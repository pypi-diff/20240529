# Comparing `tmp/python-arango-7.9.1.tar.gz` & `tmp/python_arango-8.0.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "python-arango-7.9.1.tar", last modified: Thu Jan 18 16:17:06 2024, max compression
+gzip compressed data, was "python_arango-8.0.0.tar", last modified: Wed May 29 18:56:05 2024, max compression
```

## Comparing `python-arango-7.9.1.tar` & `python_arango-8.0.0.tar`

### file list

```diff
@@ -1,98 +1,99 @@
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-01-18 16:17:06.025423 python-arango-7.9.1/
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-01-18 16:17:06.009423 python-arango-7.9.1/.circleci/
--rw-r--r--   0 runner    (1001) docker     (127)     3083 2024-01-18 16:16:48.000000 python-arango-7.9.1/.circleci/config.yml
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-01-18 16:17:06.009423 python-arango-7.9.1/.github/
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-01-18 16:17:06.009423 python-arango-7.9.1/.github/workflows/
--rw-r--r--   0 runner    (1001) docker     (127)      443 2024-01-18 16:16:48.000000 python-arango-7.9.1/.github/workflows/codeql.yaml
--rw-r--r--   0 runner    (1001) docker     (127)     2933 2024-01-18 16:16:48.000000 python-arango-7.9.1/.github/workflows/docs.yaml
--rw-r--r--   0 runner    (1001) docker     (127)     1275 2024-01-18 16:16:48.000000 python-arango-7.9.1/.github/workflows/pypi.yaml
--rw-r--r--   0 runner    (1001) docker     (127)     1393 2024-01-18 16:16:48.000000 python-arango-7.9.1/.gitignore
--rw-r--r--   0 runner    (1001) docker     (127)     1011 2024-01-18 16:16:48.000000 python-arango-7.9.1/.pre-commit-config.yaml
--rw-r--r--   0 runner    (1001) docker     (127)      921 2024-01-18 16:16:48.000000 python-arango-7.9.1/.readthedocs.yaml
--rw-r--r--   0 runner    (1001) docker     (127)      647 2024-01-18 16:16:48.000000 python-arango-7.9.1/CONTRIBUTING.md
--rw-r--r--   0 runner    (1001) docker     (127)     1072 2024-01-18 16:16:48.000000 python-arango-7.9.1/LICENSE
--rw-r--r--   0 runner    (1001) docker     (127)       62 2024-01-18 16:16:48.000000 python-arango-7.9.1/MANIFEST.in
--rw-r--r--   0 runner    (1001) docker     (127)     8343 2024-01-18 16:17:06.025423 python-arango-7.9.1/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (127)     5222 2024-01-18 16:16:48.000000 python-arango-7.9.1/README.md
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-01-18 16:17:06.017423 python-arango-7.9.1/arango/
--rw-r--r--   0 runner    (1001) docker     (127)      192 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/__init__.py
--rw-r--r--   0 runner    (1001) docker     (127)     1956 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/api.py
--rw-r--r--   0 runner    (1001) docker     (127)    28495 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/aql.py
--rw-r--r--   0 runner    (1001) docker     (127)     8644 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/backup.py
--rw-r--r--   0 runner    (1001) docker     (127)    10698 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/client.py
--rw-r--r--   0 runner    (1001) docker     (127)    13894 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/cluster.py
--rw-r--r--   0 runner    (1001) docker     (127)   138071 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/collection.py
--rw-r--r--   0 runner    (1001) docker     (127)    16347 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/connection.py
--rw-r--r--   0 runner    (1001) docker     (127)    10636 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/cursor.py
--rw-r--r--   0 runner    (1001) docker     (127)   113219 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/database.py
--rw-r--r--   0 runner    (1001) docker     (127)    34373 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/errno.py
--rw-r--r--   0 runner    (1001) docker     (127)    23856 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/exceptions.py
--rw-r--r--   0 runner    (1001) docker     (127)    15151 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/executor.py
--rw-r--r--   0 runner    (1001) docker     (127)    41477 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/formatter.py
--rw-r--r--   0 runner    (1001) docker     (127)    32737 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/foxx.py
--rw-r--r--   0 runner    (1001) docker     (127)    35861 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/graph.py
--rw-r--r--   0 runner    (1001) docker     (127)     8070 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/http.py
--rw-r--r--   0 runner    (1001) docker     (127)     7088 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/job.py
--rw-r--r--   0 runner    (1001) docker     (127)     5749 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/pregel.py
--rw-r--r--   0 runner    (1001) docker     (127)        0 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/py.typed
--rw-r--r--   0 runner    (1001) docker     (127)    33852 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/replication.py
--rw-r--r--   0 runner    (1001) docker     (127)     4124 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/request.py
--rw-r--r--   0 runner    (1001) docker     (127)     4215 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/resolver.py
--rw-r--r--   0 runner    (1001) docker     (127)     2164 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/response.py
--rw-r--r--   0 runner    (1001) docker     (127)      168 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/result.py
--rw-r--r--   0 runner    (1001) docker     (127)      779 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/typings.py
--rw-r--r--   0 runner    (1001) docker     (127)     3345 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/utils.py
--rw-r--r--   0 runner    (1001) docker     (127)    11207 2024-01-18 16:16:48.000000 python-arango-7.9.1/arango/wal.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-01-18 16:17:06.021423 python-arango-7.9.1/docs/
--rw-r--r--   0 runner    (1001) docker     (127)      634 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/Makefile
--rw-r--r--   0 runner    (1001) docker     (127)     1927 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/admin.rst
--rw-r--r--   0 runner    (1001) docker     (127)      784 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/analyzer.rst
--rw-r--r--   0 runner    (1001) docker     (127)     3874 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/aql.rst
--rw-r--r--   0 runner    (1001) docker     (127)     3444 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/async.rst
--rw-r--r--   0 runner    (1001) docker     (127)     2953 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/auth.rst
--rw-r--r--   0 runner    (1001) docker     (127)     1891 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/backup.rst
--rw-r--r--   0 runner    (1001) docker     (127)     4553 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/batch.rst
--rw-r--r--   0 runner    (1001) docker     (127)     1323 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/certificates.rst
--rw-r--r--   0 runner    (1001) docker     (127)     2657 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/cluster.rst
--rw-r--r--   0 runner    (1001) docker     (127)     1653 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/collection.rst
--rw-r--r--   0 runner    (1001) docker     (127)     2208 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/conf.py
--rw-r--r--   0 runner    (1001) docker     (127)     3515 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/contributing.rst
--rw-r--r--   0 runner    (1001) docker     (127)     5234 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/cursor.rst
--rw-r--r--   0 runner    (1001) docker     (127)     2182 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/database.rst
--rw-r--r--   0 runner    (1001) docker     (127)     6603 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/document.rst
--rw-r--r--   0 runner    (1001) docker     (127)      435 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/errno.rst
--rw-r--r--   0 runner    (1001) docker     (127)     4003 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/errors.rst
--rw-r--r--   0 runner    (1001) docker     (127)     3711 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/foxx.rst
--rw-r--r--   0 runner    (1001) docker     (127)    11910 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/graph.rst
--rw-r--r--   0 runner    (1001) docker     (127)     3721 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/http.rst
--rw-r--r--   0 runner    (1001) docker     (127)      810 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/index.rst
--rw-r--r--   0 runner    (1001) docker     (127)     1935 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/indexes.rst
--rw-r--r--   0 runner    (1001) docker     (127)      845 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/logging.rst
--rw-r--r--   0 runner    (1001) docker     (127)      760 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/make.bat
--rw-r--r--   0 runner    (1001) docker     (127)     2395 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/overload.rst
--rw-r--r--   0 runner    (1001) docker     (127)     1612 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/overview.rst
--rw-r--r--   0 runner    (1001) docker     (127)     1021 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/pregel.rst
--rw-r--r--   0 runner    (1001) docker     (127)     3081 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/replication.rst
--rw-r--r--   0 runner    (1001) docker     (127)       60 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/requirements.txt
--rw-r--r--   0 runner    (1001) docker     (127)     1130 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/schema.rst
--rw-r--r--   0 runner    (1001) docker     (127)      524 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/serializer.rst
--rw-r--r--   0 runner    (1001) docker     (127)     2401 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/simple.rst
--rw-r--r--   0 runner    (1001) docker     (127)     2857 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/specs.rst
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-01-18 16:17:06.025423 python-arango-7.9.1/docs/static/
--rw-r--r--   0 runner    (1001) docker     (127)    10608 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/static/logo.png
--rw-r--r--   0 runner    (1001) docker     (127)     1296 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/task.rst
--rw-r--r--   0 runner    (1001) docker     (127)      926 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/threading.rst
--rw-r--r--   0 runner    (1001) docker     (127)     4166 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/transaction.rst
--rw-r--r--   0 runner    (1001) docker     (127)     2538 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/user.rst
--rw-r--r--   0 runner    (1001) docker     (127)     2365 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/view.rst
--rw-r--r--   0 runner    (1001) docker     (127)     1311 2024-01-18 16:16:48.000000 python-arango-7.9.1/docs/wal.rst
--rw-r--r--   0 runner    (1001) docker     (127)     2202 2024-01-18 16:16:48.000000 python-arango-7.9.1/pyproject.toml
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-01-18 16:17:06.025423 python-arango-7.9.1/python_arango.egg-info/
--rw-r--r--   0 runner    (1001) docker     (127)     8343 2024-01-18 16:17:05.000000 python-arango-7.9.1/python_arango.egg-info/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (127)     1604 2024-01-18 16:17:06.000000 python-arango-7.9.1/python_arango.egg-info/SOURCES.txt
--rw-r--r--   0 runner    (1001) docker     (127)        1 2024-01-18 16:17:05.000000 python-arango-7.9.1/python_arango.egg-info/dependency_links.txt
--rw-r--r--   0 runner    (1001) docker     (127)      299 2024-01-18 16:17:05.000000 python-arango-7.9.1/python_arango.egg-info/requires.txt
--rw-r--r--   0 runner    (1001) docker     (127)        7 2024-01-18 16:17:05.000000 python-arango-7.9.1/python_arango.egg-info/top_level.txt
--rw-r--r--   0 runner    (1001) docker     (127)      186 2024-01-18 16:17:06.025423 python-arango-7.9.1/setup.cfg
--rw-r--r--   0 runner    (1001) docker     (127)       38 2024-01-18 16:16:48.000000 python-arango-7.9.1/setup.py
--rwxr-xr-x   0 runner    (1001) docker     (127)     1426 2024-01-18 16:16:48.000000 python-arango-7.9.1/starter.sh
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-05-29 18:56:05.326066 python_arango-8.0.0/
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-05-29 18:56:05.310066 python_arango-8.0.0/.circleci/
+-rw-r--r--   0 runner    (1001) docker     (127)     3070 2024-05-29 18:55:55.000000 python_arango-8.0.0/.circleci/config.yml
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-05-29 18:56:05.310066 python_arango-8.0.0/.github/
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-05-29 18:56:05.310066 python_arango-8.0.0/.github/workflows/
+-rw-r--r--   0 runner    (1001) docker     (127)      443 2024-05-29 18:55:55.000000 python_arango-8.0.0/.github/workflows/codeql.yaml
+-rw-r--r--   0 runner    (1001) docker     (127)     2933 2024-05-29 18:55:55.000000 python_arango-8.0.0/.github/workflows/docs.yaml
+-rw-r--r--   0 runner    (1001) docker     (127)     1275 2024-05-29 18:55:55.000000 python_arango-8.0.0/.github/workflows/pypi.yaml
+-rw-r--r--   0 runner    (1001) docker     (127)     1393 2024-05-29 18:55:55.000000 python_arango-8.0.0/.gitignore
+-rw-r--r--   0 runner    (1001) docker     (127)     1011 2024-05-29 18:55:55.000000 python_arango-8.0.0/.pre-commit-config.yaml
+-rw-r--r--   0 runner    (1001) docker     (127)      921 2024-05-29 18:55:55.000000 python_arango-8.0.0/.readthedocs.yaml
+-rw-r--r--   0 runner    (1001) docker     (127)      647 2024-05-29 18:55:55.000000 python_arango-8.0.0/CONTRIBUTING.md
+-rw-r--r--   0 runner    (1001) docker     (127)     1072 2024-05-29 18:55:55.000000 python_arango-8.0.0/LICENSE
+-rw-r--r--   0 runner    (1001) docker     (127)       62 2024-05-29 18:55:55.000000 python_arango-8.0.0/MANIFEST.in
+-rw-r--r--   0 runner    (1001) docker     (127)     8329 2024-05-29 18:56:05.326066 python_arango-8.0.0/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (127)     5226 2024-05-29 18:55:55.000000 python_arango-8.0.0/README.md
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-05-29 18:56:05.318066 python_arango-8.0.0/arango/
+-rw-r--r--   0 runner    (1001) docker     (127)      192 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (127)     1956 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/api.py
+-rw-r--r--   0 runner    (1001) docker     (127)    28495 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/aql.py
+-rw-r--r--   0 runner    (1001) docker     (127)     8644 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/backup.py
+-rw-r--r--   0 runner    (1001) docker     (127)    11792 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/client.py
+-rw-r--r--   0 runner    (1001) docker     (127)    16578 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/cluster.py
+-rw-r--r--   0 runner    (1001) docker     (127)   142808 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/collection.py
+-rw-r--r--   0 runner    (1001) docker     (127)    18465 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/connection.py
+-rw-r--r--   0 runner    (1001) docker     (127)    10636 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/cursor.py
+-rw-r--r--   0 runner    (1001) docker     (127)   124656 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/database.py
+-rw-r--r--   0 runner    (1001) docker     (127)    34373 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/errno.py
+-rw-r--r--   0 runner    (1001) docker     (127)    24956 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/exceptions.py
+-rw-r--r--   0 runner    (1001) docker     (127)    15710 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/executor.py
+-rw-r--r--   0 runner    (1001) docker     (127)    41938 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/formatter.py
+-rw-r--r--   0 runner    (1001) docker     (127)    32737 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/foxx.py
+-rw-r--r--   0 runner    (1001) docker     (127)    36236 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/graph.py
+-rw-r--r--   0 runner    (1001) docker     (127)    10215 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/http.py
+-rw-r--r--   0 runner    (1001) docker     (127)     7088 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/job.py
+-rw-r--r--   0 runner    (1001) docker     (127)     5749 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/pregel.py
+-rw-r--r--   0 runner    (1001) docker     (127)        0 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/py.typed
+-rw-r--r--   0 runner    (1001) docker     (127)    33924 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/replication.py
+-rw-r--r--   0 runner    (1001) docker     (127)     4124 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/request.py
+-rw-r--r--   0 runner    (1001) docker     (127)     4215 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/resolver.py
+-rw-r--r--   0 runner    (1001) docker     (127)     2164 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/response.py
+-rw-r--r--   0 runner    (1001) docker     (127)      168 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/result.py
+-rw-r--r--   0 runner    (1001) docker     (127)      779 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/typings.py
+-rw-r--r--   0 runner    (1001) docker     (127)     3345 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/utils.py
+-rw-r--r--   0 runner    (1001) docker     (127)    11207 2024-05-29 18:55:55.000000 python_arango-8.0.0/arango/wal.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-05-29 18:56:05.322065 python_arango-8.0.0/docs/
+-rw-r--r--   0 runner    (1001) docker     (127)      634 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/Makefile
+-rw-r--r--   0 runner    (1001) docker     (127)     2273 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/admin.rst
+-rw-r--r--   0 runner    (1001) docker     (127)      784 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/analyzer.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     3874 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/aql.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     3444 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/async.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     2953 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/auth.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     1891 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/backup.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     4553 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/batch.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     1323 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/certificates.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     2944 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/cluster.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     1653 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/collection.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     1660 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/compression.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     2208 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/conf.py
+-rw-r--r--   0 runner    (1001) docker     (127)     3340 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/contributing.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     5234 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/cursor.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     2182 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/database.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     6603 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/document.rst
+-rw-r--r--   0 runner    (1001) docker     (127)      435 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/errno.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     4003 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/errors.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     3711 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/foxx.rst
+-rw-r--r--   0 runner    (1001) docker     (127)    11989 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/graph.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     3721 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/http.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     1077 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/index.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     2514 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/indexes.rst
+-rw-r--r--   0 runner    (1001) docker     (127)      845 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/logging.rst
+-rw-r--r--   0 runner    (1001) docker     (127)      760 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/make.bat
+-rw-r--r--   0 runner    (1001) docker     (127)     2395 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/overload.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     1643 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/overview.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     1231 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/pregel.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     3081 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/replication.rst
+-rw-r--r--   0 runner    (1001) docker     (127)       60 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/requirements.txt
+-rw-r--r--   0 runner    (1001) docker     (127)     1130 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/schema.rst
+-rw-r--r--   0 runner    (1001) docker     (127)      524 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/serializer.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     2113 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/simple.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     2978 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/specs.rst
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-05-29 18:56:05.322065 python_arango-8.0.0/docs/static/
+-rw-r--r--   0 runner    (1001) docker     (127)    10608 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/static/logo.png
+-rw-r--r--   0 runner    (1001) docker     (127)     1296 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/task.rst
+-rw-r--r--   0 runner    (1001) docker     (127)      926 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/threading.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     4668 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/transaction.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     2538 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/user.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     2365 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/view.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     1311 2024-05-29 18:55:55.000000 python_arango-8.0.0/docs/wal.rst
+-rw-r--r--   0 runner    (1001) docker     (127)     2184 2024-05-29 18:55:55.000000 python_arango-8.0.0/pyproject.toml
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-05-29 18:56:05.322065 python_arango-8.0.0/python_arango.egg-info/
+-rw-r--r--   0 runner    (1001) docker     (127)     8329 2024-05-29 18:56:05.000000 python_arango-8.0.0/python_arango.egg-info/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (127)     1625 2024-05-29 18:56:05.000000 python_arango-8.0.0/python_arango.egg-info/SOURCES.txt
+-rw-r--r--   0 runner    (1001) docker     (127)        1 2024-05-29 18:56:05.000000 python_arango-8.0.0/python_arango.egg-info/dependency_links.txt
+-rw-r--r--   0 runner    (1001) docker     (127)      299 2024-05-29 18:56:05.000000 python_arango-8.0.0/python_arango.egg-info/requires.txt
+-rw-r--r--   0 runner    (1001) docker     (127)        7 2024-05-29 18:56:05.000000 python_arango-8.0.0/python_arango.egg-info/top_level.txt
+-rw-r--r--   0 runner    (1001) docker     (127)      186 2024-05-29 18:56:05.326066 python_arango-8.0.0/setup.cfg
+-rw-r--r--   0 runner    (1001) docker     (127)       38 2024-05-29 18:55:55.000000 python_arango-8.0.0/setup.py
+-rwxr-xr-x   0 runner    (1001) docker     (127)     1495 2024-05-29 18:55:55.000000 python_arango-8.0.0/starter.sh
```

### Comparing `python-arango-7.9.1/.circleci/config.yml` & `python_arango-8.0.0/.circleci/config.yml`

 * *Files 2% similar despite different names*

```diff
@@ -11,15 +11,15 @@
           name:  Python (<< matrix.python_version >>) - ArangoDB (<< matrix.arangodb_license >>, << matrix.arangodb_version >> << matrix.arangodb_config >>)
           matrix:
             parameters:
               # TODO: Revisit why pyenv doesn't recognize 3.12
               python_version: ["3.8", "3.9", "3.10", "3.11"] # "3.12"
               arangodb_config: ["single", "cluster"]
               arangodb_license: ["community", "enterprise"]
-              arangodb_version: ["3.10.10", "3.11.4", "latest"]
+              arangodb_version: ["3.11", "latest"]
 
 jobs:
   lint:
     docker:
       - image: python:latest
     steps:
       - checkout
```

### Comparing `python-arango-7.9.1/.github/workflows/docs.yaml` & `python_arango-8.0.0/.github/workflows/docs.yaml`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/.github/workflows/pypi.yaml` & `python_arango-8.0.0/.github/workflows/pypi.yaml`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/.gitignore` & `python_arango-8.0.0/.gitignore`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/.pre-commit-config.yaml` & `python_arango-8.0.0/.pre-commit-config.yaml`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/.readthedocs.yaml` & `python_arango-8.0.0/.readthedocs.yaml`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/CONTRIBUTING.md` & `python_arango-8.0.0/CONTRIBUTING.md`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/LICENSE` & `python_arango-8.0.0/LICENSE`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/PKG-INFO` & `python_arango-8.0.0/PKG-INFO`

 * *Files 8% similar despite different names*

```diff
@@ -1,13 +1,13 @@
 Metadata-Version: 2.1
 Name: python-arango
-Version: 7.9.1
+Version: 8.0.0
 Summary: Python Driver for ArangoDB
 Author-email: Joohwan Oh <joohwan.oh@outlook.com>
-Maintainer-email: Joohwan Oh <joohwan.oh@outlook.com>, Alexandru Petenchea <alexandru.petenchea@arangodb.com>, Anthony Mahanna <anthony.mahanna@arangodb.com>
+Maintainer-email: Joohwan Oh <joohwan.oh@outlook.com>, Alexandru Petenchea <alex.petenchea@gmail.com>, Anthony Mahanna <anthony.mahanna@arangodb.com>
 License: MIT License
         
         Copyright (c) 2016-2021 Joohwan Oh
         
         Permission is hereby granted, free of charge, to any person obtaining a copy
         of this software and associated documentation files (the "Software"), to deal
         in the Software without restriction, including without limitation the rights
@@ -22,15 +22,15 @@
         IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
         FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
         AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
         LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
         OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
         SOFTWARE.
         
-Project-URL: homepage, https://github.com/ArangoDB-Community/python-arango
+Project-URL: homepage, https://github.com/arangodb/python-arango
 Keywords: arangodb,python,driver
 Classifier: Intended Audience :: Developers
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Natural Language :: English
 Classifier: Operating System :: OS Independent
 Classifier: Programming Language :: Python :: 3
 Classifier: Programming Language :: Python :: 3.8
@@ -63,36 +63,36 @@
 Requires-Dist: sphinx_rtd_theme; extra == "dev"
 Requires-Dist: types-pkg_resources; extra == "dev"
 Requires-Dist: types-requests; extra == "dev"
 Requires-Dist: types-setuptools; extra == "dev"
 
 ![Logo](https://user-images.githubusercontent.com/2701938/108583516-c3576680-72ee-11eb-883f-2d9b52e74e45.png)
 
-[![CircleCI](https://dl.circleci.com/status-badge/img/gh/ArangoDB-Community/python-arango/tree/main.svg?style=svg)](https://dl.circleci.com/status-badge/redirect/gh/ArangoDB-Community/python-arango/tree/main)
-[![CodeQL](https://github.com/ArangoDB-Community/python-arango/actions/workflows/codeql.yaml/badge.svg)](https://github.com/ArangoDB-Community/python-arango/actions/workflows/codeql.yaml)
-[![Docs](https://github.com/ArangoDB-Community/python-arango/actions/workflows/docs.yaml/badge.svg)](https://github.com/ArangoDB-Community/python-arango/actions/workflows/docs.yaml)
-[![Coverage Status](https://codecov.io/gh/ArangoDB-Community/python-arango/branch/main/graph/badge.svg?token=M8zrjrzsUY)](https://codecov.io/gh/ArangoDB-Community/python-arango)
-[![Last commit](https://img.shields.io/github/last-commit/ArangoDB-Community/python-arango)](https://github.com/ArangoDB-Community/python-arango/commits/master)
+[![CircleCI](https://dl.circleci.com/status-badge/img/gh/arangodb/python-arango/tree/main.svg?style=svg)](https://dl.circleci.com/status-badge/redirect/gh/arangodb/python-arango/tree/main)
+[![CodeQL](https://github.com/arangodb/python-arango/actions/workflows/codeql.yaml/badge.svg)](https://github.com/arangodb/python-arango/actions/workflows/codeql.yaml)
+[![Docs](https://github.com/arangodb/python-arango/actions/workflows/docs.yaml/badge.svg)](https://github.com/arangodb/python-arango/actions/workflows/docs.yaml)
+[![Coverage Status](https://codecov.io/gh/arangodb/python-arango/branch/main/graph/badge.svg?token=M8zrjrzsUY)](https://codecov.io/gh/arangodb/python-arango)
+[![Last commit](https://img.shields.io/github/last-commit/arangodb/python-arango)](https://github.com/arangodb/python-arango/commits/master)
 
 [![PyPI version badge](https://img.shields.io/pypi/v/python-arango?color=3775A9&style=for-the-badge&logo=pypi&logoColor=FFD43B)](https://pypi.org/project/python-arango/)
 [![Python versions badge](https://img.shields.io/badge/3.8%2B-3776AB?style=for-the-badge&logo=python&logoColor=FFD43B&label=Python)](https://pypi.org/project/python-arango/)
 
-[![License](https://img.shields.io/github/license/ArangoDB-Community/python-arango?color=9E2165&style=for-the-badge)](https://github.com/ArangoDB-Community/python-arango/blob/master/LICENSE)
+[![License](https://img.shields.io/github/license/arangodb/python-arango?color=9E2165&style=for-the-badge)](https://github.com/arangodb/python-arango/blob/master/LICENSE)
 [![Code style: black](https://img.shields.io/static/v1?style=for-the-badge&label=code%20style&message=black&color=black)](https://github.com/psf/black)
 [![Downloads](https://img.shields.io/pepy/dt/python-arango?style=for-the-badge&color=282661
 )](https://pepy.tech/project/python-arango)
 
 # Python-Arango
 
 Python driver for [ArangoDB](https://www.arangodb.com), a scalable multi-model
 database natively supporting documents, graphs and search.
 
 ## Requirements
 
-- ArangoDB version 3.9+
+- ArangoDB version 3.11+
 - Python version 3.8+
 
 ## Installation
 
 ```shell
 pip install python-arango --upgrade
 ```
@@ -115,16 +115,16 @@
 
 # Connect to "test" database as root user.
 db = client.db("test", username="root", password="passwd")
 
 # Create a new collection named "students".
 students = db.create_collection("students")
 
-# Add a hash index to the collection.
-students.add_hash_index(fields=["name"], unique=True)
+# Add a persistent index to the collection.
+students.add_index({'type': 'persistent', 'fields': ['name'], 'unique': True})
 
 # Insert new documents into the collection.
 students.insert({"name": "jane", "age": 39})
 students.insert({"name": "josh", "age": 18})
 students.insert({"name": "judy", "age": 21})
 
 # Execute an AQL query and iterate through the result cursor.
@@ -176,16 +176,17 @@
 edges.insert({"_from": "students/01", "_to": "lectures/MAT101"})
 edges.insert({"_from": "students/01", "_to": "lectures/STA101"})
 edges.insert({"_from": "students/01", "_to": "lectures/CSC101"})
 edges.insert({"_from": "students/02", "_to": "lectures/MAT101"})
 edges.insert({"_from": "students/02", "_to": "lectures/STA101"})
 edges.insert({"_from": "students/03", "_to": "lectures/CSC101"})
 
-# Traverse the graph in outbound direction, breadth-first.
-result = graph.traverse(
-    start_vertex="students/01",
-    direction="outbound",
-    strategy="breadthfirst"
-)
+# Traverse the graph in outbound direction, breath-first.
+query = """
+    FOR v, e, p IN 1..3 OUTBOUND 'students/01' GRAPH 'school'
+    OPTIONS { bfs: true, uniqueVertices: 'global' }
+    RETURN {vertex: v, edge: e, path: p}
+    """
+cursor = db.aql.execute(query)
 ```
 
 Please see the [documentation](https://docs.python-arango.com) for more details.
```

### Comparing `python-arango-7.9.1/README.md` & `python_arango-8.0.0/README.md`

 * *Files 10% similar despite different names*

```diff
@@ -1,31 +1,31 @@
 ![Logo](https://user-images.githubusercontent.com/2701938/108583516-c3576680-72ee-11eb-883f-2d9b52e74e45.png)
 
-[![CircleCI](https://dl.circleci.com/status-badge/img/gh/ArangoDB-Community/python-arango/tree/main.svg?style=svg)](https://dl.circleci.com/status-badge/redirect/gh/ArangoDB-Community/python-arango/tree/main)
-[![CodeQL](https://github.com/ArangoDB-Community/python-arango/actions/workflows/codeql.yaml/badge.svg)](https://github.com/ArangoDB-Community/python-arango/actions/workflows/codeql.yaml)
-[![Docs](https://github.com/ArangoDB-Community/python-arango/actions/workflows/docs.yaml/badge.svg)](https://github.com/ArangoDB-Community/python-arango/actions/workflows/docs.yaml)
-[![Coverage Status](https://codecov.io/gh/ArangoDB-Community/python-arango/branch/main/graph/badge.svg?token=M8zrjrzsUY)](https://codecov.io/gh/ArangoDB-Community/python-arango)
-[![Last commit](https://img.shields.io/github/last-commit/ArangoDB-Community/python-arango)](https://github.com/ArangoDB-Community/python-arango/commits/master)
+[![CircleCI](https://dl.circleci.com/status-badge/img/gh/arangodb/python-arango/tree/main.svg?style=svg)](https://dl.circleci.com/status-badge/redirect/gh/arangodb/python-arango/tree/main)
+[![CodeQL](https://github.com/arangodb/python-arango/actions/workflows/codeql.yaml/badge.svg)](https://github.com/arangodb/python-arango/actions/workflows/codeql.yaml)
+[![Docs](https://github.com/arangodb/python-arango/actions/workflows/docs.yaml/badge.svg)](https://github.com/arangodb/python-arango/actions/workflows/docs.yaml)
+[![Coverage Status](https://codecov.io/gh/arangodb/python-arango/branch/main/graph/badge.svg?token=M8zrjrzsUY)](https://codecov.io/gh/arangodb/python-arango)
+[![Last commit](https://img.shields.io/github/last-commit/arangodb/python-arango)](https://github.com/arangodb/python-arango/commits/master)
 
 [![PyPI version badge](https://img.shields.io/pypi/v/python-arango?color=3775A9&style=for-the-badge&logo=pypi&logoColor=FFD43B)](https://pypi.org/project/python-arango/)
 [![Python versions badge](https://img.shields.io/badge/3.8%2B-3776AB?style=for-the-badge&logo=python&logoColor=FFD43B&label=Python)](https://pypi.org/project/python-arango/)
 
-[![License](https://img.shields.io/github/license/ArangoDB-Community/python-arango?color=9E2165&style=for-the-badge)](https://github.com/ArangoDB-Community/python-arango/blob/master/LICENSE)
+[![License](https://img.shields.io/github/license/arangodb/python-arango?color=9E2165&style=for-the-badge)](https://github.com/arangodb/python-arango/blob/master/LICENSE)
 [![Code style: black](https://img.shields.io/static/v1?style=for-the-badge&label=code%20style&message=black&color=black)](https://github.com/psf/black)
 [![Downloads](https://img.shields.io/pepy/dt/python-arango?style=for-the-badge&color=282661
 )](https://pepy.tech/project/python-arango)
 
 # Python-Arango
 
 Python driver for [ArangoDB](https://www.arangodb.com), a scalable multi-model
 database natively supporting documents, graphs and search.
 
 ## Requirements
 
-- ArangoDB version 3.9+
+- ArangoDB version 3.11+
 - Python version 3.8+
 
 ## Installation
 
 ```shell
 pip install python-arango --upgrade
 ```
@@ -48,16 +48,16 @@
 
 # Connect to "test" database as root user.
 db = client.db("test", username="root", password="passwd")
 
 # Create a new collection named "students".
 students = db.create_collection("students")
 
-# Add a hash index to the collection.
-students.add_hash_index(fields=["name"], unique=True)
+# Add a persistent index to the collection.
+students.add_index({'type': 'persistent', 'fields': ['name'], 'unique': True})
 
 # Insert new documents into the collection.
 students.insert({"name": "jane", "age": 39})
 students.insert({"name": "josh", "age": 18})
 students.insert({"name": "judy", "age": 21})
 
 # Execute an AQL query and iterate through the result cursor.
@@ -109,16 +109,17 @@
 edges.insert({"_from": "students/01", "_to": "lectures/MAT101"})
 edges.insert({"_from": "students/01", "_to": "lectures/STA101"})
 edges.insert({"_from": "students/01", "_to": "lectures/CSC101"})
 edges.insert({"_from": "students/02", "_to": "lectures/MAT101"})
 edges.insert({"_from": "students/02", "_to": "lectures/STA101"})
 edges.insert({"_from": "students/03", "_to": "lectures/CSC101"})
 
-# Traverse the graph in outbound direction, breadth-first.
-result = graph.traverse(
-    start_vertex="students/01",
-    direction="outbound",
-    strategy="breadthfirst"
-)
+# Traverse the graph in outbound direction, breath-first.
+query = """
+    FOR v, e, p IN 1..3 OUTBOUND 'students/01' GRAPH 'school'
+    OPTIONS { bfs: true, uniqueVertices: 'global' }
+    RETURN {vertex: v, edge: e, path: p}
+    """
+cursor = db.aql.execute(query)
 ```
 
 Please see the [documentation](https://docs.python-arango.com) for more details.
```

### Comparing `python-arango-7.9.1/arango/api.py` & `python_arango-8.0.0/arango/api.py`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/arango/aql.py` & `python_arango-8.0.0/arango/aql.py`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/arango/backup.py` & `python_arango-8.0.0/arango/backup.py`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/arango/client.py` & `python_arango-8.0.0/arango/client.py`

 * *Files 9% similar despite different names*

```diff
@@ -8,16 +8,21 @@
 from arango.connection import (
     BasicConnection,
     Connection,
     JwtConnection,
     JwtSuperuserConnection,
 )
 from arango.database import StandardDatabase
-from arango.exceptions import ServerConnectionError
-from arango.http import DEFAULT_REQUEST_TIMEOUT, DefaultHTTPClient, HTTPClient
+from arango.exceptions import ArangoClientError, ServerConnectionError
+from arango.http import (
+    DEFAULT_REQUEST_TIMEOUT,
+    DefaultHTTPClient,
+    HTTPClient,
+    RequestCompression,
+)
 from arango.resolver import (
     FallbackHostResolver,
     HostResolver,
     PeriodicHostResolver,
     RandomHostResolver,
     RoundRobinHostResolver,
     SingleHostResolver,
@@ -29,15 +34,15 @@
     Default JSON serializer
 
     :param x: A JSON data type object to serialize
     :type x: Any
     :return: The object serialized as a JSON string
     :rtype: str
     """
-    return dumps(x)
+    return dumps(x, separators=(",", ":"))
 
 
 def default_deserializer(x: str) -> Any:
     """
     Default JSON de-serializer
 
     :param x: A JSON string to deserialize
@@ -81,26 +86,34 @@
     :type verify_override: Union[bool, str, None]
     :param request_timeout: This is the default request timeout (in seconds)
        for http requests issued by the client if the parameter http_client is
        not specified. The default value is 60.
        None: No timeout.
        int: Timeout value in seconds.
     :type request_timeout: int | float
+    :param request_compression: Will compress requests to the server according to
+        the given algorithm. No compression happens by default.
+    :type request_compression: arango.http.RequestCompression | None
+    :param response_compression: Tells the server what compression algorithm is
+        acceptable for the response. No compression happens by default.
+    :type response_compression: str | None
     """
 
     def __init__(
         self,
         hosts: Union[str, Sequence[str]] = "http://127.0.0.1:8529",
         host_resolver: Union[str, HostResolver] = "fallback",
         resolver_max_tries: Optional[int] = None,
         http_client: Optional[HTTPClient] = None,
         serializer: Callable[..., str] = default_serializer,
         deserializer: Callable[[str], Any] = default_deserializer,
         verify_override: Union[bool, str, None] = None,
         request_timeout: Union[int, float, None] = DEFAULT_REQUEST_TIMEOUT,
+        request_compression: Optional[RequestCompression] = None,
+        response_compression: Optional[str] = None,
     ) -> None:
         if isinstance(hosts, str):
             self._hosts = [host.strip("/") for host in hosts.split(",")]
         else:
             self._hosts = [host.strip("/") for host in hosts]
 
         host_count = len(self._hosts)
@@ -129,14 +142,17 @@
         self._sessions = [self._http.create_session(h) for h in self._hosts]
 
         # override SSL/TLS certificate verification if provided
         if verify_override is not None:
             for session in self._sessions:
                 session.verify = verify_override
 
+        self._request_compression = request_compression
+        self._response_compression = response_compression
+
     def __repr__(self) -> str:
         return f"<ArangoClient {','.join(self._hosts)}>"
 
     def close(self) -> None:  # pragma: no cover
         """Close HTTP sessions."""
         for session in self._sessions:
             session.close()
@@ -179,15 +195,14 @@
         name: str = "_system",
         username: str = "root",
         password: str = "",
         verify: bool = False,
         auth_method: str = "basic",
         user_token: Optional[str] = None,
         superuser_token: Optional[str] = None,
-        verify_certificate: bool = True,
     ) -> StandardDatabase:
         """Connect to an ArangoDB database and return the database API wrapper.
 
         :param name: Database name.
         :type name: str
         :param username: Username for basic authentication.
         :type username: str
@@ -208,16 +223,14 @@
             expiry will be checked.
         :type user_token: str
         :param superuser_token: User generated token for superuser access.
             If set, parameters **username**, **password** and **auth_method**
             are ignored. This token is not refreshed automatically. Token
             expiry will not be checked.
         :type superuser_token: str
-        :param verify_certificate: Verify TLS certificates.
-        :type verify_certificate: bool
         :return: Standard database API wrapper.
         :rtype: arango.database.StandardDatabase
         :raise arango.exceptions.ServerConnectionError: If **verify** was set
             to True and the connection fails.
         """
         connection: Connection
 
@@ -227,55 +240,63 @@
                 host_resolver=self._host_resolver,
                 sessions=self._sessions,
                 db_name=name,
                 http_client=self._http,
                 serializer=self._serializer,
                 deserializer=self._deserializer,
                 superuser_token=superuser_token,
+                request_compression=self._request_compression,
+                response_compression=self._response_compression,
             )
         elif user_token is not None:
             connection = JwtConnection(
                 hosts=self._hosts,
                 host_resolver=self._host_resolver,
                 sessions=self._sessions,
                 db_name=name,
                 http_client=self._http,
                 serializer=self._serializer,
                 deserializer=self._deserializer,
                 user_token=user_token,
+                request_compression=self._request_compression,
+                response_compression=self._response_compression,
             )
         elif auth_method.lower() == "basic":
             connection = BasicConnection(
                 hosts=self._hosts,
                 host_resolver=self._host_resolver,
                 sessions=self._sessions,
                 db_name=name,
                 username=username,
                 password=password,
                 http_client=self._http,
                 serializer=self._serializer,
                 deserializer=self._deserializer,
+                request_compression=self._request_compression,
+                response_compression=self._response_compression,
             )
         elif auth_method.lower() == "jwt":
             connection = JwtConnection(
                 hosts=self._hosts,
                 host_resolver=self._host_resolver,
                 sessions=self._sessions,
                 db_name=name,
                 username=username,
                 password=password,
                 http_client=self._http,
                 serializer=self._serializer,
                 deserializer=self._deserializer,
+                request_compression=self._request_compression,
+                response_compression=self._response_compression,
             )
         else:
             raise ValueError(f"invalid auth_method: {auth_method}")
 
         if verify:
             try:
                 connection.ping()
             except ServerConnectionError as err:
                 raise err
             except Exception as err:
-                raise ServerConnectionError(f"bad connection: {err}")
+                raise ArangoClientError(f"bad connection: {err}")
 
         return StandardDatabase(connection)
```

### Comparing `python-arango-7.9.1/arango/cluster.py` & `python_arango-8.0.0/arango/cluster.py`

 * *Files 12% similar despite different names*

```diff
@@ -7,14 +7,15 @@
     ClusterEndpointsError,
     ClusterHealthError,
     ClusterMaintenanceModeError,
     ClusterRebalanceError,
     ClusterServerCountError,
     ClusterServerEngineError,
     ClusterServerIDError,
+    ClusterServerModeError,
     ClusterServerRoleError,
     ClusterServerStatisticsError,
     ClusterServerVersionError,
 )
 from arango.formatter import format_body
 from arango.request import Request
 from arango.response import Response
@@ -53,14 +54,35 @@
         def response_handler(resp: Response) -> str:
             if resp.is_success:
                 return str(resp.body["role"])
             raise ClusterServerRoleError(resp, request)
 
         return self._execute(request, response_handler)
 
+    def server_mode(self) -> Result[str]:
+        """Return the server mode.
+
+        In a read-only server, all write operations will fail
+        with an error code of 1004 (ERROR_READ_ONLY). Creating or dropping
+        databases and collections will also fail with error code 11 (ERROR_FORBIDDEN).
+
+        :return: Server mode. Possible values are "default" or "readonly".
+        :rtype: str
+        :raise arango.exceptions.ClusterServerModeError: If retrieval fails.
+        """
+        request = Request(method="get", endpoint="/_admin/server/mode")
+
+        def response_handler(resp: Response) -> str:
+            if resp.is_success:
+                return str(resp.body["mode"])
+
+            raise ClusterServerModeError(resp, request)
+
+        return self._execute(request, response_handler)
+
     def server_version(self, server_id: str) -> Result[Json]:
         """Return the version of the given server.
 
         :param server_id: Server ID.
         :type server_id: str
         :return: Version of the given server.
         :rtype: dict
@@ -136,14 +158,66 @@
         def response_handler(resp: Response) -> Json:
             if resp.is_success:
                 return format_body(resp.body)
             raise ClusterServerStatisticsError(resp, request)
 
         return self._execute(request, response_handler)
 
+    def server_maintenance_mode(self, server_id: str) -> Result[Json]:
+        """Return the maintenance status for the given server.
+
+        :param server_id: Server ID.
+        :type server_id: str
+        :return: Maintenance status for the given server.
+        :rtype: dict
+        :raise arango.exceptions.ClusterMaintenanceModeError: If retrieval fails.
+        """
+        request = Request(
+            method="get",
+            endpoint=f"/_admin/cluster/maintenance/{server_id}",
+        )
+
+        def response_handler(resp: Response) -> Json:
+            if resp.is_success:
+                result: Json = resp.body.get("result", {})
+                return result
+
+            raise ClusterMaintenanceModeError(resp, request)
+
+        return self._execute(request, response_handler)
+
+    def toggle_server_maintenance_mode(
+        self, server_id: str, mode: str, timeout: Optional[int] = None
+    ) -> Result[Json]:
+        """Enable or disable the maintenance mode for the given server.
+
+        :param server_id: Server ID.
+        :type server_id: str
+        :param mode: Maintenance mode. Allowed values are "normal" and "maintenance".
+        :type mode: str
+        :param timeout: Timeout in seconds.
+        :type timeout: Optional[int]
+        :return: Result of the operation.
+        :rtype: dict
+        :raise arango.exceptions.ClusterMaintenanceModeError: If toggle fails.
+        """
+        request = Request(
+            method="put",
+            endpoint=f"/_admin/cluster/maintenance/{server_id}",
+            data={"mode": mode, "timeout": timeout},
+        )
+
+        def response_handler(resp: Response) -> Json:
+            if resp.is_success:
+                return format_body(resp.body)
+
+            raise ClusterMaintenanceModeError(resp, request)
+
+        return self._execute(request, response_handler)
+
     def health(self) -> Result[Json]:
         """Return the cluster health.
 
         :return: Cluster health.
         :rtype: dict
         :raise arango.exceptions.ClusterHealthError: If retrieval fails.
         """
```

### Comparing `python-arango-7.9.1/arango/collection.py` & `python_arango-8.0.0/arango/collection.py`

 * *Files 3% similar despite different names*

```diff
@@ -3,8628 +3,8924 @@
 00000020: 2022 5665 7274 6578 436f 6c6c 6563 7469   "VertexCollecti
 00000030: 6f6e 222c 2022 4564 6765 436f 6c6c 6563  on", "EdgeCollec
 00000040: 7469 6f6e 225d 0a0a 6672 6f6d 206e 756d  tion"]..from num
 00000050: 6265 7273 2069 6d70 6f72 7420 4e75 6d62  bers import Numb
 00000060: 6572 0a66 726f 6d20 7479 7069 6e67 2069  er.from typing i
 00000070: 6d70 6f72 7420 4c69 7374 2c20 4f70 7469  mport List, Opti
 00000080: 6f6e 616c 2c20 5365 7175 656e 6365 2c20  onal, Sequence, 
-00000090: 5475 706c 652c 2055 6e69 6f6e 0a0a 6672  Tuple, Union..fr
-000000a0: 6f6d 2061 7261 6e67 6f2e 6170 6920 696d  om arango.api im
-000000b0: 706f 7274 2041 7069 4772 6f75 700a 6672  port ApiGroup.fr
-000000c0: 6f6d 2061 7261 6e67 6f2e 636f 6e6e 6563  om arango.connec
-000000d0: 7469 6f6e 2069 6d70 6f72 7420 436f 6e6e  tion import Conn
-000000e0: 6563 7469 6f6e 0a66 726f 6d20 6172 616e  ection.from aran
-000000f0: 676f 2e63 7572 736f 7220 696d 706f 7274  go.cursor import
-00000100: 2043 7572 736f 720a 6672 6f6d 2061 7261   Cursor.from ara
-00000110: 6e67 6f2e 6578 6365 7074 696f 6e73 2069  ngo.exceptions i
-00000120: 6d70 6f72 7420 280a 2020 2020 4172 616e  mport (.    Aran
-00000130: 676f 5365 7276 6572 4572 726f 722c 0a20  goServerError,. 
-00000140: 2020 2043 6f6c 6c65 6374 696f 6e43 6865     CollectionChe
-00000150: 636b 7375 6d45 7272 6f72 2c0a 2020 2020  cksumError,.    
-00000160: 436f 6c6c 6563 7469 6f6e 436f 6d70 6163  CollectionCompac
-00000170: 7445 7272 6f72 2c0a 2020 2020 436f 6c6c  tError,.    Coll
-00000180: 6563 7469 6f6e 436f 6e66 6967 7572 6545  ectionConfigureE
-00000190: 7272 6f72 2c0a 2020 2020 436f 6c6c 6563  rror,.    Collec
-000001a0: 7469 6f6e 496e 666f 726d 6174 696f 6e45  tionInformationE
-000001b0: 7272 6f72 2c0a 2020 2020 436f 6c6c 6563  rror,.    Collec
-000001c0: 7469 6f6e 4c6f 6164 4572 726f 722c 0a20  tionLoadError,. 
-000001d0: 2020 2043 6f6c 6c65 6374 696f 6e50 726f     CollectionPro
-000001e0: 7065 7274 6965 7345 7272 6f72 2c0a 2020  pertiesError,.  
-000001f0: 2020 436f 6c6c 6563 7469 6f6e 5265 6361    CollectionReca
-00000200: 6c63 756c 6174 6543 6f75 6e74 4572 726f  lculateCountErro
-00000210: 722c 0a20 2020 2043 6f6c 6c65 6374 696f  r,.    Collectio
-00000220: 6e52 656e 616d 6545 7272 6f72 2c0a 2020  nRenameError,.  
-00000230: 2020 436f 6c6c 6563 7469 6f6e 5265 7370    CollectionResp
-00000240: 6f6e 7369 626c 6553 6861 7264 4572 726f  onsibleShardErro
-00000250: 722c 0a20 2020 2043 6f6c 6c65 6374 696f  r,.    Collectio
-00000260: 6e52 6576 6973 696f 6e45 7272 6f72 2c0a  nRevisionError,.
-00000270: 2020 2020 436f 6c6c 6563 7469 6f6e 5368      CollectionSh
-00000280: 6172 6473 4572 726f 722c 0a20 2020 2043  ardsError,.    C
-00000290: 6f6c 6c65 6374 696f 6e53 7461 7469 7374  ollectionStatist
-000002a0: 6963 7345 7272 6f72 2c0a 2020 2020 436f  icsError,.    Co
-000002b0: 6c6c 6563 7469 6f6e 5472 756e 6361 7465  llectionTruncate
-000002c0: 4572 726f 722c 0a20 2020 2043 6f6c 6c65  Error,.    Colle
-000002d0: 6374 696f 6e55 6e6c 6f61 6445 7272 6f72  ctionUnloadError
-000002e0: 2c0a 2020 2020 446f 6375 6d65 6e74 436f  ,.    DocumentCo
-000002f0: 756e 7445 7272 6f72 2c0a 2020 2020 446f  untError,.    Do
-00000300: 6375 6d65 6e74 4465 6c65 7465 4572 726f  cumentDeleteErro
-00000310: 722c 0a20 2020 2044 6f63 756d 656e 7447  r,.    DocumentG
-00000320: 6574 4572 726f 722c 0a20 2020 2044 6f63  etError,.    Doc
-00000330: 756d 656e 7449 4473 4572 726f 722c 0a20  umentIDsError,. 
-00000340: 2020 2044 6f63 756d 656e 7449 6e45 7272     DocumentInErr
-00000350: 6f72 2c0a 2020 2020 446f 6375 6d65 6e74  or,.    Document
-00000360: 496e 7365 7274 4572 726f 722c 0a20 2020  InsertError,.   
-00000370: 2044 6f63 756d 656e 744b 6579 7345 7272   DocumentKeysErr
-00000380: 6f72 2c0a 2020 2020 446f 6375 6d65 6e74  or,.    Document
-00000390: 5061 7273 6545 7272 6f72 2c0a 2020 2020  ParseError,.    
-000003a0: 446f 6375 6d65 6e74 5265 706c 6163 6545  DocumentReplaceE
+00000090: 5475 706c 652c 2055 6e69 6f6e 0a66 726f  Tuple, Union.fro
+000000a0: 6d20 7761 726e 696e 6773 2069 6d70 6f72  m warnings impor
+000000b0: 7420 7761 726e 0a0a 6672 6f6d 2061 7261  t warn..from ara
+000000c0: 6e67 6f2e 6170 6920 696d 706f 7274 2041  ngo.api import A
+000000d0: 7069 4772 6f75 700a 6672 6f6d 2061 7261  piGroup.from ara
+000000e0: 6e67 6f2e 636f 6e6e 6563 7469 6f6e 2069  ngo.connection i
+000000f0: 6d70 6f72 7420 436f 6e6e 6563 7469 6f6e  mport Connection
+00000100: 0a66 726f 6d20 6172 616e 676f 2e63 7572  .from arango.cur
+00000110: 736f 7220 696d 706f 7274 2043 7572 736f  sor import Curso
+00000120: 720a 6672 6f6d 2061 7261 6e67 6f2e 6578  r.from arango.ex
+00000130: 6365 7074 696f 6e73 2069 6d70 6f72 7420  ceptions import 
+00000140: 280a 2020 2020 4172 616e 676f 5365 7276  (.    ArangoServ
+00000150: 6572 4572 726f 722c 0a20 2020 2043 6f6c  erError,.    Col
+00000160: 6c65 6374 696f 6e43 6865 636b 7375 6d45  lectionChecksumE
+00000170: 7272 6f72 2c0a 2020 2020 436f 6c6c 6563  rror,.    Collec
+00000180: 7469 6f6e 436f 6d70 6163 7445 7272 6f72  tionCompactError
+00000190: 2c0a 2020 2020 436f 6c6c 6563 7469 6f6e  ,.    Collection
+000001a0: 436f 6e66 6967 7572 6545 7272 6f72 2c0a  ConfigureError,.
+000001b0: 2020 2020 436f 6c6c 6563 7469 6f6e 496e      CollectionIn
+000001c0: 666f 726d 6174 696f 6e45 7272 6f72 2c0a  formationError,.
+000001d0: 2020 2020 436f 6c6c 6563 7469 6f6e 4c6f      CollectionLo
+000001e0: 6164 4572 726f 722c 0a20 2020 2043 6f6c  adError,.    Col
+000001f0: 6c65 6374 696f 6e50 726f 7065 7274 6965  lectionPropertie
+00000200: 7345 7272 6f72 2c0a 2020 2020 436f 6c6c  sError,.    Coll
+00000210: 6563 7469 6f6e 5265 6361 6c63 756c 6174  ectionRecalculat
+00000220: 6543 6f75 6e74 4572 726f 722c 0a20 2020  eCountError,.   
+00000230: 2043 6f6c 6c65 6374 696f 6e52 656e 616d   CollectionRenam
+00000240: 6545 7272 6f72 2c0a 2020 2020 436f 6c6c  eError,.    Coll
+00000250: 6563 7469 6f6e 5265 7370 6f6e 7369 626c  ectionResponsibl
+00000260: 6553 6861 7264 4572 726f 722c 0a20 2020  eShardError,.   
+00000270: 2043 6f6c 6c65 6374 696f 6e52 6576 6973   CollectionRevis
+00000280: 696f 6e45 7272 6f72 2c0a 2020 2020 436f  ionError,.    Co
+00000290: 6c6c 6563 7469 6f6e 5368 6172 6473 4572  llectionShardsEr
+000002a0: 726f 722c 0a20 2020 2043 6f6c 6c65 6374  ror,.    Collect
+000002b0: 696f 6e53 7461 7469 7374 6963 7345 7272  ionStatisticsErr
+000002c0: 6f72 2c0a 2020 2020 436f 6c6c 6563 7469  or,.    Collecti
+000002d0: 6f6e 5472 756e 6361 7465 4572 726f 722c  onTruncateError,
+000002e0: 0a20 2020 2043 6f6c 6c65 6374 696f 6e55  .    CollectionU
+000002f0: 6e6c 6f61 6445 7272 6f72 2c0a 2020 2020  nloadError,.    
+00000300: 446f 6375 6d65 6e74 436f 756e 7445 7272  DocumentCountErr
+00000310: 6f72 2c0a 2020 2020 446f 6375 6d65 6e74  or,.    Document
+00000320: 4465 6c65 7465 4572 726f 722c 0a20 2020  DeleteError,.   
+00000330: 2044 6f63 756d 656e 7447 6574 4572 726f   DocumentGetErro
+00000340: 722c 0a20 2020 2044 6f63 756d 656e 7449  r,.    DocumentI
+00000350: 4473 4572 726f 722c 0a20 2020 2044 6f63  DsError,.    Doc
+00000360: 756d 656e 7449 6e45 7272 6f72 2c0a 2020  umentInError,.  
+00000370: 2020 446f 6375 6d65 6e74 496e 7365 7274    DocumentInsert
+00000380: 4572 726f 722c 0a20 2020 2044 6f63 756d  Error,.    Docum
+00000390: 656e 744b 6579 7345 7272 6f72 2c0a 2020  entKeysError,.  
+000003a0: 2020 446f 6375 6d65 6e74 5061 7273 6545    DocumentParseE
 000003b0: 7272 6f72 2c0a 2020 2020 446f 6375 6d65  rror,.    Docume
-000003c0: 6e74 5265 7669 7369 6f6e 4572 726f 722c  ntRevisionError,
-000003d0: 0a20 2020 2044 6f63 756d 656e 7455 7064  .    DocumentUpd
-000003e0: 6174 6545 7272 6f72 2c0a 2020 2020 4564  ateError,.    Ed
-000003f0: 6765 4c69 7374 4572 726f 722c 0a20 2020  geListError,.   
-00000400: 2049 6e64 6578 4372 6561 7465 4572 726f   IndexCreateErro
-00000410: 722c 0a20 2020 2049 6e64 6578 4465 6c65  r,.    IndexDele
-00000420: 7465 4572 726f 722c 0a20 2020 2049 6e64  teError,.    Ind
-00000430: 6578 4765 7445 7272 6f72 2c0a 2020 2020  exGetError,.    
-00000440: 496e 6465 784c 6973 7445 7272 6f72 2c0a  IndexListError,.
-00000450: 2020 2020 496e 6465 784c 6f61 6445 7272      IndexLoadErr
-00000460: 6f72 2c0a 2020 2020 496e 6465 784d 6973  or,.    IndexMis
-00000470: 7369 6e67 4572 726f 722c 0a29 0a66 726f  singError,.).fro
-00000480: 6d20 6172 616e 676f 2e65 7865 6375 746f  m arango.executo
-00000490: 7220 696d 706f 7274 2041 7069 4578 6563  r import ApiExec
-000004a0: 7574 6f72 0a66 726f 6d20 6172 616e 676f  utor.from arango
-000004b0: 2e66 6f72 6d61 7474 6572 2069 6d70 6f72  .formatter impor
-000004c0: 7420 666f 726d 6174 5f63 6f6c 6c65 6374  t format_collect
-000004d0: 696f 6e2c 2066 6f72 6d61 745f 6564 6765  ion, format_edge
-000004e0: 2c20 666f 726d 6174 5f69 6e64 6578 2c20  , format_index, 
-000004f0: 666f 726d 6174 5f76 6572 7465 780a 6672  format_vertex.fr
-00000500: 6f6d 2061 7261 6e67 6f2e 7265 7175 6573  om arango.reques
-00000510: 7420 696d 706f 7274 2052 6571 7565 7374  t import Request
-00000520: 0a66 726f 6d20 6172 616e 676f 2e72 6573  .from arango.res
-00000530: 706f 6e73 6520 696d 706f 7274 2052 6573  ponse import Res
-00000540: 706f 6e73 650a 6672 6f6d 2061 7261 6e67  ponse.from arang
-00000550: 6f2e 7265 7375 6c74 2069 6d70 6f72 7420  o.result import 
-00000560: 5265 7375 6c74 0a66 726f 6d20 6172 616e  Result.from aran
-00000570: 676f 2e74 7970 696e 6773 2069 6d70 6f72  go.typings impor
-00000580: 7420 4669 656c 6473 2c20 4865 6164 6572  t Fields, Header
-00000590: 732c 204a 736f 6e2c 204a 736f 6e73 2c20  s, Json, Jsons, 
-000005a0: 5061 7261 6d73 0a66 726f 6d20 6172 616e  Params.from aran
-000005b0: 676f 2e75 7469 6c73 2069 6d70 6f72 7420  go.utils import 
-000005c0: 280a 2020 2020 6275 696c 645f 6669 6c74  (.    build_filt
-000005d0: 6572 5f63 6f6e 6469 7469 6f6e 732c 0a20  er_conditions,. 
-000005e0: 2020 2067 6574 5f62 6174 6368 6573 2c0a     get_batches,.
-000005f0: 2020 2020 6765 745f 646f 635f 6964 2c0a      get_doc_id,.
-00000600: 2020 2020 6973 5f6e 6f6e 655f 6f72 5f62      is_none_or_b
-00000610: 6f6f 6c2c 0a20 2020 2069 735f 6e6f 6e65  ool,.    is_none
-00000620: 5f6f 725f 696e 742c 0a20 2020 2069 735f  _or_int,.    is_
-00000630: 6e6f 6e65 5f6f 725f 7374 722c 0a29 0a0a  none_or_str,.)..
-00000640: 0a63 6c61 7373 2043 6f6c 6c65 6374 696f  .class Collectio
-00000650: 6e28 4170 6947 726f 7570 293a 0a20 2020  n(ApiGroup):.   
-00000660: 2022 2222 4261 7365 2063 6c61 7373 2066   """Base class f
-00000670: 6f72 2063 6f6c 6c65 6374 696f 6e20 4150  or collection AP
-00000680: 4920 7772 6170 7065 7273 2e0a 0a20 2020  I wrappers...   
-00000690: 203a 7061 7261 6d20 636f 6e6e 6563 7469   :param connecti
-000006a0: 6f6e 3a20 4854 5450 2063 6f6e 6e65 6374  on: HTTP connect
-000006b0: 696f 6e2e 0a20 2020 203a 7061 7261 6d20  ion..    :param 
-000006c0: 6578 6563 7574 6f72 3a20 4150 4920 6578  executor: API ex
-000006d0: 6563 7574 6f72 2e0a 2020 2020 3a70 6172  ecutor..    :par
-000006e0: 616d 206e 616d 653a 2043 6f6c 6c65 6374  am name: Collect
-000006f0: 696f 6e20 6e61 6d65 2e0a 2020 2020 2222  ion name..    ""
-00000700: 220a 0a20 2020 2074 7970 6573 203d 207b  "..    types = {
-00000710: 323a 2022 646f 6375 6d65 6e74 222c 2033  2: "document", 3
-00000720: 3a20 2265 6467 6522 7d0a 0a20 2020 2073  : "edge"}..    s
-00000730: 7461 7475 7365 7320 3d20 7b0a 2020 2020  tatuses = {.    
-00000740: 2020 2020 313a 2022 6e65 7722 2c0a 2020      1: "new",.  
-00000750: 2020 2020 2020 323a 2022 756e 6c6f 6164        2: "unload
-00000760: 6564 222c 0a20 2020 2020 2020 2033 3a20  ed",.        3: 
-00000770: 226c 6f61 6465 6422 2c0a 2020 2020 2020  "loaded",.      
-00000780: 2020 343a 2022 756e 6c6f 6164 696e 6722    4: "unloading"
-00000790: 2c0a 2020 2020 2020 2020 353a 2022 6465  ,.        5: "de
-000007a0: 6c65 7465 6422 2c0a 2020 2020 2020 2020  leted",.        
-000007b0: 363a 2022 6c6f 6164 696e 6722 2c0a 2020  6: "loading",.  
-000007c0: 2020 7d0a 0a20 2020 2064 6566 205f 5f69    }..    def __i
-000007d0: 6e69 745f 5f28 0a20 2020 2020 2020 2073  nit__(.        s
-000007e0: 656c 662c 2063 6f6e 6e65 6374 696f 6e3a  elf, connection:
-000007f0: 2043 6f6e 6e65 6374 696f 6e2c 2065 7865   Connection, exe
-00000800: 6375 746f 723a 2041 7069 4578 6563 7574  cutor: ApiExecut
-00000810: 6f72 2c20 6e61 6d65 3a20 7374 720a 2020  or, name: str.  
-00000820: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-00000830: 2020 2020 2073 7570 6572 2829 2e5f 5f69       super().__i
-00000840: 6e69 745f 5f28 636f 6e6e 6563 7469 6f6e  nit__(connection
-00000850: 2c20 6578 6563 7574 6f72 290a 2020 2020  , executor).    
-00000860: 2020 2020 7365 6c66 2e5f 6e61 6d65 203d      self._name =
-00000870: 206e 616d 650a 2020 2020 2020 2020 7365   name.        se
-00000880: 6c66 2e5f 6964 5f70 7265 6669 7820 3d20  lf._id_prefix = 
-00000890: 6e61 6d65 202b 2022 2f22 0a0a 2020 2020  name + "/"..    
-000008a0: 6465 6620 5f5f 6974 6572 5f5f 2873 656c  def __iter__(sel
-000008b0: 6629 202d 3e20 5265 7375 6c74 5b43 7572  f) -> Result[Cur
-000008c0: 736f 725d 3a0a 2020 2020 2020 2020 7265  sor]:.        re
-000008d0: 7475 726e 2073 656c 662e 616c 6c28 290a  turn self.all().
-000008e0: 0a20 2020 2064 6566 205f 5f6c 656e 5f5f  .    def __len__
-000008f0: 2873 656c 6629 202d 3e20 5265 7375 6c74  (self) -> Result
-00000900: 5b69 6e74 5d3a 0a20 2020 2020 2020 2072  [int]:.        r
-00000910: 6574 7572 6e20 7365 6c66 2e63 6f75 6e74  eturn self.count
-00000920: 2829 0a0a 2020 2020 6465 6620 5f5f 636f  ()..    def __co
-00000930: 6e74 6169 6e73 5f5f 2873 656c 662c 2064  ntains__(self, d
-00000940: 6f63 756d 656e 743a 2055 6e69 6f6e 5b73  ocument: Union[s
-00000950: 7472 2c20 4a73 6f6e 5d29 202d 3e20 5265  tr, Json]) -> Re
-00000960: 7375 6c74 5b62 6f6f 6c5d 3a0a 2020 2020  sult[bool]:.    
-00000970: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00000980: 6861 7328 646f 6375 6d65 6e74 2c20 6368  has(document, ch
-00000990: 6563 6b5f 7265 763d 4661 6c73 6529 0a0a  eck_rev=False)..
-000009a0: 2020 2020 6465 6620 5f67 6574 5f73 7461      def _get_sta
-000009b0: 7475 735f 7465 7874 2873 656c 662c 2063  tus_text(self, c
-000009c0: 6f64 653a 2069 6e74 2920 2d3e 2073 7472  ode: int) -> str
-000009d0: 3a20 2023 2070 7261 676d 613a 206e 6f20  :  # pragma: no 
-000009e0: 636f 7665 720a 2020 2020 2020 2020 2222  cover.        ""
-000009f0: 2252 6574 7572 6e20 7468 6520 636f 6c6c  "Return the coll
-00000a00: 6563 7469 6f6e 2073 7461 7475 7320 7465  ection status te
-00000a10: 7874 2e0a 0a20 2020 2020 2020 203a 7061  xt...        :pa
-00000a20: 7261 6d20 636f 6465 3a20 436f 6c6c 6563  ram code: Collec
-00000a30: 7469 6f6e 2073 7461 7475 7320 636f 6465  tion status code
-00000a40: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
-00000a50: 636f 6465 3a20 696e 740a 2020 2020 2020  code: int.      
-00000a60: 2020 3a72 6574 7572 6e3a 2043 6f6c 6c65    :return: Colle
-00000a70: 6374 696f 6e20 7374 6174 7573 2074 6578  ction status tex
-00000a80: 7420 6f72 204e 6f6e 6520 6966 2063 6f64  t or None if cod
-00000a90: 6520 6973 204e 6f6e 652e 0a20 2020 2020  e is None..     
-00000aa0: 2020 203a 7274 7970 653a 2073 7472 0a20     :rtype: str. 
-00000ab0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00000ac0: 2020 2072 6574 7572 6e20 4e6f 6e65 2069     return None i
-00000ad0: 6620 636f 6465 2069 7320 4e6f 6e65 2065  f code is None e
-00000ae0: 6c73 6520 7365 6c66 2e73 7461 7475 7365  lse self.statuse
-00000af0: 735b 636f 6465 5d0a 0a20 2020 2064 6566  s[code]..    def
-00000b00: 205f 7661 6c69 6461 7465 5f69 6428 7365   _validate_id(se
-00000b10: 6c66 2c20 646f 635f 6964 3a20 7374 7229  lf, doc_id: str)
-00000b20: 202d 3e20 7374 723a 0a20 2020 2020 2020   -> str:.       
-00000b30: 2022 2222 4368 6563 6b20 7468 6520 636f   """Check the co
-00000b40: 6c6c 6563 7469 6f6e 206e 616d 6520 696e  llection name in
-00000b50: 2074 6865 2064 6f63 756d 656e 7420 4944   the document ID
-00000b60: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-00000b70: 6d20 646f 635f 6964 3a20 446f 6375 6d65  m doc_id: Docume
-00000b80: 6e74 2049 442e 0a20 2020 2020 2020 203a  nt ID..        :
-00000b90: 7479 7065 2064 6f63 5f69 643a 2073 7472  type doc_id: str
-00000ba0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-00000bb0: 3a20 5665 7269 6669 6564 2064 6f63 756d  : Verified docum
-00000bc0: 656e 7420 4944 2e0a 2020 2020 2020 2020  ent ID..        
-00000bd0: 3a72 7479 7065 3a20 7374 720a 2020 2020  :rtype: str.    
-00000be0: 2020 2020 3a72 6169 7365 2061 7261 6e67      :raise arang
-00000bf0: 6f2e 6578 6365 7074 696f 6e73 2e44 6f63  o.exceptions.Doc
-00000c00: 756d 656e 7450 6172 7365 4572 726f 723a  umentParseError:
-00000c10: 204f 6e20 6261 6420 636f 6c6c 6563 7469   On bad collecti
-00000c20: 6f6e 206e 616d 652e 0a20 2020 2020 2020  on name..       
-00000c30: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
-00000c40: 6e6f 7420 646f 635f 6964 2e73 7461 7274  not doc_id.start
-00000c50: 7377 6974 6828 7365 6c66 2e5f 6964 5f70  swith(self._id_p
-00000c60: 7265 6669 7829 3a0a 2020 2020 2020 2020  refix):.        
-00000c70: 2020 2020 7261 6973 6520 446f 6375 6d65      raise Docume
-00000c80: 6e74 5061 7273 6545 7272 6f72 2866 2762  ntParseError(f'b
-00000c90: 6164 2063 6f6c 6c65 6374 696f 6e20 6e61  ad collection na
-00000ca0: 6d65 2069 6e20 646f 6375 6d65 6e74 2049  me in document I
-00000cb0: 4420 227b 646f 635f 6964 7d22 2729 0a20  D "{doc_id}"'). 
-00000cc0: 2020 2020 2020 2072 6574 7572 6e20 646f         return do
-00000cd0: 635f 6964 0a0a 2020 2020 6465 6620 5f65  c_id..    def _e
-00000ce0: 7874 7261 6374 5f69 6428 7365 6c66 2c20  xtract_id(self, 
-00000cf0: 626f 6479 3a20 4a73 6f6e 2920 2d3e 2073  body: Json) -> s
-00000d00: 7472 3a0a 2020 2020 2020 2020 2222 2245  tr:.        """E
-00000d10: 7874 7261 6374 2074 6865 2064 6f63 756d  xtract the docum
-00000d20: 656e 7420 4944 2066 726f 6d20 646f 6375  ent ID from docu
-00000d30: 6d65 6e74 2062 6f64 792e 0a0a 2020 2020  ment body...    
-00000d40: 2020 2020 3a70 6172 616d 2062 6f64 793a      :param body:
-00000d50: 2044 6f63 756d 656e 7420 626f 6479 2e0a   Document body..
-00000d60: 2020 2020 2020 2020 3a74 7970 6520 626f          :type bo
-00000d70: 6479 3a20 6469 6374 0a20 2020 2020 2020  dy: dict.       
-00000d80: 203a 7265 7475 726e 3a20 446f 6375 6d65   :return: Docume
-00000d90: 6e74 2049 442e 0a20 2020 2020 2020 203a  nt ID..        :
-00000da0: 7274 7970 653a 2073 7472 0a20 2020 2020  rtype: str.     
-00000db0: 2020 203a 7261 6973 6520 6172 616e 676f     :raise arango
-00000dc0: 2e65 7863 6570 7469 6f6e 732e 446f 6375  .exceptions.Docu
-00000dd0: 6d65 6e74 5061 7273 6545 7272 6f72 3a20  mentParseError: 
-00000de0: 4f6e 206d 6973 7369 6e67 2049 4420 616e  On missing ID an
-00000df0: 6420 6b65 792e 0a20 2020 2020 2020 2022  d key..        "
-00000e00: 2222 0a20 2020 2020 2020 2074 7279 3a0a  "".        try:.
-00000e10: 2020 2020 2020 2020 2020 2020 6966 2022              if "
-00000e20: 5f69 6422 2069 6e20 626f 6479 3a0a 2020  _id" in body:.  
-00000e30: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00000e40: 7475 726e 2073 656c 662e 5f76 616c 6964  turn self._valid
-00000e50: 6174 655f 6964 2862 6f64 795b 225f 6964  ate_id(body["_id
-00000e60: 225d 290a 2020 2020 2020 2020 2020 2020  "]).            
-00000e70: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00000e80: 2020 2020 2020 6b65 793a 2073 7472 203d        key: str =
-00000e90: 2062 6f64 795b 225f 6b65 7922 5d0a 2020   body["_key"].  
-00000ea0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00000eb0: 7475 726e 2073 656c 662e 5f69 645f 7072  turn self._id_pr
-00000ec0: 6566 6978 202b 206b 6579 0a20 2020 2020  efix + key.     
-00000ed0: 2020 2065 7863 6570 7420 4b65 7945 7272     except KeyErr
-00000ee0: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
-00000ef0: 7261 6973 6520 446f 6375 6d65 6e74 5061  raise DocumentPa
-00000f00: 7273 6545 7272 6f72 2827 6669 656c 6420  rseError('field 
-00000f10: 225f 6b65 7922 206f 7220 225f 6964 2220  "_key" or "_id" 
-00000f20: 7265 7175 6972 6564 2729 0a0a 2020 2020  required')..    
-00000f30: 6465 6620 5f70 7265 705f 6672 6f6d 5f62  def _prep_from_b
-00000f40: 6f64 7928 7365 6c66 2c20 646f 6375 6d65  ody(self, docume
-00000f50: 6e74 3a20 4a73 6f6e 2c20 6368 6563 6b5f  nt: Json, check_
-00000f60: 7265 763a 2062 6f6f 6c29 202d 3e20 5475  rev: bool) -> Tu
-00000f70: 706c 655b 7374 722c 2048 6561 6465 7273  ple[str, Headers
-00000f80: 5d3a 0a20 2020 2020 2020 2022 2222 5072  ]:.        """Pr
-00000f90: 6570 6172 6520 646f 6375 6d65 6e74 2049  epare document I
-00000fa0: 4420 616e 6420 7265 7175 6573 7420 6865  D and request he
-00000fb0: 6164 6572 732e 0a0a 2020 2020 2020 2020  aders...        
-00000fc0: 3a70 6172 616d 2064 6f63 756d 656e 743a  :param document:
-00000fd0: 2044 6f63 756d 656e 7420 626f 6479 2e0a   Document body..
-00000fe0: 2020 2020 2020 2020 3a74 7970 6520 646f          :type do
-00000ff0: 6375 6d65 6e74 3a20 6469 6374 0a20 2020  cument: dict.   
-00001000: 2020 2020 203a 7061 7261 6d20 6368 6563       :param chec
-00001010: 6b5f 7265 763a 2057 6865 7468 6572 2074  k_rev: Whether t
-00001020: 6f20 6368 6563 6b20 7468 6520 7265 7669  o check the revi
-00001030: 7369 6f6e 2e0a 2020 2020 2020 2020 3a74  sion..        :t
-00001040: 7970 6520 6368 6563 6b5f 7265 763a 2062  ype check_rev: b
-00001050: 6f6f 6c0a 2020 2020 2020 2020 3a72 6574  ool.        :ret
-00001060: 7572 6e3a 2044 6f63 756d 656e 7420 4944  urn: Document ID
-00001070: 2061 6e64 2072 6571 7565 7374 2068 6561   and request hea
-00001080: 6465 7273 2e0a 2020 2020 2020 2020 3a72  ders..        :r
-00001090: 7479 7065 3a20 2873 7472 2c20 6469 6374  type: (str, dict
-000010a0: 290a 2020 2020 2020 2020 2222 220a 2020  ).        """.  
-000010b0: 2020 2020 2020 646f 635f 6964 203d 2073        doc_id = s
-000010c0: 656c 662e 5f65 7874 7261 6374 5f69 6428  elf._extract_id(
-000010d0: 646f 6375 6d65 6e74 290a 2020 2020 2020  document).      
-000010e0: 2020 6966 206e 6f74 2063 6865 636b 5f72    if not check_r
-000010f0: 6576 206f 7220 225f 7265 7622 206e 6f74  ev or "_rev" not
-00001100: 2069 6e20 646f 6375 6d65 6e74 3a0a 2020   in document:.  
-00001110: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00001120: 2064 6f63 5f69 642c 207b 7d0a 2020 2020   doc_id, {}.    
+000003c0: 6e74 5265 706c 6163 6545 7272 6f72 2c0a  ntReplaceError,.
+000003d0: 2020 2020 446f 6375 6d65 6e74 5265 7669      DocumentRevi
+000003e0: 7369 6f6e 4572 726f 722c 0a20 2020 2044  sionError,.    D
+000003f0: 6f63 756d 656e 7455 7064 6174 6545 7272  ocumentUpdateErr
+00000400: 6f72 2c0a 2020 2020 4564 6765 4c69 7374  or,.    EdgeList
+00000410: 4572 726f 722c 0a20 2020 2049 6e64 6578  Error,.    Index
+00000420: 4372 6561 7465 4572 726f 722c 0a20 2020  CreateError,.   
+00000430: 2049 6e64 6578 4465 6c65 7465 4572 726f   IndexDeleteErro
+00000440: 722c 0a20 2020 2049 6e64 6578 4765 7445  r,.    IndexGetE
+00000450: 7272 6f72 2c0a 2020 2020 496e 6465 784c  rror,.    IndexL
+00000460: 6973 7445 7272 6f72 2c0a 2020 2020 496e  istError,.    In
+00000470: 6465 784c 6f61 6445 7272 6f72 2c0a 2020  dexLoadError,.  
+00000480: 2020 496e 6465 784d 6973 7369 6e67 4572    IndexMissingEr
+00000490: 726f 722c 0a29 0a66 726f 6d20 6172 616e  ror,.).from aran
+000004a0: 676f 2e65 7865 6375 746f 7220 696d 706f  go.executor impo
+000004b0: 7274 2041 7069 4578 6563 7574 6f72 0a66  rt ApiExecutor.f
+000004c0: 726f 6d20 6172 616e 676f 2e66 6f72 6d61  rom arango.forma
+000004d0: 7474 6572 2069 6d70 6f72 7420 666f 726d  tter import form
+000004e0: 6174 5f63 6f6c 6c65 6374 696f 6e2c 2066  at_collection, f
+000004f0: 6f72 6d61 745f 6564 6765 2c20 666f 726d  ormat_edge, form
+00000500: 6174 5f69 6e64 6578 2c20 666f 726d 6174  at_index, format
+00000510: 5f76 6572 7465 780a 6672 6f6d 2061 7261  _vertex.from ara
+00000520: 6e67 6f2e 7265 7175 6573 7420 696d 706f  ngo.request impo
+00000530: 7274 2052 6571 7565 7374 0a66 726f 6d20  rt Request.from 
+00000540: 6172 616e 676f 2e72 6573 706f 6e73 6520  arango.response 
+00000550: 696d 706f 7274 2052 6573 706f 6e73 650a  import Response.
+00000560: 6672 6f6d 2061 7261 6e67 6f2e 7265 7375  from arango.resu
+00000570: 6c74 2069 6d70 6f72 7420 5265 7375 6c74  lt import Result
+00000580: 0a66 726f 6d20 6172 616e 676f 2e74 7970  .from arango.typ
+00000590: 696e 6773 2069 6d70 6f72 7420 4669 656c  ings import Fiel
+000005a0: 6473 2c20 4865 6164 6572 732c 204a 736f  ds, Headers, Jso
+000005b0: 6e2c 204a 736f 6e73 2c20 5061 7261 6d73  n, Jsons, Params
+000005c0: 0a66 726f 6d20 6172 616e 676f 2e75 7469  .from arango.uti
+000005d0: 6c73 2069 6d70 6f72 7420 280a 2020 2020  ls import (.    
+000005e0: 6275 696c 645f 6669 6c74 6572 5f63 6f6e  build_filter_con
+000005f0: 6469 7469 6f6e 732c 0a20 2020 2067 6574  ditions,.    get
+00000600: 5f62 6174 6368 6573 2c0a 2020 2020 6765  _batches,.    ge
+00000610: 745f 646f 635f 6964 2c0a 2020 2020 6973  t_doc_id,.    is
+00000620: 5f6e 6f6e 655f 6f72 5f62 6f6f 6c2c 0a20  _none_or_bool,. 
+00000630: 2020 2069 735f 6e6f 6e65 5f6f 725f 696e     is_none_or_in
+00000640: 742c 0a20 2020 2069 735f 6e6f 6e65 5f6f  t,.    is_none_o
+00000650: 725f 7374 722c 0a29 0a0a 0a63 6c61 7373  r_str,.)...class
+00000660: 2043 6f6c 6c65 6374 696f 6e28 4170 6947   Collection(ApiG
+00000670: 726f 7570 293a 0a20 2020 2022 2222 4261  roup):.    """Ba
+00000680: 7365 2063 6c61 7373 2066 6f72 2063 6f6c  se class for col
+00000690: 6c65 6374 696f 6e20 4150 4920 7772 6170  lection API wrap
+000006a0: 7065 7273 2e0a 0a20 2020 203a 7061 7261  pers...    :para
+000006b0: 6d20 636f 6e6e 6563 7469 6f6e 3a20 4854  m connection: HT
+000006c0: 5450 2063 6f6e 6e65 6374 696f 6e2e 0a20  TP connection.. 
+000006d0: 2020 203a 7061 7261 6d20 6578 6563 7574     :param execut
+000006e0: 6f72 3a20 4150 4920 6578 6563 7574 6f72  or: API executor
+000006f0: 2e0a 2020 2020 3a70 6172 616d 206e 616d  ..    :param nam
+00000700: 653a 2043 6f6c 6c65 6374 696f 6e20 6e61  e: Collection na
+00000710: 6d65 2e0a 2020 2020 2222 220a 0a20 2020  me..    """..   
+00000720: 2074 7970 6573 203d 207b 323a 2022 646f   types = {2: "do
+00000730: 6375 6d65 6e74 222c 2033 3a20 2265 6467  cument", 3: "edg
+00000740: 6522 7d0a 0a20 2020 2073 7461 7475 7365  e"}..    statuse
+00000750: 7320 3d20 7b0a 2020 2020 2020 2020 313a  s = {.        1:
+00000760: 2022 6e65 7722 2c0a 2020 2020 2020 2020   "new",.        
+00000770: 323a 2022 756e 6c6f 6164 6564 222c 0a20  2: "unloaded",. 
+00000780: 2020 2020 2020 2033 3a20 226c 6f61 6465         3: "loade
+00000790: 6422 2c0a 2020 2020 2020 2020 343a 2022  d",.        4: "
+000007a0: 756e 6c6f 6164 696e 6722 2c0a 2020 2020  unloading",.    
+000007b0: 2020 2020 353a 2022 6465 6c65 7465 6422      5: "deleted"
+000007c0: 2c0a 2020 2020 2020 2020 363a 2022 6c6f  ,.        6: "lo
+000007d0: 6164 696e 6722 2c0a 2020 2020 7d0a 0a20  ading",.    }.. 
+000007e0: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
+000007f0: 0a20 2020 2020 2020 2073 656c 662c 2063  .        self, c
+00000800: 6f6e 6e65 6374 696f 6e3a 2043 6f6e 6e65  onnection: Conne
+00000810: 6374 696f 6e2c 2065 7865 6375 746f 723a  ction, executor:
+00000820: 2041 7069 4578 6563 7574 6f72 2c20 6e61   ApiExecutor, na
+00000830: 6d65 3a20 7374 720a 2020 2020 2920 2d3e  me: str.    ) ->
+00000840: 204e 6f6e 653a 0a20 2020 2020 2020 2073   None:.        s
+00000850: 7570 6572 2829 2e5f 5f69 6e69 745f 5f28  uper().__init__(
+00000860: 636f 6e6e 6563 7469 6f6e 2c20 6578 6563  connection, exec
+00000870: 7574 6f72 290a 2020 2020 2020 2020 7365  utor).        se
+00000880: 6c66 2e5f 6e61 6d65 203d 206e 616d 650a  lf._name = name.
+00000890: 2020 2020 2020 2020 7365 6c66 2e5f 6964          self._id
+000008a0: 5f70 7265 6669 7820 3d20 6e61 6d65 202b  _prefix = name +
+000008b0: 2022 2f22 0a0a 2020 2020 6465 6620 5f5f   "/"..    def __
+000008c0: 6974 6572 5f5f 2873 656c 6629 202d 3e20  iter__(self) -> 
+000008d0: 5265 7375 6c74 5b43 7572 736f 725d 3a0a  Result[Cursor]:.
+000008e0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000008f0: 656c 662e 616c 6c28 290a 0a20 2020 2064  elf.all()..    d
+00000900: 6566 205f 5f6c 656e 5f5f 2873 656c 6629  ef __len__(self)
+00000910: 202d 3e20 5265 7375 6c74 5b69 6e74 5d3a   -> Result[int]:
+00000920: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00000930: 7365 6c66 2e63 6f75 6e74 2829 0a0a 2020  self.count()..  
+00000940: 2020 6465 6620 5f5f 636f 6e74 6169 6e73    def __contains
+00000950: 5f5f 2873 656c 662c 2064 6f63 756d 656e  __(self, documen
+00000960: 743a 2055 6e69 6f6e 5b73 7472 2c20 4a73  t: Union[str, Js
+00000970: 6f6e 5d29 202d 3e20 5265 7375 6c74 5b62  on]) -> Result[b
+00000980: 6f6f 6c5d 3a0a 2020 2020 2020 2020 7265  ool]:.        re
+00000990: 7475 726e 2073 656c 662e 6861 7328 646f  turn self.has(do
+000009a0: 6375 6d65 6e74 2c20 6368 6563 6b5f 7265  cument, check_re
+000009b0: 763d 4661 6c73 6529 0a0a 2020 2020 6465  v=False)..    de
+000009c0: 6620 5f67 6574 5f73 7461 7475 735f 7465  f _get_status_te
+000009d0: 7874 2873 656c 662c 2063 6f64 653a 2069  xt(self, code: i
+000009e0: 6e74 2920 2d3e 2073 7472 3a20 2023 2070  nt) -> str:  # p
+000009f0: 7261 676d 613a 206e 6f20 636f 7665 720a  ragma: no cover.
+00000a00: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+00000a10: 6e20 7468 6520 636f 6c6c 6563 7469 6f6e  n the collection
+00000a20: 2073 7461 7475 7320 7465 7874 2e0a 0a20   status text... 
+00000a30: 2020 2020 2020 203a 7061 7261 6d20 636f         :param co
+00000a40: 6465 3a20 436f 6c6c 6563 7469 6f6e 2073  de: Collection s
+00000a50: 7461 7475 7320 636f 6465 2e0a 2020 2020  tatus code..    
+00000a60: 2020 2020 3a74 7970 6520 636f 6465 3a20      :type code: 
+00000a70: 696e 740a 2020 2020 2020 2020 3a72 6574  int.        :ret
+00000a80: 7572 6e3a 2043 6f6c 6c65 6374 696f 6e20  urn: Collection 
+00000a90: 7374 6174 7573 2074 6578 7420 6f72 204e  status text or N
+00000aa0: 6f6e 6520 6966 2063 6f64 6520 6973 204e  one if code is N
+00000ab0: 6f6e 652e 0a20 2020 2020 2020 203a 7274  one..        :rt
+00000ac0: 7970 653a 2073 7472 0a20 2020 2020 2020  ype: str.       
+00000ad0: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
+00000ae0: 7572 6e20 4e6f 6e65 2069 6620 636f 6465  urn None if code
+00000af0: 2069 7320 4e6f 6e65 2065 6c73 6520 7365   is None else se
+00000b00: 6c66 2e73 7461 7475 7365 735b 636f 6465  lf.statuses[code
+00000b10: 5d0a 0a20 2020 2064 6566 205f 7661 6c69  ]..    def _vali
+00000b20: 6461 7465 5f69 6428 7365 6c66 2c20 646f  date_id(self, do
+00000b30: 635f 6964 3a20 7374 7229 202d 3e20 7374  c_id: str) -> st
+00000b40: 723a 0a20 2020 2020 2020 2022 2222 4368  r:.        """Ch
+00000b50: 6563 6b20 7468 6520 636f 6c6c 6563 7469  eck the collecti
+00000b60: 6f6e 206e 616d 6520 696e 2074 6865 2064  on name in the d
+00000b70: 6f63 756d 656e 7420 4944 2e0a 0a20 2020  ocument ID...   
+00000b80: 2020 2020 203a 7061 7261 6d20 646f 635f       :param doc_
+00000b90: 6964 3a20 446f 6375 6d65 6e74 2049 442e  id: Document ID.
+00000ba0: 0a20 2020 2020 2020 203a 7479 7065 2064  .        :type d
+00000bb0: 6f63 5f69 643a 2073 7472 0a20 2020 2020  oc_id: str.     
+00000bc0: 2020 203a 7265 7475 726e 3a20 5665 7269     :return: Veri
+00000bd0: 6669 6564 2064 6f63 756d 656e 7420 4944  fied document ID
+00000be0: 2e0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
+00000bf0: 3a20 7374 720a 2020 2020 2020 2020 3a72  : str.        :r
+00000c00: 6169 7365 2061 7261 6e67 6f2e 6578 6365  aise arango.exce
+00000c10: 7074 696f 6e73 2e44 6f63 756d 656e 7450  ptions.DocumentP
+00000c20: 6172 7365 4572 726f 723a 204f 6e20 6261  arseError: On ba
+00000c30: 6420 636f 6c6c 6563 7469 6f6e 206e 616d  d collection nam
+00000c40: 652e 0a20 2020 2020 2020 2022 2222 0a20  e..        """. 
+00000c50: 2020 2020 2020 2069 6620 6e6f 7420 646f         if not do
+00000c60: 635f 6964 2e73 7461 7274 7377 6974 6828  c_id.startswith(
+00000c70: 7365 6c66 2e5f 6964 5f70 7265 6669 7829  self._id_prefix)
+00000c80: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00000c90: 6973 6520 446f 6375 6d65 6e74 5061 7273  ise DocumentPars
+00000ca0: 6545 7272 6f72 2866 2762 6164 2063 6f6c  eError(f'bad col
+00000cb0: 6c65 6374 696f 6e20 6e61 6d65 2069 6e20  lection name in 
+00000cc0: 646f 6375 6d65 6e74 2049 4420 227b 646f  document ID "{do
+00000cd0: 635f 6964 7d22 2729 0a20 2020 2020 2020  c_id}"').       
+00000ce0: 2072 6574 7572 6e20 646f 635f 6964 0a0a   return doc_id..
+00000cf0: 2020 2020 6465 6620 5f65 7874 7261 6374      def _extract
+00000d00: 5f69 6428 7365 6c66 2c20 626f 6479 3a20  _id(self, body: 
+00000d10: 4a73 6f6e 2920 2d3e 2073 7472 3a0a 2020  Json) -> str:.  
+00000d20: 2020 2020 2020 2222 2245 7874 7261 6374        """Extract
+00000d30: 2074 6865 2064 6f63 756d 656e 7420 4944   the document ID
+00000d40: 2066 726f 6d20 646f 6375 6d65 6e74 2062   from document b
+00000d50: 6f64 792e 0a0a 2020 2020 2020 2020 3a70  ody...        :p
+00000d60: 6172 616d 2062 6f64 793a 2044 6f63 756d  aram body: Docum
+00000d70: 656e 7420 626f 6479 2e0a 2020 2020 2020  ent body..      
+00000d80: 2020 3a74 7970 6520 626f 6479 3a20 6469    :type body: di
+00000d90: 6374 0a20 2020 2020 2020 203a 7265 7475  ct.        :retu
+00000da0: 726e 3a20 446f 6375 6d65 6e74 2049 442e  rn: Document ID.
+00000db0: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
+00000dc0: 2073 7472 0a20 2020 2020 2020 203a 7261   str.        :ra
+00000dd0: 6973 6520 6172 616e 676f 2e65 7863 6570  ise arango.excep
+00000de0: 7469 6f6e 732e 446f 6375 6d65 6e74 5061  tions.DocumentPa
+00000df0: 7273 6545 7272 6f72 3a20 4f6e 206d 6973  rseError: On mis
+00000e00: 7369 6e67 2049 4420 616e 6420 6b65 792e  sing ID and key.
+00000e10: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00000e20: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+00000e30: 2020 2020 2020 6966 2022 5f69 6422 2069        if "_id" i
+00000e40: 6e20 626f 6479 3a0a 2020 2020 2020 2020  n body:.        
+00000e50: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00000e60: 656c 662e 5f76 616c 6964 6174 655f 6964  elf._validate_id
+00000e70: 2862 6f64 795b 225f 6964 225d 290a 2020  (body["_id"]).  
+00000e80: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00000e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000ea0: 6b65 793a 2073 7472 203d 2062 6f64 795b  key: str = body[
+00000eb0: 225f 6b65 7922 5d0a 2020 2020 2020 2020  "_key"].        
+00000ec0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00000ed0: 656c 662e 5f69 645f 7072 6566 6978 202b  elf._id_prefix +
+00000ee0: 206b 6579 0a20 2020 2020 2020 2065 7863   key.        exc
+00000ef0: 6570 7420 4b65 7945 7272 6f72 3a0a 2020  ept KeyError:.  
+00000f00: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00000f10: 446f 6375 6d65 6e74 5061 7273 6545 7272  DocumentParseErr
+00000f20: 6f72 2827 6669 656c 6420 225f 6b65 7922  or('field "_key"
+00000f30: 206f 7220 225f 6964 2220 7265 7175 6972   or "_id" requir
+00000f40: 6564 2729 0a0a 2020 2020 6465 6620 5f70  ed')..    def _p
+00000f50: 7265 705f 6672 6f6d 5f62 6f64 7928 7365  rep_from_body(se
+00000f60: 6c66 2c20 646f 6375 6d65 6e74 3a20 4a73  lf, document: Js
+00000f70: 6f6e 2c20 6368 6563 6b5f 7265 763a 2062  on, check_rev: b
+00000f80: 6f6f 6c29 202d 3e20 5475 706c 655b 7374  ool) -> Tuple[st
+00000f90: 722c 2048 6561 6465 7273 5d3a 0a20 2020  r, Headers]:.   
+00000fa0: 2020 2020 2022 2222 5072 6570 6172 6520       """Prepare 
+00000fb0: 646f 6375 6d65 6e74 2049 4420 616e 6420  document ID and 
+00000fc0: 7265 7175 6573 7420 6865 6164 6572 732e  request headers.
+00000fd0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00000fe0: 2064 6f63 756d 656e 743a 2044 6f63 756d   document: Docum
+00000ff0: 656e 7420 626f 6479 2e0a 2020 2020 2020  ent body..      
+00001000: 2020 3a74 7970 6520 646f 6375 6d65 6e74    :type document
+00001010: 3a20 6469 6374 0a20 2020 2020 2020 203a  : dict.        :
+00001020: 7061 7261 6d20 6368 6563 6b5f 7265 763a  param check_rev:
+00001030: 2057 6865 7468 6572 2074 6f20 6368 6563   Whether to chec
+00001040: 6b20 7468 6520 7265 7669 7369 6f6e 2e0a  k the revision..
+00001050: 2020 2020 2020 2020 3a74 7970 6520 6368          :type ch
+00001060: 6563 6b5f 7265 763a 2062 6f6f 6c0a 2020  eck_rev: bool.  
+00001070: 2020 2020 2020 3a72 6574 7572 6e3a 2044        :return: D
+00001080: 6f63 756d 656e 7420 4944 2061 6e64 2072  ocument ID and r
+00001090: 6571 7565 7374 2068 6561 6465 7273 2e0a  equest headers..
+000010a0: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
+000010b0: 2873 7472 2c20 6469 6374 290a 2020 2020  (str, dict).    
+000010c0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000010d0: 646f 635f 6964 203d 2073 656c 662e 5f65  doc_id = self._e
+000010e0: 7874 7261 6374 5f69 6428 646f 6375 6d65  xtract_id(docume
+000010f0: 6e74 290a 2020 2020 2020 2020 6966 206e  nt).        if n
+00001100: 6f74 2063 6865 636b 5f72 6576 206f 7220  ot check_rev or 
+00001110: 225f 7265 7622 206e 6f74 2069 6e20 646f  "_rev" not in do
+00001120: 6375 6d65 6e74 3a0a 2020 2020 2020 2020  cument:.        
 00001130: 2020 2020 7265 7475 726e 2064 6f63 5f69      return doc_i
-00001140: 642c 207b 2249 662d 4d61 7463 6822 3a20  d, {"If-Match": 
-00001150: 646f 6375 6d65 6e74 5b22 5f72 6576 225d  document["_rev"]
-00001160: 7d0a 0a20 2020 2064 6566 205f 7072 6570  }..    def _prep
-00001170: 5f66 726f 6d5f 646f 6328 0a20 2020 2020  _from_doc(.     
-00001180: 2020 2073 656c 662c 2064 6f63 756d 656e     self, documen
-00001190: 743a 2055 6e69 6f6e 5b73 7472 2c20 4a73  t: Union[str, Js
-000011a0: 6f6e 5d2c 2072 6576 3a20 4f70 7469 6f6e  on], rev: Option
-000011b0: 616c 5b73 7472 5d2c 2063 6865 636b 5f72  al[str], check_r
-000011c0: 6576 3a20 626f 6f6c 0a20 2020 2029 202d  ev: bool.    ) -
-000011d0: 3e20 5475 706c 655b 7374 722c 2055 6e69  > Tuple[str, Uni
-000011e0: 6f6e 5b73 7472 2c20 4a73 6f6e 5d2c 204a  on[str, Json], J
-000011f0: 736f 6e5d 3a0a 2020 2020 2020 2020 2222  son]:.        ""
-00001200: 2250 7265 7061 7265 2064 6f63 756d 656e  "Prepare documen
-00001210: 7420 4944 2c20 626f 6479 2061 6e64 2072  t ID, body and r
-00001220: 6571 7565 7374 2068 6561 6465 7273 2e0a  equest headers..
-00001230: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00001240: 646f 6375 6d65 6e74 3a20 446f 6375 6d65  document: Docume
-00001250: 6e74 2049 442c 206b 6579 206f 7220 626f  nt ID, key or bo
-00001260: 6479 2e0a 2020 2020 2020 2020 3a74 7970  dy..        :typ
-00001270: 6520 646f 6375 6d65 6e74 3a20 7374 7220  e document: str 
-00001280: 7c20 6469 6374 0a20 2020 2020 2020 203a  | dict.        :
-00001290: 7061 7261 6d20 7265 763a 2044 6f63 756d  param rev: Docum
-000012a0: 656e 7420 7265 7669 7369 6f6e 206f 7220  ent revision or 
-000012b0: 4e6f 6e65 2e0a 2020 2020 2020 2020 3a74  None..        :t
-000012c0: 7970 6520 7265 763a 2073 7472 207c 204e  ype rev: str | N
-000012d0: 6f6e 650a 2020 2020 2020 2020 3a70 6172  one.        :par
-000012e0: 616d 2063 6865 636b 5f72 6576 3a20 5768  am check_rev: Wh
-000012f0: 6574 6865 7220 746f 2063 6865 636b 2074  ether to check t
-00001300: 6865 2072 6576 6973 696f 6e2e 0a20 2020  he revision..   
-00001310: 2020 2020 203a 7479 7065 2063 6865 636b       :type check
-00001320: 5f72 6576 3a20 626f 6f6c 0a20 2020 2020  _rev: bool.     
-00001330: 2020 203a 7265 7475 726e 3a20 446f 6375     :return: Docu
-00001340: 6d65 6e74 2049 442c 2062 6f64 7920 616e  ment ID, body an
-00001350: 6420 7265 7175 6573 7420 6865 6164 6572  d request header
-00001360: 732e 0a20 2020 2020 2020 203a 7274 7970  s..        :rtyp
-00001370: 653a 2028 7374 722c 2073 7472 207c 2062  e: (str, str | b
-00001380: 6f64 792c 2064 6963 7429 0a20 2020 2020  ody, dict).     
-00001390: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-000013a0: 6620 6973 696e 7374 616e 6365 2864 6f63  f isinstance(doc
-000013b0: 756d 656e 742c 2064 6963 7429 3a0a 2020  ument, dict):.  
-000013c0: 2020 2020 2020 2020 2020 646f 635f 6964            doc_id
-000013d0: 203d 2073 656c 662e 5f65 7874 7261 6374   = self._extract
-000013e0: 5f69 6428 646f 6375 6d65 6e74 290a 2020  _id(document).  
-000013f0: 2020 2020 2020 2020 2020 7265 7620 3d20            rev = 
-00001400: 7265 7620 6f72 2064 6f63 756d 656e 742e  rev or document.
-00001410: 6765 7428 225f 7265 7622 290a 0a20 2020  get("_rev")..   
-00001420: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-00001430: 6368 6563 6b5f 7265 7620 6f72 2072 6576  check_rev or rev
-00001440: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-00001450: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00001460: 2064 6f63 5f69 642c 2064 6f63 5f69 642c   doc_id, doc_id,
-00001470: 207b 7d0a 2020 2020 2020 2020 2020 2020   {}.            
-00001480: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00001490: 2020 2020 2020 7265 7475 726e 2064 6f63        return doc
-000014a0: 5f69 642c 2064 6f63 5f69 642c 207b 2249  _id, doc_id, {"I
-000014b0: 662d 4d61 7463 6822 3a20 7265 767d 0a20  f-Match": rev}. 
-000014c0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000014d0: 2020 2020 2020 2020 2069 6620 222f 2220           if "/" 
-000014e0: 696e 2064 6f63 756d 656e 743a 0a20 2020  in document:.   
-000014f0: 2020 2020 2020 2020 2020 2020 2064 6f63               doc
-00001500: 5f69 6420 3d20 7365 6c66 2e5f 7661 6c69  _id = self._vali
-00001510: 6461 7465 5f69 6428 646f 6375 6d65 6e74  date_id(document
-00001520: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-00001530: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00001540: 2020 2020 646f 635f 6964 203d 2073 656c      doc_id = sel
-00001550: 662e 5f69 645f 7072 6566 6978 202b 2064  f._id_prefix + d
-00001560: 6f63 756d 656e 740a 0a20 2020 2020 2020  ocument..       
-00001570: 2020 2020 2069 6620 6e6f 7420 6368 6563       if not chec
-00001580: 6b5f 7265 7620 6f72 2072 6576 2069 7320  k_rev or rev is 
-00001590: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-000015a0: 2020 2020 2020 7265 7475 726e 2064 6f63        return doc
-000015b0: 5f69 642c 2064 6f63 5f69 642c 207b 7d0a  _id, doc_id, {}.
-000015c0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-000015d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000015e0: 2020 7265 7475 726e 2064 6f63 5f69 642c    return doc_id,
-000015f0: 2064 6f63 5f69 642c 207b 2249 662d 4d61   doc_id, {"If-Ma
-00001600: 7463 6822 3a20 7265 767d 0a0a 2020 2020  tch": rev}..    
-00001610: 6465 6620 5f65 6e73 7572 655f 6b65 795f  def _ensure_key_
-00001620: 696e 5f62 6f64 7928 7365 6c66 2c20 626f  in_body(self, bo
-00001630: 6479 3a20 4a73 6f6e 2920 2d3e 204a 736f  dy: Json) -> Jso
-00001640: 6e3a 0a20 2020 2020 2020 2022 2222 5265  n:.        """Re
-00001650: 7475 726e 2074 6865 2064 6f63 756d 656e  turn the documen
-00001660: 7420 626f 6479 2077 6974 6820 225f 6b65  t body with "_ke
-00001670: 7922 2066 6965 6c64 2070 6f70 756c 6174  y" field populat
-00001680: 6564 2e0a 0a20 2020 2020 2020 203a 7061  ed...        :pa
-00001690: 7261 6d20 626f 6479 3a20 446f 6375 6d65  ram body: Docume
-000016a0: 6e74 2062 6f64 792e 0a20 2020 2020 2020  nt body..       
-000016b0: 203a 7479 7065 2062 6f64 793a 2064 6963   :type body: dic
-000016c0: 740a 2020 2020 2020 2020 3a72 6574 7572  t.        :retur
-000016d0: 6e3a 2044 6f63 756d 656e 7420 626f 6479  n: Document body
-000016e0: 2077 6974 6820 225f 6b65 7922 2066 6965   with "_key" fie
-000016f0: 6c64 2e0a 2020 2020 2020 2020 3a72 7479  ld..        :rty
-00001700: 7065 3a20 6469 6374 0a20 2020 2020 2020  pe: dict.       
-00001710: 203a 7261 6973 6520 6172 616e 676f 2e65   :raise arango.e
-00001720: 7863 6570 7469 6f6e 732e 446f 6375 6d65  xceptions.Docume
-00001730: 6e74 5061 7273 6545 7272 6f72 3a20 4f6e  ntParseError: On
-00001740: 206d 6973 7369 6e67 2049 4420 616e 6420   missing ID and 
-00001750: 6b65 792e 0a20 2020 2020 2020 2022 2222  key..        """
-00001760: 0a20 2020 2020 2020 2069 6620 225f 6b65  .        if "_ke
-00001770: 7922 2069 6e20 626f 6479 3a0a 2020 2020  y" in body:.    
-00001780: 2020 2020 2020 2020 7265 7475 726e 2062          return b
-00001790: 6f64 790a 2020 2020 2020 2020 656c 6966  ody.        elif
-000017a0: 2022 5f69 6422 2069 6e20 626f 6479 3a0a   "_id" in body:.
-000017b0: 2020 2020 2020 2020 2020 2020 646f 635f              doc_
-000017c0: 6964 203d 2073 656c 662e 5f76 616c 6964  id = self._valid
-000017d0: 6174 655f 6964 2862 6f64 795b 225f 6964  ate_id(body["_id
-000017e0: 225d 290a 2020 2020 2020 2020 2020 2020  "]).            
-000017f0: 626f 6479 203d 2062 6f64 792e 636f 7079  body = body.copy
-00001800: 2829 0a20 2020 2020 2020 2020 2020 2062  ().            b
-00001810: 6f64 795b 225f 6b65 7922 5d20 3d20 646f  ody["_key"] = do
-00001820: 635f 6964 5b6c 656e 2873 656c 662e 5f69  c_id[len(self._i
-00001830: 645f 7072 6566 6978 2920 3a5d 0a20 2020  d_prefix) :].   
-00001840: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00001850: 626f 6479 0a20 2020 2020 2020 2072 6169  body.        rai
-00001860: 7365 2044 6f63 756d 656e 7450 6172 7365  se DocumentParse
-00001870: 4572 726f 7228 2766 6965 6c64 2022 5f6b  Error('field "_k
-00001880: 6579 2220 6f72 2022 5f69 6422 2072 6571  ey" or "_id" req
-00001890: 7569 7265 6427 290a 0a20 2020 2064 6566  uired')..    def
-000018a0: 205f 656e 7375 7265 5f6b 6579 5f66 726f   _ensure_key_fro
-000018b0: 6d5f 6964 2873 656c 662c 2062 6f64 793a  m_id(self, body:
-000018c0: 204a 736f 6e29 202d 3e20 4a73 6f6e 3a0a   Json) -> Json:.
-000018d0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-000018e0: 6e20 7468 6520 626f 6479 2077 6974 6820  n the body with 
-000018f0: 225f 6b65 7922 2066 6965 6c64 2069 6620  "_key" field if 
-00001900: 6974 2068 6173 2022 5f69 6422 2066 6965  it has "_id" fie
-00001910: 6c64 2e0a 0a20 2020 2020 2020 203a 7061  ld...        :pa
-00001920: 7261 6d20 626f 6479 3a20 446f 6375 6d65  ram body: Docume
-00001930: 6e74 2062 6f64 792e 0a20 2020 2020 2020  nt body..       
-00001940: 203a 7479 7065 2062 6f64 793a 2064 6963   :type body: dic
-00001950: 740a 2020 2020 2020 2020 3a72 6574 7572  t.        :retur
-00001960: 6e3a 2044 6f63 756d 656e 7420 626f 6479  n: Document body
-00001970: 2077 6974 6820 225f 6b65 7922 2066 6965   with "_key" fie
-00001980: 6c64 2069 6620 6974 2068 6173 2022 5f69  ld if it has "_i
-00001990: 6422 2066 6965 6c64 2e0a 2020 2020 2020  d" field..      
-000019a0: 2020 3a72 7479 7065 3a20 6469 6374 0a20    :rtype: dict. 
-000019b0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000019c0: 2020 2069 6620 225f 6964 2220 696e 2062     if "_id" in b
-000019d0: 6f64 7920 616e 6420 225f 6b65 7922 206e  ody and "_key" n
-000019e0: 6f74 2069 6e20 626f 6479 3a0a 2020 2020  ot in body:.    
-000019f0: 2020 2020 2020 2020 646f 635f 6964 203d          doc_id =
-00001a00: 2073 656c 662e 5f76 616c 6964 6174 655f   self._validate_
-00001a10: 6964 2862 6f64 795b 225f 6964 225d 290a  id(body["_id"]).
-00001a20: 2020 2020 2020 2020 2020 2020 626f 6479              body
-00001a30: 203d 2062 6f64 792e 636f 7079 2829 0a20   = body.copy(). 
-00001a40: 2020 2020 2020 2020 2020 2062 6f64 795b             body[
-00001a50: 225f 6b65 7922 5d20 3d20 646f 635f 6964  "_key"] = doc_id
-00001a60: 5b6c 656e 2873 656c 662e 5f69 645f 7072  [len(self._id_pr
-00001a70: 6566 6978 2920 3a5d 0a20 2020 2020 2020  efix) :].       
-00001a80: 2072 6574 7572 6e20 626f 6479 0a0a 2020   return body..  
-00001a90: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-00001aa0: 6465 6620 6e61 6d65 2873 656c 6629 202d  def name(self) -
-00001ab0: 3e20 7374 723a 0a20 2020 2020 2020 2022  > str:.        "
-00001ac0: 2222 5265 7475 726e 2063 6f6c 6c65 6374  ""Return collect
-00001ad0: 696f 6e20 6e61 6d65 2e0a 0a20 2020 2020  ion name...     
-00001ae0: 2020 203a 7265 7475 726e 3a20 436f 6c6c     :return: Coll
-00001af0: 6563 7469 6f6e 206e 616d 652e 0a20 2020  ection name..   
-00001b00: 2020 2020 203a 7274 7970 653a 2073 7472       :rtype: str
-00001b10: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00001b20: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00001b30: 2e5f 6e61 6d65 0a0a 2020 2020 6465 6620  ._name..    def 
-00001b40: 7265 6361 6c63 756c 6174 655f 636f 756e  recalculate_coun
-00001b50: 7428 7365 6c66 2920 2d3e 2052 6573 756c  t(self) -> Resul
-00001b60: 745b 626f 6f6c 5d3a 0a20 2020 2020 2020  t[bool]:.       
-00001b70: 2022 2222 5265 6361 6c63 756c 6174 6520   """Recalculate 
-00001b80: 7468 6520 646f 6375 6d65 6e74 2063 6f75  the document cou
-00001b90: 6e74 2e0a 0a20 2020 2020 2020 203a 7265  nt...        :re
-00001ba0: 7475 726e 3a20 5472 7565 2069 6620 7265  turn: True if re
-00001bb0: 6361 6c63 756c 6174 696f 6e20 7761 7320  calculation was 
-00001bc0: 7375 6363 6573 7366 756c 2e0a 2020 2020  successful..    
-00001bd0: 2020 2020 3a72 7479 7065 3a20 626f 6f6c      :rtype: bool
-00001be0: 0a20 2020 2020 2020 203a 7261 6973 6520  .        :raise 
-00001bf0: 6172 616e 676f 2e65 7863 6570 7469 6f6e  arango.exception
-00001c00: 732e 436f 6c6c 6563 7469 6f6e 5265 6361  s.CollectionReca
-00001c10: 6c63 756c 6174 6543 6f75 6e74 4572 726f  lculateCountErro
-00001c20: 723a 2049 6620 6f70 6572 6174 696f 6e20  r: If operation 
-00001c30: 6661 696c 732e 0a20 2020 2020 2020 2022  fails..        "
-00001c40: 2222 0a20 2020 2020 2020 2072 6571 7565  "".        reque
-00001c50: 7374 203d 2052 6571 7565 7374 280a 2020  st = Request(.  
-00001c60: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
-00001c70: 3d22 7075 7422 2c0a 2020 2020 2020 2020  ="put",.        
-00001c80: 2020 2020 656e 6470 6f69 6e74 3d66 222f      endpoint=f"/
-00001c90: 5f61 7069 2f63 6f6c 6c65 6374 696f 6e2f  _api/collection/
-00001ca0: 7b73 656c 662e 6e61 6d65 7d2f 7265 6361  {self.name}/reca
-00001cb0: 6c63 756c 6174 6543 6f75 6e74 222c 0a20  lculateCount",. 
-00001cc0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00001cd0: 2020 6465 6620 7265 7370 6f6e 7365 5f68    def response_h
-00001ce0: 616e 646c 6572 2872 6573 703a 2052 6573  andler(resp: Res
-00001cf0: 706f 6e73 6529 202d 3e20 626f 6f6c 3a0a  ponse) -> bool:.
-00001d00: 2020 2020 2020 2020 2020 2020 6966 2072              if r
-00001d10: 6573 702e 6973 5f73 7563 6365 7373 3a0a  esp.is_success:.
-00001d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001d30: 7265 7475 726e 2054 7275 650a 2020 2020  return True.    
-00001d40: 2020 2020 2020 2020 7261 6973 6520 436f          raise Co
-00001d50: 6c6c 6563 7469 6f6e 5265 6361 6c63 756c  llectionRecalcul
-00001d60: 6174 6543 6f75 6e74 4572 726f 7228 7265  ateCountError(re
-00001d70: 7370 2c20 7265 7175 6573 7429 0a0a 2020  sp, request)..  
-00001d80: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00001d90: 662e 5f65 7865 6375 7465 2872 6571 7565  f._execute(reque
-00001da0: 7374 2c20 7265 7370 6f6e 7365 5f68 616e  st, response_han
-00001db0: 646c 6572 290a 0a20 2020 2064 6566 2072  dler)..    def r
-00001dc0: 6573 706f 6e73 6962 6c65 5f73 6861 7264  esponsible_shard
-00001dd0: 2873 656c 662c 2064 6f63 756d 656e 743a  (self, document:
-00001de0: 204a 736f 6e29 202d 3e20 5265 7375 6c74   Json) -> Result
-00001df0: 5b73 7472 5d3a 2020 2320 7072 6167 6d61  [str]:  # pragma
-00001e00: 3a20 6e6f 2063 6f76 6572 0a20 2020 2020  : no cover.     
-00001e10: 2020 2022 2222 5265 7475 726e 2074 6865     """Return the
-00001e20: 2049 4420 6f66 2074 6865 2073 6861 7264   ID of the shard
-00001e30: 2072 6573 706f 6e73 6962 6c65 2066 6f72   responsible for
-00001e40: 2067 6976 656e 202a 2a64 6f63 756d 656e   given **documen
-00001e50: 742a 2a2e 0a0a 2020 2020 2020 2020 4966  t**...        If
-00001e60: 2074 6865 2064 6f63 756d 656e 7420 646f   the document do
-00001e70: 6573 206e 6f74 2065 7869 7374 2c20 7265  es not exist, re
-00001e80: 7475 726e 2074 6865 2073 6861 7264 2074  turn the shard t
-00001e90: 6861 7420 776f 756c 6420 6265 0a20 2020  hat would be.   
-00001ea0: 2020 2020 2072 6573 706f 6e73 6962 6c65       responsible
-00001eb0: 2e0a 0a20 2020 2020 2020 203a 7265 7475  ...        :retu
-00001ec0: 726e 3a20 5368 6172 6420 4944 0a20 2020  rn: Shard ID.   
-00001ed0: 2020 2020 203a 7274 7970 653a 2073 7472       :rtype: str
-00001ee0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00001ef0: 2020 2020 2072 6571 7565 7374 203d 2052       request = R
-00001f00: 6571 7565 7374 280a 2020 2020 2020 2020  equest(.        
-00001f10: 2020 2020 6d65 7468 6f64 3d22 7075 7422      method="put"
-00001f20: 2c0a 2020 2020 2020 2020 2020 2020 656e  ,.            en
-00001f30: 6470 6f69 6e74 3d66 222f 5f61 7069 2f63  dpoint=f"/_api/c
-00001f40: 6f6c 6c65 6374 696f 6e2f 7b73 656c 662e  ollection/{self.
-00001f50: 6e61 6d65 7d2f 7265 7370 6f6e 7369 626c  name}/responsibl
-00001f60: 6553 6861 7264 222c 0a20 2020 2020 2020  eShard",.       
-00001f70: 2020 2020 2064 6174 613d 646f 6375 6d65       data=docume
-00001f80: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
-00001f90: 7265 6164 3d73 656c 662e 6e61 6d65 2c0a  read=self.name,.
-00001fa0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00001fb0: 2020 2064 6566 2072 6573 706f 6e73 655f     def response_
-00001fc0: 6861 6e64 6c65 7228 7265 7370 3a20 5265  handler(resp: Re
-00001fd0: 7370 6f6e 7365 2920 2d3e 2073 7472 3a0a  sponse) -> str:.
-00001fe0: 2020 2020 2020 2020 2020 2020 6966 2072              if r
-00001ff0: 6573 702e 6973 5f73 7563 6365 7373 3a0a  esp.is_success:.
-00002000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002010: 7265 7475 726e 2073 7472 2872 6573 702e  return str(resp.
-00002020: 626f 6479 5b22 7368 6172 6449 6422 5d29  body["shardId"])
-00002030: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00002040: 7365 2043 6f6c 6c65 6374 696f 6e52 6573  se CollectionRes
-00002050: 706f 6e73 6962 6c65 5368 6172 6445 7272  ponsibleShardErr
-00002060: 6f72 2872 6573 702c 2072 6571 7565 7374  or(resp, request
-00002070: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-00002080: 6e20 7365 6c66 2e5f 6578 6563 7574 6528  n self._execute(
-00002090: 7265 7175 6573 742c 2072 6573 706f 6e73  request, respons
-000020a0: 655f 6861 6e64 6c65 7229 0a0a 2020 2020  e_handler)..    
-000020b0: 6465 6620 7265 6e61 6d65 2873 656c 662c  def rename(self,
-000020c0: 206e 6577 5f6e 616d 653a 2073 7472 2920   new_name: str) 
-000020d0: 2d3e 2052 6573 756c 745b 626f 6f6c 5d3a  -> Result[bool]:
-000020e0: 0a20 2020 2020 2020 2022 2222 5265 6e61  .        """Rena
-000020f0: 6d65 2074 6865 2063 6f6c 6c65 6374 696f  me the collectio
-00002100: 6e2e 0a0a 2020 2020 2020 2020 5265 6e61  n...        Rena
-00002110: 6d65 7320 6d61 7920 6e6f 7420 6265 2072  mes may not be r
-00002120: 6566 6c65 6374 6564 2069 6d6d 6564 6961  eflected immedia
-00002130: 7465 6c79 2069 6e20 6173 796e 6320 6578  tely in async ex
-00002140: 6563 7574 696f 6e2c 2062 6174 6368 0a20  ecution, batch. 
-00002150: 2020 2020 2020 2065 7865 6375 7469 6f6e         execution
-00002160: 206f 7220 7472 616e 7361 6374 696f 6e73   or transactions
-00002170: 2e20 4974 2069 7320 7265 636f 6d6d 656e  . It is recommen
-00002180: 6465 6420 746f 2069 6e69 7469 616c 697a  ded to initializ
-00002190: 6520 6e65 7720 4150 490a 2020 2020 2020  e new API.      
-000021a0: 2020 7772 6170 7065 7273 2061 6674 6572    wrappers after
-000021b0: 2061 2072 656e 616d 652e 0a0a 2020 2020   a rename...    
-000021c0: 2020 2020 3a70 6172 616d 206e 6577 5f6e      :param new_n
-000021d0: 616d 653a 204e 6577 2063 6f6c 6c65 6374  ame: New collect
-000021e0: 696f 6e20 6e61 6d65 2e0a 2020 2020 2020  ion name..      
-000021f0: 2020 3a74 7970 6520 6e65 775f 6e61 6d65    :type new_name
-00002200: 3a20 7374 720a 2020 2020 2020 2020 3a72  : str.        :r
-00002210: 6574 7572 6e3a 2054 7275 6520 6966 2063  eturn: True if c
-00002220: 6f6c 6c65 6374 696f 6e20 7761 7320 7265  ollection was re
-00002230: 6e61 6d65 6420 7375 6363 6573 7366 756c  named successful
-00002240: 6c79 2e0a 2020 2020 2020 2020 3a72 7479  ly..        :rty
-00002250: 7065 3a20 626f 6f6c 0a20 2020 2020 2020  pe: bool.       
-00002260: 203a 7261 6973 6520 6172 616e 676f 2e65   :raise arango.e
-00002270: 7863 6570 7469 6f6e 732e 436f 6c6c 6563  xceptions.Collec
-00002280: 7469 6f6e 5265 6e61 6d65 4572 726f 723a  tionRenameError:
-00002290: 2049 6620 7265 6e61 6d65 2066 6169 6c73   If rename fails
-000022a0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-000022b0: 2020 2020 2020 7265 7175 6573 7420 3d20        request = 
-000022c0: 5265 7175 6573 7428 0a20 2020 2020 2020  Request(.       
-000022d0: 2020 2020 206d 6574 686f 643d 2270 7574       method="put
-000022e0: 222c 0a20 2020 2020 2020 2020 2020 2065  ",.            e
-000022f0: 6e64 706f 696e 743d 6622 2f5f 6170 692f  ndpoint=f"/_api/
-00002300: 636f 6c6c 6563 7469 6f6e 2f7b 7365 6c66  collection/{self
-00002310: 2e6e 616d 657d 2f72 656e 616d 6522 2c0a  .name}/rename",.
-00002320: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00002330: 3d7b 226e 616d 6522 3a20 6e65 775f 6e61  ={"name": new_na
-00002340: 6d65 7d2c 0a20 2020 2020 2020 2029 0a0a  me},.        )..
-00002350: 2020 2020 2020 2020 6465 6620 7265 7370          def resp
-00002360: 6f6e 7365 5f68 616e 646c 6572 2872 6573  onse_handler(res
-00002370: 703a 2052 6573 706f 6e73 6529 202d 3e20  p: Response) -> 
-00002380: 626f 6f6c 3a0a 2020 2020 2020 2020 2020  bool:.          
-00002390: 2020 6966 206e 6f74 2072 6573 702e 6973    if not resp.is
-000023a0: 5f73 7563 6365 7373 3a0a 2020 2020 2020  _success:.      
-000023b0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-000023c0: 436f 6c6c 6563 7469 6f6e 5265 6e61 6d65  CollectionRename
-000023d0: 4572 726f 7228 7265 7370 2c20 7265 7175  Error(resp, requ
-000023e0: 6573 7429 0a20 2020 2020 2020 2020 2020  est).           
-000023f0: 2073 656c 662e 5f6e 616d 6520 3d20 6e65   self._name = ne
-00002400: 775f 6e61 6d65 0a20 2020 2020 2020 2020  w_name.         
-00002410: 2020 2073 656c 662e 5f69 645f 7072 6566     self._id_pref
-00002420: 6978 203d 206e 6577 5f6e 616d 6520 2b20  ix = new_name + 
-00002430: 222f 220a 2020 2020 2020 2020 2020 2020  "/".            
-00002440: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
-00002450: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00002460: 2e5f 6578 6563 7574 6528 7265 7175 6573  ._execute(reques
-00002470: 742c 2072 6573 706f 6e73 655f 6861 6e64  t, response_hand
-00002480: 6c65 7229 0a0a 2020 2020 6465 6620 7072  ler)..    def pr
-00002490: 6f70 6572 7469 6573 2873 656c 6629 202d  operties(self) -
-000024a0: 3e20 5265 7375 6c74 5b4a 736f 6e5d 3a0a  > Result[Json]:.
-000024b0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-000024c0: 6e20 636f 6c6c 6563 7469 6f6e 2070 726f  n collection pro
-000024d0: 7065 7274 6965 732e 0a0a 2020 2020 2020  perties...      
-000024e0: 2020 3a72 6574 7572 6e3a 2043 6f6c 6c65    :return: Colle
-000024f0: 6374 696f 6e20 7072 6f70 6572 7469 6573  ction properties
-00002500: 2e0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
-00002510: 3a20 6469 6374 0a20 2020 2020 2020 203a  : dict.        :
-00002520: 7261 6973 6520 6172 616e 676f 2e65 7863  raise arango.exc
-00002530: 6570 7469 6f6e 732e 436f 6c6c 6563 7469  eptions.Collecti
-00002540: 6f6e 5072 6f70 6572 7469 6573 4572 726f  onPropertiesErro
-00002550: 723a 2049 6620 7265 7472 6965 7661 6c20  r: If retrieval 
-00002560: 6661 696c 732e 0a20 2020 2020 2020 2022  fails..        "
-00002570: 2222 0a20 2020 2020 2020 2072 6571 7565  "".        reque
-00002580: 7374 203d 2052 6571 7565 7374 280a 2020  st = Request(.  
-00002590: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
-000025a0: 3d22 6765 7422 2c0a 2020 2020 2020 2020  ="get",.        
-000025b0: 2020 2020 656e 6470 6f69 6e74 3d66 222f      endpoint=f"/
-000025c0: 5f61 7069 2f63 6f6c 6c65 6374 696f 6e2f  _api/collection/
-000025d0: 7b73 656c 662e 6e61 6d65 7d2f 7072 6f70  {self.name}/prop
-000025e0: 6572 7469 6573 222c 0a20 2020 2020 2020  erties",.       
-000025f0: 2020 2020 2072 6561 643d 7365 6c66 2e6e       read=self.n
-00002600: 616d 652c 0a20 2020 2020 2020 2029 0a0a  ame,.        )..
-00002610: 2020 2020 2020 2020 6465 6620 7265 7370          def resp
-00002620: 6f6e 7365 5f68 616e 646c 6572 2872 6573  onse_handler(res
-00002630: 703a 2052 6573 706f 6e73 6529 202d 3e20  p: Response) -> 
-00002640: 4a73 6f6e 3a0a 2020 2020 2020 2020 2020  Json:.          
-00002650: 2020 6966 2072 6573 702e 6973 5f73 7563    if resp.is_suc
-00002660: 6365 7373 3a0a 2020 2020 2020 2020 2020  cess:.          
-00002670: 2020 2020 2020 7265 7475 726e 2066 6f72        return for
-00002680: 6d61 745f 636f 6c6c 6563 7469 6f6e 2872  mat_collection(r
-00002690: 6573 702e 626f 6479 290a 2020 2020 2020  esp.body).      
-000026a0: 2020 2020 2020 7261 6973 6520 436f 6c6c        raise Coll
-000026b0: 6563 7469 6f6e 5072 6f70 6572 7469 6573  ectionProperties
-000026c0: 4572 726f 7228 7265 7370 2c20 7265 7175  Error(resp, requ
-000026d0: 6573 7429 0a0a 2020 2020 2020 2020 7265  est)..        re
-000026e0: 7475 726e 2073 656c 662e 5f65 7865 6375  turn self._execu
-000026f0: 7465 2872 6571 7565 7374 2c20 7265 7370  te(request, resp
-00002700: 6f6e 7365 5f68 616e 646c 6572 290a 0a20  onse_handler).. 
-00002710: 2020 2064 6566 2073 6861 7264 7328 7365     def shards(se
-00002720: 6c66 2c20 6465 7461 696c 733a 2062 6f6f  lf, details: boo
-00002730: 6c20 3d20 4661 6c73 6529 202d 3e20 5265  l = False) -> Re
-00002740: 7375 6c74 5b4a 736f 6e5d 3a0a 2020 2020  sult[Json]:.    
-00002750: 2020 2020 2222 2252 6574 7572 6e20 636f      """Return co
-00002760: 6c6c 6563 7469 6f6e 2073 6861 7264 7320  llection shards 
-00002770: 616e 6420 7072 6f70 6572 7469 6573 2e0a  and properties..
-00002780: 0a20 2020 2020 2020 2041 7661 696c 6162  .        Availab
-00002790: 6c65 206f 6e6c 7920 696e 2061 2063 6c75  le only in a clu
-000027a0: 7374 6572 2073 6574 7570 2e0a 0a20 2020  ster setup...   
-000027b0: 2020 2020 203a 7061 7261 6d20 6465 7461       :param deta
-000027c0: 696c 733a 2049 6e63 6c75 6465 2072 6573  ils: Include res
-000027d0: 706f 6e73 6962 6c65 2073 6572 7665 7273  ponsible servers
-000027e0: 2066 6f72 2065 6163 6820 7368 6172 642e   for each shard.
-000027f0: 0a20 2020 2020 2020 203a 7479 7065 2064  .        :type d
-00002800: 6574 6169 6c73 3a20 626f 6f6c 0a20 2020  etails: bool.   
-00002810: 2020 2020 203a 7265 7475 726e 3a20 436f       :return: Co
-00002820: 6c6c 6563 7469 6f6e 2073 6861 7264 7320  llection shards 
-00002830: 616e 6420 7072 6f70 6572 7469 6573 2e0a  and properties..
-00002840: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
-00002850: 6469 6374 0a20 2020 2020 2020 203a 7261  dict.        :ra
-00002860: 6973 6520 6172 616e 676f 2e65 7863 6570  ise arango.excep
-00002870: 7469 6f6e 732e 436f 6c6c 6563 7469 6f6e  tions.Collection
-00002880: 5368 6172 6473 4572 726f 723a 2049 6620  ShardsError: If 
-00002890: 7265 7472 6965 7661 6c20 6661 696c 732e  retrieval fails.
-000028a0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000028b0: 2020 2020 2072 6571 7565 7374 203d 2052       request = R
-000028c0: 6571 7565 7374 280a 2020 2020 2020 2020  equest(.        
-000028d0: 2020 2020 6d65 7468 6f64 3d22 6765 7422      method="get"
-000028e0: 2c0a 2020 2020 2020 2020 2020 2020 656e  ,.            en
-000028f0: 6470 6f69 6e74 3d66 222f 5f61 7069 2f63  dpoint=f"/_api/c
-00002900: 6f6c 6c65 6374 696f 6e2f 7b73 656c 662e  ollection/{self.
-00002910: 6e61 6d65 7d2f 7368 6172 6473 222c 0a20  name}/shards",. 
-00002920: 2020 2020 2020 2020 2020 2070 6172 616d             param
-00002930: 733d 7b22 6465 7461 696c 7322 3a20 6465  s={"details": de
-00002940: 7461 696c 737d 2c0a 2020 2020 2020 2020  tails},.        
-00002950: 2020 2020 7265 6164 3d73 656c 662e 6e61      read=self.na
-00002960: 6d65 2c0a 2020 2020 2020 2020 290a 0a20  me,.        ).. 
-00002970: 2020 2020 2020 2064 6566 2072 6573 706f         def respo
-00002980: 6e73 655f 6861 6e64 6c65 7228 7265 7370  nse_handler(resp
-00002990: 3a20 5265 7370 6f6e 7365 2920 2d3e 204a  : Response) -> J
-000029a0: 736f 6e3a 0a20 2020 2020 2020 2020 2020  son:.           
-000029b0: 2069 6620 7265 7370 2e69 735f 7375 6363   if resp.is_succ
-000029c0: 6573 733a 0a20 2020 2020 2020 2020 2020  ess:.           
-000029d0: 2020 2020 2072 6574 7572 6e20 666f 726d       return form
-000029e0: 6174 5f63 6f6c 6c65 6374 696f 6e28 7265  at_collection(re
-000029f0: 7370 2e62 6f64 7929 0a20 2020 2020 2020  sp.body).       
-00002a00: 2020 2020 2072 6169 7365 2043 6f6c 6c65       raise Colle
-00002a10: 6374 696f 6e53 6861 7264 7345 7272 6f72  ctionShardsError
-00002a20: 2872 6573 702c 2072 6571 7565 7374 290a  (resp, request).
-00002a30: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00002a40: 7365 6c66 2e5f 6578 6563 7574 6528 7265  self._execute(re
-00002a50: 7175 6573 742c 2072 6573 706f 6e73 655f  quest, response_
-00002a60: 6861 6e64 6c65 7229 0a0a 2020 2020 6465  handler)..    de
-00002a70: 6620 696e 666f 2873 656c 6629 202d 3e20  f info(self) -> 
-00002a80: 5265 7375 6c74 5b4a 736f 6e5d 3a0a 2020  Result[Json]:.  
-00002a90: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
-00002aa0: 7468 6520 636f 6c6c 6563 7469 6f6e 2069  the collection i
-00002ab0: 6e66 6f72 6d61 7469 6f6e 2e0a 0a20 2020  nformation...   
-00002ac0: 2020 2020 203a 7265 7475 726e 3a20 496e       :return: In
-00002ad0: 666f 726d 6174 696f 6e20 6162 6f75 7420  formation about 
-00002ae0: 7468 6520 636f 6c6c 6563 7469 6f6e 2e0a  the collection..
-00002af0: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
-00002b00: 6469 6374 0a20 2020 2020 2020 203a 7261  dict.        :ra
-00002b10: 6973 6520 6172 616e 676f 2e65 7863 6570  ise arango.excep
-00002b20: 7469 6f6e 732e 436f 6c6c 6563 7469 6f6e  tions.Collection
-00002b30: 496e 666f 726d 6174 696f 6e45 7272 6f72  InformationError
-00002b40: 3a20 4966 2072 6574 7269 6576 616c 2066  : If retrieval f
-00002b50: 6169 6c73 2e0a 2020 2020 2020 2020 2222  ails..        ""
-00002b60: 220a 2020 2020 2020 2020 7265 7175 6573  ".        reques
-00002b70: 7420 3d20 5265 7175 6573 7428 0a20 2020  t = Request(.   
-00002b80: 2020 2020 2020 2020 206d 6574 686f 643d           method=
-00002b90: 2267 6574 222c 0a20 2020 2020 2020 2020  "get",.         
-00002ba0: 2020 2065 6e64 706f 696e 743d 6622 2f5f     endpoint=f"/_
-00002bb0: 6170 692f 636f 6c6c 6563 7469 6f6e 2f7b  api/collection/{
-00002bc0: 7365 6c66 2e6e 616d 657d 222c 0a20 2020  self.name}",.   
-00002bd0: 2020 2020 2020 2020 2072 6561 643d 7365           read=se
-00002be0: 6c66 2e6e 616d 652c 0a20 2020 2020 2020  lf.name,.       
-00002bf0: 2029 0a0a 2020 2020 2020 2020 6465 6620   )..        def 
-00002c00: 7265 7370 6f6e 7365 5f68 616e 646c 6572  response_handler
-00002c10: 2872 6573 703a 2052 6573 706f 6e73 6529  (resp: Response)
-00002c20: 202d 3e20 4a73 6f6e 3a0a 2020 2020 2020   -> Json:.      
-00002c30: 2020 2020 2020 6966 2072 6573 702e 6973        if resp.is
-00002c40: 5f73 7563 6365 7373 3a0a 2020 2020 2020  _success:.      
-00002c50: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00002c60: 2066 6f72 6d61 745f 636f 6c6c 6563 7469   format_collecti
-00002c70: 6f6e 2872 6573 702e 626f 6479 290a 2020  on(resp.body).  
-00002c80: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00002c90: 436f 6c6c 6563 7469 6f6e 496e 666f 726d  CollectionInform
-00002ca0: 6174 696f 6e45 7272 6f72 2872 6573 702c  ationError(resp,
-00002cb0: 2072 6571 7565 7374 290a 0a20 2020 2020   request)..     
-00002cc0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00002cd0: 6578 6563 7574 6528 7265 7175 6573 742c  execute(request,
-00002ce0: 2072 6573 706f 6e73 655f 6861 6e64 6c65   response_handle
-00002cf0: 7229 0a0a 2020 2020 6465 6620 636f 6e66  r)..    def conf
-00002d00: 6967 7572 6528 0a20 2020 2020 2020 2073  igure(.        s
-00002d10: 656c 662c 0a20 2020 2020 2020 2073 796e  elf,.        syn
-00002d20: 633a 204f 7074 696f 6e61 6c5b 626f 6f6c  c: Optional[bool
-00002d30: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-00002d40: 2020 7363 6865 6d61 3a20 4f70 7469 6f6e    schema: Option
-00002d50: 616c 5b4a 736f 6e5d 203d 204e 6f6e 652c  al[Json] = None,
-00002d60: 0a20 2020 2020 2020 2072 6570 6c69 6361  .        replica
-00002d70: 7469 6f6e 5f66 6163 746f 723a 204f 7074  tion_factor: Opt
-00002d80: 696f 6e61 6c5b 696e 745d 203d 204e 6f6e  ional[int] = Non
-00002d90: 652c 0a20 2020 2020 2020 2077 7269 7465  e,.        write
-00002da0: 5f63 6f6e 6365 726e 3a20 4f70 7469 6f6e  _concern: Option
-00002db0: 616c 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a  al[int] = None,.
-00002dc0: 2020 2020 2020 2020 636f 6d70 7574 6564          computed
-00002dd0: 5f76 616c 7565 733a 204f 7074 696f 6e61  _values: Optiona
-00002de0: 6c5b 4a73 6f6e 735d 203d 204e 6f6e 652c  l[Jsons] = None,
-00002df0: 0a20 2020 2029 202d 3e20 5265 7375 6c74  .    ) -> Result
-00002e00: 5b4a 736f 6e5d 3a0a 2020 2020 2020 2020  [Json]:.        
-00002e10: 2222 2243 6f6e 6669 6775 7265 2063 6f6c  """Configure col
-00002e20: 6c65 6374 696f 6e20 7072 6f70 6572 7469  lection properti
-00002e30: 6573 2e0a 0a20 2020 2020 2020 203a 7061  es...        :pa
-00002e40: 7261 6d20 7379 6e63 3a20 426c 6f63 6b20  ram sync: Block 
-00002e50: 756e 7469 6c20 6f70 6572 6174 696f 6e73  until operations
-00002e60: 2061 7265 2073 796e 6368 726f 6e69 7a65   are synchronize
-00002e70: 6420 746f 2064 6973 6b2e 0a20 2020 2020  d to disk..     
-00002e80: 2020 203a 7479 7065 2073 796e 633a 2062     :type sync: b
-00002e90: 6f6f 6c20 7c20 4e6f 6e65 0a20 2020 2020  ool | None.     
-00002ea0: 2020 203a 7061 7261 6d20 7363 6865 6d61     :param schema
-00002eb0: 3a20 646f 6375 6d65 6e74 2073 6368 656d  : document schem
-00002ec0: 6120 666f 7220 7661 6c69 6461 7469 6f6e  a for validation
-00002ed0: 206f 6620 6f62 6a65 6374 732e 0a20 2020   of objects..   
-00002ee0: 2020 2020 203a 7479 7065 2073 6368 656d       :type schem
-00002ef0: 613a 2064 6963 740a 2020 2020 2020 2020  a: dict.        
-00002f00: 3a70 6172 616d 2072 6570 6c69 6361 7469  :param replicati
-00002f10: 6f6e 5f66 6163 746f 723a 204e 756d 6265  on_factor: Numbe
-00002f20: 7220 6f66 2063 6f70 6965 7320 6f66 2065  r of copies of e
-00002f30: 6163 6820 7368 6172 6420 6f6e 2064 6966  ach shard on dif
-00002f40: 6665 7265 6e74 0a20 2020 2020 2020 2020  ferent.         
-00002f50: 2020 2073 6572 7665 7273 2069 6e20 6120     servers in a 
-00002f60: 636c 7573 7465 722e 2041 6c6c 6f77 6564  cluster. Allowed
-00002f70: 2076 616c 7565 7320 6172 6520 3120 286f   values are 1 (o
-00002f80: 6e6c 7920 6f6e 6520 636f 7079 2069 7320  nly one copy is 
-00002f90: 6b65 7074 0a20 2020 2020 2020 2020 2020  kept.           
-00002fa0: 2061 6e64 206e 6f20 7379 6e63 6872 6f6e   and no synchron
-00002fb0: 6f75 7320 7265 706c 6963 6174 696f 6e29  ous replication)
-00002fc0: 2c20 616e 6420 6e20 286e 2d31 2072 6570  , and n (n-1 rep
-00002fd0: 6c69 6361 7320 6172 6520 6b65 7074 2061  licas are kept a
-00002fe0: 6e64 0a20 2020 2020 2020 2020 2020 2061  nd.            a
-00002ff0: 6e79 2074 776f 2063 6f70 6965 7320 6172  ny two copies ar
-00003000: 6520 7265 706c 6963 6174 6564 2061 6372  e replicated acr
-00003010: 6f73 7320 7365 7276 6572 7320 7379 6e63  oss servers sync
-00003020: 6872 6f6e 6f75 736c 792c 206d 6561 6e69  hronously, meani
-00003030: 6e67 0a20 2020 2020 2020 2020 2020 2065  ng.            e
-00003040: 7665 7279 2077 7269 7465 2074 6f20 7468  very write to th
-00003050: 6520 6d61 7374 6572 2069 7320 636f 7069  e master is copi
-00003060: 6564 2074 6f20 616c 6c20 736c 6176 6573  ed to all slaves
-00003070: 2062 6566 6f72 6520 6f70 6572 6174 696f   before operatio
-00003080: 6e0a 2020 2020 2020 2020 2020 2020 6973  n.            is
-00003090: 2072 6570 6f72 7465 6420 7375 6363 6573   reported succes
-000030a0: 7366 756c 292e 0a20 2020 2020 2020 203a  sful)..        :
-000030b0: 7479 7065 2072 6570 6c69 6361 7469 6f6e  type replication
-000030c0: 5f66 6163 746f 723a 2069 6e74 0a20 2020  _factor: int.   
-000030d0: 2020 2020 203a 7061 7261 6d20 7772 6974       :param writ
-000030e0: 655f 636f 6e63 6572 6e3a 2057 7269 7465  e_concern: Write
-000030f0: 2063 6f6e 6365 726e 2066 6f72 2074 6865   concern for the
-00003100: 2063 6f6c 6c65 6374 696f 6e2e 2044 6574   collection. Det
-00003110: 6572 6d69 6e65 7320 686f 770a 2020 2020  ermines how.    
-00003120: 2020 2020 2020 2020 6d61 6e79 2063 6f70          many cop
-00003130: 6965 7320 6f66 2065 6163 6820 7368 6172  ies of each shar
-00003140: 6420 6172 6520 7265 7175 6972 6564 2074  d are required t
-00003150: 6f20 6265 2069 6e20 7379 6e63 206f 6e20  o be in sync on 
-00003160: 6469 6666 6572 656e 740a 2020 2020 2020  different.      
-00003170: 2020 2020 2020 4442 5365 7276 6572 732e        DBServers.
-00003180: 2049 6620 7468 6572 6520 6172 6520 6c65   If there are le
-00003190: 7373 2074 6861 6e20 7468 6573 6520 6d61  ss than these ma
-000031a0: 6e79 2063 6f70 6965 7320 696e 2074 6865  ny copies in the
-000031b0: 2063 6c75 7374 6572 0a20 2020 2020 2020   cluster.       
-000031c0: 2020 2020 2061 2073 6861 7264 2077 696c       a shard wil
-000031d0: 6c20 7265 6675 7365 2074 6f20 7772 6974  l refuse to writ
-000031e0: 652e 2057 7269 7465 7320 746f 2073 6861  e. Writes to sha
-000031f0: 7264 7320 7769 7468 2065 6e6f 7567 680a  rds with enough.
-00003200: 2020 2020 2020 2020 2020 2020 7570 2d74              up-t
-00003210: 6f2d 6461 7465 2063 6f70 6965 7320 7769  o-date copies wi
-00003220: 6c6c 2073 7563 6365 6564 2061 7420 7468  ll succeed at th
-00003230: 6520 7361 6d65 2074 696d 652e 2054 6865  e same time. The
-00003240: 2076 616c 7565 206f 6620 7468 6973 0a20   value of this. 
-00003250: 2020 2020 2020 2020 2020 2070 6172 616d             param
-00003260: 6574 6572 2063 616e 6e6f 7420 6265 206c  eter cannot be l
-00003270: 6172 6765 7220 7468 616e 2074 6861 7420  arger than that 
-00003280: 6f66 202a 2a72 6570 6c69 6361 7469 6f6e  of **replication
-00003290: 5f66 6163 746f 722a 2a2e 0a20 2020 2020  _factor**..     
-000032a0: 2020 2020 2020 2044 6566 6175 6c74 2076         Default v
-000032b0: 616c 7565 2069 7320 312e 2055 7365 6420  alue is 1. Used 
-000032c0: 666f 7220 636c 7573 7465 7273 206f 6e6c  for clusters onl
-000032d0: 792e 0a20 2020 2020 2020 203a 7479 7065  y..        :type
-000032e0: 2077 7269 7465 5f63 6f6e 6365 726e 3a20   write_concern: 
-000032f0: 696e 740a 2020 2020 2020 2020 3a72 6574  int.        :ret
-00003300: 7572 6e3a 204e 6577 2063 6f6c 6c65 6374  urn: New collect
-00003310: 696f 6e20 7072 6f70 6572 7469 6573 2e0a  ion properties..
-00003320: 2020 2020 2020 2020 3a70 6172 616d 2063          :param c
-00003330: 6f6d 7075 7465 645f 7661 6c75 6573 3a20  omputed_values: 
-00003340: 4465 6669 6e65 2065 7870 7265 7373 696f  Define expressio
-00003350: 6e73 206f 6e20 7468 6520 636f 6c6c 6563  ns on the collec
-00003360: 7469 6f6e 206c 6576 656c 2074 6861 740a  tion level that.
-00003370: 2020 2020 2020 2020 2020 2020 7275 6e20              run 
-00003380: 6f6e 2069 6e73 6572 7473 2c20 6d6f 6469  on inserts, modi
-00003390: 6669 6361 7469 6f6e 732c 206f 7220 626f  fications, or bo
-000033a0: 7468 2e0a 2020 2020 2020 2020 3a74 7970  th..        :typ
-000033b0: 6520 636f 6d70 7574 6564 5f76 616c 7565  e computed_value
-000033c0: 733a 2064 6963 7420 7c20 4e6f 6e65 0a20  s: dict | None. 
-000033d0: 2020 2020 2020 203a 7274 7970 653a 2064         :rtype: d
-000033e0: 6963 740a 2020 2020 2020 2020 3a72 6169  ict.        :rai
-000033f0: 7365 2061 7261 6e67 6f2e 6578 6365 7074  se arango.except
-00003400: 696f 6e73 2e43 6f6c 6c65 6374 696f 6e43  ions.CollectionC
-00003410: 6f6e 6669 6775 7265 4572 726f 723a 2049  onfigureError: I
-00003420: 6620 6f70 6572 6174 696f 6e20 6661 696c  f operation fail
-00003430: 732e 0a20 2020 2020 2020 2022 2222 0a20  s..        """. 
-00003440: 2020 2020 2020 2064 6174 613a 204a 736f         data: Jso
-00003450: 6e20 3d20 7b7d 0a20 2020 2020 2020 2069  n = {}.        i
-00003460: 6620 7379 6e63 2069 7320 6e6f 7420 4e6f  f sync is not No
-00003470: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00003480: 6461 7461 5b22 7761 6974 466f 7253 796e  data["waitForSyn
-00003490: 6322 5d20 3d20 7379 6e63 0a20 2020 2020  c"] = sync.     
-000034a0: 2020 2069 6620 7363 6865 6d61 2069 7320     if schema is 
-000034b0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-000034c0: 2020 2020 2020 6461 7461 5b22 7363 6865        data["sche
-000034d0: 6d61 225d 203d 2073 6368 656d 610a 2020  ma"] = schema.  
-000034e0: 2020 2020 2020 6966 2072 6570 6c69 6361        if replica
-000034f0: 7469 6f6e 5f66 6163 746f 7220 6973 206e  tion_factor is n
-00003500: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-00003510: 2020 2020 2064 6174 615b 2272 6570 6c69       data["repli
-00003520: 6361 7469 6f6e 4661 6374 6f72 225d 203d  cationFactor"] =
-00003530: 2072 6570 6c69 6361 7469 6f6e 5f66 6163   replication_fac
-00003540: 746f 720a 2020 2020 2020 2020 6966 2077  tor.        if w
-00003550: 7269 7465 5f63 6f6e 6365 726e 2069 7320  rite_concern is 
-00003560: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-00003570: 2020 2020 2020 6461 7461 5b22 7772 6974        data["writ
-00003580: 6543 6f6e 6365 726e 225d 203d 2077 7269  eConcern"] = wri
-00003590: 7465 5f63 6f6e 6365 726e 0a20 2020 2020  te_concern.     
-000035a0: 2020 2069 6620 636f 6d70 7574 6564 5f76     if computed_v
-000035b0: 616c 7565 7320 6973 206e 6f74 204e 6f6e  alues is not Non
-000035c0: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
-000035d0: 6174 615b 2263 6f6d 7075 7465 6456 616c  ata["computedVal
-000035e0: 7565 7322 5d20 3d20 636f 6d70 7574 6564  ues"] = computed
-000035f0: 5f76 616c 7565 730a 0a20 2020 2020 2020  _values..       
-00003600: 2072 6571 7565 7374 203d 2052 6571 7565   request = Reque
-00003610: 7374 280a 2020 2020 2020 2020 2020 2020  st(.            
-00003620: 6d65 7468 6f64 3d22 7075 7422 2c0a 2020  method="put",.  
-00003630: 2020 2020 2020 2020 2020 656e 6470 6f69            endpoi
-00003640: 6e74 3d66 222f 5f61 7069 2f63 6f6c 6c65  nt=f"/_api/colle
-00003650: 6374 696f 6e2f 7b73 656c 662e 6e61 6d65  ction/{self.name
-00003660: 7d2f 7072 6f70 6572 7469 6573 222c 0a20  }/properties",. 
-00003670: 2020 2020 2020 2020 2020 2064 6174 613d             data=
-00003680: 6461 7461 2c0a 2020 2020 2020 2020 290a  data,.        ).
-00003690: 0a20 2020 2020 2020 2064 6566 2072 6573  .        def res
-000036a0: 706f 6e73 655f 6861 6e64 6c65 7228 7265  ponse_handler(re
-000036b0: 7370 3a20 5265 7370 6f6e 7365 2920 2d3e  sp: Response) ->
-000036c0: 204a 736f 6e3a 0a20 2020 2020 2020 2020   Json:.         
-000036d0: 2020 2069 6620 6e6f 7420 7265 7370 2e69     if not resp.i
-000036e0: 735f 7375 6363 6573 733a 0a20 2020 2020  s_success:.     
-000036f0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00003700: 2043 6f6c 6c65 6374 696f 6e43 6f6e 6669   CollectionConfi
-00003710: 6775 7265 4572 726f 7228 7265 7370 2c20  gureError(resp, 
-00003720: 7265 7175 6573 7429 0a20 2020 2020 2020  request).       
-00003730: 2020 2020 2072 6574 7572 6e20 666f 726d       return form
-00003740: 6174 5f63 6f6c 6c65 6374 696f 6e28 7265  at_collection(re
-00003750: 7370 2e62 6f64 7929 0a0a 2020 2020 2020  sp.body)..      
-00003760: 2020 7265 7475 726e 2073 656c 662e 5f65    return self._e
-00003770: 7865 6375 7465 2872 6571 7565 7374 2c20  xecute(request, 
-00003780: 7265 7370 6f6e 7365 5f68 616e 646c 6572  response_handler
-00003790: 290a 0a20 2020 2064 6566 2073 7461 7469  )..    def stati
-000037a0: 7374 6963 7328 7365 6c66 2920 2d3e 2052  stics(self) -> R
-000037b0: 6573 756c 745b 4a73 6f6e 5d3a 0a20 2020  esult[Json]:.   
-000037c0: 2020 2020 2022 2222 5265 7475 726e 2063       """Return c
-000037d0: 6f6c 6c65 6374 696f 6e20 7374 6174 6973  ollection statis
-000037e0: 7469 6373 2e0a 0a20 2020 2020 2020 203a  tics...        :
-000037f0: 7265 7475 726e 3a20 436f 6c6c 6563 7469  return: Collecti
-00003800: 6f6e 2073 7461 7469 7374 6963 732e 0a20  on statistics.. 
-00003810: 2020 2020 2020 203a 7274 7970 653a 2064         :rtype: d
-00003820: 6963 740a 2020 2020 2020 2020 3a72 6169  ict.        :rai
-00003830: 7365 2061 7261 6e67 6f2e 6578 6365 7074  se arango.except
-00003840: 696f 6e73 2e43 6f6c 6c65 6374 696f 6e53  ions.CollectionS
-00003850: 7461 7469 7374 6963 7345 7272 6f72 3a20  tatisticsError: 
-00003860: 4966 2072 6574 7269 6576 616c 2066 6169  If retrieval fai
-00003870: 6c73 2e0a 2020 2020 2020 2020 2222 220a  ls..        """.
-00003880: 2020 2020 2020 2020 7265 7175 6573 7420          request 
-00003890: 3d20 5265 7175 6573 7428 0a20 2020 2020  = Request(.     
-000038a0: 2020 2020 2020 206d 6574 686f 643d 2267         method="g
-000038b0: 6574 222c 0a20 2020 2020 2020 2020 2020  et",.           
-000038c0: 2065 6e64 706f 696e 743d 6622 2f5f 6170   endpoint=f"/_ap
-000038d0: 692f 636f 6c6c 6563 7469 6f6e 2f7b 7365  i/collection/{se
-000038e0: 6c66 2e6e 616d 657d 2f66 6967 7572 6573  lf.name}/figures
-000038f0: 222c 0a20 2020 2020 2020 2020 2020 2072  ",.            r
-00003900: 6561 643d 7365 6c66 2e6e 616d 652c 0a20  ead=self.name,. 
-00003910: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00003920: 2020 6465 6620 7265 7370 6f6e 7365 5f68    def response_h
-00003930: 616e 646c 6572 2872 6573 703a 2052 6573  andler(resp: Res
-00003940: 706f 6e73 6529 202d 3e20 4a73 6f6e 3a0a  ponse) -> Json:.
-00003950: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-00003960: 6f74 2072 6573 702e 6973 5f73 7563 6365  ot resp.is_succe
-00003970: 7373 3a0a 2020 2020 2020 2020 2020 2020  ss:.            
-00003980: 2020 2020 7261 6973 6520 436f 6c6c 6563      raise Collec
-00003990: 7469 6f6e 5374 6174 6973 7469 6373 4572  tionStatisticsEr
-000039a0: 726f 7228 7265 7370 2c20 7265 7175 6573  ror(resp, reques
-000039b0: 7429 0a0a 2020 2020 2020 2020 2020 2020  t)..            
-000039c0: 7374 6174 733a 204a 736f 6e20 3d20 7265  stats: Json = re
-000039d0: 7370 2e62 6f64 792e 6765 7428 2266 6967  sp.body.get("fig
-000039e0: 7572 6573 222c 2072 6573 702e 626f 6479  ures", resp.body
-000039f0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-00003a00: 2022 646f 6375 6d65 6e74 5265 6665 7265   "documentRefere
-00003a10: 6e63 6573 2220 696e 2073 7461 7473 3a20  nces" in stats: 
-00003a20: 2023 2070 7261 676d 613a 206e 6f20 636f   # pragma: no co
-00003a30: 7665 720a 2020 2020 2020 2020 2020 2020  ver.            
-00003a40: 2020 2020 7374 6174 735b 2264 6f63 756d      stats["docum
-00003a50: 656e 745f 7265 6673 225d 203d 2073 7461  ent_refs"] = sta
-00003a60: 7473 2e70 6f70 2822 646f 6375 6d65 6e74  ts.pop("document
-00003a70: 5265 6665 7265 6e63 6573 2229 0a20 2020  References").   
-00003a80: 2020 2020 2020 2020 2069 6620 226c 6173           if "las
-00003a90: 7454 6963 6b22 2069 6e20 7374 6174 733a  tTick" in stats:
-00003aa0: 2020 2320 7072 6167 6d61 3a20 6e6f 2063    # pragma: no c
-00003ab0: 6f76 6572 0a20 2020 2020 2020 2020 2020  over.           
-00003ac0: 2020 2020 2073 7461 7473 5b22 6c61 7374       stats["last
-00003ad0: 5f74 6963 6b22 5d20 3d20 7374 6174 732e  _tick"] = stats.
-00003ae0: 706f 7028 226c 6173 7454 6963 6b22 290a  pop("lastTick").
-00003af0: 2020 2020 2020 2020 2020 2020 6966 2022              if "
-00003b00: 7761 6974 696e 6746 6f72 2220 696e 2073  waitingFor" in s
-00003b10: 7461 7473 3a20 2023 2070 7261 676d 613a  tats:  # pragma:
-00003b20: 206e 6f20 636f 7665 720a 2020 2020 2020   no cover.      
-00003b30: 2020 2020 2020 2020 2020 7374 6174 735b            stats[
-00003b40: 2277 6169 7469 6e67 5f66 6f72 225d 203d  "waiting_for"] =
-00003b50: 2073 7461 7473 2e70 6f70 2822 7761 6974   stats.pop("wait
-00003b60: 696e 6746 6f72 2229 0a20 2020 2020 2020  ingFor").       
-00003b70: 2020 2020 2069 6620 2264 6f63 756d 656e       if "documen
-00003b80: 7473 5369 7a65 2220 696e 2073 7461 7473  tsSize" in stats
-00003b90: 3a20 2023 2070 7261 676d 613a 206e 6f20  :  # pragma: no 
-00003ba0: 636f 7665 720a 2020 2020 2020 2020 2020  cover.          
-00003bb0: 2020 2020 2020 7374 6174 735b 2264 6f63        stats["doc
-00003bc0: 756d 656e 7473 5f73 697a 6522 5d20 3d20  uments_size"] = 
-00003bd0: 7374 6174 732e 706f 7028 2264 6f63 756d  stats.pop("docum
-00003be0: 656e 7473 5369 7a65 2229 0a20 2020 2020  entsSize").     
-00003bf0: 2020 2020 2020 2069 6620 2263 6163 6865         if "cache
-00003c00: 496e 5573 6522 2069 6e20 7374 6174 733a  InUse" in stats:
-00003c10: 2020 2320 7072 6167 6d61 3a20 6e6f 2063    # pragma: no c
-00003c20: 6f76 6572 0a20 2020 2020 2020 2020 2020  over.           
-00003c30: 2020 2020 2073 7461 7473 5b22 6361 6368       stats["cach
-00003c40: 655f 696e 5f75 7365 225d 203d 2073 7461  e_in_use"] = sta
-00003c50: 7473 2e70 6f70 2822 6361 6368 6549 6e55  ts.pop("cacheInU
-00003c60: 7365 2229 0a20 2020 2020 2020 2020 2020  se").           
-00003c70: 2069 6620 2263 6163 6865 5369 7a65 2220   if "cacheSize" 
-00003c80: 696e 2073 7461 7473 3a20 2023 2070 7261  in stats:  # pra
-00003c90: 676d 613a 206e 6f20 636f 7665 720a 2020  gma: no cover.  
-00003ca0: 2020 2020 2020 2020 2020 2020 2020 7374                st
-00003cb0: 6174 735b 2263 6163 6865 5f73 697a 6522  ats["cache_size"
-00003cc0: 5d20 3d20 7374 6174 732e 706f 7028 2263  ] = stats.pop("c
-00003cd0: 6163 6865 5369 7a65 2229 0a20 2020 2020  acheSize").     
-00003ce0: 2020 2020 2020 2069 6620 2263 6163 6865         if "cache
-00003cf0: 5573 6167 6522 2069 6e20 7374 6174 733a  Usage" in stats:
-00003d00: 2020 2320 7072 6167 6d61 3a20 6e6f 2063    # pragma: no c
-00003d10: 6f76 6572 0a20 2020 2020 2020 2020 2020  over.           
-00003d20: 2020 2020 2073 7461 7473 5b22 6361 6368       stats["cach
-00003d30: 655f 7573 6167 6522 5d20 3d20 7374 6174  e_usage"] = stat
-00003d40: 732e 706f 7028 2263 6163 6865 5573 6167  s.pop("cacheUsag
-00003d50: 6522 290a 2020 2020 2020 2020 2020 2020  e").            
-00003d60: 6966 2022 756e 636f 6c6c 6563 7465 644c  if "uncollectedL
-00003d70: 6f67 6669 6c65 456e 7472 6965 7322 2069  ogfileEntries" i
-00003d80: 6e20 7374 6174 733a 2020 2320 7072 6167  n stats:  # prag
-00003d90: 6d61 3a20 6e6f 2063 6f76 6572 0a20 2020  ma: no cover.   
-00003da0: 2020 2020 2020 2020 2020 2020 2073 7461               sta
-00003db0: 7473 5b22 756e 636f 6c6c 6563 7465 645f  ts["uncollected_
-00003dc0: 6c6f 6766 696c 655f 656e 7472 6965 7322  logfile_entries"
-00003dd0: 5d20 3d20 7374 6174 732e 706f 7028 0a20  ] = stats.pop(. 
-00003de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003df0: 2020 2022 756e 636f 6c6c 6563 7465 644c     "uncollectedL
-00003e00: 6f67 6669 6c65 456e 7472 6965 7322 0a20  ogfileEntries". 
-00003e10: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00003e20: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00003e30: 7572 6e20 7374 6174 730a 0a20 2020 2020  urn stats..     
-00003e40: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00003e50: 6578 6563 7574 6528 7265 7175 6573 742c  execute(request,
-00003e60: 2072 6573 706f 6e73 655f 6861 6e64 6c65   response_handle
-00003e70: 7229 0a0a 2020 2020 6465 6620 7265 7669  r)..    def revi
-00003e80: 7369 6f6e 2873 656c 6629 202d 3e20 5265  sion(self) -> Re
-00003e90: 7375 6c74 5b73 7472 5d3a 0a20 2020 2020  sult[str]:.     
-00003ea0: 2020 2022 2222 5265 7475 726e 2063 6f6c     """Return col
-00003eb0: 6c65 6374 696f 6e20 7265 7669 7369 6f6e  lection revision
-00003ec0: 2e0a 0a20 2020 2020 2020 203a 7265 7475  ...        :retu
-00003ed0: 726e 3a20 436f 6c6c 6563 7469 6f6e 2072  rn: Collection r
-00003ee0: 6576 6973 696f 6e2e 0a20 2020 2020 2020  evision..       
-00003ef0: 203a 7274 7970 653a 2073 7472 0a20 2020   :rtype: str.   
-00003f00: 2020 2020 203a 7261 6973 6520 6172 616e       :raise aran
-00003f10: 676f 2e65 7863 6570 7469 6f6e 732e 436f  go.exceptions.Co
-00003f20: 6c6c 6563 7469 6f6e 5265 7669 7369 6f6e  llectionRevision
-00003f30: 4572 726f 723a 2049 6620 7265 7472 6965  Error: If retrie
-00003f40: 7661 6c20 6661 696c 732e 0a20 2020 2020  val fails..     
-00003f50: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
-00003f60: 6571 7565 7374 203d 2052 6571 7565 7374  equest = Request
-00003f70: 280a 2020 2020 2020 2020 2020 2020 6d65  (.            me
-00003f80: 7468 6f64 3d22 6765 7422 2c0a 2020 2020  thod="get",.    
-00003f90: 2020 2020 2020 2020 656e 6470 6f69 6e74          endpoint
-00003fa0: 3d66 222f 5f61 7069 2f63 6f6c 6c65 6374  =f"/_api/collect
-00003fb0: 696f 6e2f 7b73 656c 662e 6e61 6d65 7d2f  ion/{self.name}/
-00003fc0: 7265 7669 7369 6f6e 222c 0a20 2020 2020  revision",.     
-00003fd0: 2020 2020 2020 2072 6561 643d 7365 6c66         read=self
-00003fe0: 2e6e 616d 652c 0a20 2020 2020 2020 2029  .name,.        )
-00003ff0: 0a0a 2020 2020 2020 2020 6465 6620 7265  ..        def re
-00004000: 7370 6f6e 7365 5f68 616e 646c 6572 2872  sponse_handler(r
-00004010: 6573 703a 2052 6573 706f 6e73 6529 202d  esp: Response) -
-00004020: 3e20 7374 723a 0a20 2020 2020 2020 2020  > str:.         
-00004030: 2020 2069 6620 7265 7370 2e69 735f 7375     if resp.is_su
-00004040: 6363 6573 733a 0a20 2020 2020 2020 2020  ccess:.         
-00004050: 2020 2020 2020 2072 6574 7572 6e20 7374         return st
-00004060: 7228 7265 7370 2e62 6f64 795b 2272 6576  r(resp.body["rev
-00004070: 6973 696f 6e22 5d29 0a20 2020 2020 2020  ision"]).       
-00004080: 2020 2020 2072 6169 7365 2043 6f6c 6c65       raise Colle
-00004090: 6374 696f 6e52 6576 6973 696f 6e45 7272  ctionRevisionErr
-000040a0: 6f72 2872 6573 702c 2072 6571 7565 7374  or(resp, request
-000040b0: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-000040c0: 6e20 7365 6c66 2e5f 6578 6563 7574 6528  n self._execute(
-000040d0: 7265 7175 6573 742c 2072 6573 706f 6e73  request, respons
-000040e0: 655f 6861 6e64 6c65 7229 0a0a 2020 2020  e_handler)..    
-000040f0: 6465 6620 6368 6563 6b73 756d 2873 656c  def checksum(sel
-00004100: 662c 2077 6974 685f 7265 763a 2062 6f6f  f, with_rev: boo
-00004110: 6c20 3d20 4661 6c73 652c 2077 6974 685f  l = False, with_
-00004120: 6461 7461 3a20 626f 6f6c 203d 2046 616c  data: bool = Fal
-00004130: 7365 2920 2d3e 2052 6573 756c 745b 7374  se) -> Result[st
-00004140: 725d 3a0a 2020 2020 2020 2020 2222 2252  r]:.        """R
-00004150: 6574 7572 6e20 636f 6c6c 6563 7469 6f6e  eturn collection
-00004160: 2063 6865 636b 7375 6d2e 0a0a 2020 2020   checksum...    
-00004170: 2020 2020 3a70 6172 616d 2077 6974 685f      :param with_
-00004180: 7265 763a 2049 6e63 6c75 6465 2064 6f63  rev: Include doc
-00004190: 756d 656e 7420 7265 7669 7369 6f6e 7320  ument revisions 
-000041a0: 696e 2063 6865 636b 7375 6d20 6361 6c63  in checksum calc
-000041b0: 756c 6174 696f 6e2e 0a20 2020 2020 2020  ulation..       
-000041c0: 203a 7479 7065 2077 6974 685f 7265 763a   :type with_rev:
-000041d0: 2062 6f6f 6c0a 2020 2020 2020 2020 3a70   bool.        :p
-000041e0: 6172 616d 2077 6974 685f 6461 7461 3a20  aram with_data: 
-000041f0: 496e 636c 7564 6520 646f 6375 6d65 6e74  Include document
-00004200: 2064 6174 6120 696e 2063 6865 636b 7375   data in checksu
-00004210: 6d20 6361 6c63 756c 6174 696f 6e2e 0a20  m calculation.. 
-00004220: 2020 2020 2020 203a 7479 7065 2077 6974         :type wit
-00004230: 685f 6461 7461 3a20 626f 6f6c 0a20 2020  h_data: bool.   
-00004240: 2020 2020 203a 7265 7475 726e 3a20 436f       :return: Co
-00004250: 6c6c 6563 7469 6f6e 2063 6865 636b 7375  llection checksu
-00004260: 6d2e 0a20 2020 2020 2020 203a 7274 7970  m..        :rtyp
-00004270: 653a 2073 7472 0a20 2020 2020 2020 203a  e: str.        :
-00004280: 7261 6973 6520 6172 616e 676f 2e65 7863  raise arango.exc
-00004290: 6570 7469 6f6e 732e 436f 6c6c 6563 7469  eptions.Collecti
-000042a0: 6f6e 4368 6563 6b73 756d 4572 726f 723a  onChecksumError:
-000042b0: 2049 6620 7265 7472 6965 7661 6c20 6661   If retrieval fa
-000042c0: 696c 732e 0a20 2020 2020 2020 2022 2222  ils..        """
-000042d0: 0a20 2020 2020 2020 2072 6571 7565 7374  .        request
-000042e0: 203d 2052 6571 7565 7374 280a 2020 2020   = Request(.    
-000042f0: 2020 2020 2020 2020 6d65 7468 6f64 3d22          method="
-00004300: 6765 7422 2c0a 2020 2020 2020 2020 2020  get",.          
-00004310: 2020 656e 6470 6f69 6e74 3d66 222f 5f61    endpoint=f"/_a
-00004320: 7069 2f63 6f6c 6c65 6374 696f 6e2f 7b73  pi/collection/{s
-00004330: 656c 662e 6e61 6d65 7d2f 6368 6563 6b73  elf.name}/checks
-00004340: 756d 222c 0a20 2020 2020 2020 2020 2020  um",.           
-00004350: 2070 6172 616d 733d 7b22 7769 7468 5265   params={"withRe
-00004360: 7669 7369 6f6e 223a 2077 6974 685f 7265  vision": with_re
-00004370: 762c 2022 7769 7468 4461 7461 223a 2077  v, "withData": w
-00004380: 6974 685f 6461 7461 7d2c 0a20 2020 2020  ith_data},.     
-00004390: 2020 2029 0a0a 2020 2020 2020 2020 6465     )..        de
-000043a0: 6620 7265 7370 6f6e 7365 5f68 616e 646c  f response_handl
-000043b0: 6572 2872 6573 703a 2052 6573 706f 6e73  er(resp: Respons
-000043c0: 6529 202d 3e20 7374 723a 0a20 2020 2020  e) -> str:.     
-000043d0: 2020 2020 2020 2069 6620 7265 7370 2e69         if resp.i
-000043e0: 735f 7375 6363 6573 733a 0a20 2020 2020  s_success:.     
-000043f0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00004400: 6e20 7374 7228 7265 7370 2e62 6f64 795b  n str(resp.body[
-00004410: 2263 6865 636b 7375 6d22 5d29 0a20 2020  "checksum"]).   
-00004420: 2020 2020 2020 2020 2072 6169 7365 2043           raise C
-00004430: 6f6c 6c65 6374 696f 6e43 6865 636b 7375  ollectionChecksu
-00004440: 6d45 7272 6f72 2872 6573 702c 2072 6571  mError(resp, req
-00004450: 7565 7374 290a 0a20 2020 2020 2020 2072  uest)..        r
-00004460: 6574 7572 6e20 7365 6c66 2e5f 6578 6563  eturn self._exec
-00004470: 7574 6528 7265 7175 6573 742c 2072 6573  ute(request, res
-00004480: 706f 6e73 655f 6861 6e64 6c65 7229 0a0a  ponse_handler)..
-00004490: 2020 2020 6465 6620 636f 6d70 6163 7428      def compact(
-000044a0: 7365 6c66 2920 2d3e 2052 6573 756c 745b  self) -> Result[
-000044b0: 4a73 6f6e 5d3a 0a20 2020 2020 2020 2022  Json]:.        "
-000044c0: 2222 436f 6d70 6163 7420 6120 636f 6c6c  ""Compact a coll
-000044d0: 6563 7469 6f6e 2e0a 0a20 2020 2020 2020  ection...       
-000044e0: 2043 6f6d 7061 6374 7320 7468 6520 6461   Compacts the da
-000044f0: 7461 206f 6620 6120 636f 6c6c 6563 7469  ta of a collecti
-00004500: 6f6e 2069 6e20 6f72 6465 7220 746f 2072  on in order to r
-00004510: 6563 6c61 696d 2064 6973 6b20 7370 6163  eclaim disk spac
-00004520: 652e 0a20 2020 2020 2020 2054 6865 206f  e..        The o
-00004530: 7065 7261 7469 6f6e 2077 696c 6c20 636f  peration will co
-00004540: 6d70 6163 7420 7468 6520 646f 6375 6d65  mpact the docume
-00004550: 6e74 2061 6e64 2069 6e64 6578 2064 6174  nt and index dat
-00004560: 6120 6279 2072 6577 7269 7469 6e67 2074  a by rewriting t
-00004570: 6865 0a20 2020 2020 2020 2075 6e64 6572  he.        under
-00004580: 6c79 696e 6720 2e73 7374 2066 696c 6573  lying .sst files
-00004590: 2061 6e64 206f 6e6c 7920 6b65 6570 696e   and only keepin
-000045a0: 6720 7468 6520 7265 6c65 7661 6e74 2065  g the relevant e
-000045b0: 6e74 7269 6573 2e0a 0a20 2020 2020 2020  ntries...       
-000045c0: 2055 6e64 6572 206e 6f72 6d61 6c20 6369   Under normal ci
-000045d0: 7263 756d 7374 616e 6365 732c 2072 756e  rcumstances, run
-000045e0: 6e69 6e67 2061 2063 6f6d 7061 6374 206f  ning a compact o
-000045f0: 7065 7261 7469 6f6e 2069 7320 6e6f 7420  peration is not 
-00004600: 6e65 6365 7373 6172 792c 2061 730a 2020  necessary, as.  
-00004610: 2020 2020 2020 7468 6520 636f 6c6c 6563        the collec
-00004620: 7469 6f6e 2064 6174 6120 7769 6c6c 2065  tion data will e
-00004630: 7665 6e74 7561 6c6c 7920 6765 7420 636f  ventually get co
-00004640: 6d70 6163 7465 6420 616e 7977 6179 2e20  mpacted anyway. 
-00004650: 486f 7765 7665 722c 2069 6e20 736f 6d65  However, in some
-00004660: 0a20 2020 2020 2020 2073 6974 7561 7469  .        situati
-00004670: 6f6e 732c 2065 2e67 2e20 6166 7465 7220  ons, e.g. after 
-00004680: 7275 6e6e 696e 6720 6c6f 7473 206f 6620  running lots of 
-00004690: 7570 6461 7465 2f72 6570 6c61 6365 206f  update/replace o
-000046a0: 7220 7265 6d6f 7665 206f 7065 7261 7469  r remove operati
-000046b0: 6f6e 732c 0a20 2020 2020 2020 2074 6865  ons,.        the
-000046c0: 2064 6973 6b20 6461 7461 2066 6f72 2061   disk data for a
-000046d0: 2063 6f6c 6c65 6374 696f 6e20 6d61 7920   collection may 
-000046e0: 636f 6e74 6169 6e20 6120 6c6f 7420 6f66  contain a lot of
-000046f0: 206f 7574 6461 7465 6420 6461 7461 2066   outdated data f
-00004700: 6f72 2077 6869 6368 2074 6865 0a20 2020  or which the.   
-00004710: 2020 2020 2073 7061 6365 2073 6861 6c6c       space shall
-00004720: 2062 6520 7265 636c 6169 6d65 642e 2049   be reclaimed. I
-00004730: 6e20 7468 6973 2063 6173 6520 7468 6520  n this case the 
-00004740: 636f 6d70 6163 7469 6f6e 206f 7065 7261  compaction opera
-00004750: 7469 6f6e 2063 616e 2062 6520 7573 6564  tion can be used
-00004760: 2e0a 0a20 2020 2020 2020 203a 7265 7475  ...        :retu
-00004770: 726e 3a20 436f 6c6c 6563 7469 6f6e 2063  rn: Collection c
-00004780: 6f6d 7061 6374 2e0a 2020 2020 2020 2020  ompact..        
-00004790: 3a72 7479 7065 3a20 6469 6374 0a20 2020  :rtype: dict.   
-000047a0: 2020 2020 203a 7261 6973 6520 6172 616e       :raise aran
-000047b0: 676f 2e65 7863 6570 7469 6f6e 732e 436f  go.exceptions.Co
-000047c0: 6c6c 6563 7469 6f6e 436f 6d70 6163 7445  llectionCompactE
-000047d0: 7272 6f72 3a20 4966 2072 6574 7269 6576  rror: If retriev
-000047e0: 616c 2066 6169 6c73 2e0a 2020 2020 2020  al fails..      
-000047f0: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-00004800: 7175 6573 7420 3d20 5265 7175 6573 7428  quest = Request(
-00004810: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-00004820: 686f 643d 2270 7574 222c 0a20 2020 2020  hod="put",.     
-00004830: 2020 2020 2020 2065 6e64 706f 696e 743d         endpoint=
-00004840: 6622 2f5f 6170 692f 636f 6c6c 6563 7469  f"/_api/collecti
-00004850: 6f6e 2f7b 7365 6c66 2e6e 616d 657d 2f63  on/{self.name}/c
-00004860: 6f6d 7061 6374 222c 0a20 2020 2020 2020  ompact",.       
-00004870: 2029 0a0a 2020 2020 2020 2020 6465 6620   )..        def 
-00004880: 7265 7370 6f6e 7365 5f68 616e 646c 6572  response_handler
-00004890: 2872 6573 703a 2052 6573 706f 6e73 6529  (resp: Response)
-000048a0: 202d 3e20 4a73 6f6e 3a0a 2020 2020 2020   -> Json:.      
-000048b0: 2020 2020 2020 6966 2072 6573 702e 6973        if resp.is
-000048c0: 5f73 7563 6365 7373 3a0a 2020 2020 2020  _success:.      
-000048d0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000048e0: 2066 6f72 6d61 745f 636f 6c6c 6563 7469   format_collecti
-000048f0: 6f6e 2872 6573 702e 626f 6479 290a 2020  on(resp.body).  
-00004900: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00004910: 436f 6c6c 6563 7469 6f6e 436f 6d70 6163  CollectionCompac
-00004920: 7445 7272 6f72 2872 6573 702c 2072 6571  tError(resp, req
-00004930: 7565 7374 290a 0a20 2020 2020 2020 2072  uest)..        r
-00004940: 6574 7572 6e20 7365 6c66 2e5f 6578 6563  eturn self._exec
-00004950: 7574 6528 7265 7175 6573 742c 2072 6573  ute(request, res
-00004960: 706f 6e73 655f 6861 6e64 6c65 7229 0a0a  ponse_handler)..
-00004970: 2020 2020 6465 6620 6c6f 6164 2873 656c      def load(sel
-00004980: 6629 202d 3e20 5265 7375 6c74 5b62 6f6f  f) -> Result[boo
-00004990: 6c5d 3a0a 2020 2020 2020 2020 2222 224c  l]:.        """L
-000049a0: 6f61 6420 7468 6520 636f 6c6c 6563 7469  oad the collecti
-000049b0: 6f6e 2069 6e74 6f20 6d65 6d6f 7279 2e0a  on into memory..
-000049c0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-000049d0: 3a20 5472 7565 2069 6620 636f 6c6c 6563  : True if collec
-000049e0: 7469 6f6e 2077 6173 206c 6f61 6465 6420  tion was loaded 
-000049f0: 7375 6363 6573 7366 756c 6c79 2e0a 2020  successfully..  
-00004a00: 2020 2020 2020 3a72 7479 7065 3a20 626f        :rtype: bo
-00004a10: 6f6c 0a20 2020 2020 2020 203a 7261 6973  ol.        :rais
-00004a20: 6520 6172 616e 676f 2e65 7863 6570 7469  e arango.excepti
-00004a30: 6f6e 732e 436f 6c6c 6563 7469 6f6e 4c6f  ons.CollectionLo
-00004a40: 6164 4572 726f 723a 2049 6620 6f70 6572  adError: If oper
-00004a50: 6174 696f 6e20 6661 696c 732e 0a20 2020  ation fails..   
-00004a60: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00004a70: 2072 6571 7565 7374 203d 2052 6571 7565   request = Reque
-00004a80: 7374 286d 6574 686f 643d 2270 7574 222c  st(method="put",
-00004a90: 2065 6e64 706f 696e 743d 6622 2f5f 6170   endpoint=f"/_ap
-00004aa0: 692f 636f 6c6c 6563 7469 6f6e 2f7b 7365  i/collection/{se
-00004ab0: 6c66 2e6e 616d 657d 2f6c 6f61 6422 290a  lf.name}/load").
-00004ac0: 0a20 2020 2020 2020 2064 6566 2072 6573  .        def res
-00004ad0: 706f 6e73 655f 6861 6e64 6c65 7228 7265  ponse_handler(re
-00004ae0: 7370 3a20 5265 7370 6f6e 7365 2920 2d3e  sp: Response) ->
-00004af0: 2062 6f6f 6c3a 0a20 2020 2020 2020 2020   bool:.         
-00004b00: 2020 2069 6620 6e6f 7420 7265 7370 2e69     if not resp.i
-00004b10: 735f 7375 6363 6573 733a 0a20 2020 2020  s_success:.     
-00004b20: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00004b30: 2043 6f6c 6c65 6374 696f 6e4c 6f61 6445   CollectionLoadE
-00004b40: 7272 6f72 2872 6573 702c 2072 6571 7565  rror(resp, reque
-00004b50: 7374 290a 2020 2020 2020 2020 2020 2020  st).            
-00004b60: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
-00004b70: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00004b80: 2e5f 6578 6563 7574 6528 7265 7175 6573  ._execute(reques
-00004b90: 742c 2072 6573 706f 6e73 655f 6861 6e64  t, response_hand
-00004ba0: 6c65 7229 0a0a 2020 2020 6465 6620 756e  ler)..    def un
-00004bb0: 6c6f 6164 2873 656c 6629 202d 3e20 5265  load(self) -> Re
-00004bc0: 7375 6c74 5b62 6f6f 6c5d 3a0a 2020 2020  sult[bool]:.    
-00004bd0: 2020 2020 2222 2255 6e6c 6f61 6420 7468      """Unload th
-00004be0: 6520 636f 6c6c 6563 7469 6f6e 2066 726f  e collection fro
-00004bf0: 6d20 6d65 6d6f 7279 2e0a 0a20 2020 2020  m memory...     
-00004c00: 2020 203a 7265 7475 726e 3a20 5472 7565     :return: True
-00004c10: 2069 6620 636f 6c6c 6563 7469 6f6e 2077   if collection w
-00004c20: 6173 2075 6e6c 6f61 6465 6420 7375 6363  as unloaded succ
-00004c30: 6573 7366 756c 6c79 2e0a 2020 2020 2020  essfully..      
-00004c40: 2020 3a72 7479 7065 3a20 626f 6f6c 0a20    :rtype: bool. 
-00004c50: 2020 2020 2020 203a 7261 6973 6520 6172         :raise ar
-00004c60: 616e 676f 2e65 7863 6570 7469 6f6e 732e  ango.exceptions.
-00004c70: 436f 6c6c 6563 7469 6f6e 556e 6c6f 6164  CollectionUnload
-00004c80: 4572 726f 723a 2049 6620 6f70 6572 6174  Error: If operat
-00004c90: 696f 6e20 6661 696c 732e 0a20 2020 2020  ion fails..     
-00004ca0: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
-00004cb0: 6571 7565 7374 203d 2052 6571 7565 7374  equest = Request
-00004cc0: 286d 6574 686f 643d 2270 7574 222c 2065  (method="put", e
-00004cd0: 6e64 706f 696e 743d 6622 2f5f 6170 692f  ndpoint=f"/_api/
-00004ce0: 636f 6c6c 6563 7469 6f6e 2f7b 7365 6c66  collection/{self
-00004cf0: 2e6e 616d 657d 2f75 6e6c 6f61 6422 290a  .name}/unload").
-00004d00: 0a20 2020 2020 2020 2064 6566 2072 6573  .        def res
-00004d10: 706f 6e73 655f 6861 6e64 6c65 7228 7265  ponse_handler(re
-00004d20: 7370 3a20 5265 7370 6f6e 7365 2920 2d3e  sp: Response) ->
-00004d30: 2062 6f6f 6c3a 0a20 2020 2020 2020 2020   bool:.         
-00004d40: 2020 2069 6620 6e6f 7420 7265 7370 2e69     if not resp.i
-00004d50: 735f 7375 6363 6573 733a 0a20 2020 2020  s_success:.     
-00004d60: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00004d70: 2043 6f6c 6c65 6374 696f 6e55 6e6c 6f61   CollectionUnloa
-00004d80: 6445 7272 6f72 2872 6573 702c 2072 6571  dError(resp, req
-00004d90: 7565 7374 290a 2020 2020 2020 2020 2020  uest).          
-00004da0: 2020 7265 7475 726e 2054 7275 650a 0a20    return True.. 
-00004db0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00004dc0: 6c66 2e5f 6578 6563 7574 6528 7265 7175  lf._execute(requ
-00004dd0: 6573 742c 2072 6573 706f 6e73 655f 6861  est, response_ha
-00004de0: 6e64 6c65 7229 0a0a 2020 2020 6465 6620  ndler)..    def 
-00004df0: 7472 756e 6361 7465 2873 656c 6629 202d  truncate(self) -
-00004e00: 3e20 5265 7375 6c74 5b62 6f6f 6c5d 3a0a  > Result[bool]:.
-00004e10: 2020 2020 2020 2020 2222 2244 656c 6574          """Delet
-00004e20: 6520 616c 6c20 646f 6375 6d65 6e74 7320  e all documents 
-00004e30: 696e 2074 6865 2063 6f6c 6c65 6374 696f  in the collectio
-00004e40: 6e2e 0a0a 2020 2020 2020 2020 3a72 6574  n...        :ret
-00004e50: 7572 6e3a 2054 7275 6520 6966 2063 6f6c  urn: True if col
-00004e60: 6c65 6374 696f 6e20 7761 7320 7472 756e  lection was trun
-00004e70: 6361 7465 6420 7375 6363 6573 7366 756c  cated successful
-00004e80: 6c79 2e0a 2020 2020 2020 2020 3a72 7479  ly..        :rty
-00004e90: 7065 3a20 626f 6f6c 0a20 2020 2020 2020  pe: bool.       
-00004ea0: 203a 7261 6973 6520 6172 616e 676f 2e65   :raise arango.e
-00004eb0: 7863 6570 7469 6f6e 732e 436f 6c6c 6563  xceptions.Collec
-00004ec0: 7469 6f6e 5472 756e 6361 7465 4572 726f  tionTruncateErro
-00004ed0: 723a 2049 6620 6f70 6572 6174 696f 6e20  r: If operation 
-00004ee0: 6661 696c 732e 0a20 2020 2020 2020 2022  fails..        "
-00004ef0: 2222 0a20 2020 2020 2020 2072 6571 7565  "".        reque
-00004f00: 7374 203d 2052 6571 7565 7374 280a 2020  st = Request(.  
-00004f10: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
-00004f20: 3d22 7075 7422 2c20 656e 6470 6f69 6e74  ="put", endpoint
-00004f30: 3d66 222f 5f61 7069 2f63 6f6c 6c65 6374  =f"/_api/collect
-00004f40: 696f 6e2f 7b73 656c 662e 6e61 6d65 7d2f  ion/{self.name}/
-00004f50: 7472 756e 6361 7465 220a 2020 2020 2020  truncate".      
-00004f60: 2020 290a 0a20 2020 2020 2020 2064 6566    )..        def
-00004f70: 2072 6573 706f 6e73 655f 6861 6e64 6c65   response_handle
-00004f80: 7228 7265 7370 3a20 5265 7370 6f6e 7365  r(resp: Response
-00004f90: 2920 2d3e 2062 6f6f 6c3a 0a20 2020 2020  ) -> bool:.     
-00004fa0: 2020 2020 2020 2069 6620 6e6f 7420 7265         if not re
-00004fb0: 7370 2e69 735f 7375 6363 6573 733a 0a20  sp.is_success:. 
-00004fc0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00004fd0: 6169 7365 2043 6f6c 6c65 6374 696f 6e54  aise CollectionT
-00004fe0: 7275 6e63 6174 6545 7272 6f72 2872 6573  runcateError(res
-00004ff0: 702c 2072 6571 7565 7374 290a 2020 2020  p, request).    
-00005000: 2020 2020 2020 2020 7265 7475 726e 2054          return T
-00005010: 7275 650a 0a20 2020 2020 2020 2072 6574  rue..        ret
-00005020: 7572 6e20 7365 6c66 2e5f 6578 6563 7574  urn self._execut
-00005030: 6528 7265 7175 6573 742c 2072 6573 706f  e(request, respo
-00005040: 6e73 655f 6861 6e64 6c65 7229 0a0a 2020  nse_handler)..  
-00005050: 2020 6465 6620 636f 756e 7428 7365 6c66    def count(self
-00005060: 2920 2d3e 2052 6573 756c 745b 696e 745d  ) -> Result[int]
-00005070: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-00005080: 7572 6e20 7468 6520 746f 7461 6c20 646f  urn the total do
-00005090: 6375 6d65 6e74 2063 6f75 6e74 2e0a 0a20  cument count... 
-000050a0: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
-000050b0: 546f 7461 6c20 646f 6375 6d65 6e74 2063  Total document c
-000050c0: 6f75 6e74 2e0a 2020 2020 2020 2020 3a72  ount..        :r
-000050d0: 7479 7065 3a20 696e 740a 2020 2020 2020  type: int.      
-000050e0: 2020 3a72 6169 7365 2061 7261 6e67 6f2e    :raise arango.
-000050f0: 6578 6365 7074 696f 6e73 2e44 6f63 756d  exceptions.Docum
-00005100: 656e 7443 6f75 6e74 4572 726f 723a 2049  entCountError: I
-00005110: 6620 7265 7472 6965 7661 6c20 6661 696c  f retrieval fail
-00005120: 732e 0a20 2020 2020 2020 2022 2222 0a20  s..        """. 
-00005130: 2020 2020 2020 2072 6571 7565 7374 203d         request =
-00005140: 2052 6571 7565 7374 286d 6574 686f 643d   Request(method=
-00005150: 2267 6574 222c 2065 6e64 706f 696e 743d  "get", endpoint=
-00005160: 6622 2f5f 6170 692f 636f 6c6c 6563 7469  f"/_api/collecti
-00005170: 6f6e 2f7b 7365 6c66 2e6e 616d 657d 2f63  on/{self.name}/c
-00005180: 6f75 6e74 2229 0a0a 2020 2020 2020 2020  ount")..        
-00005190: 6465 6620 7265 7370 6f6e 7365 5f68 616e  def response_han
-000051a0: 646c 6572 2872 6573 703a 2052 6573 706f  dler(resp: Respo
-000051b0: 6e73 6529 202d 3e20 696e 743a 0a20 2020  nse) -> int:.   
-000051c0: 2020 2020 2020 2020 2069 6620 7265 7370           if resp
-000051d0: 2e69 735f 7375 6363 6573 733a 0a20 2020  .is_success:.   
-000051e0: 2020 2020 2020 2020 2020 2020 2072 6573               res
-000051f0: 756c 743a 2069 6e74 203d 2072 6573 702e  ult: int = resp.
-00005200: 626f 6479 5b22 636f 756e 7422 5d0a 2020  body["count"].  
-00005210: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00005220: 7475 726e 2072 6573 756c 740a 2020 2020  turn result.    
-00005230: 2020 2020 2020 2020 7261 6973 6520 446f          raise Do
-00005240: 6375 6d65 6e74 436f 756e 7445 7272 6f72  cumentCountError
-00005250: 2872 6573 702c 2072 6571 7565 7374 290a  (resp, request).
-00005260: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00005270: 7365 6c66 2e5f 6578 6563 7574 6528 7265  self._execute(re
-00005280: 7175 6573 742c 2072 6573 706f 6e73 655f  quest, response_
-00005290: 6861 6e64 6c65 7229 0a0a 2020 2020 6465  handler)..    de
-000052a0: 6620 6861 7328 0a20 2020 2020 2020 2073  f has(.        s
-000052b0: 656c 662c 0a20 2020 2020 2020 2064 6f63  elf,.        doc
-000052c0: 756d 656e 743a 2055 6e69 6f6e 5b73 7472  ument: Union[str
-000052d0: 2c20 4a73 6f6e 5d2c 0a20 2020 2020 2020  , Json],.       
-000052e0: 2072 6576 3a20 4f70 7469 6f6e 616c 5b73   rev: Optional[s
-000052f0: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
-00005300: 2020 2020 6368 6563 6b5f 7265 763a 2062      check_rev: b
-00005310: 6f6f 6c20 3d20 5472 7565 2c0a 2020 2020  ool = True,.    
-00005320: 2020 2020 616c 6c6f 775f 6469 7274 795f      allow_dirty_
-00005330: 7265 6164 3a20 626f 6f6c 203d 2046 616c  read: bool = Fal
-00005340: 7365 2c0a 2020 2020 2920 2d3e 2052 6573  se,.    ) -> Res
-00005350: 756c 745b 626f 6f6c 5d3a 0a20 2020 2020  ult[bool]:.     
-00005360: 2020 2022 2222 4368 6563 6b20 6966 2061     """Check if a
-00005370: 2064 6f63 756d 656e 7420 6578 6973 7473   document exists
-00005380: 2069 6e20 7468 6520 636f 6c6c 6563 7469   in the collecti
-00005390: 6f6e 2e0a 0a20 2020 2020 2020 203a 7061  on...        :pa
-000053a0: 7261 6d20 646f 6375 6d65 6e74 3a20 446f  ram document: Do
-000053b0: 6375 6d65 6e74 2049 442c 206b 6579 206f  cument ID, key o
-000053c0: 7220 626f 6479 2e20 446f 6375 6d65 6e74  r body. Document
-000053d0: 2062 6f64 7920 6d75 7374 2063 6f6e 7461   body must conta
-000053e0: 696e 0a20 2020 2020 2020 2020 2020 2074  in.            t
-000053f0: 6865 2022 5f69 6422 206f 7220 225f 6b65  he "_id" or "_ke
-00005400: 7922 2066 6965 6c64 2e0a 2020 2020 2020  y" field..      
-00005410: 2020 3a74 7970 6520 646f 6375 6d65 6e74    :type document
-00005420: 3a20 7374 7220 7c20 6469 6374 0a20 2020  : str | dict.   
-00005430: 2020 2020 203a 7061 7261 6d20 7265 763a       :param rev:
-00005440: 2045 7870 6563 7465 6420 646f 6375 6d65   Expected docume
-00005450: 6e74 2072 6576 6973 696f 6e2e 204f 7665  nt revision. Ove
-00005460: 7272 6964 6573 2076 616c 7565 206f 6620  rrides value of 
-00005470: 225f 7265 7622 2066 6965 6c64 0a20 2020  "_rev" field.   
-00005480: 2020 2020 2020 2020 2069 6e20 2a2a 646f           in **do
-00005490: 6375 6d65 6e74 2a2a 2069 6620 7072 6573  cument** if pres
-000054a0: 656e 742e 0a20 2020 2020 2020 203a 7479  ent..        :ty
-000054b0: 7065 2072 6576 3a20 7374 7220 7c20 4e6f  pe rev: str | No
-000054c0: 6e65 0a20 2020 2020 2020 203a 7061 7261  ne.        :para
-000054d0: 6d20 6368 6563 6b5f 7265 763a 2049 6620  m check_rev: If 
-000054e0: 7365 7420 746f 2054 7275 652c 2072 6576  set to True, rev
-000054f0: 6973 696f 6e20 6f66 202a 2a64 6f63 756d  ision of **docum
-00005500: 656e 742a 2a20 2869 6620 6769 7665 6e29  ent** (if given)
-00005510: 0a20 2020 2020 2020 2020 2020 2069 7320  .            is 
-00005520: 636f 6d70 6172 6564 2061 6761 696e 7374  compared against
-00005530: 2074 6865 2072 6576 6973 696f 6e20 6f66   the revision of
-00005540: 2074 6172 6765 7420 646f 6375 6d65 6e74   target document
-00005550: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
-00005560: 6368 6563 6b5f 7265 763a 2062 6f6f 6c0a  check_rev: bool.
-00005570: 2020 2020 2020 2020 3a70 6172 616d 2061          :param a
-00005580: 6c6c 6f77 5f64 6972 7479 5f72 6561 643a  llow_dirty_read:
-00005590: 2041 6c6c 6f77 2072 6561 6473 2066 726f   Allow reads fro
-000055a0: 6d20 666f 6c6c 6f77 6572 7320 696e 2061  m followers in a
-000055b0: 2063 6c75 7374 6572 2e0a 2020 2020 2020   cluster..      
-000055c0: 2020 3a74 7970 6520 616c 6c6f 775f 6469    :type allow_di
-000055d0: 7274 795f 7265 6164 3a20 626f 6f6c 0a20  rty_read: bool. 
-000055e0: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
-000055f0: 5472 7565 2069 6620 646f 6375 6d65 6e74  True if document
-00005600: 2065 7869 7374 732c 2046 616c 7365 206f   exists, False o
-00005610: 7468 6572 7769 7365 2e0a 2020 2020 2020  therwise..      
-00005620: 2020 3a72 7479 7065 3a20 626f 6f6c 0a20    :rtype: bool. 
-00005630: 2020 2020 2020 203a 7261 6973 6520 6172         :raise ar
-00005640: 616e 676f 2e65 7863 6570 7469 6f6e 732e  ango.exceptions.
-00005650: 446f 6375 6d65 6e74 496e 4572 726f 723a  DocumentInError:
-00005660: 2049 6620 6368 6563 6b20 6661 696c 732e   If check fails.
-00005670: 0a20 2020 2020 2020 203a 7261 6973 6520  .        :raise 
-00005680: 6172 616e 676f 2e65 7863 6570 7469 6f6e  arango.exception
-00005690: 732e 446f 6375 6d65 6e74 5265 7669 7369  s.DocumentRevisi
-000056a0: 6f6e 4572 726f 723a 2049 6620 7265 7669  onError: If revi
-000056b0: 7369 6f6e 7320 6d69 736d 6174 6368 2e0a  sions mismatch..
-000056c0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000056d0: 2020 2020 6861 6e64 6c65 2c20 626f 6479      handle, body
-000056e0: 2c20 6865 6164 6572 7320 3d20 7365 6c66  , headers = self
-000056f0: 2e5f 7072 6570 5f66 726f 6d5f 646f 6328  ._prep_from_doc(
-00005700: 646f 6375 6d65 6e74 2c20 7265 762c 2063  document, rev, c
-00005710: 6865 636b 5f72 6576 290a 0a20 2020 2020  heck_rev)..     
-00005720: 2020 2069 6620 616c 6c6f 775f 6469 7274     if allow_dirt
-00005730: 795f 7265 6164 3a0a 2020 2020 2020 2020  y_read:.        
-00005740: 2020 2020 6865 6164 6572 735b 2278 2d61      headers["x-a
-00005750: 7261 6e67 6f2d 616c 6c6f 772d 6469 7274  rango-allow-dirt
-00005760: 792d 7265 6164 225d 203d 2022 7472 7565  y-read"] = "true
-00005770: 220a 0a20 2020 2020 2020 2072 6571 7565  "..        reque
-00005780: 7374 203d 2052 6571 7565 7374 280a 2020  st = Request(.  
-00005790: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
-000057a0: 3d22 6765 7422 2c0a 2020 2020 2020 2020  ="get",.        
-000057b0: 2020 2020 656e 6470 6f69 6e74 3d66 222f      endpoint=f"/
-000057c0: 5f61 7069 2f64 6f63 756d 656e 742f 7b68  _api/document/{h
-000057d0: 616e 646c 657d 222c 0a20 2020 2020 2020  andle}",.       
-000057e0: 2020 2020 2068 6561 6465 7273 3d68 6561       headers=hea
-000057f0: 6465 7273 2c0a 2020 2020 2020 2020 2020  ders,.          
-00005800: 2020 7265 6164 3d73 656c 662e 6e61 6d65    read=self.name
-00005810: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-00005820: 2020 2020 2064 6566 2072 6573 706f 6e73       def respons
-00005830: 655f 6861 6e64 6c65 7228 7265 7370 3a20  e_handler(resp: 
-00005840: 5265 7370 6f6e 7365 2920 2d3e 2062 6f6f  Response) -> boo
-00005850: 6c3a 0a20 2020 2020 2020 2020 2020 2069  l:.            i
-00005860: 6620 7265 7370 2e65 7272 6f72 5f63 6f64  f resp.error_cod
-00005870: 6520 3d3d 2031 3230 323a 0a20 2020 2020  e == 1202:.     
-00005880: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00005890: 6e20 4661 6c73 650a 2020 2020 2020 2020  n False.        
-000058a0: 2020 2020 6966 2072 6573 702e 7374 6174      if resp.stat
-000058b0: 7573 5f63 6f64 6520 3d3d 2034 3132 3a0a  us_code == 412:.
-000058c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000058d0: 7261 6973 6520 446f 6375 6d65 6e74 5265  raise DocumentRe
-000058e0: 7669 7369 6f6e 4572 726f 7228 7265 7370  visionError(resp
-000058f0: 2c20 7265 7175 6573 7429 0a20 2020 2020  , request).     
-00005900: 2020 2020 2020 2069 6620 6e6f 7420 7265         if not re
-00005910: 7370 2e69 735f 7375 6363 6573 733a 0a20  sp.is_success:. 
-00005920: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00005930: 6169 7365 2044 6f63 756d 656e 7449 6e45  aise DocumentInE
-00005940: 7272 6f72 2872 6573 702c 2072 6571 7565  rror(resp, reque
-00005950: 7374 290a 2020 2020 2020 2020 2020 2020  st).            
-00005960: 7265 7475 726e 2062 6f6f 6c28 7265 7370  return bool(resp
-00005970: 2e62 6f64 7929 0a0a 2020 2020 2020 2020  .body)..        
-00005980: 7265 7475 726e 2073 656c 662e 5f65 7865  return self._exe
-00005990: 6375 7465 2872 6571 7565 7374 2c20 7265  cute(request, re
-000059a0: 7370 6f6e 7365 5f68 616e 646c 6572 290a  sponse_handler).
-000059b0: 0a20 2020 2064 6566 2069 6473 2873 656c  .    def ids(sel
-000059c0: 662c 2061 6c6c 6f77 5f64 6972 7479 5f72  f, allow_dirty_r
-000059d0: 6561 643a 2062 6f6f 6c20 3d20 4661 6c73  ead: bool = Fals
-000059e0: 6529 202d 3e20 5265 7375 6c74 5b43 7572  e) -> Result[Cur
-000059f0: 736f 725d 3a0a 2020 2020 2020 2020 2222  sor]:.        ""
-00005a00: 2252 6574 7572 6e20 7468 6520 4944 7320  "Return the IDs 
-00005a10: 6f66 2061 6c6c 2064 6f63 756d 656e 7473  of all documents
-00005a20: 2069 6e20 7468 6520 636f 6c6c 6563 7469   in the collecti
-00005a30: 6f6e 2e0a 0a20 2020 2020 2020 203a 7061  on...        :pa
-00005a40: 7261 6d20 616c 6c6f 775f 6469 7274 795f  ram allow_dirty_
-00005a50: 7265 6164 3a20 416c 6c6f 7720 7265 6164  read: Allow read
-00005a60: 7320 6672 6f6d 2066 6f6c 6c6f 7765 7273  s from followers
-00005a70: 2069 6e20 6120 636c 7573 7465 722e 0a20   in a cluster.. 
-00005a80: 2020 2020 2020 203a 7479 7065 2061 6c6c         :type all
-00005a90: 6f77 5f64 6972 7479 5f72 6561 643a 2062  ow_dirty_read: b
-00005aa0: 6f6f 6c0a 2020 2020 2020 2020 3a72 6574  ool.        :ret
-00005ab0: 7572 6e3a 2044 6f63 756d 656e 7420 4944  urn: Document ID
-00005ac0: 2063 7572 736f 722e 0a20 2020 2020 2020   cursor..       
-00005ad0: 203a 7274 7970 653a 2061 7261 6e67 6f2e   :rtype: arango.
-00005ae0: 6375 7273 6f72 2e43 7572 736f 720a 2020  cursor.Cursor.  
-00005af0: 2020 2020 2020 3a72 6169 7365 2061 7261        :raise ara
-00005b00: 6e67 6f2e 6578 6365 7074 696f 6e73 2e44  ngo.exceptions.D
-00005b10: 6f63 756d 656e 7449 4473 4572 726f 723a  ocumentIDsError:
-00005b20: 2049 6620 7265 7472 6965 7661 6c20 6661   If retrieval fa
-00005b30: 696c 732e 0a20 2020 2020 2020 2022 2222  ils..        """
-00005b40: 0a20 2020 2020 2020 2071 7565 7279 203d  .        query =
-00005b50: 2022 464f 5220 646f 6320 494e 2040 4063   "FOR doc IN @@c
-00005b60: 6f6c 6c65 6374 696f 6e20 5245 5455 524e  ollection RETURN
-00005b70: 2064 6f63 2e5f 6964 220a 2020 2020 2020   doc._id".      
-00005b80: 2020 6269 6e64 5f76 6172 7320 3d20 7b22    bind_vars = {"
-00005b90: 4063 6f6c 6c65 6374 696f 6e22 3a20 7365  @collection": se
-00005ba0: 6c66 2e6e 616d 657d 0a0a 2020 2020 2020  lf.name}..      
-00005bb0: 2020 7265 7175 6573 7420 3d20 5265 7175    request = Requ
-00005bc0: 6573 7428 0a20 2020 2020 2020 2020 2020  est(.           
-00005bd0: 206d 6574 686f 643d 2270 6f73 7422 2c0a   method="post",.
-00005be0: 2020 2020 2020 2020 2020 2020 656e 6470              endp
-00005bf0: 6f69 6e74 3d22 2f5f 6170 692f 6375 7273  oint="/_api/curs
-00005c00: 6f72 222c 0a20 2020 2020 2020 2020 2020  or",.           
-00005c10: 2064 6174 613d 7b22 7175 6572 7922 3a20   data={"query": 
-00005c20: 7175 6572 792c 2022 6269 6e64 5661 7273  query, "bindVars
-00005c30: 223a 2062 696e 645f 7661 7273 7d2c 0a20  ": bind_vars},. 
-00005c40: 2020 2020 2020 2020 2020 2072 6561 643d             read=
-00005c50: 7365 6c66 2e6e 616d 652c 0a20 2020 2020  self.name,.     
-00005c60: 2020 2020 2020 2068 6561 6465 7273 3d7b         headers={
-00005c70: 2278 2d61 7261 6e67 6f2d 616c 6c6f 772d  "x-arango-allow-
-00005c80: 6469 7274 792d 7265 6164 223a 2022 7472  dirty-read": "tr
-00005c90: 7565 227d 2069 6620 616c 6c6f 775f 6469  ue"} if allow_di
-00005ca0: 7274 795f 7265 6164 2065 6c73 6520 4e6f  rty_read else No
-00005cb0: 6e65 2c0a 2020 2020 2020 2020 290a 0a20  ne,.        ).. 
-00005cc0: 2020 2020 2020 2064 6566 2072 6573 706f         def respo
-00005cd0: 6e73 655f 6861 6e64 6c65 7228 7265 7370  nse_handler(resp
-00005ce0: 3a20 5265 7370 6f6e 7365 2920 2d3e 2043  : Response) -> C
-00005cf0: 7572 736f 723a 0a20 2020 2020 2020 2020  ursor:.         
-00005d00: 2020 2069 6620 6e6f 7420 7265 7370 2e69     if not resp.i
-00005d10: 735f 7375 6363 6573 733a 0a20 2020 2020  s_success:.     
-00005d20: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00005d30: 2044 6f63 756d 656e 7449 4473 4572 726f   DocumentIDsErro
-00005d40: 7228 7265 7370 2c20 7265 7175 6573 7429  r(resp, request)
-00005d50: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00005d60: 7572 6e20 4375 7273 6f72 2873 656c 662e  urn Cursor(self.
-00005d70: 5f63 6f6e 6e2c 2072 6573 702e 626f 6479  _conn, resp.body
-00005d80: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-00005d90: 6e20 7365 6c66 2e5f 6578 6563 7574 6528  n self._execute(
-00005da0: 7265 7175 6573 742c 2072 6573 706f 6e73  request, respons
-00005db0: 655f 6861 6e64 6c65 7229 0a0a 2020 2020  e_handler)..    
-00005dc0: 6465 6620 6b65 7973 2873 656c 662c 2061  def keys(self, a
-00005dd0: 6c6c 6f77 5f64 6972 7479 5f72 6561 643a  llow_dirty_read:
-00005de0: 2062 6f6f 6c20 3d20 4661 6c73 6529 202d   bool = False) -
-00005df0: 3e20 5265 7375 6c74 5b43 7572 736f 725d  > Result[Cursor]
-00005e00: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-00005e10: 7572 6e20 7468 6520 6b65 7973 206f 6620  urn the keys of 
-00005e20: 616c 6c20 646f 6375 6d65 6e74 7320 696e  all documents in
-00005e30: 2074 6865 2063 6f6c 6c65 6374 696f 6e2e   the collection.
-00005e40: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00005e50: 2061 6c6c 6f77 5f64 6972 7479 5f72 6561   allow_dirty_rea
-00005e60: 643a 2041 6c6c 6f77 2072 6561 6473 2066  d: Allow reads f
-00005e70: 726f 6d20 666f 6c6c 6f77 6572 7320 696e  rom followers in
-00005e80: 2061 2063 6c75 7374 6572 2e0a 2020 2020   a cluster..    
-00005e90: 2020 2020 3a74 7970 6520 616c 6c6f 775f      :type allow_
-00005ea0: 6469 7274 795f 7265 6164 3a20 626f 6f6c  dirty_read: bool
-00005eb0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-00005ec0: 3a20 446f 6375 6d65 6e74 206b 6579 2063  : Document key c
-00005ed0: 7572 736f 722e 0a20 2020 2020 2020 203a  ursor..        :
-00005ee0: 7274 7970 653a 2061 7261 6e67 6f2e 6375  rtype: arango.cu
-00005ef0: 7273 6f72 2e43 7572 736f 720a 2020 2020  rsor.Cursor.    
-00005f00: 2020 2020 3a72 6169 7365 2061 7261 6e67      :raise arang
-00005f10: 6f2e 6578 6365 7074 696f 6e73 2e44 6f63  o.exceptions.Doc
-00005f20: 756d 656e 744b 6579 7345 7272 6f72 3a20  umentKeysError: 
-00005f30: 4966 2072 6574 7269 6576 616c 2066 6169  If retrieval fai
-00005f40: 6c73 2e0a 2020 2020 2020 2020 2222 220a  ls..        """.
-00005f50: 2020 2020 2020 2020 7175 6572 7920 3d20          query = 
-00005f60: 2246 4f52 2064 6f63 2049 4e20 4040 636f  "FOR doc IN @@co
-00005f70: 6c6c 6563 7469 6f6e 2052 4554 5552 4e20  llection RETURN 
-00005f80: 646f 632e 5f6b 6579 220a 2020 2020 2020  doc._key".      
-00005f90: 2020 6269 6e64 5f76 6172 7320 3d20 7b22    bind_vars = {"
-00005fa0: 4063 6f6c 6c65 6374 696f 6e22 3a20 7365  @collection": se
-00005fb0: 6c66 2e6e 616d 657d 0a0a 2020 2020 2020  lf.name}..      
-00005fc0: 2020 7265 7175 6573 7420 3d20 5265 7175    request = Requ
-00005fd0: 6573 7428 0a20 2020 2020 2020 2020 2020  est(.           
-00005fe0: 206d 6574 686f 643d 2270 6f73 7422 2c0a   method="post",.
-00005ff0: 2020 2020 2020 2020 2020 2020 656e 6470              endp
-00006000: 6f69 6e74 3d22 2f5f 6170 692f 6375 7273  oint="/_api/curs
-00006010: 6f72 222c 0a20 2020 2020 2020 2020 2020  or",.           
-00006020: 2064 6174 613d 7b22 7175 6572 7922 3a20   data={"query": 
-00006030: 7175 6572 792c 2022 6269 6e64 5661 7273  query, "bindVars
-00006040: 223a 2062 696e 645f 7661 7273 7d2c 0a20  ": bind_vars},. 
-00006050: 2020 2020 2020 2020 2020 2072 6561 643d             read=
-00006060: 7365 6c66 2e6e 616d 652c 0a20 2020 2020  self.name,.     
-00006070: 2020 2020 2020 2068 6561 6465 7273 3d7b         headers={
-00006080: 2278 2d61 7261 6e67 6f2d 616c 6c6f 772d  "x-arango-allow-
-00006090: 6469 7274 792d 7265 6164 223a 2022 7472  dirty-read": "tr
-000060a0: 7565 227d 2069 6620 616c 6c6f 775f 6469  ue"} if allow_di
-000060b0: 7274 795f 7265 6164 2065 6c73 6520 4e6f  rty_read else No
-000060c0: 6e65 2c0a 2020 2020 2020 2020 290a 0a20  ne,.        ).. 
-000060d0: 2020 2020 2020 2064 6566 2072 6573 706f         def respo
-000060e0: 6e73 655f 6861 6e64 6c65 7228 7265 7370  nse_handler(resp
-000060f0: 3a20 5265 7370 6f6e 7365 2920 2d3e 2043  : Response) -> C
-00006100: 7572 736f 723a 0a20 2020 2020 2020 2020  ursor:.         
-00006110: 2020 2069 6620 6e6f 7420 7265 7370 2e69     if not resp.i
-00006120: 735f 7375 6363 6573 733a 0a20 2020 2020  s_success:.     
-00006130: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00006140: 2044 6f63 756d 656e 744b 6579 7345 7272   DocumentKeysErr
-00006150: 6f72 2872 6573 702c 2072 6571 7565 7374  or(resp, request
-00006160: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00006170: 7475 726e 2043 7572 736f 7228 7365 6c66  turn Cursor(self
-00006180: 2e5f 636f 6e6e 2c20 7265 7370 2e62 6f64  ._conn, resp.bod
-00006190: 7929 0a0a 2020 2020 2020 2020 7265 7475  y)..        retu
-000061a0: 726e 2073 656c 662e 5f65 7865 6375 7465  rn self._execute
-000061b0: 2872 6571 7565 7374 2c20 7265 7370 6f6e  (request, respon
-000061c0: 7365 5f68 616e 646c 6572 290a 0a20 2020  se_handler)..   
-000061d0: 2064 6566 2061 6c6c 280a 2020 2020 2020   def all(.      
-000061e0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-000061f0: 736b 6970 3a20 4f70 7469 6f6e 616c 5b69  skip: Optional[i
-00006200: 6e74 5d20 3d20 4e6f 6e65 2c0a 2020 2020  nt] = None,.    
-00006210: 2020 2020 6c69 6d69 743a 204f 7074 696f      limit: Optio
-00006220: 6e61 6c5b 696e 745d 203d 204e 6f6e 652c  nal[int] = None,
-00006230: 0a20 2020 2020 2020 2061 6c6c 6f77 5f64  .        allow_d
-00006240: 6972 7479 5f72 6561 643a 2062 6f6f 6c20  irty_read: bool 
-00006250: 3d20 4661 6c73 652c 0a20 2020 2029 202d  = False,.    ) -
-00006260: 3e20 5265 7375 6c74 5b43 7572 736f 725d  > Result[Cursor]
-00006270: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-00006280: 7572 6e20 616c 6c20 646f 6375 6d65 6e74  urn all document
-00006290: 7320 696e 2074 6865 2063 6f6c 6c65 6374  s in the collect
-000062a0: 696f 6e2e 0a0a 2020 2020 2020 2020 3a70  ion...        :p
-000062b0: 6172 616d 2073 6b69 703a 204e 756d 6265  aram skip: Numbe
-000062c0: 7220 6f66 2064 6f63 756d 656e 7473 2074  r of documents t
-000062d0: 6f20 736b 6970 2e0a 2020 2020 2020 2020  o skip..        
-000062e0: 3a74 7970 6520 736b 6970 3a20 696e 7420  :type skip: int 
-000062f0: 7c20 4e6f 6e65 0a20 2020 2020 2020 203a  | None.        :
-00006300: 7061 7261 6d20 6c69 6d69 743a 204d 6178  param limit: Max
-00006310: 206e 756d 6265 7220 6f66 2064 6f63 756d   number of docum
-00006320: 656e 7473 2072 6574 7572 6e65 642e 0a20  ents returned.. 
-00006330: 2020 2020 2020 203a 7479 7065 206c 696d         :type lim
-00006340: 6974 3a20 696e 7420 7c20 4e6f 6e65 0a20  it: int | None. 
-00006350: 2020 2020 2020 203a 7061 7261 6d20 616c         :param al
-00006360: 6c6f 775f 6469 7274 795f 7265 6164 3a20  low_dirty_read: 
-00006370: 416c 6c6f 7720 7265 6164 7320 6672 6f6d  Allow reads from
-00006380: 2066 6f6c 6c6f 7765 7273 2069 6e20 6120   followers in a 
-00006390: 636c 7573 7465 722e 0a20 2020 2020 2020  cluster..       
-000063a0: 203a 7479 7065 2061 6c6c 6f77 5f64 6972   :type allow_dir
-000063b0: 7479 5f72 6561 643a 2062 6f6f 6c0a 2020  ty_read: bool.  
-000063c0: 2020 2020 2020 3a72 6574 7572 6e3a 2044        :return: D
-000063d0: 6f63 756d 656e 7420 6375 7273 6f72 2e0a  ocument cursor..
-000063e0: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
-000063f0: 6172 616e 676f 2e63 7572 736f 722e 4375  arango.cursor.Cu
-00006400: 7273 6f72 0a20 2020 2020 2020 203a 7261  rsor.        :ra
-00006410: 6973 6520 6172 616e 676f 2e65 7863 6570  ise arango.excep
-00006420: 7469 6f6e 732e 446f 6375 6d65 6e74 4765  tions.DocumentGe
-00006430: 7445 7272 6f72 3a20 4966 2072 6574 7269  tError: If retri
-00006440: 6576 616c 2066 6169 6c73 2e0a 2020 2020  eval fails..    
-00006450: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00006460: 6173 7365 7274 2069 735f 6e6f 6e65 5f6f  assert is_none_o
-00006470: 725f 696e 7428 736b 6970 292c 2022 736b  r_int(skip), "sk
-00006480: 6970 206d 7573 7420 6265 2061 206e 6f6e  ip must be a non
-00006490: 2d6e 6567 6174 6976 6520 696e 7422 0a20  -negative int". 
-000064a0: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-000064b0: 5f6e 6f6e 655f 6f72 5f69 6e74 286c 696d  _none_or_int(lim
-000064c0: 6974 292c 2022 6c69 6d69 7420 6d75 7374  it), "limit must
-000064d0: 2062 6520 6120 6e6f 6e2d 6e65 6761 7469   be a non-negati
-000064e0: 7665 2069 6e74 220a 0a20 2020 2020 2020  ve int"..       
-000064f0: 2073 6b69 705f 7661 6c20 3d20 736b 6970   skip_val = skip
-00006500: 2069 6620 736b 6970 2069 7320 6e6f 7420   if skip is not 
-00006510: 4e6f 6e65 2065 6c73 6520 300a 2020 2020  None else 0.    
-00006520: 2020 2020 6c69 6d69 745f 7661 6c20 3d20      limit_val = 
-00006530: 6c69 6d69 7420 6966 206c 696d 6974 2069  limit if limit i
-00006540: 7320 6e6f 7420 4e6f 6e65 2065 6c73 6520  s not None else 
-00006550: 226e 756c 6c22 0a20 2020 2020 2020 2071  "null".        q
-00006560: 7565 7279 203d 2066 2222 220a 2020 2020  uery = f""".    
-00006570: 2020 2020 2020 2020 464f 5220 646f 6320          FOR doc 
-00006580: 494e 2040 4063 6f6c 6c65 6374 696f 6e0a  IN @@collection.
-00006590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000065a0: 4c49 4d49 5420 7b73 6b69 705f 7661 6c7d  LIMIT {skip_val}
-000065b0: 2c20 7b6c 696d 6974 5f76 616c 7d0a 2020  , {limit_val}.  
-000065c0: 2020 2020 2020 2020 2020 2020 2020 5245                RE
-000065d0: 5455 524e 2064 6f63 0a20 2020 2020 2020  TURN doc.       
-000065e0: 2022 2222 0a0a 2020 2020 2020 2020 6269   """..        bi
-000065f0: 6e64 5f76 6172 7320 3d20 7b22 4063 6f6c  nd_vars = {"@col
-00006600: 6c65 6374 696f 6e22 3a20 7365 6c66 2e6e  lection": self.n
-00006610: 616d 657d 0a0a 2020 2020 2020 2020 7265  ame}..        re
-00006620: 7175 6573 7420 3d20 5265 7175 6573 7428  quest = Request(
-00006630: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-00006640: 686f 643d 2270 6f73 7422 2c0a 2020 2020  hod="post",.    
-00006650: 2020 2020 2020 2020 656e 6470 6f69 6e74          endpoint
-00006660: 3d22 2f5f 6170 692f 6375 7273 6f72 222c  ="/_api/cursor",
-00006670: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-00006680: 613d 7b22 7175 6572 7922 3a20 7175 6572  a={"query": quer
-00006690: 792c 2022 6269 6e64 5661 7273 223a 2062  y, "bindVars": b
-000066a0: 696e 645f 7661 7273 2c20 2263 6f75 6e74  ind_vars, "count
-000066b0: 223a 2054 7275 657d 2c0a 2020 2020 2020  ": True},.      
-000066c0: 2020 2020 2020 7265 6164 3d73 656c 662e        read=self.
-000066d0: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-000066e0: 2020 6865 6164 6572 733d 7b22 782d 6172    headers={"x-ar
-000066f0: 616e 676f 2d61 6c6c 6f77 2d64 6972 7479  ango-allow-dirty
-00006700: 2d72 6561 6422 3a20 2274 7275 6522 7d20  -read": "true"} 
-00006710: 6966 2061 6c6c 6f77 5f64 6972 7479 5f72  if allow_dirty_r
-00006720: 6561 6420 656c 7365 204e 6f6e 652c 0a20  ead else None,. 
-00006730: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00006740: 2020 6465 6620 7265 7370 6f6e 7365 5f68    def response_h
-00006750: 616e 646c 6572 2872 6573 703a 2052 6573  andler(resp: Res
-00006760: 706f 6e73 6529 202d 3e20 4375 7273 6f72  ponse) -> Cursor
-00006770: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00006780: 206e 6f74 2072 6573 702e 6973 5f73 7563   not resp.is_suc
-00006790: 6365 7373 3a0a 2020 2020 2020 2020 2020  cess:.          
-000067a0: 2020 2020 2020 7261 6973 6520 446f 6375        raise Docu
-000067b0: 6d65 6e74 4765 7445 7272 6f72 2872 6573  mentGetError(res
-000067c0: 702c 2072 6571 7565 7374 290a 2020 2020  p, request).    
-000067d0: 2020 2020 2020 2020 7265 7475 726e 2043          return C
-000067e0: 7572 736f 7228 7365 6c66 2e5f 636f 6e6e  ursor(self._conn
-000067f0: 2c20 7265 7370 2e62 6f64 7929 0a0a 2020  , resp.body)..  
-00006800: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00006810: 662e 5f65 7865 6375 7465 2872 6571 7565  f._execute(reque
-00006820: 7374 2c20 7265 7370 6f6e 7365 5f68 616e  st, response_han
-00006830: 646c 6572 290a 0a20 2020 2064 6566 2066  dler)..    def f
-00006840: 696e 6428 0a20 2020 2020 2020 2073 656c  ind(.        sel
-00006850: 662c 0a20 2020 2020 2020 2066 696c 7465  f,.        filte
-00006860: 7273 3a20 4a73 6f6e 2c0a 2020 2020 2020  rs: Json,.      
-00006870: 2020 736b 6970 3a20 4f70 7469 6f6e 616c    skip: Optional
-00006880: 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a 2020  [int] = None,.  
-00006890: 2020 2020 2020 6c69 6d69 743a 204f 7074        limit: Opt
-000068a0: 696f 6e61 6c5b 696e 745d 203d 204e 6f6e  ional[int] = Non
-000068b0: 652c 0a20 2020 2020 2020 2061 6c6c 6f77  e,.        allow
-000068c0: 5f64 6972 7479 5f72 6561 643a 2062 6f6f  _dirty_read: boo
-000068d0: 6c20 3d20 4661 6c73 652c 0a20 2020 2029  l = False,.    )
-000068e0: 202d 3e20 5265 7375 6c74 5b43 7572 736f   -> Result[Curso
-000068f0: 725d 3a0a 2020 2020 2020 2020 2222 2252  r]:.        """R
-00006900: 6574 7572 6e20 616c 6c20 646f 6375 6d65  eturn all docume
-00006910: 6e74 7320 7468 6174 206d 6174 6368 2074  nts that match t
-00006920: 6865 2067 6976 656e 2066 696c 7465 7273  he given filters
-00006930: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-00006940: 6d20 6669 6c74 6572 733a 2044 6f63 756d  m filters: Docum
-00006950: 656e 7420 6669 6c74 6572 732e 0a20 2020  ent filters..   
-00006960: 2020 2020 203a 7479 7065 2066 696c 7465       :type filte
-00006970: 7273 3a20 6469 6374 0a20 2020 2020 2020  rs: dict.       
-00006980: 203a 7061 7261 6d20 736b 6970 3a20 4e75   :param skip: Nu
-00006990: 6d62 6572 206f 6620 646f 6375 6d65 6e74  mber of document
-000069a0: 7320 746f 2073 6b69 702e 0a20 2020 2020  s to skip..     
-000069b0: 2020 203a 7479 7065 2073 6b69 703a 2069     :type skip: i
-000069c0: 6e74 207c 204e 6f6e 650a 2020 2020 2020  nt | None.      
-000069d0: 2020 3a70 6172 616d 206c 696d 6974 3a20    :param limit: 
-000069e0: 4d61 7820 6e75 6d62 6572 206f 6620 646f  Max number of do
-000069f0: 6375 6d65 6e74 7320 7265 7475 726e 6564  cuments returned
-00006a00: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
-00006a10: 6c69 6d69 743a 2069 6e74 207c 204e 6f6e  limit: int | Non
-00006a20: 650a 2020 2020 2020 2020 3a70 6172 616d  e.        :param
-00006a30: 2061 6c6c 6f77 5f64 6972 7479 5f72 6561   allow_dirty_rea
-00006a40: 643a 2041 6c6c 6f77 2072 6561 6473 2066  d: Allow reads f
-00006a50: 726f 6d20 666f 6c6c 6f77 6572 7320 696e  rom followers in
-00006a60: 2061 2063 6c75 7374 6572 2e0a 2020 2020   a cluster..    
-00006a70: 2020 2020 3a74 7970 6520 616c 6c6f 775f      :type allow_
-00006a80: 6469 7274 795f 7265 6164 3a20 626f 6f6c  dirty_read: bool
-00006a90: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-00006aa0: 3a20 446f 6375 6d65 6e74 2063 7572 736f  : Document curso
-00006ab0: 722e 0a20 2020 2020 2020 203a 7274 7970  r..        :rtyp
-00006ac0: 653a 2061 7261 6e67 6f2e 6375 7273 6f72  e: arango.cursor
-00006ad0: 2e43 7572 736f 720a 2020 2020 2020 2020  .Cursor.        
-00006ae0: 3a72 6169 7365 2061 7261 6e67 6f2e 6578  :raise arango.ex
-00006af0: 6365 7074 696f 6e73 2e44 6f63 756d 656e  ceptions.Documen
-00006b00: 7447 6574 4572 726f 723a 2049 6620 7265  tGetError: If re
-00006b10: 7472 6965 7661 6c20 6661 696c 732e 0a20  trieval fails.. 
-00006b20: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00006b30: 2020 2061 7373 6572 7420 6973 696e 7374     assert isinst
-00006b40: 616e 6365 2866 696c 7465 7273 2c20 6469  ance(filters, di
-00006b50: 6374 292c 2022 6669 6c74 6572 7320 6d75  ct), "filters mu
-00006b60: 7374 2062 6520 6120 6469 6374 220a 2020  st be a dict".  
-00006b70: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
-00006b80: 6e6f 6e65 5f6f 725f 696e 7428 736b 6970  none_or_int(skip
-00006b90: 292c 2022 736b 6970 206d 7573 7420 6265  ), "skip must be
-00006ba0: 2061 206e 6f6e 2d6e 6567 6174 6976 6520   a non-negative 
-00006bb0: 696e 7422 0a20 2020 2020 2020 2061 7373  int".        ass
-00006bc0: 6572 7420 6973 5f6e 6f6e 655f 6f72 5f69  ert is_none_or_i
-00006bd0: 6e74 286c 696d 6974 292c 2022 6c69 6d69  nt(limit), "limi
-00006be0: 7420 6d75 7374 2062 6520 6120 6e6f 6e2d  t must be a non-
-00006bf0: 6e65 6761 7469 7665 2069 6e74 220a 0a20  negative int".. 
-00006c00: 2020 2020 2020 2073 6b69 705f 7661 6c20         skip_val 
-00006c10: 3d20 736b 6970 2069 6620 736b 6970 2069  = skip if skip i
-00006c20: 7320 6e6f 7420 4e6f 6e65 2065 6c73 6520  s not None else 
-00006c30: 300a 2020 2020 2020 2020 6c69 6d69 745f  0.        limit_
-00006c40: 7661 6c20 3d20 6c69 6d69 7420 6966 206c  val = limit if l
-00006c50: 696d 6974 2069 7320 6e6f 7420 4e6f 6e65  imit is not None
-00006c60: 2065 6c73 6520 226e 756c 6c22 0a20 2020   else "null".   
-00006c70: 2020 2020 2071 7565 7279 203d 2066 2222       query = f""
-00006c80: 220a 2020 2020 2020 2020 2020 2020 464f  ".            FO
-00006c90: 5220 646f 6320 494e 2040 4063 6f6c 6c65  R doc IN @@colle
-00006ca0: 6374 696f 6e0a 2020 2020 2020 2020 2020  ction.          
-00006cb0: 2020 2020 2020 7b62 7569 6c64 5f66 696c        {build_fil
-00006cc0: 7465 725f 636f 6e64 6974 696f 6e73 2866  ter_conditions(f
-00006cd0: 696c 7465 7273 297d 0a20 2020 2020 2020  ilters)}.       
-00006ce0: 2020 2020 2020 2020 204c 494d 4954 207b           LIMIT {
-00006cf0: 736b 6970 5f76 616c 7d2c 207b 6c69 6d69  skip_val}, {limi
-00006d00: 745f 7661 6c7d 0a20 2020 2020 2020 2020  t_val}.         
-00006d10: 2020 2020 2020 2052 4554 5552 4e20 646f         RETURN do
-00006d20: 630a 2020 2020 2020 2020 2222 220a 0a20  c.        """.. 
-00006d30: 2020 2020 2020 2062 696e 645f 7661 7273         bind_vars
-00006d40: 203d 207b 2240 636f 6c6c 6563 7469 6f6e   = {"@collection
-00006d50: 223a 2073 656c 662e 6e61 6d65 7d0a 0a20  ": self.name}.. 
-00006d60: 2020 2020 2020 2072 6571 7565 7374 203d         request =
-00006d70: 2052 6571 7565 7374 280a 2020 2020 2020   Request(.      
-00006d80: 2020 2020 2020 6d65 7468 6f64 3d22 706f        method="po
-00006d90: 7374 222c 0a20 2020 2020 2020 2020 2020  st",.           
-00006da0: 2065 6e64 706f 696e 743d 222f 5f61 7069   endpoint="/_api
-00006db0: 2f63 7572 736f 7222 2c0a 2020 2020 2020  /cursor",.      
-00006dc0: 2020 2020 2020 6461 7461 3d7b 2271 7565        data={"que
-00006dd0: 7279 223a 2071 7565 7279 2c20 2262 696e  ry": query, "bin
-00006de0: 6456 6172 7322 3a20 6269 6e64 5f76 6172  dVars": bind_var
-00006df0: 732c 2022 636f 756e 7422 3a20 5472 7565  s, "count": True
-00006e00: 7d2c 0a20 2020 2020 2020 2020 2020 2072  },.            r
-00006e10: 6561 643d 7365 6c66 2e6e 616d 652c 0a20  ead=self.name,. 
-00006e20: 2020 2020 2020 2020 2020 2068 6561 6465             heade
-00006e30: 7273 3d7b 2278 2d61 7261 6e67 6f2d 616c  rs={"x-arango-al
-00006e40: 6c6f 772d 6469 7274 792d 7265 6164 223a  low-dirty-read":
-00006e50: 2022 7472 7565 227d 2069 6620 616c 6c6f   "true"} if allo
-00006e60: 775f 6469 7274 795f 7265 6164 2065 6c73  w_dirty_read els
-00006e70: 6520 4e6f 6e65 2c0a 2020 2020 2020 2020  e None,.        
-00006e80: 290a 0a20 2020 2020 2020 2064 6566 2072  )..        def r
-00006e90: 6573 706f 6e73 655f 6861 6e64 6c65 7228  esponse_handler(
-00006ea0: 7265 7370 3a20 5265 7370 6f6e 7365 2920  resp: Response) 
-00006eb0: 2d3e 2043 7572 736f 723a 0a20 2020 2020  -> Cursor:.     
-00006ec0: 2020 2020 2020 2069 6620 6e6f 7420 7265         if not re
-00006ed0: 7370 2e69 735f 7375 6363 6573 733a 0a20  sp.is_success:. 
-00006ee0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00006ef0: 6169 7365 2044 6f63 756d 656e 7447 6574  aise DocumentGet
-00006f00: 4572 726f 7228 7265 7370 2c20 7265 7175  Error(resp, requ
-00006f10: 6573 7429 0a20 2020 2020 2020 2020 2020  est).           
-00006f20: 2072 6574 7572 6e20 4375 7273 6f72 2873   return Cursor(s
-00006f30: 656c 662e 5f63 6f6e 6e2c 2072 6573 702e  elf._conn, resp.
-00006f40: 626f 6479 290a 0a20 2020 2020 2020 2072  body)..        r
-00006f50: 6574 7572 6e20 7365 6c66 2e5f 6578 6563  eturn self._exec
-00006f60: 7574 6528 7265 7175 6573 742c 2072 6573  ute(request, res
-00006f70: 706f 6e73 655f 6861 6e64 6c65 7229 0a0a  ponse_handler)..
-00006f80: 2020 2020 6465 6620 6669 6e64 5f6e 6561      def find_nea
-00006f90: 7228 0a20 2020 2020 2020 2073 656c 662c  r(.        self,
-00006fa0: 0a20 2020 2020 2020 206c 6174 6974 7564  .        latitud
-00006fb0: 653a 204e 756d 6265 722c 0a20 2020 2020  e: Number,.     
-00006fc0: 2020 206c 6f6e 6769 7475 6465 3a20 4e75     longitude: Nu
-00006fd0: 6d62 6572 2c0a 2020 2020 2020 2020 6c69  mber,.        li
-00006fe0: 6d69 743a 204f 7074 696f 6e61 6c5b 696e  mit: Optional[in
-00006ff0: 745d 203d 204e 6f6e 652c 0a20 2020 2020  t] = None,.     
-00007000: 2020 2061 6c6c 6f77 5f64 6972 7479 5f72     allow_dirty_r
-00007010: 6561 643a 2062 6f6f 6c20 3d20 4661 6c73  ead: bool = Fals
-00007020: 652c 0a20 2020 2029 202d 3e20 5265 7375  e,.    ) -> Resu
-00007030: 6c74 5b43 7572 736f 725d 3a0a 2020 2020  lt[Cursor]:.    
-00007040: 2020 2020 2222 2252 6574 7572 6e20 646f      """Return do
-00007050: 6375 6d65 6e74 7320 6e65 6172 2061 2067  cuments near a g
-00007060: 6976 656e 2063 6f6f 7264 696e 6174 652e  iven coordinate.
-00007070: 0a0a 2020 2020 2020 2020 446f 6375 6d65  ..        Docume
-00007080: 6e74 7320 7265 7475 726e 6564 2061 7265  nts returned are
-00007090: 2073 6f72 7465 6420 6163 636f 7264 696e   sorted accordin
-000070a0: 6720 746f 2064 6973 7461 6e63 652c 2077  g to distance, w
-000070b0: 6974 6820 7468 6520 6e65 6172 6573 740a  ith the nearest.
-000070c0: 2020 2020 2020 2020 646f 6375 6d65 6e74          document
-000070d0: 2062 6569 6e67 2074 6865 2066 6972 7374   being the first
-000070e0: 2e20 4966 2074 6865 7265 2061 7265 2064  . If there are d
-000070f0: 6f63 756d 656e 7473 206f 6620 6571 7561  ocuments of equa
-00007100: 6c20 6469 7374 616e 6365 2c0a 2020 2020  l distance,.    
-00007110: 2020 2020 7468 6579 2061 7265 2072 616e      they are ran
-00007120: 646f 6d6c 7920 6368 6f73 656e 2066 726f  domly chosen fro
-00007130: 6d20 7468 6520 7365 7420 756e 7469 6c20  m the set until 
-00007140: 7468 6520 6c69 6d69 7420 6973 2072 6561  the limit is rea
-00007150: 6368 6564 2e20 4120 6765 6f0a 2020 2020  ched. A geo.    
-00007160: 2020 2020 696e 6465 7820 6d75 7374 2062      index must b
-00007170: 6520 6465 6669 6e65 6420 696e 2074 6865  e defined in the
-00007180: 2063 6f6c 6c65 6374 696f 6e20 746f 2075   collection to u
-00007190: 7365 2074 6869 7320 6d65 7468 6f64 2e0a  se this method..
-000071a0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-000071b0: 6c61 7469 7475 6465 3a20 4c61 7469 7475  latitude: Latitu
-000071c0: 6465 2e0a 2020 2020 2020 2020 3a74 7970  de..        :typ
-000071d0: 6520 6c61 7469 7475 6465 3a20 696e 7420  e latitude: int 
-000071e0: 7c20 666c 6f61 740a 2020 2020 2020 2020  | float.        
-000071f0: 3a70 6172 616d 206c 6f6e 6769 7475 6465  :param longitude
-00007200: 3a20 4c6f 6e67 6974 7564 652e 0a20 2020  : Longitude..   
-00007210: 2020 2020 203a 7479 7065 206c 6f6e 6769       :type longi
-00007220: 7475 6465 3a20 696e 7420 7c20 666c 6f61  tude: int | floa
-00007230: 740a 2020 2020 2020 2020 3a70 6172 616d  t.        :param
-00007240: 206c 696d 6974 3a20 4d61 7820 6e75 6d62   limit: Max numb
-00007250: 6572 206f 6620 646f 6375 6d65 6e74 7320  er of documents 
-00007260: 7265 7475 726e 6564 2e0a 2020 2020 2020  returned..      
-00007270: 2020 3a74 7970 6520 6c69 6d69 743a 2069    :type limit: i
-00007280: 6e74 207c 204e 6f6e 650a 2020 2020 2020  nt | None.      
-00007290: 2020 3a70 6172 616d 2061 6c6c 6f77 5f64    :param allow_d
-000072a0: 6972 7479 5f72 6561 643a 2041 6c6c 6f77  irty_read: Allow
-000072b0: 2072 6561 6473 2066 726f 6d20 666f 6c6c   reads from foll
-000072c0: 6f77 6572 7320 696e 2061 2063 6c75 7374  owers in a clust
-000072d0: 6572 2e0a 2020 2020 2020 2020 3a74 7970  er..        :typ
-000072e0: 6520 616c 6c6f 775f 6469 7274 795f 7265  e allow_dirty_re
-000072f0: 6164 3a20 626f 6f6c 0a20 2020 2020 2020  ad: bool.       
-00007300: 203a 7265 7475 726e 733a 2044 6f63 756d   :returns: Docum
-00007310: 656e 7420 6375 7273 6f72 2e0a 2020 2020  ent cursor..    
-00007320: 2020 2020 3a72 7479 7065 3a20 6172 616e      :rtype: aran
-00007330: 676f 2e63 7572 736f 722e 4375 7273 6f72  go.cursor.Cursor
-00007340: 0a20 2020 2020 2020 203a 7261 6973 6573  .        :raises
-00007350: 2061 7261 6e67 6f2e 6578 6365 7074 696f   arango.exceptio
-00007360: 6e73 2e44 6f63 756d 656e 7447 6574 4572  ns.DocumentGetEr
-00007370: 726f 723a 2049 6620 7265 7472 6965 7661  ror: If retrieva
-00007380: 6c20 6661 696c 732e 0a20 2020 2020 2020  l fails..       
-00007390: 2022 2222 0a20 2020 2020 2020 2061 7373   """.        ass
-000073a0: 6572 7420 6973 696e 7374 616e 6365 286c  ert isinstance(l
-000073b0: 6174 6974 7564 652c 204e 756d 6265 7229  atitude, Number)
-000073c0: 2c20 226c 6174 6974 7564 6520 6d75 7374  , "latitude must
-000073d0: 2062 6520 6120 6e75 6d62 6572 220a 2020   be a number".  
-000073e0: 2020 2020 2020 6173 7365 7274 2069 7369        assert isi
-000073f0: 6e73 7461 6e63 6528 6c6f 6e67 6974 7564  nstance(longitud
-00007400: 652c 204e 756d 6265 7229 2c20 226c 6f6e  e, Number), "lon
-00007410: 6769 7475 6465 206d 7573 7420 6265 2061  gitude must be a
-00007420: 206e 756d 6265 7222 0a20 2020 2020 2020   number".       
-00007430: 2061 7373 6572 7420 6973 5f6e 6f6e 655f   assert is_none_
-00007440: 6f72 5f69 6e74 286c 696d 6974 292c 2022  or_int(limit), "
-00007450: 6c69 6d69 7420 6d75 7374 2062 6520 6120  limit must be a 
-00007460: 6e6f 6e2d 6e65 6761 7469 7665 2069 6e74  non-negative int
-00007470: 220a 0a20 2020 2020 2020 2071 7565 7279  "..        query
-00007480: 203d 2022 2222 0a20 2020 2020 2020 2046   = """.        F
-00007490: 4f52 2064 6f63 2049 4e20 4e45 4152 2840  OR doc IN NEAR(@
-000074a0: 636f 6c6c 6563 7469 6f6e 2c20 406c 6174  collection, @lat
-000074b0: 6974 7564 652c 2040 6c6f 6e67 6974 7564  itude, @longitud
-000074c0: 657b 7d29 0a20 2020 2020 2020 2020 2020  e{}).           
-000074d0: 2052 4554 5552 4e20 646f 630a 2020 2020   RETURN doc.    
-000074e0: 2020 2020 2222 222e 666f 726d 6174 280a      """.format(.
-000074f0: 2020 2020 2020 2020 2020 2020 2222 2069              "" i
-00007500: 6620 6c69 6d69 7420 6973 204e 6f6e 6520  f limit is None 
-00007510: 656c 7365 2022 2c20 406c 696d 6974 2022  else ", @limit "
-00007520: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00007530: 2020 2020 6269 6e64 5f76 6172 7320 3d20      bind_vars = 
-00007540: 7b0a 2020 2020 2020 2020 2020 2020 2263  {.            "c
-00007550: 6f6c 6c65 6374 696f 6e22 3a20 7365 6c66  ollection": self
-00007560: 2e5f 6e61 6d65 2c0a 2020 2020 2020 2020  ._name,.        
-00007570: 2020 2020 226c 6174 6974 7564 6522 3a20      "latitude": 
-00007580: 6c61 7469 7475 6465 2c0a 2020 2020 2020  latitude,.      
-00007590: 2020 2020 2020 226c 6f6e 6769 7475 6465        "longitude
-000075a0: 223a 206c 6f6e 6769 7475 6465 2c0a 2020  ": longitude,.  
-000075b0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-000075c0: 6966 206c 696d 6974 2069 7320 6e6f 7420  if limit is not 
-000075d0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-000075e0: 2020 6269 6e64 5f76 6172 735b 226c 696d    bind_vars["lim
-000075f0: 6974 225d 203d 206c 696d 6974 0a0a 2020  it"] = limit..  
-00007600: 2020 2020 2020 7265 7175 6573 7420 3d20        request = 
-00007610: 5265 7175 6573 7428 0a20 2020 2020 2020  Request(.       
-00007620: 2020 2020 206d 6574 686f 643d 2270 6f73       method="pos
-00007630: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
-00007640: 656e 6470 6f69 6e74 3d22 2f5f 6170 692f  endpoint="/_api/
-00007650: 6375 7273 6f72 222c 0a20 2020 2020 2020  cursor",.       
-00007660: 2020 2020 2064 6174 613d 7b22 7175 6572       data={"quer
-00007670: 7922 3a20 7175 6572 792c 2022 6269 6e64  y": query, "bind
-00007680: 5661 7273 223a 2062 696e 645f 7661 7273  Vars": bind_vars
-00007690: 2c20 2263 6f75 6e74 223a 2054 7275 657d  , "count": True}
-000076a0: 2c0a 2020 2020 2020 2020 2020 2020 7265  ,.            re
-000076b0: 6164 3d73 656c 662e 6e61 6d65 2c0a 2020  ad=self.name,.  
-000076c0: 2020 2020 2020 2020 2020 6865 6164 6572            header
-000076d0: 733d 7b22 782d 6172 616e 676f 2d61 6c6c  s={"x-arango-all
-000076e0: 6f77 2d64 6972 7479 2d72 6561 6422 3a20  ow-dirty-read": 
-000076f0: 2274 7275 6522 7d20 6966 2061 6c6c 6f77  "true"} if allow
-00007700: 5f64 6972 7479 5f72 6561 6420 656c 7365  _dirty_read else
-00007710: 204e 6f6e 652c 0a20 2020 2020 2020 2029   None,.        )
-00007720: 0a0a 2020 2020 2020 2020 6465 6620 7265  ..        def re
-00007730: 7370 6f6e 7365 5f68 616e 646c 6572 2872  sponse_handler(r
-00007740: 6573 703a 2052 6573 706f 6e73 6529 202d  esp: Response) -
-00007750: 3e20 4375 7273 6f72 3a0a 2020 2020 2020  > Cursor:.      
-00007760: 2020 2020 2020 6966 206e 6f74 2072 6573        if not res
-00007770: 702e 6973 5f73 7563 6365 7373 3a0a 2020  p.is_success:.  
-00007780: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00007790: 6973 6520 446f 6375 6d65 6e74 4765 7445  ise DocumentGetE
-000077a0: 7272 6f72 2872 6573 702c 2072 6571 7565  rror(resp, reque
-000077b0: 7374 290a 2020 2020 2020 2020 2020 2020  st).            
-000077c0: 7265 7475 726e 2043 7572 736f 7228 7365  return Cursor(se
-000077d0: 6c66 2e5f 636f 6e6e 2c20 7265 7370 2e62  lf._conn, resp.b
-000077e0: 6f64 7929 0a0a 2020 2020 2020 2020 7265  ody)..        re
-000077f0: 7475 726e 2073 656c 662e 5f65 7865 6375  turn self._execu
-00007800: 7465 2872 6571 7565 7374 2c20 7265 7370  te(request, resp
-00007810: 6f6e 7365 5f68 616e 646c 6572 290a 0a20  onse_handler).. 
-00007820: 2020 2064 6566 2066 696e 645f 696e 5f72     def find_in_r
-00007830: 616e 6765 280a 2020 2020 2020 2020 7365  ange(.        se
-00007840: 6c66 2c0a 2020 2020 2020 2020 6669 656c  lf,.        fiel
-00007850: 643a 2073 7472 2c0a 2020 2020 2020 2020  d: str,.        
-00007860: 6c6f 7765 723a 2069 6e74 2c0a 2020 2020  lower: int,.    
-00007870: 2020 2020 7570 7065 723a 2069 6e74 2c0a      upper: int,.
-00007880: 2020 2020 2020 2020 736b 6970 3a20 4f70          skip: Op
-00007890: 7469 6f6e 616c 5b69 6e74 5d20 3d20 4e6f  tional[int] = No
-000078a0: 6e65 2c0a 2020 2020 2020 2020 6c69 6d69  ne,.        limi
-000078b0: 743a 204f 7074 696f 6e61 6c5b 696e 745d  t: Optional[int]
-000078c0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-000078d0: 2061 6c6c 6f77 5f64 6972 7479 5f72 6561   allow_dirty_rea
-000078e0: 643a 2062 6f6f 6c20 3d20 4661 6c73 652c  d: bool = False,
-000078f0: 0a20 2020 2029 202d 3e20 5265 7375 6c74  .    ) -> Result
-00007900: 5b43 7572 736f 725d 3a0a 2020 2020 2020  [Cursor]:.      
-00007910: 2020 2222 2252 6574 7572 6e20 646f 6375    """Return docu
-00007920: 6d65 6e74 7320 7769 7468 696e 2061 2067  ments within a g
-00007930: 6976 656e 2072 616e 6765 2069 6e20 6120  iven range in a 
-00007940: 7261 6e64 6f6d 206f 7264 6572 2e0a 0a20  random order... 
-00007950: 2020 2020 2020 2041 2073 6b69 706c 6973         A skiplis
-00007960: 7420 696e 6465 7820 6d75 7374 2062 6520  t index must be 
-00007970: 6465 6669 6e65 6420 696e 2074 6865 2063  defined in the c
-00007980: 6f6c 6c65 6374 696f 6e20 746f 2075 7365  ollection to use
-00007990: 2074 6869 7320 6d65 7468 6f64 2e0a 0a20   this method... 
-000079a0: 2020 2020 2020 203a 7061 7261 6d20 6669         :param fi
-000079b0: 656c 643a 2044 6f63 756d 656e 7420 6669  eld: Document fi
-000079c0: 656c 6420 6e61 6d65 2e0a 2020 2020 2020  eld name..      
-000079d0: 2020 3a74 7970 6520 6669 656c 643a 2073    :type field: s
-000079e0: 7472 0a20 2020 2020 2020 203a 7061 7261  tr.        :para
-000079f0: 6d20 6c6f 7765 723a 204c 6f77 6572 2062  m lower: Lower b
-00007a00: 6f75 6e64 2028 696e 636c 7573 6976 6529  ound (inclusive)
-00007a10: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
-00007a20: 6c6f 7765 723a 2069 6e74 0a20 2020 2020  lower: int.     
-00007a30: 2020 203a 7061 7261 6d20 7570 7065 723a     :param upper:
-00007a40: 2055 7070 6572 2062 6f75 6e64 2028 6578   Upper bound (ex
-00007a50: 636c 7573 6976 6529 2e0a 2020 2020 2020  clusive)..      
-00007a60: 2020 3a74 7970 6520 7570 7065 723a 2069    :type upper: i
-00007a70: 6e74 0a20 2020 2020 2020 203a 7061 7261  nt.        :para
-00007a80: 6d20 736b 6970 3a20 4e75 6d62 6572 206f  m skip: Number o
-00007a90: 6620 646f 6375 6d65 6e74 7320 746f 2073  f documents to s
-00007aa0: 6b69 702e 0a20 2020 2020 2020 203a 7479  kip..        :ty
-00007ab0: 7065 2073 6b69 703a 2069 6e74 207c 204e  pe skip: int | N
-00007ac0: 6f6e 650a 2020 2020 2020 2020 3a70 6172  one.        :par
-00007ad0: 616d 206c 696d 6974 3a20 4d61 7820 6e75  am limit: Max nu
-00007ae0: 6d62 6572 206f 6620 646f 6375 6d65 6e74  mber of document
-00007af0: 7320 7265 7475 726e 6564 2e0a 2020 2020  s returned..    
-00007b00: 2020 2020 3a74 7970 6520 6c69 6d69 743a      :type limit:
-00007b10: 2069 6e74 207c 204e 6f6e 650a 2020 2020   int | None.    
-00007b20: 2020 2020 3a70 6172 616d 2061 6c6c 6f77      :param allow
-00007b30: 5f64 6972 7479 5f72 6561 643a 2041 6c6c  _dirty_read: All
-00007b40: 6f77 2072 6561 6473 2066 726f 6d20 666f  ow reads from fo
-00007b50: 6c6c 6f77 6572 7320 696e 2061 2063 6c75  llowers in a clu
-00007b60: 7374 6572 2e0a 2020 2020 2020 2020 3a74  ster..        :t
-00007b70: 7970 6520 616c 6c6f 775f 6469 7274 795f  ype allow_dirty_
-00007b80: 7265 6164 3a20 626f 6f6c 0a20 2020 2020  read: bool.     
-00007b90: 2020 203a 7265 7475 726e 733a 2044 6f63     :returns: Doc
-00007ba0: 756d 656e 7420 6375 7273 6f72 2e0a 2020  ument cursor..  
-00007bb0: 2020 2020 2020 3a72 7479 7065 3a20 6172        :rtype: ar
-00007bc0: 616e 676f 2e63 7572 736f 722e 4375 7273  ango.cursor.Curs
-00007bd0: 6f72 0a20 2020 2020 2020 203a 7261 6973  or.        :rais
-00007be0: 6573 2061 7261 6e67 6f2e 6578 6365 7074  es arango.except
-00007bf0: 696f 6e73 2e44 6f63 756d 656e 7447 6574  ions.DocumentGet
-00007c00: 4572 726f 723a 2049 6620 7265 7472 6965  Error: If retrie
-00007c10: 7661 6c20 6661 696c 732e 0a20 2020 2020  val fails..     
-00007c20: 2020 2022 2222 0a20 2020 2020 2020 2061     """.        a
-00007c30: 7373 6572 7420 6973 5f6e 6f6e 655f 6f72  ssert is_none_or
-00007c40: 5f69 6e74 2873 6b69 7029 2c20 2273 6b69  _int(skip), "ski
-00007c50: 7020 6d75 7374 2062 6520 6120 6e6f 6e2d  p must be a non-
-00007c60: 6e65 6761 7469 7665 2069 6e74 220a 2020  negative int".  
-00007c70: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
-00007c80: 6e6f 6e65 5f6f 725f 696e 7428 6c69 6d69  none_or_int(limi
-00007c90: 7429 2c20 226c 696d 6974 206d 7573 7420  t), "limit must 
-00007ca0: 6265 2061 206e 6f6e 2d6e 6567 6174 6976  be a non-negativ
-00007cb0: 6520 696e 7422 0a0a 2020 2020 2020 2020  e int"..        
-00007cc0: 6269 6e64 5f76 6172 7320 3d20 7b0a 2020  bind_vars = {.  
-00007cd0: 2020 2020 2020 2020 2020 2240 636f 6c6c            "@coll
-00007ce0: 6563 7469 6f6e 223a 2073 656c 662e 5f6e  ection": self._n
-00007cf0: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-00007d00: 2022 6669 656c 6422 3a20 6669 656c 642c   "field": field,
-00007d10: 0a20 2020 2020 2020 2020 2020 2022 6c6f  .            "lo
-00007d20: 7765 7222 3a20 6c6f 7765 722c 0a20 2020  wer": lower,.   
-00007d30: 2020 2020 2020 2020 2022 7570 7065 7222           "upper"
-00007d40: 3a20 7570 7065 722c 0a20 2020 2020 2020  : upper,.       
-00007d50: 2020 2020 2022 736b 6970 223a 2030 2069       "skip": 0 i
-00007d60: 6620 736b 6970 2069 7320 4e6f 6e65 2065  f skip is None e
-00007d70: 6c73 6520 736b 6970 2c0a 2020 2020 2020  lse skip,.      
-00007d80: 2020 2020 2020 226c 696d 6974 223a 2032        "limit": 2
-00007d90: 3134 3734 3833 3634 3720 6966 206c 696d  147483647 if lim
-00007da0: 6974 2069 7320 4e6f 6e65 2065 6c73 6520  it is None else 
-00007db0: 6c69 6d69 742c 2020 2320 3220 5e20 3331  limit,  # 2 ^ 31
-00007dc0: 202d 2031 0a20 2020 2020 2020 207d 0a0a   - 1.        }..
-00007dd0: 2020 2020 2020 2020 7175 6572 7920 3d20          query = 
-00007de0: 2222 220a 2020 2020 2020 2020 464f 5220  """.        FOR 
-00007df0: 646f 6320 494e 2040 4063 6f6c 6c65 6374  doc IN @@collect
-00007e00: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
-00007e10: 4649 4c54 4552 2064 6f63 2e40 6669 656c  FILTER doc.@fiel
-00007e20: 6420 3e3d 2040 6c6f 7765 7220 2626 2064  d >= @lower && d
-00007e30: 6f63 2e40 6669 656c 6420 3c20 4075 7070  oc.@field < @upp
-00007e40: 6572 0a20 2020 2020 2020 2020 2020 204c  er.            L
-00007e50: 494d 4954 2040 736b 6970 2c20 406c 696d  IMIT @skip, @lim
-00007e60: 6974 0a20 2020 2020 2020 2020 2020 2052  it.            R
-00007e70: 4554 5552 4e20 646f 630a 2020 2020 2020  ETURN doc.      
-00007e80: 2020 2222 220a 0a20 2020 2020 2020 2072    """..        r
-00007e90: 6571 7565 7374 203d 2052 6571 7565 7374  equest = Request
-00007ea0: 280a 2020 2020 2020 2020 2020 2020 6d65  (.            me
-00007eb0: 7468 6f64 3d22 706f 7374 222c 0a20 2020  thod="post",.   
-00007ec0: 2020 2020 2020 2020 2065 6e64 706f 696e           endpoin
-00007ed0: 743d 222f 5f61 7069 2f63 7572 736f 7222  t="/_api/cursor"
-00007ee0: 2c0a 2020 2020 2020 2020 2020 2020 6461  ,.            da
-00007ef0: 7461 3d7b 2271 7565 7279 223a 2071 7565  ta={"query": que
-00007f00: 7279 2c20 2262 696e 6456 6172 7322 3a20  ry, "bindVars": 
-00007f10: 6269 6e64 5f76 6172 732c 2022 636f 756e  bind_vars, "coun
-00007f20: 7422 3a20 5472 7565 7d2c 0a20 2020 2020  t": True},.     
-00007f30: 2020 2020 2020 2072 6561 643d 7365 6c66         read=self
-00007f40: 2e6e 616d 652c 0a20 2020 2020 2020 2020  .name,.         
-00007f50: 2020 2068 6561 6465 7273 3d7b 2278 2d61     headers={"x-a
-00007f60: 7261 6e67 6f2d 616c 6c6f 772d 6469 7274  rango-allow-dirt
-00007f70: 792d 7265 6164 223a 2022 7472 7565 227d  y-read": "true"}
-00007f80: 2069 6620 616c 6c6f 775f 6469 7274 795f   if allow_dirty_
-00007f90: 7265 6164 2065 6c73 6520 4e6f 6e65 2c0a  read else None,.
-00007fa0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00007fb0: 2020 2064 6566 2072 6573 706f 6e73 655f     def response_
-00007fc0: 6861 6e64 6c65 7228 7265 7370 3a20 5265  handler(resp: Re
-00007fd0: 7370 6f6e 7365 2920 2d3e 2043 7572 736f  sponse) -> Curso
-00007fe0: 723a 0a20 2020 2020 2020 2020 2020 2069  r:.            i
-00007ff0: 6620 6e6f 7420 7265 7370 2e69 735f 7375  f not resp.is_su
-00008000: 6363 6573 733a 0a20 2020 2020 2020 2020  ccess:.         
-00008010: 2020 2020 2020 2072 6169 7365 2044 6f63         raise Doc
-00008020: 756d 656e 7447 6574 4572 726f 7228 7265  umentGetError(re
-00008030: 7370 2c20 7265 7175 6573 7429 0a20 2020  sp, request).   
-00008040: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00008050: 4375 7273 6f72 2873 656c 662e 5f63 6f6e  Cursor(self._con
-00008060: 6e2c 2072 6573 702e 626f 6479 290a 0a20  n, resp.body).. 
-00008070: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00008080: 6c66 2e5f 6578 6563 7574 6528 7265 7175  lf._execute(requ
-00008090: 6573 742c 2072 6573 706f 6e73 655f 6861  est, response_ha
-000080a0: 6e64 6c65 7229 0a0a 2020 2020 6465 6620  ndler)..    def 
-000080b0: 6669 6e64 5f69 6e5f 7261 6469 7573 280a  find_in_radius(.
-000080c0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-000080d0: 2020 2020 2020 6c61 7469 7475 6465 3a20        latitude: 
-000080e0: 4e75 6d62 6572 2c0a 2020 2020 2020 2020  Number,.        
-000080f0: 6c6f 6e67 6974 7564 653a 204e 756d 6265  longitude: Numbe
-00008100: 722c 0a20 2020 2020 2020 2072 6164 6975  r,.        radiu
-00008110: 733a 204e 756d 6265 722c 0a20 2020 2020  s: Number,.     
-00008120: 2020 2064 6973 7461 6e63 655f 6669 656c     distance_fiel
-00008130: 643a 204f 7074 696f 6e61 6c5b 7374 725d  d: Optional[str]
-00008140: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00008150: 2061 6c6c 6f77 5f64 6972 7479 5f72 6561   allow_dirty_rea
-00008160: 643a 2062 6f6f 6c20 3d20 4661 6c73 652c  d: bool = False,
-00008170: 0a20 2020 2029 202d 3e20 5265 7375 6c74  .    ) -> Result
-00008180: 5b43 7572 736f 725d 3a0a 2020 2020 2020  [Cursor]:.      
-00008190: 2020 2222 2252 6574 7572 6e20 646f 6375    """Return docu
-000081a0: 6d65 6e74 7320 7769 7468 696e 2061 2067  ments within a g
-000081b0: 6976 656e 2072 6164 6975 7320 6172 6f75  iven radius arou
-000081c0: 6e64 2061 2063 6f6f 7264 696e 6174 652e  nd a coordinate.
-000081d0: 0a0a 2020 2020 2020 2020 4120 6765 6f20  ..        A geo 
-000081e0: 696e 6465 7820 6d75 7374 2062 6520 6465  index must be de
-000081f0: 6669 6e65 6420 696e 2074 6865 2063 6f6c  fined in the col
-00008200: 6c65 6374 696f 6e20 746f 2075 7365 2074  lection to use t
-00008210: 6869 7320 6d65 7468 6f64 2e0a 0a20 2020  his method...   
-00008220: 2020 2020 203a 7061 7261 6d20 6c61 7469       :param lati
-00008230: 7475 6465 3a20 4c61 7469 7475 6465 2e0a  tude: Latitude..
-00008240: 2020 2020 2020 2020 3a74 7970 6520 6c61          :type la
-00008250: 7469 7475 6465 3a20 696e 7420 7c20 666c  titude: int | fl
-00008260: 6f61 740a 2020 2020 2020 2020 3a70 6172  oat.        :par
-00008270: 616d 206c 6f6e 6769 7475 6465 3a20 4c6f  am longitude: Lo
-00008280: 6e67 6974 7564 652e 0a20 2020 2020 2020  ngitude..       
-00008290: 203a 7479 7065 206c 6f6e 6769 7475 6465   :type longitude
-000082a0: 3a20 696e 7420 7c20 666c 6f61 740a 2020  : int | float.  
-000082b0: 2020 2020 2020 3a70 6172 616d 2072 6164        :param rad
-000082c0: 6975 733a 204d 6178 2072 6164 6975 732e  ius: Max radius.
-000082d0: 0a20 2020 2020 2020 203a 7479 7065 2072  .        :type r
-000082e0: 6164 6975 733a 2069 6e74 207c 2066 6c6f  adius: int | flo
-000082f0: 6174 0a20 2020 2020 2020 203a 7061 7261  at.        :para
-00008300: 6d20 6469 7374 616e 6365 5f66 6965 6c64  m distance_field
-00008310: 3a20 446f 6375 6d65 6e74 2066 6965 6c64  : Document field
-00008320: 2075 7365 6420 746f 2069 6e64 6963 6174   used to indicat
-00008330: 6520 7468 6520 6469 7374 616e 6365 2074  e the distance t
-00008340: 6f0a 2020 2020 2020 2020 2020 2020 7468  o.            th
-00008350: 6520 6769 7665 6e20 636f 6f72 6469 6e61  e given coordina
-00008360: 7465 2e20 5468 6973 2070 6172 616d 6574  te. This paramet
-00008370: 6572 2069 7320 6967 6e6f 7265 6420 696e  er is ignored in
-00008380: 2074 7261 6e73 6163 7469 6f6e 732e 0a20   transactions.. 
-00008390: 2020 2020 2020 203a 7479 7065 2064 6973         :type dis
-000083a0: 7461 6e63 655f 6669 656c 643a 2073 7472  tance_field: str
-000083b0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-000083c0: 616c 6c6f 775f 6469 7274 795f 7265 6164  allow_dirty_read
-000083d0: 3a20 416c 6c6f 7720 7265 6164 7320 6672  : Allow reads fr
-000083e0: 6f6d 2066 6f6c 6c6f 7765 7273 2069 6e20  om followers in 
-000083f0: 6120 636c 7573 7465 722e 0a20 2020 2020  a cluster..     
-00008400: 2020 203a 7479 7065 2061 6c6c 6f77 5f64     :type allow_d
-00008410: 6972 7479 5f72 6561 643a 2062 6f6f 6c0a  irty_read: bool.
-00008420: 2020 2020 2020 2020 3a72 6574 7572 6e73          :returns
-00008430: 3a20 446f 6375 6d65 6e74 2063 7572 736f  : Document curso
-00008440: 722e 0a20 2020 2020 2020 203a 7274 7970  r..        :rtyp
-00008450: 653a 2061 7261 6e67 6f2e 6375 7273 6f72  e: arango.cursor
-00008460: 2e43 7572 736f 720a 2020 2020 2020 2020  .Cursor.        
-00008470: 3a72 6169 7365 7320 6172 616e 676f 2e65  :raises arango.e
-00008480: 7863 6570 7469 6f6e 732e 446f 6375 6d65  xceptions.Docume
-00008490: 6e74 4765 7445 7272 6f72 3a20 4966 2072  ntGetError: If r
-000084a0: 6574 7269 6576 616c 2066 6169 6c73 2e0a  etrieval fails..
-000084b0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000084c0: 2020 2020 6173 7365 7274 2069 7369 6e73      assert isins
-000084d0: 7461 6e63 6528 6c61 7469 7475 6465 2c20  tance(latitude, 
-000084e0: 4e75 6d62 6572 292c 2022 6c61 7469 7475  Number), "latitu
-000084f0: 6465 206d 7573 7420 6265 2061 206e 756d  de must be a num
-00008500: 6265 7222 0a20 2020 2020 2020 2061 7373  ber".        ass
-00008510: 6572 7420 6973 696e 7374 616e 6365 286c  ert isinstance(l
-00008520: 6f6e 6769 7475 6465 2c20 4e75 6d62 6572  ongitude, Number
-00008530: 292c 2022 6c6f 6e67 6974 7564 6520 6d75  ), "longitude mu
-00008540: 7374 2062 6520 6120 6e75 6d62 6572 220a  st be a number".
-00008550: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-00008560: 7369 6e73 7461 6e63 6528 7261 6469 7573  sinstance(radius
-00008570: 2c20 4e75 6d62 6572 292c 2022 7261 6469  , Number), "radi
-00008580: 7573 206d 7573 7420 6265 2061 206e 756d  us must be a num
-00008590: 6265 7222 0a20 2020 2020 2020 2061 7373  ber".        ass
-000085a0: 6572 7420 6973 5f6e 6f6e 655f 6f72 5f73  ert is_none_or_s
-000085b0: 7472 2864 6973 7461 6e63 655f 6669 656c  tr(distance_fiel
-000085c0: 6429 2c20 2264 6973 7461 6e63 655f 6669  d), "distance_fi
-000085d0: 656c 6420 6d75 7374 2062 6520 6120 7374  eld must be a st
-000085e0: 7222 0a0a 2020 2020 2020 2020 7175 6572  r"..        quer
-000085f0: 7920 3d20 2222 220a 2020 2020 2020 2020  y = """.        
-00008600: 464f 5220 646f 6320 494e 2057 4954 4849  FOR doc IN WITHI
-00008610: 4e28 4040 636f 6c6c 6563 7469 6f6e 2c20  N(@@collection, 
-00008620: 406c 6174 6974 7564 652c 2040 6c6f 6e67  @latitude, @long
-00008630: 6974 7564 652c 2040 7261 6469 7573 7b7d  itude, @radius{}
-00008640: 290a 2020 2020 2020 2020 2020 2020 5245  ).            RE
-00008650: 5455 524e 2064 6f63 0a20 2020 2020 2020  TURN doc.       
-00008660: 2022 2222 2e66 6f72 6d61 7428 0a20 2020   """.format(.   
-00008670: 2020 2020 2020 2020 2022 2220 6966 2064           "" if d
-00008680: 6973 7461 6e63 655f 6669 656c 6420 6973  istance_field is
-00008690: 204e 6f6e 6520 656c 7365 2022 2c20 4064   None else ", @d
-000086a0: 6973 7461 6e63 6522 0a20 2020 2020 2020  istance".       
-000086b0: 2029 0a0a 2020 2020 2020 2020 6269 6e64   )..        bind
-000086c0: 5f76 6172 7320 3d20 7b0a 2020 2020 2020  _vars = {.      
-000086d0: 2020 2020 2020 2240 636f 6c6c 6563 7469        "@collecti
-000086e0: 6f6e 223a 2073 656c 662e 5f6e 616d 652c  on": self._name,
-000086f0: 0a20 2020 2020 2020 2020 2020 2022 6c61  .            "la
-00008700: 7469 7475 6465 223a 206c 6174 6974 7564  titude": latitud
-00008710: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
-00008720: 6c6f 6e67 6974 7564 6522 3a20 6c6f 6e67  longitude": long
-00008730: 6974 7564 652c 0a20 2020 2020 2020 2020  itude,.         
-00008740: 2020 2022 7261 6469 7573 223a 2072 6164     "radius": rad
-00008750: 6975 732c 0a20 2020 2020 2020 207d 0a20  ius,.        }. 
-00008760: 2020 2020 2020 2069 6620 6469 7374 616e         if distan
-00008770: 6365 5f66 6965 6c64 2069 7320 6e6f 7420  ce_field is not 
-00008780: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00008790: 2020 6269 6e64 5f76 6172 735b 2264 6973    bind_vars["dis
-000087a0: 7461 6e63 6522 5d20 3d20 6469 7374 616e  tance"] = distan
-000087b0: 6365 5f66 6965 6c64 0a0a 2020 2020 2020  ce_field..      
-000087c0: 2020 7265 7175 6573 7420 3d20 5265 7175    request = Requ
-000087d0: 6573 7428 0a20 2020 2020 2020 2020 2020  est(.           
-000087e0: 206d 6574 686f 643d 2270 6f73 7422 2c0a   method="post",.
-000087f0: 2020 2020 2020 2020 2020 2020 656e 6470              endp
-00008800: 6f69 6e74 3d22 2f5f 6170 692f 6375 7273  oint="/_api/curs
-00008810: 6f72 222c 0a20 2020 2020 2020 2020 2020  or",.           
-00008820: 2064 6174 613d 7b22 7175 6572 7922 3a20   data={"query": 
-00008830: 7175 6572 792c 2022 6269 6e64 5661 7273  query, "bindVars
-00008840: 223a 2062 696e 645f 7661 7273 2c20 2263  ": bind_vars, "c
-00008850: 6f75 6e74 223a 2054 7275 657d 2c0a 2020  ount": True},.  
-00008860: 2020 2020 2020 2020 2020 7265 6164 3d73            read=s
-00008870: 656c 662e 6e61 6d65 2c0a 2020 2020 2020  elf.name,.      
-00008880: 2020 2020 2020 6865 6164 6572 733d 7b22        headers={"
-00008890: 782d 6172 616e 676f 2d61 6c6c 6f77 2d64  x-arango-allow-d
-000088a0: 6972 7479 2d72 6561 6422 3a20 2274 7275  irty-read": "tru
-000088b0: 6522 7d20 6966 2061 6c6c 6f77 5f64 6972  e"} if allow_dir
-000088c0: 7479 5f72 6561 6420 656c 7365 204e 6f6e  ty_read else Non
-000088d0: 652c 0a20 2020 2020 2020 2029 0a0a 2020  e,.        )..  
-000088e0: 2020 2020 2020 6465 6620 7265 7370 6f6e        def respon
-000088f0: 7365 5f68 616e 646c 6572 2872 6573 703a  se_handler(resp:
-00008900: 2052 6573 706f 6e73 6529 202d 3e20 4375   Response) -> Cu
-00008910: 7273 6f72 3a0a 2020 2020 2020 2020 2020  rsor:.          
-00008920: 2020 6966 206e 6f74 2072 6573 702e 6973    if not resp.is
-00008930: 5f73 7563 6365 7373 3a0a 2020 2020 2020  _success:.      
-00008940: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00008950: 446f 6375 6d65 6e74 4765 7445 7272 6f72  DocumentGetError
-00008960: 2872 6573 702c 2072 6571 7565 7374 290a  (resp, request).
-00008970: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00008980: 726e 2043 7572 736f 7228 7365 6c66 2e5f  rn Cursor(self._
-00008990: 636f 6e6e 2c20 7265 7370 2e62 6f64 7929  conn, resp.body)
-000089a0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-000089b0: 2073 656c 662e 5f65 7865 6375 7465 2872   self._execute(r
-000089c0: 6571 7565 7374 2c20 7265 7370 6f6e 7365  equest, response
-000089d0: 5f68 616e 646c 6572 290a 0a20 2020 2064  _handler)..    d
-000089e0: 6566 2066 696e 645f 696e 5f62 6f78 280a  ef find_in_box(.
-000089f0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00008a00: 2020 2020 2020 6c61 7469 7475 6465 313a        latitude1:
-00008a10: 204e 756d 6265 722c 0a20 2020 2020 2020   Number,.       
-00008a20: 206c 6f6e 6769 7475 6465 313a 204e 756d   longitude1: Num
-00008a30: 6265 722c 0a20 2020 2020 2020 206c 6174  ber,.        lat
-00008a40: 6974 7564 6532 3a20 4e75 6d62 6572 2c0a  itude2: Number,.
-00008a50: 2020 2020 2020 2020 6c6f 6e67 6974 7564          longitud
-00008a60: 6532 3a20 4e75 6d62 6572 2c0a 2020 2020  e2: Number,.    
-00008a70: 2020 2020 736b 6970 3a20 4f70 7469 6f6e      skip: Option
-00008a80: 616c 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a  al[int] = None,.
-00008a90: 2020 2020 2020 2020 6c69 6d69 743a 204f          limit: O
-00008aa0: 7074 696f 6e61 6c5b 696e 745d 203d 204e  ptional[int] = N
-00008ab0: 6f6e 652c 0a20 2020 2020 2020 2069 6e64  one,.        ind
-00008ac0: 6578 3a20 4f70 7469 6f6e 616c 5b73 7472  ex: Optional[str
-00008ad0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-00008ae0: 2020 616c 6c6f 775f 6469 7274 795f 7265    allow_dirty_re
-00008af0: 6164 3a20 626f 6f6c 203d 2046 616c 7365  ad: bool = False
-00008b00: 2c0a 2020 2020 2920 2d3e 2052 6573 756c  ,.    ) -> Resul
-00008b10: 745b 4375 7273 6f72 5d3a 0a20 2020 2020  t[Cursor]:.     
-00008b20: 2020 2022 2222 5265 7475 726e 2061 6c6c     """Return all
-00008b30: 2064 6f63 756d 656e 7473 2069 6e20 6120   documents in a 
-00008b40: 7265 6374 616e 6775 6c61 7220 6172 6561  rectangular area
-00008b50: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-00008b60: 6d20 6c61 7469 7475 6465 313a 2046 6972  m latitude1: Fir
-00008b70: 7374 206c 6174 6974 7564 652e 0a20 2020  st latitude..   
-00008b80: 2020 2020 203a 7479 7065 206c 6174 6974       :type latit
-00008b90: 7564 6531 3a20 696e 7420 7c20 666c 6f61  ude1: int | floa
-00008ba0: 740a 2020 2020 2020 2020 3a70 6172 616d  t.        :param
-00008bb0: 206c 6f6e 6769 7475 6465 313a 2046 6972   longitude1: Fir
-00008bc0: 7374 206c 6f6e 6769 7475 6465 2e0a 2020  st longitude..  
-00008bd0: 2020 2020 2020 3a74 7970 6520 6c6f 6e67        :type long
-00008be0: 6974 7564 6531 3a20 696e 7420 7c20 666c  itude1: int | fl
-00008bf0: 6f61 740a 2020 2020 2020 2020 3a70 6172  oat.        :par
-00008c00: 616d 206c 6174 6974 7564 6532 3a20 5365  am latitude2: Se
-00008c10: 636f 6e64 206c 6174 6974 7564 652e 0a20  cond latitude.. 
-00008c20: 2020 2020 2020 203a 7479 7065 206c 6174         :type lat
-00008c30: 6974 7564 6532 3a20 696e 7420 7c20 666c  itude2: int | fl
-00008c40: 6f61 740a 2020 2020 2020 2020 3a70 6172  oat.        :par
-00008c50: 616d 206c 6f6e 6769 7475 6465 323a 2053  am longitude2: S
-00008c60: 6563 6f6e 6420 6c6f 6e67 6974 7564 650a  econd longitude.
-00008c70: 2020 2020 2020 2020 3a74 7970 6520 6c6f          :type lo
-00008c80: 6e67 6974 7564 6532 3a20 696e 7420 7c20  ngitude2: int | 
-00008c90: 666c 6f61 740a 2020 2020 2020 2020 3a70  float.        :p
-00008ca0: 6172 616d 2073 6b69 703a 204e 756d 6265  aram skip: Numbe
-00008cb0: 7220 6f66 2064 6f63 756d 656e 7473 2074  r of documents t
-00008cc0: 6f20 736b 6970 2e0a 2020 2020 2020 2020  o skip..        
-00008cd0: 3a74 7970 6520 736b 6970 3a20 696e 7420  :type skip: int 
-00008ce0: 7c20 4e6f 6e65 0a20 2020 2020 2020 203a  | None.        :
-00008cf0: 7061 7261 6d20 6c69 6d69 743a 204d 6178  param limit: Max
-00008d00: 206e 756d 6265 7220 6f66 2064 6f63 756d   number of docum
-00008d10: 656e 7473 2072 6574 7572 6e65 642e 0a20  ents returned.. 
-00008d20: 2020 2020 2020 203a 7479 7065 206c 696d         :type lim
-00008d30: 6974 3a20 696e 7420 7c20 4e6f 6e65 0a20  it: int | None. 
-00008d40: 2020 2020 2020 203a 7061 7261 6d20 696e         :param in
-00008d50: 6465 783a 2049 4420 6f66 2074 6865 2067  dex: ID of the g
-00008d60: 656f 2069 6e64 6578 2074 6f20 7573 6520  eo index to use 
-00008d70: 2877 6974 686f 7574 2074 6865 2063 6f6c  (without the col
-00008d80: 6c65 6374 696f 6e0a 2020 2020 2020 2020  lection.        
-00008d90: 2020 2020 7072 6566 6978 292e 2054 6869      prefix). Thi
-00008da0: 7320 7061 7261 6d65 7465 7220 6973 2069  s parameter is i
-00008db0: 676e 6f72 6564 2069 6e20 7472 616e 7361  gnored in transa
-00008dc0: 6374 696f 6e73 2e0a 2020 2020 2020 2020  ctions..        
-00008dd0: 3a74 7970 6520 696e 6465 783a 2073 7472  :type index: str
-00008de0: 207c 204e 6f6e 650a 2020 2020 2020 2020   | None.        
-00008df0: 3a70 6172 616d 2061 6c6c 6f77 5f64 6972  :param allow_dir
-00008e00: 7479 5f72 6561 643a 2041 6c6c 6f77 2072  ty_read: Allow r
-00008e10: 6561 6473 2066 726f 6d20 666f 6c6c 6f77  eads from follow
-00008e20: 6572 7320 696e 2061 2063 6c75 7374 6572  ers in a cluster
-00008e30: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
-00008e40: 616c 6c6f 775f 6469 7274 795f 7265 6164  allow_dirty_read
-00008e50: 3a20 626f 6f6c 0a20 2020 2020 2020 203a  : bool.        :
-00008e60: 7265 7475 726e 733a 2044 6f63 756d 656e  returns: Documen
-00008e70: 7420 6375 7273 6f72 2e0a 2020 2020 2020  t cursor..      
-00008e80: 2020 3a72 7479 7065 3a20 6172 616e 676f    :rtype: arango
-00008e90: 2e63 7572 736f 722e 4375 7273 6f72 0a20  .cursor.Cursor. 
-00008ea0: 2020 2020 2020 203a 7261 6973 6573 2061         :raises a
-00008eb0: 7261 6e67 6f2e 6578 6365 7074 696f 6e73  rango.exceptions
-00008ec0: 2e44 6f63 756d 656e 7447 6574 4572 726f  .DocumentGetErro
-00008ed0: 723a 2049 6620 7265 7472 6965 7661 6c20  r: If retrieval 
-00008ee0: 6661 696c 732e 0a20 2020 2020 2020 2022  fails..        "
-00008ef0: 2222 0a20 2020 2020 2020 2061 7373 6572  "".        asser
-00008f00: 7420 6973 696e 7374 616e 6365 286c 6174  t isinstance(lat
-00008f10: 6974 7564 6531 2c20 4e75 6d62 6572 292c  itude1, Number),
-00008f20: 2022 6c61 7469 7475 6465 3120 6d75 7374   "latitude1 must
-00008f30: 2062 6520 6120 6e75 6d62 6572 220a 2020   be a number".  
-00008f40: 2020 2020 2020 6173 7365 7274 2069 7369        assert isi
-00008f50: 6e73 7461 6e63 6528 6c6f 6e67 6974 7564  nstance(longitud
-00008f60: 6531 2c20 4e75 6d62 6572 292c 2022 6c6f  e1, Number), "lo
-00008f70: 6e67 6974 7564 6531 206d 7573 7420 6265  ngitude1 must be
-00008f80: 2061 206e 756d 6265 7222 0a20 2020 2020   a number".     
-00008f90: 2020 2061 7373 6572 7420 6973 696e 7374     assert isinst
-00008fa0: 616e 6365 286c 6174 6974 7564 6532 2c20  ance(latitude2, 
-00008fb0: 4e75 6d62 6572 292c 2022 6c61 7469 7475  Number), "latitu
-00008fc0: 6465 3220 6d75 7374 2062 6520 6120 6e75  de2 must be a nu
-00008fd0: 6d62 6572 220a 2020 2020 2020 2020 6173  mber".        as
-00008fe0: 7365 7274 2069 7369 6e73 7461 6e63 6528  sert isinstance(
-00008ff0: 6c6f 6e67 6974 7564 6532 2c20 4e75 6d62  longitude2, Numb
-00009000: 6572 292c 2022 6c6f 6e67 6974 7564 6532  er), "longitude2
-00009010: 206d 7573 7420 6265 2061 206e 756d 6265   must be a numbe
-00009020: 7222 0a20 2020 2020 2020 2061 7373 6572  r".        asser
-00009030: 7420 6973 5f6e 6f6e 655f 6f72 5f69 6e74  t is_none_or_int
-00009040: 2873 6b69 7029 2c20 2273 6b69 7020 6d75  (skip), "skip mu
-00009050: 7374 2062 6520 6120 6e6f 6e2d 6e65 6761  st be a non-nega
-00009060: 7469 7665 2069 6e74 220a 2020 2020 2020  tive int".      
-00009070: 2020 6173 7365 7274 2069 735f 6e6f 6e65    assert is_none
-00009080: 5f6f 725f 696e 7428 6c69 6d69 7429 2c20  _or_int(limit), 
-00009090: 226c 696d 6974 206d 7573 7420 6265 2061  "limit must be a
-000090a0: 206e 6f6e 2d6e 6567 6174 6976 6520 696e   non-negative in
-000090b0: 7422 0a20 2020 2020 2020 2061 7373 6572  t".        asser
-000090c0: 7420 6973 5f6e 6f6e 655f 6f72 5f73 7472  t is_none_or_str
-000090d0: 2869 6e64 6578 292c 2022 696e 6465 7820  (index), "index 
-000090e0: 6d75 7374 2062 6520 6120 7374 7269 6e67  must be a string
-000090f0: 220a 0a20 2020 2020 2020 2064 6566 2062  "..        def b
-00009100: 7569 6c64 5f63 6f6f 7264 5f73 7472 5f66  uild_coord_str_f
-00009110: 726f 6d5f 696e 6465 7828 696e 6465 783a  rom_index(index:
-00009120: 204a 736f 6e29 202d 3e20 7374 723a 0a20   Json) -> str:. 
-00009130: 2020 2020 2020 2020 2020 2069 6e64 6578             index
-00009140: 5f66 6965 6c64 3a20 4c69 7374 5b73 7472  _field: List[str
-00009150: 5d20 3d20 696e 6465 785b 2266 6965 6c64  ] = index["field
-00009160: 7322 5d0a 0a20 2020 2020 2020 2020 2020  s"]..           
-00009170: 2069 6620 6c65 6e28 696e 6465 785f 6669   if len(index_fi
-00009180: 656c 6429 203d 3d20 313a 0a20 2020 2020  eld) == 1:.     
-00009190: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000091a0: 6e20 6622 646f 632e 7b69 6e64 6578 5f66  n f"doc.{index_f
-000091b0: 6965 6c64 5b30 5d7d 220a 2020 2020 2020  ield[0]}".      
-000091c0: 2020 2020 2020 656c 6966 206c 656e 2869        elif len(i
-000091d0: 6e64 6578 5f66 6965 6c64 2920 3d3d 2032  ndex_field) == 2
-000091e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000091f0: 2020 7265 7475 726e 2066 225b 646f 632e    return f"[doc.
-00009200: 7b69 6e64 6578 5f66 6965 6c64 5b30 5d7d  {index_field[0]}
-00009210: 2c20 646f 632e 7b69 6e64 6578 5f66 6965  , doc.{index_fie
-00009220: 6c64 5b31 5d7d 5d22 0a20 2020 2020 2020  ld[1]}]".       
-00009230: 2020 2020 2065 6c73 653a 2020 2320 7072       else:  # pr
-00009240: 6167 6d61 3a20 6e6f 2063 6f76 6572 0a20  agma: no cover. 
-00009250: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00009260: 203d 2022 2a2a 696e 6465 782a 2a20 6d75   = "**index** mu
-00009270: 7374 2062 6520 6120 6765 6f20 696e 6465  st be a geo inde
-00009280: 7820 7769 7468 2031 206f 7220 3220 6669  x with 1 or 2 fi
-00009290: 656c 6473 220a 2020 2020 2020 2020 2020  elds".          
-000092a0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-000092b0: 6545 7272 6f72 286d 290a 0a20 2020 2020  eError(m)..     
-000092c0: 2020 2063 6f6f 7264 5f73 7472 203d 2022     coord_str = "
-000092d0: 220a 2020 2020 2020 2020 6966 2069 6e64  ".        if ind
-000092e0: 6578 2069 7320 4e6f 6e65 3a0a 2020 2020  ex is None:.    
-000092f0: 2020 2020 2020 2020 2320 4669 6e64 2074          # Find t
-00009300: 6865 2066 6972 7374 2067 656f 2069 6e64  he first geo ind
-00009310: 6578 0a20 2020 2020 2020 2020 2020 2066  ex.            f
-00009320: 6f72 2063 6f6c 6c65 6374 696f 6e5f 696e  or collection_in
-00009330: 6465 7820 696e 2073 656c 662e 696e 6465  dex in self.inde
-00009340: 7865 7328 293a 2020 2320 7479 7065 3a69  xes():  # type:i
-00009350: 676e 6f72 655b 756e 696f 6e2d 6174 7472  gnore[union-attr
-00009360: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00009370: 2020 6966 2063 6f6c 6c65 6374 696f 6e5f    if collection_
-00009380: 696e 6465 785b 2274 7970 6522 5d20 3d3d  index["type"] ==
-00009390: 2022 6765 6f22 3a0a 2020 2020 2020 2020   "geo":.        
-000093a0: 2020 2020 2020 2020 2020 2020 636f 6f72              coor
-000093b0: 645f 7374 7220 3d20 6275 696c 645f 636f  d_str = build_co
-000093c0: 6f72 645f 7374 725f 6672 6f6d 5f69 6e64  ord_str_from_ind
-000093d0: 6578 2863 6f6c 6c65 6374 696f 6e5f 696e  ex(collection_in
-000093e0: 6465 7829 0a20 2020 2020 2020 2020 2020  dex).           
-000093f0: 2020 2020 2020 2020 2062 7265 616b 0a0a           break..
-00009400: 2020 2020 2020 2020 2020 2020 2320 4966              # If
-00009410: 206e 6f20 6765 6f20 696e 6465 7820 666f   no geo index fo
-00009420: 756e 642c 2072 6169 7365 0a20 2020 2020  und, raise.     
-00009430: 2020 2020 2020 2069 6620 636f 6f72 645f         if coord_
-00009440: 7374 7220 3d3d 2022 223a 0a20 2020 2020  str == "":.     
-00009450: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00009460: 2049 6e64 6578 4d69 7373 696e 6745 7272   IndexMissingErr
-00009470: 6f72 2866 224e 6f20 6765 6f20 696e 6465  or(f"No geo inde
-00009480: 7820 666f 756e 6420 696e 207b 7365 6c66  x found in {self
-00009490: 2e6e 616d 657d 2229 0a0a 2020 2020 2020  .name}")..      
-000094a0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000094b0: 2020 2020 2320 4669 6e64 2074 6865 2067      # Find the g
-000094c0: 656f 2069 6e64 6578 2077 6974 6820 7468  eo index with th
-000094d0: 6520 6769 7665 6e20 4944 0a20 2020 2020  e given ID.     
-000094e0: 2020 2020 2020 2067 656f 5f69 6e64 6578         geo_index
-000094f0: 203d 2073 656c 662e 6765 745f 696e 6465   = self.get_inde
-00009500: 7828 696e 6465 7829 0a20 2020 2020 2020  x(index).       
-00009510: 2020 2020 2061 7373 6572 7420 6973 696e       assert isin
-00009520: 7374 616e 6365 2867 656f 5f69 6e64 6578  stance(geo_index
-00009530: 2c20 6469 6374 290a 0a20 2020 2020 2020  , dict)..       
-00009540: 2020 2020 2023 2049 6620 7468 6520 696e       # If the in
-00009550: 6465 7820 6973 206e 6f74 2061 2067 656f  dex is not a geo
-00009560: 2069 6e64 6578 2c20 7261 6973 650a 2020   index, raise.  
-00009570: 2020 2020 2020 2020 2020 6966 2067 656f            if geo
-00009580: 5f69 6e64 6578 5b22 7479 7065 225d 2021  _index["type"] !
-00009590: 3d20 2267 656f 223a 0a20 2020 2020 2020  = "geo":.       
-000095a0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-000095b0: 616c 7565 4572 726f 7228 222a 2a69 6e64  alueError("**ind
-000095c0: 6578 2a2a 206d 7573 7420 706f 696e 7420  ex** must point 
-000095d0: 746f 2061 2047 656f 2049 6e64 6578 2229  to a Geo Index")
-000095e0: 0a0a 2020 2020 2020 2020 2020 2020 636f  ..            co
-000095f0: 6f72 645f 7374 7220 3d20 6275 696c 645f  ord_str = build_
-00009600: 636f 6f72 645f 7374 725f 6672 6f6d 5f69  coord_str_from_i
-00009610: 6e64 6578 2867 656f 5f69 6e64 6578 290a  ndex(geo_index).
-00009620: 0a20 2020 2020 2020 2073 6b69 705f 7661  .        skip_va
-00009630: 6c20 3d20 736b 6970 2069 6620 736b 6970  l = skip if skip
-00009640: 2069 7320 6e6f 7420 4e6f 6e65 2065 6c73   is not None els
-00009650: 6520 300a 2020 2020 2020 2020 6c69 6d69  e 0.        limi
-00009660: 745f 7661 6c20 3d20 6c69 6d69 7420 6966  t_val = limit if
-00009670: 206c 696d 6974 2069 7320 6e6f 7420 4e6f   limit is not No
-00009680: 6e65 2065 6c73 6520 226e 756c 6c22 0a20  ne else "null". 
-00009690: 2020 2020 2020 2071 7565 7279 203d 2066         query = f
-000096a0: 2222 220a 2020 2020 2020 2020 2020 2020  """.            
-000096b0: 4c45 5420 7265 6374 203d 2047 454f 5f50  LET rect = GEO_P
-000096c0: 4f4c 5947 4f4e 285b 205b 0a20 2020 2020  OLYGON([ [.     
-000096d0: 2020 2020 2020 2020 2020 205b 7b6c 6f6e             [{lon
-000096e0: 6769 7475 6465 317d 2c20 7b6c 6174 6974  gitude1}, {latit
-000096f0: 7564 6531 7d5d 2c20 2f2f 2062 6f74 746f  ude1}], // botto
-00009700: 6d2d 6c65 6674 0a20 2020 2020 2020 2020  m-left.         
-00009710: 2020 2020 2020 205b 7b6c 6f6e 6769 7475         [{longitu
-00009720: 6465 327d 2c20 7b6c 6174 6974 7564 6531  de2}, {latitude1
-00009730: 7d5d 2c20 2f2f 2062 6f74 746f 6d2d 7269  }], // bottom-ri
-00009740: 6768 740a 2020 2020 2020 2020 2020 2020  ght.            
-00009750: 2020 2020 5b7b 6c6f 6e67 6974 7564 6532      [{longitude2
-00009760: 7d2c 207b 6c61 7469 7475 6465 327d 5d2c  }, {latitude2}],
-00009770: 202f 2f20 746f 702d 7269 6768 740a 2020   // top-right.  
-00009780: 2020 2020 2020 2020 2020 2020 2020 5b7b                [{
-00009790: 6c6f 6e67 6974 7564 6531 7d2c 207b 6c61  longitude1}, {la
-000097a0: 7469 7475 6465 327d 5d2c 202f 2f20 746f  titude2}], // to
-000097b0: 702d 6c65 6674 0a20 2020 2020 2020 2020  p-left.         
-000097c0: 2020 2020 2020 205b 7b6c 6f6e 6769 7475         [{longitu
-000097d0: 6465 317d 2c20 7b6c 6174 6974 7564 6531  de1}, {latitude1
-000097e0: 7d5d 2c20 2f2f 2062 6f74 746f 6d2d 6c65  }], // bottom-le
-000097f0: 6674 2028 636c 6f73 6520 706f 6c79 676f  ft (close polygo
-00009800: 6e29 0a20 2020 2020 2020 2020 2020 205d  n).            ]
-00009810: 205d 290a 0a20 2020 2020 2020 2020 2020   ])..           
-00009820: 2046 4f52 2064 6f63 2049 4e20 4040 636f   FOR doc IN @@co
-00009830: 6c6c 6563 7469 6f6e 0a20 2020 2020 2020  llection.       
-00009840: 2020 2020 2020 2020 2046 494c 5445 5220           FILTER 
-00009850: 4745 4f5f 434f 4e54 4149 4e53 2872 6563  GEO_CONTAINS(rec
-00009860: 742c 207b 636f 6f72 645f 7374 727d 290a  t, {coord_str}).
-00009870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009880: 4c49 4d49 5420 7b73 6b69 705f 7661 6c7d  LIMIT {skip_val}
-00009890: 2c20 7b6c 696d 6974 5f76 616c 7d0a 2020  , {limit_val}.  
-000098a0: 2020 2020 2020 2020 2020 2020 2020 5245                RE
-000098b0: 5455 524e 2064 6f63 0a20 2020 2020 2020  TURN doc.       
-000098c0: 2022 2222 0a0a 2020 2020 2020 2020 6269   """..        bi
-000098d0: 6e64 5f76 6172 7320 3d20 7b22 4063 6f6c  nd_vars = {"@col
-000098e0: 6c65 6374 696f 6e22 3a20 7365 6c66 2e6e  lection": self.n
-000098f0: 616d 657d 0a0a 2020 2020 2020 2020 7265  ame}..        re
-00009900: 7175 6573 7420 3d20 5265 7175 6573 7428  quest = Request(
-00009910: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-00009920: 686f 643d 2270 6f73 7422 2c0a 2020 2020  hod="post",.    
-00009930: 2020 2020 2020 2020 656e 6470 6f69 6e74          endpoint
-00009940: 3d22 2f5f 6170 692f 6375 7273 6f72 222c  ="/_api/cursor",
-00009950: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-00009960: 613d 7b22 7175 6572 7922 3a20 7175 6572  a={"query": quer
-00009970: 792c 2022 6269 6e64 5661 7273 223a 2062  y, "bindVars": b
-00009980: 696e 645f 7661 7273 2c20 2263 6f75 6e74  ind_vars, "count
-00009990: 223a 2054 7275 657d 2c0a 2020 2020 2020  ": True},.      
-000099a0: 2020 2020 2020 7265 6164 3d73 656c 662e        read=self.
-000099b0: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-000099c0: 2020 6865 6164 6572 733d 7b22 782d 6172    headers={"x-ar
-000099d0: 616e 676f 2d61 6c6c 6f77 2d64 6972 7479  ango-allow-dirty
-000099e0: 2d72 6561 6422 3a20 2274 7275 6522 7d20  -read": "true"} 
-000099f0: 6966 2061 6c6c 6f77 5f64 6972 7479 5f72  if allow_dirty_r
-00009a00: 6561 6420 656c 7365 204e 6f6e 652c 0a20  ead else None,. 
-00009a10: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00009a20: 2020 6465 6620 7265 7370 6f6e 7365 5f68    def response_h
-00009a30: 616e 646c 6572 2872 6573 703a 2052 6573  andler(resp: Res
-00009a40: 706f 6e73 6529 202d 3e20 4375 7273 6f72  ponse) -> Cursor
-00009a50: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00009a60: 206e 6f74 2072 6573 702e 6973 5f73 7563   not resp.is_suc
-00009a70: 6365 7373 3a0a 2020 2020 2020 2020 2020  cess:.          
-00009a80: 2020 2020 2020 7261 6973 6520 446f 6375        raise Docu
-00009a90: 6d65 6e74 4765 7445 7272 6f72 2872 6573  mentGetError(res
-00009aa0: 702c 2072 6571 7565 7374 290a 2020 2020  p, request).    
-00009ab0: 2020 2020 2020 2020 7265 7475 726e 2043          return C
-00009ac0: 7572 736f 7228 7365 6c66 2e5f 636f 6e6e  ursor(self._conn
-00009ad0: 2c20 7265 7370 2e62 6f64 7929 0a0a 2020  , resp.body)..  
-00009ae0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00009af0: 662e 5f65 7865 6375 7465 2872 6571 7565  f._execute(reque
-00009b00: 7374 2c20 7265 7370 6f6e 7365 5f68 616e  st, response_han
-00009b10: 646c 6572 290a 0a20 2020 2064 6566 2066  dler)..    def f
-00009b20: 696e 645f 6279 5f74 6578 7428 0a20 2020  ind_by_text(.   
-00009b30: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00009b40: 2020 2066 6965 6c64 3a20 7374 722c 0a20     field: str,. 
-00009b50: 2020 2020 2020 2071 7565 7279 3a20 7374         query: st
-00009b60: 722c 0a20 2020 2020 2020 206c 696d 6974  r,.        limit
-00009b70: 3a20 4f70 7469 6f6e 616c 5b69 6e74 5d20  : Optional[int] 
-00009b80: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00009b90: 616c 6c6f 775f 6469 7274 795f 7265 6164  allow_dirty_read
-00009ba0: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
-00009bb0: 2020 2020 2920 2d3e 2052 6573 756c 745b      ) -> Result[
-00009bc0: 4375 7273 6f72 5d3a 0a20 2020 2020 2020  Cursor]:.       
-00009bd0: 2022 2222 5265 7475 726e 2064 6f63 756d   """Return docum
-00009be0: 656e 7473 2074 6861 7420 6d61 7463 6820  ents that match 
-00009bf0: 7468 6520 6769 7665 6e20 6675 6c6c 7465  the given fullte
-00009c00: 7874 2071 7565 7279 2e0a 0a20 2020 2020  xt query...     
-00009c10: 2020 203a 7061 7261 6d20 6669 656c 643a     :param field:
-00009c20: 2044 6f63 756d 656e 7420 6669 656c 6420   Document field 
-00009c30: 7769 7468 2066 756c 6c74 6578 7420 696e  with fulltext in
-00009c40: 6465 782e 0a20 2020 2020 2020 203a 7479  dex..        :ty
-00009c50: 7065 2066 6965 6c64 3a20 7374 720a 2020  pe field: str.  
-00009c60: 2020 2020 2020 3a70 6172 616d 2071 7565        :param que
-00009c70: 7279 3a20 4675 6c6c 7465 7874 2071 7565  ry: Fulltext que
-00009c80: 7279 2e0a 2020 2020 2020 2020 3a74 7970  ry..        :typ
-00009c90: 6520 7175 6572 793a 2073 7472 0a20 2020  e query: str.   
-00009ca0: 2020 2020 203a 7061 7261 6d20 6c69 6d69       :param limi
-00009cb0: 743a 204d 6178 206e 756d 6265 7220 6f66  t: Max number of
-00009cc0: 2064 6f63 756d 656e 7473 2072 6574 7572   documents retur
-00009cd0: 6e65 642e 0a20 2020 2020 2020 203a 7479  ned..        :ty
-00009ce0: 7065 206c 696d 6974 3a20 696e 7420 7c20  pe limit: int | 
-00009cf0: 4e6f 6e65 0a20 2020 2020 2020 203a 7061  None.        :pa
-00009d00: 7261 6d20 616c 6c6f 775f 6469 7274 795f  ram allow_dirty_
-00009d10: 7265 6164 3a20 416c 6c6f 7720 7265 6164  read: Allow read
-00009d20: 7320 6672 6f6d 2066 6f6c 6c6f 7765 7273  s from followers
-00009d30: 2069 6e20 6120 636c 7573 7465 722e 0a20   in a cluster.. 
-00009d40: 2020 2020 2020 203a 7479 7065 2061 6c6c         :type all
-00009d50: 6f77 5f64 6972 7479 5f72 6561 643a 2062  ow_dirty_read: b
-00009d60: 6f6f 6c0a 2020 2020 2020 2020 3a72 6574  ool.        :ret
-00009d70: 7572 6e73 3a20 446f 6375 6d65 6e74 2063  urns: Document c
-00009d80: 7572 736f 722e 0a20 2020 2020 2020 203a  ursor..        :
-00009d90: 7274 7970 653a 2061 7261 6e67 6f2e 6375  rtype: arango.cu
-00009da0: 7273 6f72 2e43 7572 736f 720a 2020 2020  rsor.Cursor.    
-00009db0: 2020 2020 3a72 6169 7365 7320 6172 616e      :raises aran
-00009dc0: 676f 2e65 7863 6570 7469 6f6e 732e 446f  go.exceptions.Do
-00009dd0: 6375 6d65 6e74 4765 7445 7272 6f72 3a20  cumentGetError: 
-00009de0: 4966 2072 6574 7269 6576 616c 2066 6169  If retrieval fai
-00009df0: 6c73 2e0a 2020 2020 2020 2020 2222 220a  ls..        """.
-00009e00: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-00009e10: 735f 6e6f 6e65 5f6f 725f 696e 7428 6c69  s_none_or_int(li
-00009e20: 6d69 7429 2c20 226c 696d 6974 206d 7573  mit), "limit mus
-00009e30: 7420 6265 2061 206e 6f6e 2d6e 6567 6174  t be a non-negat
-00009e40: 6976 6520 696e 7422 0a0a 2020 2020 2020  ive int"..      
-00009e50: 2020 6269 6e64 5f76 6172 733a 204a 736f    bind_vars: Jso
-00009e60: 6e20 3d20 7b0a 2020 2020 2020 2020 2020  n = {.          
-00009e70: 2020 2263 6f6c 6c65 6374 696f 6e22 3a20    "collection": 
-00009e80: 7365 6c66 2e5f 6e61 6d65 2c0a 2020 2020  self._name,.    
-00009e90: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
-00009ea0: 2066 6965 6c64 2c0a 2020 2020 2020 2020   field,.        
-00009eb0: 2020 2020 2271 7565 7279 223a 2071 7565      "query": que
-00009ec0: 7279 2c0a 2020 2020 2020 2020 7d0a 2020  ry,.        }.  
-00009ed0: 2020 2020 2020 6966 206c 696d 6974 2069        if limit i
-00009ee0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-00009ef0: 2020 2020 2020 2020 6269 6e64 5f76 6172          bind_var
-00009f00: 735b 226c 696d 6974 225d 203d 206c 696d  s["limit"] = lim
-00009f10: 6974 0a0a 2020 2020 2020 2020 6171 6c20  it..        aql 
-00009f20: 3d20 2222 220a 2020 2020 2020 2020 464f  = """.        FO
-00009f30: 5220 646f 6320 494e 2046 554c 4c54 4558  R doc IN FULLTEX
-00009f40: 5428 4063 6f6c 6c65 6374 696f 6e2c 2040  T(@collection, @
-00009f50: 6669 656c 642c 2040 7175 6572 797b 7d29  field, @query{})
-00009f60: 0a20 2020 2020 2020 2020 2020 2052 4554  .            RET
-00009f70: 5552 4e20 646f 630a 2020 2020 2020 2020  URN doc.        
-00009f80: 2222 222e 666f 726d 6174 280a 2020 2020  """.format(.    
-00009f90: 2020 2020 2020 2020 2222 2069 6620 6c69          "" if li
-00009fa0: 6d69 7420 6973 204e 6f6e 6520 656c 7365  mit is None else
-00009fb0: 2022 2c20 406c 696d 6974 220a 2020 2020   ", @limit".    
-00009fc0: 2020 2020 290a 0a20 2020 2020 2020 2072      )..        r
-00009fd0: 6571 7565 7374 203d 2052 6571 7565 7374  equest = Request
-00009fe0: 280a 2020 2020 2020 2020 2020 2020 6d65  (.            me
-00009ff0: 7468 6f64 3d22 706f 7374 222c 0a20 2020  thod="post",.   
-0000a000: 2020 2020 2020 2020 2065 6e64 706f 696e           endpoin
-0000a010: 743d 222f 5f61 7069 2f63 7572 736f 7222  t="/_api/cursor"
-0000a020: 2c0a 2020 2020 2020 2020 2020 2020 6461  ,.            da
-0000a030: 7461 3d7b 2271 7565 7279 223a 2061 716c  ta={"query": aql
-0000a040: 2c20 2262 696e 6456 6172 7322 3a20 6269  , "bindVars": bi
-0000a050: 6e64 5f76 6172 732c 2022 636f 756e 7422  nd_vars, "count"
-0000a060: 3a20 5472 7565 7d2c 0a20 2020 2020 2020  : True},.       
-0000a070: 2020 2020 2072 6561 643d 7365 6c66 2e6e       read=self.n
-0000a080: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-0000a090: 2068 6561 6465 7273 3d7b 2278 2d61 7261   headers={"x-ara
-0000a0a0: 6e67 6f2d 616c 6c6f 772d 6469 7274 792d  ngo-allow-dirty-
-0000a0b0: 7265 6164 223a 2022 7472 7565 227d 2069  read": "true"} i
-0000a0c0: 6620 616c 6c6f 775f 6469 7274 795f 7265  f allow_dirty_re
-0000a0d0: 6164 2065 6c73 6520 4e6f 6e65 2c0a 2020  ad else None,.  
-0000a0e0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0000a0f0: 2064 6566 2072 6573 706f 6e73 655f 6861   def response_ha
-0000a100: 6e64 6c65 7228 7265 7370 3a20 5265 7370  ndler(resp: Resp
-0000a110: 6f6e 7365 2920 2d3e 2043 7572 736f 723a  onse) -> Cursor:
-0000a120: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000a130: 6e6f 7420 7265 7370 2e69 735f 7375 6363  not resp.is_succ
-0000a140: 6573 733a 0a20 2020 2020 2020 2020 2020  ess:.           
-0000a150: 2020 2020 2072 6169 7365 2044 6f63 756d       raise Docum
-0000a160: 656e 7447 6574 4572 726f 7228 7265 7370  entGetError(resp
-0000a170: 2c20 7265 7175 6573 7429 0a20 2020 2020  , request).     
-0000a180: 2020 2020 2020 2072 6574 7572 6e20 4375         return Cu
-0000a190: 7273 6f72 2873 656c 662e 5f63 6f6e 6e2c  rsor(self._conn,
-0000a1a0: 2072 6573 702e 626f 6479 290a 0a20 2020   resp.body)..   
-0000a1b0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0000a1c0: 2e5f 6578 6563 7574 6528 7265 7175 6573  ._execute(reques
-0000a1d0: 742c 2072 6573 706f 6e73 655f 6861 6e64  t, response_hand
-0000a1e0: 6c65 7229 0a0a 2020 2020 6465 6620 6765  ler)..    def ge
-0000a1f0: 745f 6d61 6e79 280a 2020 2020 2020 2020  t_many(.        
-0000a200: 7365 6c66 2c0a 2020 2020 2020 2020 646f  self,.        do
-0000a210: 6375 6d65 6e74 733a 2053 6571 7565 6e63  cuments: Sequenc
-0000a220: 655b 556e 696f 6e5b 7374 722c 204a 736f  e[Union[str, Jso
-0000a230: 6e5d 5d2c 0a20 2020 2020 2020 2061 6c6c  n]],.        all
-0000a240: 6f77 5f64 6972 7479 5f72 6561 643a 2062  ow_dirty_read: b
-0000a250: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
-0000a260: 2029 202d 3e20 5265 7375 6c74 5b4a 736f   ) -> Result[Jso
-0000a270: 6e73 5d3a 0a20 2020 2020 2020 2022 2222  ns]:.        """
-0000a280: 5265 7475 726e 206d 756c 7469 706c 6520  Return multiple 
-0000a290: 646f 6375 6d65 6e74 7320 6967 6e6f 7269  documents ignori
-0000a2a0: 6e67 2061 6e79 206d 6973 7369 6e67 206f  ng any missing o
-0000a2b0: 6e65 732e 0a0a 2020 2020 2020 2020 3a70  nes...        :p
-0000a2c0: 6172 616d 2064 6f63 756d 656e 7473 3a20  aram documents: 
-0000a2d0: 4c69 7374 206f 6620 646f 6375 6d65 6e74  List of document
-0000a2e0: 206b 6579 732c 2049 4473 206f 7220 626f   keys, IDs or bo
-0000a2f0: 6469 6573 2e20 446f 6375 6d65 6e74 2062  dies. Document b
-0000a300: 6f64 6965 730a 2020 2020 2020 2020 2020  odies.          
-0000a310: 2020 6d75 7374 2063 6f6e 7461 696e 2074    must contain t
-0000a320: 6865 2022 5f69 6422 206f 7220 225f 6b65  he "_id" or "_ke
-0000a330: 7922 2066 6965 6c64 732e 0a20 2020 2020  y" fields..     
-0000a340: 2020 203a 7479 7065 2064 6f63 756d 656e     :type documen
-0000a350: 7473 3a20 5b73 7472 207c 2064 6963 745d  ts: [str | dict]
-0000a360: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000a370: 616c 6c6f 775f 6469 7274 795f 7265 6164  allow_dirty_read
-0000a380: 3a20 416c 6c6f 7720 7265 6164 7320 6672  : Allow reads fr
-0000a390: 6f6d 2066 6f6c 6c6f 7765 7273 2069 6e20  om followers in 
-0000a3a0: 6120 636c 7573 7465 722e 0a20 2020 2020  a cluster..     
-0000a3b0: 2020 203a 7479 7065 2061 6c6c 6f77 5f64     :type allow_d
-0000a3c0: 6972 7479 5f72 6561 643a 2062 6f6f 6c0a  irty_read: bool.
-0000a3d0: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-0000a3e0: 2044 6f63 756d 656e 7473 2e20 4d69 7373   Documents. Miss
-0000a3f0: 696e 6720 6f6e 6573 2061 7265 206e 6f74  ing ones are not
-0000a400: 2069 6e63 6c75 6465 642e 0a20 2020 2020   included..     
-0000a410: 2020 203a 7274 7970 653a 205b 6469 6374     :rtype: [dict
-0000a420: 5d0a 2020 2020 2020 2020 3a72 6169 7365  ].        :raise
-0000a430: 2061 7261 6e67 6f2e 6578 6365 7074 696f   arango.exceptio
-0000a440: 6e73 2e44 6f63 756d 656e 7447 6574 4572  ns.DocumentGetEr
-0000a450: 726f 723a 2049 6620 7265 7472 6965 7661  ror: If retrieva
-0000a460: 6c20 6661 696c 732e 0a20 2020 2020 2020  l fails..       
-0000a470: 2022 2222 0a20 2020 2020 2020 2068 616e   """.        han
-0000a480: 646c 6573 203d 205b 7365 6c66 2e5f 6578  dles = [self._ex
-0000a490: 7472 6163 745f 6964 2864 2920 6966 2069  tract_id(d) if i
-0000a4a0: 7369 6e73 7461 6e63 6528 642c 2064 6963  sinstance(d, dic
-0000a4b0: 7429 2065 6c73 6520 6420 666f 7220 6420  t) else d for d 
-0000a4c0: 696e 2064 6f63 756d 656e 7473 5d0a 0a20  in documents].. 
-0000a4d0: 2020 2020 2020 2070 6172 616d 733a 2050         params: P
-0000a4e0: 6172 616d 7320 3d20 7b22 6f6e 6c79 6765  arams = {"onlyge
-0000a4f0: 7422 3a20 5472 7565 7d0a 0a20 2020 2020  t": True}..     
-0000a500: 2020 2072 6571 7565 7374 203d 2052 6571     request = Req
-0000a510: 7565 7374 280a 2020 2020 2020 2020 2020  uest(.          
-0000a520: 2020 6d65 7468 6f64 3d22 7075 7422 2c0a    method="put",.
-0000a530: 2020 2020 2020 2020 2020 2020 656e 6470              endp
-0000a540: 6f69 6e74 3d66 222f 5f61 7069 2f64 6f63  oint=f"/_api/doc
-0000a550: 756d 656e 742f 7b73 656c 662e 6e61 6d65  ument/{self.name
-0000a560: 7d22 2c0a 2020 2020 2020 2020 2020 2020  }",.            
-0000a570: 7061 7261 6d73 3d70 6172 616d 732c 0a20  params=params,. 
-0000a580: 2020 2020 2020 2020 2020 2064 6174 613d             data=
-0000a590: 6861 6e64 6c65 732c 0a20 2020 2020 2020  handles,.       
-0000a5a0: 2020 2020 2072 6561 643d 7365 6c66 2e6e       read=self.n
-0000a5b0: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-0000a5c0: 2068 6561 6465 7273 3d7b 2278 2d61 7261   headers={"x-ara
-0000a5d0: 6e67 6f2d 616c 6c6f 772d 6469 7274 792d  ngo-allow-dirty-
-0000a5e0: 7265 6164 223a 2022 7472 7565 227d 2069  read": "true"} i
-0000a5f0: 6620 616c 6c6f 775f 6469 7274 795f 7265  f allow_dirty_re
-0000a600: 6164 2065 6c73 6520 4e6f 6e65 2c0a 2020  ad else None,.  
-0000a610: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0000a620: 2064 6566 2072 6573 706f 6e73 655f 6861   def response_ha
-0000a630: 6e64 6c65 7228 7265 7370 3a20 5265 7370  ndler(resp: Resp
-0000a640: 6f6e 7365 2920 2d3e 204a 736f 6e73 3a0a  onse) -> Jsons:.
-0000a650: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-0000a660: 6f74 2072 6573 702e 6973 5f73 7563 6365  ot resp.is_succe
-0000a670: 7373 3a0a 2020 2020 2020 2020 2020 2020  ss:.            
-0000a680: 2020 2020 7261 6973 6520 446f 6375 6d65      raise Docume
-0000a690: 6e74 4765 7445 7272 6f72 2872 6573 702c  ntGetError(resp,
-0000a6a0: 2072 6571 7565 7374 290a 2020 2020 2020   request).      
-0000a6b0: 2020 2020 2020 7265 7475 726e 205b 646f        return [do
-0000a6c0: 6320 666f 7220 646f 6320 696e 2072 6573  c for doc in res
-0000a6d0: 702e 626f 6479 2069 6620 225f 6964 2220  p.body if "_id" 
-0000a6e0: 696e 2064 6f63 5d0a 0a20 2020 2020 2020  in doc]..       
-0000a6f0: 2072 6574 7572 6e20 7365 6c66 2e5f 6578   return self._ex
-0000a700: 6563 7574 6528 7265 7175 6573 742c 2072  ecute(request, r
-0000a710: 6573 706f 6e73 655f 6861 6e64 6c65 7229  esponse_handler)
-0000a720: 0a0a 2020 2020 6465 6620 7261 6e64 6f6d  ..    def random
-0000a730: 2873 656c 662c 2061 6c6c 6f77 5f64 6972  (self, allow_dir
-0000a740: 7479 5f72 6561 643a 2062 6f6f 6c20 3d20  ty_read: bool = 
-0000a750: 4661 6c73 6529 202d 3e20 5265 7375 6c74  False) -> Result
-0000a760: 5b4f 7074 696f 6e61 6c5b 4a73 6f6e 5d5d  [Optional[Json]]
-0000a770: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-0000a780: 7572 6e20 6120 7261 6e64 6f6d 2064 6f63  urn a random doc
-0000a790: 756d 656e 7420 6672 6f6d 2074 6865 2063  ument from the c
-0000a7a0: 6f6c 6c65 6374 696f 6e2e 2052 6574 7572  ollection. Retur
-0000a7b0: 6e73 204e 6f6e 650a 2020 2020 2020 2020  ns None.        
-0000a7c0: 6966 2074 6865 2063 6f6c 6c65 6374 696f  if the collectio
-0000a7d0: 6e20 6973 2065 6d70 7479 2e0a 0a20 2020  n is empty...   
-0000a7e0: 2020 2020 203a 7061 7261 6d20 616c 6c6f       :param allo
-0000a7f0: 775f 6469 7274 795f 7265 6164 3a20 416c  w_dirty_read: Al
-0000a800: 6c6f 7720 7265 6164 7320 6672 6f6d 2066  low reads from f
-0000a810: 6f6c 6c6f 7765 7273 2069 6e20 6120 636c  ollowers in a cl
-0000a820: 7573 7465 722e 0a20 2020 2020 2020 203a  uster..        :
-0000a830: 7479 7065 2061 6c6c 6f77 5f64 6972 7479  type allow_dirty
-0000a840: 5f72 6561 643a 2062 6f6f 6c0a 2020 2020  _read: bool.    
-0000a850: 2020 2020 3a72 6574 7572 6e3a 2041 2072      :return: A r
-0000a860: 616e 646f 6d20 646f 6375 6d65 6e74 2e0a  andom document..
-0000a870: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
-0000a880: 6469 6374 0a20 2020 2020 2020 203a 7261  dict.        :ra
-0000a890: 6973 6520 6172 616e 676f 2e65 7863 6570  ise arango.excep
-0000a8a0: 7469 6f6e 732e 446f 6375 6d65 6e74 4765  tions.DocumentGe
-0000a8b0: 7445 7272 6f72 3a20 4966 2072 6574 7269  tError: If retri
-0000a8c0: 6576 616c 2066 6169 6c73 2e0a 2020 2020  eval fails..    
-0000a8d0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000a8e0: 7175 6572 7920 3d20 2246 4f52 2064 6f63  query = "FOR doc
-0000a8f0: 2049 4e20 4040 636f 6c6c 6563 7469 6f6e   IN @@collection
-0000a900: 2053 4f52 5420 5241 4e44 2829 204c 494d   SORT RAND() LIM
-0000a910: 4954 2031 2052 4554 5552 4e20 646f 6322  IT 1 RETURN doc"
-0000a920: 0a20 2020 2020 2020 2062 696e 645f 7661  .        bind_va
-0000a930: 7273 203d 207b 2240 636f 6c6c 6563 7469  rs = {"@collecti
-0000a940: 6f6e 223a 2073 656c 662e 6e61 6d65 7d0a  on": self.name}.
-0000a950: 0a20 2020 2020 2020 2072 6571 7565 7374  .        request
-0000a960: 203d 2052 6571 7565 7374 280a 2020 2020   = Request(.    
-0000a970: 2020 2020 2020 2020 6d65 7468 6f64 3d22          method="
-0000a980: 706f 7374 222c 0a20 2020 2020 2020 2020  post",.         
-0000a990: 2020 2065 6e64 706f 696e 743d 222f 5f61     endpoint="/_a
-0000a9a0: 7069 2f63 7572 736f 7222 2c0a 2020 2020  pi/cursor",.    
-0000a9b0: 2020 2020 2020 2020 6461 7461 3d7b 2271          data={"q
-0000a9c0: 7565 7279 223a 2071 7565 7279 2c20 2262  uery": query, "b
-0000a9d0: 696e 6456 6172 7322 3a20 6269 6e64 5f76  indVars": bind_v
-0000a9e0: 6172 737d 2c0a 2020 2020 2020 2020 2020  ars},.          
-0000a9f0: 2020 7265 6164 3d73 656c 662e 6e61 6d65    read=self.name
-0000aa00: 2c0a 2020 2020 2020 2020 2020 2020 6865  ,.            he
-0000aa10: 6164 6572 733d 7b22 782d 6172 616e 676f  aders={"x-arango
-0000aa20: 2d61 6c6c 6f77 2d64 6972 7479 2d72 6561  -allow-dirty-rea
-0000aa30: 6422 3a20 2274 7275 6522 7d20 6966 2061  d": "true"} if a
-0000aa40: 6c6c 6f77 5f64 6972 7479 5f72 6561 6420  llow_dirty_read 
-0000aa50: 656c 7365 204e 6f6e 652c 0a20 2020 2020  else None,.     
-0000aa60: 2020 2029 0a0a 2020 2020 2020 2020 6465     )..        de
-0000aa70: 6620 7265 7370 6f6e 7365 5f68 616e 646c  f response_handl
-0000aa80: 6572 2872 6573 703a 2052 6573 706f 6e73  er(resp: Respons
-0000aa90: 6529 202d 3e20 4f70 7469 6f6e 616c 5b4a  e) -> Optional[J
-0000aaa0: 736f 6e5d 3a0a 2020 2020 2020 2020 2020  son]:.          
-0000aab0: 2020 6966 206e 6f74 2072 6573 702e 6973    if not resp.is
-0000aac0: 5f73 7563 6365 7373 3a0a 2020 2020 2020  _success:.      
-0000aad0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000aae0: 446f 6375 6d65 6e74 4765 7445 7272 6f72  DocumentGetError
-0000aaf0: 2872 6573 702c 2072 6571 7565 7374 290a  (resp, request).
-0000ab00: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
-0000ab10: 736f 7220 3d20 4375 7273 6f72 2873 656c  sor = Cursor(sel
-0000ab20: 662e 5f63 6f6e 6e2c 2072 6573 702e 626f  f._conn, resp.bo
-0000ab30: 6479 290a 2020 2020 2020 2020 2020 2020  dy).            
-0000ab40: 7265 7475 726e 2063 7572 736f 722e 706f  return cursor.po
-0000ab50: 7028 2920 6966 206e 6f74 2063 7572 736f  p() if not curso
-0000ab60: 722e 656d 7074 7928 2920 656c 7365 204e  r.empty() else N
-0000ab70: 6f6e 650a 0a20 2020 2020 2020 2072 6574  one..        ret
-0000ab80: 7572 6e20 7365 6c66 2e5f 6578 6563 7574  urn self._execut
-0000ab90: 6528 7265 7175 6573 742c 2072 6573 706f  e(request, respo
-0000aba0: 6e73 655f 6861 6e64 6c65 7229 0a0a 2020  nse_handler)..  
-0000abb0: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
-0000abc0: 2323 2323 2323 0a20 2020 2023 2049 6e64  ######.    # Ind
-0000abd0: 6578 204d 616e 6167 656d 656e 7420 230a  ex Management #.
-0000abe0: 2020 2020 2323 2323 2323 2323 2323 2323      ############
-0000abf0: 2323 2323 2323 2323 0a0a 2020 2020 6465  ########..    de
-0000ac00: 6620 696e 6465 7865 7328 7365 6c66 2920  f indexes(self) 
-0000ac10: 2d3e 2052 6573 756c 745b 4a73 6f6e 735d  -> Result[Jsons]
-0000ac20: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-0000ac30: 7572 6e20 7468 6520 636f 6c6c 6563 7469  urn the collecti
-0000ac40: 6f6e 2069 6e64 6578 6573 2e0a 0a20 2020  on indexes...   
-0000ac50: 2020 2020 203a 7265 7475 726e 3a20 436f       :return: Co
-0000ac60: 6c6c 6563 7469 6f6e 2069 6e64 6578 6573  llection indexes
-0000ac70: 2e0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
-0000ac80: 3a20 5b64 6963 745d 0a20 2020 2020 2020  : [dict].       
-0000ac90: 203a 7261 6973 6520 6172 616e 676f 2e65   :raise arango.e
-0000aca0: 7863 6570 7469 6f6e 732e 496e 6465 784c  xceptions.IndexL
-0000acb0: 6973 7445 7272 6f72 3a20 4966 2072 6574  istError: If ret
-0000acc0: 7269 6576 616c 2066 6169 6c73 2e0a 2020  rieval fails..  
-0000acd0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000ace0: 2020 7265 7175 6573 7420 3d20 5265 7175    request = Requ
-0000acf0: 6573 7428 0a20 2020 2020 2020 2020 2020  est(.           
-0000ad00: 206d 6574 686f 643d 2267 6574 222c 0a20   method="get",. 
-0000ad10: 2020 2020 2020 2020 2020 2065 6e64 706f             endpo
-0000ad20: 696e 743d 222f 5f61 7069 2f69 6e64 6578  int="/_api/index
-0000ad30: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
-0000ad40: 6172 616d 733d 7b22 636f 6c6c 6563 7469  arams={"collecti
-0000ad50: 6f6e 223a 2073 656c 662e 6e61 6d65 7d2c  on": self.name},
-0000ad60: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-0000ad70: 2020 2020 6465 6620 7265 7370 6f6e 7365      def response
-0000ad80: 5f68 616e 646c 6572 2872 6573 703a 2052  _handler(resp: R
-0000ad90: 6573 706f 6e73 6529 202d 3e20 4a73 6f6e  esponse) -> Json
-0000ada0: 733a 0a20 2020 2020 2020 2020 2020 2069  s:.            i
-0000adb0: 6620 6e6f 7420 7265 7370 2e69 735f 7375  f not resp.is_su
-0000adc0: 6363 6573 733a 0a20 2020 2020 2020 2020  ccess:.         
-0000add0: 2020 2020 2020 2072 6169 7365 2049 6e64         raise Ind
-0000ade0: 6578 4c69 7374 4572 726f 7228 7265 7370  exListError(resp
-0000adf0: 2c20 7265 7175 6573 7429 0a20 2020 2020  , request).     
-0000ae00: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
-0000ae10: 7265 7370 2e62 6f64 795b 2269 6e64 6578  resp.body["index
-0000ae20: 6573 225d 0a20 2020 2020 2020 2020 2020  es"].           
-0000ae30: 2072 6574 7572 6e20 5b66 6f72 6d61 745f   return [format_
-0000ae40: 696e 6465 7828 696e 6465 7829 2066 6f72  index(index) for
-0000ae50: 2069 6e64 6578 2069 6e20 7265 7375 6c74   index in result
-0000ae60: 5d0a 0a20 2020 2020 2020 2072 6574 7572  ]..        retur
-0000ae70: 6e20 7365 6c66 2e5f 6578 6563 7574 6528  n self._execute(
-0000ae80: 7265 7175 6573 742c 2072 6573 706f 6e73  request, respons
-0000ae90: 655f 6861 6e64 6c65 7229 0a0a 2020 2020  e_handler)..    
-0000aea0: 6465 6620 6765 745f 696e 6465 7828 7365  def get_index(se
-0000aeb0: 6c66 2c20 6964 3a20 7374 7229 202d 3e20  lf, id: str) -> 
-0000aec0: 5265 7375 6c74 5b4a 736f 6e5d 3a0a 2020  Result[Json]:.  
-0000aed0: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
-0000aee0: 7468 6520 696e 6465 7820 7769 7468 2074  the index with t
-0000aef0: 6865 2067 6976 656e 2069 642e 0a0a 2020  he given id...  
-0000af00: 2020 2020 2020 3a70 6172 616d 2069 643a        :param id:
-0000af10: 2054 6865 2069 6420 6f66 2074 6865 2069   The id of the i
-0000af20: 6e64 6578 0a20 2020 2020 2020 203a 7479  ndex.        :ty
-0000af30: 7065 2069 643a 2073 7472 0a20 2020 2020  pe id: str.     
-0000af40: 2020 203a 7265 7475 726e 3a20 496e 6465     :return: Inde
-0000af50: 7820 6465 7461 696c 730a 2020 2020 2020  x details.      
-0000af60: 2020 3a72 7479 7065 3a20 6469 6374 0a20    :rtype: dict. 
-0000af70: 2020 2020 2020 203a 7261 6973 6520 6172         :raise ar
-0000af80: 616e 676f 2e65 7863 6570 7469 6f6e 732e  ango.exceptions.
-0000af90: 496e 6465 7847 6574 4572 726f 723a 2049  IndexGetError: I
-0000afa0: 6620 7265 7472 6965 7661 6c20 6661 696c  f retrieval fail
-0000afb0: 732e 0a20 2020 2020 2020 2022 2222 0a20  s..        """. 
-0000afc0: 2020 2020 2020 2072 6571 7565 7374 203d         request =
-0000afd0: 2052 6571 7565 7374 280a 2020 2020 2020   Request(.      
-0000afe0: 2020 2020 2020 6d65 7468 6f64 3d22 6765        method="ge
-0000aff0: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
-0000b000: 656e 6470 6f69 6e74 3d66 222f 5f61 7069  endpoint=f"/_api
-0000b010: 2f69 6e64 6578 2f7b 7365 6c66 2e6e 616d  /index/{self.nam
-0000b020: 657d 2f7b 6964 7d22 2c0a 2020 2020 2020  e}/{id}",.      
-0000b030: 2020 290a 0a20 2020 2020 2020 2064 6566    )..        def
-0000b040: 2072 6573 706f 6e73 655f 6861 6e64 6c65   response_handle
-0000b050: 7228 7265 7370 3a20 5265 7370 6f6e 7365  r(resp: Response
-0000b060: 2920 2d3e 204a 736f 6e3a 0a20 2020 2020  ) -> Json:.     
-0000b070: 2020 2020 2020 2069 6620 6e6f 7420 7265         if not re
-0000b080: 7370 2e69 735f 7375 6363 6573 733a 0a20  sp.is_success:. 
-0000b090: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000b0a0: 6169 7365 2049 6e64 6578 4765 7445 7272  aise IndexGetErr
-0000b0b0: 6f72 2872 6573 702c 2072 6571 7565 7374  or(resp, request
-0000b0c0: 290a 0a20 2020 2020 2020 2020 2020 2072  )..            r
-0000b0d0: 6574 7572 6e20 666f 726d 6174 5f69 6e64  eturn format_ind
-0000b0e0: 6578 2872 6573 702e 626f 6479 290a 0a20  ex(resp.body).. 
-0000b0f0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0000b100: 6c66 2e5f 6578 6563 7574 6528 7265 7175  lf._execute(requ
-0000b110: 6573 742c 2072 6573 706f 6e73 655f 6861  est, response_ha
-0000b120: 6e64 6c65 7229 0a0a 2020 2020 6465 6620  ndler)..    def 
-0000b130: 5f61 6464 5f69 6e64 6578 2873 656c 662c  _add_index(self,
-0000b140: 2064 6174 613a 204a 736f 6e29 202d 3e20   data: Json) -> 
-0000b150: 5265 7375 6c74 5b4a 736f 6e5d 3a0a 2020  Result[Json]:.  
-0000b160: 2020 2020 2020 2222 2248 656c 7065 7220        """Helper 
-0000b170: 6d65 7468 6f64 2066 6f72 2063 7265 6174  method for creat
-0000b180: 696e 6720 6120 6e65 7720 696e 6465 782e  ing a new index.
-0000b190: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0000b1a0: 2064 6174 613a 2049 6e64 6578 2064 6174   data: Index dat
-0000b1b0: 612e 0a20 2020 2020 2020 203a 7479 7065  a..        :type
-0000b1c0: 2064 6174 613a 2064 6963 740a 2020 2020   data: dict.    
-0000b1d0: 2020 2020 3a72 6574 7572 6e3a 204e 6577      :return: New
-0000b1e0: 2069 6e64 6578 2064 6574 6169 6c73 2e0a   index details..
-0000b1f0: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
-0000b200: 6469 6374 0a20 2020 2020 2020 203a 7261  dict.        :ra
-0000b210: 6973 6520 6172 616e 676f 2e65 7863 6570  ise arango.excep
-0000b220: 7469 6f6e 732e 496e 6465 7843 7265 6174  tions.IndexCreat
-0000b230: 6545 7272 6f72 3a20 4966 2063 7265 6174  eError: If creat
-0000b240: 6520 6661 696c 732e 0a20 2020 2020 2020  e fails..       
-0000b250: 2022 2222 0a20 2020 2020 2020 2072 6571   """.        req
-0000b260: 7565 7374 203d 2052 6571 7565 7374 280a  uest = Request(.
-0000b270: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
-0000b280: 6f64 3d22 706f 7374 222c 0a20 2020 2020  od="post",.     
-0000b290: 2020 2020 2020 2065 6e64 706f 696e 743d         endpoint=
-0000b2a0: 222f 5f61 7069 2f69 6e64 6578 222c 0a20  "/_api/index",. 
-0000b2b0: 2020 2020 2020 2020 2020 2064 6174 613d             data=
-0000b2c0: 6461 7461 2c0a 2020 2020 2020 2020 2020  data,.          
-0000b2d0: 2020 7061 7261 6d73 3d7b 2263 6f6c 6c65    params={"colle
-0000b2e0: 6374 696f 6e22 3a20 7365 6c66 2e6e 616d  ction": self.nam
-0000b2f0: 657d 2c0a 2020 2020 2020 2020 290a 0a20  e},.        ).. 
-0000b300: 2020 2020 2020 2064 6566 2072 6573 706f         def respo
-0000b310: 6e73 655f 6861 6e64 6c65 7228 7265 7370  nse_handler(resp
-0000b320: 3a20 5265 7370 6f6e 7365 2920 2d3e 204a  : Response) -> J
-0000b330: 736f 6e3a 0a20 2020 2020 2020 2020 2020  son:.           
-0000b340: 2069 6620 6e6f 7420 7265 7370 2e69 735f   if not resp.is_
-0000b350: 7375 6363 6573 733a 0a20 2020 2020 2020  success:.       
-0000b360: 2020 2020 2020 2020 2072 6169 7365 2049           raise I
-0000b370: 6e64 6578 4372 6561 7465 4572 726f 7228  ndexCreateError(
-0000b380: 7265 7370 2c20 7265 7175 6573 7429 0a20  resp, request). 
-0000b390: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000b3a0: 6e20 666f 726d 6174 5f69 6e64 6578 2872  n format_index(r
-0000b3b0: 6573 702e 626f 6479 290a 0a20 2020 2020  esp.body)..     
-0000b3c0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-0000b3d0: 6578 6563 7574 6528 7265 7175 6573 742c  execute(request,
-0000b3e0: 2072 6573 706f 6e73 655f 6861 6e64 6c65   response_handle
-0000b3f0: 7229 0a0a 2020 2020 6465 6620 6164 645f  r)..    def add_
-0000b400: 6861 7368 5f69 6e64 6578 280a 2020 2020  hash_index(.    
-0000b410: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-0000b420: 2020 6669 656c 6473 3a20 5365 7175 656e    fields: Sequen
-0000b430: 6365 5b73 7472 5d2c 0a20 2020 2020 2020  ce[str],.       
-0000b440: 2075 6e69 7175 653a 204f 7074 696f 6e61   unique: Optiona
-0000b450: 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65 2c0a  l[bool] = None,.
-0000b460: 2020 2020 2020 2020 7370 6172 7365 3a20          sparse: 
-0000b470: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 203d  Optional[bool] =
-0000b480: 204e 6f6e 652c 0a20 2020 2020 2020 2064   None,.        d
-0000b490: 6564 7570 6c69 6361 7465 3a20 4f70 7469  eduplicate: Opti
-0000b4a0: 6f6e 616c 5b62 6f6f 6c5d 203d 204e 6f6e  onal[bool] = Non
-0000b4b0: 652c 0a20 2020 2020 2020 206e 616d 653a  e,.        name:
-0000b4c0: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
-0000b4d0: 204e 6f6e 652c 0a20 2020 2020 2020 2069   None,.        i
-0000b4e0: 6e5f 6261 636b 6772 6f75 6e64 3a20 4f70  n_background: Op
-0000b4f0: 7469 6f6e 616c 5b62 6f6f 6c5d 203d 204e  tional[bool] = N
-0000b500: 6f6e 652c 0a20 2020 2029 202d 3e20 5265  one,.    ) -> Re
-0000b510: 7375 6c74 5b4a 736f 6e5d 3a0a 2020 2020  sult[Json]:.    
-0000b520: 2020 2020 2222 2243 7265 6174 6520 6120      """Create a 
-0000b530: 6e65 7720 6861 7368 2069 6e64 6578 2e0a  new hash index..
-0000b540: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000b550: 6669 656c 6473 3a20 446f 6375 6d65 6e74  fields: Document
-0000b560: 2066 6965 6c64 7320 746f 2069 6e64 6578   fields to index
-0000b570: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
-0000b580: 6669 656c 6473 3a20 5b73 7472 5d0a 2020  fields: [str].  
-0000b590: 2020 2020 2020 3a70 6172 616d 2075 6e69        :param uni
-0000b5a0: 7175 653a 2057 6865 7468 6572 2074 6865  que: Whether the
-0000b5b0: 2069 6e64 6578 2069 7320 756e 6971 7565   index is unique
+00001140: 642c 207b 7d0a 2020 2020 2020 2020 7265  d, {}.        re
+00001150: 7475 726e 2064 6f63 5f69 642c 207b 2249  turn doc_id, {"I
+00001160: 662d 4d61 7463 6822 3a20 646f 6375 6d65  f-Match": docume
+00001170: 6e74 5b22 5f72 6576 225d 7d0a 0a20 2020  nt["_rev"]}..   
+00001180: 2064 6566 205f 7072 6570 5f66 726f 6d5f   def _prep_from_
+00001190: 646f 6328 0a20 2020 2020 2020 2073 656c  doc(.        sel
+000011a0: 662c 2064 6f63 756d 656e 743a 2055 6e69  f, document: Uni
+000011b0: 6f6e 5b73 7472 2c20 4a73 6f6e 5d2c 2072  on[str, Json], r
+000011c0: 6576 3a20 4f70 7469 6f6e 616c 5b73 7472  ev: Optional[str
+000011d0: 5d2c 2063 6865 636b 5f72 6576 3a20 626f  ], check_rev: bo
+000011e0: 6f6c 0a20 2020 2029 202d 3e20 5475 706c  ol.    ) -> Tupl
+000011f0: 655b 7374 722c 2055 6e69 6f6e 5b73 7472  e[str, Union[str
+00001200: 2c20 4a73 6f6e 5d2c 204a 736f 6e5d 3a0a  , Json], Json]:.
+00001210: 2020 2020 2020 2020 2222 2250 7265 7061          """Prepa
+00001220: 7265 2064 6f63 756d 656e 7420 4944 2c20  re document ID, 
+00001230: 626f 6479 2061 6e64 2072 6571 7565 7374  body and request
+00001240: 2068 6561 6465 7273 2e0a 0a20 2020 2020   headers...     
+00001250: 2020 203a 7061 7261 6d20 646f 6375 6d65     :param docume
+00001260: 6e74 3a20 446f 6375 6d65 6e74 2049 442c  nt: Document ID,
+00001270: 206b 6579 206f 7220 626f 6479 2e0a 2020   key or body..  
+00001280: 2020 2020 2020 3a74 7970 6520 646f 6375        :type docu
+00001290: 6d65 6e74 3a20 7374 7220 7c20 6469 6374  ment: str | dict
+000012a0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+000012b0: 7265 763a 2044 6f63 756d 656e 7420 7265  rev: Document re
+000012c0: 7669 7369 6f6e 206f 7220 4e6f 6e65 2e0a  vision or None..
+000012d0: 2020 2020 2020 2020 3a74 7970 6520 7265          :type re
+000012e0: 763a 2073 7472 207c 204e 6f6e 650a 2020  v: str | None.  
+000012f0: 2020 2020 2020 3a70 6172 616d 2063 6865        :param che
+00001300: 636b 5f72 6576 3a20 5768 6574 6865 7220  ck_rev: Whether 
+00001310: 746f 2063 6865 636b 2074 6865 2072 6576  to check the rev
+00001320: 6973 696f 6e2e 0a20 2020 2020 2020 203a  ision..        :
+00001330: 7479 7065 2063 6865 636b 5f72 6576 3a20  type check_rev: 
+00001340: 626f 6f6c 0a20 2020 2020 2020 203a 7265  bool.        :re
+00001350: 7475 726e 3a20 446f 6375 6d65 6e74 2049  turn: Document I
+00001360: 442c 2062 6f64 7920 616e 6420 7265 7175  D, body and requ
+00001370: 6573 7420 6865 6164 6572 732e 0a20 2020  est headers..   
+00001380: 2020 2020 203a 7274 7970 653a 2028 7374       :rtype: (st
+00001390: 722c 2073 7472 207c 2062 6f64 792c 2064  r, str | body, d
+000013a0: 6963 7429 0a20 2020 2020 2020 2022 2222  ict).        """
+000013b0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+000013c0: 7374 616e 6365 2864 6f63 756d 656e 742c  stance(document,
+000013d0: 2064 6963 7429 3a0a 2020 2020 2020 2020   dict):.        
+000013e0: 2020 2020 646f 635f 6964 203d 2073 656c      doc_id = sel
+000013f0: 662e 5f65 7874 7261 6374 5f69 6428 646f  f._extract_id(do
+00001400: 6375 6d65 6e74 290a 2020 2020 2020 2020  cument).        
+00001410: 2020 2020 7265 7620 3d20 7265 7620 6f72      rev = rev or
+00001420: 2064 6f63 756d 656e 742e 6765 7428 225f   document.get("_
+00001430: 7265 7622 290a 0a20 2020 2020 2020 2020  rev")..         
+00001440: 2020 2069 6620 6e6f 7420 6368 6563 6b5f     if not check_
+00001450: 7265 7620 6f72 2072 6576 2069 7320 4e6f  rev or rev is No
+00001460: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00001470: 2020 2020 7265 7475 726e 2064 6f63 5f69      return doc_i
+00001480: 642c 2064 6f63 5f69 642c 207b 7d0a 2020  d, doc_id, {}.  
+00001490: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+000014a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000014b0: 7265 7475 726e 2064 6f63 5f69 642c 2064  return doc_id, d
+000014c0: 6f63 5f69 642c 207b 2249 662d 4d61 7463  oc_id, {"If-Matc
+000014d0: 6822 3a20 7265 767d 0a20 2020 2020 2020  h": rev}.       
+000014e0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000014f0: 2020 2069 6620 222f 2220 696e 2064 6f63     if "/" in doc
+00001500: 756d 656e 743a 0a20 2020 2020 2020 2020  ument:.         
+00001510: 2020 2020 2020 2064 6f63 5f69 6420 3d20         doc_id = 
+00001520: 7365 6c66 2e5f 7661 6c69 6461 7465 5f69  self._validate_i
+00001530: 6428 646f 6375 6d65 6e74 290a 2020 2020  d(document).    
+00001540: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00001550: 2020 2020 2020 2020 2020 2020 2020 646f                do
+00001560: 635f 6964 203d 2073 656c 662e 5f69 645f  c_id = self._id_
+00001570: 7072 6566 6978 202b 2064 6f63 756d 656e  prefix + documen
+00001580: 740a 0a20 2020 2020 2020 2020 2020 2069  t..            i
+00001590: 6620 6e6f 7420 6368 6563 6b5f 7265 7620  f not check_rev 
+000015a0: 6f72 2072 6576 2069 7320 4e6f 6e65 3a0a  or rev is None:.
+000015b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000015c0: 7265 7475 726e 2064 6f63 5f69 642c 2064  return doc_id, d
+000015d0: 6f63 5f69 642c 207b 7d0a 2020 2020 2020  oc_id, {}.      
+000015e0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+000015f0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00001600: 726e 2064 6f63 5f69 642c 2064 6f63 5f69  rn doc_id, doc_i
+00001610: 642c 207b 2249 662d 4d61 7463 6822 3a20  d, {"If-Match": 
+00001620: 7265 767d 0a0a 2020 2020 6465 6620 5f65  rev}..    def _e
+00001630: 6e73 7572 655f 6b65 795f 696e 5f62 6f64  nsure_key_in_bod
+00001640: 7928 7365 6c66 2c20 626f 6479 3a20 4a73  y(self, body: Js
+00001650: 6f6e 2920 2d3e 204a 736f 6e3a 0a20 2020  on) -> Json:.   
+00001660: 2020 2020 2022 2222 5265 7475 726e 2074       """Return t
+00001670: 6865 2064 6f63 756d 656e 7420 626f 6479  he document body
+00001680: 2077 6974 6820 225f 6b65 7922 2066 6965   with "_key" fie
+00001690: 6c64 2070 6f70 756c 6174 6564 2e0a 0a20  ld populated... 
+000016a0: 2020 2020 2020 203a 7061 7261 6d20 626f         :param bo
+000016b0: 6479 3a20 446f 6375 6d65 6e74 2062 6f64  dy: Document bod
+000016c0: 792e 0a20 2020 2020 2020 203a 7479 7065  y..        :type
+000016d0: 2062 6f64 793a 2064 6963 740a 2020 2020   body: dict.    
+000016e0: 2020 2020 3a72 6574 7572 6e3a 2044 6f63      :return: Doc
+000016f0: 756d 656e 7420 626f 6479 2077 6974 6820  ument body with 
+00001700: 225f 6b65 7922 2066 6965 6c64 2e0a 2020  "_key" field..  
+00001710: 2020 2020 2020 3a72 7479 7065 3a20 6469        :rtype: di
+00001720: 6374 0a20 2020 2020 2020 203a 7261 6973  ct.        :rais
+00001730: 6520 6172 616e 676f 2e65 7863 6570 7469  e arango.excepti
+00001740: 6f6e 732e 446f 6375 6d65 6e74 5061 7273  ons.DocumentPars
+00001750: 6545 7272 6f72 3a20 4f6e 206d 6973 7369  eError: On missi
+00001760: 6e67 2049 4420 616e 6420 6b65 792e 0a20  ng ID and key.. 
+00001770: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00001780: 2020 2069 6620 225f 6b65 7922 2069 6e20     if "_key" in 
+00001790: 626f 6479 3a0a 2020 2020 2020 2020 2020  body:.          
+000017a0: 2020 7265 7475 726e 2062 6f64 790a 2020    return body.  
+000017b0: 2020 2020 2020 656c 6966 2022 5f69 6422        elif "_id"
+000017c0: 2069 6e20 626f 6479 3a0a 2020 2020 2020   in body:.      
+000017d0: 2020 2020 2020 646f 635f 6964 203d 2073        doc_id = s
+000017e0: 656c 662e 5f76 616c 6964 6174 655f 6964  elf._validate_id
+000017f0: 2862 6f64 795b 225f 6964 225d 290a 2020  (body["_id"]).  
+00001800: 2020 2020 2020 2020 2020 626f 6479 203d            body =
+00001810: 2062 6f64 792e 636f 7079 2829 0a20 2020   body.copy().   
+00001820: 2020 2020 2020 2020 2062 6f64 795b 225f           body["_
+00001830: 6b65 7922 5d20 3d20 646f 635f 6964 5b6c  key"] = doc_id[l
+00001840: 656e 2873 656c 662e 5f69 645f 7072 6566  en(self._id_pref
+00001850: 6978 2920 3a5d 0a20 2020 2020 2020 2020  ix) :].         
+00001860: 2020 2072 6574 7572 6e20 626f 6479 0a20     return body. 
+00001870: 2020 2020 2020 2072 6169 7365 2044 6f63         raise Doc
+00001880: 756d 656e 7450 6172 7365 4572 726f 7228  umentParseError(
+00001890: 2766 6965 6c64 2022 5f6b 6579 2220 6f72  'field "_key" or
+000018a0: 2022 5f69 6422 2072 6571 7569 7265 6427   "_id" required'
+000018b0: 290a 0a20 2020 2064 6566 205f 656e 7375  )..    def _ensu
+000018c0: 7265 5f6b 6579 5f66 726f 6d5f 6964 2873  re_key_from_id(s
+000018d0: 656c 662c 2062 6f64 793a 204a 736f 6e29  elf, body: Json)
+000018e0: 202d 3e20 4a73 6f6e 3a0a 2020 2020 2020   -> Json:.      
+000018f0: 2020 2222 2252 6574 7572 6e20 7468 6520    """Return the 
+00001900: 626f 6479 2077 6974 6820 225f 6b65 7922  body with "_key"
+00001910: 2066 6965 6c64 2069 6620 6974 2068 6173   field if it has
+00001920: 2022 5f69 6422 2066 6965 6c64 2e0a 0a20   "_id" field... 
+00001930: 2020 2020 2020 203a 7061 7261 6d20 626f         :param bo
+00001940: 6479 3a20 446f 6375 6d65 6e74 2062 6f64  dy: Document bod
+00001950: 792e 0a20 2020 2020 2020 203a 7479 7065  y..        :type
+00001960: 2062 6f64 793a 2064 6963 740a 2020 2020   body: dict.    
+00001970: 2020 2020 3a72 6574 7572 6e3a 2044 6f63      :return: Doc
+00001980: 756d 656e 7420 626f 6479 2077 6974 6820  ument body with 
+00001990: 225f 6b65 7922 2066 6965 6c64 2069 6620  "_key" field if 
+000019a0: 6974 2068 6173 2022 5f69 6422 2066 6965  it has "_id" fie
+000019b0: 6c64 2e0a 2020 2020 2020 2020 3a72 7479  ld..        :rty
+000019c0: 7065 3a20 6469 6374 0a20 2020 2020 2020  pe: dict.       
+000019d0: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
+000019e0: 225f 6964 2220 696e 2062 6f64 7920 616e  "_id" in body an
+000019f0: 6420 225f 6b65 7922 206e 6f74 2069 6e20  d "_key" not in 
+00001a00: 626f 6479 3a0a 2020 2020 2020 2020 2020  body:.          
+00001a10: 2020 646f 635f 6964 203d 2073 656c 662e    doc_id = self.
+00001a20: 5f76 616c 6964 6174 655f 6964 2862 6f64  _validate_id(bod
+00001a30: 795b 225f 6964 225d 290a 2020 2020 2020  y["_id"]).      
+00001a40: 2020 2020 2020 626f 6479 203d 2062 6f64        body = bod
+00001a50: 792e 636f 7079 2829 0a20 2020 2020 2020  y.copy().       
+00001a60: 2020 2020 2062 6f64 795b 225f 6b65 7922       body["_key"
+00001a70: 5d20 3d20 646f 635f 6964 5b6c 656e 2873  ] = doc_id[len(s
+00001a80: 656c 662e 5f69 645f 7072 6566 6978 2920  elf._id_prefix) 
+00001a90: 3a5d 0a20 2020 2020 2020 2072 6574 7572  :].        retur
+00001aa0: 6e20 626f 6479 0a0a 2020 2020 4070 726f  n body..    @pro
+00001ab0: 7065 7274 790a 2020 2020 6465 6620 6e61  perty.    def na
+00001ac0: 6d65 2873 656c 6629 202d 3e20 7374 723a  me(self) -> str:
+00001ad0: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+00001ae0: 726e 2063 6f6c 6c65 6374 696f 6e20 6e61  rn collection na
+00001af0: 6d65 2e0a 0a20 2020 2020 2020 203a 7265  me...        :re
+00001b00: 7475 726e 3a20 436f 6c6c 6563 7469 6f6e  turn: Collection
+00001b10: 206e 616d 652e 0a20 2020 2020 2020 203a   name..        :
+00001b20: 7274 7970 653a 2073 7472 0a20 2020 2020  rtype: str.     
+00001b30: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+00001b40: 6574 7572 6e20 7365 6c66 2e5f 6e61 6d65  eturn self._name
+00001b50: 0a0a 2020 2020 6465 6620 7265 6361 6c63  ..    def recalc
+00001b60: 756c 6174 655f 636f 756e 7428 7365 6c66  ulate_count(self
+00001b70: 2920 2d3e 2052 6573 756c 745b 626f 6f6c  ) -> Result[bool
+00001b80: 5d3a 0a20 2020 2020 2020 2022 2222 5265  ]:.        """Re
+00001b90: 6361 6c63 756c 6174 6520 7468 6520 646f  calculate the do
+00001ba0: 6375 6d65 6e74 2063 6f75 6e74 2e0a 0a20  cument count... 
+00001bb0: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
+00001bc0: 5472 7565 2069 6620 7265 6361 6c63 756c  True if recalcul
+00001bd0: 6174 696f 6e20 7761 7320 7375 6363 6573  ation was succes
+00001be0: 7366 756c 2e0a 2020 2020 2020 2020 3a72  sful..        :r
+00001bf0: 7479 7065 3a20 626f 6f6c 0a20 2020 2020  type: bool.     
+00001c00: 2020 203a 7261 6973 6520 6172 616e 676f     :raise arango
+00001c10: 2e65 7863 6570 7469 6f6e 732e 436f 6c6c  .exceptions.Coll
+00001c20: 6563 7469 6f6e 5265 6361 6c63 756c 6174  ectionRecalculat
+00001c30: 6543 6f75 6e74 4572 726f 723a 2049 6620  eCountError: If 
+00001c40: 6f70 6572 6174 696f 6e20 6661 696c 732e  operation fails.
+00001c50: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00001c60: 2020 2020 2072 6571 7565 7374 203d 2052       request = R
+00001c70: 6571 7565 7374 280a 2020 2020 2020 2020  equest(.        
+00001c80: 2020 2020 6d65 7468 6f64 3d22 7075 7422      method="put"
+00001c90: 2c0a 2020 2020 2020 2020 2020 2020 656e  ,.            en
+00001ca0: 6470 6f69 6e74 3d66 222f 5f61 7069 2f63  dpoint=f"/_api/c
+00001cb0: 6f6c 6c65 6374 696f 6e2f 7b73 656c 662e  ollection/{self.
+00001cc0: 6e61 6d65 7d2f 7265 6361 6c63 756c 6174  name}/recalculat
+00001cd0: 6543 6f75 6e74 222c 0a20 2020 2020 2020  eCount",.       
+00001ce0: 2029 0a0a 2020 2020 2020 2020 6465 6620   )..        def 
+00001cf0: 7265 7370 6f6e 7365 5f68 616e 646c 6572  response_handler
+00001d00: 2872 6573 703a 2052 6573 706f 6e73 6529  (resp: Response)
+00001d10: 202d 3e20 626f 6f6c 3a0a 2020 2020 2020   -> bool:.      
+00001d20: 2020 2020 2020 6966 2072 6573 702e 6973        if resp.is
+00001d30: 5f73 7563 6365 7373 3a0a 2020 2020 2020  _success:.      
+00001d40: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00001d50: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
+00001d60: 2020 7261 6973 6520 436f 6c6c 6563 7469    raise Collecti
+00001d70: 6f6e 5265 6361 6c63 756c 6174 6543 6f75  onRecalculateCou
+00001d80: 6e74 4572 726f 7228 7265 7370 2c20 7265  ntError(resp, re
+00001d90: 7175 6573 7429 0a0a 2020 2020 2020 2020  quest)..        
+00001da0: 7265 7475 726e 2073 656c 662e 5f65 7865  return self._exe
+00001db0: 6375 7465 2872 6571 7565 7374 2c20 7265  cute(request, re
+00001dc0: 7370 6f6e 7365 5f68 616e 646c 6572 290a  sponse_handler).
+00001dd0: 0a20 2020 2064 6566 2072 6573 706f 6e73  .    def respons
+00001de0: 6962 6c65 5f73 6861 7264 2873 656c 662c  ible_shard(self,
+00001df0: 2064 6f63 756d 656e 743a 204a 736f 6e29   document: Json)
+00001e00: 202d 3e20 5265 7375 6c74 5b73 7472 5d3a   -> Result[str]:
+00001e10: 2020 2320 7072 6167 6d61 3a20 6e6f 2063    # pragma: no c
+00001e20: 6f76 6572 0a20 2020 2020 2020 2022 2222  over.        """
+00001e30: 5265 7475 726e 2074 6865 2049 4420 6f66  Return the ID of
+00001e40: 2074 6865 2073 6861 7264 2072 6573 706f   the shard respo
+00001e50: 6e73 6962 6c65 2066 6f72 2067 6976 656e  nsible for given
+00001e60: 202a 2a64 6f63 756d 656e 742a 2a2e 0a0a   **document**...
+00001e70: 2020 2020 2020 2020 4966 2074 6865 2064          If the d
+00001e80: 6f63 756d 656e 7420 646f 6573 206e 6f74  ocument does not
+00001e90: 2065 7869 7374 2c20 7265 7475 726e 2074   exist, return t
+00001ea0: 6865 2073 6861 7264 2074 6861 7420 776f  he shard that wo
+00001eb0: 756c 6420 6265 0a20 2020 2020 2020 2072  uld be.        r
+00001ec0: 6573 706f 6e73 6962 6c65 2e0a 0a20 2020  esponsible...   
+00001ed0: 2020 2020 203a 7265 7475 726e 3a20 5368       :return: Sh
+00001ee0: 6172 6420 4944 0a20 2020 2020 2020 203a  ard ID.        :
+00001ef0: 7274 7970 653a 2073 7472 0a20 2020 2020  rtype: str.     
+00001f00: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+00001f10: 6571 7565 7374 203d 2052 6571 7565 7374  equest = Request
+00001f20: 280a 2020 2020 2020 2020 2020 2020 6d65  (.            me
+00001f30: 7468 6f64 3d22 7075 7422 2c0a 2020 2020  thod="put",.    
+00001f40: 2020 2020 2020 2020 656e 6470 6f69 6e74          endpoint
+00001f50: 3d66 222f 5f61 7069 2f63 6f6c 6c65 6374  =f"/_api/collect
+00001f60: 696f 6e2f 7b73 656c 662e 6e61 6d65 7d2f  ion/{self.name}/
+00001f70: 7265 7370 6f6e 7369 626c 6553 6861 7264  responsibleShard
+00001f80: 222c 0a20 2020 2020 2020 2020 2020 2064  ",.            d
+00001f90: 6174 613d 646f 6375 6d65 6e74 2c0a 2020  ata=document,.  
+00001fa0: 2020 2020 2020 2020 2020 7265 6164 3d73            read=s
+00001fb0: 656c 662e 6e61 6d65 2c0a 2020 2020 2020  elf.name,.      
+00001fc0: 2020 290a 0a20 2020 2020 2020 2064 6566    )..        def
+00001fd0: 2072 6573 706f 6e73 655f 6861 6e64 6c65   response_handle
+00001fe0: 7228 7265 7370 3a20 5265 7370 6f6e 7365  r(resp: Response
+00001ff0: 2920 2d3e 2073 7472 3a0a 2020 2020 2020  ) -> str:.      
+00002000: 2020 2020 2020 6966 2072 6573 702e 6973        if resp.is
+00002010: 5f73 7563 6365 7373 3a0a 2020 2020 2020  _success:.      
+00002020: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00002030: 2073 7472 2872 6573 702e 626f 6479 5b22   str(resp.body["
+00002040: 7368 6172 6449 6422 5d29 0a20 2020 2020  shardId"]).     
+00002050: 2020 2020 2020 2072 6169 7365 2043 6f6c         raise Col
+00002060: 6c65 6374 696f 6e52 6573 706f 6e73 6962  lectionResponsib
+00002070: 6c65 5368 6172 6445 7272 6f72 2872 6573  leShardError(res
+00002080: 702c 2072 6571 7565 7374 290a 0a20 2020  p, request)..   
+00002090: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000020a0: 2e5f 6578 6563 7574 6528 7265 7175 6573  ._execute(reques
+000020b0: 742c 2072 6573 706f 6e73 655f 6861 6e64  t, response_hand
+000020c0: 6c65 7229 0a0a 2020 2020 6465 6620 7265  ler)..    def re
+000020d0: 6e61 6d65 2873 656c 662c 206e 6577 5f6e  name(self, new_n
+000020e0: 616d 653a 2073 7472 2920 2d3e 2052 6573  ame: str) -> Res
+000020f0: 756c 745b 626f 6f6c 5d3a 0a20 2020 2020  ult[bool]:.     
+00002100: 2020 2022 2222 5265 6e61 6d65 2074 6865     """Rename the
+00002110: 2063 6f6c 6c65 6374 696f 6e2e 0a0a 2020   collection...  
+00002120: 2020 2020 2020 5265 6e61 6d65 7320 6d61        Renames ma
+00002130: 7920 6e6f 7420 6265 2072 6566 6c65 6374  y not be reflect
+00002140: 6564 2069 6d6d 6564 6961 7465 6c79 2069  ed immediately i
+00002150: 6e20 6173 796e 6320 6578 6563 7574 696f  n async executio
+00002160: 6e2c 2062 6174 6368 0a20 2020 2020 2020  n, batch.       
+00002170: 2065 7865 6375 7469 6f6e 206f 7220 7472   execution or tr
+00002180: 616e 7361 6374 696f 6e73 2e20 4974 2069  ansactions. It i
+00002190: 7320 7265 636f 6d6d 656e 6465 6420 746f  s recommended to
+000021a0: 2069 6e69 7469 616c 697a 6520 6e65 7720   initialize new 
+000021b0: 4150 490a 2020 2020 2020 2020 7772 6170  API.        wrap
+000021c0: 7065 7273 2061 6674 6572 2061 2072 656e  pers after a ren
+000021d0: 616d 652e 0a0a 2020 2020 2020 2020 3a70  ame...        :p
+000021e0: 6172 616d 206e 6577 5f6e 616d 653a 204e  aram new_name: N
+000021f0: 6577 2063 6f6c 6c65 6374 696f 6e20 6e61  ew collection na
+00002200: 6d65 2e0a 2020 2020 2020 2020 3a74 7970  me..        :typ
+00002210: 6520 6e65 775f 6e61 6d65 3a20 7374 720a  e new_name: str.
+00002220: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
+00002230: 2054 7275 6520 6966 2063 6f6c 6c65 6374   True if collect
+00002240: 696f 6e20 7761 7320 7265 6e61 6d65 6420  ion was renamed 
+00002250: 7375 6363 6573 7366 756c 6c79 2e0a 2020  successfully..  
+00002260: 2020 2020 2020 3a72 7479 7065 3a20 626f        :rtype: bo
+00002270: 6f6c 0a20 2020 2020 2020 203a 7261 6973  ol.        :rais
+00002280: 6520 6172 616e 676f 2e65 7863 6570 7469  e arango.excepti
+00002290: 6f6e 732e 436f 6c6c 6563 7469 6f6e 5265  ons.CollectionRe
+000022a0: 6e61 6d65 4572 726f 723a 2049 6620 7265  nameError: If re
+000022b0: 6e61 6d65 2066 6169 6c73 2e0a 2020 2020  name fails..    
+000022c0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000022d0: 7265 7175 6573 7420 3d20 5265 7175 6573  request = Reques
+000022e0: 7428 0a20 2020 2020 2020 2020 2020 206d  t(.            m
+000022f0: 6574 686f 643d 2270 7574 222c 0a20 2020  ethod="put",.   
+00002300: 2020 2020 2020 2020 2065 6e64 706f 696e           endpoin
+00002310: 743d 6622 2f5f 6170 692f 636f 6c6c 6563  t=f"/_api/collec
+00002320: 7469 6f6e 2f7b 7365 6c66 2e6e 616d 657d  tion/{self.name}
+00002330: 2f72 656e 616d 6522 2c0a 2020 2020 2020  /rename",.      
+00002340: 2020 2020 2020 6461 7461 3d7b 226e 616d        data={"nam
+00002350: 6522 3a20 6e65 775f 6e61 6d65 7d2c 0a20  e": new_name},. 
+00002360: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00002370: 2020 6465 6620 7265 7370 6f6e 7365 5f68    def response_h
+00002380: 616e 646c 6572 2872 6573 703a 2052 6573  andler(resp: Res
+00002390: 706f 6e73 6529 202d 3e20 626f 6f6c 3a0a  ponse) -> bool:.
+000023a0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+000023b0: 6f74 2072 6573 702e 6973 5f73 7563 6365  ot resp.is_succe
+000023c0: 7373 3a0a 2020 2020 2020 2020 2020 2020  ss:.            
+000023d0: 2020 2020 7261 6973 6520 436f 6c6c 6563      raise Collec
+000023e0: 7469 6f6e 5265 6e61 6d65 4572 726f 7228  tionRenameError(
+000023f0: 7265 7370 2c20 7265 7175 6573 7429 0a20  resp, request). 
+00002400: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00002410: 5f6e 616d 6520 3d20 6e65 775f 6e61 6d65  _name = new_name
+00002420: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00002430: 662e 5f69 645f 7072 6566 6978 203d 206e  f._id_prefix = n
+00002440: 6577 5f6e 616d 6520 2b20 222f 220a 2020  ew_name + "/".  
+00002450: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00002460: 2054 7275 650a 0a20 2020 2020 2020 2072   True..        r
+00002470: 6574 7572 6e20 7365 6c66 2e5f 6578 6563  eturn self._exec
+00002480: 7574 6528 7265 7175 6573 742c 2072 6573  ute(request, res
+00002490: 706f 6e73 655f 6861 6e64 6c65 7229 0a0a  ponse_handler)..
+000024a0: 2020 2020 6465 6620 7072 6f70 6572 7469      def properti
+000024b0: 6573 2873 656c 6629 202d 3e20 5265 7375  es(self) -> Resu
+000024c0: 6c74 5b4a 736f 6e5d 3a0a 2020 2020 2020  lt[Json]:.      
+000024d0: 2020 2222 2252 6574 7572 6e20 636f 6c6c    """Return coll
+000024e0: 6563 7469 6f6e 2070 726f 7065 7274 6965  ection propertie
+000024f0: 732e 0a0a 2020 2020 2020 2020 3a72 6574  s...        :ret
+00002500: 7572 6e3a 2043 6f6c 6c65 6374 696f 6e20  urn: Collection 
+00002510: 7072 6f70 6572 7469 6573 2e0a 2020 2020  properties..    
+00002520: 2020 2020 3a72 7479 7065 3a20 6469 6374      :rtype: dict
+00002530: 0a20 2020 2020 2020 203a 7261 6973 6520  .        :raise 
+00002540: 6172 616e 676f 2e65 7863 6570 7469 6f6e  arango.exception
+00002550: 732e 436f 6c6c 6563 7469 6f6e 5072 6f70  s.CollectionProp
+00002560: 6572 7469 6573 4572 726f 723a 2049 6620  ertiesError: If 
+00002570: 7265 7472 6965 7661 6c20 6661 696c 732e  retrieval fails.
+00002580: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00002590: 2020 2020 2072 6571 7565 7374 203d 2052       request = R
+000025a0: 6571 7565 7374 280a 2020 2020 2020 2020  equest(.        
+000025b0: 2020 2020 6d65 7468 6f64 3d22 6765 7422      method="get"
+000025c0: 2c0a 2020 2020 2020 2020 2020 2020 656e  ,.            en
+000025d0: 6470 6f69 6e74 3d66 222f 5f61 7069 2f63  dpoint=f"/_api/c
+000025e0: 6f6c 6c65 6374 696f 6e2f 7b73 656c 662e  ollection/{self.
+000025f0: 6e61 6d65 7d2f 7072 6f70 6572 7469 6573  name}/properties
+00002600: 222c 0a20 2020 2020 2020 2020 2020 2072  ",.            r
+00002610: 6561 643d 7365 6c66 2e6e 616d 652c 0a20  ead=self.name,. 
+00002620: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00002630: 2020 6465 6620 7265 7370 6f6e 7365 5f68    def response_h
+00002640: 616e 646c 6572 2872 6573 703a 2052 6573  andler(resp: Res
+00002650: 706f 6e73 6529 202d 3e20 4a73 6f6e 3a0a  ponse) -> Json:.
+00002660: 2020 2020 2020 2020 2020 2020 6966 2072              if r
+00002670: 6573 702e 6973 5f73 7563 6365 7373 3a0a  esp.is_success:.
+00002680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002690: 7265 7475 726e 2066 6f72 6d61 745f 636f  return format_co
+000026a0: 6c6c 6563 7469 6f6e 2872 6573 702e 626f  llection(resp.bo
+000026b0: 6479 290a 2020 2020 2020 2020 2020 2020  dy).            
+000026c0: 7261 6973 6520 436f 6c6c 6563 7469 6f6e  raise Collection
+000026d0: 5072 6f70 6572 7469 6573 4572 726f 7228  PropertiesError(
+000026e0: 7265 7370 2c20 7265 7175 6573 7429 0a0a  resp, request)..
+000026f0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00002700: 656c 662e 5f65 7865 6375 7465 2872 6571  elf._execute(req
+00002710: 7565 7374 2c20 7265 7370 6f6e 7365 5f68  uest, response_h
+00002720: 616e 646c 6572 290a 0a20 2020 2064 6566  andler)..    def
+00002730: 2073 6861 7264 7328 7365 6c66 2c20 6465   shards(self, de
+00002740: 7461 696c 733a 2062 6f6f 6c20 3d20 4661  tails: bool = Fa
+00002750: 6c73 6529 202d 3e20 5265 7375 6c74 5b4a  lse) -> Result[J
+00002760: 736f 6e5d 3a0a 2020 2020 2020 2020 2222  son]:.        ""
+00002770: 2252 6574 7572 6e20 636f 6c6c 6563 7469  "Return collecti
+00002780: 6f6e 2073 6861 7264 7320 616e 6420 7072  on shards and pr
+00002790: 6f70 6572 7469 6573 2e0a 0a20 2020 2020  operties...     
+000027a0: 2020 2041 7661 696c 6162 6c65 206f 6e6c     Available onl
+000027b0: 7920 696e 2061 2063 6c75 7374 6572 2073  y in a cluster s
+000027c0: 6574 7570 2e0a 0a20 2020 2020 2020 203a  etup...        :
+000027d0: 7061 7261 6d20 6465 7461 696c 733a 2049  param details: I
+000027e0: 6e63 6c75 6465 2072 6573 706f 6e73 6962  nclude responsib
+000027f0: 6c65 2073 6572 7665 7273 2066 6f72 2065  le servers for e
+00002800: 6163 6820 7368 6172 642e 0a20 2020 2020  ach shard..     
+00002810: 2020 203a 7479 7065 2064 6574 6169 6c73     :type details
+00002820: 3a20 626f 6f6c 0a20 2020 2020 2020 203a  : bool.        :
+00002830: 7265 7475 726e 3a20 436f 6c6c 6563 7469  return: Collecti
+00002840: 6f6e 2073 6861 7264 7320 616e 6420 7072  on shards and pr
+00002850: 6f70 6572 7469 6573 2e0a 2020 2020 2020  operties..      
+00002860: 2020 3a72 7479 7065 3a20 6469 6374 0a20    :rtype: dict. 
+00002870: 2020 2020 2020 203a 7261 6973 6520 6172         :raise ar
+00002880: 616e 676f 2e65 7863 6570 7469 6f6e 732e  ango.exceptions.
+00002890: 436f 6c6c 6563 7469 6f6e 5368 6172 6473  CollectionShards
+000028a0: 4572 726f 723a 2049 6620 7265 7472 6965  Error: If retrie
+000028b0: 7661 6c20 6661 696c 732e 0a20 2020 2020  val fails..     
+000028c0: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+000028d0: 6571 7565 7374 203d 2052 6571 7565 7374  equest = Request
+000028e0: 280a 2020 2020 2020 2020 2020 2020 6d65  (.            me
+000028f0: 7468 6f64 3d22 6765 7422 2c0a 2020 2020  thod="get",.    
+00002900: 2020 2020 2020 2020 656e 6470 6f69 6e74          endpoint
+00002910: 3d66 222f 5f61 7069 2f63 6f6c 6c65 6374  =f"/_api/collect
+00002920: 696f 6e2f 7b73 656c 662e 6e61 6d65 7d2f  ion/{self.name}/
+00002930: 7368 6172 6473 222c 0a20 2020 2020 2020  shards",.       
+00002940: 2020 2020 2070 6172 616d 733d 7b22 6465       params={"de
+00002950: 7461 696c 7322 3a20 6465 7461 696c 737d  tails": details}
+00002960: 2c0a 2020 2020 2020 2020 2020 2020 7265  ,.            re
+00002970: 6164 3d73 656c 662e 6e61 6d65 2c0a 2020  ad=self.name,.  
+00002980: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00002990: 2064 6566 2072 6573 706f 6e73 655f 6861   def response_ha
+000029a0: 6e64 6c65 7228 7265 7370 3a20 5265 7370  ndler(resp: Resp
+000029b0: 6f6e 7365 2920 2d3e 204a 736f 6e3a 0a20  onse) -> Json:. 
+000029c0: 2020 2020 2020 2020 2020 2069 6620 7265             if re
+000029d0: 7370 2e69 735f 7375 6363 6573 733a 0a20  sp.is_success:. 
+000029e0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+000029f0: 6574 7572 6e20 666f 726d 6174 5f63 6f6c  eturn format_col
+00002a00: 6c65 6374 696f 6e28 7265 7370 2e62 6f64  lection(resp.bod
+00002a10: 7929 0a20 2020 2020 2020 2020 2020 2072  y).            r
+00002a20: 6169 7365 2043 6f6c 6c65 6374 696f 6e53  aise CollectionS
+00002a30: 6861 7264 7345 7272 6f72 2872 6573 702c  hardsError(resp,
+00002a40: 2072 6571 7565 7374 290a 0a20 2020 2020   request)..     
+00002a50: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00002a60: 6578 6563 7574 6528 7265 7175 6573 742c  execute(request,
+00002a70: 2072 6573 706f 6e73 655f 6861 6e64 6c65   response_handle
+00002a80: 7229 0a0a 2020 2020 6465 6620 696e 666f  r)..    def info
+00002a90: 2873 656c 6629 202d 3e20 5265 7375 6c74  (self) -> Result
+00002aa0: 5b4a 736f 6e5d 3a0a 2020 2020 2020 2020  [Json]:.        
+00002ab0: 2222 2252 6574 7572 6e20 7468 6520 636f  """Return the co
+00002ac0: 6c6c 6563 7469 6f6e 2069 6e66 6f72 6d61  llection informa
+00002ad0: 7469 6f6e 2e0a 0a20 2020 2020 2020 203a  tion...        :
+00002ae0: 7265 7475 726e 3a20 496e 666f 726d 6174  return: Informat
+00002af0: 696f 6e20 6162 6f75 7420 7468 6520 636f  ion about the co
+00002b00: 6c6c 6563 7469 6f6e 2e0a 2020 2020 2020  llection..      
+00002b10: 2020 3a72 7479 7065 3a20 6469 6374 0a20    :rtype: dict. 
+00002b20: 2020 2020 2020 203a 7261 6973 6520 6172         :raise ar
+00002b30: 616e 676f 2e65 7863 6570 7469 6f6e 732e  ango.exceptions.
+00002b40: 436f 6c6c 6563 7469 6f6e 496e 666f 726d  CollectionInform
+00002b50: 6174 696f 6e45 7272 6f72 3a20 4966 2072  ationError: If r
+00002b60: 6574 7269 6576 616c 2066 6169 6c73 2e0a  etrieval fails..
+00002b70: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00002b80: 2020 2020 7265 7175 6573 7420 3d20 5265      request = Re
+00002b90: 7175 6573 7428 0a20 2020 2020 2020 2020  quest(.         
+00002ba0: 2020 206d 6574 686f 643d 2267 6574 222c     method="get",
+00002bb0: 0a20 2020 2020 2020 2020 2020 2065 6e64  .            end
+00002bc0: 706f 696e 743d 6622 2f5f 6170 692f 636f  point=f"/_api/co
+00002bd0: 6c6c 6563 7469 6f6e 2f7b 7365 6c66 2e6e  llection/{self.n
+00002be0: 616d 657d 222c 0a20 2020 2020 2020 2020  ame}",.         
+00002bf0: 2020 2072 6561 643d 7365 6c66 2e6e 616d     read=self.nam
+00002c00: 652c 0a20 2020 2020 2020 2029 0a0a 2020  e,.        )..  
+00002c10: 2020 2020 2020 6465 6620 7265 7370 6f6e        def respon
+00002c20: 7365 5f68 616e 646c 6572 2872 6573 703a  se_handler(resp:
+00002c30: 2052 6573 706f 6e73 6529 202d 3e20 4a73   Response) -> Js
+00002c40: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
+00002c50: 6966 2072 6573 702e 6973 5f73 7563 6365  if resp.is_succe
+00002c60: 7373 3a0a 2020 2020 2020 2020 2020 2020  ss:.            
+00002c70: 2020 2020 7265 7475 726e 2066 6f72 6d61      return forma
+00002c80: 745f 636f 6c6c 6563 7469 6f6e 2872 6573  t_collection(res
+00002c90: 702e 626f 6479 290a 2020 2020 2020 2020  p.body).        
+00002ca0: 2020 2020 7261 6973 6520 436f 6c6c 6563      raise Collec
+00002cb0: 7469 6f6e 496e 666f 726d 6174 696f 6e45  tionInformationE
+00002cc0: 7272 6f72 2872 6573 702c 2072 6571 7565  rror(resp, reque
+00002cd0: 7374 290a 0a20 2020 2020 2020 2072 6574  st)..        ret
+00002ce0: 7572 6e20 7365 6c66 2e5f 6578 6563 7574  urn self._execut
+00002cf0: 6528 7265 7175 6573 742c 2072 6573 706f  e(request, respo
+00002d00: 6e73 655f 6861 6e64 6c65 7229 0a0a 2020  nse_handler)..  
+00002d10: 2020 6465 6620 636f 6e66 6967 7572 6528    def configure(
+00002d20: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00002d30: 2020 2020 2020 2073 796e 633a 204f 7074         sync: Opt
+00002d40: 696f 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f  ional[bool] = No
+00002d50: 6e65 2c0a 2020 2020 2020 2020 7363 6865  ne,.        sche
+00002d60: 6d61 3a20 4f70 7469 6f6e 616c 5b4a 736f  ma: Optional[Jso
+00002d70: 6e5d 203d 204e 6f6e 652c 0a20 2020 2020  n] = None,.     
+00002d80: 2020 2072 6570 6c69 6361 7469 6f6e 5f66     replication_f
+00002d90: 6163 746f 723a 204f 7074 696f 6e61 6c5b  actor: Optional[
+00002da0: 696e 745d 203d 204e 6f6e 652c 0a20 2020  int] = None,.   
+00002db0: 2020 2020 2077 7269 7465 5f63 6f6e 6365       write_conce
+00002dc0: 726e 3a20 4f70 7469 6f6e 616c 5b69 6e74  rn: Optional[int
+00002dd0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+00002de0: 2020 636f 6d70 7574 6564 5f76 616c 7565    computed_value
+00002df0: 733a 204f 7074 696f 6e61 6c5b 4a73 6f6e  s: Optional[Json
+00002e00: 735d 203d 204e 6f6e 652c 0a20 2020 2029  s] = None,.    )
+00002e10: 202d 3e20 5265 7375 6c74 5b4a 736f 6e5d   -> Result[Json]
+00002e20: 3a0a 2020 2020 2020 2020 2222 2243 6f6e  :.        """Con
+00002e30: 6669 6775 7265 2063 6f6c 6c65 6374 696f  figure collectio
+00002e40: 6e20 7072 6f70 6572 7469 6573 2e0a 0a20  n properties... 
+00002e50: 2020 2020 2020 203a 7061 7261 6d20 7379         :param sy
+00002e60: 6e63 3a20 426c 6f63 6b20 756e 7469 6c20  nc: Block until 
+00002e70: 6f70 6572 6174 696f 6e73 2061 7265 2073  operations are s
+00002e80: 796e 6368 726f 6e69 7a65 6420 746f 2064  ynchronized to d
+00002e90: 6973 6b2e 0a20 2020 2020 2020 203a 7479  isk..        :ty
+00002ea0: 7065 2073 796e 633a 2062 6f6f 6c20 7c20  pe sync: bool | 
+00002eb0: 4e6f 6e65 0a20 2020 2020 2020 203a 7061  None.        :pa
+00002ec0: 7261 6d20 7363 6865 6d61 3a20 646f 6375  ram schema: docu
+00002ed0: 6d65 6e74 2073 6368 656d 6120 666f 7220  ment schema for 
+00002ee0: 7661 6c69 6461 7469 6f6e 206f 6620 6f62  validation of ob
+00002ef0: 6a65 6374 732e 0a20 2020 2020 2020 203a  jects..        :
+00002f00: 7479 7065 2073 6368 656d 613a 2064 6963  type schema: dic
+00002f10: 740a 2020 2020 2020 2020 3a70 6172 616d  t.        :param
+00002f20: 2072 6570 6c69 6361 7469 6f6e 5f66 6163   replication_fac
+00002f30: 746f 723a 204e 756d 6265 7220 6f66 2063  tor: Number of c
+00002f40: 6f70 6965 7320 6f66 2065 6163 6820 7368  opies of each sh
+00002f50: 6172 6420 6f6e 2064 6966 6665 7265 6e74  ard on different
+00002f60: 0a20 2020 2020 2020 2020 2020 2073 6572  .            ser
+00002f70: 7665 7273 2069 6e20 6120 636c 7573 7465  vers in a cluste
+00002f80: 722e 2041 6c6c 6f77 6564 2076 616c 7565  r. Allowed value
+00002f90: 7320 6172 6520 3120 286f 6e6c 7920 6f6e  s are 1 (only on
+00002fa0: 6520 636f 7079 2069 7320 6b65 7074 0a20  e copy is kept. 
+00002fb0: 2020 2020 2020 2020 2020 2061 6e64 206e             and n
+00002fc0: 6f20 7379 6e63 6872 6f6e 6f75 7320 7265  o synchronous re
+00002fd0: 706c 6963 6174 696f 6e29 2c20 616e 6420  plication), and 
+00002fe0: 6e20 286e 2d31 2072 6570 6c69 6361 7320  n (n-1 replicas 
+00002ff0: 6172 6520 6b65 7074 2061 6e64 0a20 2020  are kept and.   
+00003000: 2020 2020 2020 2020 2061 6e79 2074 776f           any two
+00003010: 2063 6f70 6965 7320 6172 6520 7265 706c   copies are repl
+00003020: 6963 6174 6564 2061 6372 6f73 7320 7365  icated across se
+00003030: 7276 6572 7320 7379 6e63 6872 6f6e 6f75  rvers synchronou
+00003040: 736c 792c 206d 6561 6e69 6e67 0a20 2020  sly, meaning.   
+00003050: 2020 2020 2020 2020 2065 7665 7279 2077           every w
+00003060: 7269 7465 2074 6f20 7468 6520 6d61 7374  rite to the mast
+00003070: 6572 2069 7320 636f 7069 6564 2074 6f20  er is copied to 
+00003080: 616c 6c20 736c 6176 6573 2062 6566 6f72  all slaves befor
+00003090: 6520 6f70 6572 6174 696f 6e0a 2020 2020  e operation.    
+000030a0: 2020 2020 2020 2020 6973 2072 6570 6f72          is repor
+000030b0: 7465 6420 7375 6363 6573 7366 756c 292e  ted successful).
+000030c0: 0a20 2020 2020 2020 203a 7479 7065 2072  .        :type r
+000030d0: 6570 6c69 6361 7469 6f6e 5f66 6163 746f  eplication_facto
+000030e0: 723a 2069 6e74 0a20 2020 2020 2020 203a  r: int.        :
+000030f0: 7061 7261 6d20 7772 6974 655f 636f 6e63  param write_conc
+00003100: 6572 6e3a 2057 7269 7465 2063 6f6e 6365  ern: Write conce
+00003110: 726e 2066 6f72 2074 6865 2063 6f6c 6c65  rn for the colle
+00003120: 6374 696f 6e2e 2044 6574 6572 6d69 6e65  ction. Determine
+00003130: 7320 686f 770a 2020 2020 2020 2020 2020  s how.          
+00003140: 2020 6d61 6e79 2063 6f70 6965 7320 6f66    many copies of
+00003150: 2065 6163 6820 7368 6172 6420 6172 6520   each shard are 
+00003160: 7265 7175 6972 6564 2074 6f20 6265 2069  required to be i
+00003170: 6e20 7379 6e63 206f 6e20 6469 6666 6572  n sync on differ
+00003180: 656e 740a 2020 2020 2020 2020 2020 2020  ent.            
+00003190: 4442 5365 7276 6572 732e 2049 6620 7468  DBServers. If th
+000031a0: 6572 6520 6172 6520 6c65 7373 2074 6861  ere are less tha
+000031b0: 6e20 7468 6573 6520 6d61 6e79 2063 6f70  n these many cop
+000031c0: 6965 7320 696e 2074 6865 2063 6c75 7374  ies in the clust
+000031d0: 6572 0a20 2020 2020 2020 2020 2020 2061  er.            a
+000031e0: 2073 6861 7264 2077 696c 6c20 7265 6675   shard will refu
+000031f0: 7365 2074 6f20 7772 6974 652e 2057 7269  se to write. Wri
+00003200: 7465 7320 746f 2073 6861 7264 7320 7769  tes to shards wi
+00003210: 7468 2065 6e6f 7567 680a 2020 2020 2020  th enough.      
+00003220: 2020 2020 2020 7570 2d74 6f2d 6461 7465        up-to-date
+00003230: 2063 6f70 6965 7320 7769 6c6c 2073 7563   copies will suc
+00003240: 6365 6564 2061 7420 7468 6520 7361 6d65  ceed at the same
+00003250: 2074 696d 652e 2054 6865 2076 616c 7565   time. The value
+00003260: 206f 6620 7468 6973 0a20 2020 2020 2020   of this.       
+00003270: 2020 2020 2070 6172 616d 6574 6572 2063       parameter c
+00003280: 616e 6e6f 7420 6265 206c 6172 6765 7220  annot be larger 
+00003290: 7468 616e 2074 6861 7420 6f66 202a 2a72  than that of **r
+000032a0: 6570 6c69 6361 7469 6f6e 5f66 6163 746f  eplication_facto
+000032b0: 722a 2a2e 0a20 2020 2020 2020 2020 2020  r**..           
+000032c0: 2044 6566 6175 6c74 2076 616c 7565 2069   Default value i
+000032d0: 7320 312e 2055 7365 6420 666f 7220 636c  s 1. Used for cl
+000032e0: 7573 7465 7273 206f 6e6c 792e 0a20 2020  usters only..   
+000032f0: 2020 2020 203a 7479 7065 2077 7269 7465       :type write
+00003300: 5f63 6f6e 6365 726e 3a20 696e 740a 2020  _concern: int.  
+00003310: 2020 2020 2020 3a72 6574 7572 6e3a 204e        :return: N
+00003320: 6577 2063 6f6c 6c65 6374 696f 6e20 7072  ew collection pr
+00003330: 6f70 6572 7469 6573 2e0a 2020 2020 2020  operties..      
+00003340: 2020 3a70 6172 616d 2063 6f6d 7075 7465    :param compute
+00003350: 645f 7661 6c75 6573 3a20 4465 6669 6e65  d_values: Define
+00003360: 2065 7870 7265 7373 696f 6e73 206f 6e20   expressions on 
+00003370: 7468 6520 636f 6c6c 6563 7469 6f6e 206c  the collection l
+00003380: 6576 656c 2074 6861 740a 2020 2020 2020  evel that.      
+00003390: 2020 2020 2020 7275 6e20 6f6e 2069 6e73        run on ins
+000033a0: 6572 7473 2c20 6d6f 6469 6669 6361 7469  erts, modificati
+000033b0: 6f6e 732c 206f 7220 626f 7468 2e0a 2020  ons, or both..  
+000033c0: 2020 2020 2020 3a74 7970 6520 636f 6d70        :type comp
+000033d0: 7574 6564 5f76 616c 7565 733a 2064 6963  uted_values: dic
+000033e0: 7420 7c20 4e6f 6e65 0a20 2020 2020 2020  t | None.       
+000033f0: 203a 7274 7970 653a 2064 6963 740a 2020   :rtype: dict.  
+00003400: 2020 2020 2020 3a72 6169 7365 2061 7261        :raise ara
+00003410: 6e67 6f2e 6578 6365 7074 696f 6e73 2e43  ngo.exceptions.C
+00003420: 6f6c 6c65 6374 696f 6e43 6f6e 6669 6775  ollectionConfigu
+00003430: 7265 4572 726f 723a 2049 6620 6f70 6572  reError: If oper
+00003440: 6174 696f 6e20 6661 696c 732e 0a20 2020  ation fails..   
+00003450: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00003460: 2064 6174 613a 204a 736f 6e20 3d20 7b7d   data: Json = {}
+00003470: 0a20 2020 2020 2020 2069 6620 7379 6e63  .        if sync
+00003480: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00003490: 2020 2020 2020 2020 2020 6461 7461 5b22            data["
+000034a0: 7761 6974 466f 7253 796e 6322 5d20 3d20  waitForSync"] = 
+000034b0: 7379 6e63 0a20 2020 2020 2020 2069 6620  sync.        if 
+000034c0: 7363 6865 6d61 2069 7320 6e6f 7420 4e6f  schema is not No
+000034d0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+000034e0: 6461 7461 5b22 7363 6865 6d61 225d 203d  data["schema"] =
+000034f0: 2073 6368 656d 610a 2020 2020 2020 2020   schema.        
+00003500: 6966 2072 6570 6c69 6361 7469 6f6e 5f66  if replication_f
+00003510: 6163 746f 7220 6973 206e 6f74 204e 6f6e  actor is not Non
+00003520: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
+00003530: 6174 615b 2272 6570 6c69 6361 7469 6f6e  ata["replication
+00003540: 4661 6374 6f72 225d 203d 2072 6570 6c69  Factor"] = repli
+00003550: 6361 7469 6f6e 5f66 6163 746f 720a 2020  cation_factor.  
+00003560: 2020 2020 2020 6966 2077 7269 7465 5f63        if write_c
+00003570: 6f6e 6365 726e 2069 7320 6e6f 7420 4e6f  oncern is not No
+00003580: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00003590: 6461 7461 5b22 7772 6974 6543 6f6e 6365  data["writeConce
+000035a0: 726e 225d 203d 2077 7269 7465 5f63 6f6e  rn"] = write_con
+000035b0: 6365 726e 0a20 2020 2020 2020 2069 6620  cern.        if 
+000035c0: 636f 6d70 7574 6564 5f76 616c 7565 7320  computed_values 
+000035d0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+000035e0: 2020 2020 2020 2020 2064 6174 615b 2263           data["c
+000035f0: 6f6d 7075 7465 6456 616c 7565 7322 5d20  omputedValues"] 
+00003600: 3d20 636f 6d70 7574 6564 5f76 616c 7565  = computed_value
+00003610: 730a 0a20 2020 2020 2020 2072 6571 7565  s..        reque
+00003620: 7374 203d 2052 6571 7565 7374 280a 2020  st = Request(.  
+00003630: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+00003640: 3d22 7075 7422 2c0a 2020 2020 2020 2020  ="put",.        
+00003650: 2020 2020 656e 6470 6f69 6e74 3d66 222f      endpoint=f"/
+00003660: 5f61 7069 2f63 6f6c 6c65 6374 696f 6e2f  _api/collection/
+00003670: 7b73 656c 662e 6e61 6d65 7d2f 7072 6f70  {self.name}/prop
+00003680: 6572 7469 6573 222c 0a20 2020 2020 2020  erties",.       
+00003690: 2020 2020 2064 6174 613d 6461 7461 2c0a       data=data,.
+000036a0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+000036b0: 2020 2064 6566 2072 6573 706f 6e73 655f     def response_
+000036c0: 6861 6e64 6c65 7228 7265 7370 3a20 5265  handler(resp: Re
+000036d0: 7370 6f6e 7365 2920 2d3e 204a 736f 6e3a  sponse) -> Json:
+000036e0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000036f0: 6e6f 7420 7265 7370 2e69 735f 7375 6363  not resp.is_succ
+00003700: 6573 733a 0a20 2020 2020 2020 2020 2020  ess:.           
+00003710: 2020 2020 2072 6169 7365 2043 6f6c 6c65       raise Colle
+00003720: 6374 696f 6e43 6f6e 6669 6775 7265 4572  ctionConfigureEr
+00003730: 726f 7228 7265 7370 2c20 7265 7175 6573  ror(resp, reques
+00003740: 7429 0a20 2020 2020 2020 2020 2020 2072  t).            r
+00003750: 6574 7572 6e20 666f 726d 6174 5f63 6f6c  eturn format_col
+00003760: 6c65 6374 696f 6e28 7265 7370 2e62 6f64  lection(resp.bod
+00003770: 7929 0a0a 2020 2020 2020 2020 7265 7475  y)..        retu
+00003780: 726e 2073 656c 662e 5f65 7865 6375 7465  rn self._execute
+00003790: 2872 6571 7565 7374 2c20 7265 7370 6f6e  (request, respon
+000037a0: 7365 5f68 616e 646c 6572 290a 0a20 2020  se_handler)..   
+000037b0: 2064 6566 2073 7461 7469 7374 6963 7328   def statistics(
+000037c0: 7365 6c66 2920 2d3e 2052 6573 756c 745b  self) -> Result[
+000037d0: 4a73 6f6e 5d3a 0a20 2020 2020 2020 2022  Json]:.        "
+000037e0: 2222 5265 7475 726e 2063 6f6c 6c65 6374  ""Return collect
+000037f0: 696f 6e20 7374 6174 6973 7469 6373 2e0a  ion statistics..
+00003800: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00003810: 3a20 436f 6c6c 6563 7469 6f6e 2073 7461  : Collection sta
+00003820: 7469 7374 6963 732e 0a20 2020 2020 2020  tistics..       
+00003830: 203a 7274 7970 653a 2064 6963 740a 2020   :rtype: dict.  
+00003840: 2020 2020 2020 3a72 6169 7365 2061 7261        :raise ara
+00003850: 6e67 6f2e 6578 6365 7074 696f 6e73 2e43  ngo.exceptions.C
+00003860: 6f6c 6c65 6374 696f 6e53 7461 7469 7374  ollectionStatist
+00003870: 6963 7345 7272 6f72 3a20 4966 2072 6574  icsError: If ret
+00003880: 7269 6576 616c 2066 6169 6c73 2e0a 2020  rieval fails..  
+00003890: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000038a0: 2020 7265 7175 6573 7420 3d20 5265 7175    request = Requ
+000038b0: 6573 7428 0a20 2020 2020 2020 2020 2020  est(.           
+000038c0: 206d 6574 686f 643d 2267 6574 222c 0a20   method="get",. 
+000038d0: 2020 2020 2020 2020 2020 2065 6e64 706f             endpo
+000038e0: 696e 743d 6622 2f5f 6170 692f 636f 6c6c  int=f"/_api/coll
+000038f0: 6563 7469 6f6e 2f7b 7365 6c66 2e6e 616d  ection/{self.nam
+00003900: 657d 2f66 6967 7572 6573 222c 0a20 2020  e}/figures",.   
+00003910: 2020 2020 2020 2020 2072 6561 643d 7365           read=se
+00003920: 6c66 2e6e 616d 652c 0a20 2020 2020 2020  lf.name,.       
+00003930: 2029 0a0a 2020 2020 2020 2020 6465 6620   )..        def 
+00003940: 7265 7370 6f6e 7365 5f68 616e 646c 6572  response_handler
+00003950: 2872 6573 703a 2052 6573 706f 6e73 6529  (resp: Response)
+00003960: 202d 3e20 4a73 6f6e 3a0a 2020 2020 2020   -> Json:.      
+00003970: 2020 2020 2020 6966 206e 6f74 2072 6573        if not res
+00003980: 702e 6973 5f73 7563 6365 7373 3a0a 2020  p.is_success:.  
+00003990: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+000039a0: 6973 6520 436f 6c6c 6563 7469 6f6e 5374  ise CollectionSt
+000039b0: 6174 6973 7469 6373 4572 726f 7228 7265  atisticsError(re
+000039c0: 7370 2c20 7265 7175 6573 7429 0a0a 2020  sp, request)..  
+000039d0: 2020 2020 2020 2020 2020 7374 6174 733a            stats:
+000039e0: 204a 736f 6e20 3d20 7265 7370 2e62 6f64   Json = resp.bod
+000039f0: 792e 6765 7428 2266 6967 7572 6573 222c  y.get("figures",
+00003a00: 2072 6573 702e 626f 6479 290a 2020 2020   resp.body).    
+00003a10: 2020 2020 2020 2020 6966 2022 646f 6375          if "docu
+00003a20: 6d65 6e74 5265 6665 7265 6e63 6573 2220  mentReferences" 
+00003a30: 696e 2073 7461 7473 3a20 2023 2070 7261  in stats:  # pra
+00003a40: 676d 613a 206e 6f20 636f 7665 720a 2020  gma: no cover.  
+00003a50: 2020 2020 2020 2020 2020 2020 2020 7374                st
+00003a60: 6174 735b 2264 6f63 756d 656e 745f 7265  ats["document_re
+00003a70: 6673 225d 203d 2073 7461 7473 2e70 6f70  fs"] = stats.pop
+00003a80: 2822 646f 6375 6d65 6e74 5265 6665 7265  ("documentRefere
+00003a90: 6e63 6573 2229 0a20 2020 2020 2020 2020  nces").         
+00003aa0: 2020 2069 6620 226c 6173 7454 6963 6b22     if "lastTick"
+00003ab0: 2069 6e20 7374 6174 733a 2020 2320 7072   in stats:  # pr
+00003ac0: 6167 6d61 3a20 6e6f 2063 6f76 6572 0a20  agma: no cover. 
+00003ad0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00003ae0: 7461 7473 5b22 6c61 7374 5f74 6963 6b22  tats["last_tick"
+00003af0: 5d20 3d20 7374 6174 732e 706f 7028 226c  ] = stats.pop("l
+00003b00: 6173 7454 6963 6b22 290a 2020 2020 2020  astTick").      
+00003b10: 2020 2020 2020 6966 2022 7761 6974 696e        if "waitin
+00003b20: 6746 6f72 2220 696e 2073 7461 7473 3a20  gFor" in stats: 
+00003b30: 2023 2070 7261 676d 613a 206e 6f20 636f   # pragma: no co
+00003b40: 7665 720a 2020 2020 2020 2020 2020 2020  ver.            
+00003b50: 2020 2020 7374 6174 735b 2277 6169 7469      stats["waiti
+00003b60: 6e67 5f66 6f72 225d 203d 2073 7461 7473  ng_for"] = stats
+00003b70: 2e70 6f70 2822 7761 6974 696e 6746 6f72  .pop("waitingFor
+00003b80: 2229 0a20 2020 2020 2020 2020 2020 2069  ").            i
+00003b90: 6620 2264 6f63 756d 656e 7473 5369 7a65  f "documentsSize
+00003ba0: 2220 696e 2073 7461 7473 3a20 2023 2070  " in stats:  # p
+00003bb0: 7261 676d 613a 206e 6f20 636f 7665 720a  ragma: no cover.
+00003bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003bd0: 7374 6174 735b 2264 6f63 756d 656e 7473  stats["documents
+00003be0: 5f73 697a 6522 5d20 3d20 7374 6174 732e  _size"] = stats.
+00003bf0: 706f 7028 2264 6f63 756d 656e 7473 5369  pop("documentsSi
+00003c00: 7a65 2229 0a20 2020 2020 2020 2020 2020  ze").           
+00003c10: 2069 6620 2263 6163 6865 496e 5573 6522   if "cacheInUse"
+00003c20: 2069 6e20 7374 6174 733a 2020 2320 7072   in stats:  # pr
+00003c30: 6167 6d61 3a20 6e6f 2063 6f76 6572 0a20  agma: no cover. 
+00003c40: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00003c50: 7461 7473 5b22 6361 6368 655f 696e 5f75  tats["cache_in_u
+00003c60: 7365 225d 203d 2073 7461 7473 2e70 6f70  se"] = stats.pop
+00003c70: 2822 6361 6368 6549 6e55 7365 2229 0a20  ("cacheInUse"). 
+00003c80: 2020 2020 2020 2020 2020 2069 6620 2263             if "c
+00003c90: 6163 6865 5369 7a65 2220 696e 2073 7461  acheSize" in sta
+00003ca0: 7473 3a20 2023 2070 7261 676d 613a 206e  ts:  # pragma: n
+00003cb0: 6f20 636f 7665 720a 2020 2020 2020 2020  o cover.        
+00003cc0: 2020 2020 2020 2020 7374 6174 735b 2263          stats["c
+00003cd0: 6163 6865 5f73 697a 6522 5d20 3d20 7374  ache_size"] = st
+00003ce0: 6174 732e 706f 7028 2263 6163 6865 5369  ats.pop("cacheSi
+00003cf0: 7a65 2229 0a20 2020 2020 2020 2020 2020  ze").           
+00003d00: 2069 6620 2263 6163 6865 5573 6167 6522   if "cacheUsage"
+00003d10: 2069 6e20 7374 6174 733a 2020 2320 7072   in stats:  # pr
+00003d20: 6167 6d61 3a20 6e6f 2063 6f76 6572 0a20  agma: no cover. 
+00003d30: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00003d40: 7461 7473 5b22 6361 6368 655f 7573 6167  tats["cache_usag
+00003d50: 6522 5d20 3d20 7374 6174 732e 706f 7028  e"] = stats.pop(
+00003d60: 2263 6163 6865 5573 6167 6522 290a 2020  "cacheUsage").  
+00003d70: 2020 2020 2020 2020 2020 6966 2022 756e            if "un
+00003d80: 636f 6c6c 6563 7465 644c 6f67 6669 6c65  collectedLogfile
+00003d90: 456e 7472 6965 7322 2069 6e20 7374 6174  Entries" in stat
+00003da0: 733a 2020 2320 7072 6167 6d61 3a20 6e6f  s:  # pragma: no
+00003db0: 2063 6f76 6572 0a20 2020 2020 2020 2020   cover.         
+00003dc0: 2020 2020 2020 2073 7461 7473 5b22 756e         stats["un
+00003dd0: 636f 6c6c 6563 7465 645f 6c6f 6766 696c  collected_logfil
+00003de0: 655f 656e 7472 6965 7322 5d20 3d20 7374  e_entries"] = st
+00003df0: 6174 732e 706f 7028 0a20 2020 2020 2020  ats.pop(.       
+00003e00: 2020 2020 2020 2020 2020 2020 2022 756e               "un
+00003e10: 636f 6c6c 6563 7465 644c 6f67 6669 6c65  collectedLogfile
+00003e20: 456e 7472 6965 7322 0a20 2020 2020 2020  Entries".       
+00003e30: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00003e40: 2020 2020 2020 2072 6574 7572 6e20 7374         return st
+00003e50: 6174 730a 0a20 2020 2020 2020 2072 6574  ats..        ret
+00003e60: 7572 6e20 7365 6c66 2e5f 6578 6563 7574  urn self._execut
+00003e70: 6528 7265 7175 6573 742c 2072 6573 706f  e(request, respo
+00003e80: 6e73 655f 6861 6e64 6c65 7229 0a0a 2020  nse_handler)..  
+00003e90: 2020 6465 6620 7265 7669 7369 6f6e 2873    def revision(s
+00003ea0: 656c 6629 202d 3e20 5265 7375 6c74 5b73  elf) -> Result[s
+00003eb0: 7472 5d3a 0a20 2020 2020 2020 2022 2222  tr]:.        """
+00003ec0: 5265 7475 726e 2063 6f6c 6c65 6374 696f  Return collectio
+00003ed0: 6e20 7265 7669 7369 6f6e 2e0a 0a20 2020  n revision...   
+00003ee0: 2020 2020 203a 7265 7475 726e 3a20 436f       :return: Co
+00003ef0: 6c6c 6563 7469 6f6e 2072 6576 6973 696f  llection revisio
+00003f00: 6e2e 0a20 2020 2020 2020 203a 7274 7970  n..        :rtyp
+00003f10: 653a 2073 7472 0a20 2020 2020 2020 203a  e: str.        :
+00003f20: 7261 6973 6520 6172 616e 676f 2e65 7863  raise arango.exc
+00003f30: 6570 7469 6f6e 732e 436f 6c6c 6563 7469  eptions.Collecti
+00003f40: 6f6e 5265 7669 7369 6f6e 4572 726f 723a  onRevisionError:
+00003f50: 2049 6620 7265 7472 6965 7661 6c20 6661   If retrieval fa
+00003f60: 696c 732e 0a20 2020 2020 2020 2022 2222  ils..        """
+00003f70: 0a20 2020 2020 2020 2072 6571 7565 7374  .        request
+00003f80: 203d 2052 6571 7565 7374 280a 2020 2020   = Request(.    
+00003f90: 2020 2020 2020 2020 6d65 7468 6f64 3d22          method="
+00003fa0: 6765 7422 2c0a 2020 2020 2020 2020 2020  get",.          
+00003fb0: 2020 656e 6470 6f69 6e74 3d66 222f 5f61    endpoint=f"/_a
+00003fc0: 7069 2f63 6f6c 6c65 6374 696f 6e2f 7b73  pi/collection/{s
+00003fd0: 656c 662e 6e61 6d65 7d2f 7265 7669 7369  elf.name}/revisi
+00003fe0: 6f6e 222c 0a20 2020 2020 2020 2020 2020  on",.           
+00003ff0: 2072 6561 643d 7365 6c66 2e6e 616d 652c   read=self.name,
+00004000: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00004010: 2020 2020 6465 6620 7265 7370 6f6e 7365      def response
+00004020: 5f68 616e 646c 6572 2872 6573 703a 2052  _handler(resp: R
+00004030: 6573 706f 6e73 6529 202d 3e20 7374 723a  esponse) -> str:
+00004040: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00004050: 7265 7370 2e69 735f 7375 6363 6573 733a  resp.is_success:
+00004060: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004070: 2072 6574 7572 6e20 7374 7228 7265 7370   return str(resp
+00004080: 2e62 6f64 795b 2272 6576 6973 696f 6e22  .body["revision"
+00004090: 5d29 0a20 2020 2020 2020 2020 2020 2072  ]).            r
+000040a0: 6169 7365 2043 6f6c 6c65 6374 696f 6e52  aise CollectionR
+000040b0: 6576 6973 696f 6e45 7272 6f72 2872 6573  evisionError(res
+000040c0: 702c 2072 6571 7565 7374 290a 0a20 2020  p, request)..   
+000040d0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000040e0: 2e5f 6578 6563 7574 6528 7265 7175 6573  ._execute(reques
+000040f0: 742c 2072 6573 706f 6e73 655f 6861 6e64  t, response_hand
+00004100: 6c65 7229 0a0a 2020 2020 6465 6620 6368  ler)..    def ch
+00004110: 6563 6b73 756d 2873 656c 662c 2077 6974  ecksum(self, wit
+00004120: 685f 7265 763a 2062 6f6f 6c20 3d20 4661  h_rev: bool = Fa
+00004130: 6c73 652c 2077 6974 685f 6461 7461 3a20  lse, with_data: 
+00004140: 626f 6f6c 203d 2046 616c 7365 2920 2d3e  bool = False) ->
+00004150: 2052 6573 756c 745b 7374 725d 3a0a 2020   Result[str]:.  
+00004160: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
+00004170: 636f 6c6c 6563 7469 6f6e 2063 6865 636b  collection check
+00004180: 7375 6d2e 0a0a 2020 2020 2020 2020 3a70  sum...        :p
+00004190: 6172 616d 2077 6974 685f 7265 763a 2049  aram with_rev: I
+000041a0: 6e63 6c75 6465 2064 6f63 756d 656e 7420  nclude document 
+000041b0: 7265 7669 7369 6f6e 7320 696e 2063 6865  revisions in che
+000041c0: 636b 7375 6d20 6361 6c63 756c 6174 696f  cksum calculatio
+000041d0: 6e2e 0a20 2020 2020 2020 203a 7479 7065  n..        :type
+000041e0: 2077 6974 685f 7265 763a 2062 6f6f 6c0a   with_rev: bool.
+000041f0: 2020 2020 2020 2020 3a70 6172 616d 2077          :param w
+00004200: 6974 685f 6461 7461 3a20 496e 636c 7564  ith_data: Includ
+00004210: 6520 646f 6375 6d65 6e74 2064 6174 6120  e document data 
+00004220: 696e 2063 6865 636b 7375 6d20 6361 6c63  in checksum calc
+00004230: 756c 6174 696f 6e2e 0a20 2020 2020 2020  ulation..       
+00004240: 203a 7479 7065 2077 6974 685f 6461 7461   :type with_data
+00004250: 3a20 626f 6f6c 0a20 2020 2020 2020 203a  : bool.        :
+00004260: 7265 7475 726e 3a20 436f 6c6c 6563 7469  return: Collecti
+00004270: 6f6e 2063 6865 636b 7375 6d2e 0a20 2020  on checksum..   
+00004280: 2020 2020 203a 7274 7970 653a 2073 7472       :rtype: str
+00004290: 0a20 2020 2020 2020 203a 7261 6973 6520  .        :raise 
+000042a0: 6172 616e 676f 2e65 7863 6570 7469 6f6e  arango.exception
+000042b0: 732e 436f 6c6c 6563 7469 6f6e 4368 6563  s.CollectionChec
+000042c0: 6b73 756d 4572 726f 723a 2049 6620 7265  ksumError: If re
+000042d0: 7472 6965 7661 6c20 6661 696c 732e 0a20  trieval fails.. 
+000042e0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000042f0: 2020 2072 6571 7565 7374 203d 2052 6571     request = Req
+00004300: 7565 7374 280a 2020 2020 2020 2020 2020  uest(.          
+00004310: 2020 6d65 7468 6f64 3d22 6765 7422 2c0a    method="get",.
+00004320: 2020 2020 2020 2020 2020 2020 656e 6470              endp
+00004330: 6f69 6e74 3d66 222f 5f61 7069 2f63 6f6c  oint=f"/_api/col
+00004340: 6c65 6374 696f 6e2f 7b73 656c 662e 6e61  lection/{self.na
+00004350: 6d65 7d2f 6368 6563 6b73 756d 222c 0a20  me}/checksum",. 
+00004360: 2020 2020 2020 2020 2020 2070 6172 616d             param
+00004370: 733d 7b22 7769 7468 5265 7669 7369 6f6e  s={"withRevision
+00004380: 223a 2077 6974 685f 7265 762c 2022 7769  ": with_rev, "wi
+00004390: 7468 4461 7461 223a 2077 6974 685f 6461  thData": with_da
+000043a0: 7461 7d2c 0a20 2020 2020 2020 2029 0a0a  ta},.        )..
+000043b0: 2020 2020 2020 2020 6465 6620 7265 7370          def resp
+000043c0: 6f6e 7365 5f68 616e 646c 6572 2872 6573  onse_handler(res
+000043d0: 703a 2052 6573 706f 6e73 6529 202d 3e20  p: Response) -> 
+000043e0: 7374 723a 0a20 2020 2020 2020 2020 2020  str:.           
+000043f0: 2069 6620 7265 7370 2e69 735f 7375 6363   if resp.is_succ
+00004400: 6573 733a 0a20 2020 2020 2020 2020 2020  ess:.           
+00004410: 2020 2020 2072 6574 7572 6e20 7374 7228       return str(
+00004420: 7265 7370 2e62 6f64 795b 2263 6865 636b  resp.body["check
+00004430: 7375 6d22 5d29 0a20 2020 2020 2020 2020  sum"]).         
+00004440: 2020 2072 6169 7365 2043 6f6c 6c65 6374     raise Collect
+00004450: 696f 6e43 6865 636b 7375 6d45 7272 6f72  ionChecksumError
+00004460: 2872 6573 702c 2072 6571 7565 7374 290a  (resp, request).
+00004470: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00004480: 7365 6c66 2e5f 6578 6563 7574 6528 7265  self._execute(re
+00004490: 7175 6573 742c 2072 6573 706f 6e73 655f  quest, response_
+000044a0: 6861 6e64 6c65 7229 0a0a 2020 2020 6465  handler)..    de
+000044b0: 6620 636f 6d70 6163 7428 7365 6c66 2920  f compact(self) 
+000044c0: 2d3e 2052 6573 756c 745b 4a73 6f6e 5d3a  -> Result[Json]:
+000044d0: 0a20 2020 2020 2020 2022 2222 436f 6d70  .        """Comp
+000044e0: 6163 7420 6120 636f 6c6c 6563 7469 6f6e  act a collection
+000044f0: 2e0a 0a20 2020 2020 2020 2043 6f6d 7061  ...        Compa
+00004500: 6374 7320 7468 6520 6461 7461 206f 6620  cts the data of 
+00004510: 6120 636f 6c6c 6563 7469 6f6e 2069 6e20  a collection in 
+00004520: 6f72 6465 7220 746f 2072 6563 6c61 696d  order to reclaim
+00004530: 2064 6973 6b20 7370 6163 652e 0a20 2020   disk space..   
+00004540: 2020 2020 2054 6865 206f 7065 7261 7469       The operati
+00004550: 6f6e 2077 696c 6c20 636f 6d70 6163 7420  on will compact 
+00004560: 7468 6520 646f 6375 6d65 6e74 2061 6e64  the document and
+00004570: 2069 6e64 6578 2064 6174 6120 6279 2072   index data by r
+00004580: 6577 7269 7469 6e67 2074 6865 0a20 2020  ewriting the.   
+00004590: 2020 2020 2075 6e64 6572 6c79 696e 6720       underlying 
+000045a0: 2e73 7374 2066 696c 6573 2061 6e64 206f  .sst files and o
+000045b0: 6e6c 7920 6b65 6570 696e 6720 7468 6520  nly keeping the 
+000045c0: 7265 6c65 7661 6e74 2065 6e74 7269 6573  relevant entries
+000045d0: 2e0a 0a20 2020 2020 2020 2055 6e64 6572  ...        Under
+000045e0: 206e 6f72 6d61 6c20 6369 7263 756d 7374   normal circumst
+000045f0: 616e 6365 732c 2072 756e 6e69 6e67 2061  ances, running a
+00004600: 2063 6f6d 7061 6374 206f 7065 7261 7469   compact operati
+00004610: 6f6e 2069 7320 6e6f 7420 6e65 6365 7373  on is not necess
+00004620: 6172 792c 2061 730a 2020 2020 2020 2020  ary, as.        
+00004630: 7468 6520 636f 6c6c 6563 7469 6f6e 2064  the collection d
+00004640: 6174 6120 7769 6c6c 2065 7665 6e74 7561  ata will eventua
+00004650: 6c6c 7920 6765 7420 636f 6d70 6163 7465  lly get compacte
+00004660: 6420 616e 7977 6179 2e20 486f 7765 7665  d anyway. Howeve
+00004670: 722c 2069 6e20 736f 6d65 0a20 2020 2020  r, in some.     
+00004680: 2020 2073 6974 7561 7469 6f6e 732c 2065     situations, e
+00004690: 2e67 2e20 6166 7465 7220 7275 6e6e 696e  .g. after runnin
+000046a0: 6720 6c6f 7473 206f 6620 7570 6461 7465  g lots of update
+000046b0: 2f72 6570 6c61 6365 206f 7220 7265 6d6f  /replace or remo
+000046c0: 7665 206f 7065 7261 7469 6f6e 732c 0a20  ve operations,. 
+000046d0: 2020 2020 2020 2074 6865 2064 6973 6b20         the disk 
+000046e0: 6461 7461 2066 6f72 2061 2063 6f6c 6c65  data for a colle
+000046f0: 6374 696f 6e20 6d61 7920 636f 6e74 6169  ction may contai
+00004700: 6e20 6120 6c6f 7420 6f66 206f 7574 6461  n a lot of outda
+00004710: 7465 6420 6461 7461 2066 6f72 2077 6869  ted data for whi
+00004720: 6368 2074 6865 0a20 2020 2020 2020 2073  ch the.        s
+00004730: 7061 6365 2073 6861 6c6c 2062 6520 7265  pace shall be re
+00004740: 636c 6169 6d65 642e 2049 6e20 7468 6973  claimed. In this
+00004750: 2063 6173 6520 7468 6520 636f 6d70 6163   case the compac
+00004760: 7469 6f6e 206f 7065 7261 7469 6f6e 2063  tion operation c
+00004770: 616e 2062 6520 7573 6564 2e0a 0a20 2020  an be used...   
+00004780: 2020 2020 203a 7265 7475 726e 3a20 436f       :return: Co
+00004790: 6c6c 6563 7469 6f6e 2063 6f6d 7061 6374  llection compact
+000047a0: 2e0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
+000047b0: 3a20 6469 6374 0a20 2020 2020 2020 203a  : dict.        :
+000047c0: 7261 6973 6520 6172 616e 676f 2e65 7863  raise arango.exc
+000047d0: 6570 7469 6f6e 732e 436f 6c6c 6563 7469  eptions.Collecti
+000047e0: 6f6e 436f 6d70 6163 7445 7272 6f72 3a20  onCompactError: 
+000047f0: 4966 2072 6574 7269 6576 616c 2066 6169  If retrieval fai
+00004800: 6c73 2e0a 2020 2020 2020 2020 2222 220a  ls..        """.
+00004810: 2020 2020 2020 2020 7265 7175 6573 7420          request 
+00004820: 3d20 5265 7175 6573 7428 0a20 2020 2020  = Request(.     
+00004830: 2020 2020 2020 206d 6574 686f 643d 2270         method="p
+00004840: 7574 222c 0a20 2020 2020 2020 2020 2020  ut",.           
+00004850: 2065 6e64 706f 696e 743d 6622 2f5f 6170   endpoint=f"/_ap
+00004860: 692f 636f 6c6c 6563 7469 6f6e 2f7b 7365  i/collection/{se
+00004870: 6c66 2e6e 616d 657d 2f63 6f6d 7061 6374  lf.name}/compact
+00004880: 222c 0a20 2020 2020 2020 2029 0a0a 2020  ",.        )..  
+00004890: 2020 2020 2020 6465 6620 7265 7370 6f6e        def respon
+000048a0: 7365 5f68 616e 646c 6572 2872 6573 703a  se_handler(resp:
+000048b0: 2052 6573 706f 6e73 6529 202d 3e20 4a73   Response) -> Js
+000048c0: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
+000048d0: 6966 2072 6573 702e 6973 5f73 7563 6365  if resp.is_succe
+000048e0: 7373 3a0a 2020 2020 2020 2020 2020 2020  ss:.            
+000048f0: 2020 2020 7265 7475 726e 2066 6f72 6d61      return forma
+00004900: 745f 636f 6c6c 6563 7469 6f6e 2872 6573  t_collection(res
+00004910: 702e 626f 6479 290a 2020 2020 2020 2020  p.body).        
+00004920: 2020 2020 7261 6973 6520 436f 6c6c 6563      raise Collec
+00004930: 7469 6f6e 436f 6d70 6163 7445 7272 6f72  tionCompactError
+00004940: 2872 6573 702c 2072 6571 7565 7374 290a  (resp, request).
+00004950: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00004960: 7365 6c66 2e5f 6578 6563 7574 6528 7265  self._execute(re
+00004970: 7175 6573 742c 2072 6573 706f 6e73 655f  quest, response_
+00004980: 6861 6e64 6c65 7229 0a0a 2020 2020 6465  handler)..    de
+00004990: 6620 6c6f 6164 2873 656c 6629 202d 3e20  f load(self) -> 
+000049a0: 5265 7375 6c74 5b62 6f6f 6c5d 3a0a 2020  Result[bool]:.  
+000049b0: 2020 2020 2020 2222 224c 6f61 6420 7468        """Load th
+000049c0: 6520 636f 6c6c 6563 7469 6f6e 2069 6e74  e collection int
+000049d0: 6f20 6d65 6d6f 7279 2e0a 0a20 2020 2020  o memory...     
+000049e0: 2020 203a 7265 7475 726e 3a20 5472 7565     :return: True
+000049f0: 2069 6620 636f 6c6c 6563 7469 6f6e 2077   if collection w
+00004a00: 6173 206c 6f61 6465 6420 7375 6363 6573  as loaded succes
+00004a10: 7366 756c 6c79 2e0a 2020 2020 2020 2020  sfully..        
+00004a20: 3a72 7479 7065 3a20 626f 6f6c 0a20 2020  :rtype: bool.   
+00004a30: 2020 2020 203a 7261 6973 6520 6172 616e       :raise aran
+00004a40: 676f 2e65 7863 6570 7469 6f6e 732e 436f  go.exceptions.Co
+00004a50: 6c6c 6563 7469 6f6e 4c6f 6164 4572 726f  llectionLoadErro
+00004a60: 723a 2049 6620 6f70 6572 6174 696f 6e20  r: If operation 
+00004a70: 6661 696c 732e 0a20 2020 2020 2020 2022  fails..        "
+00004a80: 2222 0a20 2020 2020 2020 2072 6571 7565  "".        reque
+00004a90: 7374 203d 2052 6571 7565 7374 286d 6574  st = Request(met
+00004aa0: 686f 643d 2270 7574 222c 2065 6e64 706f  hod="put", endpo
+00004ab0: 696e 743d 6622 2f5f 6170 692f 636f 6c6c  int=f"/_api/coll
+00004ac0: 6563 7469 6f6e 2f7b 7365 6c66 2e6e 616d  ection/{self.nam
+00004ad0: 657d 2f6c 6f61 6422 290a 0a20 2020 2020  e}/load")..     
+00004ae0: 2020 2064 6566 2072 6573 706f 6e73 655f     def response_
+00004af0: 6861 6e64 6c65 7228 7265 7370 3a20 5265  handler(resp: Re
+00004b00: 7370 6f6e 7365 2920 2d3e 2062 6f6f 6c3a  sponse) -> bool:
+00004b10: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00004b20: 6e6f 7420 7265 7370 2e69 735f 7375 6363  not resp.is_succ
+00004b30: 6573 733a 0a20 2020 2020 2020 2020 2020  ess:.           
+00004b40: 2020 2020 2072 6169 7365 2043 6f6c 6c65       raise Colle
+00004b50: 6374 696f 6e4c 6f61 6445 7272 6f72 2872  ctionLoadError(r
+00004b60: 6573 702c 2072 6571 7565 7374 290a 2020  esp, request).  
+00004b70: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00004b80: 2054 7275 650a 0a20 2020 2020 2020 2072   True..        r
+00004b90: 6574 7572 6e20 7365 6c66 2e5f 6578 6563  eturn self._exec
+00004ba0: 7574 6528 7265 7175 6573 742c 2072 6573  ute(request, res
+00004bb0: 706f 6e73 655f 6861 6e64 6c65 7229 0a0a  ponse_handler)..
+00004bc0: 2020 2020 6465 6620 756e 6c6f 6164 2873      def unload(s
+00004bd0: 656c 6629 202d 3e20 5265 7375 6c74 5b62  elf) -> Result[b
+00004be0: 6f6f 6c5d 3a0a 2020 2020 2020 2020 2222  ool]:.        ""
+00004bf0: 2255 6e6c 6f61 6420 7468 6520 636f 6c6c  "Unload the coll
+00004c00: 6563 7469 6f6e 2066 726f 6d20 6d65 6d6f  ection from memo
+00004c10: 7279 2e0a 0a20 2020 2020 2020 203a 7265  ry...        :re
+00004c20: 7475 726e 3a20 5472 7565 2069 6620 636f  turn: True if co
+00004c30: 6c6c 6563 7469 6f6e 2077 6173 2075 6e6c  llection was unl
+00004c40: 6f61 6465 6420 7375 6363 6573 7366 756c  oaded successful
+00004c50: 6c79 2e0a 2020 2020 2020 2020 3a72 7479  ly..        :rty
+00004c60: 7065 3a20 626f 6f6c 0a20 2020 2020 2020  pe: bool.       
+00004c70: 203a 7261 6973 6520 6172 616e 676f 2e65   :raise arango.e
+00004c80: 7863 6570 7469 6f6e 732e 436f 6c6c 6563  xceptions.Collec
+00004c90: 7469 6f6e 556e 6c6f 6164 4572 726f 723a  tionUnloadError:
+00004ca0: 2049 6620 6f70 6572 6174 696f 6e20 6661   If operation fa
+00004cb0: 696c 732e 0a20 2020 2020 2020 2022 2222  ils..        """
+00004cc0: 0a20 2020 2020 2020 2072 6571 7565 7374  .        request
+00004cd0: 203d 2052 6571 7565 7374 286d 6574 686f   = Request(metho
+00004ce0: 643d 2270 7574 222c 2065 6e64 706f 696e  d="put", endpoin
+00004cf0: 743d 6622 2f5f 6170 692f 636f 6c6c 6563  t=f"/_api/collec
+00004d00: 7469 6f6e 2f7b 7365 6c66 2e6e 616d 657d  tion/{self.name}
+00004d10: 2f75 6e6c 6f61 6422 290a 0a20 2020 2020  /unload")..     
+00004d20: 2020 2064 6566 2072 6573 706f 6e73 655f     def response_
+00004d30: 6861 6e64 6c65 7228 7265 7370 3a20 5265  handler(resp: Re
+00004d40: 7370 6f6e 7365 2920 2d3e 2062 6f6f 6c3a  sponse) -> bool:
+00004d50: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00004d60: 6e6f 7420 7265 7370 2e69 735f 7375 6363  not resp.is_succ
+00004d70: 6573 733a 0a20 2020 2020 2020 2020 2020  ess:.           
+00004d80: 2020 2020 2072 6169 7365 2043 6f6c 6c65       raise Colle
+00004d90: 6374 696f 6e55 6e6c 6f61 6445 7272 6f72  ctionUnloadError
+00004da0: 2872 6573 702c 2072 6571 7565 7374 290a  (resp, request).
+00004db0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00004dc0: 726e 2054 7275 650a 0a20 2020 2020 2020  rn True..       
+00004dd0: 2072 6574 7572 6e20 7365 6c66 2e5f 6578   return self._ex
+00004de0: 6563 7574 6528 7265 7175 6573 742c 2072  ecute(request, r
+00004df0: 6573 706f 6e73 655f 6861 6e64 6c65 7229  esponse_handler)
+00004e00: 0a0a 2020 2020 6465 6620 7472 756e 6361  ..    def trunca
+00004e10: 7465 2873 656c 6629 202d 3e20 5265 7375  te(self) -> Resu
+00004e20: 6c74 5b62 6f6f 6c5d 3a0a 2020 2020 2020  lt[bool]:.      
+00004e30: 2020 2222 2244 656c 6574 6520 616c 6c20    """Delete all 
+00004e40: 646f 6375 6d65 6e74 7320 696e 2074 6865  documents in the
+00004e50: 2063 6f6c 6c65 6374 696f 6e2e 0a0a 2020   collection...  
+00004e60: 2020 2020 2020 3a72 6574 7572 6e3a 2054        :return: T
+00004e70: 7275 6520 6966 2063 6f6c 6c65 6374 696f  rue if collectio
+00004e80: 6e20 7761 7320 7472 756e 6361 7465 6420  n was truncated 
+00004e90: 7375 6363 6573 7366 756c 6c79 2e0a 2020  successfully..  
+00004ea0: 2020 2020 2020 3a72 7479 7065 3a20 626f        :rtype: bo
+00004eb0: 6f6c 0a20 2020 2020 2020 203a 7261 6973  ol.        :rais
+00004ec0: 6520 6172 616e 676f 2e65 7863 6570 7469  e arango.excepti
+00004ed0: 6f6e 732e 436f 6c6c 6563 7469 6f6e 5472  ons.CollectionTr
+00004ee0: 756e 6361 7465 4572 726f 723a 2049 6620  uncateError: If 
+00004ef0: 6f70 6572 6174 696f 6e20 6661 696c 732e  operation fails.
+00004f00: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00004f10: 2020 2020 2072 6571 7565 7374 203d 2052       request = R
+00004f20: 6571 7565 7374 280a 2020 2020 2020 2020  equest(.        
+00004f30: 2020 2020 6d65 7468 6f64 3d22 7075 7422      method="put"
+00004f40: 2c20 656e 6470 6f69 6e74 3d66 222f 5f61  , endpoint=f"/_a
+00004f50: 7069 2f63 6f6c 6c65 6374 696f 6e2f 7b73  pi/collection/{s
+00004f60: 656c 662e 6e61 6d65 7d2f 7472 756e 6361  elf.name}/trunca
+00004f70: 7465 220a 2020 2020 2020 2020 290a 0a20  te".        ).. 
+00004f80: 2020 2020 2020 2064 6566 2072 6573 706f         def respo
+00004f90: 6e73 655f 6861 6e64 6c65 7228 7265 7370  nse_handler(resp
+00004fa0: 3a20 5265 7370 6f6e 7365 2920 2d3e 2062  : Response) -> b
+00004fb0: 6f6f 6c3a 0a20 2020 2020 2020 2020 2020  ool:.           
+00004fc0: 2069 6620 6e6f 7420 7265 7370 2e69 735f   if not resp.is_
+00004fd0: 7375 6363 6573 733a 0a20 2020 2020 2020  success:.       
+00004fe0: 2020 2020 2020 2020 2072 6169 7365 2043           raise C
+00004ff0: 6f6c 6c65 6374 696f 6e54 7275 6e63 6174  ollectionTruncat
+00005000: 6545 7272 6f72 2872 6573 702c 2072 6571  eError(resp, req
+00005010: 7565 7374 290a 2020 2020 2020 2020 2020  uest).          
+00005020: 2020 7265 7475 726e 2054 7275 650a 0a20    return True.. 
+00005030: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00005040: 6c66 2e5f 6578 6563 7574 6528 7265 7175  lf._execute(requ
+00005050: 6573 742c 2072 6573 706f 6e73 655f 6861  est, response_ha
+00005060: 6e64 6c65 7229 0a0a 2020 2020 6465 6620  ndler)..    def 
+00005070: 636f 756e 7428 7365 6c66 2920 2d3e 2052  count(self) -> R
+00005080: 6573 756c 745b 696e 745d 3a0a 2020 2020  esult[int]:.    
+00005090: 2020 2020 2222 2252 6574 7572 6e20 7468      """Return th
+000050a0: 6520 746f 7461 6c20 646f 6375 6d65 6e74  e total document
+000050b0: 2063 6f75 6e74 2e0a 0a20 2020 2020 2020   count...       
+000050c0: 203a 7265 7475 726e 3a20 546f 7461 6c20   :return: Total 
+000050d0: 646f 6375 6d65 6e74 2063 6f75 6e74 2e0a  document count..
+000050e0: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
+000050f0: 696e 740a 2020 2020 2020 2020 3a72 6169  int.        :rai
+00005100: 7365 2061 7261 6e67 6f2e 6578 6365 7074  se arango.except
+00005110: 696f 6e73 2e44 6f63 756d 656e 7443 6f75  ions.DocumentCou
+00005120: 6e74 4572 726f 723a 2049 6620 7265 7472  ntError: If retr
+00005130: 6965 7661 6c20 6661 696c 732e 0a20 2020  ieval fails..   
+00005140: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00005150: 2072 6571 7565 7374 203d 2052 6571 7565   request = Reque
+00005160: 7374 286d 6574 686f 643d 2267 6574 222c  st(method="get",
+00005170: 2065 6e64 706f 696e 743d 6622 2f5f 6170   endpoint=f"/_ap
+00005180: 692f 636f 6c6c 6563 7469 6f6e 2f7b 7365  i/collection/{se
+00005190: 6c66 2e6e 616d 657d 2f63 6f75 6e74 2229  lf.name}/count")
+000051a0: 0a0a 2020 2020 2020 2020 6465 6620 7265  ..        def re
+000051b0: 7370 6f6e 7365 5f68 616e 646c 6572 2872  sponse_handler(r
+000051c0: 6573 703a 2052 6573 706f 6e73 6529 202d  esp: Response) -
+000051d0: 3e20 696e 743a 0a20 2020 2020 2020 2020  > int:.         
+000051e0: 2020 2069 6620 7265 7370 2e69 735f 7375     if resp.is_su
+000051f0: 6363 6573 733a 0a20 2020 2020 2020 2020  ccess:.         
+00005200: 2020 2020 2020 2072 6573 756c 743a 2069         result: i
+00005210: 6e74 203d 2072 6573 702e 626f 6479 5b22  nt = resp.body["
+00005220: 636f 756e 7422 5d0a 2020 2020 2020 2020  count"].        
+00005230: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+00005240: 6573 756c 740a 2020 2020 2020 2020 2020  esult.          
+00005250: 2020 7261 6973 6520 446f 6375 6d65 6e74    raise Document
+00005260: 436f 756e 7445 7272 6f72 2872 6573 702c  CountError(resp,
+00005270: 2072 6571 7565 7374 290a 0a20 2020 2020   request)..     
+00005280: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00005290: 6578 6563 7574 6528 7265 7175 6573 742c  execute(request,
+000052a0: 2072 6573 706f 6e73 655f 6861 6e64 6c65   response_handle
+000052b0: 7229 0a0a 2020 2020 6465 6620 6861 7328  r)..    def has(
+000052c0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+000052d0: 2020 2020 2020 2064 6f63 756d 656e 743a         document:
+000052e0: 2055 6e69 6f6e 5b73 7472 2c20 4a73 6f6e   Union[str, Json
+000052f0: 5d2c 0a20 2020 2020 2020 2072 6576 3a20  ],.        rev: 
+00005300: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
+00005310: 4e6f 6e65 2c0a 2020 2020 2020 2020 6368  None,.        ch
+00005320: 6563 6b5f 7265 763a 2062 6f6f 6c20 3d20  eck_rev: bool = 
+00005330: 5472 7565 2c0a 2020 2020 2020 2020 616c  True,.        al
+00005340: 6c6f 775f 6469 7274 795f 7265 6164 3a20  low_dirty_read: 
+00005350: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+00005360: 2020 2920 2d3e 2052 6573 756c 745b 626f    ) -> Result[bo
+00005370: 6f6c 5d3a 0a20 2020 2020 2020 2022 2222  ol]:.        """
+00005380: 4368 6563 6b20 6966 2061 2064 6f63 756d  Check if a docum
+00005390: 656e 7420 6578 6973 7473 2069 6e20 7468  ent exists in th
+000053a0: 6520 636f 6c6c 6563 7469 6f6e 2e0a 0a20  e collection... 
+000053b0: 2020 2020 2020 203a 7061 7261 6d20 646f         :param do
+000053c0: 6375 6d65 6e74 3a20 446f 6375 6d65 6e74  cument: Document
+000053d0: 2049 442c 206b 6579 206f 7220 626f 6479   ID, key or body
+000053e0: 2e20 446f 6375 6d65 6e74 2062 6f64 7920  . Document body 
+000053f0: 6d75 7374 2063 6f6e 7461 696e 0a20 2020  must contain.   
+00005400: 2020 2020 2020 2020 2074 6865 2022 5f69           the "_i
+00005410: 6422 206f 7220 225f 6b65 7922 2066 6965  d" or "_key" fie
+00005420: 6c64 2e0a 2020 2020 2020 2020 3a74 7970  ld..        :typ
+00005430: 6520 646f 6375 6d65 6e74 3a20 7374 7220  e document: str 
+00005440: 7c20 6469 6374 0a20 2020 2020 2020 203a  | dict.        :
+00005450: 7061 7261 6d20 7265 763a 2045 7870 6563  param rev: Expec
+00005460: 7465 6420 646f 6375 6d65 6e74 2072 6576  ted document rev
+00005470: 6973 696f 6e2e 204f 7665 7272 6964 6573  ision. Overrides
+00005480: 2076 616c 7565 206f 6620 225f 7265 7622   value of "_rev"
+00005490: 2066 6965 6c64 0a20 2020 2020 2020 2020   field.         
+000054a0: 2020 2069 6e20 2a2a 646f 6375 6d65 6e74     in **document
+000054b0: 2a2a 2069 6620 7072 6573 656e 742e 0a20  ** if present.. 
+000054c0: 2020 2020 2020 203a 7479 7065 2072 6576         :type rev
+000054d0: 3a20 7374 7220 7c20 4e6f 6e65 0a20 2020  : str | None.   
+000054e0: 2020 2020 203a 7061 7261 6d20 6368 6563       :param chec
+000054f0: 6b5f 7265 763a 2049 6620 7365 7420 746f  k_rev: If set to
+00005500: 2054 7275 652c 2072 6576 6973 696f 6e20   True, revision 
+00005510: 6f66 202a 2a64 6f63 756d 656e 742a 2a20  of **document** 
+00005520: 2869 6620 6769 7665 6e29 0a20 2020 2020  (if given).     
+00005530: 2020 2020 2020 2069 7320 636f 6d70 6172         is compar
+00005540: 6564 2061 6761 696e 7374 2074 6865 2072  ed against the r
+00005550: 6576 6973 696f 6e20 6f66 2074 6172 6765  evision of targe
+00005560: 7420 646f 6375 6d65 6e74 2e0a 2020 2020  t document..    
+00005570: 2020 2020 3a74 7970 6520 6368 6563 6b5f      :type check_
+00005580: 7265 763a 2062 6f6f 6c0a 2020 2020 2020  rev: bool.      
+00005590: 2020 3a70 6172 616d 2061 6c6c 6f77 5f64    :param allow_d
+000055a0: 6972 7479 5f72 6561 643a 2041 6c6c 6f77  irty_read: Allow
+000055b0: 2072 6561 6473 2066 726f 6d20 666f 6c6c   reads from foll
+000055c0: 6f77 6572 7320 696e 2061 2063 6c75 7374  owers in a clust
+000055d0: 6572 2e0a 2020 2020 2020 2020 3a74 7970  er..        :typ
+000055e0: 6520 616c 6c6f 775f 6469 7274 795f 7265  e allow_dirty_re
+000055f0: 6164 3a20 626f 6f6c 0a20 2020 2020 2020  ad: bool.       
+00005600: 203a 7265 7475 726e 3a20 5472 7565 2069   :return: True i
+00005610: 6620 646f 6375 6d65 6e74 2065 7869 7374  f document exist
+00005620: 732c 2046 616c 7365 206f 7468 6572 7769  s, False otherwi
+00005630: 7365 2e0a 2020 2020 2020 2020 3a72 7479  se..        :rty
+00005640: 7065 3a20 626f 6f6c 0a20 2020 2020 2020  pe: bool.       
+00005650: 203a 7261 6973 6520 6172 616e 676f 2e65   :raise arango.e
+00005660: 7863 6570 7469 6f6e 732e 446f 6375 6d65  xceptions.Docume
+00005670: 6e74 496e 4572 726f 723a 2049 6620 6368  ntInError: If ch
+00005680: 6563 6b20 6661 696c 732e 0a20 2020 2020  eck fails..     
+00005690: 2020 203a 7261 6973 6520 6172 616e 676f     :raise arango
+000056a0: 2e65 7863 6570 7469 6f6e 732e 446f 6375  .exceptions.Docu
+000056b0: 6d65 6e74 5265 7669 7369 6f6e 4572 726f  mentRevisionErro
+000056c0: 723a 2049 6620 7265 7669 7369 6f6e 7320  r: If revisions 
+000056d0: 6d69 736d 6174 6368 2e0a 2020 2020 2020  mismatch..      
+000056e0: 2020 2222 220a 2020 2020 2020 2020 6861    """.        ha
+000056f0: 6e64 6c65 2c20 626f 6479 2c20 6865 6164  ndle, body, head
+00005700: 6572 7320 3d20 7365 6c66 2e5f 7072 6570  ers = self._prep
+00005710: 5f66 726f 6d5f 646f 6328 646f 6375 6d65  _from_doc(docume
+00005720: 6e74 2c20 7265 762c 2063 6865 636b 5f72  nt, rev, check_r
+00005730: 6576 290a 0a20 2020 2020 2020 2069 6620  ev)..        if 
+00005740: 616c 6c6f 775f 6469 7274 795f 7265 6164  allow_dirty_read
+00005750: 3a0a 2020 2020 2020 2020 2020 2020 6865  :.            he
+00005760: 6164 6572 735b 2278 2d61 7261 6e67 6f2d  aders["x-arango-
+00005770: 616c 6c6f 772d 6469 7274 792d 7265 6164  allow-dirty-read
+00005780: 225d 203d 2022 7472 7565 220a 0a20 2020  "] = "true"..   
+00005790: 2020 2020 2072 6571 7565 7374 203d 2052       request = R
+000057a0: 6571 7565 7374 280a 2020 2020 2020 2020  equest(.        
+000057b0: 2020 2020 6d65 7468 6f64 3d22 6765 7422      method="get"
+000057c0: 2c0a 2020 2020 2020 2020 2020 2020 656e  ,.            en
+000057d0: 6470 6f69 6e74 3d66 222f 5f61 7069 2f64  dpoint=f"/_api/d
+000057e0: 6f63 756d 656e 742f 7b68 616e 646c 657d  ocument/{handle}
+000057f0: 222c 0a20 2020 2020 2020 2020 2020 2068  ",.            h
+00005800: 6561 6465 7273 3d68 6561 6465 7273 2c0a  eaders=headers,.
+00005810: 2020 2020 2020 2020 2020 2020 7265 6164              read
+00005820: 3d73 656c 662e 6e61 6d65 2c0a 2020 2020  =self.name,.    
+00005830: 2020 2020 290a 0a20 2020 2020 2020 2064      )..        d
+00005840: 6566 2072 6573 706f 6e73 655f 6861 6e64  ef response_hand
+00005850: 6c65 7228 7265 7370 3a20 5265 7370 6f6e  ler(resp: Respon
+00005860: 7365 2920 2d3e 2062 6f6f 6c3a 0a20 2020  se) -> bool:.   
+00005870: 2020 2020 2020 2020 2069 6620 7265 7370           if resp
+00005880: 2e65 7272 6f72 5f63 6f64 6520 3d3d 2031  .error_code == 1
+00005890: 3230 323a 0a20 2020 2020 2020 2020 2020  202:.           
+000058a0: 2020 2020 2072 6574 7572 6e20 4661 6c73       return Fals
+000058b0: 650a 2020 2020 2020 2020 2020 2020 6966  e.            if
+000058c0: 2072 6573 702e 7374 6174 7573 5f63 6f64   resp.status_cod
+000058d0: 6520 3d3d 2034 3132 3a0a 2020 2020 2020  e == 412:.      
+000058e0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+000058f0: 446f 6375 6d65 6e74 5265 7669 7369 6f6e  DocumentRevision
+00005900: 4572 726f 7228 7265 7370 2c20 7265 7175  Error(resp, requ
+00005910: 6573 7429 0a20 2020 2020 2020 2020 2020  est).           
+00005920: 2069 6620 6e6f 7420 7265 7370 2e69 735f   if not resp.is_
+00005930: 7375 6363 6573 733a 0a20 2020 2020 2020  success:.       
+00005940: 2020 2020 2020 2020 2072 6169 7365 2044           raise D
+00005950: 6f63 756d 656e 7449 6e45 7272 6f72 2872  ocumentInError(r
+00005960: 6573 702c 2072 6571 7565 7374 290a 2020  esp, request).  
+00005970: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00005980: 2062 6f6f 6c28 7265 7370 2e62 6f64 7929   bool(resp.body)
+00005990: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000059a0: 2073 656c 662e 5f65 7865 6375 7465 2872   self._execute(r
+000059b0: 6571 7565 7374 2c20 7265 7370 6f6e 7365  equest, response
+000059c0: 5f68 616e 646c 6572 290a 0a20 2020 2064  _handler)..    d
+000059d0: 6566 2069 6473 2873 656c 662c 2061 6c6c  ef ids(self, all
+000059e0: 6f77 5f64 6972 7479 5f72 6561 643a 2062  ow_dirty_read: b
+000059f0: 6f6f 6c20 3d20 4661 6c73 6529 202d 3e20  ool = False) -> 
+00005a00: 5265 7375 6c74 5b43 7572 736f 725d 3a0a  Result[Cursor]:.
+00005a10: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+00005a20: 6e20 7468 6520 4944 7320 6f66 2061 6c6c  n the IDs of all
+00005a30: 2064 6f63 756d 656e 7473 2069 6e20 7468   documents in th
+00005a40: 6520 636f 6c6c 6563 7469 6f6e 2e0a 0a20  e collection... 
+00005a50: 2020 2020 2020 203a 7061 7261 6d20 616c         :param al
+00005a60: 6c6f 775f 6469 7274 795f 7265 6164 3a20  low_dirty_read: 
+00005a70: 416c 6c6f 7720 7265 6164 7320 6672 6f6d  Allow reads from
+00005a80: 2066 6f6c 6c6f 7765 7273 2069 6e20 6120   followers in a 
+00005a90: 636c 7573 7465 722e 0a20 2020 2020 2020  cluster..       
+00005aa0: 203a 7479 7065 2061 6c6c 6f77 5f64 6972   :type allow_dir
+00005ab0: 7479 5f72 6561 643a 2062 6f6f 6c0a 2020  ty_read: bool.  
+00005ac0: 2020 2020 2020 3a72 6574 7572 6e3a 2044        :return: D
+00005ad0: 6f63 756d 656e 7420 4944 2063 7572 736f  ocument ID curso
+00005ae0: 722e 0a20 2020 2020 2020 203a 7274 7970  r..        :rtyp
+00005af0: 653a 2061 7261 6e67 6f2e 6375 7273 6f72  e: arango.cursor
+00005b00: 2e43 7572 736f 720a 2020 2020 2020 2020  .Cursor.        
+00005b10: 3a72 6169 7365 2061 7261 6e67 6f2e 6578  :raise arango.ex
+00005b20: 6365 7074 696f 6e73 2e44 6f63 756d 656e  ceptions.Documen
+00005b30: 7449 4473 4572 726f 723a 2049 6620 7265  tIDsError: If re
+00005b40: 7472 6965 7661 6c20 6661 696c 732e 0a20  trieval fails.. 
+00005b50: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00005b60: 2020 2071 7565 7279 203d 2022 464f 5220     query = "FOR 
+00005b70: 646f 6320 494e 2040 4063 6f6c 6c65 6374  doc IN @@collect
+00005b80: 696f 6e20 5245 5455 524e 2064 6f63 2e5f  ion RETURN doc._
+00005b90: 6964 220a 2020 2020 2020 2020 6269 6e64  id".        bind
+00005ba0: 5f76 6172 7320 3d20 7b22 4063 6f6c 6c65  _vars = {"@colle
+00005bb0: 6374 696f 6e22 3a20 7365 6c66 2e6e 616d  ction": self.nam
+00005bc0: 657d 0a0a 2020 2020 2020 2020 7265 7175  e}..        requ
+00005bd0: 6573 7420 3d20 5265 7175 6573 7428 0a20  est = Request(. 
+00005be0: 2020 2020 2020 2020 2020 206d 6574 686f             metho
+00005bf0: 643d 2270 6f73 7422 2c0a 2020 2020 2020  d="post",.      
+00005c00: 2020 2020 2020 656e 6470 6f69 6e74 3d22        endpoint="
+00005c10: 2f5f 6170 692f 6375 7273 6f72 222c 0a20  /_api/cursor",. 
+00005c20: 2020 2020 2020 2020 2020 2064 6174 613d             data=
+00005c30: 7b22 7175 6572 7922 3a20 7175 6572 792c  {"query": query,
+00005c40: 2022 6269 6e64 5661 7273 223a 2062 696e   "bindVars": bin
+00005c50: 645f 7661 7273 7d2c 0a20 2020 2020 2020  d_vars},.       
+00005c60: 2020 2020 2072 6561 643d 7365 6c66 2e6e       read=self.n
+00005c70: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
+00005c80: 2068 6561 6465 7273 3d7b 2278 2d61 7261   headers={"x-ara
+00005c90: 6e67 6f2d 616c 6c6f 772d 6469 7274 792d  ngo-allow-dirty-
+00005ca0: 7265 6164 223a 2022 7472 7565 227d 2069  read": "true"} i
+00005cb0: 6620 616c 6c6f 775f 6469 7274 795f 7265  f allow_dirty_re
+00005cc0: 6164 2065 6c73 6520 4e6f 6e65 2c0a 2020  ad else None,.  
+00005cd0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00005ce0: 2064 6566 2072 6573 706f 6e73 655f 6861   def response_ha
+00005cf0: 6e64 6c65 7228 7265 7370 3a20 5265 7370  ndler(resp: Resp
+00005d00: 6f6e 7365 2920 2d3e 2043 7572 736f 723a  onse) -> Cursor:
+00005d10: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00005d20: 6e6f 7420 7265 7370 2e69 735f 7375 6363  not resp.is_succ
+00005d30: 6573 733a 0a20 2020 2020 2020 2020 2020  ess:.           
+00005d40: 2020 2020 2072 6169 7365 2044 6f63 756d       raise Docum
+00005d50: 656e 7449 4473 4572 726f 7228 7265 7370  entIDsError(resp
+00005d60: 2c20 7265 7175 6573 7429 0a20 2020 2020  , request).     
+00005d70: 2020 2020 2020 2072 6574 7572 6e20 4375         return Cu
+00005d80: 7273 6f72 2873 656c 662e 5f63 6f6e 6e2c  rsor(self._conn,
+00005d90: 2072 6573 702e 626f 6479 290a 0a20 2020   resp.body)..   
+00005da0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00005db0: 2e5f 6578 6563 7574 6528 7265 7175 6573  ._execute(reques
+00005dc0: 742c 2072 6573 706f 6e73 655f 6861 6e64  t, response_hand
+00005dd0: 6c65 7229 0a0a 2020 2020 6465 6620 6b65  ler)..    def ke
+00005de0: 7973 2873 656c 662c 2061 6c6c 6f77 5f64  ys(self, allow_d
+00005df0: 6972 7479 5f72 6561 643a 2062 6f6f 6c20  irty_read: bool 
+00005e00: 3d20 4661 6c73 6529 202d 3e20 5265 7375  = False) -> Resu
+00005e10: 6c74 5b43 7572 736f 725d 3a0a 2020 2020  lt[Cursor]:.    
+00005e20: 2020 2020 2222 2252 6574 7572 6e20 7468      """Return th
+00005e30: 6520 6b65 7973 206f 6620 616c 6c20 646f  e keys of all do
+00005e40: 6375 6d65 6e74 7320 696e 2074 6865 2063  cuments in the c
+00005e50: 6f6c 6c65 6374 696f 6e2e 0a0a 2020 2020  ollection...    
+00005e60: 2020 2020 3a70 6172 616d 2061 6c6c 6f77      :param allow
+00005e70: 5f64 6972 7479 5f72 6561 643a 2041 6c6c  _dirty_read: All
+00005e80: 6f77 2072 6561 6473 2066 726f 6d20 666f  ow reads from fo
+00005e90: 6c6c 6f77 6572 7320 696e 2061 2063 6c75  llowers in a clu
+00005ea0: 7374 6572 2e0a 2020 2020 2020 2020 3a74  ster..        :t
+00005eb0: 7970 6520 616c 6c6f 775f 6469 7274 795f  ype allow_dirty_
+00005ec0: 7265 6164 3a20 626f 6f6c 0a20 2020 2020  read: bool.     
+00005ed0: 2020 203a 7265 7475 726e 3a20 446f 6375     :return: Docu
+00005ee0: 6d65 6e74 206b 6579 2063 7572 736f 722e  ment key cursor.
+00005ef0: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
+00005f00: 2061 7261 6e67 6f2e 6375 7273 6f72 2e43   arango.cursor.C
+00005f10: 7572 736f 720a 2020 2020 2020 2020 3a72  ursor.        :r
+00005f20: 6169 7365 2061 7261 6e67 6f2e 6578 6365  aise arango.exce
+00005f30: 7074 696f 6e73 2e44 6f63 756d 656e 744b  ptions.DocumentK
+00005f40: 6579 7345 7272 6f72 3a20 4966 2072 6574  eysError: If ret
+00005f50: 7269 6576 616c 2066 6169 6c73 2e0a 2020  rieval fails..  
+00005f60: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00005f70: 2020 7175 6572 7920 3d20 2246 4f52 2064    query = "FOR d
+00005f80: 6f63 2049 4e20 4040 636f 6c6c 6563 7469  oc IN @@collecti
+00005f90: 6f6e 2052 4554 5552 4e20 646f 632e 5f6b  on RETURN doc._k
+00005fa0: 6579 220a 2020 2020 2020 2020 6269 6e64  ey".        bind
+00005fb0: 5f76 6172 7320 3d20 7b22 4063 6f6c 6c65  _vars = {"@colle
+00005fc0: 6374 696f 6e22 3a20 7365 6c66 2e6e 616d  ction": self.nam
+00005fd0: 657d 0a0a 2020 2020 2020 2020 7265 7175  e}..        requ
+00005fe0: 6573 7420 3d20 5265 7175 6573 7428 0a20  est = Request(. 
+00005ff0: 2020 2020 2020 2020 2020 206d 6574 686f             metho
+00006000: 643d 2270 6f73 7422 2c0a 2020 2020 2020  d="post",.      
+00006010: 2020 2020 2020 656e 6470 6f69 6e74 3d22        endpoint="
+00006020: 2f5f 6170 692f 6375 7273 6f72 222c 0a20  /_api/cursor",. 
+00006030: 2020 2020 2020 2020 2020 2064 6174 613d             data=
+00006040: 7b22 7175 6572 7922 3a20 7175 6572 792c  {"query": query,
+00006050: 2022 6269 6e64 5661 7273 223a 2062 696e   "bindVars": bin
+00006060: 645f 7661 7273 7d2c 0a20 2020 2020 2020  d_vars},.       
+00006070: 2020 2020 2072 6561 643d 7365 6c66 2e6e       read=self.n
+00006080: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
+00006090: 2068 6561 6465 7273 3d7b 2278 2d61 7261   headers={"x-ara
+000060a0: 6e67 6f2d 616c 6c6f 772d 6469 7274 792d  ngo-allow-dirty-
+000060b0: 7265 6164 223a 2022 7472 7565 227d 2069  read": "true"} i
+000060c0: 6620 616c 6c6f 775f 6469 7274 795f 7265  f allow_dirty_re
+000060d0: 6164 2065 6c73 6520 4e6f 6e65 2c0a 2020  ad else None,.  
+000060e0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+000060f0: 2064 6566 2072 6573 706f 6e73 655f 6861   def response_ha
+00006100: 6e64 6c65 7228 7265 7370 3a20 5265 7370  ndler(resp: Resp
+00006110: 6f6e 7365 2920 2d3e 2043 7572 736f 723a  onse) -> Cursor:
+00006120: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00006130: 6e6f 7420 7265 7370 2e69 735f 7375 6363  not resp.is_succ
+00006140: 6573 733a 0a20 2020 2020 2020 2020 2020  ess:.           
+00006150: 2020 2020 2072 6169 7365 2044 6f63 756d       raise Docum
+00006160: 656e 744b 6579 7345 7272 6f72 2872 6573  entKeysError(res
+00006170: 702c 2072 6571 7565 7374 290a 2020 2020  p, request).    
+00006180: 2020 2020 2020 2020 7265 7475 726e 2043          return C
+00006190: 7572 736f 7228 7365 6c66 2e5f 636f 6e6e  ursor(self._conn
+000061a0: 2c20 7265 7370 2e62 6f64 7929 0a0a 2020  , resp.body)..  
+000061b0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000061c0: 662e 5f65 7865 6375 7465 2872 6571 7565  f._execute(reque
+000061d0: 7374 2c20 7265 7370 6f6e 7365 5f68 616e  st, response_han
+000061e0: 646c 6572 290a 0a20 2020 2064 6566 2061  dler)..    def a
+000061f0: 6c6c 280a 2020 2020 2020 2020 7365 6c66  ll(.        self
+00006200: 2c0a 2020 2020 2020 2020 736b 6970 3a20  ,.        skip: 
+00006210: 4f70 7469 6f6e 616c 5b69 6e74 5d20 3d20  Optional[int] = 
+00006220: 4e6f 6e65 2c0a 2020 2020 2020 2020 6c69  None,.        li
+00006230: 6d69 743a 204f 7074 696f 6e61 6c5b 696e  mit: Optional[in
+00006240: 745d 203d 204e 6f6e 652c 0a20 2020 2020  t] = None,.     
+00006250: 2020 2061 6c6c 6f77 5f64 6972 7479 5f72     allow_dirty_r
+00006260: 6561 643a 2062 6f6f 6c20 3d20 4661 6c73  ead: bool = Fals
+00006270: 652c 0a20 2020 2029 202d 3e20 5265 7375  e,.    ) -> Resu
+00006280: 6c74 5b43 7572 736f 725d 3a0a 2020 2020  lt[Cursor]:.    
+00006290: 2020 2020 2222 2252 6574 7572 6e20 616c      """Return al
+000062a0: 6c20 646f 6375 6d65 6e74 7320 696e 2074  l documents in t
+000062b0: 6865 2063 6f6c 6c65 6374 696f 6e2e 0a0a  he collection...
+000062c0: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
+000062d0: 6b69 703a 204e 756d 6265 7220 6f66 2064  kip: Number of d
+000062e0: 6f63 756d 656e 7473 2074 6f20 736b 6970  ocuments to skip
+000062f0: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
+00006300: 736b 6970 3a20 696e 7420 7c20 4e6f 6e65  skip: int | None
+00006310: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00006320: 6c69 6d69 743a 204d 6178 206e 756d 6265  limit: Max numbe
+00006330: 7220 6f66 2064 6f63 756d 656e 7473 2072  r of documents r
+00006340: 6574 7572 6e65 642e 0a20 2020 2020 2020  eturned..       
+00006350: 203a 7479 7065 206c 696d 6974 3a20 696e   :type limit: in
+00006360: 7420 7c20 4e6f 6e65 0a20 2020 2020 2020  t | None.       
+00006370: 203a 7061 7261 6d20 616c 6c6f 775f 6469   :param allow_di
+00006380: 7274 795f 7265 6164 3a20 416c 6c6f 7720  rty_read: Allow 
+00006390: 7265 6164 7320 6672 6f6d 2066 6f6c 6c6f  reads from follo
+000063a0: 7765 7273 2069 6e20 6120 636c 7573 7465  wers in a cluste
+000063b0: 722e 0a20 2020 2020 2020 203a 7479 7065  r..        :type
+000063c0: 2061 6c6c 6f77 5f64 6972 7479 5f72 6561   allow_dirty_rea
+000063d0: 643a 2062 6f6f 6c0a 2020 2020 2020 2020  d: bool.        
+000063e0: 3a72 6574 7572 6e3a 2044 6f63 756d 656e  :return: Documen
+000063f0: 7420 6375 7273 6f72 2e0a 2020 2020 2020  t cursor..      
+00006400: 2020 3a72 7479 7065 3a20 6172 616e 676f    :rtype: arango
+00006410: 2e63 7572 736f 722e 4375 7273 6f72 0a20  .cursor.Cursor. 
+00006420: 2020 2020 2020 203a 7261 6973 6520 6172         :raise ar
+00006430: 616e 676f 2e65 7863 6570 7469 6f6e 732e  ango.exceptions.
+00006440: 446f 6375 6d65 6e74 4765 7445 7272 6f72  DocumentGetError
+00006450: 3a20 4966 2072 6574 7269 6576 616c 2066  : If retrieval f
+00006460: 6169 6c73 2e0a 2020 2020 2020 2020 2222  ails..        ""
+00006470: 220a 2020 2020 2020 2020 6173 7365 7274  ".        assert
+00006480: 2069 735f 6e6f 6e65 5f6f 725f 696e 7428   is_none_or_int(
+00006490: 736b 6970 292c 2022 736b 6970 206d 7573  skip), "skip mus
+000064a0: 7420 6265 2061 206e 6f6e 2d6e 6567 6174  t be a non-negat
+000064b0: 6976 6520 696e 7422 0a20 2020 2020 2020  ive int".       
+000064c0: 2061 7373 6572 7420 6973 5f6e 6f6e 655f   assert is_none_
+000064d0: 6f72 5f69 6e74 286c 696d 6974 292c 2022  or_int(limit), "
+000064e0: 6c69 6d69 7420 6d75 7374 2062 6520 6120  limit must be a 
+000064f0: 6e6f 6e2d 6e65 6761 7469 7665 2069 6e74  non-negative int
+00006500: 220a 0a20 2020 2020 2020 2073 6b69 705f  "..        skip_
+00006510: 7661 6c20 3d20 736b 6970 2069 6620 736b  val = skip if sk
+00006520: 6970 2069 7320 6e6f 7420 4e6f 6e65 2065  ip is not None e
+00006530: 6c73 6520 300a 2020 2020 2020 2020 6c69  lse 0.        li
+00006540: 6d69 745f 7661 6c20 3d20 6c69 6d69 7420  mit_val = limit 
+00006550: 6966 206c 696d 6974 2069 7320 6e6f 7420  if limit is not 
+00006560: 4e6f 6e65 2065 6c73 6520 226e 756c 6c22  None else "null"
+00006570: 0a20 2020 2020 2020 2071 7565 7279 203d  .        query =
+00006580: 2066 2222 220a 2020 2020 2020 2020 2020   f""".          
+00006590: 2020 464f 5220 646f 6320 494e 2040 4063    FOR doc IN @@c
+000065a0: 6f6c 6c65 6374 696f 6e0a 2020 2020 2020  ollection.      
+000065b0: 2020 2020 2020 2020 2020 4c49 4d49 5420            LIMIT 
+000065c0: 7b73 6b69 705f 7661 6c7d 2c20 7b6c 696d  {skip_val}, {lim
+000065d0: 6974 5f76 616c 7d0a 2020 2020 2020 2020  it_val}.        
+000065e0: 2020 2020 2020 2020 5245 5455 524e 2064          RETURN d
+000065f0: 6f63 0a20 2020 2020 2020 2022 2222 0a0a  oc.        """..
+00006600: 2020 2020 2020 2020 6269 6e64 5f76 6172          bind_var
+00006610: 7320 3d20 7b22 4063 6f6c 6c65 6374 696f  s = {"@collectio
+00006620: 6e22 3a20 7365 6c66 2e6e 616d 657d 0a0a  n": self.name}..
+00006630: 2020 2020 2020 2020 7265 7175 6573 7420          request 
+00006640: 3d20 5265 7175 6573 7428 0a20 2020 2020  = Request(.     
+00006650: 2020 2020 2020 206d 6574 686f 643d 2270         method="p
+00006660: 6f73 7422 2c0a 2020 2020 2020 2020 2020  ost",.          
+00006670: 2020 656e 6470 6f69 6e74 3d22 2f5f 6170    endpoint="/_ap
+00006680: 692f 6375 7273 6f72 222c 0a20 2020 2020  i/cursor",.     
+00006690: 2020 2020 2020 2064 6174 613d 7b22 7175         data={"qu
+000066a0: 6572 7922 3a20 7175 6572 792c 2022 6269  ery": query, "bi
+000066b0: 6e64 5661 7273 223a 2062 696e 645f 7661  ndVars": bind_va
+000066c0: 7273 2c20 2263 6f75 6e74 223a 2054 7275  rs, "count": Tru
+000066d0: 657d 2c0a 2020 2020 2020 2020 2020 2020  e},.            
+000066e0: 7265 6164 3d73 656c 662e 6e61 6d65 2c0a  read=self.name,.
+000066f0: 2020 2020 2020 2020 2020 2020 6865 6164              head
+00006700: 6572 733d 7b22 782d 6172 616e 676f 2d61  ers={"x-arango-a
+00006710: 6c6c 6f77 2d64 6972 7479 2d72 6561 6422  llow-dirty-read"
+00006720: 3a20 2274 7275 6522 7d20 6966 2061 6c6c  : "true"} if all
+00006730: 6f77 5f64 6972 7479 5f72 6561 6420 656c  ow_dirty_read el
+00006740: 7365 204e 6f6e 652c 0a20 2020 2020 2020  se None,.       
+00006750: 2029 0a0a 2020 2020 2020 2020 6465 6620   )..        def 
+00006760: 7265 7370 6f6e 7365 5f68 616e 646c 6572  response_handler
+00006770: 2872 6573 703a 2052 6573 706f 6e73 6529  (resp: Response)
+00006780: 202d 3e20 4375 7273 6f72 3a0a 2020 2020   -> Cursor:.    
+00006790: 2020 2020 2020 2020 6966 206e 6f74 2072          if not r
+000067a0: 6573 702e 6973 5f73 7563 6365 7373 3a0a  esp.is_success:.
+000067b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000067c0: 7261 6973 6520 446f 6375 6d65 6e74 4765  raise DocumentGe
+000067d0: 7445 7272 6f72 2872 6573 702c 2072 6571  tError(resp, req
+000067e0: 7565 7374 290a 2020 2020 2020 2020 2020  uest).          
+000067f0: 2020 7265 7475 726e 2043 7572 736f 7228    return Cursor(
+00006800: 7365 6c66 2e5f 636f 6e6e 2c20 7265 7370  self._conn, resp
+00006810: 2e62 6f64 7929 0a0a 2020 2020 2020 2020  .body)..        
+00006820: 7265 7475 726e 2073 656c 662e 5f65 7865  return self._exe
+00006830: 6375 7465 2872 6571 7565 7374 2c20 7265  cute(request, re
+00006840: 7370 6f6e 7365 5f68 616e 646c 6572 290a  sponse_handler).
+00006850: 0a20 2020 2064 6566 2066 696e 6428 0a20  .    def find(. 
+00006860: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00006870: 2020 2020 2066 696c 7465 7273 3a20 4a73       filters: Js
+00006880: 6f6e 2c0a 2020 2020 2020 2020 736b 6970  on,.        skip
+00006890: 3a20 4f70 7469 6f6e 616c 5b69 6e74 5d20  : Optional[int] 
+000068a0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+000068b0: 6c69 6d69 743a 204f 7074 696f 6e61 6c5b  limit: Optional[
+000068c0: 696e 745d 203d 204e 6f6e 652c 0a20 2020  int] = None,.   
+000068d0: 2020 2020 2061 6c6c 6f77 5f64 6972 7479       allow_dirty
+000068e0: 5f72 6561 643a 2062 6f6f 6c20 3d20 4661  _read: bool = Fa
+000068f0: 6c73 652c 0a20 2020 2029 202d 3e20 5265  lse,.    ) -> Re
+00006900: 7375 6c74 5b43 7572 736f 725d 3a0a 2020  sult[Cursor]:.  
+00006910: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
+00006920: 616c 6c20 646f 6375 6d65 6e74 7320 7468  all documents th
+00006930: 6174 206d 6174 6368 2074 6865 2067 6976  at match the giv
+00006940: 656e 2066 696c 7465 7273 2e0a 0a20 2020  en filters...   
+00006950: 2020 2020 203a 7061 7261 6d20 6669 6c74       :param filt
+00006960: 6572 733a 2044 6f63 756d 656e 7420 6669  ers: Document fi
+00006970: 6c74 6572 732e 0a20 2020 2020 2020 203a  lters..        :
+00006980: 7479 7065 2066 696c 7465 7273 3a20 6469  type filters: di
+00006990: 6374 0a20 2020 2020 2020 203a 7061 7261  ct.        :para
+000069a0: 6d20 736b 6970 3a20 4e75 6d62 6572 206f  m skip: Number o
+000069b0: 6620 646f 6375 6d65 6e74 7320 746f 2073  f documents to s
+000069c0: 6b69 702e 0a20 2020 2020 2020 203a 7479  kip..        :ty
+000069d0: 7065 2073 6b69 703a 2069 6e74 207c 204e  pe skip: int | N
+000069e0: 6f6e 650a 2020 2020 2020 2020 3a70 6172  one.        :par
+000069f0: 616d 206c 696d 6974 3a20 4d61 7820 6e75  am limit: Max nu
+00006a00: 6d62 6572 206f 6620 646f 6375 6d65 6e74  mber of document
+00006a10: 7320 7265 7475 726e 6564 2e0a 2020 2020  s returned..    
+00006a20: 2020 2020 3a74 7970 6520 6c69 6d69 743a      :type limit:
+00006a30: 2069 6e74 207c 204e 6f6e 650a 2020 2020   int | None.    
+00006a40: 2020 2020 3a70 6172 616d 2061 6c6c 6f77      :param allow
+00006a50: 5f64 6972 7479 5f72 6561 643a 2041 6c6c  _dirty_read: All
+00006a60: 6f77 2072 6561 6473 2066 726f 6d20 666f  ow reads from fo
+00006a70: 6c6c 6f77 6572 7320 696e 2061 2063 6c75  llowers in a clu
+00006a80: 7374 6572 2e0a 2020 2020 2020 2020 3a74  ster..        :t
+00006a90: 7970 6520 616c 6c6f 775f 6469 7274 795f  ype allow_dirty_
+00006aa0: 7265 6164 3a20 626f 6f6c 0a20 2020 2020  read: bool.     
+00006ab0: 2020 203a 7265 7475 726e 3a20 446f 6375     :return: Docu
+00006ac0: 6d65 6e74 2063 7572 736f 722e 0a20 2020  ment cursor..   
+00006ad0: 2020 2020 203a 7274 7970 653a 2061 7261       :rtype: ara
+00006ae0: 6e67 6f2e 6375 7273 6f72 2e43 7572 736f  ngo.cursor.Curso
+00006af0: 720a 2020 2020 2020 2020 3a72 6169 7365  r.        :raise
+00006b00: 2061 7261 6e67 6f2e 6578 6365 7074 696f   arango.exceptio
+00006b10: 6e73 2e44 6f63 756d 656e 7447 6574 4572  ns.DocumentGetEr
+00006b20: 726f 723a 2049 6620 7265 7472 6965 7661  ror: If retrieva
+00006b30: 6c20 6661 696c 732e 0a20 2020 2020 2020  l fails..       
+00006b40: 2022 2222 0a20 2020 2020 2020 2061 7373   """.        ass
+00006b50: 6572 7420 6973 696e 7374 616e 6365 2866  ert isinstance(f
+00006b60: 696c 7465 7273 2c20 6469 6374 292c 2022  ilters, dict), "
+00006b70: 6669 6c74 6572 7320 6d75 7374 2062 6520  filters must be 
+00006b80: 6120 6469 6374 220a 2020 2020 2020 2020  a dict".        
+00006b90: 6173 7365 7274 2069 735f 6e6f 6e65 5f6f  assert is_none_o
+00006ba0: 725f 696e 7428 736b 6970 292c 2022 736b  r_int(skip), "sk
+00006bb0: 6970 206d 7573 7420 6265 2061 206e 6f6e  ip must be a non
+00006bc0: 2d6e 6567 6174 6976 6520 696e 7422 0a20  -negative int". 
+00006bd0: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+00006be0: 5f6e 6f6e 655f 6f72 5f69 6e74 286c 696d  _none_or_int(lim
+00006bf0: 6974 292c 2022 6c69 6d69 7420 6d75 7374  it), "limit must
+00006c00: 2062 6520 6120 6e6f 6e2d 6e65 6761 7469   be a non-negati
+00006c10: 7665 2069 6e74 220a 0a20 2020 2020 2020  ve int"..       
+00006c20: 2073 6b69 705f 7661 6c20 3d20 736b 6970   skip_val = skip
+00006c30: 2069 6620 736b 6970 2069 7320 6e6f 7420   if skip is not 
+00006c40: 4e6f 6e65 2065 6c73 6520 300a 2020 2020  None else 0.    
+00006c50: 2020 2020 6c69 6d69 745f 7661 6c20 3d20      limit_val = 
+00006c60: 6c69 6d69 7420 6966 206c 696d 6974 2069  limit if limit i
+00006c70: 7320 6e6f 7420 4e6f 6e65 2065 6c73 6520  s not None else 
+00006c80: 226e 756c 6c22 0a20 2020 2020 2020 2071  "null".        q
+00006c90: 7565 7279 203d 2066 2222 220a 2020 2020  uery = f""".    
+00006ca0: 2020 2020 2020 2020 464f 5220 646f 6320          FOR doc 
+00006cb0: 494e 2040 4063 6f6c 6c65 6374 696f 6e0a  IN @@collection.
+00006cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006cd0: 7b62 7569 6c64 5f66 696c 7465 725f 636f  {build_filter_co
+00006ce0: 6e64 6974 696f 6e73 2866 696c 7465 7273  nditions(filters
+00006cf0: 297d 0a20 2020 2020 2020 2020 2020 2020  )}.             
+00006d00: 2020 204c 494d 4954 207b 736b 6970 5f76     LIMIT {skip_v
+00006d10: 616c 7d2c 207b 6c69 6d69 745f 7661 6c7d  al}, {limit_val}
+00006d20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006d30: 2052 4554 5552 4e20 646f 630a 2020 2020   RETURN doc.    
+00006d40: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+00006d50: 2062 696e 645f 7661 7273 203d 207b 2240   bind_vars = {"@
+00006d60: 636f 6c6c 6563 7469 6f6e 223a 2073 656c  collection": sel
+00006d70: 662e 6e61 6d65 7d0a 0a20 2020 2020 2020  f.name}..       
+00006d80: 2072 6571 7565 7374 203d 2052 6571 7565   request = Reque
+00006d90: 7374 280a 2020 2020 2020 2020 2020 2020  st(.            
+00006da0: 6d65 7468 6f64 3d22 706f 7374 222c 0a20  method="post",. 
+00006db0: 2020 2020 2020 2020 2020 2065 6e64 706f             endpo
+00006dc0: 696e 743d 222f 5f61 7069 2f63 7572 736f  int="/_api/curso
+00006dd0: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
+00006de0: 6461 7461 3d7b 2271 7565 7279 223a 2071  data={"query": q
+00006df0: 7565 7279 2c20 2262 696e 6456 6172 7322  uery, "bindVars"
+00006e00: 3a20 6269 6e64 5f76 6172 732c 2022 636f  : bind_vars, "co
+00006e10: 756e 7422 3a20 5472 7565 7d2c 0a20 2020  unt": True},.   
+00006e20: 2020 2020 2020 2020 2072 6561 643d 7365           read=se
+00006e30: 6c66 2e6e 616d 652c 0a20 2020 2020 2020  lf.name,.       
+00006e40: 2020 2020 2068 6561 6465 7273 3d7b 2278       headers={"x
+00006e50: 2d61 7261 6e67 6f2d 616c 6c6f 772d 6469  -arango-allow-di
+00006e60: 7274 792d 7265 6164 223a 2022 7472 7565  rty-read": "true
+00006e70: 227d 2069 6620 616c 6c6f 775f 6469 7274  "} if allow_dirt
+00006e80: 795f 7265 6164 2065 6c73 6520 4e6f 6e65  y_read else None
+00006e90: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+00006ea0: 2020 2020 2064 6566 2072 6573 706f 6e73       def respons
+00006eb0: 655f 6861 6e64 6c65 7228 7265 7370 3a20  e_handler(resp: 
+00006ec0: 5265 7370 6f6e 7365 2920 2d3e 2043 7572  Response) -> Cur
+00006ed0: 736f 723a 0a20 2020 2020 2020 2020 2020  sor:.           
+00006ee0: 2069 6620 6e6f 7420 7265 7370 2e69 735f   if not resp.is_
+00006ef0: 7375 6363 6573 733a 0a20 2020 2020 2020  success:.       
+00006f00: 2020 2020 2020 2020 2072 6169 7365 2044           raise D
+00006f10: 6f63 756d 656e 7447 6574 4572 726f 7228  ocumentGetError(
+00006f20: 7265 7370 2c20 7265 7175 6573 7429 0a20  resp, request). 
+00006f30: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00006f40: 6e20 4375 7273 6f72 2873 656c 662e 5f63  n Cursor(self._c
+00006f50: 6f6e 6e2c 2072 6573 702e 626f 6479 290a  onn, resp.body).
+00006f60: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00006f70: 7365 6c66 2e5f 6578 6563 7574 6528 7265  self._execute(re
+00006f80: 7175 6573 742c 2072 6573 706f 6e73 655f  quest, response_
+00006f90: 6861 6e64 6c65 7229 0a0a 2020 2020 6465  handler)..    de
+00006fa0: 6620 6669 6e64 5f6e 6561 7228 0a20 2020  f find_near(.   
+00006fb0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00006fc0: 2020 206c 6174 6974 7564 653a 204e 756d     latitude: Num
+00006fd0: 6265 722c 0a20 2020 2020 2020 206c 6f6e  ber,.        lon
+00006fe0: 6769 7475 6465 3a20 4e75 6d62 6572 2c0a  gitude: Number,.
+00006ff0: 2020 2020 2020 2020 6c69 6d69 743a 204f          limit: O
+00007000: 7074 696f 6e61 6c5b 696e 745d 203d 204e  ptional[int] = N
+00007010: 6f6e 652c 0a20 2020 2020 2020 2061 6c6c  one,.        all
+00007020: 6f77 5f64 6972 7479 5f72 6561 643a 2062  ow_dirty_read: b
+00007030: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
+00007040: 2029 202d 3e20 5265 7375 6c74 5b43 7572   ) -> Result[Cur
+00007050: 736f 725d 3a0a 2020 2020 2020 2020 2222  sor]:.        ""
+00007060: 2252 6574 7572 6e20 646f 6375 6d65 6e74  "Return document
+00007070: 7320 6e65 6172 2061 2067 6976 656e 2063  s near a given c
+00007080: 6f6f 7264 696e 6174 652e 0a0a 2020 2020  oordinate...    
+00007090: 2020 2020 446f 6375 6d65 6e74 7320 7265      Documents re
+000070a0: 7475 726e 6564 2061 7265 2073 6f72 7465  turned are sorte
+000070b0: 6420 6163 636f 7264 696e 6720 746f 2064  d according to d
+000070c0: 6973 7461 6e63 652c 2077 6974 6820 7468  istance, with th
+000070d0: 6520 6e65 6172 6573 740a 2020 2020 2020  e nearest.      
+000070e0: 2020 646f 6375 6d65 6e74 2062 6569 6e67    document being
+000070f0: 2074 6865 2066 6972 7374 2e20 4966 2074   the first. If t
+00007100: 6865 7265 2061 7265 2064 6f63 756d 656e  here are documen
+00007110: 7473 206f 6620 6571 7561 6c20 6469 7374  ts of equal dist
+00007120: 616e 6365 2c0a 2020 2020 2020 2020 7468  ance,.        th
+00007130: 6579 2061 7265 2072 616e 646f 6d6c 7920  ey are randomly 
+00007140: 6368 6f73 656e 2066 726f 6d20 7468 6520  chosen from the 
+00007150: 7365 7420 756e 7469 6c20 7468 6520 6c69  set until the li
+00007160: 6d69 7420 6973 2072 6561 6368 6564 2e20  mit is reached. 
+00007170: 4120 6765 6f0a 2020 2020 2020 2020 696e  A geo.        in
+00007180: 6465 7820 6d75 7374 2062 6520 6465 6669  dex must be defi
+00007190: 6e65 6420 696e 2074 6865 2063 6f6c 6c65  ned in the colle
+000071a0: 6374 696f 6e20 746f 2075 7365 2074 6869  ction to use thi
+000071b0: 7320 6d65 7468 6f64 2e0a 0a20 2020 2020  s method...     
+000071c0: 2020 203a 7061 7261 6d20 6c61 7469 7475     :param latitu
+000071d0: 6465 3a20 4c61 7469 7475 6465 2e0a 2020  de: Latitude..  
+000071e0: 2020 2020 2020 3a74 7970 6520 6c61 7469        :type lati
+000071f0: 7475 6465 3a20 696e 7420 7c20 666c 6f61  tude: int | floa
+00007200: 740a 2020 2020 2020 2020 3a70 6172 616d  t.        :param
+00007210: 206c 6f6e 6769 7475 6465 3a20 4c6f 6e67   longitude: Long
+00007220: 6974 7564 652e 0a20 2020 2020 2020 203a  itude..        :
+00007230: 7479 7065 206c 6f6e 6769 7475 6465 3a20  type longitude: 
+00007240: 696e 7420 7c20 666c 6f61 740a 2020 2020  int | float.    
+00007250: 2020 2020 3a70 6172 616d 206c 696d 6974      :param limit
+00007260: 3a20 4d61 7820 6e75 6d62 6572 206f 6620  : Max number of 
+00007270: 646f 6375 6d65 6e74 7320 7265 7475 726e  documents return
+00007280: 6564 2e0a 2020 2020 2020 2020 3a74 7970  ed..        :typ
+00007290: 6520 6c69 6d69 743a 2069 6e74 207c 204e  e limit: int | N
+000072a0: 6f6e 650a 2020 2020 2020 2020 3a70 6172  one.        :par
+000072b0: 616d 2061 6c6c 6f77 5f64 6972 7479 5f72  am allow_dirty_r
+000072c0: 6561 643a 2041 6c6c 6f77 2072 6561 6473  ead: Allow reads
+000072d0: 2066 726f 6d20 666f 6c6c 6f77 6572 7320   from followers 
+000072e0: 696e 2061 2063 6c75 7374 6572 2e0a 2020  in a cluster..  
+000072f0: 2020 2020 2020 3a74 7970 6520 616c 6c6f        :type allo
+00007300: 775f 6469 7274 795f 7265 6164 3a20 626f  w_dirty_read: bo
+00007310: 6f6c 0a20 2020 2020 2020 203a 7265 7475  ol.        :retu
+00007320: 726e 733a 2044 6f63 756d 656e 7420 6375  rns: Document cu
+00007330: 7273 6f72 2e0a 2020 2020 2020 2020 3a72  rsor..        :r
+00007340: 7479 7065 3a20 6172 616e 676f 2e63 7572  type: arango.cur
+00007350: 736f 722e 4375 7273 6f72 0a20 2020 2020  sor.Cursor.     
+00007360: 2020 203a 7261 6973 6573 2061 7261 6e67     :raises arang
+00007370: 6f2e 6578 6365 7074 696f 6e73 2e44 6f63  o.exceptions.Doc
+00007380: 756d 656e 7447 6574 4572 726f 723a 2049  umentGetError: I
+00007390: 6620 7265 7472 6965 7661 6c20 6661 696c  f retrieval fail
+000073a0: 732e 0a20 2020 2020 2020 2022 2222 0a20  s..        """. 
+000073b0: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+000073c0: 696e 7374 616e 6365 286c 6174 6974 7564  instance(latitud
+000073d0: 652c 204e 756d 6265 7229 2c20 226c 6174  e, Number), "lat
+000073e0: 6974 7564 6520 6d75 7374 2062 6520 6120  itude must be a 
+000073f0: 6e75 6d62 6572 220a 2020 2020 2020 2020  number".        
+00007400: 6173 7365 7274 2069 7369 6e73 7461 6e63  assert isinstanc
+00007410: 6528 6c6f 6e67 6974 7564 652c 204e 756d  e(longitude, Num
+00007420: 6265 7229 2c20 226c 6f6e 6769 7475 6465  ber), "longitude
+00007430: 206d 7573 7420 6265 2061 206e 756d 6265   must be a numbe
+00007440: 7222 0a20 2020 2020 2020 2061 7373 6572  r".        asser
+00007450: 7420 6973 5f6e 6f6e 655f 6f72 5f69 6e74  t is_none_or_int
+00007460: 286c 696d 6974 292c 2022 6c69 6d69 7420  (limit), "limit 
+00007470: 6d75 7374 2062 6520 6120 6e6f 6e2d 6e65  must be a non-ne
+00007480: 6761 7469 7665 2069 6e74 220a 0a20 2020  gative int"..   
+00007490: 2020 2020 2071 7565 7279 203d 2022 2222       query = """
+000074a0: 0a20 2020 2020 2020 2046 4f52 2064 6f63  .        FOR doc
+000074b0: 2049 4e20 4e45 4152 2840 636f 6c6c 6563   IN NEAR(@collec
+000074c0: 7469 6f6e 2c20 406c 6174 6974 7564 652c  tion, @latitude,
+000074d0: 2040 6c6f 6e67 6974 7564 657b 7d29 0a20   @longitude{}). 
+000074e0: 2020 2020 2020 2020 2020 2052 4554 5552             RETUR
+000074f0: 4e20 646f 630a 2020 2020 2020 2020 2222  N doc.        ""
+00007500: 222e 666f 726d 6174 280a 2020 2020 2020  ".format(.      
+00007510: 2020 2020 2020 2222 2069 6620 6c69 6d69        "" if limi
+00007520: 7420 6973 204e 6f6e 6520 656c 7365 2022  t is None else "
+00007530: 2c20 406c 696d 6974 2022 0a20 2020 2020  , @limit ".     
+00007540: 2020 2029 0a0a 2020 2020 2020 2020 6269     )..        bi
+00007550: 6e64 5f76 6172 7320 3d20 7b0a 2020 2020  nd_vars = {.    
+00007560: 2020 2020 2020 2020 2263 6f6c 6c65 6374          "collect
+00007570: 696f 6e22 3a20 7365 6c66 2e5f 6e61 6d65  ion": self._name
+00007580: 2c0a 2020 2020 2020 2020 2020 2020 226c  ,.            "l
+00007590: 6174 6974 7564 6522 3a20 6c61 7469 7475  atitude": latitu
+000075a0: 6465 2c0a 2020 2020 2020 2020 2020 2020  de,.            
+000075b0: 226c 6f6e 6769 7475 6465 223a 206c 6f6e  "longitude": lon
+000075c0: 6769 7475 6465 2c0a 2020 2020 2020 2020  gitude,.        
+000075d0: 7d0a 2020 2020 2020 2020 6966 206c 696d  }.        if lim
+000075e0: 6974 2069 7320 6e6f 7420 4e6f 6e65 3a0a  it is not None:.
+000075f0: 2020 2020 2020 2020 2020 2020 6269 6e64              bind
+00007600: 5f76 6172 735b 226c 696d 6974 225d 203d  _vars["limit"] =
+00007610: 206c 696d 6974 0a0a 2020 2020 2020 2020   limit..        
+00007620: 7265 7175 6573 7420 3d20 5265 7175 6573  request = Reques
+00007630: 7428 0a20 2020 2020 2020 2020 2020 206d  t(.            m
+00007640: 6574 686f 643d 2270 6f73 7422 2c0a 2020  ethod="post",.  
+00007650: 2020 2020 2020 2020 2020 656e 6470 6f69            endpoi
+00007660: 6e74 3d22 2f5f 6170 692f 6375 7273 6f72  nt="/_api/cursor
+00007670: 222c 0a20 2020 2020 2020 2020 2020 2064  ",.            d
+00007680: 6174 613d 7b22 7175 6572 7922 3a20 7175  ata={"query": qu
+00007690: 6572 792c 2022 6269 6e64 5661 7273 223a  ery, "bindVars":
+000076a0: 2062 696e 645f 7661 7273 2c20 2263 6f75   bind_vars, "cou
+000076b0: 6e74 223a 2054 7275 657d 2c0a 2020 2020  nt": True},.    
+000076c0: 2020 2020 2020 2020 7265 6164 3d73 656c          read=sel
+000076d0: 662e 6e61 6d65 2c0a 2020 2020 2020 2020  f.name,.        
+000076e0: 2020 2020 6865 6164 6572 733d 7b22 782d      headers={"x-
+000076f0: 6172 616e 676f 2d61 6c6c 6f77 2d64 6972  arango-allow-dir
+00007700: 7479 2d72 6561 6422 3a20 2274 7275 6522  ty-read": "true"
+00007710: 7d20 6966 2061 6c6c 6f77 5f64 6972 7479  } if allow_dirty
+00007720: 5f72 6561 6420 656c 7365 204e 6f6e 652c  _read else None,
+00007730: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00007740: 2020 2020 6465 6620 7265 7370 6f6e 7365      def response
+00007750: 5f68 616e 646c 6572 2872 6573 703a 2052  _handler(resp: R
+00007760: 6573 706f 6e73 6529 202d 3e20 4375 7273  esponse) -> Curs
+00007770: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
+00007780: 6966 206e 6f74 2072 6573 702e 6973 5f73  if not resp.is_s
+00007790: 7563 6365 7373 3a0a 2020 2020 2020 2020  uccess:.        
+000077a0: 2020 2020 2020 2020 7261 6973 6520 446f          raise Do
+000077b0: 6375 6d65 6e74 4765 7445 7272 6f72 2872  cumentGetError(r
+000077c0: 6573 702c 2072 6571 7565 7374 290a 2020  esp, request).  
+000077d0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000077e0: 2043 7572 736f 7228 7365 6c66 2e5f 636f   Cursor(self._co
+000077f0: 6e6e 2c20 7265 7370 2e62 6f64 7929 0a0a  nn, resp.body)..
+00007800: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00007810: 656c 662e 5f65 7865 6375 7465 2872 6571  elf._execute(req
+00007820: 7565 7374 2c20 7265 7370 6f6e 7365 5f68  uest, response_h
+00007830: 616e 646c 6572 290a 0a20 2020 2064 6566  andler)..    def
+00007840: 2066 696e 645f 696e 5f72 616e 6765 280a   find_in_range(.
+00007850: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00007860: 2020 2020 2020 6669 656c 643a 2073 7472        field: str
+00007870: 2c0a 2020 2020 2020 2020 6c6f 7765 723a  ,.        lower:
+00007880: 2069 6e74 2c0a 2020 2020 2020 2020 7570   int,.        up
+00007890: 7065 723a 2069 6e74 2c0a 2020 2020 2020  per: int,.      
+000078a0: 2020 736b 6970 3a20 4f70 7469 6f6e 616c    skip: Optional
+000078b0: 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a 2020  [int] = None,.  
+000078c0: 2020 2020 2020 6c69 6d69 743a 204f 7074        limit: Opt
+000078d0: 696f 6e61 6c5b 696e 745d 203d 204e 6f6e  ional[int] = Non
+000078e0: 652c 0a20 2020 2020 2020 2061 6c6c 6f77  e,.        allow
+000078f0: 5f64 6972 7479 5f72 6561 643a 2062 6f6f  _dirty_read: boo
+00007900: 6c20 3d20 4661 6c73 652c 0a20 2020 2029  l = False,.    )
+00007910: 202d 3e20 5265 7375 6c74 5b43 7572 736f   -> Result[Curso
+00007920: 725d 3a0a 2020 2020 2020 2020 2222 2252  r]:.        """R
+00007930: 6574 7572 6e20 646f 6375 6d65 6e74 7320  eturn documents 
+00007940: 7769 7468 696e 2061 2067 6976 656e 2072  within a given r
+00007950: 616e 6765 2069 6e20 6120 7261 6e64 6f6d  ange in a random
+00007960: 206f 7264 6572 2e0a 0a20 2020 2020 2020   order...       
+00007970: 2041 2073 6b69 706c 6973 7420 696e 6465   A skiplist inde
+00007980: 7820 6d75 7374 2062 6520 6465 6669 6e65  x must be define
+00007990: 6420 696e 2074 6865 2063 6f6c 6c65 6374  d in the collect
+000079a0: 696f 6e20 746f 2075 7365 2074 6869 7320  ion to use this 
+000079b0: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
+000079c0: 203a 7061 7261 6d20 6669 656c 643a 2044   :param field: D
+000079d0: 6f63 756d 656e 7420 6669 656c 6420 6e61  ocument field na
+000079e0: 6d65 2e0a 2020 2020 2020 2020 3a74 7970  me..        :typ
+000079f0: 6520 6669 656c 643a 2073 7472 0a20 2020  e field: str.   
+00007a00: 2020 2020 203a 7061 7261 6d20 6c6f 7765       :param lowe
+00007a10: 723a 204c 6f77 6572 2062 6f75 6e64 2028  r: Lower bound (
+00007a20: 696e 636c 7573 6976 6529 2e0a 2020 2020  inclusive)..    
+00007a30: 2020 2020 3a74 7970 6520 6c6f 7765 723a      :type lower:
+00007a40: 2069 6e74 0a20 2020 2020 2020 203a 7061   int.        :pa
+00007a50: 7261 6d20 7570 7065 723a 2055 7070 6572  ram upper: Upper
+00007a60: 2062 6f75 6e64 2028 6578 636c 7573 6976   bound (exclusiv
+00007a70: 6529 2e0a 2020 2020 2020 2020 3a74 7970  e)..        :typ
+00007a80: 6520 7570 7065 723a 2069 6e74 0a20 2020  e upper: int.   
+00007a90: 2020 2020 203a 7061 7261 6d20 736b 6970       :param skip
+00007aa0: 3a20 4e75 6d62 6572 206f 6620 646f 6375  : Number of docu
+00007ab0: 6d65 6e74 7320 746f 2073 6b69 702e 0a20  ments to skip.. 
+00007ac0: 2020 2020 2020 203a 7479 7065 2073 6b69         :type ski
+00007ad0: 703a 2069 6e74 207c 204e 6f6e 650a 2020  p: int | None.  
+00007ae0: 2020 2020 2020 3a70 6172 616d 206c 696d        :param lim
+00007af0: 6974 3a20 4d61 7820 6e75 6d62 6572 206f  it: Max number o
+00007b00: 6620 646f 6375 6d65 6e74 7320 7265 7475  f documents retu
+00007b10: 726e 6564 2e0a 2020 2020 2020 2020 3a74  rned..        :t
+00007b20: 7970 6520 6c69 6d69 743a 2069 6e74 207c  ype limit: int |
+00007b30: 204e 6f6e 650a 2020 2020 2020 2020 3a70   None.        :p
+00007b40: 6172 616d 2061 6c6c 6f77 5f64 6972 7479  aram allow_dirty
+00007b50: 5f72 6561 643a 2041 6c6c 6f77 2072 6561  _read: Allow rea
+00007b60: 6473 2066 726f 6d20 666f 6c6c 6f77 6572  ds from follower
+00007b70: 7320 696e 2061 2063 6c75 7374 6572 2e0a  s in a cluster..
+00007b80: 2020 2020 2020 2020 3a74 7970 6520 616c          :type al
+00007b90: 6c6f 775f 6469 7274 795f 7265 6164 3a20  low_dirty_read: 
+00007ba0: 626f 6f6c 0a20 2020 2020 2020 203a 7265  bool.        :re
+00007bb0: 7475 726e 733a 2044 6f63 756d 656e 7420  turns: Document 
+00007bc0: 6375 7273 6f72 2e0a 2020 2020 2020 2020  cursor..        
+00007bd0: 3a72 7479 7065 3a20 6172 616e 676f 2e63  :rtype: arango.c
+00007be0: 7572 736f 722e 4375 7273 6f72 0a20 2020  ursor.Cursor.   
+00007bf0: 2020 2020 203a 7261 6973 6573 2061 7261       :raises ara
+00007c00: 6e67 6f2e 6578 6365 7074 696f 6e73 2e44  ngo.exceptions.D
+00007c10: 6f63 756d 656e 7447 6574 4572 726f 723a  ocumentGetError:
+00007c20: 2049 6620 7265 7472 6965 7661 6c20 6661   If retrieval fa
+00007c30: 696c 732e 0a20 2020 2020 2020 2022 2222  ils..        """
+00007c40: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00007c50: 6973 5f6e 6f6e 655f 6f72 5f69 6e74 2873  is_none_or_int(s
+00007c60: 6b69 7029 2c20 2273 6b69 7020 6d75 7374  kip), "skip must
+00007c70: 2062 6520 6120 6e6f 6e2d 6e65 6761 7469   be a non-negati
+00007c80: 7665 2069 6e74 220a 2020 2020 2020 2020  ve int".        
+00007c90: 6173 7365 7274 2069 735f 6e6f 6e65 5f6f  assert is_none_o
+00007ca0: 725f 696e 7428 6c69 6d69 7429 2c20 226c  r_int(limit), "l
+00007cb0: 696d 6974 206d 7573 7420 6265 2061 206e  imit must be a n
+00007cc0: 6f6e 2d6e 6567 6174 6976 6520 696e 7422  on-negative int"
+00007cd0: 0a0a 2020 2020 2020 2020 6269 6e64 5f76  ..        bind_v
+00007ce0: 6172 7320 3d20 7b0a 2020 2020 2020 2020  ars = {.        
+00007cf0: 2020 2020 2240 636f 6c6c 6563 7469 6f6e      "@collection
+00007d00: 223a 2073 656c 662e 5f6e 616d 652c 0a20  ": self._name,. 
+00007d10: 2020 2020 2020 2020 2020 2022 6669 656c             "fiel
+00007d20: 6422 3a20 6669 656c 642c 0a20 2020 2020  d": field,.     
+00007d30: 2020 2020 2020 2022 6c6f 7765 7222 3a20         "lower": 
+00007d40: 6c6f 7765 722c 0a20 2020 2020 2020 2020  lower,.         
+00007d50: 2020 2022 7570 7065 7222 3a20 7570 7065     "upper": uppe
+00007d60: 722c 0a20 2020 2020 2020 2020 2020 2022  r,.            "
+00007d70: 736b 6970 223a 2030 2069 6620 736b 6970  skip": 0 if skip
+00007d80: 2069 7320 4e6f 6e65 2065 6c73 6520 736b   is None else sk
+00007d90: 6970 2c0a 2020 2020 2020 2020 2020 2020  ip,.            
+00007da0: 226c 696d 6974 223a 2032 3134 3734 3833  "limit": 2147483
+00007db0: 3634 3720 6966 206c 696d 6974 2069 7320  647 if limit is 
+00007dc0: 4e6f 6e65 2065 6c73 6520 6c69 6d69 742c  None else limit,
+00007dd0: 2020 2320 3220 5e20 3331 202d 2031 0a20    # 2 ^ 31 - 1. 
+00007de0: 2020 2020 2020 207d 0a0a 2020 2020 2020         }..      
+00007df0: 2020 7175 6572 7920 3d20 2222 220a 2020    query = """.  
+00007e00: 2020 2020 2020 464f 5220 646f 6320 494e        FOR doc IN
+00007e10: 2040 4063 6f6c 6c65 6374 696f 6e0a 2020   @@collection.  
+00007e20: 2020 2020 2020 2020 2020 4649 4c54 4552            FILTER
+00007e30: 2064 6f63 2e40 6669 656c 6420 3e3d 2040   doc.@field >= @
+00007e40: 6c6f 7765 7220 2626 2064 6f63 2e40 6669  lower && doc.@fi
+00007e50: 656c 6420 3c20 4075 7070 6572 0a20 2020  eld < @upper.   
+00007e60: 2020 2020 2020 2020 204c 494d 4954 2040           LIMIT @
+00007e70: 736b 6970 2c20 406c 696d 6974 0a20 2020  skip, @limit.   
+00007e80: 2020 2020 2020 2020 2052 4554 5552 4e20           RETURN 
+00007e90: 646f 630a 2020 2020 2020 2020 2222 220a  doc.        """.
+00007ea0: 0a20 2020 2020 2020 2072 6571 7565 7374  .        request
+00007eb0: 203d 2052 6571 7565 7374 280a 2020 2020   = Request(.    
+00007ec0: 2020 2020 2020 2020 6d65 7468 6f64 3d22          method="
+00007ed0: 706f 7374 222c 0a20 2020 2020 2020 2020  post",.         
+00007ee0: 2020 2065 6e64 706f 696e 743d 222f 5f61     endpoint="/_a
+00007ef0: 7069 2f63 7572 736f 7222 2c0a 2020 2020  pi/cursor",.    
+00007f00: 2020 2020 2020 2020 6461 7461 3d7b 2271          data={"q
+00007f10: 7565 7279 223a 2071 7565 7279 2c20 2262  uery": query, "b
+00007f20: 696e 6456 6172 7322 3a20 6269 6e64 5f76  indVars": bind_v
+00007f30: 6172 732c 2022 636f 756e 7422 3a20 5472  ars, "count": Tr
+00007f40: 7565 7d2c 0a20 2020 2020 2020 2020 2020  ue},.           
+00007f50: 2072 6561 643d 7365 6c66 2e6e 616d 652c   read=self.name,
+00007f60: 0a20 2020 2020 2020 2020 2020 2068 6561  .            hea
+00007f70: 6465 7273 3d7b 2278 2d61 7261 6e67 6f2d  ders={"x-arango-
+00007f80: 616c 6c6f 772d 6469 7274 792d 7265 6164  allow-dirty-read
+00007f90: 223a 2022 7472 7565 227d 2069 6620 616c  ": "true"} if al
+00007fa0: 6c6f 775f 6469 7274 795f 7265 6164 2065  low_dirty_read e
+00007fb0: 6c73 6520 4e6f 6e65 2c0a 2020 2020 2020  lse None,.      
+00007fc0: 2020 290a 0a20 2020 2020 2020 2064 6566    )..        def
+00007fd0: 2072 6573 706f 6e73 655f 6861 6e64 6c65   response_handle
+00007fe0: 7228 7265 7370 3a20 5265 7370 6f6e 7365  r(resp: Response
+00007ff0: 2920 2d3e 2043 7572 736f 723a 0a20 2020  ) -> Cursor:.   
+00008000: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+00008010: 7265 7370 2e69 735f 7375 6363 6573 733a  resp.is_success:
+00008020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008030: 2072 6169 7365 2044 6f63 756d 656e 7447   raise DocumentG
+00008040: 6574 4572 726f 7228 7265 7370 2c20 7265  etError(resp, re
+00008050: 7175 6573 7429 0a20 2020 2020 2020 2020  quest).         
+00008060: 2020 2072 6574 7572 6e20 4375 7273 6f72     return Cursor
+00008070: 2873 656c 662e 5f63 6f6e 6e2c 2072 6573  (self._conn, res
+00008080: 702e 626f 6479 290a 0a20 2020 2020 2020  p.body)..       
+00008090: 2072 6574 7572 6e20 7365 6c66 2e5f 6578   return self._ex
+000080a0: 6563 7574 6528 7265 7175 6573 742c 2072  ecute(request, r
+000080b0: 6573 706f 6e73 655f 6861 6e64 6c65 7229  esponse_handler)
+000080c0: 0a0a 2020 2020 6465 6620 6669 6e64 5f69  ..    def find_i
+000080d0: 6e5f 7261 6469 7573 280a 2020 2020 2020  n_radius(.      
+000080e0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+000080f0: 6c61 7469 7475 6465 3a20 4e75 6d62 6572  latitude: Number
+00008100: 2c0a 2020 2020 2020 2020 6c6f 6e67 6974  ,.        longit
+00008110: 7564 653a 204e 756d 6265 722c 0a20 2020  ude: Number,.   
+00008120: 2020 2020 2072 6164 6975 733a 204e 756d       radius: Num
+00008130: 6265 722c 0a20 2020 2020 2020 2064 6973  ber,.        dis
+00008140: 7461 6e63 655f 6669 656c 643a 204f 7074  tance_field: Opt
+00008150: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
+00008160: 652c 0a20 2020 2020 2020 2061 6c6c 6f77  e,.        allow
+00008170: 5f64 6972 7479 5f72 6561 643a 2062 6f6f  _dirty_read: boo
+00008180: 6c20 3d20 4661 6c73 652c 0a20 2020 2029  l = False,.    )
+00008190: 202d 3e20 5265 7375 6c74 5b43 7572 736f   -> Result[Curso
+000081a0: 725d 3a0a 2020 2020 2020 2020 2222 2252  r]:.        """R
+000081b0: 6574 7572 6e20 646f 6375 6d65 6e74 7320  eturn documents 
+000081c0: 7769 7468 696e 2061 2067 6976 656e 2072  within a given r
+000081d0: 6164 6975 7320 6172 6f75 6e64 2061 2063  adius around a c
+000081e0: 6f6f 7264 696e 6174 652e 0a0a 2020 2020  oordinate...    
+000081f0: 2020 2020 4120 6765 6f20 696e 6465 7820      A geo index 
+00008200: 6d75 7374 2062 6520 6465 6669 6e65 6420  must be defined 
+00008210: 696e 2074 6865 2063 6f6c 6c65 6374 696f  in the collectio
+00008220: 6e20 746f 2075 7365 2074 6869 7320 6d65  n to use this me
+00008230: 7468 6f64 2e0a 0a20 2020 2020 2020 203a  thod...        :
+00008240: 7061 7261 6d20 6c61 7469 7475 6465 3a20  param latitude: 
+00008250: 4c61 7469 7475 6465 2e0a 2020 2020 2020  Latitude..      
+00008260: 2020 3a74 7970 6520 6c61 7469 7475 6465    :type latitude
+00008270: 3a20 696e 7420 7c20 666c 6f61 740a 2020  : int | float.  
+00008280: 2020 2020 2020 3a70 6172 616d 206c 6f6e        :param lon
+00008290: 6769 7475 6465 3a20 4c6f 6e67 6974 7564  gitude: Longitud
+000082a0: 652e 0a20 2020 2020 2020 203a 7479 7065  e..        :type
+000082b0: 206c 6f6e 6769 7475 6465 3a20 696e 7420   longitude: int 
+000082c0: 7c20 666c 6f61 740a 2020 2020 2020 2020  | float.        
+000082d0: 3a70 6172 616d 2072 6164 6975 733a 204d  :param radius: M
+000082e0: 6178 2072 6164 6975 732e 0a20 2020 2020  ax radius..     
+000082f0: 2020 203a 7479 7065 2072 6164 6975 733a     :type radius:
+00008300: 2069 6e74 207c 2066 6c6f 6174 0a20 2020   int | float.   
+00008310: 2020 2020 203a 7061 7261 6d20 6469 7374       :param dist
+00008320: 616e 6365 5f66 6965 6c64 3a20 446f 6375  ance_field: Docu
+00008330: 6d65 6e74 2066 6965 6c64 2075 7365 6420  ment field used 
+00008340: 746f 2069 6e64 6963 6174 6520 7468 6520  to indicate the 
+00008350: 6469 7374 616e 6365 2074 6f0a 2020 2020  distance to.    
+00008360: 2020 2020 2020 2020 7468 6520 6769 7665          the give
+00008370: 6e20 636f 6f72 6469 6e61 7465 2e20 5468  n coordinate. Th
+00008380: 6973 2070 6172 616d 6574 6572 2069 7320  is parameter is 
+00008390: 6967 6e6f 7265 6420 696e 2074 7261 6e73  ignored in trans
+000083a0: 6163 7469 6f6e 732e 0a20 2020 2020 2020  actions..       
+000083b0: 203a 7479 7065 2064 6973 7461 6e63 655f   :type distance_
+000083c0: 6669 656c 643a 2073 7472 0a20 2020 2020  field: str.     
+000083d0: 2020 203a 7061 7261 6d20 616c 6c6f 775f     :param allow_
+000083e0: 6469 7274 795f 7265 6164 3a20 416c 6c6f  dirty_read: Allo
+000083f0: 7720 7265 6164 7320 6672 6f6d 2066 6f6c  w reads from fol
+00008400: 6c6f 7765 7273 2069 6e20 6120 636c 7573  lowers in a clus
+00008410: 7465 722e 0a20 2020 2020 2020 203a 7479  ter..        :ty
+00008420: 7065 2061 6c6c 6f77 5f64 6972 7479 5f72  pe allow_dirty_r
+00008430: 6561 643a 2062 6f6f 6c0a 2020 2020 2020  ead: bool.      
+00008440: 2020 3a72 6574 7572 6e73 3a20 446f 6375    :returns: Docu
+00008450: 6d65 6e74 2063 7572 736f 722e 0a20 2020  ment cursor..   
+00008460: 2020 2020 203a 7274 7970 653a 2061 7261       :rtype: ara
+00008470: 6e67 6f2e 6375 7273 6f72 2e43 7572 736f  ngo.cursor.Curso
+00008480: 720a 2020 2020 2020 2020 3a72 6169 7365  r.        :raise
+00008490: 7320 6172 616e 676f 2e65 7863 6570 7469  s arango.excepti
+000084a0: 6f6e 732e 446f 6375 6d65 6e74 4765 7445  ons.DocumentGetE
+000084b0: 7272 6f72 3a20 4966 2072 6574 7269 6576  rror: If retriev
+000084c0: 616c 2066 6169 6c73 2e0a 2020 2020 2020  al fails..      
+000084d0: 2020 2222 220a 2020 2020 2020 2020 6173    """.        as
+000084e0: 7365 7274 2069 7369 6e73 7461 6e63 6528  sert isinstance(
+000084f0: 6c61 7469 7475 6465 2c20 4e75 6d62 6572  latitude, Number
+00008500: 292c 2022 6c61 7469 7475 6465 206d 7573  ), "latitude mus
+00008510: 7420 6265 2061 206e 756d 6265 7222 0a20  t be a number". 
+00008520: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+00008530: 696e 7374 616e 6365 286c 6f6e 6769 7475  instance(longitu
+00008540: 6465 2c20 4e75 6d62 6572 292c 2022 6c6f  de, Number), "lo
+00008550: 6e67 6974 7564 6520 6d75 7374 2062 6520  ngitude must be 
+00008560: 6120 6e75 6d62 6572 220a 2020 2020 2020  a number".      
+00008570: 2020 6173 7365 7274 2069 7369 6e73 7461    assert isinsta
+00008580: 6e63 6528 7261 6469 7573 2c20 4e75 6d62  nce(radius, Numb
+00008590: 6572 292c 2022 7261 6469 7573 206d 7573  er), "radius mus
+000085a0: 7420 6265 2061 206e 756d 6265 7222 0a20  t be a number". 
+000085b0: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+000085c0: 5f6e 6f6e 655f 6f72 5f73 7472 2864 6973  _none_or_str(dis
+000085d0: 7461 6e63 655f 6669 656c 6429 2c20 2264  tance_field), "d
+000085e0: 6973 7461 6e63 655f 6669 656c 6420 6d75  istance_field mu
+000085f0: 7374 2062 6520 6120 7374 7222 0a0a 2020  st be a str"..  
+00008600: 2020 2020 2020 7175 6572 7920 3d20 2222        query = ""
+00008610: 220a 2020 2020 2020 2020 464f 5220 646f  ".        FOR do
+00008620: 6320 494e 2057 4954 4849 4e28 4040 636f  c IN WITHIN(@@co
+00008630: 6c6c 6563 7469 6f6e 2c20 406c 6174 6974  llection, @latit
+00008640: 7564 652c 2040 6c6f 6e67 6974 7564 652c  ude, @longitude,
+00008650: 2040 7261 6469 7573 7b7d 290a 2020 2020   @radius{}).    
+00008660: 2020 2020 2020 2020 5245 5455 524e 2064          RETURN d
+00008670: 6f63 0a20 2020 2020 2020 2022 2222 2e66  oc.        """.f
+00008680: 6f72 6d61 7428 0a20 2020 2020 2020 2020  ormat(.         
+00008690: 2020 2022 2220 6966 2064 6973 7461 6e63     "" if distanc
+000086a0: 655f 6669 656c 6420 6973 204e 6f6e 6520  e_field is None 
+000086b0: 656c 7365 2022 2c20 4064 6973 7461 6e63  else ", @distanc
+000086c0: 6522 0a20 2020 2020 2020 2029 0a0a 2020  e".        )..  
+000086d0: 2020 2020 2020 6269 6e64 5f76 6172 7320        bind_vars 
+000086e0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+000086f0: 2240 636f 6c6c 6563 7469 6f6e 223a 2073  "@collection": s
+00008700: 656c 662e 5f6e 616d 652c 0a20 2020 2020  elf._name,.     
+00008710: 2020 2020 2020 2022 6c61 7469 7475 6465         "latitude
+00008720: 223a 206c 6174 6974 7564 652c 0a20 2020  ": latitude,.   
+00008730: 2020 2020 2020 2020 2022 6c6f 6e67 6974           "longit
+00008740: 7564 6522 3a20 6c6f 6e67 6974 7564 652c  ude": longitude,
+00008750: 0a20 2020 2020 2020 2020 2020 2022 7261  .            "ra
+00008760: 6469 7573 223a 2072 6164 6975 732c 0a20  dius": radius,. 
+00008770: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+00008780: 2069 6620 6469 7374 616e 6365 5f66 6965   if distance_fie
+00008790: 6c64 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ld is not None:.
+000087a0: 2020 2020 2020 2020 2020 2020 6269 6e64              bind
+000087b0: 5f76 6172 735b 2264 6973 7461 6e63 6522  _vars["distance"
+000087c0: 5d20 3d20 6469 7374 616e 6365 5f66 6965  ] = distance_fie
+000087d0: 6c64 0a0a 2020 2020 2020 2020 7265 7175  ld..        requ
+000087e0: 6573 7420 3d20 5265 7175 6573 7428 0a20  est = Request(. 
+000087f0: 2020 2020 2020 2020 2020 206d 6574 686f             metho
+00008800: 643d 2270 6f73 7422 2c0a 2020 2020 2020  d="post",.      
+00008810: 2020 2020 2020 656e 6470 6f69 6e74 3d22        endpoint="
+00008820: 2f5f 6170 692f 6375 7273 6f72 222c 0a20  /_api/cursor",. 
+00008830: 2020 2020 2020 2020 2020 2064 6174 613d             data=
+00008840: 7b22 7175 6572 7922 3a20 7175 6572 792c  {"query": query,
+00008850: 2022 6269 6e64 5661 7273 223a 2062 696e   "bindVars": bin
+00008860: 645f 7661 7273 2c20 2263 6f75 6e74 223a  d_vars, "count":
+00008870: 2054 7275 657d 2c0a 2020 2020 2020 2020   True},.        
+00008880: 2020 2020 7265 6164 3d73 656c 662e 6e61      read=self.na
+00008890: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+000088a0: 6865 6164 6572 733d 7b22 782d 6172 616e  headers={"x-aran
+000088b0: 676f 2d61 6c6c 6f77 2d64 6972 7479 2d72  go-allow-dirty-r
+000088c0: 6561 6422 3a20 2274 7275 6522 7d20 6966  ead": "true"} if
+000088d0: 2061 6c6c 6f77 5f64 6972 7479 5f72 6561   allow_dirty_rea
+000088e0: 6420 656c 7365 204e 6f6e 652c 0a20 2020  d else None,.   
+000088f0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00008900: 6465 6620 7265 7370 6f6e 7365 5f68 616e  def response_han
+00008910: 646c 6572 2872 6573 703a 2052 6573 706f  dler(resp: Respo
+00008920: 6e73 6529 202d 3e20 4375 7273 6f72 3a0a  nse) -> Cursor:.
+00008930: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00008940: 6f74 2072 6573 702e 6973 5f73 7563 6365  ot resp.is_succe
+00008950: 7373 3a0a 2020 2020 2020 2020 2020 2020  ss:.            
+00008960: 2020 2020 7261 6973 6520 446f 6375 6d65      raise Docume
+00008970: 6e74 4765 7445 7272 6f72 2872 6573 702c  ntGetError(resp,
+00008980: 2072 6571 7565 7374 290a 2020 2020 2020   request).      
+00008990: 2020 2020 2020 7265 7475 726e 2043 7572        return Cur
+000089a0: 736f 7228 7365 6c66 2e5f 636f 6e6e 2c20  sor(self._conn, 
+000089b0: 7265 7370 2e62 6f64 7929 0a0a 2020 2020  resp.body)..    
+000089c0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+000089d0: 5f65 7865 6375 7465 2872 6571 7565 7374  _execute(request
+000089e0: 2c20 7265 7370 6f6e 7365 5f68 616e 646c  , response_handl
+000089f0: 6572 290a 0a20 2020 2064 6566 2066 696e  er)..    def fin
+00008a00: 645f 696e 5f62 6f78 280a 2020 2020 2020  d_in_box(.      
+00008a10: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00008a20: 6c61 7469 7475 6465 313a 204e 756d 6265  latitude1: Numbe
+00008a30: 722c 0a20 2020 2020 2020 206c 6f6e 6769  r,.        longi
+00008a40: 7475 6465 313a 204e 756d 6265 722c 0a20  tude1: Number,. 
+00008a50: 2020 2020 2020 206c 6174 6974 7564 6532         latitude2
+00008a60: 3a20 4e75 6d62 6572 2c0a 2020 2020 2020  : Number,.      
+00008a70: 2020 6c6f 6e67 6974 7564 6532 3a20 4e75    longitude2: Nu
+00008a80: 6d62 6572 2c0a 2020 2020 2020 2020 736b  mber,.        sk
+00008a90: 6970 3a20 4f70 7469 6f6e 616c 5b69 6e74  ip: Optional[int
+00008aa0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+00008ab0: 2020 6c69 6d69 743a 204f 7074 696f 6e61    limit: Optiona
+00008ac0: 6c5b 696e 745d 203d 204e 6f6e 652c 0a20  l[int] = None,. 
+00008ad0: 2020 2020 2020 2069 6e64 6578 3a20 4f70         index: Op
+00008ae0: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
+00008af0: 6e65 2c0a 2020 2020 2020 2020 616c 6c6f  ne,.        allo
+00008b00: 775f 6469 7274 795f 7265 6164 3a20 626f  w_dirty_read: bo
+00008b10: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
+00008b20: 2920 2d3e 2052 6573 756c 745b 4375 7273  ) -> Result[Curs
+00008b30: 6f72 5d3a 0a20 2020 2020 2020 2022 2222  or]:.        """
+00008b40: 5265 7475 726e 2061 6c6c 2064 6f63 756d  Return all docum
+00008b50: 656e 7473 2069 6e20 6120 7265 6374 616e  ents in a rectan
+00008b60: 6775 6c61 7220 6172 6561 2e0a 0a20 2020  gular area...   
+00008b70: 2020 2020 203a 7061 7261 6d20 6c61 7469       :param lati
+00008b80: 7475 6465 313a 2046 6972 7374 206c 6174  tude1: First lat
+00008b90: 6974 7564 652e 0a20 2020 2020 2020 203a  itude..        :
+00008ba0: 7479 7065 206c 6174 6974 7564 6531 3a20  type latitude1: 
+00008bb0: 696e 7420 7c20 666c 6f61 740a 2020 2020  int | float.    
+00008bc0: 2020 2020 3a70 6172 616d 206c 6f6e 6769      :param longi
+00008bd0: 7475 6465 313a 2046 6972 7374 206c 6f6e  tude1: First lon
+00008be0: 6769 7475 6465 2e0a 2020 2020 2020 2020  gitude..        
+00008bf0: 3a74 7970 6520 6c6f 6e67 6974 7564 6531  :type longitude1
+00008c00: 3a20 696e 7420 7c20 666c 6f61 740a 2020  : int | float.  
+00008c10: 2020 2020 2020 3a70 6172 616d 206c 6174        :param lat
+00008c20: 6974 7564 6532 3a20 5365 636f 6e64 206c  itude2: Second l
+00008c30: 6174 6974 7564 652e 0a20 2020 2020 2020  atitude..       
+00008c40: 203a 7479 7065 206c 6174 6974 7564 6532   :type latitude2
+00008c50: 3a20 696e 7420 7c20 666c 6f61 740a 2020  : int | float.  
+00008c60: 2020 2020 2020 3a70 6172 616d 206c 6f6e        :param lon
+00008c70: 6769 7475 6465 323a 2053 6563 6f6e 6420  gitude2: Second 
+00008c80: 6c6f 6e67 6974 7564 650a 2020 2020 2020  longitude.      
+00008c90: 2020 3a74 7970 6520 6c6f 6e67 6974 7564    :type longitud
+00008ca0: 6532 3a20 696e 7420 7c20 666c 6f61 740a  e2: int | float.
+00008cb0: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
+00008cc0: 6b69 703a 204e 756d 6265 7220 6f66 2064  kip: Number of d
+00008cd0: 6f63 756d 656e 7473 2074 6f20 736b 6970  ocuments to skip
+00008ce0: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
+00008cf0: 736b 6970 3a20 696e 7420 7c20 4e6f 6e65  skip: int | None
+00008d00: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00008d10: 6c69 6d69 743a 204d 6178 206e 756d 6265  limit: Max numbe
+00008d20: 7220 6f66 2064 6f63 756d 656e 7473 2072  r of documents r
+00008d30: 6574 7572 6e65 642e 0a20 2020 2020 2020  eturned..       
+00008d40: 203a 7479 7065 206c 696d 6974 3a20 696e   :type limit: in
+00008d50: 7420 7c20 4e6f 6e65 0a20 2020 2020 2020  t | None.       
+00008d60: 203a 7061 7261 6d20 696e 6465 783a 2049   :param index: I
+00008d70: 4420 6f66 2074 6865 2067 656f 2069 6e64  D of the geo ind
+00008d80: 6578 2074 6f20 7573 6520 2877 6974 686f  ex to use (witho
+00008d90: 7574 2074 6865 2063 6f6c 6c65 6374 696f  ut the collectio
+00008da0: 6e0a 2020 2020 2020 2020 2020 2020 7072  n.            pr
+00008db0: 6566 6978 292e 2054 6869 7320 7061 7261  efix). This para
+00008dc0: 6d65 7465 7220 6973 2069 676e 6f72 6564  meter is ignored
+00008dd0: 2069 6e20 7472 616e 7361 6374 696f 6e73   in transactions
+00008de0: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
+00008df0: 696e 6465 783a 2073 7472 207c 204e 6f6e  index: str | Non
+00008e00: 650a 2020 2020 2020 2020 3a70 6172 616d  e.        :param
+00008e10: 2061 6c6c 6f77 5f64 6972 7479 5f72 6561   allow_dirty_rea
+00008e20: 643a 2041 6c6c 6f77 2072 6561 6473 2066  d: Allow reads f
+00008e30: 726f 6d20 666f 6c6c 6f77 6572 7320 696e  rom followers in
+00008e40: 2061 2063 6c75 7374 6572 2e0a 2020 2020   a cluster..    
+00008e50: 2020 2020 3a74 7970 6520 616c 6c6f 775f      :type allow_
+00008e60: 6469 7274 795f 7265 6164 3a20 626f 6f6c  dirty_read: bool
+00008e70: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00008e80: 733a 2044 6f63 756d 656e 7420 6375 7273  s: Document curs
+00008e90: 6f72 2e0a 2020 2020 2020 2020 3a72 7479  or..        :rty
+00008ea0: 7065 3a20 6172 616e 676f 2e63 7572 736f  pe: arango.curso
+00008eb0: 722e 4375 7273 6f72 0a20 2020 2020 2020  r.Cursor.       
+00008ec0: 203a 7261 6973 6573 2061 7261 6e67 6f2e   :raises arango.
+00008ed0: 6578 6365 7074 696f 6e73 2e44 6f63 756d  exceptions.Docum
+00008ee0: 656e 7447 6574 4572 726f 723a 2049 6620  entGetError: If 
+00008ef0: 7265 7472 6965 7661 6c20 6661 696c 732e  retrieval fails.
+00008f00: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00008f10: 2020 2020 2061 7373 6572 7420 6973 696e       assert isin
+00008f20: 7374 616e 6365 286c 6174 6974 7564 6531  stance(latitude1
+00008f30: 2c20 4e75 6d62 6572 292c 2022 6c61 7469  , Number), "lati
+00008f40: 7475 6465 3120 6d75 7374 2062 6520 6120  tude1 must be a 
+00008f50: 6e75 6d62 6572 220a 2020 2020 2020 2020  number".        
+00008f60: 6173 7365 7274 2069 7369 6e73 7461 6e63  assert isinstanc
+00008f70: 6528 6c6f 6e67 6974 7564 6531 2c20 4e75  e(longitude1, Nu
+00008f80: 6d62 6572 292c 2022 6c6f 6e67 6974 7564  mber), "longitud
+00008f90: 6531 206d 7573 7420 6265 2061 206e 756d  e1 must be a num
+00008fa0: 6265 7222 0a20 2020 2020 2020 2061 7373  ber".        ass
+00008fb0: 6572 7420 6973 696e 7374 616e 6365 286c  ert isinstance(l
+00008fc0: 6174 6974 7564 6532 2c20 4e75 6d62 6572  atitude2, Number
+00008fd0: 292c 2022 6c61 7469 7475 6465 3220 6d75  ), "latitude2 mu
+00008fe0: 7374 2062 6520 6120 6e75 6d62 6572 220a  st be a number".
+00008ff0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00009000: 7369 6e73 7461 6e63 6528 6c6f 6e67 6974  sinstance(longit
+00009010: 7564 6532 2c20 4e75 6d62 6572 292c 2022  ude2, Number), "
+00009020: 6c6f 6e67 6974 7564 6532 206d 7573 7420  longitude2 must 
+00009030: 6265 2061 206e 756d 6265 7222 0a20 2020  be a number".   
+00009040: 2020 2020 2061 7373 6572 7420 6973 5f6e       assert is_n
+00009050: 6f6e 655f 6f72 5f69 6e74 2873 6b69 7029  one_or_int(skip)
+00009060: 2c20 2273 6b69 7020 6d75 7374 2062 6520  , "skip must be 
+00009070: 6120 6e6f 6e2d 6e65 6761 7469 7665 2069  a non-negative i
+00009080: 6e74 220a 2020 2020 2020 2020 6173 7365  nt".        asse
+00009090: 7274 2069 735f 6e6f 6e65 5f6f 725f 696e  rt is_none_or_in
+000090a0: 7428 6c69 6d69 7429 2c20 226c 696d 6974  t(limit), "limit
+000090b0: 206d 7573 7420 6265 2061 206e 6f6e 2d6e   must be a non-n
+000090c0: 6567 6174 6976 6520 696e 7422 0a20 2020  egative int".   
+000090d0: 2020 2020 2061 7373 6572 7420 6973 5f6e       assert is_n
+000090e0: 6f6e 655f 6f72 5f73 7472 2869 6e64 6578  one_or_str(index
+000090f0: 292c 2022 696e 6465 7820 6d75 7374 2062  ), "index must b
+00009100: 6520 6120 7374 7269 6e67 220a 0a20 2020  e a string"..   
+00009110: 2020 2020 2064 6566 2062 7569 6c64 5f63       def build_c
+00009120: 6f6f 7264 5f73 7472 5f66 726f 6d5f 696e  oord_str_from_in
+00009130: 6465 7828 696e 6465 783a 204a 736f 6e29  dex(index: Json)
+00009140: 202d 3e20 7374 723a 0a20 2020 2020 2020   -> str:.       
+00009150: 2020 2020 2069 6e64 6578 5f66 6965 6c64       index_field
+00009160: 3a20 4c69 7374 5b73 7472 5d20 3d20 696e  : List[str] = in
+00009170: 6465 785b 2266 6965 6c64 7322 5d0a 0a20  dex["fields"].. 
+00009180: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+00009190: 6e28 696e 6465 785f 6669 656c 6429 203d  n(index_field) =
+000091a0: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+000091b0: 2020 2020 2072 6574 7572 6e20 6622 646f       return f"do
+000091c0: 632e 7b69 6e64 6578 5f66 6965 6c64 5b30  c.{index_field[0
+000091d0: 5d7d 220a 2020 2020 2020 2020 2020 2020  ]}".            
+000091e0: 656c 6966 206c 656e 2869 6e64 6578 5f66  elif len(index_f
+000091f0: 6965 6c64 2920 3d3d 2032 3a0a 2020 2020  ield) == 2:.    
+00009200: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00009210: 726e 2066 225b 646f 632e 7b69 6e64 6578  rn f"[doc.{index
+00009220: 5f66 6965 6c64 5b30 5d7d 2c20 646f 632e  _field[0]}, doc.
+00009230: 7b69 6e64 6578 5f66 6965 6c64 5b31 5d7d  {index_field[1]}
+00009240: 5d22 0a20 2020 2020 2020 2020 2020 2065  ]".            e
+00009250: 6c73 653a 2020 2320 7072 6167 6d61 3a20  lse:  # pragma: 
+00009260: 6e6f 2063 6f76 6572 0a20 2020 2020 2020  no cover.       
+00009270: 2020 2020 2020 2020 206d 203d 2022 2a2a           m = "**
+00009280: 696e 6465 782a 2a20 6d75 7374 2062 6520  index** must be 
+00009290: 6120 6765 6f20 696e 6465 7820 7769 7468  a geo index with
+000092a0: 2031 206f 7220 3220 6669 656c 6473 220a   1 or 2 fields".
+000092b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000092c0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+000092d0: 286d 290a 0a20 2020 2020 2020 2063 6f6f  (m)..        coo
+000092e0: 7264 5f73 7472 203d 2022 220a 2020 2020  rd_str = "".    
+000092f0: 2020 2020 6966 2069 6e64 6578 2069 7320      if index is 
+00009300: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00009310: 2020 2320 4669 6e64 2074 6865 2066 6972    # Find the fir
+00009320: 7374 2067 656f 2069 6e64 6578 0a20 2020  st geo index.   
+00009330: 2020 2020 2020 2020 2066 6f72 2063 6f6c           for col
+00009340: 6c65 6374 696f 6e5f 696e 6465 7820 696e  lection_index in
+00009350: 2073 656c 662e 696e 6465 7865 7328 293a   self.indexes():
+00009360: 2020 2320 7479 7065 3a69 676e 6f72 655b    # type:ignore[
+00009370: 756e 696f 6e2d 6174 7472 5d0a 2020 2020  union-attr].    
+00009380: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+00009390: 6f6c 6c65 6374 696f 6e5f 696e 6465 785b  ollection_index[
+000093a0: 2274 7970 6522 5d20 3d3d 2022 6765 6f22  "type"] == "geo"
+000093b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000093c0: 2020 2020 2020 636f 6f72 645f 7374 7220        coord_str 
+000093d0: 3d20 6275 696c 645f 636f 6f72 645f 7374  = build_coord_st
+000093e0: 725f 6672 6f6d 5f69 6e64 6578 2863 6f6c  r_from_index(col
+000093f0: 6c65 6374 696f 6e5f 696e 6465 7829 0a20  lection_index). 
+00009400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009410: 2020 2062 7265 616b 0a0a 2020 2020 2020     break..      
+00009420: 2020 2020 2020 2320 4966 206e 6f20 6765        # If no ge
+00009430: 6f20 696e 6465 7820 666f 756e 642c 2072  o index found, r
+00009440: 6169 7365 0a20 2020 2020 2020 2020 2020  aise.           
+00009450: 2069 6620 636f 6f72 645f 7374 7220 3d3d   if coord_str ==
+00009460: 2022 223a 0a20 2020 2020 2020 2020 2020   "":.           
+00009470: 2020 2020 2072 6169 7365 2049 6e64 6578       raise Index
+00009480: 4d69 7373 696e 6745 7272 6f72 2866 224e  MissingError(f"N
+00009490: 6f20 6765 6f20 696e 6465 7820 666f 756e  o geo index foun
+000094a0: 6420 696e 207b 7365 6c66 2e6e 616d 657d  d in {self.name}
+000094b0: 2229 0a0a 2020 2020 2020 2020 656c 7365  ")..        else
+000094c0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+000094d0: 4669 6e64 2074 6865 2067 656f 2069 6e64  Find the geo ind
+000094e0: 6578 2077 6974 6820 7468 6520 6769 7665  ex with the give
+000094f0: 6e20 4944 0a20 2020 2020 2020 2020 2020  n ID.           
+00009500: 2067 656f 5f69 6e64 6578 203d 2073 656c   geo_index = sel
+00009510: 662e 6765 745f 696e 6465 7828 696e 6465  f.get_index(inde
+00009520: 7829 0a20 2020 2020 2020 2020 2020 2061  x).            a
+00009530: 7373 6572 7420 6973 696e 7374 616e 6365  ssert isinstance
+00009540: 2867 656f 5f69 6e64 6578 2c20 6469 6374  (geo_index, dict
+00009550: 290a 0a20 2020 2020 2020 2020 2020 2023  )..            #
+00009560: 2049 6620 7468 6520 696e 6465 7820 6973   If the index is
+00009570: 206e 6f74 2061 2067 656f 2069 6e64 6578   not a geo index
+00009580: 2c20 7261 6973 650a 2020 2020 2020 2020  , raise.        
+00009590: 2020 2020 6966 2067 656f 5f69 6e64 6578      if geo_index
+000095a0: 5b22 7479 7065 225d 2021 3d20 2267 656f  ["type"] != "geo
+000095b0: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
+000095c0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+000095d0: 726f 7228 222a 2a69 6e64 6578 2a2a 206d  ror("**index** m
+000095e0: 7573 7420 706f 696e 7420 746f 2061 2047  ust point to a G
+000095f0: 656f 2049 6e64 6578 2229 0a0a 2020 2020  eo Index")..    
+00009600: 2020 2020 2020 2020 636f 6f72 645f 7374          coord_st
+00009610: 7220 3d20 6275 696c 645f 636f 6f72 645f  r = build_coord_
+00009620: 7374 725f 6672 6f6d 5f69 6e64 6578 2867  str_from_index(g
+00009630: 656f 5f69 6e64 6578 290a 0a20 2020 2020  eo_index)..     
+00009640: 2020 2073 6b69 705f 7661 6c20 3d20 736b     skip_val = sk
+00009650: 6970 2069 6620 736b 6970 2069 7320 6e6f  ip if skip is no
+00009660: 7420 4e6f 6e65 2065 6c73 6520 300a 2020  t None else 0.  
+00009670: 2020 2020 2020 6c69 6d69 745f 7661 6c20        limit_val 
+00009680: 3d20 6c69 6d69 7420 6966 206c 696d 6974  = limit if limit
+00009690: 2069 7320 6e6f 7420 4e6f 6e65 2065 6c73   is not None els
+000096a0: 6520 226e 756c 6c22 0a20 2020 2020 2020  e "null".       
+000096b0: 2071 7565 7279 203d 2066 2222 220a 2020   query = f""".  
+000096c0: 2020 2020 2020 2020 2020 4c45 5420 7265            LET re
+000096d0: 6374 203d 2047 454f 5f50 4f4c 5947 4f4e  ct = GEO_POLYGON
+000096e0: 285b 205b 0a20 2020 2020 2020 2020 2020  ([ [.           
+000096f0: 2020 2020 205b 7b6c 6f6e 6769 7475 6465       [{longitude
+00009700: 317d 2c20 7b6c 6174 6974 7564 6531 7d5d  1}, {latitude1}]
+00009710: 2c20 2f2f 2062 6f74 746f 6d2d 6c65 6674  , // bottom-left
+00009720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009730: 205b 7b6c 6f6e 6769 7475 6465 327d 2c20   [{longitude2}, 
+00009740: 7b6c 6174 6974 7564 6531 7d5d 2c20 2f2f  {latitude1}], //
+00009750: 2062 6f74 746f 6d2d 7269 6768 740a 2020   bottom-right.  
+00009760: 2020 2020 2020 2020 2020 2020 2020 5b7b                [{
+00009770: 6c6f 6e67 6974 7564 6532 7d2c 207b 6c61  longitude2}, {la
+00009780: 7469 7475 6465 327d 5d2c 202f 2f20 746f  titude2}], // to
+00009790: 702d 7269 6768 740a 2020 2020 2020 2020  p-right.        
+000097a0: 2020 2020 2020 2020 5b7b 6c6f 6e67 6974          [{longit
+000097b0: 7564 6531 7d2c 207b 6c61 7469 7475 6465  ude1}, {latitude
+000097c0: 327d 5d2c 202f 2f20 746f 702d 6c65 6674  2}], // top-left
+000097d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000097e0: 205b 7b6c 6f6e 6769 7475 6465 317d 2c20   [{longitude1}, 
+000097f0: 7b6c 6174 6974 7564 6531 7d5d 2c20 2f2f  {latitude1}], //
+00009800: 2062 6f74 746f 6d2d 6c65 6674 2028 636c   bottom-left (cl
+00009810: 6f73 6520 706f 6c79 676f 6e29 0a20 2020  ose polygon).   
+00009820: 2020 2020 2020 2020 205d 205d 290a 0a20           ] ]).. 
+00009830: 2020 2020 2020 2020 2020 2046 4f52 2064             FOR d
+00009840: 6f63 2049 4e20 4040 636f 6c6c 6563 7469  oc IN @@collecti
+00009850: 6f6e 0a20 2020 2020 2020 2020 2020 2020  on.             
+00009860: 2020 2046 494c 5445 5220 4745 4f5f 434f     FILTER GEO_CO
+00009870: 4e54 4149 4e53 2872 6563 742c 207b 636f  NTAINS(rect, {co
+00009880: 6f72 645f 7374 727d 290a 2020 2020 2020  ord_str}).      
+00009890: 2020 2020 2020 2020 2020 4c49 4d49 5420            LIMIT 
+000098a0: 7b73 6b69 705f 7661 6c7d 2c20 7b6c 696d  {skip_val}, {lim
+000098b0: 6974 5f76 616c 7d0a 2020 2020 2020 2020  it_val}.        
+000098c0: 2020 2020 2020 2020 5245 5455 524e 2064          RETURN d
+000098d0: 6f63 0a20 2020 2020 2020 2022 2222 2020  oc.        """  
+000098e0: 2320 6e6f 7161 3a20 4532 3031 2045 3230  # noqa: E201 E20
+000098f0: 320a 0a20 2020 2020 2020 2062 696e 645f  2..        bind_
+00009900: 7661 7273 203d 207b 2240 636f 6c6c 6563  vars = {"@collec
+00009910: 7469 6f6e 223a 2073 656c 662e 6e61 6d65  tion": self.name
+00009920: 7d0a 0a20 2020 2020 2020 2072 6571 7565  }..        reque
+00009930: 7374 203d 2052 6571 7565 7374 280a 2020  st = Request(.  
+00009940: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+00009950: 3d22 706f 7374 222c 0a20 2020 2020 2020  ="post",.       
+00009960: 2020 2020 2065 6e64 706f 696e 743d 222f       endpoint="/
+00009970: 5f61 7069 2f63 7572 736f 7222 2c0a 2020  _api/cursor",.  
+00009980: 2020 2020 2020 2020 2020 6461 7461 3d7b            data={
+00009990: 2271 7565 7279 223a 2071 7565 7279 2c20  "query": query, 
+000099a0: 2262 696e 6456 6172 7322 3a20 6269 6e64  "bindVars": bind
+000099b0: 5f76 6172 732c 2022 636f 756e 7422 3a20  _vars, "count": 
+000099c0: 5472 7565 7d2c 0a20 2020 2020 2020 2020  True},.         
+000099d0: 2020 2072 6561 643d 7365 6c66 2e6e 616d     read=self.nam
+000099e0: 652c 0a20 2020 2020 2020 2020 2020 2068  e,.            h
+000099f0: 6561 6465 7273 3d7b 2278 2d61 7261 6e67  eaders={"x-arang
+00009a00: 6f2d 616c 6c6f 772d 6469 7274 792d 7265  o-allow-dirty-re
+00009a10: 6164 223a 2022 7472 7565 227d 2069 6620  ad": "true"} if 
+00009a20: 616c 6c6f 775f 6469 7274 795f 7265 6164  allow_dirty_read
+00009a30: 2065 6c73 6520 4e6f 6e65 2c0a 2020 2020   else None,.    
+00009a40: 2020 2020 290a 0a20 2020 2020 2020 2064      )..        d
+00009a50: 6566 2072 6573 706f 6e73 655f 6861 6e64  ef response_hand
+00009a60: 6c65 7228 7265 7370 3a20 5265 7370 6f6e  ler(resp: Respon
+00009a70: 7365 2920 2d3e 2043 7572 736f 723a 0a20  se) -> Cursor:. 
+00009a80: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+00009a90: 7420 7265 7370 2e69 735f 7375 6363 6573  t resp.is_succes
+00009aa0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00009ab0: 2020 2072 6169 7365 2044 6f63 756d 656e     raise Documen
+00009ac0: 7447 6574 4572 726f 7228 7265 7370 2c20  tGetError(resp, 
+00009ad0: 7265 7175 6573 7429 0a20 2020 2020 2020  request).       
+00009ae0: 2020 2020 2072 6574 7572 6e20 4375 7273       return Curs
+00009af0: 6f72 2873 656c 662e 5f63 6f6e 6e2c 2072  or(self._conn, r
+00009b00: 6573 702e 626f 6479 290a 0a20 2020 2020  esp.body)..     
+00009b10: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00009b20: 6578 6563 7574 6528 7265 7175 6573 742c  execute(request,
+00009b30: 2072 6573 706f 6e73 655f 6861 6e64 6c65   response_handle
+00009b40: 7229 0a0a 2020 2020 6465 6620 6669 6e64  r)..    def find
+00009b50: 5f62 795f 7465 7874 280a 2020 2020 2020  _by_text(.      
+00009b60: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00009b70: 6669 656c 643a 2073 7472 2c0a 2020 2020  field: str,.    
+00009b80: 2020 2020 7175 6572 793a 2073 7472 2c0a      query: str,.
+00009b90: 2020 2020 2020 2020 6c69 6d69 743a 204f          limit: O
+00009ba0: 7074 696f 6e61 6c5b 696e 745d 203d 204e  ptional[int] = N
+00009bb0: 6f6e 652c 0a20 2020 2020 2020 2061 6c6c  one,.        all
+00009bc0: 6f77 5f64 6972 7479 5f72 6561 643a 2062  ow_dirty_read: b
+00009bd0: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
+00009be0: 2029 202d 3e20 5265 7375 6c74 5b43 7572   ) -> Result[Cur
+00009bf0: 736f 725d 3a0a 2020 2020 2020 2020 2222  sor]:.        ""
+00009c00: 2252 6574 7572 6e20 646f 6375 6d65 6e74  "Return document
+00009c10: 7320 7468 6174 206d 6174 6368 2074 6865  s that match the
+00009c20: 2067 6976 656e 2066 756c 6c74 6578 7420   given fulltext 
+00009c30: 7175 6572 792e 0a0a 2020 2020 2020 2020  query...        
+00009c40: 3a70 6172 616d 2066 6965 6c64 3a20 446f  :param field: Do
+00009c50: 6375 6d65 6e74 2066 6965 6c64 2077 6974  cument field wit
+00009c60: 6820 6675 6c6c 7465 7874 2069 6e64 6578  h fulltext index
+00009c70: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
+00009c80: 6669 656c 643a 2073 7472 0a20 2020 2020  field: str.     
+00009c90: 2020 203a 7061 7261 6d20 7175 6572 793a     :param query:
+00009ca0: 2046 756c 6c74 6578 7420 7175 6572 792e   Fulltext query.
+00009cb0: 0a20 2020 2020 2020 203a 7479 7065 2071  .        :type q
+00009cc0: 7565 7279 3a20 7374 720a 2020 2020 2020  uery: str.      
+00009cd0: 2020 3a70 6172 616d 206c 696d 6974 3a20    :param limit: 
+00009ce0: 4d61 7820 6e75 6d62 6572 206f 6620 646f  Max number of do
+00009cf0: 6375 6d65 6e74 7320 7265 7475 726e 6564  cuments returned
+00009d00: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
+00009d10: 6c69 6d69 743a 2069 6e74 207c 204e 6f6e  limit: int | Non
+00009d20: 650a 2020 2020 2020 2020 3a70 6172 616d  e.        :param
+00009d30: 2061 6c6c 6f77 5f64 6972 7479 5f72 6561   allow_dirty_rea
+00009d40: 643a 2041 6c6c 6f77 2072 6561 6473 2066  d: Allow reads f
+00009d50: 726f 6d20 666f 6c6c 6f77 6572 7320 696e  rom followers in
+00009d60: 2061 2063 6c75 7374 6572 2e0a 2020 2020   a cluster..    
+00009d70: 2020 2020 3a74 7970 6520 616c 6c6f 775f      :type allow_
+00009d80: 6469 7274 795f 7265 6164 3a20 626f 6f6c  dirty_read: bool
+00009d90: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00009da0: 733a 2044 6f63 756d 656e 7420 6375 7273  s: Document curs
+00009db0: 6f72 2e0a 2020 2020 2020 2020 3a72 7479  or..        :rty
+00009dc0: 7065 3a20 6172 616e 676f 2e63 7572 736f  pe: arango.curso
+00009dd0: 722e 4375 7273 6f72 0a20 2020 2020 2020  r.Cursor.       
+00009de0: 203a 7261 6973 6573 2061 7261 6e67 6f2e   :raises arango.
+00009df0: 6578 6365 7074 696f 6e73 2e44 6f63 756d  exceptions.Docum
+00009e00: 656e 7447 6574 4572 726f 723a 2049 6620  entGetError: If 
+00009e10: 7265 7472 6965 7661 6c20 6661 696c 732e  retrieval fails.
+00009e20: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00009e30: 2020 2020 2061 7373 6572 7420 6973 5f6e       assert is_n
+00009e40: 6f6e 655f 6f72 5f69 6e74 286c 696d 6974  one_or_int(limit
+00009e50: 292c 2022 6c69 6d69 7420 6d75 7374 2062  ), "limit must b
+00009e60: 6520 6120 6e6f 6e2d 6e65 6761 7469 7665  e a non-negative
+00009e70: 2069 6e74 220a 0a20 2020 2020 2020 2062   int"..        b
+00009e80: 696e 645f 7661 7273 3a20 4a73 6f6e 203d  ind_vars: Json =
+00009e90: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+00009ea0: 636f 6c6c 6563 7469 6f6e 223a 2073 656c  collection": sel
+00009eb0: 662e 5f6e 616d 652c 0a20 2020 2020 2020  f._name,.       
+00009ec0: 2020 2020 2022 6669 656c 6422 3a20 6669       "field": fi
+00009ed0: 656c 642c 0a20 2020 2020 2020 2020 2020  eld,.           
+00009ee0: 2022 7175 6572 7922 3a20 7175 6572 792c   "query": query,
+00009ef0: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
+00009f00: 2020 2069 6620 6c69 6d69 7420 6973 206e     if limit is n
+00009f10: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+00009f20: 2020 2020 2062 696e 645f 7661 7273 5b22       bind_vars["
+00009f30: 6c69 6d69 7422 5d20 3d20 6c69 6d69 740a  limit"] = limit.
+00009f40: 0a20 2020 2020 2020 2061 716c 203d 2022  .        aql = "
+00009f50: 2222 0a20 2020 2020 2020 2046 4f52 2064  "".        FOR d
+00009f60: 6f63 2049 4e20 4655 4c4c 5445 5854 2840  oc IN FULLTEXT(@
+00009f70: 636f 6c6c 6563 7469 6f6e 2c20 4066 6965  collection, @fie
+00009f80: 6c64 2c20 4071 7565 7279 7b7d 290a 2020  ld, @query{}).  
+00009f90: 2020 2020 2020 2020 2020 5245 5455 524e            RETURN
+00009fa0: 2064 6f63 0a20 2020 2020 2020 2022 2222   doc.        """
+00009fb0: 2e66 6f72 6d61 7428 0a20 2020 2020 2020  .format(.       
+00009fc0: 2020 2020 2022 2220 6966 206c 696d 6974       "" if limit
+00009fd0: 2069 7320 4e6f 6e65 2065 6c73 6520 222c   is None else ",
+00009fe0: 2040 6c69 6d69 7422 0a20 2020 2020 2020   @limit".       
+00009ff0: 2029 0a0a 2020 2020 2020 2020 7265 7175   )..        requ
+0000a000: 6573 7420 3d20 5265 7175 6573 7428 0a20  est = Request(. 
+0000a010: 2020 2020 2020 2020 2020 206d 6574 686f             metho
+0000a020: 643d 2270 6f73 7422 2c0a 2020 2020 2020  d="post",.      
+0000a030: 2020 2020 2020 656e 6470 6f69 6e74 3d22        endpoint="
+0000a040: 2f5f 6170 692f 6375 7273 6f72 222c 0a20  /_api/cursor",. 
+0000a050: 2020 2020 2020 2020 2020 2064 6174 613d             data=
+0000a060: 7b22 7175 6572 7922 3a20 6171 6c2c 2022  {"query": aql, "
+0000a070: 6269 6e64 5661 7273 223a 2062 696e 645f  bindVars": bind_
+0000a080: 7661 7273 2c20 2263 6f75 6e74 223a 2054  vars, "count": T
+0000a090: 7275 657d 2c0a 2020 2020 2020 2020 2020  rue},.          
+0000a0a0: 2020 7265 6164 3d73 656c 662e 6e61 6d65    read=self.name
+0000a0b0: 2c0a 2020 2020 2020 2020 2020 2020 6865  ,.            he
+0000a0c0: 6164 6572 733d 7b22 782d 6172 616e 676f  aders={"x-arango
+0000a0d0: 2d61 6c6c 6f77 2d64 6972 7479 2d72 6561  -allow-dirty-rea
+0000a0e0: 6422 3a20 2274 7275 6522 7d20 6966 2061  d": "true"} if a
+0000a0f0: 6c6c 6f77 5f64 6972 7479 5f72 6561 6420  llow_dirty_read 
+0000a100: 656c 7365 204e 6f6e 652c 0a20 2020 2020  else None,.     
+0000a110: 2020 2029 0a0a 2020 2020 2020 2020 6465     )..        de
+0000a120: 6620 7265 7370 6f6e 7365 5f68 616e 646c  f response_handl
+0000a130: 6572 2872 6573 703a 2052 6573 706f 6e73  er(resp: Respons
+0000a140: 6529 202d 3e20 4375 7273 6f72 3a0a 2020  e) -> Cursor:.  
+0000a150: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+0000a160: 2072 6573 702e 6973 5f73 7563 6365 7373   resp.is_success
+0000a170: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000a180: 2020 7261 6973 6520 446f 6375 6d65 6e74    raise Document
+0000a190: 4765 7445 7272 6f72 2872 6573 702c 2072  GetError(resp, r
+0000a1a0: 6571 7565 7374 290a 2020 2020 2020 2020  equest).        
+0000a1b0: 2020 2020 7265 7475 726e 2043 7572 736f      return Curso
+0000a1c0: 7228 7365 6c66 2e5f 636f 6e6e 2c20 7265  r(self._conn, re
+0000a1d0: 7370 2e62 6f64 7929 0a0a 2020 2020 2020  sp.body)..      
+0000a1e0: 2020 7265 7475 726e 2073 656c 662e 5f65    return self._e
+0000a1f0: 7865 6375 7465 2872 6571 7565 7374 2c20  xecute(request, 
+0000a200: 7265 7370 6f6e 7365 5f68 616e 646c 6572  response_handler
+0000a210: 290a 0a20 2020 2064 6566 2067 6574 5f6d  )..    def get_m
+0000a220: 616e 7928 0a20 2020 2020 2020 2073 656c  any(.        sel
+0000a230: 662c 0a20 2020 2020 2020 2064 6f63 756d  f,.        docum
+0000a240: 656e 7473 3a20 5365 7175 656e 6365 5b55  ents: Sequence[U
+0000a250: 6e69 6f6e 5b73 7472 2c20 4a73 6f6e 5d5d  nion[str, Json]]
+0000a260: 2c0a 2020 2020 2020 2020 616c 6c6f 775f  ,.        allow_
+0000a270: 6469 7274 795f 7265 6164 3a20 626f 6f6c  dirty_read: bool
+0000a280: 203d 2046 616c 7365 2c0a 2020 2020 2920   = False,.    ) 
+0000a290: 2d3e 2052 6573 756c 745b 4a73 6f6e 735d  -> Result[Jsons]
+0000a2a0: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
+0000a2b0: 7572 6e20 6d75 6c74 6970 6c65 2064 6f63  urn multiple doc
+0000a2c0: 756d 656e 7473 2069 676e 6f72 696e 6720  uments ignoring 
+0000a2d0: 616e 7920 6d69 7373 696e 6720 6f6e 6573  any missing ones
+0000a2e0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+0000a2f0: 6d20 646f 6375 6d65 6e74 733a 204c 6973  m documents: Lis
+0000a300: 7420 6f66 2064 6f63 756d 656e 7420 6b65  t of document ke
+0000a310: 7973 2c20 4944 7320 6f72 2062 6f64 6965  ys, IDs or bodie
+0000a320: 732e 2044 6f63 756d 656e 7420 626f 6469  s. Document bodi
+0000a330: 6573 0a20 2020 2020 2020 2020 2020 206d  es.            m
+0000a340: 7573 7420 636f 6e74 6169 6e20 7468 6520  ust contain the 
+0000a350: 225f 6964 2220 6f72 2022 5f6b 6579 2220  "_id" or "_key" 
+0000a360: 6669 656c 6473 2e0a 2020 2020 2020 2020  fields..        
+0000a370: 3a74 7970 6520 646f 6375 6d65 6e74 733a  :type documents:
+0000a380: 205b 7374 7220 7c20 6469 6374 5d0a 2020   [str | dict].  
+0000a390: 2020 2020 2020 3a70 6172 616d 2061 6c6c        :param all
+0000a3a0: 6f77 5f64 6972 7479 5f72 6561 643a 2041  ow_dirty_read: A
+0000a3b0: 6c6c 6f77 2072 6561 6473 2066 726f 6d20  llow reads from 
+0000a3c0: 666f 6c6c 6f77 6572 7320 696e 2061 2063  followers in a c
+0000a3d0: 6c75 7374 6572 2e0a 2020 2020 2020 2020  luster..        
+0000a3e0: 3a74 7970 6520 616c 6c6f 775f 6469 7274  :type allow_dirt
+0000a3f0: 795f 7265 6164 3a20 626f 6f6c 0a20 2020  y_read: bool.   
+0000a400: 2020 2020 203a 7265 7475 726e 3a20 446f       :return: Do
+0000a410: 6375 6d65 6e74 732e 204d 6973 7369 6e67  cuments. Missing
+0000a420: 206f 6e65 7320 6172 6520 6e6f 7420 696e   ones are not in
+0000a430: 636c 7564 6564 2e0a 2020 2020 2020 2020  cluded..        
+0000a440: 3a72 7479 7065 3a20 5b64 6963 745d 0a20  :rtype: [dict]. 
+0000a450: 2020 2020 2020 203a 7261 6973 6520 6172         :raise ar
+0000a460: 616e 676f 2e65 7863 6570 7469 6f6e 732e  ango.exceptions.
+0000a470: 446f 6375 6d65 6e74 4765 7445 7272 6f72  DocumentGetError
+0000a480: 3a20 4966 2072 6574 7269 6576 616c 2066  : If retrieval f
+0000a490: 6169 6c73 2e0a 2020 2020 2020 2020 2222  ails..        ""
+0000a4a0: 220a 2020 2020 2020 2020 6861 6e64 6c65  ".        handle
+0000a4b0: 7320 3d20 5b73 656c 662e 5f65 7874 7261  s = [self._extra
+0000a4c0: 6374 5f69 6428 6429 2069 6620 6973 696e  ct_id(d) if isin
+0000a4d0: 7374 616e 6365 2864 2c20 6469 6374 2920  stance(d, dict) 
+0000a4e0: 656c 7365 2064 2066 6f72 2064 2069 6e20  else d for d in 
+0000a4f0: 646f 6375 6d65 6e74 735d 0a0a 2020 2020  documents]..    
+0000a500: 2020 2020 7061 7261 6d73 3a20 5061 7261      params: Para
+0000a510: 6d73 203d 207b 226f 6e6c 7967 6574 223a  ms = {"onlyget":
+0000a520: 2054 7275 657d 0a0a 2020 2020 2020 2020   True}..        
+0000a530: 7265 7175 6573 7420 3d20 5265 7175 6573  request = Reques
+0000a540: 7428 0a20 2020 2020 2020 2020 2020 206d  t(.            m
+0000a550: 6574 686f 643d 2270 7574 222c 0a20 2020  ethod="put",.   
+0000a560: 2020 2020 2020 2020 2065 6e64 706f 696e           endpoin
+0000a570: 743d 6622 2f5f 6170 692f 646f 6375 6d65  t=f"/_api/docume
+0000a580: 6e74 2f7b 7365 6c66 2e6e 616d 657d 222c  nt/{self.name}",
+0000a590: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
+0000a5a0: 616d 733d 7061 7261 6d73 2c0a 2020 2020  ams=params,.    
+0000a5b0: 2020 2020 2020 2020 6461 7461 3d68 616e          data=han
+0000a5c0: 646c 6573 2c0a 2020 2020 2020 2020 2020  dles,.          
+0000a5d0: 2020 7265 6164 3d73 656c 662e 6e61 6d65    read=self.name
+0000a5e0: 2c0a 2020 2020 2020 2020 2020 2020 6865  ,.            he
+0000a5f0: 6164 6572 733d 7b22 782d 6172 616e 676f  aders={"x-arango
+0000a600: 2d61 6c6c 6f77 2d64 6972 7479 2d72 6561  -allow-dirty-rea
+0000a610: 6422 3a20 2274 7275 6522 7d20 6966 2061  d": "true"} if a
+0000a620: 6c6c 6f77 5f64 6972 7479 5f72 6561 6420  llow_dirty_read 
+0000a630: 656c 7365 204e 6f6e 652c 0a20 2020 2020  else None,.     
+0000a640: 2020 2029 0a0a 2020 2020 2020 2020 6465     )..        de
+0000a650: 6620 7265 7370 6f6e 7365 5f68 616e 646c  f response_handl
+0000a660: 6572 2872 6573 703a 2052 6573 706f 6e73  er(resp: Respons
+0000a670: 6529 202d 3e20 4a73 6f6e 733a 0a20 2020  e) -> Jsons:.   
+0000a680: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+0000a690: 7265 7370 2e69 735f 7375 6363 6573 733a  resp.is_success:
+0000a6a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a6b0: 2072 6169 7365 2044 6f63 756d 656e 7447   raise DocumentG
+0000a6c0: 6574 4572 726f 7228 7265 7370 2c20 7265  etError(resp, re
+0000a6d0: 7175 6573 7429 0a20 2020 2020 2020 2020  quest).         
+0000a6e0: 2020 2072 6574 7572 6e20 5b64 6f63 2066     return [doc f
+0000a6f0: 6f72 2064 6f63 2069 6e20 7265 7370 2e62  or doc in resp.b
+0000a700: 6f64 7920 6966 2022 5f69 6422 2069 6e20  ody if "_id" in 
+0000a710: 646f 635d 0a0a 2020 2020 2020 2020 7265  doc]..        re
+0000a720: 7475 726e 2073 656c 662e 5f65 7865 6375  turn self._execu
+0000a730: 7465 2872 6571 7565 7374 2c20 7265 7370  te(request, resp
+0000a740: 6f6e 7365 5f68 616e 646c 6572 290a 0a20  onse_handler).. 
+0000a750: 2020 2064 6566 2072 616e 646f 6d28 7365     def random(se
+0000a760: 6c66 2c20 616c 6c6f 775f 6469 7274 795f  lf, allow_dirty_
+0000a770: 7265 6164 3a20 626f 6f6c 203d 2046 616c  read: bool = Fal
+0000a780: 7365 2920 2d3e 2052 6573 756c 745b 4f70  se) -> Result[Op
+0000a790: 7469 6f6e 616c 5b4a 736f 6e5d 5d3a 0a20  tional[Json]]:. 
+0000a7a0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+0000a7b0: 2061 2072 616e 646f 6d20 646f 6375 6d65   a random docume
+0000a7c0: 6e74 2066 726f 6d20 7468 6520 636f 6c6c  nt from the coll
+0000a7d0: 6563 7469 6f6e 2e20 5265 7475 726e 7320  ection. Returns 
+0000a7e0: 4e6f 6e65 0a20 2020 2020 2020 2069 6620  None.        if 
+0000a7f0: 7468 6520 636f 6c6c 6563 7469 6f6e 2069  the collection i
+0000a800: 7320 656d 7074 792e 0a0a 2020 2020 2020  s empty...      
+0000a810: 2020 3a70 6172 616d 2061 6c6c 6f77 5f64    :param allow_d
+0000a820: 6972 7479 5f72 6561 643a 2041 6c6c 6f77  irty_read: Allow
+0000a830: 2072 6561 6473 2066 726f 6d20 666f 6c6c   reads from foll
+0000a840: 6f77 6572 7320 696e 2061 2063 6c75 7374  owers in a clust
+0000a850: 6572 2e0a 2020 2020 2020 2020 3a74 7970  er..        :typ
+0000a860: 6520 616c 6c6f 775f 6469 7274 795f 7265  e allow_dirty_re
+0000a870: 6164 3a20 626f 6f6c 0a20 2020 2020 2020  ad: bool.       
+0000a880: 203a 7265 7475 726e 3a20 4120 7261 6e64   :return: A rand
+0000a890: 6f6d 2064 6f63 756d 656e 742e 0a20 2020  om document..   
+0000a8a0: 2020 2020 203a 7274 7970 653a 2064 6963       :rtype: dic
+0000a8b0: 740a 2020 2020 2020 2020 3a72 6169 7365  t.        :raise
+0000a8c0: 2061 7261 6e67 6f2e 6578 6365 7074 696f   arango.exceptio
+0000a8d0: 6e73 2e44 6f63 756d 656e 7447 6574 4572  ns.DocumentGetEr
+0000a8e0: 726f 723a 2049 6620 7265 7472 6965 7661  ror: If retrieva
+0000a8f0: 6c20 6661 696c 732e 0a20 2020 2020 2020  l fails..       
+0000a900: 2022 2222 0a20 2020 2020 2020 2071 7565   """.        que
+0000a910: 7279 203d 2022 464f 5220 646f 6320 494e  ry = "FOR doc IN
+0000a920: 2040 4063 6f6c 6c65 6374 696f 6e20 534f   @@collection SO
+0000a930: 5254 2052 414e 4428 2920 4c49 4d49 5420  RT RAND() LIMIT 
+0000a940: 3120 5245 5455 524e 2064 6f63 220a 2020  1 RETURN doc".  
+0000a950: 2020 2020 2020 6269 6e64 5f76 6172 7320        bind_vars 
+0000a960: 3d20 7b22 4063 6f6c 6c65 6374 696f 6e22  = {"@collection"
+0000a970: 3a20 7365 6c66 2e6e 616d 657d 0a0a 2020  : self.name}..  
+0000a980: 2020 2020 2020 7265 7175 6573 7420 3d20        request = 
+0000a990: 5265 7175 6573 7428 0a20 2020 2020 2020  Request(.       
+0000a9a0: 2020 2020 206d 6574 686f 643d 2270 6f73       method="pos
+0000a9b0: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
+0000a9c0: 656e 6470 6f69 6e74 3d22 2f5f 6170 692f  endpoint="/_api/
+0000a9d0: 6375 7273 6f72 222c 0a20 2020 2020 2020  cursor",.       
+0000a9e0: 2020 2020 2064 6174 613d 7b22 7175 6572       data={"quer
+0000a9f0: 7922 3a20 7175 6572 792c 2022 6269 6e64  y": query, "bind
+0000aa00: 5661 7273 223a 2062 696e 645f 7661 7273  Vars": bind_vars
+0000aa10: 7d2c 0a20 2020 2020 2020 2020 2020 2072  },.            r
+0000aa20: 6561 643d 7365 6c66 2e6e 616d 652c 0a20  ead=self.name,. 
+0000aa30: 2020 2020 2020 2020 2020 2068 6561 6465             heade
+0000aa40: 7273 3d7b 2278 2d61 7261 6e67 6f2d 616c  rs={"x-arango-al
+0000aa50: 6c6f 772d 6469 7274 792d 7265 6164 223a  low-dirty-read":
+0000aa60: 2022 7472 7565 227d 2069 6620 616c 6c6f   "true"} if allo
+0000aa70: 775f 6469 7274 795f 7265 6164 2065 6c73  w_dirty_read els
+0000aa80: 6520 4e6f 6e65 2c0a 2020 2020 2020 2020  e None,.        
+0000aa90: 290a 0a20 2020 2020 2020 2064 6566 2072  )..        def r
+0000aaa0: 6573 706f 6e73 655f 6861 6e64 6c65 7228  esponse_handler(
+0000aab0: 7265 7370 3a20 5265 7370 6f6e 7365 2920  resp: Response) 
+0000aac0: 2d3e 204f 7074 696f 6e61 6c5b 4a73 6f6e  -> Optional[Json
+0000aad0: 5d3a 0a20 2020 2020 2020 2020 2020 2069  ]:.            i
+0000aae0: 6620 6e6f 7420 7265 7370 2e69 735f 7375  f not resp.is_su
+0000aaf0: 6363 6573 733a 0a20 2020 2020 2020 2020  ccess:.         
+0000ab00: 2020 2020 2020 2072 6169 7365 2044 6f63         raise Doc
+0000ab10: 756d 656e 7447 6574 4572 726f 7228 7265  umentGetError(re
+0000ab20: 7370 2c20 7265 7175 6573 7429 0a0a 2020  sp, request)..  
+0000ab30: 2020 2020 2020 2020 2020 6375 7273 6f72            cursor
+0000ab40: 203d 2043 7572 736f 7228 7365 6c66 2e5f   = Cursor(self._
+0000ab50: 636f 6e6e 2c20 7265 7370 2e62 6f64 7929  conn, resp.body)
+0000ab60: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000ab70: 7572 6e20 6375 7273 6f72 2e70 6f70 2829  urn cursor.pop()
+0000ab80: 2069 6620 6e6f 7420 6375 7273 6f72 2e65   if not cursor.e
+0000ab90: 6d70 7479 2829 2065 6c73 6520 4e6f 6e65  mpty() else None
+0000aba0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000abb0: 2073 656c 662e 5f65 7865 6375 7465 2872   self._execute(r
+0000abc0: 6571 7565 7374 2c20 7265 7370 6f6e 7365  equest, response
+0000abd0: 5f68 616e 646c 6572 290a 0a20 2020 2023  _handler)..    #
+0000abe0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0000abf0: 2323 230a 2020 2020 2320 496e 6465 7820  ###.    # Index 
+0000ac00: 4d61 6e61 6765 6d65 6e74 2023 0a20 2020  Management #.   
+0000ac10: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
+0000ac20: 2323 2323 230a 0a20 2020 2064 6566 2069  #####..    def i
+0000ac30: 6e64 6578 6573 2873 656c 6629 202d 3e20  ndexes(self) -> 
+0000ac40: 5265 7375 6c74 5b4a 736f 6e73 5d3a 0a20  Result[Jsons]:. 
+0000ac50: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+0000ac60: 2074 6865 2063 6f6c 6c65 6374 696f 6e20   the collection 
+0000ac70: 696e 6465 7865 732e 0a0a 2020 2020 2020  indexes...      
+0000ac80: 2020 3a72 6574 7572 6e3a 2043 6f6c 6c65    :return: Colle
+0000ac90: 6374 696f 6e20 696e 6465 7865 732e 0a20  ction indexes.. 
+0000aca0: 2020 2020 2020 203a 7274 7970 653a 205b         :rtype: [
+0000acb0: 6469 6374 5d0a 2020 2020 2020 2020 3a72  dict].        :r
+0000acc0: 6169 7365 2061 7261 6e67 6f2e 6578 6365  aise arango.exce
+0000acd0: 7074 696f 6e73 2e49 6e64 6578 4c69 7374  ptions.IndexList
+0000ace0: 4572 726f 723a 2049 6620 7265 7472 6965  Error: If retrie
+0000acf0: 7661 6c20 6661 696c 732e 0a20 2020 2020  val fails..     
+0000ad00: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+0000ad10: 6571 7565 7374 203d 2052 6571 7565 7374  equest = Request
+0000ad20: 280a 2020 2020 2020 2020 2020 2020 6d65  (.            me
+0000ad30: 7468 6f64 3d22 6765 7422 2c0a 2020 2020  thod="get",.    
+0000ad40: 2020 2020 2020 2020 656e 6470 6f69 6e74          endpoint
+0000ad50: 3d22 2f5f 6170 692f 696e 6465 7822 2c0a  ="/_api/index",.
+0000ad60: 2020 2020 2020 2020 2020 2020 7061 7261              para
+0000ad70: 6d73 3d7b 2263 6f6c 6c65 6374 696f 6e22  ms={"collection"
+0000ad80: 3a20 7365 6c66 2e6e 616d 657d 2c0a 2020  : self.name},.  
+0000ad90: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+0000ada0: 2064 6566 2072 6573 706f 6e73 655f 6861   def response_ha
+0000adb0: 6e64 6c65 7228 7265 7370 3a20 5265 7370  ndler(resp: Resp
+0000adc0: 6f6e 7365 2920 2d3e 204a 736f 6e73 3a0a  onse) -> Jsons:.
+0000add0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+0000ade0: 6f74 2072 6573 702e 6973 5f73 7563 6365  ot resp.is_succe
+0000adf0: 7373 3a0a 2020 2020 2020 2020 2020 2020  ss:.            
+0000ae00: 2020 2020 7261 6973 6520 496e 6465 784c      raise IndexL
+0000ae10: 6973 7445 7272 6f72 2872 6573 702c 2072  istError(resp, r
+0000ae20: 6571 7565 7374 290a 2020 2020 2020 2020  equest).        
+0000ae30: 2020 2020 7265 7375 6c74 203d 2072 6573      result = res
+0000ae40: 702e 626f 6479 5b22 696e 6465 7865 7322  p.body["indexes"
+0000ae50: 5d0a 2020 2020 2020 2020 2020 2020 7265  ].            re
+0000ae60: 7475 726e 205b 666f 726d 6174 5f69 6e64  turn [format_ind
+0000ae70: 6578 2869 6e64 6578 2920 666f 7220 696e  ex(index) for in
+0000ae80: 6465 7820 696e 2072 6573 756c 745d 0a0a  dex in result]..
+0000ae90: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000aea0: 656c 662e 5f65 7865 6375 7465 2872 6571  elf._execute(req
+0000aeb0: 7565 7374 2c20 7265 7370 6f6e 7365 5f68  uest, response_h
+0000aec0: 616e 646c 6572 290a 0a20 2020 2064 6566  andler)..    def
+0000aed0: 2067 6574 5f69 6e64 6578 2873 656c 662c   get_index(self,
+0000aee0: 2069 643a 2073 7472 2920 2d3e 2052 6573   id: str) -> Res
+0000aef0: 756c 745b 4a73 6f6e 5d3a 0a20 2020 2020  ult[Json]:.     
+0000af00: 2020 2022 2222 5265 7475 726e 2074 6865     """Return the
+0000af10: 2069 6e64 6578 2077 6974 6820 7468 6520   index with the 
+0000af20: 6769 7665 6e20 6964 2e0a 0a20 2020 2020  given id...     
+0000af30: 2020 203a 7061 7261 6d20 6964 3a20 5468     :param id: Th
+0000af40: 6520 6964 206f 6620 7468 6520 696e 6465  e id of the inde
+0000af50: 780a 2020 2020 2020 2020 3a74 7970 6520  x.        :type 
+0000af60: 6964 3a20 7374 720a 2020 2020 2020 2020  id: str.        
+0000af70: 3a72 6574 7572 6e3a 2049 6e64 6578 2064  :return: Index d
+0000af80: 6574 6169 6c73 0a20 2020 2020 2020 203a  etails.        :
+0000af90: 7274 7970 653a 2064 6963 740a 2020 2020  rtype: dict.    
+0000afa0: 2020 2020 3a72 6169 7365 2061 7261 6e67      :raise arang
+0000afb0: 6f2e 6578 6365 7074 696f 6e73 2e49 6e64  o.exceptions.Ind
+0000afc0: 6578 4765 7445 7272 6f72 3a20 4966 2072  exGetError: If r
+0000afd0: 6574 7269 6576 616c 2066 6169 6c73 2e0a  etrieval fails..
+0000afe0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000aff0: 2020 2020 7265 7175 6573 7420 3d20 5265      request = Re
+0000b000: 7175 6573 7428 0a20 2020 2020 2020 2020  quest(.         
+0000b010: 2020 206d 6574 686f 643d 2267 6574 222c     method="get",
+0000b020: 0a20 2020 2020 2020 2020 2020 2065 6e64  .            end
+0000b030: 706f 696e 743d 6622 2f5f 6170 692f 696e  point=f"/_api/in
+0000b040: 6465 782f 7b73 656c 662e 6e61 6d65 7d2f  dex/{self.name}/
+0000b050: 7b69 647d 222c 0a20 2020 2020 2020 2029  {id}",.        )
+0000b060: 0a0a 2020 2020 2020 2020 6465 6620 7265  ..        def re
+0000b070: 7370 6f6e 7365 5f68 616e 646c 6572 2872  sponse_handler(r
+0000b080: 6573 703a 2052 6573 706f 6e73 6529 202d  esp: Response) -
+0000b090: 3e20 4a73 6f6e 3a0a 2020 2020 2020 2020  > Json:.        
+0000b0a0: 2020 2020 6966 206e 6f74 2072 6573 702e      if not resp.
+0000b0b0: 6973 5f73 7563 6365 7373 3a0a 2020 2020  is_success:.    
+0000b0c0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000b0d0: 6520 496e 6465 7847 6574 4572 726f 7228  e IndexGetError(
+0000b0e0: 7265 7370 2c20 7265 7175 6573 7429 0a0a  resp, request)..
+0000b0f0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000b100: 726e 2066 6f72 6d61 745f 696e 6465 7828  rn format_index(
+0000b110: 7265 7370 2e62 6f64 7929 0a0a 2020 2020  resp.body)..    
+0000b120: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000b130: 5f65 7865 6375 7465 2872 6571 7565 7374  _execute(request
+0000b140: 2c20 7265 7370 6f6e 7365 5f68 616e 646c  , response_handl
+0000b150: 6572 290a 0a20 2020 2064 6566 2061 6464  er)..    def add
+0000b160: 5f69 6e64 6578 2873 656c 662c 2064 6174  _index(self, dat
+0000b170: 613a 204a 736f 6e2c 2066 6f72 6d61 7474  a: Json, formatt
+0000b180: 6572 3a20 626f 6f6c 203d 2046 616c 7365  er: bool = False
+0000b190: 2920 2d3e 2052 6573 756c 745b 4a73 6f6e  ) -> Result[Json
+0000b1a0: 5d3a 0a20 2020 2020 2020 2022 2222 4372  ]:.        """Cr
+0000b1b0: 6561 7465 2061 6e20 696e 6465 782e 0a0a  eate an index...
+0000b1c0: 2020 2020 2020 2020 2e2e 206e 6f74 653a          .. note:
+0000b1d0: 3a0a 0a20 2020 2020 2020 2020 2020 2041  :..            A
+0000b1e0: 7320 7468 6520 6061 6464 5f69 6e64 6578  s the `add_index
+0000b1f0: 6020 6d65 7468 6f64 2077 6173 206d 6164  ` method was mad
+0000b200: 6520 6176 6169 6c61 626c 6520 7374 6172  e available star
+0000b210: 7469 6e67 2077 6974 6820 6472 6976 6572  ting with driver
+0000b220: 0a20 2020 2020 2020 2020 2020 2076 6572  .            ver
+0000b230: 7369 6f6e 2038 2c20 7765 2068 6176 6520  sion 8, we have 
+0000b240: 6465 6369 6465 6420 746f 2064 6570 7265  decided to depre
+0000b250: 6361 7465 2074 6865 206f 7468 6572 2060  cate the other `
+0000b260: 6164 645f 2a5f 696e 6465 7860 0a20 2020  add_*_index`.   
+0000b270: 2020 2020 2020 2020 206d 6574 686f 6473           methods
+0000b280: 2c20 6d61 6b69 6e67 2074 6869 7320 7468  , making this th
+0000b290: 6520 6f66 6669 6369 616c 2077 6179 2074  e official way t
+0000b2a0: 6f20 6372 6561 7465 2069 6e64 6578 6573  o create indexes
+0000b2b0: 2e20 5768 696c 650a 2020 2020 2020 2020  . While.        
+0000b2c0: 2020 2020 7468 6520 6f74 6865 7220 6d65      the other me
+0000b2d0: 7468 6f64 7320 7374 696c 6c20 776f 726b  thods still work
+0000b2e0: 2c20 7765 2072 6563 6f6d 6d65 6e64 2075  , we recommend u
+0000b2f0: 7369 6e67 2074 6869 7320 6f6e 6520 696e  sing this one in
+0000b300: 7374 6561 642e 0a20 2020 2020 2020 2020  stead..         
+0000b310: 2020 204e 6f74 6520 7468 6174 2074 6865     Note that the
+0000b320: 206f 7468 6572 206d 6574 686f 6473 2077   other methods w
+0000b330: 6f75 6c64 2075 7365 2061 2066 6f72 6d61  ould use a forma
+0000b340: 7474 6572 2062 7920 6465 6661 756c 742c  tter by default,
+0000b350: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
+0000b360: 6365 7373 696e 6720 7468 6520 696e 6465  cessing the inde
+0000b370: 7820 6174 7472 6962 7574 6573 2072 6574  x attributes ret
+0000b380: 7572 6e65 6420 6279 2074 6865 2073 6572  urned by the ser
+0000b390: 7665 7220 2866 6f72 2074 6865 0a20 2020  ver (for the.   
+0000b3a0: 2020 2020 2020 2020 206d 6f73 7420 7061           most pa
+0000b3b0: 7274 2c20 6974 2064 6f65 7320 6120 736e  rt, it does a sn
+0000b3c0: 616b 6520 6361 7365 2063 6f6e 7665 7273  ake case convers
+0000b3d0: 696f 6e29 2e20 5468 6973 206d 6574 686f  ion). This metho
+0000b3e0: 6420 736b 6970 7320 7468 6174 2c0a 2020  d skips that,.  
+0000b3f0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0000b400: 696e 6720 7468 6520 7261 7720 696e 6465  ing the raw inde
+0000b410: 782c 2065 7863 6570 7420 666f 7220 7468  x, except for th
+0000b420: 6520 6069 6460 2061 7474 7269 6275 7465  e `id` attribute
+0000b430: 2e20 486f 7765 7665 722c 0a20 2020 2020  . However,.     
+0000b440: 2020 2020 2020 2069 6620 796f 7520 7761         if you wa
+0000b450: 6e74 2074 6865 2066 6f72 6d61 7474 6572  nt the formatter
+0000b460: 2074 6f20 6265 2061 7070 6c69 6564 2066   to be applied f
+0000b470: 6f72 2062 6163 6b77 6172 6473 2063 6f6d  or backwards com
+0000b480: 7061 7469 6269 6c69 7479 2c0a 2020 2020  patibility,.    
+0000b490: 2020 2020 2020 2020 796f 7520 6361 6e20          you can 
+0000b4a0: 7365 7420 7468 6520 6066 6f72 6d61 7474  set the `formatt
+0000b4b0: 6572 6020 7061 7261 6d65 7465 7220 746f  er` parameter to
+0000b4c0: 2060 5472 7565 602e 0a0a 2020 2020 2020   `True`...      
+0000b4d0: 2020 3a70 6172 616d 2064 6174 613a 2049    :param data: I
+0000b4e0: 6e64 6578 2064 6174 612e 204d 7573 7420  ndex data. Must 
+0000b4f0: 636f 6e74 6169 6e20 6120 2274 7970 6522  contain a "type"
+0000b500: 2061 6e64 2022 6669 656c 6473 2220 6174   and "fields" at
+0000b510: 7472 6962 7574 652e 0a20 2020 2020 2020  tribute..       
+0000b520: 203a 7479 7065 2064 6174 613a 2064 6963   :type data: dic
+0000b530: 740a 2020 2020 2020 2020 3a70 6172 616d  t.        :param
+0000b540: 2066 6f72 6d61 7474 6572 3a20 4966 2073   formatter: If s
+0000b550: 6574 2074 6f20 5472 7565 2c20 6170 706c  et to True, appl
+0000b560: 7920 666f 726d 6174 7469 6e67 2074 6f20  y formatting to 
+0000b570: 7468 6520 7265 7475 726e 6564 2072 6573  the returned res
+0000b580: 756c 742e 0a20 2020 2020 2020 2020 2020  ult..           
+0000b590: 2053 686f 756c 6420 6f6e 6c79 2062 6520   Should only be 
+0000b5a0: 7573 6564 2066 6f72 2062 6163 6b77 6172  used for backwar
+0000b5b0: 6473 2063 6f6d 7061 7469 6269 6c69 7479  ds compatibility
 0000b5c0: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
-0000b5d0: 756e 6971 7565 3a20 626f 6f6c 207c 204e  unique: bool | N
-0000b5e0: 6f6e 650a 2020 2020 2020 2020 3a70 6172  one.        :par
-0000b5f0: 616d 2073 7061 7273 653a 2049 6620 7365  am sparse: If se
-0000b600: 7420 746f 2054 7275 652c 2064 6f63 756d  t to True, docum
-0000b610: 656e 7473 2077 6974 6820 4e6f 6e65 2069  ents with None i
-0000b620: 6e20 7468 6520 6669 656c 640a 2020 2020  n the field.    
-0000b630: 2020 2020 2020 2020 6172 6520 616c 736f          are also
-0000b640: 2069 6e64 6578 6564 2e20 4966 2073 6574   indexed. If set
-0000b650: 2074 6f20 4661 6c73 652c 2074 6865 7920   to False, they 
-0000b660: 6172 6520 736b 6970 7065 642e 0a20 2020  are skipped..   
-0000b670: 2020 2020 203a 7479 7065 2073 7061 7273       :type spars
-0000b680: 653a 2062 6f6f 6c20 7c20 4e6f 6e65 0a20  e: bool | None. 
-0000b690: 2020 2020 2020 203a 7061 7261 6d20 6465         :param de
-0000b6a0: 6475 706c 6963 6174 653a 2049 6620 7365  duplicate: If se
-0000b6b0: 7420 746f 2054 7275 652c 2069 6e73 6572  t to True, inser
-0000b6c0: 7469 6e67 2064 7570 6c69 6361 7465 2069  ting duplicate i
-0000b6d0: 6e64 6578 2076 616c 7565 730a 2020 2020  ndex values.    
-0000b6e0: 2020 2020 2020 2020 6672 6f6d 2074 6865          from the
-0000b6f0: 2073 616d 6520 646f 6375 6d65 6e74 2074   same document t
-0000b700: 7269 6767 6572 7320 756e 6971 7565 2063  riggers unique c
-0000b710: 6f6e 7374 7261 696e 7420 6572 726f 7273  onstraint errors
-0000b720: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
-0000b730: 6465 6475 706c 6963 6174 653a 2062 6f6f  deduplicate: boo
-0000b740: 6c20 7c20 4e6f 6e65 0a20 2020 2020 2020  l | None.       
-0000b750: 203a 7061 7261 6d20 6e61 6d65 3a20 4f70   :param name: Op
-0000b760: 7469 6f6e 616c 206e 616d 6520 666f 7220  tional name for 
-0000b770: 7468 6520 696e 6465 782e 0a20 2020 2020  the index..     
-0000b780: 2020 203a 7479 7065 206e 616d 653a 2073     :type name: s
-0000b790: 7472 207c 204e 6f6e 650a 2020 2020 2020  tr | None.      
-0000b7a0: 2020 3a70 6172 616d 2069 6e5f 6261 636b    :param in_back
-0000b7b0: 6772 6f75 6e64 3a20 446f 206e 6f74 2068  ground: Do not h
-0000b7c0: 6f6c 6420 7468 6520 636f 6c6c 6563 7469  old the collecti
-0000b7d0: 6f6e 206c 6f63 6b2e 0a20 2020 2020 2020  on lock..       
-0000b7e0: 203a 7479 7065 2069 6e5f 6261 636b 6772   :type in_backgr
-0000b7f0: 6f75 6e64 3a20 626f 6f6c 207c 204e 6f6e  ound: bool | Non
-0000b800: 650a 2020 2020 2020 2020 3a72 6574 7572  e.        :retur
-0000b810: 6e3a 204e 6577 2069 6e64 6578 2064 6574  n: New index det
-0000b820: 6169 6c73 2e0a 2020 2020 2020 2020 3a72  ails..        :r
-0000b830: 7479 7065 3a20 6469 6374 0a20 2020 2020  type: dict.     
-0000b840: 2020 203a 7261 6973 6520 6172 616e 676f     :raise arango
-0000b850: 2e65 7863 6570 7469 6f6e 732e 496e 6465  .exceptions.Inde
-0000b860: 7843 7265 6174 6545 7272 6f72 3a20 4966  xCreateError: If
-0000b870: 2063 7265 6174 6520 6661 696c 732e 0a20   create fails.. 
-0000b880: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000b890: 2020 2064 6174 613a 204a 736f 6e20 3d20     data: Json = 
-0000b8a0: 7b22 7479 7065 223a 2022 6861 7368 222c  {"type": "hash",
-0000b8b0: 2022 6669 656c 6473 223a 2066 6965 6c64   "fields": field
-0000b8c0: 737d 0a0a 2020 2020 2020 2020 6966 2075  s}..        if u
-0000b8d0: 6e69 7175 6520 6973 206e 6f74 204e 6f6e  nique is not Non
-0000b8e0: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
-0000b8f0: 6174 615b 2275 6e69 7175 6522 5d20 3d20  ata["unique"] = 
-0000b900: 756e 6971 7565 0a20 2020 2020 2020 2069  unique.        i
-0000b910: 6620 7370 6172 7365 2069 7320 6e6f 7420  f sparse is not 
-0000b920: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0000b930: 2020 6461 7461 5b22 7370 6172 7365 225d    data["sparse"]
-0000b940: 203d 2073 7061 7273 650a 2020 2020 2020   = sparse.      
-0000b950: 2020 6966 2064 6564 7570 6c69 6361 7465    if deduplicate
-0000b960: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0000b970: 2020 2020 2020 2020 2020 6461 7461 5b22            data["
-0000b980: 6465 6475 706c 6963 6174 6522 5d20 3d20  deduplicate"] = 
-0000b990: 6465 6475 706c 6963 6174 650a 2020 2020  deduplicate.    
-0000b9a0: 2020 2020 6966 206e 616d 6520 6973 206e      if name is n
-0000b9b0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-0000b9c0: 2020 2020 2064 6174 615b 226e 616d 6522       data["name"
-0000b9d0: 5d20 3d20 6e61 6d65 0a20 2020 2020 2020  ] = name.       
-0000b9e0: 2069 6620 696e 5f62 6163 6b67 726f 756e   if in_backgroun
-0000b9f0: 6420 6973 206e 6f74 204e 6f6e 653a 0a20  d is not None:. 
-0000ba00: 2020 2020 2020 2020 2020 2064 6174 615b             data[
-0000ba10: 2269 6e42 6163 6b67 726f 756e 6422 5d20  "inBackground"] 
-0000ba20: 3d20 696e 5f62 6163 6b67 726f 756e 640a  = in_background.
-0000ba30: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000ba40: 7365 6c66 2e5f 6164 645f 696e 6465 7828  self._add_index(
-0000ba50: 6461 7461 290a 0a20 2020 2064 6566 2061  data)..    def a
-0000ba60: 6464 5f73 6b69 706c 6973 745f 696e 6465  dd_skiplist_inde
-0000ba70: 7828 0a20 2020 2020 2020 2073 656c 662c  x(.        self,
-0000ba80: 0a20 2020 2020 2020 2066 6965 6c64 733a  .        fields:
-0000ba90: 2053 6571 7565 6e63 655b 7374 725d 2c0a   Sequence[str],.
-0000baa0: 2020 2020 2020 2020 756e 6971 7565 3a20          unique: 
-0000bab0: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 203d  Optional[bool] =
-0000bac0: 204e 6f6e 652c 0a20 2020 2020 2020 2073   None,.        s
-0000bad0: 7061 7273 653a 204f 7074 696f 6e61 6c5b  parse: Optional[
-0000bae0: 626f 6f6c 5d20 3d20 4e6f 6e65 2c0a 2020  bool] = None,.  
-0000baf0: 2020 2020 2020 6465 6475 706c 6963 6174        deduplicat
-0000bb00: 653a 204f 7074 696f 6e61 6c5b 626f 6f6c  e: Optional[bool
-0000bb10: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-0000bb20: 2020 6e61 6d65 3a20 4f70 7469 6f6e 616c    name: Optional
-0000bb30: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
-0000bb40: 2020 2020 2020 696e 5f62 6163 6b67 726f        in_backgro
-0000bb50: 756e 643a 204f 7074 696f 6e61 6c5b 626f  und: Optional[bo
-0000bb60: 6f6c 5d20 3d20 4e6f 6e65 2c0a 2020 2020  ol] = None,.    
-0000bb70: 2920 2d3e 2052 6573 756c 745b 4a73 6f6e  ) -> Result[Json
-0000bb80: 5d3a 0a20 2020 2020 2020 2022 2222 4372  ]:.        """Cr
-0000bb90: 6561 7465 2061 206e 6577 2073 6b69 706c  eate a new skipl
-0000bba0: 6973 7420 696e 6465 782e 0a0a 2020 2020  ist index...    
-0000bbb0: 2020 2020 3a70 6172 616d 2066 6965 6c64      :param field
-0000bbc0: 733a 2044 6f63 756d 656e 7420 6669 656c  s: Document fiel
-0000bbd0: 6473 2074 6f20 696e 6465 782e 0a20 2020  ds to index..   
-0000bbe0: 2020 2020 203a 7479 7065 2066 6965 6c64       :type field
-0000bbf0: 733a 205b 7374 725d 0a20 2020 2020 2020  s: [str].       
-0000bc00: 203a 7061 7261 6d20 756e 6971 7565 3a20   :param unique: 
-0000bc10: 5768 6574 6865 7220 7468 6520 696e 6465  Whether the inde
-0000bc20: 7820 6973 2075 6e69 7175 652e 0a20 2020  x is unique..   
-0000bc30: 2020 2020 203a 7479 7065 2075 6e69 7175       :type uniqu
-0000bc40: 653a 2062 6f6f 6c20 7c20 4e6f 6e65 0a20  e: bool | None. 
-0000bc50: 2020 2020 2020 203a 7061 7261 6d20 7370         :param sp
-0000bc60: 6172 7365 3a20 4966 2073 6574 2074 6f20  arse: If set to 
-0000bc70: 5472 7565 2c20 646f 6375 6d65 6e74 7320  True, documents 
-0000bc80: 7769 7468 204e 6f6e 6520 696e 2074 6865  with None in the
-0000bc90: 2066 6965 6c64 0a20 2020 2020 2020 2020   field.         
-0000bca0: 2020 2061 7265 2061 6c73 6f20 696e 6465     are also inde
-0000bcb0: 7865 642e 2049 6620 7365 7420 746f 2046  xed. If set to F
-0000bcc0: 616c 7365 2c20 7468 6579 2061 7265 2073  alse, they are s
-0000bcd0: 6b69 7070 6564 2e0a 2020 2020 2020 2020  kipped..        
-0000bce0: 3a74 7970 6520 7370 6172 7365 3a20 626f  :type sparse: bo
-0000bcf0: 6f6c 207c 204e 6f6e 650a 2020 2020 2020  ol | None.      
-0000bd00: 2020 3a70 6172 616d 2064 6564 7570 6c69    :param dedupli
-0000bd10: 6361 7465 3a20 4966 2073 6574 2074 6f20  cate: If set to 
-0000bd20: 5472 7565 2c20 696e 7365 7274 696e 6720  True, inserting 
-0000bd30: 6475 706c 6963 6174 6520 696e 6465 7820  duplicate index 
-0000bd40: 7661 6c75 6573 0a20 2020 2020 2020 2020  values.         
-0000bd50: 2020 2066 726f 6d20 7468 6520 7361 6d65     from the same
-0000bd60: 2064 6f63 756d 656e 7420 7472 6967 6765   document trigge
-0000bd70: 7273 2075 6e69 7175 6520 636f 6e73 7472  rs unique constr
-0000bd80: 6169 6e74 2065 7272 6f72 732e 0a20 2020  aint errors..   
-0000bd90: 2020 2020 203a 7479 7065 2064 6564 7570       :type dedup
-0000bda0: 6c69 6361 7465 3a20 626f 6f6c 207c 204e  licate: bool | N
-0000bdb0: 6f6e 650a 2020 2020 2020 2020 3a70 6172  one.        :par
-0000bdc0: 616d 206e 616d 653a 204f 7074 696f 6e61  am name: Optiona
-0000bdd0: 6c20 6e61 6d65 2066 6f72 2074 6865 2069  l name for the i
-0000bde0: 6e64 6578 2e0a 2020 2020 2020 2020 3a74  ndex..        :t
-0000bdf0: 7970 6520 6e61 6d65 3a20 7374 7220 7c20  ype name: str | 
-0000be00: 4e6f 6e65 0a20 2020 2020 2020 203a 7061  None.        :pa
-0000be10: 7261 6d20 696e 5f62 6163 6b67 726f 756e  ram in_backgroun
-0000be20: 643a 2044 6f20 6e6f 7420 686f 6c64 2074  d: Do not hold t
-0000be30: 6865 2063 6f6c 6c65 6374 696f 6e20 6c6f  he collection lo
-0000be40: 636b 2e0a 2020 2020 2020 2020 3a74 7970  ck..        :typ
-0000be50: 6520 696e 5f62 6163 6b67 726f 756e 643a  e in_background:
-0000be60: 2062 6f6f 6c20 7c20 4e6f 6e65 0a20 2020   bool | None.   
-0000be70: 2020 2020 203a 7265 7475 726e 3a20 4e65       :return: Ne
-0000be80: 7720 696e 6465 7820 6465 7461 696c 732e  w index details.
-0000be90: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
-0000bea0: 2064 6963 740a 2020 2020 2020 2020 3a72   dict.        :r
-0000beb0: 6169 7365 2061 7261 6e67 6f2e 6578 6365  aise arango.exce
-0000bec0: 7074 696f 6e73 2e49 6e64 6578 4372 6561  ptions.IndexCrea
-0000bed0: 7465 4572 726f 723a 2049 6620 6372 6561  teError: If crea
-0000bee0: 7465 2066 6169 6c73 2e0a 2020 2020 2020  te fails..      
-0000bef0: 2020 2222 220a 2020 2020 2020 2020 6461    """.        da
-0000bf00: 7461 3a20 4a73 6f6e 203d 207b 2274 7970  ta: Json = {"typ
-0000bf10: 6522 3a20 2273 6b69 706c 6973 7422 2c20  e": "skiplist", 
-0000bf20: 2266 6965 6c64 7322 3a20 6669 656c 6473  "fields": fields
-0000bf30: 7d0a 0a20 2020 2020 2020 2069 6620 756e  }..        if un
-0000bf40: 6971 7565 2069 7320 6e6f 7420 4e6f 6e65  ique is not None
-0000bf50: 3a0a 2020 2020 2020 2020 2020 2020 6461  :.            da
-0000bf60: 7461 5b22 756e 6971 7565 225d 203d 2075  ta["unique"] = u
-0000bf70: 6e69 7175 650a 2020 2020 2020 2020 6966  nique.        if
-0000bf80: 2073 7061 7273 6520 6973 206e 6f74 204e   sparse is not N
-0000bf90: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0000bfa0: 2064 6174 615b 2273 7061 7273 6522 5d20   data["sparse"] 
-0000bfb0: 3d20 7370 6172 7365 0a20 2020 2020 2020  = sparse.       
-0000bfc0: 2069 6620 6465 6475 706c 6963 6174 6520   if deduplicate 
-0000bfd0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-0000bfe0: 2020 2020 2020 2020 2064 6174 615b 2264           data["d
-0000bff0: 6564 7570 6c69 6361 7465 225d 203d 2064  eduplicate"] = d
-0000c000: 6564 7570 6c69 6361 7465 0a20 2020 2020  eduplicate.     
-0000c010: 2020 2069 6620 6e61 6d65 2069 7320 6e6f     if name is no
-0000c020: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-0000c030: 2020 2020 6461 7461 5b22 6e61 6d65 225d      data["name"]
-0000c040: 203d 206e 616d 650a 2020 2020 2020 2020   = name.        
-0000c050: 6966 2069 6e5f 6261 636b 6772 6f75 6e64  if in_background
-0000c060: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0000c070: 2020 2020 2020 2020 2020 6461 7461 5b22            data["
-0000c080: 696e 4261 636b 6772 6f75 6e64 225d 203d  inBackground"] =
-0000c090: 2069 6e5f 6261 636b 6772 6f75 6e64 0a0a   in_background..
-0000c0a0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000c0b0: 656c 662e 5f61 6464 5f69 6e64 6578 2864  elf._add_index(d
-0000c0c0: 6174 6129 0a0a 2020 2020 6465 6620 6164  ata)..    def ad
-0000c0d0: 645f 6765 6f5f 696e 6465 7828 0a20 2020  d_geo_index(.   
-0000c0e0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0000c0f0: 2020 2066 6965 6c64 733a 2046 6965 6c64     fields: Field
-0000c100: 732c 0a20 2020 2020 2020 206f 7264 6572  s,.        order
-0000c110: 6564 3a20 4f70 7469 6f6e 616c 5b62 6f6f  ed: Optional[boo
-0000c120: 6c5d 203d 204e 6f6e 652c 0a20 2020 2020  l] = None,.     
-0000c130: 2020 206e 616d 653a 204f 7074 696f 6e61     name: Optiona
-0000c140: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
-0000c150: 2020 2020 2020 2069 6e5f 6261 636b 6772         in_backgr
-0000c160: 6f75 6e64 3a20 4f70 7469 6f6e 616c 5b62  ound: Optional[b
-0000c170: 6f6f 6c5d 203d 204e 6f6e 652c 0a20 2020  ool] = None,.   
-0000c180: 2020 2020 206c 6567 6163 7950 6f6c 7967       legacyPolyg
-0000c190: 6f6e 733a 204f 7074 696f 6e61 6c5b 626f  ons: Optional[bo
-0000c1a0: 6f6c 5d20 3d20 4661 6c73 652c 0a20 2020  ol] = False,.   
-0000c1b0: 2029 202d 3e20 5265 7375 6c74 5b4a 736f   ) -> Result[Jso
-0000c1c0: 6e5d 3a0a 2020 2020 2020 2020 2222 2243  n]:.        """C
-0000c1d0: 7265 6174 6520 6120 6e65 7720 6765 6f2d  reate a new geo-
-0000c1e0: 7370 6174 6961 6c20 696e 6465 782e 0a0a  spatial index...
-0000c1f0: 2020 2020 2020 2020 3a70 6172 616d 2066          :param f
-0000c200: 6965 6c64 733a 2041 2073 696e 676c 6520  ields: A single 
-0000c210: 646f 6375 6d65 6e74 2066 6965 6c64 206f  document field o
-0000c220: 7220 6120 6c69 7374 206f 6620 646f 6375  r a list of docu
-0000c230: 6d65 6e74 2066 6965 6c64 732e 2049 660a  ment fields. If.
-0000c240: 2020 2020 2020 2020 2020 2020 6120 7369              a si
-0000c250: 6e67 6c65 2066 6965 6c64 2069 7320 6769  ngle field is gi
-0000c260: 7665 6e2c 2074 6865 2066 6965 6c64 206d  ven, the field m
-0000c270: 7573 7420 6861 7665 2076 616c 7565 7320  ust have values 
-0000c280: 7468 6174 2061 7265 206c 6973 7473 0a20  that are lists. 
-0000c290: 2020 2020 2020 2020 2020 2077 6974 6820             with 
-0000c2a0: 6174 206c 6561 7374 2074 776f 2066 6c6f  at least two flo
-0000c2b0: 6174 732e 2044 6f63 756d 656e 7473 2077  ats. Documents w
-0000c2c0: 6974 6820 6d69 7373 696e 6720 6669 656c  ith missing fiel
-0000c2d0: 6473 206f 7220 696e 7661 6c69 640a 2020  ds or invalid.  
-0000c2e0: 2020 2020 2020 2020 2020 7661 6c75 6573            values
-0000c2f0: 2061 7265 2065 7863 6c75 6465 642e 0a20   are excluded.. 
-0000c300: 2020 2020 2020 203a 7479 7065 2066 6965         :type fie
-0000c310: 6c64 733a 2073 7472 207c 205b 7374 725d  lds: str | [str]
-0000c320: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000c330: 6f72 6465 7265 643a 2057 6865 7468 6572  ordered: Whether
-0000c340: 2074 6865 206f 7264 6572 2069 7320 6c6f   the order is lo
-0000c350: 6e67 6974 7564 652c 2074 6865 6e20 6c61  ngitude, then la
-0000c360: 7469 7475 6465 2e0a 2020 2020 2020 2020  titude..        
-0000c370: 3a74 7970 6520 6f72 6465 7265 643a 2062  :type ordered: b
-0000c380: 6f6f 6c20 7c20 4e6f 6e65 0a20 2020 2020  ool | None.     
-0000c390: 2020 203a 7061 7261 6d20 6e61 6d65 3a20     :param name: 
-0000c3a0: 4f70 7469 6f6e 616c 206e 616d 6520 666f  Optional name fo
-0000c3b0: 7220 7468 6520 696e 6465 782e 0a20 2020  r the index..   
-0000c3c0: 2020 2020 203a 7479 7065 206e 616d 653a       :type name:
-0000c3d0: 2073 7472 207c 204e 6f6e 650a 2020 2020   str | None.    
-0000c3e0: 2020 2020 3a70 6172 616d 2069 6e5f 6261      :param in_ba
-0000c3f0: 636b 6772 6f75 6e64 3a20 446f 206e 6f74  ckground: Do not
-0000c400: 2068 6f6c 6420 7468 6520 636f 6c6c 6563   hold the collec
-0000c410: 7469 6f6e 206c 6f63 6b2e 0a20 2020 2020  tion lock..     
-0000c420: 2020 203a 7479 7065 2069 6e5f 6261 636b     :type in_back
-0000c430: 6772 6f75 6e64 3a20 626f 6f6c 207c 204e  ground: bool | N
-0000c440: 6f6e 650a 2020 2020 2020 2020 3a70 6172  one.        :par
-0000c450: 616d 206c 6567 6163 7950 6f6c 7967 6f6e  am legacyPolygon
-0000c460: 733a 2057 6865 7468 6572 206f 7220 6e6f  s: Whether or no
-0000c470: 7420 746f 2075 7365 2075 7365 2074 6865  t to use use the
-0000c480: 206f 6c64 2c20 7072 652d 332e 3130 2072   old, pre-3.10 r
-0000c490: 756c 6573 0a20 2020 2020 2020 2020 2020  ules.           
-0000c4a0: 2066 6f72 2074 6865 2070 6172 7369 6e67   for the parsing
-0000c4b0: 2047 656f 4a53 4f4e 2070 6f6c 7967 6f6e   GeoJSON polygon
-0000c4c0: 730a 2020 2020 2020 2020 3a74 7970 6520  s.        :type 
-0000c4d0: 6c65 6761 6379 506f 6c79 676f 6e73 3a20  legacyPolygons: 
-0000c4e0: 626f 6f6c 207c 204e 6f6e 650a 2020 2020  bool | None.    
-0000c4f0: 2020 2020 3a72 6574 7572 6e3a 204e 6577      :return: New
-0000c500: 2069 6e64 6578 2064 6574 6169 6c73 2e0a   index details..
-0000c510: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
-0000c520: 6469 6374 0a20 2020 2020 2020 203a 7261  dict.        :ra
-0000c530: 6973 6520 6172 616e 676f 2e65 7863 6570  ise arango.excep
-0000c540: 7469 6f6e 732e 496e 6465 7843 7265 6174  tions.IndexCreat
-0000c550: 6545 7272 6f72 3a20 4966 2063 7265 6174  eError: If creat
-0000c560: 6520 6661 696c 732e 0a20 2020 2020 2020  e fails..       
-0000c570: 2022 2222 0a20 2020 2020 2020 2064 6174   """.        dat
-0000c580: 613a 204a 736f 6e20 3d20 7b22 7479 7065  a: Json = {"type
-0000c590: 223a 2022 6765 6f22 2c20 2266 6965 6c64  ": "geo", "field
-0000c5a0: 7322 3a20 6669 656c 6473 7d0a 0a20 2020  s": fields}..   
-0000c5b0: 2020 2020 2069 6620 6f72 6465 7265 6420       if ordered 
-0000c5c0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-0000c5d0: 2020 2020 2020 2020 2064 6174 615b 2267           data["g
-0000c5e0: 656f 4a73 6f6e 225d 203d 206f 7264 6572  eoJson"] = order
-0000c5f0: 6564 0a20 2020 2020 2020 2069 6620 6e61  ed.        if na
-0000c600: 6d65 2069 7320 6e6f 7420 4e6f 6e65 3a0a  me is not None:.
-0000c610: 2020 2020 2020 2020 2020 2020 6461 7461              data
-0000c620: 5b22 6e61 6d65 225d 203d 206e 616d 650a  ["name"] = name.
-0000c630: 2020 2020 2020 2020 6966 2069 6e5f 6261          if in_ba
-0000c640: 636b 6772 6f75 6e64 2069 7320 6e6f 7420  ckground is not 
-0000c650: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0000c660: 2020 6461 7461 5b22 696e 4261 636b 6772    data["inBackgr
-0000c670: 6f75 6e64 225d 203d 2069 6e5f 6261 636b  ound"] = in_back
-0000c680: 6772 6f75 6e64 0a20 2020 2020 2020 2069  ground.        i
-0000c690: 6620 6c65 6761 6379 506f 6c79 676f 6e73  f legacyPolygons
-0000c6a0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0000c6b0: 2020 2020 2020 2020 2020 6461 7461 5b22            data["
-0000c6c0: 6c65 6761 6379 506f 6c79 676f 6e73 225d  legacyPolygons"]
-0000c6d0: 203d 206c 6567 6163 7950 6f6c 7967 6f6e   = legacyPolygon
-0000c6e0: 730a 0a20 2020 2020 2020 2072 6574 7572  s..        retur
-0000c6f0: 6e20 7365 6c66 2e5f 6164 645f 696e 6465  n self._add_inde
-0000c700: 7828 6461 7461 290a 0a20 2020 2064 6566  x(data)..    def
-0000c710: 2061 6464 5f66 756c 6c74 6578 745f 696e   add_fulltext_in
-0000c720: 6465 7828 0a20 2020 2020 2020 2073 656c  dex(.        sel
-0000c730: 662c 0a20 2020 2020 2020 2066 6965 6c64  f,.        field
-0000c740: 733a 2053 6571 7565 6e63 655b 7374 725d  s: Sequence[str]
-0000c750: 2c0a 2020 2020 2020 2020 6d69 6e5f 6c65  ,.        min_le
-0000c760: 6e67 7468 3a20 4f70 7469 6f6e 616c 5b69  ngth: Optional[i
-0000c770: 6e74 5d20 3d20 4e6f 6e65 2c0a 2020 2020  nt] = None,.    
-0000c780: 2020 2020 6e61 6d65 3a20 4f70 7469 6f6e      name: Option
-0000c790: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
-0000c7a0: 2020 2020 2020 2020 696e 5f62 6163 6b67          in_backg
-0000c7b0: 726f 756e 643a 204f 7074 696f 6e61 6c5b  round: Optional[
-0000c7c0: 626f 6f6c 5d20 3d20 4e6f 6e65 2c0a 2020  bool] = None,.  
-0000c7d0: 2020 2920 2d3e 2052 6573 756c 745b 4a73    ) -> Result[Js
-0000c7e0: 6f6e 5d3a 0a20 2020 2020 2020 2022 2222  on]:.        """
-0000c7f0: 4372 6561 7465 2061 206e 6577 2066 756c  Create a new ful
-0000c800: 6c74 6578 7420 696e 6465 782e 2054 6869  ltext index. Thi
-0000c810: 7320 6d65 7468 6f64 2069 7320 6465 7072  s method is depr
-0000c820: 6563 6174 6564 0a20 2020 2020 2020 2020  ecated.         
-0000c830: 2020 2069 6e20 4172 616e 676f 4442 2033     in ArangoDB 3
-0000c840: 2e31 3020 616e 6420 7769 6c6c 2062 6520  .10 and will be 
-0000c850: 7265 6d6f 7665 6420 696e 2061 2066 7574  removed in a fut
-0000c860: 7572 6520 7665 7273 696f 6e0a 2020 2020  ure version.    
-0000c870: 2020 2020 2020 2020 6f66 2074 6865 2064          of the d
-0000c880: 7269 7665 722e 0a0a 2020 2020 2020 2020  river...        
-0000c890: 3a70 6172 616d 2066 6965 6c64 733a 2044  :param fields: D
-0000c8a0: 6f63 756d 656e 7420 6669 656c 6473 2074  ocument fields t
-0000c8b0: 6f20 696e 6465 782e 0a20 2020 2020 2020  o index..       
-0000c8c0: 203a 7479 7065 2066 6965 6c64 733a 205b   :type fields: [
-0000c8d0: 7374 725d 0a20 2020 2020 2020 203a 7061  str].        :pa
-0000c8e0: 7261 6d20 6d69 6e5f 6c65 6e67 7468 3a20  ram min_length: 
-0000c8f0: 4d69 6e69 6d75 6d20 6e75 6d62 6572 206f  Minimum number o
-0000c900: 6620 6368 6172 6163 7465 7273 2074 6f20  f characters to 
-0000c910: 696e 6465 782e 0a20 2020 2020 2020 203a  index..        :
-0000c920: 7479 7065 206d 696e 5f6c 656e 6774 683a  type min_length:
-0000c930: 2069 6e74 207c 204e 6f6e 650a 2020 2020   int | None.    
-0000c940: 2020 2020 3a70 6172 616d 206e 616d 653a      :param name:
-0000c950: 204f 7074 696f 6e61 6c20 6e61 6d65 2066   Optional name f
-0000c960: 6f72 2074 6865 2069 6e64 6578 2e0a 2020  or the index..  
-0000c970: 2020 2020 2020 3a74 7970 6520 6e61 6d65        :type name
-0000c980: 3a20 7374 7220 7c20 4e6f 6e65 0a20 2020  : str | None.   
-0000c990: 2020 2020 203a 7061 7261 6d20 696e 5f62       :param in_b
-0000c9a0: 6163 6b67 726f 756e 643a 2044 6f20 6e6f  ackground: Do no
-0000c9b0: 7420 686f 6c64 2074 6865 2063 6f6c 6c65  t hold the colle
-0000c9c0: 6374 696f 6e20 6c6f 636b 2e0a 2020 2020  ction lock..    
-0000c9d0: 2020 2020 3a74 7970 6520 696e 5f62 6163      :type in_bac
-0000c9e0: 6b67 726f 756e 643a 2062 6f6f 6c20 7c20  kground: bool | 
-0000c9f0: 4e6f 6e65 0a20 2020 2020 2020 203a 7265  None.        :re
-0000ca00: 7475 726e 3a20 4e65 7720 696e 6465 7820  turn: New index 
-0000ca10: 6465 7461 696c 732e 0a20 2020 2020 2020  details..       
-0000ca20: 203a 7274 7970 653a 2064 6963 740a 2020   :rtype: dict.  
-0000ca30: 2020 2020 2020 3a72 6169 7365 2061 7261        :raise ara
-0000ca40: 6e67 6f2e 6578 6365 7074 696f 6e73 2e49  ngo.exceptions.I
-0000ca50: 6e64 6578 4372 6561 7465 4572 726f 723a  ndexCreateError:
-0000ca60: 2049 6620 6372 6561 7465 2066 6169 6c73   If create fails
-0000ca70: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0000ca80: 2020 2020 2020 6461 7461 3a20 4a73 6f6e        data: Json
-0000ca90: 203d 207b 2274 7970 6522 3a20 2266 756c   = {"type": "ful
-0000caa0: 6c74 6578 7422 2c20 2266 6965 6c64 7322  ltext", "fields"
-0000cab0: 3a20 6669 656c 6473 7d0a 0a20 2020 2020  : fields}..     
-0000cac0: 2020 2069 6620 6d69 6e5f 6c65 6e67 7468     if min_length
-0000cad0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0000cae0: 2020 2020 2020 2020 2020 6461 7461 5b22            data["
-0000caf0: 6d69 6e4c 656e 6774 6822 5d20 3d20 6d69  minLength"] = mi
-0000cb00: 6e5f 6c65 6e67 7468 0a20 2020 2020 2020  n_length.       
-0000cb10: 2069 6620 6e61 6d65 2069 7320 6e6f 7420   if name is not 
-0000cb20: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0000cb30: 2020 6461 7461 5b22 6e61 6d65 225d 203d    data["name"] =
-0000cb40: 206e 616d 650a 2020 2020 2020 2020 6966   name.        if
-0000cb50: 2069 6e5f 6261 636b 6772 6f75 6e64 2069   in_background i
-0000cb60: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0000cb70: 2020 2020 2020 2020 6461 7461 5b22 696e          data["in
-0000cb80: 4261 636b 6772 6f75 6e64 225d 203d 2069  Background"] = i
-0000cb90: 6e5f 6261 636b 6772 6f75 6e64 0a0a 2020  n_background..  
-0000cba0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000cbb0: 662e 5f61 6464 5f69 6e64 6578 2864 6174  f._add_index(dat
-0000cbc0: 6129 0a0a 2020 2020 6465 6620 6164 645f  a)..    def add_
-0000cbd0: 7065 7273 6973 7465 6e74 5f69 6e64 6578  persistent_index
-0000cbe0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0000cbf0: 2020 2020 2020 2020 6669 656c 6473 3a20          fields: 
-0000cc00: 5365 7175 656e 6365 5b73 7472 5d2c 0a20  Sequence[str],. 
-0000cc10: 2020 2020 2020 2075 6e69 7175 653a 204f         unique: O
-0000cc20: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
-0000cc30: 4e6f 6e65 2c0a 2020 2020 2020 2020 7370  None,.        sp
-0000cc40: 6172 7365 3a20 4f70 7469 6f6e 616c 5b62  arse: Optional[b
-0000cc50: 6f6f 6c5d 203d 204e 6f6e 652c 0a20 2020  ool] = None,.   
-0000cc60: 2020 2020 206e 616d 653a 204f 7074 696f       name: Optio
-0000cc70: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
-0000cc80: 0a20 2020 2020 2020 2069 6e5f 6261 636b  .        in_back
-0000cc90: 6772 6f75 6e64 3a20 4f70 7469 6f6e 616c  ground: Optional
-0000cca0: 5b62 6f6f 6c5d 203d 204e 6f6e 652c 0a20  [bool] = None,. 
-0000ccb0: 2020 2020 2020 2073 746f 7265 6456 616c         storedVal
-0000ccc0: 7565 733a 204f 7074 696f 6e61 6c5b 5365  ues: Optional[Se
-0000ccd0: 7175 656e 6365 5b73 7472 5d5d 203d 204e  quence[str]] = N
-0000cce0: 6f6e 652c 0a20 2020 2020 2020 2063 6163  one,.        cac
-0000ccf0: 6865 456e 6162 6c65 643a 204f 7074 696f  heEnabled: Optio
-0000cd00: 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65  nal[bool] = None
-0000cd10: 2c0a 2020 2020 2920 2d3e 2052 6573 756c  ,.    ) -> Resul
-0000cd20: 745b 4a73 6f6e 5d3a 0a20 2020 2020 2020  t[Json]:.       
-0000cd30: 2022 2222 4372 6561 7465 2061 206e 6577   """Create a new
-0000cd40: 2070 6572 7369 7374 656e 7420 696e 6465   persistent inde
-0000cd50: 782e 0a0a 2020 2020 2020 2020 556e 6971  x...        Uniq
-0000cd60: 7565 2070 6572 7369 7374 656e 7420 696e  ue persistent in
-0000cd70: 6465 7865 7320 6f6e 206e 6f6e 2d73 6861  dexes on non-sha
-0000cd80: 7264 6564 206b 6579 7320 6172 6520 6e6f  rded keys are no
-0000cd90: 7420 7375 7070 6f72 7465 6420 696e 2061  t supported in a
-0000cda0: 0a20 2020 2020 2020 2063 6c75 7374 6572  .        cluster
-0000cdb0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-0000cdc0: 6d20 6669 656c 6473 3a20 446f 6375 6d65  m fields: Docume
-0000cdd0: 6e74 2066 6965 6c64 7320 746f 2069 6e64  nt fields to ind
-0000cde0: 6578 2e0a 2020 2020 2020 2020 3a74 7970  ex..        :typ
-0000cdf0: 6520 6669 656c 6473 3a20 5b73 7472 5d0a  e fields: [str].
-0000ce00: 2020 2020 2020 2020 3a70 6172 616d 2075          :param u
-0000ce10: 6e69 7175 653a 2057 6865 7468 6572 2074  nique: Whether t
-0000ce20: 6865 2069 6e64 6578 2069 7320 756e 6971  he index is uniq
-0000ce30: 7565 2e0a 2020 2020 2020 2020 3a74 7970  ue..        :typ
-0000ce40: 6520 756e 6971 7565 3a20 626f 6f6c 207c  e unique: bool |
-0000ce50: 204e 6f6e 650a 2020 2020 2020 2020 3a70   None.        :p
-0000ce60: 6172 616d 2073 7061 7273 653a 2045 7863  aram sparse: Exc
-0000ce70: 6c75 6465 2064 6f63 756d 656e 7473 2074  lude documents t
-0000ce80: 6861 7420 646f 206e 6f74 2063 6f6e 7461  hat do not conta
-0000ce90: 696e 2061 7420 6c65 6173 7420 6f6e 6520  in at least one 
-0000cea0: 6f66 0a20 2020 2020 2020 2020 2020 2074  of.            t
-0000ceb0: 6865 2069 6e64 6578 6564 2066 6965 6c64  he indexed field
-0000cec0: 732c 206f 7220 646f 6375 6d65 6e74 7320  s, or documents 
-0000ced0: 7468 6174 2068 6176 6520 6120 7661 6c75  that have a valu
-0000cee0: 6520 6f66 204e 6f6e 6520 696e 2061 6e79  e of None in any
-0000cef0: 0a20 2020 2020 2020 2020 2020 206f 6620  .            of 
-0000cf00: 7468 6520 696e 6465 7865 6420 6669 656c  the indexed fiel
-0000cf10: 6473 2e0a 2020 2020 2020 2020 3a74 7970  ds..        :typ
-0000cf20: 6520 7370 6172 7365 3a20 626f 6f6c 207c  e sparse: bool |
-0000cf30: 204e 6f6e 650a 2020 2020 2020 2020 3a70   None.        :p
-0000cf40: 6172 616d 206e 616d 653a 204f 7074 696f  aram name: Optio
-0000cf50: 6e61 6c20 6e61 6d65 2066 6f72 2074 6865  nal name for the
-0000cf60: 2069 6e64 6578 2e0a 2020 2020 2020 2020   index..        
-0000cf70: 3a74 7970 6520 6e61 6d65 3a20 7374 7220  :type name: str 
-0000cf80: 7c20 4e6f 6e65 0a20 2020 2020 2020 203a  | None.        :
-0000cf90: 7061 7261 6d20 696e 5f62 6163 6b67 726f  param in_backgro
-0000cfa0: 756e 643a 2044 6f20 6e6f 7420 686f 6c64  und: Do not hold
-0000cfb0: 2074 6865 2063 6f6c 6c65 6374 696f 6e20   the collection 
-0000cfc0: 6c6f 636b 2e0a 2020 2020 2020 2020 3a74  lock..        :t
-0000cfd0: 7970 6520 696e 5f62 6163 6b67 726f 756e  ype in_backgroun
-0000cfe0: 643a 2062 6f6f 6c20 7c20 4e6f 6e65 0a20  d: bool | None. 
-0000cff0: 2020 2020 2020 203a 7061 7261 6d20 7374         :param st
-0000d000: 6f72 6564 5661 6c75 6573 3a20 4164 6469  oredValues: Addi
-0000d010: 7469 6f6e 616c 2061 7474 7269 6275 7465  tional attribute
-0000d020: 7320 746f 2069 6e63 6c75 6465 2069 6e20  s to include in 
-0000d030: 6120 7065 7273 6973 7465 6e74 0a20 2020  a persistent.   
-0000d040: 2020 2020 2020 2020 2069 6e64 6578 2e20           index. 
-0000d050: 5468 6573 6520 6164 6469 7469 6f6e 616c  These additional
-0000d060: 2061 7474 7269 6275 7465 7320 6361 6e6e   attributes cann
-0000d070: 6f74 2062 6520 7573 6564 2066 6f72 2069  ot be used for i
-0000d080: 6e64 6578 0a20 2020 2020 2020 2020 2020  ndex.           
-0000d090: 206c 6f6f 6b75 7073 206f 7220 736f 7274   lookups or sort
-0000d0a0: 732c 2062 7574 2074 6865 7920 6361 6e20  s, but they can 
-0000d0b0: 6265 2075 7365 6420 666f 7220 7072 6f6a  be used for proj
-0000d0c0: 6563 7469 6f6e 732e 204d 7573 7420 6265  ections. Must be
-0000d0d0: 0a20 2020 2020 2020 2020 2020 2061 6e20  .            an 
-0000d0e0: 6172 7261 7920 6f66 2069 6e64 6578 2061  array of index a
-0000d0f0: 7474 7269 6275 7465 2070 6174 6873 2e20  ttribute paths. 
-0000d100: 5468 6572 6520 6d75 7374 2062 6520 6e6f  There must be no
-0000d110: 206f 7665 726c 6170 206f 660a 2020 2020   overlap of.    
-0000d120: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
-0000d130: 6520 7061 7468 7320 6265 7477 6565 6e20  e paths between 
-0000d140: 6669 656c 6473 2061 6e64 2073 746f 7265  fields and store
-0000d150: 6456 616c 7565 732e 2054 6865 206d 6178  dValues. The max
-0000d160: 696d 756d 0a20 2020 2020 2020 2020 2020  imum.           
-0000d170: 206e 756d 6265 7220 6f66 2076 616c 7565   number of value
-0000d180: 7320 6973 2033 322e 0a20 2020 2020 2020  s is 32..       
-0000d190: 203a 7479 7065 2073 746f 7265 6456 616c   :type storedVal
-0000d1a0: 7565 733a 205b 7374 725d 0a20 2020 2020  ues: [str].     
-0000d1b0: 2020 203a 7061 7261 6d20 6361 6368 6545     :param cacheE
-0000d1c0: 6e61 626c 6564 3a20 456e 6162 6c65 2061  nabled: Enable a
-0000d1d0: 6e20 696e 2d6d 656d 6f72 7920 6361 6368  n in-memory cach
-0000d1e0: 6520 666f 7220 696e 6465 7820 7661 6c75  e for index valu
-0000d1f0: 6573 2066 6f72 0a20 2020 2020 2020 2020  es for.         
-0000d200: 2020 2070 6572 7369 7374 656e 7420 696e     persistent in
-0000d210: 6465 7865 732e 0a20 2020 2020 2020 203a  dexes..        :
-0000d220: 7479 7065 2063 6163 6865 456e 6162 6c65  type cacheEnable
-0000d230: 643a 2062 6f6f 6c20 7c20 4e6f 6e65 0a20  d: bool | None. 
-0000d240: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
-0000d250: 4e65 7720 696e 6465 7820 6465 7461 696c  New index detail
-0000d260: 732e 0a20 2020 2020 2020 203a 7274 7970  s..        :rtyp
-0000d270: 653a 2064 6963 740a 2020 2020 2020 2020  e: dict.        
-0000d280: 3a72 6169 7365 2061 7261 6e67 6f2e 6578  :raise arango.ex
-0000d290: 6365 7074 696f 6e73 2e49 6e64 6578 4372  ceptions.IndexCr
-0000d2a0: 6561 7465 4572 726f 723a 2049 6620 6372  eateError: If cr
-0000d2b0: 6561 7465 2066 6169 6c73 2e0a 2020 2020  eate fails..    
-0000d2c0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000d2d0: 6461 7461 3a20 4a73 6f6e 203d 207b 2274  data: Json = {"t
-0000d2e0: 7970 6522 3a20 2270 6572 7369 7374 656e  ype": "persisten
-0000d2f0: 7422 2c20 2266 6965 6c64 7322 3a20 6669  t", "fields": fi
-0000d300: 656c 6473 7d0a 0a20 2020 2020 2020 2069  elds}..        i
-0000d310: 6620 756e 6971 7565 2069 7320 6e6f 7420  f unique is not 
-0000d320: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0000d330: 2020 6461 7461 5b22 756e 6971 7565 225d    data["unique"]
-0000d340: 203d 2075 6e69 7175 650a 2020 2020 2020   = unique.      
-0000d350: 2020 6966 2073 7061 7273 6520 6973 206e    if sparse is n
-0000d360: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-0000d370: 2020 2020 2064 6174 615b 2273 7061 7273       data["spars
-0000d380: 6522 5d20 3d20 7370 6172 7365 0a20 2020  e"] = sparse.   
-0000d390: 2020 2020 2069 6620 6e61 6d65 2069 7320       if name is 
-0000d3a0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-0000d3b0: 2020 2020 2020 6461 7461 5b22 6e61 6d65        data["name
-0000d3c0: 225d 203d 206e 616d 650a 2020 2020 2020  "] = name.      
-0000d3d0: 2020 6966 2069 6e5f 6261 636b 6772 6f75    if in_backgrou
-0000d3e0: 6e64 2069 7320 6e6f 7420 4e6f 6e65 3a0a  nd is not None:.
-0000d3f0: 2020 2020 2020 2020 2020 2020 6461 7461              data
-0000d400: 5b22 696e 4261 636b 6772 6f75 6e64 225d  ["inBackground"]
-0000d410: 203d 2069 6e5f 6261 636b 6772 6f75 6e64   = in_background
-0000d420: 0a20 2020 2020 2020 2069 6620 7374 6f72  .        if stor
-0000d430: 6564 5661 6c75 6573 2069 7320 6e6f 7420  edValues is not 
-0000d440: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0000d450: 2020 6461 7461 5b22 7374 6f72 6564 5661    data["storedVa
-0000d460: 6c75 6573 225d 203d 2073 746f 7265 6456  lues"] = storedV
-0000d470: 616c 7565 730a 2020 2020 2020 2020 6966  alues.        if
-0000d480: 2063 6163 6865 456e 6162 6c65 6420 6973   cacheEnabled is
-0000d490: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-0000d4a0: 2020 2020 2020 2064 6174 615b 2263 6163         data["cac
-0000d4b0: 6865 456e 6162 6c65 6422 5d20 3d20 6361  heEnabled"] = ca
-0000d4c0: 6368 6545 6e61 626c 6564 0a0a 2020 2020  cheEnabled..    
-0000d4d0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0000d4e0: 5f61 6464 5f69 6e64 6578 2864 6174 6129  _add_index(data)
-0000d4f0: 0a0a 2020 2020 6465 6620 6164 645f 7474  ..    def add_tt
-0000d500: 6c5f 696e 6465 7828 0a20 2020 2020 2020  l_index(.       
-0000d510: 2073 656c 662c 0a20 2020 2020 2020 2066   self,.        f
-0000d520: 6965 6c64 733a 2053 6571 7565 6e63 655b  ields: Sequence[
-0000d530: 7374 725d 2c0a 2020 2020 2020 2020 6578  str],.        ex
-0000d540: 7069 7279 5f74 696d 653a 2069 6e74 2c0a  piry_time: int,.
-0000d550: 2020 2020 2020 2020 6e61 6d65 3a20 4f70          name: Op
-0000d560: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
-0000d570: 6e65 2c0a 2020 2020 2020 2020 696e 5f62  ne,.        in_b
-0000d580: 6163 6b67 726f 756e 643a 204f 7074 696f  ackground: Optio
-0000d590: 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65  nal[bool] = None
-0000d5a0: 2c0a 2020 2020 2920 2d3e 2052 6573 756c  ,.    ) -> Resul
-0000d5b0: 745b 4a73 6f6e 5d3a 0a20 2020 2020 2020  t[Json]:.       
-0000d5c0: 2022 2222 4372 6561 7465 2061 206e 6577   """Create a new
-0000d5d0: 2054 544c 2028 7469 6d65 2d74 6f2d 6c69   TTL (time-to-li
-0000d5e0: 7665 2920 696e 6465 782e 0a0a 2020 2020  ve) index...    
-0000d5f0: 2020 2020 3a70 6172 616d 2066 6965 6c64      :param field
-0000d600: 733a 2044 6f63 756d 656e 7420 6669 656c  s: Document fiel
-0000d610: 6420 746f 2069 6e64 6578 2e0a 2020 2020  d to index..    
-0000d620: 2020 2020 3a74 7970 6520 6669 656c 6473      :type fields
-0000d630: 3a20 5b73 7472 5d0a 2020 2020 2020 2020  : [str].        
-0000d640: 3a70 6172 616d 2065 7870 6972 795f 7469  :param expiry_ti
-0000d650: 6d65 3a20 5469 6d65 206f 6620 6578 7069  me: Time of expi
-0000d660: 7279 2069 6e20 7365 636f 6e64 7320 6166  ry in seconds af
-0000d670: 7465 7220 646f 6375 6d65 6e74 2063 7265  ter document cre
-0000d680: 6174 696f 6e2e 0a20 2020 2020 2020 203a  ation..        :
-0000d690: 7479 7065 2065 7870 6972 795f 7469 6d65  type expiry_time
-0000d6a0: 3a20 696e 740a 2020 2020 2020 2020 3a70  : int.        :p
-0000d6b0: 6172 616d 206e 616d 653a 204f 7074 696f  aram name: Optio
-0000d6c0: 6e61 6c20 6e61 6d65 2066 6f72 2074 6865  nal name for the
-0000d6d0: 2069 6e64 6578 2e0a 2020 2020 2020 2020   index..        
-0000d6e0: 3a74 7970 6520 6e61 6d65 3a20 7374 7220  :type name: str 
-0000d6f0: 7c20 4e6f 6e65 0a20 2020 2020 2020 203a  | None.        :
-0000d700: 7061 7261 6d20 696e 5f62 6163 6b67 726f  param in_backgro
-0000d710: 756e 643a 2044 6f20 6e6f 7420 686f 6c64  und: Do not hold
-0000d720: 2074 6865 2063 6f6c 6c65 6374 696f 6e20   the collection 
-0000d730: 6c6f 636b 2e0a 2020 2020 2020 2020 3a74  lock..        :t
-0000d740: 7970 6520 696e 5f62 6163 6b67 726f 756e  ype in_backgroun
-0000d750: 643a 2062 6f6f 6c20 7c20 4e6f 6e65 0a20  d: bool | None. 
-0000d760: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
-0000d770: 4e65 7720 696e 6465 7820 6465 7461 696c  New index detail
-0000d780: 732e 0a20 2020 2020 2020 203a 7274 7970  s..        :rtyp
-0000d790: 653a 2064 6963 740a 2020 2020 2020 2020  e: dict.        
-0000d7a0: 3a72 6169 7365 2061 7261 6e67 6f2e 6578  :raise arango.ex
-0000d7b0: 6365 7074 696f 6e73 2e49 6e64 6578 4372  ceptions.IndexCr
-0000d7c0: 6561 7465 4572 726f 723a 2049 6620 6372  eateError: If cr
-0000d7d0: 6561 7465 2066 6169 6c73 2e0a 2020 2020  eate fails..    
-0000d7e0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000d7f0: 6461 7461 3a20 4a73 6f6e 203d 207b 2274  data: Json = {"t
-0000d800: 7970 6522 3a20 2274 746c 222c 2022 6669  ype": "ttl", "fi
-0000d810: 656c 6473 223a 2066 6965 6c64 732c 2022  elds": fields, "
-0000d820: 6578 7069 7265 4166 7465 7222 3a20 6578  expireAfter": ex
-0000d830: 7069 7279 5f74 696d 657d 0a0a 2020 2020  piry_time}..    
-0000d840: 2020 2020 6966 206e 616d 6520 6973 206e      if name is n
-0000d850: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-0000d860: 2020 2020 2064 6174 615b 226e 616d 6522       data["name"
-0000d870: 5d20 3d20 6e61 6d65 0a20 2020 2020 2020  ] = name.       
-0000d880: 2069 6620 696e 5f62 6163 6b67 726f 756e   if in_backgroun
-0000d890: 6420 6973 206e 6f74 204e 6f6e 653a 0a20  d is not None:. 
-0000d8a0: 2020 2020 2020 2020 2020 2064 6174 615b             data[
-0000d8b0: 2269 6e42 6163 6b67 726f 756e 6422 5d20  "inBackground"] 
-0000d8c0: 3d20 696e 5f62 6163 6b67 726f 756e 640a  = in_background.
-0000d8d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000d8e0: 7365 6c66 2e5f 6164 645f 696e 6465 7828  self._add_index(
-0000d8f0: 6461 7461 290a 0a20 2020 2064 6566 2061  data)..    def a
-0000d900: 6464 5f69 6e76 6572 7465 645f 696e 6465  dd_inverted_inde
-0000d910: 7828 0a20 2020 2020 2020 2073 656c 662c  x(.        self,
-0000d920: 0a20 2020 2020 2020 2066 6965 6c64 733a  .        fields:
-0000d930: 204a 736f 6e2c 0a20 2020 2020 2020 206e   Json,.        n
-0000d940: 616d 653a 204f 7074 696f 6e61 6c5b 7374  ame: Optional[st
-0000d950: 725d 203d 204e 6f6e 652c 0a20 2020 2020  r] = None,.     
-0000d960: 2020 2069 6e42 6163 6b67 726f 756e 643a     inBackground:
-0000d970: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
-0000d980: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0000d990: 7061 7261 6c6c 656c 6973 6d3a 204f 7074  parallelism: Opt
-0000d9a0: 696f 6e61 6c5b 696e 745d 203d 204e 6f6e  ional[int] = Non
-0000d9b0: 652c 0a20 2020 2020 2020 2070 7269 6d61  e,.        prima
-0000d9c0: 7279 536f 7274 3a20 4f70 7469 6f6e 616c  rySort: Optional
-0000d9d0: 5b4a 736f 6e5d 203d 204e 6f6e 652c 0a20  [Json] = None,. 
-0000d9e0: 2020 2020 2020 2073 746f 7265 6456 616c         storedVal
-0000d9f0: 7565 733a 204f 7074 696f 6e61 6c5b 5365  ues: Optional[Se
-0000da00: 7175 656e 6365 5b4a 736f 6e5d 5d20 3d20  quence[Json]] = 
-0000da10: 4e6f 6e65 2c0a 2020 2020 2020 2020 616e  None,.        an
-0000da20: 616c 797a 6572 3a20 4f70 7469 6f6e 616c  alyzer: Optional
-0000da30: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
-0000da40: 2020 2020 2020 6665 6174 7572 6573 3a20        features: 
-0000da50: 4f70 7469 6f6e 616c 5b53 6571 7565 6e63  Optional[Sequenc
-0000da60: 655b 7374 725d 5d20 3d20 4e6f 6e65 2c0a  e[str]] = None,.
-0000da70: 2020 2020 2020 2020 696e 636c 7564 6541          includeA
-0000da80: 6c6c 4669 656c 6473 3a20 4f70 7469 6f6e  llFields: Option
-0000da90: 616c 5b62 6f6f 6c5d 203d 204e 6f6e 652c  al[bool] = None,
-0000daa0: 0a20 2020 2020 2020 2074 7261 636b 4c69  .        trackLi
-0000dab0: 7374 506f 7369 7469 6f6e 733a 204f 7074  stPositions: Opt
-0000dac0: 696f 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f  ional[bool] = No
-0000dad0: 6e65 2c0a 2020 2020 2020 2020 7365 6172  ne,.        sear
-0000dae0: 6368 4669 656c 643a 204f 7074 696f 6e61  chField: Optiona
-0000daf0: 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65 2c0a  l[bool] = None,.
-0000db00: 2020 2020 2020 2020 7072 696d 6172 794b          primaryK
-0000db10: 6579 4361 6368 653a 204f 7074 696f 6e61  eyCache: Optiona
-0000db20: 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65 2c0a  l[bool] = None,.
-0000db30: 2020 2020 2020 2020 6361 6368 653a 204f          cache: O
-0000db40: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
-0000db50: 4e6f 6e65 2c0a 2020 2020 2920 2d3e 2052  None,.    ) -> R
-0000db60: 6573 756c 745b 4a73 6f6e 5d3a 0a20 2020  esult[Json]:.   
-0000db70: 2020 2020 2022 2222 4372 6561 7465 2061       """Create a
-0000db80: 206e 6577 2069 6e76 6572 7465 6420 696e   new inverted in
-0000db90: 6465 782c 2069 6e74 726f 6475 6365 6420  dex, introduced 
-0000dba0: 696e 2076 6572 7369 6f6e 2033 2e31 302e  in version 3.10.
-0000dbb0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0000dbc0: 2066 6965 6c64 733a 2044 6f63 756d 656e   fields: Documen
-0000dbd0: 7420 6669 656c 6473 2074 6f20 696e 6465  t fields to inde
-0000dbe0: 782e 0a20 2020 2020 2020 203a 7479 7065  x..        :type
-0000dbf0: 2066 6965 6c64 733a 204a 736f 6e0a 2020   fields: Json.  
-0000dc00: 2020 2020 2020 3a70 6172 616d 206e 616d        :param nam
-0000dc10: 653a 204f 7074 696f 6e61 6c20 6e61 6d65  e: Optional name
-0000dc20: 2066 6f72 2074 6865 2069 6e64 6578 2e0a   for the index..
-0000dc30: 2020 2020 2020 2020 3a74 7970 6520 6e61          :type na
-0000dc40: 6d65 3a20 7374 7220 7c20 4e6f 6e65 0a20  me: str | None. 
-0000dc50: 2020 2020 2020 203a 7061 7261 6d20 696e         :param in
-0000dc60: 4261 636b 6772 6f75 6e64 3a20 446f 206e  Background: Do n
-0000dc70: 6f74 2068 6f6c 6420 7468 6520 636f 6c6c  ot hold the coll
-0000dc80: 6563 7469 6f6e 206c 6f63 6b2e 0a20 2020  ection lock..   
-0000dc90: 2020 2020 203a 7479 7065 2069 6e42 6163       :type inBac
-0000dca0: 6b67 726f 756e 643a 2062 6f6f 6c20 7c20  kground: bool | 
-0000dcb0: 4e6f 6e65 0a20 2020 2020 2020 203a 7061  None.        :pa
-0000dcc0: 7261 6d20 7061 7261 6c6c 656c 6973 6d3a  ram parallelism:
-0000dcd0: 2054 6865 206e 756d 6265 7220 6f66 2074   The number of t
-0000dce0: 6872 6561 6473 2074 6f20 7573 6520 666f  hreads to use fo
-0000dcf0: 7220 696e 6465 7869 6e67 2074 6865 2066  r indexing the f
-0000dd00: 6965 6c64 732e 0a20 2020 2020 2020 203a  ields..        :
-0000dd10: 7479 7065 2070 6172 616c 6c65 6c69 736d  type parallelism
-0000dd20: 3a20 696e 7420 7c20 4e6f 6e65 0a20 2020  : int | None.   
-0000dd30: 2020 2020 203a 7061 7261 6d20 7072 696d       :param prim
-0000dd40: 6172 7953 6f72 743a 2050 7269 6d61 7279  arySort: Primary
-0000dd50: 2073 6f72 7420 6f72 6465 7220 746f 2065   sort order to e
-0000dd60: 6e61 626c 6520 616e 2041 514c 206f 7074  nable an AQL opt
-0000dd70: 696d 697a 6174 696f 6e2e 0a20 2020 2020  imization..     
-0000dd80: 2020 203a 7479 7065 2070 7269 6d61 7279     :type primary
-0000dd90: 536f 7274 3a20 4f70 7469 6f6e 616c 5b4a  Sort: Optional[J
-0000dda0: 736f 6e5d 0a20 2020 2020 2020 203a 7061  son].        :pa
-0000ddb0: 7261 6d20 7374 6f72 6564 5661 6c75 6573  ram storedValues
-0000ddc0: 3a20 416e 2061 7272 6179 206f 6620 6f62  : An array of ob
-0000ddd0: 6a65 6374 7320 7769 7468 2070 6174 6873  jects with paths
-0000dde0: 2074 6f20 6164 6469 7469 6f6e 616c 0a20   to additional. 
-0000ddf0: 2020 2020 2020 2020 2020 2061 7474 7269             attri
-0000de00: 6275 7465 7320 746f 2073 746f 7265 2069  butes to store i
-0000de10: 6e20 7468 6520 696e 6465 782e 0a20 2020  n the index..   
-0000de20: 2020 2020 203a 7479 7065 2073 746f 7265       :type store
-0000de30: 6456 616c 7565 733a 2053 6571 7565 6e63  dValues: Sequenc
-0000de40: 655b 4a73 6f6e 5d20 7c20 4e6f 6e65 0a20  e[Json] | None. 
-0000de50: 2020 2020 2020 203a 7061 7261 6d20 616e         :param an
-0000de60: 616c 797a 6572 3a20 416e 616c 797a 6572  alyzer: Analyzer
-0000de70: 2074 6f20 7573 6520 6279 2064 6566 6175   to use by defau
-0000de80: 6c74 2e0a 2020 2020 2020 2020 3a74 7970  lt..        :typ
-0000de90: 6520 616e 616c 797a 6572 3a20 4f70 7469  e analyzer: Opti
-0000dea0: 6f6e 616c 5b73 7472 5d0a 2020 2020 2020  onal[str].      
-0000deb0: 2020 3a70 6172 616d 2066 6561 7475 7265    :param feature
-0000dec0: 733a 204c 6973 7420 6f66 2041 6e61 6c79  s: List of Analy
-0000ded0: 7a65 7220 6665 6174 7572 6573 2e0a 2020  zer features..  
-0000dee0: 2020 2020 2020 3a74 7970 6520 6665 6174        :type feat
-0000def0: 7572 6573 3a20 5365 7175 656e 6365 5b73  ures: Sequence[s
-0000df00: 7472 5d20 7c20 4e6f 6e65 0a20 2020 2020  tr] | None.     
-0000df10: 2020 203a 7061 7261 6d20 696e 636c 7564     :param includ
-0000df20: 6541 6c6c 4669 656c 6473 3a20 5468 6973  eAllFields: This
-0000df30: 206f 7074 696f 6e20 6f6e 6c79 2061 7070   option only app
-0000df40: 6c69 6573 2069 6620 796f 7520 7573 6520  lies if you use 
-0000df50: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-0000df60: 696e 7665 7274 6564 2069 6e64 6578 2069  inverted index i
-0000df70: 6e20 7365 6172 6368 2d61 6c69 6173 2076  n search-alias v
-0000df80: 6965 7773 2e0a 2020 2020 2020 2020 3a74  iews..        :t
-0000df90: 7970 6520 696e 636c 7564 6541 6c6c 4669  ype includeAllFi
-0000dfa0: 656c 6473 3a20 626f 6f6c 207c 204e 6f6e  elds: bool | Non
-0000dfb0: 650a 2020 2020 2020 2020 3a70 6172 616d  e.        :param
-0000dfc0: 2074 7261 636b 4c69 7374 506f 7369 7469   trackListPositi
-0000dfd0: 6f6e 733a 2054 6869 7320 6f70 7469 6f6e  ons: This option
-0000dfe0: 206f 6e6c 7920 6170 706c 6965 7320 6966   only applies if
-0000dff0: 2079 6f75 2075 7365 2074 6865 0a20 2020   you use the.   
-0000e000: 2020 2020 2020 2020 2069 6e76 6572 7465           inverte
-0000e010: 6420 696e 6465 7820 696e 2073 6561 7263  d index in searc
-0000e020: 682d 616c 6961 7320 7669 6577 732c 2061  h-alias views, a
-0000e030: 6e64 2073 6561 7263 6846 6965 6c64 2069  nd searchField i
-0000e040: 7320 7472 7565 2e0a 2020 2020 2020 2020  s true..        
-0000e050: 3a74 7970 6520 7472 6163 6b4c 6973 7450  :type trackListP
-0000e060: 6f73 6974 696f 6e73 3a20 626f 6f6c 207c  ositions: bool |
-0000e070: 204e 6f6e 650a 2020 2020 2020 2020 3a70   None.        :p
-0000e080: 6172 616d 2073 6561 7263 6846 6965 6c64  aram searchField
-0000e090: 3a20 5468 6973 206f 7074 696f 6e20 6f6e  : This option on
-0000e0a0: 6c79 2061 7070 6c69 6573 2069 6620 796f  ly applies if yo
-0000e0b0: 7520 7573 6520 7468 6520 696e 7665 7274  u use the invert
-0000e0c0: 6564 0a20 2020 2020 2020 2020 2020 2069  ed.            i
-0000e0d0: 6e64 6578 2069 6e20 7365 6172 6368 2d61  ndex in search-a
-0000e0e0: 6c69 6173 2076 6965 7773 0a20 2020 2020  lias views.     
-0000e0f0: 2020 203a 7479 7065 2073 6561 7263 6846     :type searchF
-0000e100: 6965 6c64 3a20 626f 6f6c 207c 204e 6f6e  ield: bool | Non
-0000e110: 650a 2020 2020 2020 2020 3a70 6172 616d  e.        :param
-0000e120: 2070 7269 6d61 7279 4b65 7943 6163 6865   primaryKeyCache
-0000e130: 3a20 416c 7761 7973 2063 6163 6865 2074  : Always cache t
-0000e140: 6865 2070 7269 6d61 7279 206b 6579 2063  he primary key c
-0000e150: 6f6c 756d 6e20 696e 206d 656d 6f72 792e  olumn in memory.
-0000e160: 0a20 2020 2020 2020 203a 7479 7065 2070  .        :type p
-0000e170: 7269 6d61 7279 4b65 7943 6163 6865 3a20  rimaryKeyCache: 
-0000e180: 626f 6f6c 207c 204e 6f6e 650a 2020 2020  bool | None.    
-0000e190: 2020 2020 3a70 6172 616d 2063 6163 6865      :param cache
-0000e1a0: 3a20 416c 7761 7973 2063 6163 6865 2074  : Always cache t
-0000e1b0: 6865 2066 6965 6c64 206e 6f72 6d61 6c69  he field normali
-0000e1c0: 7a61 7469 6f6e 2076 616c 7565 7320 696e  zation values in
-0000e1d0: 206d 656d 6f72 790a 2020 2020 2020 2020   memory.        
-0000e1e0: 2020 2020 666f 7220 616c 6c20 6669 656c      for all fiel
-0000e1f0: 6473 2062 7920 6465 6661 756c 742e 0a20  ds by default.. 
-0000e200: 2020 2020 2020 203a 7479 7065 2063 6163         :type cac
-0000e210: 6865 3a20 626f 6f6c 207c 204e 6f6e 650a  he: bool | None.
-0000e220: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-0000e230: 204e 6577 2069 6e64 6578 2064 6574 6169   New index detai
-0000e240: 6c73 2e0a 2020 2020 2020 2020 3a72 7479  ls..        :rty
-0000e250: 7065 3a20 6469 6374 0a20 2020 2020 2020  pe: dict.       
-0000e260: 203a 7261 6973 6520 6172 616e 676f 2e65   :raise arango.e
-0000e270: 7863 6570 7469 6f6e 732e 496e 6465 7843  xceptions.IndexC
-0000e280: 7265 6174 6545 7272 6f72 3a20 4966 2063  reateError: If c
-0000e290: 7265 6174 6520 6661 696c 732e 0a20 2020  reate fails..   
-0000e2a0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0000e2b0: 2064 6174 613a 204a 736f 6e20 3d20 7b22   data: Json = {"
-0000e2c0: 7479 7065 223a 2022 696e 7665 7274 6564  type": "inverted
-0000e2d0: 222c 2022 6669 656c 6473 223a 2066 6965  ", "fields": fie
-0000e2e0: 6c64 737d 0a0a 2020 2020 2020 2020 6966  lds}..        if
-0000e2f0: 206e 616d 6520 6973 206e 6f74 204e 6f6e   name is not Non
-0000e300: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
-0000e310: 6174 615b 226e 616d 6522 5d20 3d20 6e61  ata["name"] = na
-0000e320: 6d65 0a20 2020 2020 2020 2069 6620 696e  me.        if in
-0000e330: 4261 636b 6772 6f75 6e64 2069 7320 6e6f  Background is no
-0000e340: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-0000e350: 2020 2020 6461 7461 5b22 696e 4261 636b      data["inBack
-0000e360: 6772 6f75 6e64 225d 203d 2069 6e42 6163  ground"] = inBac
-0000e370: 6b67 726f 756e 640a 2020 2020 2020 2020  kground.        
-0000e380: 6966 2070 6172 616c 6c65 6c69 736d 2069  if parallelism i
-0000e390: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0000e3a0: 2020 2020 2020 2020 6461 7461 5b22 7061          data["pa
-0000e3b0: 7261 6c6c 656c 6973 6d22 5d20 3d20 7061  rallelism"] = pa
-0000e3c0: 7261 6c6c 656c 6973 6d0a 2020 2020 2020  rallelism.      
-0000e3d0: 2020 6966 2070 7269 6d61 7279 536f 7274    if primarySort
-0000e3e0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0000e3f0: 2020 2020 2020 2020 2020 6461 7461 5b22            data["
-0000e400: 7072 696d 6172 7953 6f72 7422 5d20 3d20  primarySort"] = 
-0000e410: 7072 696d 6172 7953 6f72 740a 2020 2020  primarySort.    
-0000e420: 2020 2020 6966 2073 746f 7265 6456 616c      if storedVal
-0000e430: 7565 7320 6973 206e 6f74 204e 6f6e 653a  ues is not None:
-0000e440: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-0000e450: 615b 2273 746f 7265 6456 616c 7565 7322  a["storedValues"
-0000e460: 5d20 3d20 7374 6f72 6564 5661 6c75 6573  ] = storedValues
-0000e470: 0a20 2020 2020 2020 2069 6620 616e 616c  .        if anal
-0000e480: 797a 6572 2069 7320 6e6f 7420 4e6f 6e65  yzer is not None
-0000e490: 3a0a 2020 2020 2020 2020 2020 2020 6461  :.            da
-0000e4a0: 7461 5b22 616e 616c 797a 6572 225d 203d  ta["analyzer"] =
-0000e4b0: 2061 6e61 6c79 7a65 720a 2020 2020 2020   analyzer.      
-0000e4c0: 2020 6966 2066 6561 7475 7265 7320 6973    if features is
-0000e4d0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-0000e4e0: 2020 2020 2020 2064 6174 615b 2266 6561         data["fea
-0000e4f0: 7475 7265 7322 5d20 3d20 6665 6174 7572  tures"] = featur
-0000e500: 6573 0a20 2020 2020 2020 2069 6620 696e  es.        if in
-0000e510: 636c 7564 6541 6c6c 4669 656c 6473 2069  cludeAllFields i
-0000e520: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0000e530: 2020 2020 2020 2020 6461 7461 5b22 696e          data["in
-0000e540: 636c 7564 6541 6c6c 4669 656c 6473 225d  cludeAllFields"]
-0000e550: 203d 2069 6e63 6c75 6465 416c 6c46 6965   = includeAllFie
-0000e560: 6c64 730a 2020 2020 2020 2020 6966 2074  lds.        if t
-0000e570: 7261 636b 4c69 7374 506f 7369 7469 6f6e  rackListPosition
-0000e580: 7320 6973 206e 6f74 204e 6f6e 653a 0a20  s is not None:. 
-0000e590: 2020 2020 2020 2020 2020 2064 6174 615b             data[
-0000e5a0: 2274 7261 636b 4c69 7374 506f 7369 7469  "trackListPositi
-0000e5b0: 6f6e 7322 5d20 3d20 7472 6163 6b4c 6973  ons"] = trackLis
-0000e5c0: 7450 6f73 6974 696f 6e73 0a20 2020 2020  tPositions.     
-0000e5d0: 2020 2069 6620 7365 6172 6368 4669 656c     if searchFiel
-0000e5e0: 6420 6973 206e 6f74 204e 6f6e 653a 0a20  d is not None:. 
-0000e5f0: 2020 2020 2020 2020 2020 2064 6174 615b             data[
-0000e600: 2273 6561 7263 6846 6965 6c64 225d 203d  "searchField"] =
-0000e610: 2073 6561 7263 6846 6965 6c64 0a20 2020   searchField.   
-0000e620: 2020 2020 2069 6620 6669 656c 6473 2069       if fields i
-0000e630: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0000e640: 2020 2020 2020 2020 6461 7461 5b22 6669          data["fi
-0000e650: 656c 6473 225d 203d 2066 6965 6c64 730a  elds"] = fields.
-0000e660: 2020 2020 2020 2020 6966 2070 7269 6d61          if prima
-0000e670: 7279 4b65 7943 6163 6865 2069 7320 6e6f  ryKeyCache is no
-0000e680: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-0000e690: 2020 2020 6461 7461 5b22 7072 696d 6172      data["primar
-0000e6a0: 794b 6579 4361 6368 6522 5d20 3d20 7072  yKeyCache"] = pr
-0000e6b0: 696d 6172 794b 6579 4361 6368 650a 2020  imaryKeyCache.  
-0000e6c0: 2020 2020 2020 6966 2063 6163 6865 2069        if cache i
-0000e6d0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0000e6e0: 2020 2020 2020 2020 6461 7461 5b22 6361          data["ca
-0000e6f0: 6368 6522 5d20 3d20 6361 6368 650a 0a20  che"] = cache.. 
-0000e700: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0000e710: 6c66 2e5f 6164 645f 696e 6465 7828 6461  lf._add_index(da
-0000e720: 7461 290a 0a20 2020 2064 6566 2064 656c  ta)..    def del
-0000e730: 6574 655f 696e 6465 7828 7365 6c66 2c20  ete_index(self, 
-0000e740: 696e 6465 785f 6964 3a20 7374 722c 2069  index_id: str, i
-0000e750: 676e 6f72 655f 6d69 7373 696e 673a 2062  gnore_missing: b
-0000e760: 6f6f 6c20 3d20 4661 6c73 6529 202d 3e20  ool = False) -> 
-0000e770: 5265 7375 6c74 5b62 6f6f 6c5d 3a0a 2020  Result[bool]:.  
-0000e780: 2020 2020 2020 2222 2244 656c 6574 6520        """Delete 
-0000e790: 616e 2069 6e64 6578 2e0a 0a20 2020 2020  an index...     
-0000e7a0: 2020 203a 7061 7261 6d20 696e 6465 785f     :param index_
-0000e7b0: 6964 3a20 496e 6465 7820 4944 2e0a 2020  id: Index ID..  
-0000e7c0: 2020 2020 2020 3a74 7970 6520 696e 6465        :type inde
-0000e7d0: 785f 6964 3a20 7374 720a 2020 2020 2020  x_id: str.      
-0000e7e0: 2020 3a70 6172 616d 2069 676e 6f72 655f    :param ignore_
-0000e7f0: 6d69 7373 696e 673a 2044 6f20 6e6f 7420  missing: Do not 
-0000e800: 7261 6973 6520 616e 2065 7863 6570 7469  raise an excepti
-0000e810: 6f6e 206f 6e20 6d69 7373 696e 6720 696e  on on missing in
-0000e820: 6465 782e 0a20 2020 2020 2020 203a 7479  dex..        :ty
-0000e830: 7065 2069 676e 6f72 655f 6d69 7373 696e  pe ignore_missin
-0000e840: 673a 2062 6f6f 6c0a 2020 2020 2020 2020  g: bool.        
-0000e850: 3a72 6574 7572 6e3a 2054 7275 6520 6966  :return: True if
-0000e860: 2069 6e64 6578 2077 6173 2064 656c 6574   index was delet
-0000e870: 6564 2073 7563 6365 7373 6675 6c6c 792c  ed successfully,
-0000e880: 2046 616c 7365 2069 6620 696e 6465 7820   False if index 
-0000e890: 7761 730a 2020 2020 2020 2020 2020 2020  was.            
-0000e8a0: 6e6f 7420 666f 756e 6420 616e 6420 2a2a  not found and **
-0000e8b0: 6967 6e6f 7265 5f6d 6973 7369 6e67 2a2a  ignore_missing**
-0000e8c0: 2077 6173 2073 6574 2074 6f20 5472 7565   was set to True
-0000e8d0: 2e0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
-0000e8e0: 3a20 626f 6f6c 0a20 2020 2020 2020 203a  : bool.        :
-0000e8f0: 7261 6973 6520 6172 616e 676f 2e65 7863  raise arango.exc
-0000e900: 6570 7469 6f6e 732e 496e 6465 7844 656c  eptions.IndexDel
-0000e910: 6574 6545 7272 6f72 3a20 4966 2064 656c  eteError: If del
-0000e920: 6574 6520 6661 696c 732e 0a20 2020 2020  ete fails..     
-0000e930: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
-0000e940: 6571 7565 7374 203d 2052 6571 7565 7374  equest = Request
-0000e950: 280a 2020 2020 2020 2020 2020 2020 6d65  (.            me
-0000e960: 7468 6f64 3d22 6465 6c65 7465 222c 2065  thod="delete", e
-0000e970: 6e64 706f 696e 743d 6622 2f5f 6170 692f  ndpoint=f"/_api/
-0000e980: 696e 6465 782f 7b73 656c 662e 6e61 6d65  index/{self.name
-0000e990: 7d2f 7b69 6e64 6578 5f69 647d 220a 2020  }/{index_id}".  
-0000e9a0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0000e9b0: 2064 6566 2072 6573 706f 6e73 655f 6861   def response_ha
-0000e9c0: 6e64 6c65 7228 7265 7370 3a20 5265 7370  ndler(resp: Resp
-0000e9d0: 6f6e 7365 2920 2d3e 2062 6f6f 6c3a 0a20  onse) -> bool:. 
-0000e9e0: 2020 2020 2020 2020 2020 2069 6620 7265             if re
-0000e9f0: 7370 2e65 7272 6f72 5f63 6f64 6520 3d3d  sp.error_code ==
-0000ea00: 2031 3231 3220 616e 6420 6967 6e6f 7265   1212 and ignore
-0000ea10: 5f6d 6973 7369 6e67 3a0a 2020 2020 2020  _missing:.      
-0000ea20: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000ea30: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
-0000ea40: 2020 2069 6620 6e6f 7420 7265 7370 2e69     if not resp.i
-0000ea50: 735f 7375 6363 6573 733a 0a20 2020 2020  s_success:.     
-0000ea60: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000ea70: 2049 6e64 6578 4465 6c65 7465 4572 726f   IndexDeleteErro
-0000ea80: 7228 7265 7370 2c20 7265 7175 6573 7429  r(resp, request)
-0000ea90: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0000eaa0: 7572 6e20 5472 7565 0a0a 2020 2020 2020  urn True..      
-0000eab0: 2020 7265 7475 726e 2073 656c 662e 5f65    return self._e
-0000eac0: 7865 6375 7465 2872 6571 7565 7374 2c20  xecute(request, 
-0000ead0: 7265 7370 6f6e 7365 5f68 616e 646c 6572  response_handler
-0000eae0: 290a 0a20 2020 2064 6566 206c 6f61 645f  )..    def load_
-0000eaf0: 696e 6465 7865 7328 7365 6c66 2920 2d3e  indexes(self) ->
-0000eb00: 2052 6573 756c 745b 626f 6f6c 5d3a 0a20   Result[bool]:. 
-0000eb10: 2020 2020 2020 2022 2222 4361 6368 6520         """Cache 
-0000eb20: 616c 6c20 696e 6465 7865 7320 696e 2074  all indexes in t
-0000eb30: 6865 2063 6f6c 6c65 6374 696f 6e20 696e  he collection in
-0000eb40: 746f 206d 656d 6f72 792e 0a0a 2020 2020  to memory...    
-0000eb50: 2020 2020 3a72 6574 7572 6e3a 2054 7275      :return: Tru
-0000eb60: 6520 6966 2069 6e64 6578 2077 6173 206c  e if index was l
-0000eb70: 6f61 6465 6420 7375 6363 6573 7366 756c  oaded successful
-0000eb80: 6c79 2e0a 2020 2020 2020 2020 3a72 7479  ly..        :rty
-0000eb90: 7065 3a20 626f 6f6c 0a20 2020 2020 2020  pe: bool.       
-0000eba0: 203a 7261 6973 6520 6172 616e 676f 2e65   :raise arango.e
-0000ebb0: 7863 6570 7469 6f6e 732e 496e 6465 784c  xceptions.IndexL
-0000ebc0: 6f61 6445 7272 6f72 3a20 4966 206f 7065  oadError: If ope
-0000ebd0: 7261 7469 6f6e 2066 6169 6c73 2e0a 2020  ration fails..  
-0000ebe0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000ebf0: 2020 7265 7175 6573 7420 3d20 5265 7175    request = Requ
-0000ec00: 6573 7428 0a20 2020 2020 2020 2020 2020  est(.           
-0000ec10: 206d 6574 686f 643d 2270 7574 222c 0a20   method="put",. 
-0000ec20: 2020 2020 2020 2020 2020 2065 6e64 706f             endpo
-0000ec30: 696e 743d 6622 2f5f 6170 692f 636f 6c6c  int=f"/_api/coll
-0000ec40: 6563 7469 6f6e 2f7b 7365 6c66 2e6e 616d  ection/{self.nam
-0000ec50: 657d 2f6c 6f61 6449 6e64 6578 6573 496e  e}/loadIndexesIn
-0000ec60: 746f 4d65 6d6f 7279 222c 0a20 2020 2020  toMemory",.     
-0000ec70: 2020 2029 0a0a 2020 2020 2020 2020 6465     )..        de
-0000ec80: 6620 7265 7370 6f6e 7365 5f68 616e 646c  f response_handl
-0000ec90: 6572 2872 6573 703a 2052 6573 706f 6e73  er(resp: Respons
-0000eca0: 6529 202d 3e20 626f 6f6c 3a0a 2020 2020  e) -> bool:.    
-0000ecb0: 2020 2020 2020 2020 6966 206e 6f74 2072          if not r
-0000ecc0: 6573 702e 6973 5f73 7563 6365 7373 3a0a  esp.is_success:.
-0000ecd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ece0: 7261 6973 6520 496e 6465 784c 6f61 6445  raise IndexLoadE
-0000ecf0: 7272 6f72 2872 6573 702c 2072 6571 7565  rror(resp, reque
-0000ed00: 7374 290a 2020 2020 2020 2020 2020 2020  st).            
-0000ed10: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
-0000ed20: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0000ed30: 2e5f 6578 6563 7574 6528 7265 7175 6573  ._execute(reques
-0000ed40: 742c 2072 6573 706f 6e73 655f 6861 6e64  t, response_hand
-0000ed50: 6c65 7229 0a0a 2020 2020 6465 6620 696e  ler)..    def in
-0000ed60: 7365 7274 5f6d 616e 7928 0a20 2020 2020  sert_many(.     
-0000ed70: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-0000ed80: 2064 6f63 756d 656e 7473 3a20 5365 7175   documents: Sequ
-0000ed90: 656e 6365 5b4a 736f 6e5d 2c0a 2020 2020  ence[Json],.    
-0000eda0: 2020 2020 7265 7475 726e 5f6e 6577 3a20      return_new: 
-0000edb0: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
-0000edc0: 2020 2020 2020 7379 6e63 3a20 4f70 7469        sync: Opti
-0000edd0: 6f6e 616c 5b62 6f6f 6c5d 203d 204e 6f6e  onal[bool] = Non
-0000ede0: 652c 0a20 2020 2020 2020 2073 696c 656e  e,.        silen
-0000edf0: 743a 2062 6f6f 6c20 3d20 4661 6c73 652c  t: bool = False,
-0000ee00: 0a20 2020 2020 2020 206f 7665 7277 7269  .        overwri
-0000ee10: 7465 3a20 626f 6f6c 203d 2046 616c 7365  te: bool = False
-0000ee20: 2c0a 2020 2020 2020 2020 7265 7475 726e  ,.        return
-0000ee30: 5f6f 6c64 3a20 626f 6f6c 203d 2046 616c  _old: bool = Fal
-0000ee40: 7365 2c0a 2020 2020 2020 2020 6f76 6572  se,.        over
-0000ee50: 7772 6974 655f 6d6f 6465 3a20 4f70 7469  write_mode: Opti
-0000ee60: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
-0000ee70: 2c0a 2020 2020 2020 2020 6b65 6570 5f6e  ,.        keep_n
-0000ee80: 6f6e 653a 204f 7074 696f 6e61 6c5b 626f  one: Optional[bo
-0000ee90: 6f6c 5d20 3d20 4e6f 6e65 2c0a 2020 2020  ol] = None,.    
-0000eea0: 2020 2020 6d65 7267 653a 204f 7074 696f      merge: Optio
-0000eeb0: 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65  nal[bool] = None
-0000eec0: 2c0a 2020 2020 2020 2020 7265 6669 6c6c  ,.        refill
-0000eed0: 5f69 6e64 6578 5f63 6163 6865 733a 204f  _index_caches: O
-0000eee0: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
-0000eef0: 4e6f 6e65 2c0a 2020 2020 2920 2d3e 2052  None,.    ) -> R
-0000ef00: 6573 756c 745b 556e 696f 6e5b 626f 6f6c  esult[Union[bool
-0000ef10: 2c20 4c69 7374 5b55 6e69 6f6e 5b4a 736f  , List[Union[Jso
-0000ef20: 6e2c 2041 7261 6e67 6f53 6572 7665 7245  n, ArangoServerE
-0000ef30: 7272 6f72 5d5d 5d5d 3a0a 2020 2020 2020  rror]]]]:.      
-0000ef40: 2020 2222 2249 6e73 6572 7420 6d75 6c74    """Insert mult
-0000ef50: 6970 6c65 2064 6f63 756d 656e 7473 2e0a  iple documents..
-0000ef60: 0a20 2020 2020 2020 202e 2e20 6e6f 7465  .        .. note
-0000ef70: 3a3a 0a0a 2020 2020 2020 2020 2020 2020  ::..            
-0000ef80: 4966 2069 6e73 6572 7469 6e67 2061 2064  If inserting a d
-0000ef90: 6f63 756d 656e 7420 6661 696c 732c 2074  ocument fails, t
-0000efa0: 6865 2065 7863 6570 7469 6f6e 2069 7320  he exception is 
-0000efb0: 6e6f 7420 7261 6973 6564 2062 7574 0a20  not raised but. 
-0000efc0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000efd0: 6e65 6420 6173 2061 6e20 6f62 6a65 6374  ned as an object
-0000efe0: 2069 6e20 7468 6520 7265 7375 6c74 206c   in the result l
-0000eff0: 6973 742e 2049 7420 6973 2075 7020 746f  ist. It is up to
-0000f000: 2079 6f75 2074 6f0a 2020 2020 2020 2020   you to.        
-0000f010: 2020 2020 696e 7370 6563 7420 7468 6520      inspect the 
-0000f020: 6c69 7374 2074 6f20 6465 7465 726d 696e  list to determin
-0000f030: 6520 7768 6963 6820 646f 6375 6d65 6e74  e which document
-0000f040: 7320 7765 7265 2069 6e73 6572 7465 640a  s were inserted.
-0000f050: 2020 2020 2020 2020 2020 2020 7375 6363              succ
-0000f060: 6573 7366 756c 6c79 2028 7265 7475 726e  essfully (return
-0000f070: 7320 646f 6375 6d65 6e74 206d 6574 6164  s document metad
-0000f080: 6174 6129 2061 6e64 2077 6869 6368 2077  ata) and which w
-0000f090: 6572 6520 6e6f 740a 2020 2020 2020 2020  ere not.        
-0000f0a0: 2020 2020 2872 6574 7572 6e73 2065 7863      (returns exc
-0000f0b0: 6570 7469 6f6e 206f 626a 6563 7429 2e0a  eption object)..
-0000f0c0: 0a20 2020 2020 2020 202e 2e20 6e6f 7465  .        .. note
-0000f0d0: 3a3a 0a0a 2020 2020 2020 2020 2020 2020  ::..            
-0000f0e0: 496e 2065 6467 652f 7665 7274 6578 2063  In edge/vertex c
-0000f0f0: 6f6c 6c65 6374 696f 6e73 2c20 7468 6973  ollections, this
-0000f100: 206d 6574 686f 6420 646f 6573 204e 4f54   method does NOT
-0000f110: 2070 726f 7669 6465 2074 6865 0a20 2020   provide the.   
-0000f120: 2020 2020 2020 2020 2074 7261 6e73 6163           transac
-0000f130: 7469 6f6e 616c 2067 7561 7261 6e74 6565  tional guarantee
-0000f140: 7320 616e 6420 7661 6c69 6461 7469 6f6e  s and validation
-0000f150: 7320 7468 6174 2073 696e 676c 6520 696e  s that single in
-0000f160: 7365 7274 0a20 2020 2020 2020 2020 2020  sert.           
-0000f170: 206f 7065 7261 7469 6f6e 2064 6f65 7320   operation does 
-0000f180: 666f 7220 6772 6170 6873 2e20 4966 2074  for graphs. If t
-0000f190: 6865 7365 2070 726f 7065 7274 6965 7320  hese properties 
-0000f1a0: 6172 6520 7265 7175 6972 6564 2c20 7365  are required, se
-0000f1b0: 650a 2020 2020 2020 2020 2020 2020 3a66  e.            :f
-0000f1c0: 756e 633a 6061 7261 6e67 6f2e 6461 7461  unc:`arango.data
-0000f1d0: 6261 7365 2e53 7461 6e64 6172 6444 6174  base.StandardDat
-0000f1e0: 6162 6173 652e 6265 6769 6e5f 6261 7463  abase.begin_batc
-0000f1f0: 685f 6578 6563 7574 696f 6e60 0a20 2020  h_execution`.   
-0000f200: 2020 2020 2020 2020 2066 6f72 2061 6e20           for an 
-0000f210: 616c 7465 726e 6174 6976 6520 6170 7072  alternative appr
-0000f220: 6f61 6368 2e0a 0a20 2020 2020 2020 203a  oach...        :
-0000f230: 7061 7261 6d20 646f 6375 6d65 6e74 733a  param documents:
-0000f240: 204c 6973 7420 6f66 206e 6577 2064 6f63   List of new doc
-0000f250: 756d 656e 7473 2074 6f20 696e 7365 7274  uments to insert
-0000f260: 2e20 4966 2074 6865 7920 636f 6e74 6169  . If they contai
-0000f270: 6e20 7468 650a 2020 2020 2020 2020 2020  n the.          
-0000f280: 2020 225f 6b65 7922 206f 7220 225f 6964    "_key" or "_id
-0000f290: 2220 6669 656c 6473 2c20 7468 6520 7661  " fields, the va
-0000f2a0: 6c75 6573 2061 7265 2075 7365 6420 6173  lues are used as
-0000f2b0: 2074 6865 206b 6579 7320 6f66 2074 6865   the keys of the
-0000f2c0: 206e 6577 0a20 2020 2020 2020 2020 2020   new.           
-0000f2d0: 2064 6f63 756d 656e 7473 2028 6175 746f   documents (auto
-0000f2e0: 2d67 656e 6572 6174 6564 206f 7468 6572  -generated other
-0000f2f0: 7769 7365 292e 2041 6e79 2022 5f72 6576  wise). Any "_rev
-0000f300: 2220 6669 656c 6420 6973 2069 676e 6f72  " field is ignor
-0000f310: 6564 2e0a 2020 2020 2020 2020 3a74 7970  ed..        :typ
-0000f320: 6520 646f 6375 6d65 6e74 733a 205b 6469  e documents: [di
-0000f330: 6374 5d0a 2020 2020 2020 2020 3a70 6172  ct].        :par
-0000f340: 616d 2072 6574 7572 6e5f 6e65 773a 2049  am return_new: I
-0000f350: 6e63 6c75 6465 2062 6f64 6965 7320 6f66  nclude bodies of
-0000f360: 2074 6865 206e 6577 2064 6f63 756d 656e   the new documen
-0000f370: 7473 2069 6e20 7468 6520 7265 7475 726e  ts in the return
-0000f380: 6564 0a20 2020 2020 2020 2020 2020 206d  ed.            m
-0000f390: 6574 6164 6174 612e 2049 676e 6f72 6564  etadata. Ignored
-0000f3a0: 2069 6620 7061 7261 6d65 7465 7220 2a2a   if parameter **
-0000f3b0: 7369 6c65 6e74 2a2a 2069 7320 7365 7420  silent** is set 
-0000f3c0: 746f 2054 7275 650a 2020 2020 2020 2020  to True.        
-0000f3d0: 3a74 7970 6520 7265 7475 726e 5f6e 6577  :type return_new
-0000f3e0: 3a20 626f 6f6c 0a20 2020 2020 2020 203a  : bool.        :
-0000f3f0: 7061 7261 6d20 7379 6e63 3a20 426c 6f63  param sync: Bloc
-0000f400: 6b20 756e 7469 6c20 6f70 6572 6174 696f  k until operatio
-0000f410: 6e20 6973 2073 796e 6368 726f 6e69 7a65  n is synchronize
-0000f420: 6420 746f 2064 6973 6b2e 0a20 2020 2020  d to disk..     
-0000f430: 2020 203a 7479 7065 2073 796e 633a 2062     :type sync: b
-0000f440: 6f6f 6c20 7c20 4e6f 6e65 0a20 2020 2020  ool | None.     
-0000f450: 2020 203a 7061 7261 6d20 7369 6c65 6e74     :param silent
-0000f460: 3a20 4966 2073 6574 2074 6f20 5472 7565  : If set to True
-0000f470: 2c20 6e6f 2064 6f63 756d 656e 7420 6d65  , no document me
-0000f480: 7461 6461 7461 2069 7320 7265 7475 726e  tadata is return
-0000f490: 6564 2e20 5468 6973 0a20 2020 2020 2020  ed. This.       
-0000f4a0: 2020 2020 2063 616e 2062 6520 7573 6564       can be used
-0000f4b0: 2074 6f20 7361 7665 2072 6573 6f75 7263   to save resourc
-0000f4c0: 6573 2e0a 2020 2020 2020 2020 3a74 7970  es..        :typ
-0000f4d0: 6520 7369 6c65 6e74 3a20 626f 6f6c 0a20  e silent: bool. 
-0000f4e0: 2020 2020 2020 203a 7061 7261 6d20 6f76         :param ov
-0000f4f0: 6572 7772 6974 653a 2049 6620 7365 7420  erwrite: If set 
-0000f500: 746f 2054 7275 652c 206f 7065 7261 7469  to True, operati
-0000f510: 6f6e 2064 6f65 7320 6e6f 7420 6661 696c  on does not fail
-0000f520: 206f 6e20 6475 706c 6963 6174 650a 2020   on duplicate.  
-0000f530: 2020 2020 2020 2020 2020 6b65 7973 2061            keys a
-0000f540: 6e64 2074 6865 2065 7869 7374 696e 6720  nd the existing 
-0000f550: 646f 6375 6d65 6e74 7320 6172 6520 7265  documents are re
-0000f560: 706c 6163 6564 2e0a 2020 2020 2020 2020  placed..        
-0000f570: 3a74 7970 6520 6f76 6572 7772 6974 653a  :type overwrite:
-0000f580: 2062 6f6f 6c0a 2020 2020 2020 2020 3a70   bool.        :p
-0000f590: 6172 616d 2072 6574 7572 6e5f 6f6c 643a  aram return_old:
-0000f5a0: 2049 6e63 6c75 6465 2062 6f64 7920 6f66   Include body of
-0000f5b0: 2074 6865 206f 6c64 2064 6f63 756d 656e   the old documen
-0000f5c0: 7473 2069 6620 7265 706c 6163 6564 2e0a  ts if replaced..
-0000f5d0: 2020 2020 2020 2020 2020 2020 4170 706c              Appl
-0000f5e0: 6965 7320 6f6e 6c79 2077 6865 6e20 7661  ies only when va
-0000f5f0: 6c75 6520 6f66 202a 2a6f 7665 7277 7269  lue of **overwri
-0000f600: 7465 2a2a 2069 7320 7365 7420 746f 2054  te** is set to T
-0000f610: 7275 652e 0a20 2020 2020 2020 203a 7479  rue..        :ty
-0000f620: 7065 2072 6574 7572 6e5f 6f6c 643a 2062  pe return_old: b
-0000f630: 6f6f 6c0a 2020 2020 2020 2020 3a70 6172  ool.        :par
-0000f640: 616d 206f 7665 7277 7269 7465 5f6d 6f64  am overwrite_mod
-0000f650: 653a 204f 7665 7277 7269 7465 2062 6568  e: Overwrite beh
-0000f660: 6176 696f 7220 7573 6564 2077 6865 6e20  avior used when 
-0000f670: 7468 6520 646f 6375 6d65 6e74 206b 6579  the document key
-0000f680: 0a20 2020 2020 2020 2020 2020 2065 7869  .            exi
-0000f690: 7374 7320 616c 7265 6164 792e 2041 6c6c  sts already. All
-0000f6a0: 6f77 6564 2076 616c 7565 7320 6172 6520  owed values are 
-0000f6b0: 2272 6570 6c61 6365 2220 2872 6570 6c61  "replace" (repla
-0000f6c0: 6365 2d69 6e73 6572 7429 2c0a 2020 2020  ce-insert),.    
-0000f6d0: 2020 2020 2020 2020 2275 7064 6174 6522          "update"
-0000f6e0: 2028 7570 6461 7465 2d69 6e73 6572 7429   (update-insert)
-0000f6f0: 2c20 2269 676e 6f72 6522 206f 7220 2263  , "ignore" or "c
-0000f700: 6f6e 666c 6963 7422 2e0a 2020 2020 2020  onflict"..      
-0000f710: 2020 2020 2020 496d 706c 6963 6974 6c79        Implicitly
-0000f720: 2073 6574 7320 7468 6520 7661 6c75 6520   sets the value 
-0000f730: 6f66 2070 6172 616d 6574 6572 202a 2a6f  of parameter **o
-0000f740: 7665 7277 7269 7465 2a2a 2e0a 2020 2020  verwrite**..    
-0000f750: 2020 2020 3a74 7970 6520 6f76 6572 7772      :type overwr
-0000f760: 6974 655f 6d6f 6465 3a20 7374 7220 7c20  ite_mode: str | 
-0000f770: 4e6f 6e65 0a20 2020 2020 2020 203a 7061  None.        :pa
-0000f780: 7261 6d20 6b65 6570 5f6e 6f6e 653a 2049  ram keep_none: I
-0000f790: 6620 7365 7420 746f 2054 7275 652c 2066  f set to True, f
-0000f7a0: 6965 6c64 7320 7769 7468 2076 616c 7565  ields with value
-0000f7b0: 204e 6f6e 6520 6172 6520 7265 7461 696e   None are retain
-0000f7c0: 6564 0a20 2020 2020 2020 2020 2020 2069  ed.            i
-0000f7d0: 6e20 7468 6520 646f 6375 6d65 6e74 2e20  n the document. 
-0000f7e0: 4f74 6865 7277 6973 652c 2074 6865 7920  Otherwise, they 
-0000f7f0: 6172 6520 7265 6d6f 7665 6420 636f 6d70  are removed comp
-0000f800: 6c65 7465 6c79 2e20 4170 706c 6965 730a  letely. Applies.
-0000f810: 2020 2020 2020 2020 2020 2020 6f6e 6c79              only
-0000f820: 2077 6865 6e20 2a2a 6f76 6572 7772 6974   when **overwrit
-0000f830: 655f 6d6f 6465 2a2a 2069 7320 7365 7420  e_mode** is set 
-0000f840: 746f 2022 7570 6461 7465 2220 2875 7064  to "update" (upd
-0000f850: 6174 652d 696e 7365 7274 292e 0a20 2020  ate-insert)..   
-0000f860: 2020 2020 203a 7479 7065 206b 6565 705f       :type keep_
-0000f870: 6e6f 6e65 3a20 626f 6f6c 207c 204e 6f6e  none: bool | Non
-0000f880: 650a 2020 2020 2020 2020 3a70 6172 616d  e.        :param
-0000f890: 206d 6572 6765 3a20 4966 2073 6574 2074   merge: If set t
-0000f8a0: 6f20 5472 7565 2028 6465 6661 756c 7429  o True (default)
-0000f8b0: 2c20 7375 622d 6469 6374 696f 6e61 7269  , sub-dictionari
-0000f8c0: 6573 2061 7265 206d 6572 6765 640a 2020  es are merged.  
-0000f8d0: 2020 2020 2020 2020 2020 696e 7374 6561            instea
-0000f8e0: 6420 6f66 2074 6865 206e 6577 206f 6e65  d of the new one
-0000f8f0: 206f 7665 7277 7269 7469 6e67 2074 6865   overwriting the
-0000f900: 206f 6c64 206f 6e65 2e20 4170 706c 6965   old one. Applie
-0000f910: 7320 6f6e 6c79 2077 6865 6e0a 2020 2020  s only when.    
-0000f920: 2020 2020 2020 2020 2a2a 6f76 6572 7772          **overwr
-0000f930: 6974 655f 6d6f 6465 2a2a 2069 7320 7365  ite_mode** is se
-0000f940: 7420 746f 2022 7570 6461 7465 2220 2875  t to "update" (u
-0000f950: 7064 6174 652d 696e 7365 7274 292e 0a20  pdate-insert).. 
-0000f960: 2020 2020 2020 203a 7479 7065 206d 6572         :type mer
-0000f970: 6765 3a20 626f 6f6c 207c 204e 6f6e 650a  ge: bool | None.
-0000f980: 2020 2020 2020 2020 3a70 6172 616d 2072          :param r
-0000f990: 6566 696c 6c5f 696e 6465 785f 6361 6368  efill_index_cach
-0000f9a0: 6573 3a20 5768 6574 6865 7220 746f 2061  es: Whether to a
-0000f9b0: 6464 206e 6577 2065 6e74 7269 6573 2074  dd new entries t
-0000f9c0: 6f20 696e 2d6d 656d 6f72 790a 2020 2020  o in-memory.    
-0000f9d0: 2020 2020 2020 2020 696e 6465 7820 6361          index ca
-0000f9e0: 6368 6573 2069 6620 646f 6375 6d65 6e74  ches if document
-0000f9f0: 2069 6e73 6572 7469 6f6e 7320 6166 6665   insertions affe
-0000fa00: 6374 2074 6865 2065 6467 6520 696e 6465  ct the edge inde
-0000fa10: 7820 6f72 0a20 2020 2020 2020 2020 2020  x or.           
-0000fa20: 2063 6163 6865 2d65 6e61 626c 6564 2070   cache-enabled p
-0000fa30: 6572 7369 7374 656e 7420 696e 6465 7865  ersistent indexe
-0000fa40: 732e 0a20 2020 2020 2020 203a 7479 7065  s..        :type
-0000fa50: 2072 6566 696c 6c5f 696e 6465 785f 6361   refill_index_ca
-0000fa60: 6368 6573 3a20 626f 6f6c 207c 204e 6f6e  ches: bool | Non
-0000fa70: 650a 2020 2020 2020 2020 3a72 6574 7572  e.        :retur
-0000fa80: 6e3a 204c 6973 7420 6f66 2064 6f63 756d  n: List of docum
-0000fa90: 656e 7420 6d65 7461 6461 7461 2028 652e  ent metadata (e.
-0000faa0: 672e 2064 6f63 756d 656e 7420 6b65 7973  g. document keys
-0000fab0: 2c20 7265 7669 7369 6f6e 7329 2061 6e64  , revisions) and
-0000fac0: 0a20 2020 2020 2020 2020 2020 2061 6e79  .            any
-0000fad0: 2065 7863 6570 7469 6f6e 2c20 6f72 2054   exception, or T
-0000fae0: 7275 6520 6966 2070 6172 616d 6574 6572  rue if parameter
-0000faf0: 202a 2a73 696c 656e 742a 2a20 7761 7320   **silent** was 
-0000fb00: 7365 7420 746f 2054 7275 652e 0a20 2020  set to True..   
-0000fb10: 2020 2020 203a 7274 7970 653a 205b 6469       :rtype: [di
-0000fb20: 6374 207c 2041 7261 6e67 6f53 6572 7665  ct | ArangoServe
-0000fb30: 7245 7272 6f72 5d20 7c20 626f 6f6c 0a20  rError] | bool. 
-0000fb40: 2020 2020 2020 203a 7261 6973 6520 6172         :raise ar
-0000fb50: 616e 676f 2e65 7863 6570 7469 6f6e 732e  ango.exceptions.
-0000fb60: 446f 6375 6d65 6e74 496e 7365 7274 4572  DocumentInsertEr
-0000fb70: 726f 723a 2049 6620 696e 7365 7274 2066  ror: If insert f
-0000fb80: 6169 6c73 2e0a 2020 2020 2020 2020 2222  ails..        ""
-0000fb90: 220a 2020 2020 2020 2020 646f 6375 6d65  ".        docume
-0000fba0: 6e74 7320 3d20 5b73 656c 662e 5f65 6e73  nts = [self._ens
-0000fbb0: 7572 655f 6b65 795f 6672 6f6d 5f69 6428  ure_key_from_id(
-0000fbc0: 646f 6329 2066 6f72 2064 6f63 2069 6e20  doc) for doc in 
-0000fbd0: 646f 6375 6d65 6e74 735d 0a0a 2020 2020  documents]..    
-0000fbe0: 2020 2020 7061 7261 6d73 3a20 5061 7261      params: Para
-0000fbf0: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
-0000fc00: 2020 2022 7265 7475 726e 4e65 7722 3a20     "returnNew": 
-0000fc10: 7265 7475 726e 5f6e 6577 2c0a 2020 2020  return_new,.    
-0000fc20: 2020 2020 2020 2020 2273 696c 656e 7422          "silent"
-0000fc30: 3a20 7369 6c65 6e74 2c0a 2020 2020 2020  : silent,.      
-0000fc40: 2020 2020 2020 226f 7665 7277 7269 7465        "overwrite
-0000fc50: 223a 206f 7665 7277 7269 7465 2c0a 2020  ": overwrite,.  
-0000fc60: 2020 2020 2020 2020 2020 2272 6574 7572            "retur
-0000fc70: 6e4f 6c64 223a 2072 6574 7572 6e5f 6f6c  nOld": return_ol
-0000fc80: 642c 0a20 2020 2020 2020 207d 0a20 2020  d,.        }.   
-0000fc90: 2020 2020 2069 6620 7379 6e63 2069 7320       if sync is 
-0000fca0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-0000fcb0: 2020 2020 2020 7061 7261 6d73 5b22 7761        params["wa
-0000fcc0: 6974 466f 7253 796e 6322 5d20 3d20 7379  itForSync"] = sy
-0000fcd0: 6e63 0a0a 2020 2020 2020 2020 6966 206f  nc..        if o
-0000fce0: 7665 7277 7269 7465 5f6d 6f64 6520 6973  verwrite_mode is
-0000fcf0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-0000fd00: 2020 2020 2020 2070 6172 616d 735b 226f         params["o
-0000fd10: 7665 7277 7269 7465 4d6f 6465 225d 203d  verwriteMode"] =
-0000fd20: 206f 7665 7277 7269 7465 5f6d 6f64 650a   overwrite_mode.
-0000fd30: 2020 2020 2020 2020 6966 206b 6565 705f          if keep_
-0000fd40: 6e6f 6e65 2069 7320 6e6f 7420 4e6f 6e65  none is not None
-0000fd50: 3a0a 2020 2020 2020 2020 2020 2020 7061  :.            pa
-0000fd60: 7261 6d73 5b22 6b65 6570 4e75 6c6c 225d  rams["keepNull"]
-0000fd70: 203d 206b 6565 705f 6e6f 6e65 0a20 2020   = keep_none.   
-0000fd80: 2020 2020 2069 6620 6d65 7267 6520 6973       if merge is
-0000fd90: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-0000fda0: 2020 2020 2020 2070 6172 616d 735b 226d         params["m
-0000fdb0: 6572 6765 4f62 6a65 6374 7322 5d20 3d20  ergeObjects"] = 
-0000fdc0: 6d65 7267 650a 0a20 2020 2020 2020 2023  merge..        #
-0000fdd0: 204e 6577 2069 6e20 4172 616e 676f 4442   New in ArangoDB
-0000fde0: 2033 2e39 2e36 2061 6e64 2033 2e31 302e   3.9.6 and 3.10.
-0000fdf0: 320a 2020 2020 2020 2020 6966 2072 6566  2.        if ref
-0000fe00: 696c 6c5f 696e 6465 785f 6361 6368 6573  ill_index_caches
-0000fe10: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0000fe20: 2020 2020 2020 2020 2020 7061 7261 6d73            params
-0000fe30: 5b22 7265 6669 6c6c 496e 6465 7843 6163  ["refillIndexCac
-0000fe40: 6865 7322 5d20 3d20 7265 6669 6c6c 5f69  hes"] = refill_i
-0000fe50: 6e64 6578 5f63 6163 6865 730a 0a20 2020  ndex_caches..   
-0000fe60: 2020 2020 2072 6571 7565 7374 203d 2052       request = R
-0000fe70: 6571 7565 7374 280a 2020 2020 2020 2020  equest(.        
-0000fe80: 2020 2020 6d65 7468 6f64 3d22 706f 7374      method="post
-0000fe90: 222c 0a20 2020 2020 2020 2020 2020 2065  ",.            e
-0000fea0: 6e64 706f 696e 743d 6622 2f5f 6170 692f  ndpoint=f"/_api/
-0000feb0: 646f 6375 6d65 6e74 2f7b 7365 6c66 2e6e  document/{self.n
-0000fec0: 616d 657d 222c 0a20 2020 2020 2020 2020  ame}",.         
-0000fed0: 2020 2064 6174 613d 646f 6375 6d65 6e74     data=document
-0000fee0: 732c 0a20 2020 2020 2020 2020 2020 2070  s,.            p
-0000fef0: 6172 616d 733d 7061 7261 6d73 2c0a 2020  arams=params,.  
-0000ff00: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0000ff10: 2064 6566 2072 6573 706f 6e73 655f 6861   def response_ha
-0000ff20: 6e64 6c65 7228 0a20 2020 2020 2020 2020  ndler(.         
-0000ff30: 2020 2072 6573 703a 2052 6573 706f 6e73     resp: Respons
-0000ff40: 652c 0a20 2020 2020 2020 2029 202d 3e20  e,.        ) -> 
-0000ff50: 556e 696f 6e5b 626f 6f6c 2c20 4c69 7374  Union[bool, List
-0000ff60: 5b55 6e69 6f6e 5b4a 736f 6e2c 2041 7261  [Union[Json, Ara
-0000ff70: 6e67 6f53 6572 7665 7245 7272 6f72 5d5d  ngoServerError]]
-0000ff80: 5d3a 0a20 2020 2020 2020 2020 2020 2069  ]:.            i
-0000ff90: 6620 6e6f 7420 7265 7370 2e69 735f 7375  f not resp.is_su
-0000ffa0: 6363 6573 733a 0a20 2020 2020 2020 2020  ccess:.         
-0000ffb0: 2020 2020 2020 2072 6169 7365 2044 6f63         raise Doc
-0000ffc0: 756d 656e 7449 6e73 6572 7445 7272 6f72  umentInsertError
-0000ffd0: 2872 6573 702c 2072 6571 7565 7374 290a  (resp, request).
-0000ffe0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0000fff0: 696c 656e 7420 6973 2054 7275 653a 0a20  ilent is True:. 
-00010000: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00010010: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
-00010020: 2020 2020 2020 2020 7265 7375 6c74 733a          results:
-00010030: 204c 6973 745b 556e 696f 6e5b 4a73 6f6e   List[Union[Json
-00010040: 2c20 4172 616e 676f 5365 7276 6572 4572  , ArangoServerEr
-00010050: 726f 725d 5d20 3d20 5b5d 0a20 2020 2020  ror]] = [].     
-00010060: 2020 2020 2020 2066 6f72 2062 6f64 7920         for body 
-00010070: 696e 2072 6573 702e 626f 6479 3a0a 2020  in resp.body:.  
-00010080: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00010090: 2022 5f69 6422 2069 6e20 626f 6479 3a0a   "_id" in body:.
-000100a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000100b0: 2020 2020 6966 2022 5f6f 6c64 5265 7622      if "_oldRev"
-000100c0: 2069 6e20 626f 6479 3a0a 2020 2020 2020   in body:.      
-000100d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000100e0: 2020 626f 6479 5b22 5f6f 6c64 5f72 6576    body["_old_rev
-000100f0: 225d 203d 2062 6f64 792e 706f 7028 225f  "] = body.pop("_
-00010100: 6f6c 6452 6576 2229 0a20 2020 2020 2020  oldRev").       
-00010110: 2020 2020 2020 2020 2020 2020 2072 6573               res
-00010120: 756c 7473 2e61 7070 656e 6428 626f 6479  ults.append(body
-00010130: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00010140: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00010150: 2020 2020 2020 2020 2020 2020 7375 625f              sub_
-00010160: 7265 7370 203d 2073 656c 662e 5f63 6f6e  resp = self._con
-00010170: 6e2e 7072 6570 5f62 756c 6b5f 6572 725f  n.prep_bulk_err_
-00010180: 7265 7370 6f6e 7365 2872 6573 702c 2062  response(resp, b
-00010190: 6f64 7929 0a20 2020 2020 2020 2020 2020  ody).           
-000101a0: 2020 2020 2020 2020 2072 6573 756c 7473           results
-000101b0: 2e61 7070 656e 6428 446f 6375 6d65 6e74  .append(Document
-000101c0: 496e 7365 7274 4572 726f 7228 7375 625f  InsertError(sub_
-000101d0: 7265 7370 2c20 7265 7175 6573 7429 290a  resp, request)).
-000101e0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-000101f0: 7572 6e20 7265 7375 6c74 730a 0a20 2020  urn results..   
-00010200: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00010210: 2e5f 6578 6563 7574 6528 7265 7175 6573  ._execute(reques
-00010220: 742c 2072 6573 706f 6e73 655f 6861 6e64  t, response_hand
-00010230: 6c65 7229 0a0a 2020 2020 6465 6620 7570  ler)..    def up
-00010240: 6461 7465 5f6d 616e 7928 0a20 2020 2020  date_many(.     
-00010250: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00010260: 2064 6f63 756d 656e 7473 3a20 5365 7175   documents: Sequ
-00010270: 656e 6365 5b4a 736f 6e5d 2c0a 2020 2020  ence[Json],.    
-00010280: 2020 2020 6368 6563 6b5f 7265 763a 2062      check_rev: b
-00010290: 6f6f 6c20 3d20 5472 7565 2c0a 2020 2020  ool = True,.    
-000102a0: 2020 2020 6d65 7267 653a 2062 6f6f 6c20      merge: bool 
-000102b0: 3d20 5472 7565 2c0a 2020 2020 2020 2020  = True,.        
-000102c0: 6b65 6570 5f6e 6f6e 653a 2062 6f6f 6c20  keep_none: bool 
-000102d0: 3d20 5472 7565 2c0a 2020 2020 2020 2020  = True,.        
-000102e0: 7265 7475 726e 5f6e 6577 3a20 626f 6f6c  return_new: bool
-000102f0: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
-00010300: 2020 7265 7475 726e 5f6f 6c64 3a20 626f    return_old: bo
-00010310: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
-00010320: 2020 2020 7379 6e63 3a20 4f70 7469 6f6e      sync: Option
-00010330: 616c 5b62 6f6f 6c5d 203d 204e 6f6e 652c  al[bool] = None,
-00010340: 0a20 2020 2020 2020 2073 696c 656e 743a  .        silent:
-00010350: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
-00010360: 2020 2020 2020 2072 6566 696c 6c5f 696e         refill_in
-00010370: 6465 785f 6361 6368 6573 3a20 4f70 7469  dex_caches: Opti
-00010380: 6f6e 616c 5b62 6f6f 6c5d 203d 204e 6f6e  onal[bool] = Non
-00010390: 652c 0a20 2020 2020 2020 2072 6169 7365  e,.        raise
-000103a0: 5f6f 6e5f 646f 6375 6d65 6e74 5f65 7272  _on_document_err
-000103b0: 6f72 3a20 626f 6f6c 203d 2046 616c 7365  or: bool = False
-000103c0: 2c0a 2020 2020 2920 2d3e 2052 6573 756c  ,.    ) -> Resul
-000103d0: 745b 556e 696f 6e5b 626f 6f6c 2c20 4c69  t[Union[bool, Li
-000103e0: 7374 5b55 6e69 6f6e 5b4a 736f 6e2c 2041  st[Union[Json, A
-000103f0: 7261 6e67 6f53 6572 7665 7245 7272 6f72  rangoServerError
-00010400: 5d5d 5d5d 3a0a 2020 2020 2020 2020 2222  ]]]]:.        ""
-00010410: 2255 7064 6174 6520 6d75 6c74 6970 6c65  "Update multiple
-00010420: 2064 6f63 756d 656e 7473 2e0a 0a20 2020   documents...   
-00010430: 2020 2020 202e 2e20 6e6f 7465 3a3a 0a0a       .. note::..
-00010440: 2020 2020 2020 2020 2020 2020 4966 2075              If u
-00010450: 7064 6174 696e 6720 6120 646f 6375 6d65  pdating a docume
-00010460: 6e74 2066 6169 6c73 2c20 7468 6520 6578  nt fails, the ex
-00010470: 6365 7074 696f 6e20 6973 206e 6f74 2072  ception is not r
-00010480: 6169 7365 6420 6275 740a 2020 2020 2020  aised but.      
-00010490: 2020 2020 2020 7265 7475 726e 6564 2061        returned a
-000104a0: 7320 616e 206f 626a 6563 7420 696e 2074  s an object in t
-000104b0: 6865 2072 6573 756c 7420 6c69 7374 2e20  he result list. 
-000104c0: 4974 2069 7320 7570 2074 6f20 796f 7520  It is up to you 
-000104d0: 746f 0a20 2020 2020 2020 2020 2020 2069  to.            i
-000104e0: 6e73 7065 6374 2074 6865 206c 6973 7420  nspect the list 
-000104f0: 746f 2064 6574 6572 6d69 6e65 2077 6869  to determine whi
-00010500: 6368 2064 6f63 756d 656e 7473 2077 6572  ch documents wer
-00010510: 6520 7570 6461 7465 640a 2020 2020 2020  e updated.      
-00010520: 2020 2020 2020 7375 6363 6573 7366 756c        successful
-00010530: 6c79 2028 7265 7475 726e 7320 646f 6375  ly (returns docu
-00010540: 6d65 6e74 206d 6574 6164 6174 6129 2061  ment metadata) a
-00010550: 6e64 2077 6869 6368 2077 6572 6520 6e6f  nd which were no
-00010560: 740a 2020 2020 2020 2020 2020 2020 2872  t.            (r
-00010570: 6574 7572 6e73 2065 7863 6570 7469 6f6e  eturns exception
-00010580: 206f 626a 6563 7429 2e20 416c 7465 726e   object). Altern
-00010590: 6174 6976 656c 792c 2079 6f75 2063 616e  atively, you can
-000105a0: 2072 656c 7920 6f6e 0a20 2020 2020 2020   rely on.       
-000105b0: 2020 2020 2073 6574 7469 6e67 202a 2a72       setting **r
-000105c0: 6169 7365 5f6f 6e5f 646f 6375 6d65 6e74  aise_on_document
-000105d0: 5f65 7272 6f72 2a2a 2074 6f20 5472 7565  _error** to True
-000105e0: 2028 6465 6661 756c 7473 2074 6f20 4661   (defaults to Fa
-000105f0: 6c73 6529 2e0a 0a20 2020 2020 2020 202e  lse)...        .
-00010600: 2e20 6e6f 7465 3a3a 0a0a 2020 2020 2020  . note::..      
-00010610: 2020 2020 2020 496e 2065 6467 652f 7665        In edge/ve
-00010620: 7274 6578 2063 6f6c 6c65 6374 696f 6e73  rtex collections
-00010630: 2c20 7468 6973 206d 6574 686f 6420 646f  , this method do
-00010640: 6573 204e 4f54 2070 726f 7669 6465 2074  es NOT provide t
-00010650: 6865 0a20 2020 2020 2020 2020 2020 2074  he.            t
-00010660: 7261 6e73 6163 7469 6f6e 616c 2067 7561  ransactional gua
-00010670: 7261 6e74 6565 7320 616e 6420 7661 6c69  rantees and vali
-00010680: 6461 7469 6f6e 7320 7468 6174 2073 696e  dations that sin
-00010690: 676c 6520 7570 6461 7465 0a20 2020 2020  gle update.     
-000106a0: 2020 2020 2020 206f 7065 7261 7469 6f6e         operation
-000106b0: 2064 6f65 7320 666f 7220 6772 6170 6873   does for graphs
-000106c0: 2e20 4966 2074 6865 7365 2070 726f 7065  . If these prope
-000106d0: 7274 6965 7320 6172 6520 7265 7175 6972  rties are requir
-000106e0: 6564 2c20 7365 650a 2020 2020 2020 2020  ed, see.        
-000106f0: 2020 2020 3a66 756e 633a 6061 7261 6e67      :func:`arang
-00010700: 6f2e 6461 7461 6261 7365 2e53 7461 6e64  o.database.Stand
-00010710: 6172 6444 6174 6162 6173 652e 6265 6769  ardDatabase.begi
-00010720: 6e5f 6261 7463 685f 6578 6563 7574 696f  n_batch_executio
-00010730: 6e60 0a20 2020 2020 2020 2020 2020 2066  n`.            f
-00010740: 6f72 2061 6e20 616c 7465 726e 6174 6976  or an alternativ
-00010750: 6520 6170 7072 6f61 6368 2e0a 0a20 2020  e approach...   
-00010760: 2020 2020 203a 7061 7261 6d20 646f 6375       :param docu
-00010770: 6d65 6e74 733a 2050 6172 7469 616c 206f  ments: Partial o
-00010780: 7220 6675 6c6c 2064 6f63 756d 656e 7473  r full documents
-00010790: 2077 6974 6820 7468 6520 7570 6461 7465   with the update
-000107a0: 6420 7661 6c75 6573 2e0a 2020 2020 2020  d values..      
-000107b0: 2020 2020 2020 5468 6579 206d 7573 7420        They must 
-000107c0: 636f 6e74 6169 6e20 7468 6520 225f 6964  contain the "_id
-000107d0: 2220 6f72 2022 5f6b 6579 2220 6669 656c  " or "_key" fiel
-000107e0: 6473 2e0a 2020 2020 2020 2020 3a74 7970  ds..        :typ
-000107f0: 6520 646f 6375 6d65 6e74 733a 205b 6469  e documents: [di
-00010800: 6374 5d0a 2020 2020 2020 2020 3a70 6172  ct].        :par
-00010810: 616d 2063 6865 636b 5f72 6576 3a20 4966  am check_rev: If
-00010820: 2073 6574 2074 6f20 5472 7565 2c20 7265   set to True, re
-00010830: 7669 7369 6f6e 7320 6f66 202a 2a64 6f63  visions of **doc
-00010840: 756d 656e 7473 2a2a 2028 6966 2067 6976  uments** (if giv
-00010850: 656e 290a 2020 2020 2020 2020 2020 2020  en).            
-00010860: 6172 6520 636f 6d70 6172 6564 2061 6761  are compared aga
-00010870: 696e 7374 2074 6865 2072 6576 6973 696f  inst the revisio
-00010880: 6e73 206f 6620 7461 7267 6574 2064 6f63  ns of target doc
-00010890: 756d 656e 7473 2e0a 2020 2020 2020 2020  uments..        
-000108a0: 3a74 7970 6520 6368 6563 6b5f 7265 763a  :type check_rev:
-000108b0: 2062 6f6f 6c0a 2020 2020 2020 2020 3a70   bool.        :p
-000108c0: 6172 616d 206d 6572 6765 3a20 4966 2073  aram merge: If s
-000108d0: 6574 2074 6f20 5472 7565 2c20 7375 622d  et to True, sub-
-000108e0: 6469 6374 696f 6e61 7269 6573 2061 7265  dictionaries are
-000108f0: 206d 6572 6765 6420 696e 7374 6561 6420   merged instead 
-00010900: 6f66 0a20 2020 2020 2020 2020 2020 2074  of.            t
-00010910: 6865 206e 6577 206f 6e65 7320 6f76 6572  he new ones over
-00010920: 7772 6974 696e 6720 7468 6520 6f6c 6420  writing the old 
-00010930: 6f6e 6573 2e0a 2020 2020 2020 2020 3a74  ones..        :t
-00010940: 7970 6520 6d65 7267 653a 2062 6f6f 6c20  ype merge: bool 
-00010950: 7c20 4e6f 6e65 0a20 2020 2020 2020 203a  | None.        :
-00010960: 7061 7261 6d20 6b65 6570 5f6e 6f6e 653a  param keep_none:
-00010970: 2049 6620 7365 7420 746f 2054 7275 652c   If set to True,
-00010980: 2066 6965 6c64 7320 7769 7468 2076 616c   fields with val
-00010990: 7565 204e 6f6e 6520 6172 6520 7265 7461  ue None are reta
-000109a0: 696e 6564 0a20 2020 2020 2020 2020 2020  ined.           
-000109b0: 2069 6e20 7468 6520 646f 6375 6d65 6e74   in the document
-000109c0: 2e20 4f74 6865 7277 6973 652c 2074 6865  . Otherwise, the
-000109d0: 7920 6172 6520 7265 6d6f 7665 6420 636f  y are removed co
-000109e0: 6d70 6c65 7465 6c79 2e0a 2020 2020 2020  mpletely..      
-000109f0: 2020 3a74 7970 6520 6b65 6570 5f6e 6f6e    :type keep_non
-00010a00: 653a 2062 6f6f 6c20 7c20 4e6f 6e65 0a20  e: bool | None. 
-00010a10: 2020 2020 2020 203a 7061 7261 6d20 7265         :param re
-00010a20: 7475 726e 5f6e 6577 3a20 496e 636c 7564  turn_new: Includ
-00010a30: 6520 626f 6479 206f 6620 7468 6520 6e65  e body of the ne
-00010a40: 7720 646f 6375 6d65 6e74 2069 6e20 7468  w document in th
-00010a50: 6520 7265 7475 726e 6564 0a20 2020 2020  e returned.     
-00010a60: 2020 2020 2020 206d 6574 6164 6174 612e         metadata.
-00010a70: 2049 676e 6f72 6564 2069 6620 7061 7261   Ignored if para
-00010a80: 6d65 7465 7220 2a2a 7369 6c65 6e74 2a2a  meter **silent**
-00010a90: 2069 7320 7365 7420 746f 2054 7275 652e   is set to True.
-00010aa0: 0a20 2020 2020 2020 203a 7479 7065 2072  .        :type r
-00010ab0: 6574 7572 6e5f 6e65 773a 2062 6f6f 6c0a  eturn_new: bool.
-00010ac0: 2020 2020 2020 2020 3a70 6172 616d 2072          :param r
-00010ad0: 6574 7572 6e5f 6f6c 643a 2049 6e63 6c75  eturn_old: Inclu
-00010ae0: 6465 2062 6f64 7920 6f66 2074 6865 206f  de body of the o
-00010af0: 6c64 2064 6f63 756d 656e 7420 696e 2074  ld document in t
-00010b00: 6865 2072 6574 7572 6e65 640a 2020 2020  he returned.    
-00010b10: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
-00010b20: 2e20 4967 6e6f 7265 6420 6966 2070 6172  . Ignored if par
-00010b30: 616d 6574 6572 202a 2a73 696c 656e 742a  ameter **silent*
-00010b40: 2a20 6973 2073 6574 2074 6f20 5472 7565  * is set to True
-00010b50: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
-00010b60: 7265 7475 726e 5f6f 6c64 3a20 626f 6f6c  return_old: bool
-00010b70: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00010b80: 7379 6e63 3a20 426c 6f63 6b20 756e 7469  sync: Block unti
-00010b90: 6c20 6f70 6572 6174 696f 6e20 6973 2073  l operation is s
-00010ba0: 796e 6368 726f 6e69 7a65 6420 746f 2064  ynchronized to d
-00010bb0: 6973 6b2e 0a20 2020 2020 2020 203a 7479  isk..        :ty
-00010bc0: 7065 2073 796e 633a 2062 6f6f 6c20 7c20  pe sync: bool | 
-00010bd0: 4e6f 6e65 0a20 2020 2020 2020 203a 7061  None.        :pa
-00010be0: 7261 6d20 7369 6c65 6e74 3a20 4966 2073  ram silent: If s
-00010bf0: 6574 2074 6f20 5472 7565 2c20 6e6f 2064  et to True, no d
-00010c00: 6f63 756d 656e 7420 6d65 7461 6461 7461  ocument metadata
-00010c10: 2069 7320 7265 7475 726e 6564 2e20 5468   is returned. Th
-00010c20: 6973 0a20 2020 2020 2020 2020 2020 2063  is.            c
-00010c30: 616e 2062 6520 7573 6564 2074 6f20 7361  an be used to sa
-00010c40: 7665 2072 6573 6f75 7263 6573 2e0a 2020  ve resources..  
-00010c50: 2020 2020 2020 3a74 7970 6520 7369 6c65        :type sile
-00010c60: 6e74 3a20 626f 6f6c 0a20 2020 2020 2020  nt: bool.       
-00010c70: 203a 7061 7261 6d20 7265 6669 6c6c 5f69   :param refill_i
-00010c80: 6e64 6578 5f63 6163 6865 733a 2057 6865  ndex_caches: Whe
-00010c90: 7468 6572 2074 6f20 6164 6420 6e65 7720  ther to add new 
-00010ca0: 656e 7472 6965 7320 746f 2069 6e2d 6d65  entries to in-me
-00010cb0: 6d6f 7279 0a20 2020 2020 2020 2020 2020  mory.           
-00010cc0: 2069 6e64 6578 2063 6163 6865 7320 6966   index caches if
-00010cd0: 2064 6f63 756d 656e 7420 6f70 6572 6174   document operat
-00010ce0: 696f 6e73 2061 6666 6563 7420 7468 6520  ions affect the 
-00010cf0: 6564 6765 2069 6e64 6578 206f 720a 2020  edge index or.  
-00010d00: 2020 2020 2020 2020 2020 6361 6368 652d            cache-
-00010d10: 656e 6162 6c65 6420 7065 7273 6973 7465  enabled persiste
-00010d20: 6e74 2069 6e64 6578 6573 2e0a 2020 2020  nt indexes..    
-00010d30: 2020 2020 3a74 7970 6520 7265 6669 6c6c      :type refill
-00010d40: 5f69 6e64 6578 5f63 6163 6865 733a 2062  _index_caches: b
-00010d50: 6f6f 6c20 7c20 4e6f 6e65 0a20 2020 2020  ool | None.     
-00010d60: 2020 203a 7061 7261 6d20 7261 6973 655f     :param raise_
-00010d70: 6f6e 5f64 6f63 756d 656e 745f 6572 726f  on_document_erro
-00010d80: 723a 2057 6865 7468 6572 2074 6f20 7261  r: Whether to ra
-00010d90: 6973 6520 6966 2061 2044 6f63 756d 656e  ise if a Documen
-00010da0: 7452 6576 6973 696f 6e45 7272 6f72 0a20  tRevisionError. 
-00010db0: 2020 2020 2020 2020 2020 206f 7220 6120             or a 
-00010dc0: 446f 6375 6d65 6e74 5570 6461 7465 4572  DocumentUpdateEr
-00010dd0: 726f 7220 6973 2065 6e63 6f75 6e74 6572  ror is encounter
-00010de0: 6564 206f 6e20 616e 2069 6e64 6976 6964  ed on an individ
-00010df0: 7561 6c20 646f 6375 6d65 6e74 2c0a 2020  ual document,.  
-00010e00: 2020 2020 2020 2020 2020 6173 206f 7070            as opp
-00010e10: 6f73 6564 2074 6f20 7265 7475 726e 696e  osed to returnin
-00010e20: 6720 7468 6520 6572 726f 7220 6173 2061  g the error as a
-00010e30: 6e20 6f62 6a65 6374 2069 6e20 7468 6520  n object in the 
-00010e40: 7265 7375 6c74 206c 6973 742e 0a20 2020  result list..   
-00010e50: 2020 2020 2020 2020 2044 6566 6175 6c74           Default
-00010e60: 7320 746f 2046 616c 7365 2e0a 2020 2020  s to False..    
-00010e70: 2020 2020 3a74 7970 6520 7261 6973 655f      :type raise_
-00010e80: 6f6e 5f64 6f63 756d 656e 745f 6572 726f  on_document_erro
-00010e90: 723a 2062 6f6f 6c0a 2020 2020 2020 2020  r: bool.        
-00010ea0: 3a72 6574 7572 6e3a 204c 6973 7420 6f66  :return: List of
-00010eb0: 2064 6f63 756d 656e 7420 6d65 7461 6461   document metada
-00010ec0: 7461 2028 652e 672e 2064 6f63 756d 656e  ta (e.g. documen
-00010ed0: 7420 6b65 7973 2c20 7265 7669 7369 6f6e  t keys, revision
-00010ee0: 7329 2061 6e64 0a20 2020 2020 2020 2020  s) and.         
-00010ef0: 2020 2061 6e79 2065 7863 6570 7469 6f6e     any exception
-00010f00: 732c 206f 7220 5472 7565 2069 6620 7061  s, or True if pa
-00010f10: 7261 6d65 7465 7220 2a2a 7369 6c65 6e74  rameter **silent
-00010f20: 2a2a 2077 6173 2073 6574 2074 6f20 5472  ** was set to Tr
-00010f30: 7565 2e0a 2020 2020 2020 2020 3a72 7479  ue..        :rty
-00010f40: 7065 3a20 5b64 6963 7420 7c20 4172 616e  pe: [dict | Aran
-00010f50: 676f 4572 726f 725d 207c 2062 6f6f 6c0a  goError] | bool.
-00010f60: 2020 2020 2020 2020 3a72 6169 7365 2061          :raise a
-00010f70: 7261 6e67 6f2e 6578 6365 7074 696f 6e73  rango.exceptions
-00010f80: 2e44 6f63 756d 656e 7455 7064 6174 6545  .DocumentUpdateE
-00010f90: 7272 6f72 3a20 4966 2075 7064 6174 6520  rror: If update 
-00010fa0: 6661 696c 732e 0a20 2020 2020 2020 2022  fails..        "
-00010fb0: 2222 0a20 2020 2020 2020 2070 6172 616d  "".        param
-00010fc0: 733a 2050 6172 616d 7320 3d20 7b0a 2020  s: Params = {.  
-00010fd0: 2020 2020 2020 2020 2020 226b 6565 704e            "keepN
-00010fe0: 756c 6c22 3a20 6b65 6570 5f6e 6f6e 652c  ull": keep_none,
-00010ff0: 0a20 2020 2020 2020 2020 2020 2022 6d65  .            "me
-00011000: 7267 654f 626a 6563 7473 223a 206d 6572  rgeObjects": mer
-00011010: 6765 2c0a 2020 2020 2020 2020 2020 2020  ge,.            
-00011020: 2272 6574 7572 6e4e 6577 223a 2072 6574  "returnNew": ret
-00011030: 7572 6e5f 6e65 772c 0a20 2020 2020 2020  urn_new,.       
-00011040: 2020 2020 2022 7265 7475 726e 4f6c 6422       "returnOld"
-00011050: 3a20 7265 7475 726e 5f6f 6c64 2c0a 2020  : return_old,.  
-00011060: 2020 2020 2020 2020 2020 2269 676e 6f72            "ignor
-00011070: 6552 6576 7322 3a20 6e6f 7420 6368 6563  eRevs": not chec
-00011080: 6b5f 7265 762c 0a20 2020 2020 2020 2020  k_rev,.         
-00011090: 2020 2022 6f76 6572 7772 6974 6522 3a20     "overwrite": 
-000110a0: 6e6f 7420 6368 6563 6b5f 7265 762c 0a20  not check_rev,. 
-000110b0: 2020 2020 2020 2020 2020 2022 7369 6c65             "sile
-000110c0: 6e74 223a 2073 696c 656e 742c 0a20 2020  nt": silent,.   
-000110d0: 2020 2020 207d 0a20 2020 2020 2020 2069       }.        i
-000110e0: 6620 7379 6e63 2069 7320 6e6f 7420 4e6f  f sync is not No
-000110f0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00011100: 7061 7261 6d73 5b22 7761 6974 466f 7253  params["waitForS
-00011110: 796e 6322 5d20 3d20 7379 6e63 0a0a 2020  ync"] = sync..  
-00011120: 2020 2020 2020 2320 4e65 7720 696e 2041        # New in A
-00011130: 7261 6e67 6f44 4220 332e 392e 3620 616e  rangoDB 3.9.6 an
-00011140: 6420 332e 3130 2e32 0a20 2020 2020 2020  d 3.10.2.       
-00011150: 2069 6620 7265 6669 6c6c 5f69 6e64 6578   if refill_index
-00011160: 5f63 6163 6865 7320 6973 206e 6f74 204e  _caches is not N
-00011170: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00011180: 2070 6172 616d 735b 2272 6566 696c 6c49   params["refillI
-00011190: 6e64 6578 4361 6368 6573 225d 203d 2072  ndexCaches"] = r
-000111a0: 6566 696c 6c5f 696e 6465 785f 6361 6368  efill_index_cach
-000111b0: 6573 0a0a 2020 2020 2020 2020 646f 6375  es..        docu
-000111c0: 6d65 6e74 7320 3d20 5b73 656c 662e 5f65  ments = [self._e
-000111d0: 6e73 7572 655f 6b65 795f 696e 5f62 6f64  nsure_key_in_bod
-000111e0: 7928 646f 6329 2066 6f72 2064 6f63 2069  y(doc) for doc i
-000111f0: 6e20 646f 6375 6d65 6e74 735d 0a0a 2020  n documents]..  
-00011200: 2020 2020 2020 7265 7175 6573 7420 3d20        request = 
-00011210: 5265 7175 6573 7428 0a20 2020 2020 2020  Request(.       
-00011220: 2020 2020 206d 6574 686f 643d 2270 6174       method="pat
-00011230: 6368 222c 0a20 2020 2020 2020 2020 2020  ch",.           
-00011240: 2065 6e64 706f 696e 743d 6622 2f5f 6170   endpoint=f"/_ap
-00011250: 692f 646f 6375 6d65 6e74 2f7b 7365 6c66  i/document/{self
-00011260: 2e6e 616d 657d 222c 0a20 2020 2020 2020  .name}",.       
-00011270: 2020 2020 2064 6174 613d 646f 6375 6d65       data=docume
-00011280: 6e74 732c 0a20 2020 2020 2020 2020 2020  nts,.           
-00011290: 2070 6172 616d 733d 7061 7261 6d73 2c0a   params=params,.
-000112a0: 2020 2020 2020 2020 2020 2020 7772 6974              writ
-000112b0: 653d 7365 6c66 2e6e 616d 652c 0a20 2020  e=self.name,.   
-000112c0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-000112d0: 6465 6620 7265 7370 6f6e 7365 5f68 616e  def response_han
-000112e0: 646c 6572 280a 2020 2020 2020 2020 2020  dler(.          
-000112f0: 2020 7265 7370 3a20 5265 7370 6f6e 7365    resp: Response
-00011300: 2c0a 2020 2020 2020 2020 2920 2d3e 2055  ,.        ) -> U
-00011310: 6e69 6f6e 5b62 6f6f 6c2c 204c 6973 745b  nion[bool, List[
-00011320: 556e 696f 6e5b 4a73 6f6e 2c20 4172 616e  Union[Json, Aran
-00011330: 676f 5365 7276 6572 4572 726f 725d 5d5d  goServerError]]]
-00011340: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00011350: 206e 6f74 2072 6573 702e 6973 5f73 7563   not resp.is_suc
-00011360: 6365 7373 3a0a 2020 2020 2020 2020 2020  cess:.          
-00011370: 2020 2020 2020 7261 6973 6520 446f 6375        raise Docu
-00011380: 6d65 6e74 5570 6461 7465 4572 726f 7228  mentUpdateError(
-00011390: 7265 7370 2c20 7265 7175 6573 7429 0a20  resp, request). 
-000113a0: 2020 2020 2020 2020 2020 2069 6620 7369             if si
-000113b0: 6c65 6e74 2069 7320 5472 7565 3a0a 2020  lent is True:.  
-000113c0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-000113d0: 7475 726e 2054 7275 650a 0a20 2020 2020  turn True..     
-000113e0: 2020 2020 2020 2072 6573 756c 7473 203d         results =
-000113f0: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
-00011400: 666f 7220 626f 6479 2069 6e20 7265 7370  for body in resp
-00011410: 2e62 6f64 793a 0a20 2020 2020 2020 2020  .body:.         
-00011420: 2020 2020 2020 2069 6620 225f 6964 2220         if "_id" 
-00011430: 696e 2062 6f64 793a 0a20 2020 2020 2020  in body:.       
-00011440: 2020 2020 2020 2020 2020 2020 2062 6f64               bod
-00011450: 795b 225f 6f6c 645f 7265 7622 5d20 3d20  y["_old_rev"] = 
-00011460: 626f 6479 2e70 6f70 2822 5f6f 6c64 5265  body.pop("_oldRe
-00011470: 7622 290a 2020 2020 2020 2020 2020 2020  v").            
-00011480: 2020 2020 2020 2020 7265 7375 6c74 732e          results.
-00011490: 6170 7065 6e64 2862 6f64 7929 0a20 2020  append(body).   
-000114a0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-000114b0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000114c0: 2020 2020 2020 2073 7562 5f72 6573 7020         sub_resp 
-000114d0: 3d20 7365 6c66 2e5f 636f 6e6e 2e70 7265  = self._conn.pre
-000114e0: 705f 6275 6c6b 5f65 7272 5f72 6573 706f  p_bulk_err_respo
-000114f0: 6e73 6528 7265 7370 2c20 626f 6479 290a  nse(resp, body).
-00011500: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011510: 2020 2020 2065 7272 6f72 3a20 4172 616e       error: Aran
-00011520: 676f 5365 7276 6572 4572 726f 720a 2020  goServerError.  
-00011530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011540: 2020 6966 2073 7562 5f72 6573 702e 6572    if sub_resp.er
-00011550: 726f 725f 636f 6465 203d 3d20 3132 3030  ror_code == 1200
-00011560: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00011570: 2020 2020 2020 2020 2020 6572 726f 7220            error 
-00011580: 3d20 446f 6375 6d65 6e74 5265 7669 7369  = DocumentRevisi
-00011590: 6f6e 4572 726f 7228 7375 625f 7265 7370  onError(sub_resp
-000115a0: 2c20 7265 7175 6573 7429 0a20 2020 2020  , request).     
-000115b0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000115c0: 6c73 653a 2020 2320 7072 6167 6d61 3a20  lse:  # pragma: 
-000115d0: 6e6f 2063 6f76 6572 0a20 2020 2020 2020  no cover.       
-000115e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000115f0: 2065 7272 6f72 203d 2044 6f63 756d 656e   error = Documen
-00011600: 7455 7064 6174 6545 7272 6f72 2873 7562  tUpdateError(sub
-00011610: 5f72 6573 702c 2072 6571 7565 7374 290a  _resp, request).
-00011620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011630: 2020 2020 2069 6620 7261 6973 655f 6f6e       if raise_on
-00011640: 5f64 6f63 756d 656e 745f 6572 726f 723a  _document_error:
-00011650: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011660: 2020 2020 2020 2020 2072 6169 7365 2065           raise e
-00011670: 7272 6f72 0a0a 2020 2020 2020 2020 2020  rror..          
-00011680: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-00011690: 732e 6170 7065 6e64 2865 7272 6f72 290a  s.append(error).
-000116a0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-000116b0: 7572 6e20 7265 7375 6c74 730a 0a20 2020  urn results..   
-000116c0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-000116d0: 2e5f 6578 6563 7574 6528 7265 7175 6573  ._execute(reques
-000116e0: 742c 2072 6573 706f 6e73 655f 6861 6e64  t, response_hand
-000116f0: 6c65 7229 0a0a 2020 2020 6465 6620 7570  ler)..    def up
-00011700: 6461 7465 5f6d 6174 6368 280a 2020 2020  date_match(.    
-00011710: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00011720: 2020 6669 6c74 6572 733a 204a 736f 6e2c    filters: Json,
-00011730: 0a20 2020 2020 2020 2062 6f64 793a 204a  .        body: J
-00011740: 736f 6e2c 0a20 2020 2020 2020 206c 696d  son,.        lim
-00011750: 6974 3a20 4f70 7469 6f6e 616c 5b69 6e74  it: Optional[int
-00011760: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-00011770: 2020 6b65 6570 5f6e 6f6e 653a 2062 6f6f    keep_none: boo
-00011780: 6c20 3d20 5472 7565 2c0a 2020 2020 2020  l = True,.      
-00011790: 2020 7379 6e63 3a20 4f70 7469 6f6e 616c    sync: Optional
-000117a0: 5b62 6f6f 6c5d 203d 204e 6f6e 652c 0a20  [bool] = None,. 
-000117b0: 2020 2020 2020 206d 6572 6765 3a20 626f         merge: bo
-000117c0: 6f6c 203d 2054 7275 652c 0a20 2020 2020  ol = True,.     
-000117d0: 2020 2061 6c6c 6f77 5f64 6972 7479 5f72     allow_dirty_r
-000117e0: 6561 643a 2062 6f6f 6c20 3d20 4661 6c73  ead: bool = Fals
-000117f0: 652c 0a20 2020 2029 202d 3e20 5265 7375  e,.    ) -> Resu
-00011800: 6c74 5b69 6e74 5d3a 0a20 2020 2020 2020  lt[int]:.       
-00011810: 2022 2222 5570 6461 7465 206d 6174 6368   """Update match
-00011820: 696e 6720 646f 6375 6d65 6e74 732e 0a0a  ing documents...
-00011830: 2020 2020 2020 2020 2e2e 206e 6f74 653a          .. note:
-00011840: 3a0a 0a20 2020 2020 2020 2020 2020 2049  :..            I
-00011850: 6e20 6564 6765 2f76 6572 7465 7820 636f  n edge/vertex co
-00011860: 6c6c 6563 7469 6f6e 732c 2074 6869 7320  llections, this 
-00011870: 6d65 7468 6f64 2064 6f65 7320 4e4f 5420  method does NOT 
-00011880: 7072 6f76 6964 6520 7468 650a 2020 2020  provide the.    
-00011890: 2020 2020 2020 2020 7472 616e 7361 6374          transact
-000118a0: 696f 6e61 6c20 6775 6172 616e 7465 6573  ional guarantees
-000118b0: 2061 6e64 2076 616c 6964 6174 696f 6e73   and validations
-000118c0: 2074 6861 7420 7369 6e67 6c65 2075 7064   that single upd
-000118d0: 6174 650a 2020 2020 2020 2020 2020 2020  ate.            
-000118e0: 6f70 6572 6174 696f 6e20 646f 6573 2066  operation does f
-000118f0: 6f72 2067 7261 7068 732e 2049 6620 7468  or graphs. If th
-00011900: 6573 6520 7072 6f70 6572 7469 6573 2061  ese properties a
-00011910: 7265 2072 6571 7569 7265 642c 2073 6565  re required, see
-00011920: 0a20 2020 2020 2020 2020 2020 203a 6675  .            :fu
-00011930: 6e63 3a60 6172 616e 676f 2e64 6174 6162  nc:`arango.datab
-00011940: 6173 652e 5374 616e 6461 7264 4461 7461  ase.StandardData
-00011950: 6261 7365 2e62 6567 696e 5f62 6174 6368  base.begin_batch
-00011960: 5f65 7865 6375 7469 6f6e 600a 2020 2020  _execution`.    
-00011970: 2020 2020 2020 2020 666f 7220 616e 2061          for an a
-00011980: 6c74 6572 6e61 7469 7665 2061 7070 726f  lternative appro
-00011990: 6163 682e 0a0a 2020 2020 2020 2020 3a70  ach...        :p
-000119a0: 6172 616d 2066 696c 7465 7273 3a20 446f  aram filters: Do
-000119b0: 6375 6d65 6e74 2066 696c 7465 7273 2e0a  cument filters..
-000119c0: 2020 2020 2020 2020 3a74 7970 6520 6669          :type fi
-000119d0: 6c74 6572 733a 2064 6963 740a 2020 2020  lters: dict.    
-000119e0: 2020 2020 3a70 6172 616d 2062 6f64 793a      :param body:
-000119f0: 2046 756c 6c20 6f72 2070 6172 7469 616c   Full or partial
-00011a00: 2064 6f63 756d 656e 7420 626f 6479 2077   document body w
-00011a10: 6974 6820 7468 6520 7570 6461 7465 732e  ith the updates.
-00011a20: 0a20 2020 2020 2020 203a 7479 7065 2062  .        :type b
-00011a30: 6f64 793a 2064 6963 740a 2020 2020 2020  ody: dict.      
-00011a40: 2020 3a70 6172 616d 206c 696d 6974 3a20    :param limit: 
-00011a50: 4d61 7820 6e75 6d62 6572 206f 6620 646f  Max number of do
-00011a60: 6375 6d65 6e74 7320 746f 2075 7064 6174  cuments to updat
-00011a70: 652e 2049 6620 7468 6520 6c69 6d69 7420  e. If the limit 
-00011a80: 6973 206c 6f77 6572 0a20 2020 2020 2020  is lower.       
-00011a90: 2020 2020 2074 6861 6e20 7468 6520 6e75       than the nu
-00011aa0: 6d62 6572 206f 6620 6d61 7463 6865 6420  mber of matched 
-00011ab0: 646f 6375 6d65 6e74 732c 2072 616e 646f  documents, rando
-00011ac0: 6d20 646f 6375 6d65 6e74 7320 6172 650a  m documents are.
-00011ad0: 2020 2020 2020 2020 2020 2020 6368 6f73              chos
-00011ae0: 656e 2e20 5468 6973 2070 6172 616d 6574  en. This paramet
-00011af0: 6572 2069 7320 6e6f 7420 7375 7070 6f72  er is not suppor
-00011b00: 7465 6420 6f6e 2073 6861 7264 6564 2063  ted on sharded c
-00011b10: 6f6c 6c65 6374 696f 6e73 2e0a 2020 2020  ollections..    
-00011b20: 2020 2020 3a74 7970 6520 6c69 6d69 743a      :type limit:
-00011b30: 2069 6e74 207c 204e 6f6e 650a 2020 2020   int | None.    
-00011b40: 2020 2020 3a70 6172 616d 206b 6565 705f      :param keep_
-00011b50: 6e6f 6e65 3a20 4966 2073 6574 2074 6f20  none: If set to 
-00011b60: 5472 7565 2c20 6669 656c 6473 2077 6974  True, fields wit
-00011b70: 6820 7661 6c75 6520 4e6f 6e65 2061 7265  h value None are
-00011b80: 2072 6574 6169 6e65 640a 2020 2020 2020   retained.      
-00011b90: 2020 2020 2020 696e 2074 6865 2064 6f63        in the doc
-00011ba0: 756d 656e 742e 204f 7468 6572 7769 7365  ument. Otherwise
-00011bb0: 2c20 7468 6579 2061 7265 2072 656d 6f76  , they are remov
-00011bc0: 6564 2063 6f6d 706c 6574 656c 792e 0a20  ed completely.. 
-00011bd0: 2020 2020 2020 203a 7479 7065 206b 6565         :type kee
-00011be0: 705f 6e6f 6e65 3a20 626f 6f6c 207c 204e  p_none: bool | N
-00011bf0: 6f6e 650a 2020 2020 2020 2020 3a70 6172  one.        :par
-00011c00: 616d 2073 796e 633a 2042 6c6f 636b 2075  am sync: Block u
-00011c10: 6e74 696c 206f 7065 7261 7469 6f6e 2069  ntil operation i
-00011c20: 7320 7379 6e63 6872 6f6e 697a 6564 2074  s synchronized t
-00011c30: 6f20 6469 736b 2e0a 2020 2020 2020 2020  o disk..        
-00011c40: 3a74 7970 6520 7379 6e63 3a20 626f 6f6c  :type sync: bool
-00011c50: 207c 204e 6f6e 650a 2020 2020 2020 2020   | None.        
-00011c60: 3a70 6172 616d 206d 6572 6765 3a20 4966  :param merge: If
-00011c70: 2073 6574 2074 6f20 5472 7565 2c20 7375   set to True, su
-00011c80: 622d 6469 6374 696f 6e61 7269 6573 2061  b-dictionaries a
-00011c90: 7265 206d 6572 6765 6420 696e 7374 6561  re merged instea
-00011ca0: 6420 6f66 0a20 2020 2020 2020 2020 2020  d of.           
-00011cb0: 2074 6865 206e 6577 206f 6e65 7320 6f76   the new ones ov
-00011cc0: 6572 7772 6974 696e 6720 7468 6520 6f6c  erwriting the ol
-00011cd0: 6420 6f6e 6573 2e0a 2020 2020 2020 2020  d ones..        
-00011ce0: 3a74 7970 6520 6d65 7267 653a 2062 6f6f  :type merge: boo
-00011cf0: 6c20 7c20 4e6f 6e65 0a20 2020 2020 2020  l | None.       
-00011d00: 203a 7061 7261 6d20 616c 6c6f 775f 6469   :param allow_di
-00011d10: 7274 795f 7265 6164 3a20 416c 6c6f 7720  rty_read: Allow 
-00011d20: 7265 6164 7320 6672 6f6d 2066 6f6c 6c6f  reads from follo
-00011d30: 7765 7273 2069 6e20 6120 636c 7573 7465  wers in a cluste
-00011d40: 722e 0a20 2020 2020 2020 203a 7479 7065  r..        :type
-00011d50: 2061 6c6c 6f77 5f64 6972 7479 5f72 6561   allow_dirty_rea
-00011d60: 643a 2062 6f6f 6c0a 2020 2020 2020 2020  d: bool.        
-00011d70: 3a72 6574 7572 6e3a 204e 756d 6265 7220  :return: Number 
-00011d80: 6f66 2064 6f63 756d 656e 7473 2075 7064  of documents upd
-00011d90: 6174 6564 2e0a 2020 2020 2020 2020 3a72  ated..        :r
-00011da0: 7479 7065 3a20 696e 740a 2020 2020 2020  type: int.      
-00011db0: 2020 3a72 6169 7365 2061 7261 6e67 6f2e    :raise arango.
-00011dc0: 6578 6365 7074 696f 6e73 2e44 6f63 756d  exceptions.Docum
-00011dd0: 656e 7455 7064 6174 6545 7272 6f72 3a20  entUpdateError: 
-00011de0: 4966 2075 7064 6174 6520 6661 696c 732e  If update fails.
-00011df0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00011e00: 2020 2020 2061 7373 6572 7420 6973 696e       assert isin
-00011e10: 7374 616e 6365 2866 696c 7465 7273 2c20  stance(filters, 
-00011e20: 6469 6374 292c 2022 6669 6c74 6572 7320  dict), "filters 
-00011e30: 6d75 7374 2062 6520 6120 6469 6374 220a  must be a dict".
-00011e40: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-00011e50: 735f 6e6f 6e65 5f6f 725f 696e 7428 6c69  s_none_or_int(li
-00011e60: 6d69 7429 2c20 226c 696d 6974 206d 7573  mit), "limit mus
-00011e70: 7420 6265 2061 206e 6f6e 2d6e 6567 6174  t be a non-negat
-00011e80: 6976 6520 696e 7422 0a20 2020 2020 2020  ive int".       
-00011e90: 2061 7373 6572 7420 6973 5f6e 6f6e 655f   assert is_none_
-00011ea0: 6f72 5f62 6f6f 6c28 7379 6e63 292c 2022  or_bool(sync), "
-00011eb0: 7379 6e63 206d 7573 7420 6265 204e 6f6e  sync must be Non
-00011ec0: 6520 6f72 2061 2062 6f6f 6c22 0a0a 2020  e or a bool"..  
-00011ed0: 2020 2020 2020 2320 4966 2074 6865 2077        # If the w
-00011ee0: 6169 7446 6f72 5379 6e63 2070 6172 616d  aitForSync param
-00011ef0: 6574 6572 2069 7320 6e6f 7420 7370 6563  eter is not spec
-00011f00: 6966 6965 6420 6f72 2073 6574 2074 6f20  ified or set to 
-00011f10: 6661 6c73 652c 0a20 2020 2020 2020 2023  false,.        #
-00011f20: 2074 6865 6e20 7468 6520 636f 6c6c 6563   then the collec
-00011f30: 7469 6f6e e280 9973 2064 6566 6175 6c74  tion...s default
-00011f40: 2077 6169 7446 6f72 5379 6e63 2062 6568   waitForSync beh
-00011f50: 6176 696f 7220 6973 2061 7070 6c69 6564  avior is applied
-00011f60: 2e0a 2020 2020 2020 2020 7379 6e63 5f76  ..        sync_v
-00011f70: 616c 203d 2066 222c 2077 6169 7446 6f72  al = f", waitFor
-00011f80: 5379 6e63 3a20 7b73 796e 637d 2220 6966  Sync: {sync}" if
-00011f90: 2073 796e 6320 6973 206e 6f74 204e 6f6e   sync is not Non
-00011fa0: 6520 656c 7365 2022 220a 0a20 2020 2020  e else ""..     
-00011fb0: 2020 2071 7565 7279 203d 2066 2222 220a     query = f""".
-00011fc0: 2020 2020 2020 2020 2020 2020 464f 5220              FOR 
-00011fd0: 646f 6320 494e 2040 4063 6f6c 6c65 6374  doc IN @@collect
-00011fe0: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
-00011ff0: 2020 2020 7b62 7569 6c64 5f66 696c 7465      {build_filte
-00012000: 725f 636f 6e64 6974 696f 6e73 2866 696c  r_conditions(fil
-00012010: 7465 7273 297d 0a20 2020 2020 2020 2020  ters)}.         
-00012020: 2020 2020 2020 207b 6622 4c49 4d49 5420         {f"LIMIT 
-00012030: 7b6c 696d 6974 7d22 2069 6620 6c69 6d69  {limit}" if limi
-00012040: 7420 6973 206e 6f74 204e 6f6e 6520 656c  t is not None el
-00012050: 7365 2022 227d 0a20 2020 2020 2020 2020  se ""}.         
-00012060: 2020 2020 2020 2055 5044 4154 4520 646f         UPDATE do
-00012070: 6320 5749 5448 2040 626f 6479 2049 4e20  c WITH @body IN 
-00012080: 4040 636f 6c6c 6563 7469 6f6e 0a20 2020  @@collection.   
-00012090: 2020 2020 2020 2020 2020 2020 204f 5054               OPT
-000120a0: 494f 4e53 207b 7b20 6b65 6570 4e75 6c6c  IONS {{ keepNull
-000120b0: 3a20 406b 6565 705f 6e6f 6e65 2c20 6d65  : @keep_none, me
-000120c0: 7267 654f 626a 6563 7473 3a20 406d 6572  rgeObjects: @mer
-000120d0: 6765 207b 7379 6e63 5f76 616c 7d20 7d7d  ge {sync_val} }}
-000120e0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-000120f0: 2020 2020 2020 6269 6e64 5f76 6172 7320        bind_vars 
-00012100: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-00012110: 2240 636f 6c6c 6563 7469 6f6e 223a 2073  "@collection": s
-00012120: 656c 662e 6e61 6d65 2c0a 2020 2020 2020  elf.name,.      
-00012130: 2020 2020 2020 2262 6f64 7922 3a20 626f        "body": bo
-00012140: 6479 2c0a 2020 2020 2020 2020 2020 2020  dy,.            
-00012150: 226b 6565 705f 6e6f 6e65 223a 206b 6565  "keep_none": kee
-00012160: 705f 6e6f 6e65 2c0a 2020 2020 2020 2020  p_none,.        
-00012170: 2020 2020 226d 6572 6765 223a 206d 6572      "merge": mer
-00012180: 6765 2c0a 2020 2020 2020 2020 7d0a 0a20  ge,.        }.. 
-00012190: 2020 2020 2020 2072 6571 7565 7374 203d         request =
-000121a0: 2052 6571 7565 7374 280a 2020 2020 2020   Request(.      
-000121b0: 2020 2020 2020 6d65 7468 6f64 3d22 706f        method="po
-000121c0: 7374 222c 0a20 2020 2020 2020 2020 2020  st",.           
-000121d0: 2065 6e64 706f 696e 743d 222f 5f61 7069   endpoint="/_api
-000121e0: 2f63 7572 736f 7222 2c0a 2020 2020 2020  /cursor",.      
-000121f0: 2020 2020 2020 6461 7461 3d7b 2271 7565        data={"que
-00012200: 7279 223a 2071 7565 7279 2c20 2262 696e  ry": query, "bin
-00012210: 6456 6172 7322 3a20 6269 6e64 5f76 6172  dVars": bind_var
-00012220: 737d 2c0a 2020 2020 2020 2020 2020 2020  s},.            
-00012230: 7772 6974 653d 7365 6c66 2e6e 616d 652c  write=self.name,
-00012240: 0a20 2020 2020 2020 2020 2020 2068 6561  .            hea
-00012250: 6465 7273 3d7b 2278 2d61 7261 6e67 6f2d  ders={"x-arango-
-00012260: 616c 6c6f 772d 6469 7274 792d 7265 6164  allow-dirty-read
-00012270: 223a 2022 7472 7565 227d 2069 6620 616c  ": "true"} if al
-00012280: 6c6f 775f 6469 7274 795f 7265 6164 2065  low_dirty_read e
-00012290: 6c73 6520 4e6f 6e65 2c0a 2020 2020 2020  lse None,.      
-000122a0: 2020 290a 0a20 2020 2020 2020 2064 6566    )..        def
-000122b0: 2072 6573 706f 6e73 655f 6861 6e64 6c65   response_handle
-000122c0: 7228 7265 7370 3a20 5265 7370 6f6e 7365  r(resp: Response
-000122d0: 2920 2d3e 2069 6e74 3a0a 2020 2020 2020  ) -> int:.      
-000122e0: 2020 2020 2020 6966 2072 6573 702e 6973        if resp.is
-000122f0: 5f73 7563 6365 7373 3a0a 2020 2020 2020  _success:.      
-00012300: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-00012310: 3a20 696e 7420 3d20 7265 7370 2e62 6f64  : int = resp.bod
-00012320: 795b 2265 7874 7261 225d 5b22 7374 6174  y["extra"]["stat
-00012330: 7322 5d5b 2277 7269 7465 7345 7865 6375  s"]["writesExecu
-00012340: 7465 6422 5d0a 2020 2020 2020 2020 2020  ted"].          
-00012350: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-00012360: 756c 740a 2020 2020 2020 2020 2020 2020  ult.            
-00012370: 7261 6973 6520 446f 6375 6d65 6e74 5570  raise DocumentUp
-00012380: 6461 7465 4572 726f 7228 7265 7370 2c20  dateError(resp, 
-00012390: 7265 7175 6573 7429 0a0a 2020 2020 2020  request)..      
-000123a0: 2020 7265 7475 726e 2073 656c 662e 5f65    return self._e
-000123b0: 7865 6375 7465 2872 6571 7565 7374 2c20  xecute(request, 
-000123c0: 7265 7370 6f6e 7365 5f68 616e 646c 6572  response_handler
-000123d0: 290a 0a20 2020 2064 6566 2072 6570 6c61  )..    def repla
-000123e0: 6365 5f6d 616e 7928 0a20 2020 2020 2020  ce_many(.       
-000123f0: 2073 656c 662c 0a20 2020 2020 2020 2064   self,.        d
-00012400: 6f63 756d 656e 7473 3a20 5365 7175 656e  ocuments: Sequen
-00012410: 6365 5b4a 736f 6e5d 2c0a 2020 2020 2020  ce[Json],.      
-00012420: 2020 6368 6563 6b5f 7265 763a 2062 6f6f    check_rev: boo
-00012430: 6c20 3d20 5472 7565 2c0a 2020 2020 2020  l = True,.      
-00012440: 2020 7265 7475 726e 5f6e 6577 3a20 626f    return_new: bo
-00012450: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
-00012460: 2020 2020 7265 7475 726e 5f6f 6c64 3a20      return_old: 
-00012470: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
-00012480: 2020 2020 2020 7379 6e63 3a20 4f70 7469        sync: Opti
-00012490: 6f6e 616c 5b62 6f6f 6c5d 203d 204e 6f6e  onal[bool] = Non
-000124a0: 652c 0a20 2020 2020 2020 2073 696c 656e  e,.        silen
-000124b0: 743a 2062 6f6f 6c20 3d20 4661 6c73 652c  t: bool = False,
-000124c0: 0a20 2020 2020 2020 2072 6566 696c 6c5f  .        refill_
-000124d0: 696e 6465 785f 6361 6368 6573 3a20 4f70  index_caches: Op
-000124e0: 7469 6f6e 616c 5b62 6f6f 6c5d 203d 204e  tional[bool] = N
-000124f0: 6f6e 652c 0a20 2020 2029 202d 3e20 5265  one,.    ) -> Re
-00012500: 7375 6c74 5b55 6e69 6f6e 5b62 6f6f 6c2c  sult[Union[bool,
-00012510: 204c 6973 745b 556e 696f 6e5b 4a73 6f6e   List[Union[Json
-00012520: 2c20 4172 616e 676f 5365 7276 6572 4572  , ArangoServerEr
-00012530: 726f 725d 5d5d 5d3a 0a20 2020 2020 2020  ror]]]]:.       
-00012540: 2022 2222 5265 706c 6163 6520 6d75 6c74   """Replace mult
-00012550: 6970 6c65 2064 6f63 756d 656e 7473 2e0a  iple documents..
-00012560: 0a20 2020 2020 2020 202e 2e20 6e6f 7465  .        .. note
-00012570: 3a3a 0a0a 2020 2020 2020 2020 2020 2020  ::..            
-00012580: 4966 2072 6570 6c61 6369 6e67 2061 2064  If replacing a d
-00012590: 6f63 756d 656e 7420 6661 696c 732c 2074  ocument fails, t
-000125a0: 6865 2065 7863 6570 7469 6f6e 2069 7320  he exception is 
-000125b0: 6e6f 7420 7261 6973 6564 2062 7574 0a20  not raised but. 
-000125c0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000125d0: 6e65 6420 6173 2061 6e20 6f62 6a65 6374  ned as an object
-000125e0: 2069 6e20 7468 6520 7265 7375 6c74 206c   in the result l
-000125f0: 6973 742e 2049 7420 6973 2075 7020 746f  ist. It is up to
-00012600: 2079 6f75 2074 6f0a 2020 2020 2020 2020   you to.        
-00012610: 2020 2020 696e 7370 6563 7420 7468 6520      inspect the 
-00012620: 6c69 7374 2074 6f20 6465 7465 726d 696e  list to determin
-00012630: 6520 7768 6963 6820 646f 6375 6d65 6e74  e which document
-00012640: 7320 7765 7265 2072 6570 6c61 6365 640a  s were replaced.
-00012650: 2020 2020 2020 2020 2020 2020 7375 6363              succ
-00012660: 6573 7366 756c 6c79 2028 7265 7475 726e  essfully (return
-00012670: 7320 646f 6375 6d65 6e74 206d 6574 6164  s document metad
-00012680: 6174 6129 2061 6e64 2077 6869 6368 2077  ata) and which w
-00012690: 6572 6520 6e6f 740a 2020 2020 2020 2020  ere not.        
-000126a0: 2020 2020 2872 6574 7572 6e73 2065 7863      (returns exc
-000126b0: 6570 7469 6f6e 206f 626a 6563 7429 2e0a  eption object)..
-000126c0: 0a20 2020 2020 2020 202e 2e20 6e6f 7465  .        .. note
-000126d0: 3a3a 0a0a 2020 2020 2020 2020 2020 2020  ::..            
-000126e0: 496e 2065 6467 652f 7665 7274 6578 2063  In edge/vertex c
-000126f0: 6f6c 6c65 6374 696f 6e73 2c20 7468 6973  ollections, this
-00012700: 206d 6574 686f 6420 646f 6573 204e 4f54   method does NOT
-00012710: 2070 726f 7669 6465 2074 6865 0a20 2020   provide the.   
-00012720: 2020 2020 2020 2020 2074 7261 6e73 6163           transac
-00012730: 7469 6f6e 616c 2067 7561 7261 6e74 6565  tional guarantee
-00012740: 7320 616e 6420 7661 6c69 6461 7469 6f6e  s and validation
-00012750: 7320 7468 6174 2073 696e 676c 6520 7265  s that single re
-00012760: 706c 6163 650a 2020 2020 2020 2020 2020  place.          
-00012770: 2020 6f70 6572 6174 696f 6e20 646f 6573    operation does
-00012780: 2066 6f72 2067 7261 7068 732e 2049 6620   for graphs. If 
-00012790: 7468 6573 6520 7072 6f70 6572 7469 6573  these properties
-000127a0: 2061 7265 2072 6571 7569 7265 642c 2073   are required, s
-000127b0: 6565 0a20 2020 2020 2020 2020 2020 203a  ee.            :
-000127c0: 6675 6e63 3a60 6172 616e 676f 2e64 6174  func:`arango.dat
-000127d0: 6162 6173 652e 5374 616e 6461 7264 4461  abase.StandardDa
-000127e0: 7461 6261 7365 2e62 6567 696e 5f62 6174  tabase.begin_bat
-000127f0: 6368 5f65 7865 6375 7469 6f6e 600a 2020  ch_execution`.  
-00012800: 2020 2020 2020 2020 2020 666f 7220 616e            for an
-00012810: 2061 6c74 6572 6e61 7469 7665 2061 7070   alternative app
-00012820: 726f 6163 682e 0a0a 2020 2020 2020 2020  roach...        
-00012830: 3a70 6172 616d 2064 6f63 756d 656e 7473  :param documents
-00012840: 3a20 4e65 7720 646f 6375 6d65 6e74 7320  : New documents 
-00012850: 746f 2072 6570 6c61 6365 2074 6865 206f  to replace the o
-00012860: 6c64 206f 6e65 7320 7769 7468 2e20 5468  ld ones with. Th
-00012870: 6579 206d 7573 740a 2020 2020 2020 2020  ey must.        
-00012880: 2020 2020 636f 6e74 6169 6e20 7468 6520      contain the 
-00012890: 225f 6964 2220 6f72 2022 5f6b 6579 2220  "_id" or "_key" 
-000128a0: 6669 656c 6473 2e20 4564 6765 2064 6f63  fields. Edge doc
-000128b0: 756d 656e 7473 206d 7573 7420 616c 736f  uments must also
-000128c0: 2068 6176 650a 2020 2020 2020 2020 2020   have.          
-000128d0: 2020 225f 6672 6f6d 2220 616e 6420 225f    "_from" and "_
-000128e0: 746f 2220 6669 656c 6473 2e0a 2020 2020  to" fields..    
-000128f0: 2020 2020 3a74 7970 6520 646f 6375 6d65      :type docume
-00012900: 6e74 733a 205b 6469 6374 5d0a 2020 2020  nts: [dict].    
-00012910: 2020 2020 3a70 6172 616d 2063 6865 636b      :param check
-00012920: 5f72 6576 3a20 4966 2073 6574 2074 6f20  _rev: If set to 
-00012930: 5472 7565 2c20 7265 7669 7369 6f6e 7320  True, revisions 
-00012940: 6f66 202a 2a64 6f63 756d 656e 7473 2a2a  of **documents**
-00012950: 2028 6966 2067 6976 656e 290a 2020 2020   (if given).    
-00012960: 2020 2020 2020 2020 6172 6520 636f 6d70          are comp
-00012970: 6172 6564 2061 6761 696e 7374 2074 6865  ared against the
-00012980: 2072 6576 6973 696f 6e73 206f 6620 7461   revisions of ta
-00012990: 7267 6574 2064 6f63 756d 656e 7473 2e0a  rget documents..
-000129a0: 2020 2020 2020 2020 3a74 7970 6520 6368          :type ch
-000129b0: 6563 6b5f 7265 763a 2062 6f6f 6c0a 2020  eck_rev: bool.  
-000129c0: 2020 2020 2020 3a70 6172 616d 2072 6574        :param ret
-000129d0: 7572 6e5f 6e65 773a 2049 6e63 6c75 6465  urn_new: Include
-000129e0: 2062 6f64 7920 6f66 2074 6865 206e 6577   body of the new
-000129f0: 2064 6f63 756d 656e 7420 696e 2074 6865   document in the
-00012a00: 2072 6574 7572 6e65 640a 2020 2020 2020   returned.      
-00012a10: 2020 2020 2020 6d65 7461 6461 7461 2e20        metadata. 
-00012a20: 4967 6e6f 7265 6420 6966 2070 6172 616d  Ignored if param
-00012a30: 6574 6572 202a 2a73 696c 656e 742a 2a20  eter **silent** 
-00012a40: 6973 2073 6574 2074 6f20 5472 7565 2e0a  is set to True..
-00012a50: 2020 2020 2020 2020 3a74 7970 6520 7265          :type re
-00012a60: 7475 726e 5f6e 6577 3a20 626f 6f6c 0a20  turn_new: bool. 
-00012a70: 2020 2020 2020 203a 7061 7261 6d20 7265         :param re
-00012a80: 7475 726e 5f6f 6c64 3a20 496e 636c 7564  turn_old: Includ
-00012a90: 6520 626f 6479 206f 6620 7468 6520 6f6c  e body of the ol
-00012aa0: 6420 646f 6375 6d65 6e74 2069 6e20 7468  d document in th
-00012ab0: 6520 7265 7475 726e 6564 0a20 2020 2020  e returned.     
-00012ac0: 2020 2020 2020 206d 6574 6164 6174 612e         metadata.
-00012ad0: 2049 676e 6f72 6564 2069 6620 7061 7261   Ignored if para
-00012ae0: 6d65 7465 7220 2a2a 7369 6c65 6e74 2a2a  meter **silent**
-00012af0: 2069 7320 7365 7420 746f 2054 7275 652e   is set to True.
-00012b00: 0a20 2020 2020 2020 203a 7479 7065 2072  .        :type r
-00012b10: 6574 7572 6e5f 6f6c 643a 2062 6f6f 6c0a  eturn_old: bool.
-00012b20: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
-00012b30: 796e 633a 2042 6c6f 636b 2075 6e74 696c  ync: Block until
-00012b40: 206f 7065 7261 7469 6f6e 2069 7320 7379   operation is sy
-00012b50: 6e63 6872 6f6e 697a 6564 2074 6f20 6469  nchronized to di
-00012b60: 736b 2e0a 2020 2020 2020 2020 3a74 7970  sk..        :typ
-00012b70: 6520 7379 6e63 3a20 626f 6f6c 207c 204e  e sync: bool | N
-00012b80: 6f6e 650a 2020 2020 2020 2020 3a70 6172  one.        :par
-00012b90: 616d 2073 696c 656e 743a 2049 6620 7365  am silent: If se
-00012ba0: 7420 746f 2054 7275 652c 206e 6f20 646f  t to True, no do
-00012bb0: 6375 6d65 6e74 206d 6574 6164 6174 6120  cument metadata 
-00012bc0: 6973 2072 6574 7572 6e65 642e 2054 6869  is returned. Thi
-00012bd0: 730a 2020 2020 2020 2020 2020 2020 6361  s.            ca
-00012be0: 6e20 6265 2075 7365 6420 746f 2073 6176  n be used to sav
-00012bf0: 6520 7265 736f 7572 6365 732e 0a20 2020  e resources..   
-00012c00: 2020 2020 203a 7479 7065 2073 696c 656e       :type silen
-00012c10: 743a 2062 6f6f 6c0a 2020 2020 2020 2020  t: bool.        
-00012c20: 3a70 6172 616d 2072 6566 696c 6c5f 696e  :param refill_in
-00012c30: 6465 785f 6361 6368 6573 3a20 5768 6574  dex_caches: Whet
-00012c40: 6865 7220 746f 2061 6464 206e 6577 2065  her to add new e
-00012c50: 6e74 7269 6573 2074 6f20 696e 2d6d 656d  ntries to in-mem
-00012c60: 6f72 790a 2020 2020 2020 2020 2020 2020  ory.            
-00012c70: 696e 6465 7820 6361 6368 6573 2069 6620  index caches if 
-00012c80: 646f 6375 6d65 6e74 206f 7065 7261 7469  document operati
-00012c90: 6f6e 7320 6166 6665 6374 2074 6865 2065  ons affect the e
-00012ca0: 6467 6520 696e 6465 7820 6f72 0a20 2020  dge index or.   
-00012cb0: 2020 2020 2020 2020 2063 6163 6865 2d65           cache-e
-00012cc0: 6e61 626c 6564 2070 6572 7369 7374 656e  nabled persisten
-00012cd0: 7420 696e 6465 7865 732e 0a20 2020 2020  t indexes..     
-00012ce0: 2020 203a 7479 7065 2072 6566 696c 6c5f     :type refill_
-00012cf0: 696e 6465 785f 6361 6368 6573 3a20 626f  index_caches: bo
-00012d00: 6f6c 207c 204e 6f6e 650a 2020 2020 2020  ol | None.      
-00012d10: 2020 3a72 6574 7572 6e3a 204c 6973 7420    :return: List 
-00012d20: 6f66 2064 6f63 756d 656e 7420 6d65 7461  of document meta
-00012d30: 6461 7461 2028 652e 672e 2064 6f63 756d  data (e.g. docum
-00012d40: 656e 7420 6b65 7973 2c20 7265 7669 7369  ent keys, revisi
-00012d50: 6f6e 7329 2061 6e64 0a20 2020 2020 2020  ons) and.       
-00012d60: 2020 2020 2061 6e79 2065 7863 6570 7469       any excepti
-00012d70: 6f6e 732c 206f 7220 5472 7565 2069 6620  ons, or True if 
-00012d80: 7061 7261 6d65 7465 7220 2a2a 7369 6c65  parameter **sile
-00012d90: 6e74 2a2a 2077 6173 2073 6574 2074 6f20  nt** was set to 
-00012da0: 5472 7565 2e0a 2020 2020 2020 2020 3a72  True..        :r
-00012db0: 7479 7065 3a20 5b64 6963 7420 7c20 4172  type: [dict | Ar
-00012dc0: 616e 676f 5365 7276 6572 4572 726f 725d  angoServerError]
-00012dd0: 207c 2062 6f6f 6c0a 2020 2020 2020 2020   | bool.        
-00012de0: 3a72 6169 7365 2061 7261 6e67 6f2e 6578  :raise arango.ex
-00012df0: 6365 7074 696f 6e73 2e44 6f63 756d 656e  ceptions.Documen
-00012e00: 7452 6570 6c61 6365 4572 726f 723a 2049  tReplaceError: I
-00012e10: 6620 7265 706c 6163 6520 6661 696c 732e  f replace fails.
-00012e20: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00012e30: 2020 2020 2070 6172 616d 733a 2050 6172       params: Par
-00012e40: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
-00012e50: 2020 2020 2272 6574 7572 6e4e 6577 223a      "returnNew":
-00012e60: 2072 6574 7572 6e5f 6e65 772c 0a20 2020   return_new,.   
-00012e70: 2020 2020 2020 2020 2022 7265 7475 726e           "return
-00012e80: 4f6c 6422 3a20 7265 7475 726e 5f6f 6c64  Old": return_old
-00012e90: 2c0a 2020 2020 2020 2020 2020 2020 2269  ,.            "i
-00012ea0: 676e 6f72 6552 6576 7322 3a20 6e6f 7420  gnoreRevs": not 
-00012eb0: 6368 6563 6b5f 7265 762c 0a20 2020 2020  check_rev,.     
-00012ec0: 2020 2020 2020 2022 6f76 6572 7772 6974         "overwrit
-00012ed0: 6522 3a20 6e6f 7420 6368 6563 6b5f 7265  e": not check_re
-00012ee0: 762c 0a20 2020 2020 2020 2020 2020 2022  v,.            "
-00012ef0: 7369 6c65 6e74 223a 2073 696c 656e 742c  silent": silent,
-00012f00: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-00012f10: 2020 2069 6620 7379 6e63 2069 7320 6e6f     if sync is no
-00012f20: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00012f30: 2020 2020 7061 7261 6d73 5b22 7761 6974      params["wait
-00012f40: 466f 7253 796e 6322 5d20 3d20 7379 6e63  ForSync"] = sync
-00012f50: 0a0a 2020 2020 2020 2020 2320 4e65 7720  ..        # New 
-00012f60: 696e 2041 7261 6e67 6f44 4220 332e 392e  in ArangoDB 3.9.
-00012f70: 3620 616e 6420 332e 3130 2e32 0a20 2020  6 and 3.10.2.   
-00012f80: 2020 2020 2069 6620 7265 6669 6c6c 5f69       if refill_i
-00012f90: 6e64 6578 5f63 6163 6865 7320 6973 206e  ndex_caches is n
-00012fa0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-00012fb0: 2020 2020 2070 6172 616d 735b 2272 6566       params["ref
-00012fc0: 696c 6c49 6e64 6578 4361 6368 6573 225d  illIndexCaches"]
-00012fd0: 203d 2072 6566 696c 6c5f 696e 6465 785f   = refill_index_
-00012fe0: 6361 6368 6573 0a0a 2020 2020 2020 2020  caches..        
-00012ff0: 646f 6375 6d65 6e74 7320 3d20 5b73 656c  documents = [sel
-00013000: 662e 5f65 6e73 7572 655f 6b65 795f 696e  f._ensure_key_in
-00013010: 5f62 6f64 7928 646f 6329 2066 6f72 2064  _body(doc) for d
-00013020: 6f63 2069 6e20 646f 6375 6d65 6e74 735d  oc in documents]
-00013030: 0a0a 2020 2020 2020 2020 7265 7175 6573  ..        reques
-00013040: 7420 3d20 5265 7175 6573 7428 0a20 2020  t = Request(.   
-00013050: 2020 2020 2020 2020 206d 6574 686f 643d           method=
-00013060: 2270 7574 222c 0a20 2020 2020 2020 2020  "put",.         
-00013070: 2020 2065 6e64 706f 696e 743d 6622 2f5f     endpoint=f"/_
-00013080: 6170 692f 646f 6375 6d65 6e74 2f7b 7365  api/document/{se
-00013090: 6c66 2e6e 616d 657d 222c 0a20 2020 2020  lf.name}",.     
-000130a0: 2020 2020 2020 2070 6172 616d 733d 7061         params=pa
-000130b0: 7261 6d73 2c0a 2020 2020 2020 2020 2020  rams,.          
-000130c0: 2020 6461 7461 3d64 6f63 756d 656e 7473    data=documents
-000130d0: 2c0a 2020 2020 2020 2020 2020 2020 7772  ,.            wr
-000130e0: 6974 653d 7365 6c66 2e6e 616d 652c 0a20  ite=self.name,. 
-000130f0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00013100: 2020 6465 6620 7265 7370 6f6e 7365 5f68    def response_h
-00013110: 616e 646c 6572 280a 2020 2020 2020 2020  andler(.        
-00013120: 2020 2020 7265 7370 3a20 5265 7370 6f6e      resp: Respon
-00013130: 7365 2c0a 2020 2020 2020 2020 2920 2d3e  se,.        ) ->
-00013140: 2055 6e69 6f6e 5b62 6f6f 6c2c 204c 6973   Union[bool, Lis
-00013150: 745b 556e 696f 6e5b 4a73 6f6e 2c20 4172  t[Union[Json, Ar
-00013160: 616e 676f 5365 7276 6572 4572 726f 725d  angoServerError]
-00013170: 5d5d 3a0a 2020 2020 2020 2020 2020 2020  ]]:.            
-00013180: 6966 206e 6f74 2072 6573 702e 6973 5f73  if not resp.is_s
-00013190: 7563 6365 7373 3a0a 2020 2020 2020 2020  uccess:.        
-000131a0: 2020 2020 2020 2020 7261 6973 6520 446f          raise Do
-000131b0: 6375 6d65 6e74 5265 706c 6163 6545 7272  cumentReplaceErr
-000131c0: 6f72 2872 6573 702c 2072 6571 7565 7374  or(resp, request
-000131d0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-000131e0: 2073 696c 656e 7420 6973 2054 7275 653a   silent is True:
-000131f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013200: 2072 6574 7572 6e20 5472 7565 0a0a 2020   return True..  
-00013210: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-00013220: 733a 204c 6973 745b 556e 696f 6e5b 4a73  s: List[Union[Js
-00013230: 6f6e 2c20 4172 616e 676f 5365 7276 6572  on, ArangoServer
-00013240: 4572 726f 725d 5d20 3d20 5b5d 0a20 2020  Error]] = [].   
-00013250: 2020 2020 2020 2020 2066 6f72 2062 6f64           for bod
-00013260: 7920 696e 2072 6573 702e 626f 6479 3a0a  y in resp.body:.
-00013270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013280: 6966 2022 5f69 6422 2069 6e20 626f 6479  if "_id" in body
-00013290: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000132a0: 2020 2020 2020 626f 6479 5b22 5f6f 6c64        body["_old
-000132b0: 5f72 6576 225d 203d 2062 6f64 792e 706f  _rev"] = body.po
-000132c0: 7028 225f 6f6c 6452 6576 2229 0a20 2020  p("_oldRev").   
-000132d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000132e0: 2072 6573 756c 7473 2e61 7070 656e 6428   results.append(
-000132f0: 626f 6479 290a 2020 2020 2020 2020 2020  body).          
-00013300: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00013310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013320: 7375 625f 7265 7370 203d 2073 656c 662e  sub_resp = self.
-00013330: 5f63 6f6e 6e2e 7072 6570 5f62 756c 6b5f  _conn.prep_bulk_
-00013340: 6572 725f 7265 7370 6f6e 7365 2872 6573  err_response(res
-00013350: 702c 2062 6f64 7929 0a0a 2020 2020 2020  p, body)..      
-00013360: 2020 2020 2020 2020 2020 2020 2020 6572                er
-00013370: 726f 723a 2041 7261 6e67 6f53 6572 7665  ror: ArangoServe
-00013380: 7245 7272 6f72 0a20 2020 2020 2020 2020  rError.         
-00013390: 2020 2020 2020 2020 2020 2069 6620 7375             if su
-000133a0: 625f 7265 7370 2e65 7272 6f72 5f63 6f64  b_resp.error_cod
-000133b0: 6520 3d3d 2031 3230 303a 0a20 2020 2020  e == 1200:.     
-000133c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000133d0: 2020 2065 7272 6f72 203d 2044 6f63 756d     error = Docum
-000133e0: 656e 7452 6576 6973 696f 6e45 7272 6f72  entRevisionError
-000133f0: 2873 7562 5f72 6573 702c 2072 6571 7565  (sub_resp, reque
-00013400: 7374 290a 2020 2020 2020 2020 2020 2020  st).            
-00013410: 2020 2020 2020 2020 656c 7365 3a20 2023          else:  #
-00013420: 2070 7261 676d 613a 206e 6f20 636f 7665   pragma: no cove
-00013430: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
-00013440: 2020 2020 2020 2020 2020 6572 726f 7220            error 
-00013450: 3d20 446f 6375 6d65 6e74 5265 706c 6163  = DocumentReplac
-00013460: 6545 7272 6f72 2873 7562 5f72 6573 702c  eError(sub_resp,
-00013470: 2072 6571 7565 7374 290a 0a20 2020 2020   request)..     
-00013480: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00013490: 6573 756c 7473 2e61 7070 656e 6428 6572  esults.append(er
-000134a0: 726f 7229 0a0a 2020 2020 2020 2020 2020  ror)..          
-000134b0: 2020 7265 7475 726e 2072 6573 756c 7473    return results
-000134c0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-000134d0: 2073 656c 662e 5f65 7865 6375 7465 2872   self._execute(r
-000134e0: 6571 7565 7374 2c20 7265 7370 6f6e 7365  equest, response
-000134f0: 5f68 616e 646c 6572 290a 0a20 2020 2064  _handler)..    d
-00013500: 6566 2072 6570 6c61 6365 5f6d 6174 6368  ef replace_match
-00013510: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-00013520: 2020 2020 2020 2020 6669 6c74 6572 733a          filters:
-00013530: 204a 736f 6e2c 0a20 2020 2020 2020 2062   Json,.        b
-00013540: 6f64 793a 204a 736f 6e2c 0a20 2020 2020  ody: Json,.     
-00013550: 2020 206c 696d 6974 3a20 4f70 7469 6f6e     limit: Option
-00013560: 616c 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a  al[int] = None,.
-00013570: 2020 2020 2020 2020 7379 6e63 3a20 4f70          sync: Op
-00013580: 7469 6f6e 616c 5b62 6f6f 6c5d 203d 204e  tional[bool] = N
-00013590: 6f6e 652c 0a20 2020 2020 2020 2061 6c6c  one,.        all
-000135a0: 6f77 5f64 6972 7479 5f72 6561 643a 2062  ow_dirty_read: b
-000135b0: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
-000135c0: 2029 202d 3e20 5265 7375 6c74 5b69 6e74   ) -> Result[int
-000135d0: 5d3a 0a20 2020 2020 2020 2022 2222 5265  ]:.        """Re
-000135e0: 706c 6163 6520 6d61 7463 6869 6e67 2064  place matching d
-000135f0: 6f63 756d 656e 7473 2e0a 0a20 2020 2020  ocuments...     
-00013600: 2020 202e 2e20 6e6f 7465 3a3a 0a0a 2020     .. note::..  
-00013610: 2020 2020 2020 2020 2020 496e 2065 6467            In edg
-00013620: 652f 7665 7274 6578 2063 6f6c 6c65 6374  e/vertex collect
-00013630: 696f 6e73 2c20 7468 6973 206d 6574 686f  ions, this metho
-00013640: 6420 646f 6573 204e 4f54 2070 726f 7669  d does NOT provi
-00013650: 6465 2074 6865 0a20 2020 2020 2020 2020  de the.         
-00013660: 2020 2074 7261 6e73 6163 7469 6f6e 616c     transactional
-00013670: 2067 7561 7261 6e74 6565 7320 616e 6420   guarantees and 
-00013680: 7661 6c69 6461 7469 6f6e 7320 7468 6174  validations that
-00013690: 2073 696e 676c 6520 7265 706c 6163 650a   single replace.
-000136a0: 2020 2020 2020 2020 2020 2020 6f70 6572              oper
-000136b0: 6174 696f 6e20 646f 6573 2066 6f72 2067  ation does for g
-000136c0: 7261 7068 732e 2049 6620 7468 6573 6520  raphs. If these 
-000136d0: 7072 6f70 6572 7469 6573 2061 7265 2072  properties are r
-000136e0: 6571 7569 7265 642c 2073 6565 0a20 2020  equired, see.   
-000136f0: 2020 2020 2020 2020 203a 6675 6e63 3a60           :func:`
-00013700: 6172 616e 676f 2e64 6174 6162 6173 652e  arango.database.
-00013710: 5374 616e 6461 7264 4461 7461 6261 7365  StandardDatabase
-00013720: 2e62 6567 696e 5f62 6174 6368 5f65 7865  .begin_batch_exe
-00013730: 6375 7469 6f6e 600a 2020 2020 2020 2020  cution`.        
-00013740: 2020 2020 666f 7220 616e 2061 6c74 6572      for an alter
-00013750: 6e61 7469 7665 2061 7070 726f 6163 682e  native approach.
-00013760: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00013770: 2066 696c 7465 7273 3a20 446f 6375 6d65   filters: Docume
-00013780: 6e74 2066 696c 7465 7273 2e0a 2020 2020  nt filters..    
-00013790: 2020 2020 3a74 7970 6520 6669 6c74 6572      :type filter
-000137a0: 733a 2064 6963 740a 2020 2020 2020 2020  s: dict.        
-000137b0: 3a70 6172 616d 2062 6f64 793a 204e 6577  :param body: New
-000137c0: 2064 6f63 756d 656e 7420 626f 6479 2e0a   document body..
-000137d0: 2020 2020 2020 2020 3a74 7970 6520 626f          :type bo
-000137e0: 6479 3a20 6469 6374 0a20 2020 2020 2020  dy: dict.       
-000137f0: 203a 7061 7261 6d20 6c69 6d69 743a 204d   :param limit: M
-00013800: 6178 206e 756d 6265 7220 6f66 2064 6f63  ax number of doc
-00013810: 756d 656e 7473 2074 6f20 7265 706c 6163  uments to replac
-00013820: 652e 2049 6620 7468 6520 6c69 6d69 7420  e. If the limit 
-00013830: 6973 206c 6f77 6572 0a20 2020 2020 2020  is lower.       
-00013840: 2020 2020 2074 6861 6e20 7468 6520 6e75       than the nu
-00013850: 6d62 6572 206f 6620 6d61 7463 6865 6420  mber of matched 
-00013860: 646f 6375 6d65 6e74 732c 2072 616e 646f  documents, rando
-00013870: 6d20 646f 6375 6d65 6e74 7320 6172 6520  m documents are 
-00013880: 6368 6f73 656e 2e0a 2020 2020 2020 2020  chosen..        
-00013890: 3a74 7970 6520 6c69 6d69 743a 2069 6e74  :type limit: int
-000138a0: 207c 204e 6f6e 650a 2020 2020 2020 2020   | None.        
-000138b0: 3a70 6172 616d 2073 796e 633a 2042 6c6f  :param sync: Blo
-000138c0: 636b 2075 6e74 696c 206f 7065 7261 7469  ck until operati
-000138d0: 6f6e 2069 7320 7379 6e63 6872 6f6e 697a  on is synchroniz
-000138e0: 6564 2074 6f20 6469 736b 2e0a 2020 2020  ed to disk..    
-000138f0: 2020 2020 3a74 7970 6520 7379 6e63 3a20      :type sync: 
-00013900: 626f 6f6c 207c 204e 6f6e 650a 2020 2020  bool | None.    
-00013910: 2020 2020 3a70 6172 616d 2061 6c6c 6f77      :param allow
-00013920: 5f64 6972 7479 5f72 6561 643a 2041 6c6c  _dirty_read: All
-00013930: 6f77 2072 6561 6473 2066 726f 6d20 666f  ow reads from fo
-00013940: 6c6c 6f77 6572 7320 696e 2061 2063 6c75  llowers in a clu
-00013950: 7374 6572 2e0a 2020 2020 2020 2020 3a74  ster..        :t
-00013960: 7970 6520 616c 6c6f 775f 6469 7274 795f  ype allow_dirty_
-00013970: 7265 6164 3a20 626f 6f6c 0a20 2020 2020  read: bool.     
-00013980: 2020 203a 7265 7475 726e 3a20 4e75 6d62     :return: Numb
-00013990: 6572 206f 6620 646f 6375 6d65 6e74 7320  er of documents 
-000139a0: 7265 706c 6163 6564 2e0a 2020 2020 2020  replaced..      
-000139b0: 2020 3a72 7479 7065 3a20 696e 740a 2020    :rtype: int.  
-000139c0: 2020 2020 2020 3a72 6169 7365 2061 7261        :raise ara
-000139d0: 6e67 6f2e 6578 6365 7074 696f 6e73 2e44  ngo.exceptions.D
-000139e0: 6f63 756d 656e 7452 6570 6c61 6365 4572  ocumentReplaceEr
-000139f0: 726f 723a 2049 6620 7265 706c 6163 6520  ror: If replace 
-00013a00: 6661 696c 732e 0a20 2020 2020 2020 2022  fails..        "
-00013a10: 2222 0a20 2020 2020 2020 2061 7373 6572  "".        asser
-00013a20: 7420 6973 696e 7374 616e 6365 2866 696c  t isinstance(fil
-00013a30: 7465 7273 2c20 6469 6374 292c 2022 6669  ters, dict), "fi
-00013a40: 6c74 6572 7320 6d75 7374 2062 6520 6120  lters must be a 
-00013a50: 6469 6374 220a 2020 2020 2020 2020 6173  dict".        as
-00013a60: 7365 7274 2069 735f 6e6f 6e65 5f6f 725f  sert is_none_or_
-00013a70: 696e 7428 6c69 6d69 7429 2c20 226c 696d  int(limit), "lim
-00013a80: 6974 206d 7573 7420 6265 2061 206e 6f6e  it must be a non
-00013a90: 2d6e 6567 6174 6976 6520 696e 7422 0a20  -negative int". 
-00013aa0: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-00013ab0: 5f6e 6f6e 655f 6f72 5f62 6f6f 6c28 7379  _none_or_bool(sy
-00013ac0: 6e63 292c 2022 7379 6e63 206d 7573 7420  nc), "sync must 
-00013ad0: 6265 204e 6f6e 6520 6f72 2061 2062 6f6f  be None or a boo
-00013ae0: 6c22 0a0a 2020 2020 2020 2020 2320 4966  l"..        # If
-00013af0: 2074 6865 2077 6169 7446 6f72 5379 6e63   the waitForSync
-00013b00: 2070 6172 616d 6574 6572 2069 7320 6e6f   parameter is no
-00013b10: 7420 7370 6563 6966 6965 6420 6f72 2073  t specified or s
-00013b20: 6574 2074 6f20 6661 6c73 652c 0a20 2020  et to false,.   
-00013b30: 2020 2020 2023 2074 6865 6e20 7468 6520       # then the 
-00013b40: 636f 6c6c 6563 7469 6f6e e280 9973 2064  collection...s d
-00013b50: 6566 6175 6c74 2077 6169 7446 6f72 5379  efault waitForSy
-00013b60: 6e63 2062 6568 6176 696f 7220 6973 2061  nc behavior is a
-00013b70: 7070 6c69 6564 2e0a 2020 2020 2020 2020  pplied..        
-00013b80: 7379 6e63 5f76 616c 203d 2066 2277 6169  sync_val = f"wai
-00013b90: 7446 6f72 5379 6e63 3a20 7b73 796e 637d  tForSync: {sync}
-00013ba0: 2220 6966 2073 796e 6320 6973 206e 6f74  " if sync is not
-00013bb0: 204e 6f6e 6520 656c 7365 2022 220a 0a20   None else "".. 
-00013bc0: 2020 2020 2020 2071 7565 7279 203d 2066         query = f
-00013bd0: 2222 220a 2020 2020 2020 2020 2020 2020  """.            
-00013be0: 464f 5220 646f 6320 494e 2040 4063 6f6c  FOR doc IN @@col
-00013bf0: 6c65 6374 696f 6e0a 2020 2020 2020 2020  lection.        
-00013c00: 2020 2020 2020 2020 7b62 7569 6c64 5f66          {build_f
-00013c10: 696c 7465 725f 636f 6e64 6974 696f 6e73  ilter_conditions
-00013c20: 2866 696c 7465 7273 297d 0a20 2020 2020  (filters)}.     
-00013c30: 2020 2020 2020 2020 2020 207b 6622 4c49             {f"LI
-00013c40: 4d49 5420 7b6c 696d 6974 7d22 2069 6620  MIT {limit}" if 
-00013c50: 6c69 6d69 7420 6973 206e 6f74 204e 6f6e  limit is not Non
-00013c60: 6520 656c 7365 2022 227d 0a20 2020 2020  e else ""}.     
-00013c70: 2020 2020 2020 2020 2020 2052 4550 4c41             REPLA
-00013c80: 4345 2064 6f63 2057 4954 4820 4062 6f64  CE doc WITH @bod
-00013c90: 7920 494e 2040 4063 6f6c 6c65 6374 696f  y IN @@collectio
-00013ca0: 6e0a 2020 2020 2020 2020 2020 2020 2020  n.              
-00013cb0: 2020 7b66 224f 5054 494f 4e53 207b 7b20    {f"OPTIONS {{ 
-00013cc0: 7b73 796e 635f 7661 6c7d 207d 7d22 2069  {sync_val} }}" i
-00013cd0: 6620 7379 6e63 5f76 616c 2065 6c73 6520  f sync_val else 
-00013ce0: 2222 7d0a 2020 2020 2020 2020 2222 220a  ""}.        """.
-00013cf0: 0a20 2020 2020 2020 2062 696e 645f 7661  .        bind_va
-00013d00: 7273 203d 207b 2240 636f 6c6c 6563 7469  rs = {"@collecti
-00013d10: 6f6e 223a 2073 656c 662e 6e61 6d65 2c20  on": self.name, 
-00013d20: 2262 6f64 7922 3a20 626f 6479 7d0a 0a20  "body": body}.. 
-00013d30: 2020 2020 2020 2072 6571 7565 7374 203d         request =
-00013d40: 2052 6571 7565 7374 280a 2020 2020 2020   Request(.      
-00013d50: 2020 2020 2020 6d65 7468 6f64 3d22 706f        method="po
-00013d60: 7374 222c 0a20 2020 2020 2020 2020 2020  st",.           
-00013d70: 2065 6e64 706f 696e 743d 222f 5f61 7069   endpoint="/_api
-00013d80: 2f63 7572 736f 7222 2c0a 2020 2020 2020  /cursor",.      
-00013d90: 2020 2020 2020 6461 7461 3d7b 2271 7565        data={"que
-00013da0: 7279 223a 2071 7565 7279 2c20 2262 696e  ry": query, "bin
-00013db0: 6456 6172 7322 3a20 6269 6e64 5f76 6172  dVars": bind_var
-00013dc0: 737d 2c0a 2020 2020 2020 2020 2020 2020  s},.            
-00013dd0: 7772 6974 653d 7365 6c66 2e6e 616d 652c  write=self.name,
-00013de0: 0a20 2020 2020 2020 2020 2020 2068 6561  .            hea
-00013df0: 6465 7273 3d7b 2278 2d61 7261 6e67 6f2d  ders={"x-arango-
-00013e00: 616c 6c6f 772d 6469 7274 792d 7265 6164  allow-dirty-read
-00013e10: 223a 2022 7472 7565 227d 2069 6620 616c  ": "true"} if al
-00013e20: 6c6f 775f 6469 7274 795f 7265 6164 2065  low_dirty_read e
-00013e30: 6c73 6520 4e6f 6e65 2c0a 2020 2020 2020  lse None,.      
-00013e40: 2020 290a 0a20 2020 2020 2020 2064 6566    )..        def
-00013e50: 2072 6573 706f 6e73 655f 6861 6e64 6c65   response_handle
-00013e60: 7228 7265 7370 3a20 5265 7370 6f6e 7365  r(resp: Response
-00013e70: 2920 2d3e 2069 6e74 3a0a 2020 2020 2020  ) -> int:.      
-00013e80: 2020 2020 2020 6966 2072 6573 702e 6973        if resp.is
-00013e90: 5f73 7563 6365 7373 3a0a 2020 2020 2020  _success:.      
-00013ea0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-00013eb0: 3a20 696e 7420 3d20 7265 7370 2e62 6f64  : int = resp.bod
-00013ec0: 795b 2265 7874 7261 225d 5b22 7374 6174  y["extra"]["stat
-00013ed0: 7322 5d5b 2277 7269 7465 7345 7865 6375  s"]["writesExecu
-00013ee0: 7465 6422 5d0a 2020 2020 2020 2020 2020  ted"].          
-00013ef0: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-00013f00: 756c 740a 2020 2020 2020 2020 2020 2020  ult.            
-00013f10: 7261 6973 6520 446f 6375 6d65 6e74 5265  raise DocumentRe
-00013f20: 706c 6163 6545 7272 6f72 2872 6573 702c  placeError(resp,
-00013f30: 2072 6571 7565 7374 290a 0a20 2020 2020   request)..     
-00013f40: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00013f50: 6578 6563 7574 6528 7265 7175 6573 742c  execute(request,
-00013f60: 2072 6573 706f 6e73 655f 6861 6e64 6c65   response_handle
-00013f70: 7229 0a0a 2020 2020 6465 6620 6465 6c65  r)..    def dele
-00013f80: 7465 5f6d 616e 7928 0a20 2020 2020 2020  te_many(.       
-00013f90: 2073 656c 662c 0a20 2020 2020 2020 2064   self,.        d
-00013fa0: 6f63 756d 656e 7473 3a20 5365 7175 656e  ocuments: Sequen
-00013fb0: 6365 5b4a 736f 6e5d 2c0a 2020 2020 2020  ce[Json],.      
-00013fc0: 2020 7265 7475 726e 5f6f 6c64 3a20 626f    return_old: bo
-00013fd0: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
-00013fe0: 2020 2020 6368 6563 6b5f 7265 763a 2062      check_rev: b
-00013ff0: 6f6f 6c20 3d20 5472 7565 2c0a 2020 2020  ool = True,.    
-00014000: 2020 2020 7379 6e63 3a20 4f70 7469 6f6e      sync: Option
-00014010: 616c 5b62 6f6f 6c5d 203d 204e 6f6e 652c  al[bool] = None,
-00014020: 0a20 2020 2020 2020 2073 696c 656e 743a  .        silent:
-00014030: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
-00014040: 2020 2020 2020 2072 6566 696c 6c5f 696e         refill_in
-00014050: 6465 785f 6361 6368 6573 3a20 4f70 7469  dex_caches: Opti
-00014060: 6f6e 616c 5b62 6f6f 6c5d 203d 204e 6f6e  onal[bool] = Non
-00014070: 652c 0a20 2020 2029 202d 3e20 5265 7375  e,.    ) -> Resu
-00014080: 6c74 5b55 6e69 6f6e 5b62 6f6f 6c2c 204c  lt[Union[bool, L
-00014090: 6973 745b 556e 696f 6e5b 4a73 6f6e 2c20  ist[Union[Json, 
-000140a0: 4172 616e 676f 5365 7276 6572 4572 726f  ArangoServerErro
-000140b0: 725d 5d5d 5d3a 0a20 2020 2020 2020 2022  r]]]]:.        "
-000140c0: 2222 4465 6c65 7465 206d 756c 7469 706c  ""Delete multipl
-000140d0: 6520 646f 6375 6d65 6e74 732e 0a0a 2020  e documents...  
-000140e0: 2020 2020 2020 2e2e 206e 6f74 653a 3a0a        .. note::.
-000140f0: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-00014100: 6465 6c65 7469 6e67 2061 2064 6f63 756d  deleting a docum
-00014110: 656e 7420 6661 696c 732c 2074 6865 2065  ent fails, the e
-00014120: 7863 6570 7469 6f6e 2069 7320 6e6f 7420  xception is not 
-00014130: 7261 6973 6564 2062 7574 0a20 2020 2020  raised but.     
-00014140: 2020 2020 2020 2072 6574 7572 6e65 6420         returned 
-00014150: 6173 2061 6e20 6f62 6a65 6374 2069 6e20  as an object in 
-00014160: 7468 6520 7265 7375 6c74 206c 6973 742e  the result list.
-00014170: 2049 7420 6973 2075 7020 746f 2079 6f75   It is up to you
-00014180: 2074 6f0a 2020 2020 2020 2020 2020 2020   to.            
-00014190: 696e 7370 6563 7420 7468 6520 6c69 7374  inspect the list
-000141a0: 2074 6f20 6465 7465 726d 696e 6520 7768   to determine wh
-000141b0: 6963 6820 646f 6375 6d65 6e74 7320 7765  ich documents we
-000141c0: 7265 2064 656c 6574 6564 0a20 2020 2020  re deleted.     
-000141d0: 2020 2020 2020 2073 7563 6365 7373 6675         successfu
-000141e0: 6c6c 7920 2872 6574 7572 6e73 2064 6f63  lly (returns doc
-000141f0: 756d 656e 7420 6d65 7461 6461 7461 2920  ument metadata) 
-00014200: 616e 6420 7768 6963 6820 7765 7265 206e  and which were n
-00014210: 6f74 0a20 2020 2020 2020 2020 2020 2028  ot.            (
-00014220: 7265 7475 726e 7320 6578 6365 7074 696f  returns exceptio
-00014230: 6e20 6f62 6a65 6374 292e 0a0a 2020 2020  n object)...    
-00014240: 2020 2020 2e2e 206e 6f74 653a 3a0a 0a20      .. note::.. 
-00014250: 2020 2020 2020 2020 2020 2049 6e20 6564             In ed
-00014260: 6765 2f76 6572 7465 7820 636f 6c6c 6563  ge/vertex collec
-00014270: 7469 6f6e 732c 2074 6869 7320 6d65 7468  tions, this meth
-00014280: 6f64 2064 6f65 7320 4e4f 5420 7072 6f76  od does NOT prov
-00014290: 6964 6520 7468 650a 2020 2020 2020 2020  ide the.        
-000142a0: 2020 2020 7472 616e 7361 6374 696f 6e61      transactiona
-000142b0: 6c20 6775 6172 616e 7465 6573 2061 6e64  l guarantees and
-000142c0: 2076 616c 6964 6174 696f 6e73 2074 6861   validations tha
-000142d0: 7420 7369 6e67 6c65 2064 656c 6574 650a  t single delete.
-000142e0: 2020 2020 2020 2020 2020 2020 6f70 6572              oper
-000142f0: 6174 696f 6e20 646f 6573 2066 6f72 2067  ation does for g
-00014300: 7261 7068 732e 2049 6620 7468 6573 6520  raphs. If these 
-00014310: 7072 6f70 6572 7469 6573 2061 7265 2072  properties are r
-00014320: 6571 7569 7265 642c 2073 6565 0a20 2020  equired, see.   
-00014330: 2020 2020 2020 2020 203a 6675 6e63 3a60           :func:`
-00014340: 6172 616e 676f 2e64 6174 6162 6173 652e  arango.database.
-00014350: 5374 616e 6461 7264 4461 7461 6261 7365  StandardDatabase
-00014360: 2e62 6567 696e 5f62 6174 6368 5f65 7865  .begin_batch_exe
-00014370: 6375 7469 6f6e 600a 2020 2020 2020 2020  cution`.        
-00014380: 2020 2020 666f 7220 616e 2061 6c74 6572      for an alter
-00014390: 6e61 7469 7665 2061 7070 726f 6163 682e  native approach.
-000143a0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-000143b0: 2064 6f63 756d 656e 7473 3a20 446f 6375   documents: Docu
-000143c0: 6d65 6e74 2049 4473 2c20 6b65 7973 206f  ment IDs, keys o
-000143d0: 7220 626f 6469 6573 2e20 446f 6375 6d65  r bodies. Docume
-000143e0: 6e74 2062 6f64 6965 7320 6d75 7374 0a20  nt bodies must. 
-000143f0: 2020 2020 2020 2020 2020 2063 6f6e 7461             conta
-00014400: 696e 2074 6865 2022 5f69 6422 206f 7220  in the "_id" or 
-00014410: 225f 6b65 7922 2066 6965 6c64 732e 0a20  "_key" fields.. 
-00014420: 2020 2020 2020 203a 7479 7065 2064 6f63         :type doc
-00014430: 756d 656e 7473 3a20 5b73 7472 207c 2064  uments: [str | d
-00014440: 6963 745d 0a20 2020 2020 2020 203a 7061  ict].        :pa
-00014450: 7261 6d20 7265 7475 726e 5f6f 6c64 3a20  ram return_old: 
-00014460: 496e 636c 7564 6520 626f 6469 6573 206f  Include bodies o
-00014470: 6620 7468 6520 6f6c 6420 646f 6375 6d65  f the old docume
-00014480: 6e74 7320 696e 2074 6865 2072 6573 756c  nts in the resul
-00014490: 742e 0a20 2020 2020 2020 203a 7479 7065  t..        :type
-000144a0: 2072 6574 7572 6e5f 6f6c 643a 2062 6f6f   return_old: boo
-000144b0: 6c0a 2020 2020 2020 2020 3a70 6172 616d  l.        :param
-000144c0: 2063 6865 636b 5f72 6576 3a20 4966 2073   check_rev: If s
-000144d0: 6574 2074 6f20 5472 7565 2c20 7265 7669  et to True, revi
-000144e0: 7369 6f6e 7320 6f66 202a 2a64 6f63 756d  sions of **docum
-000144f0: 656e 7473 2a2a 2028 6966 2067 6976 656e  ents** (if given
-00014500: 290a 2020 2020 2020 2020 2020 2020 6172  ).            ar
-00014510: 6520 636f 6d70 6172 6564 2061 6761 696e  e compared again
-00014520: 7374 2074 6865 2072 6576 6973 696f 6e73  st the revisions
-00014530: 206f 6620 7461 7267 6574 2064 6f63 756d   of target docum
-00014540: 656e 7473 2e0a 2020 2020 2020 2020 3a74  ents..        :t
-00014550: 7970 6520 6368 6563 6b5f 7265 763a 2062  ype check_rev: b
-00014560: 6f6f 6c0a 2020 2020 2020 2020 3a70 6172  ool.        :par
-00014570: 616d 2073 796e 633a 2042 6c6f 636b 2075  am sync: Block u
-00014580: 6e74 696c 206f 7065 7261 7469 6f6e 2069  ntil operation i
-00014590: 7320 7379 6e63 6872 6f6e 697a 6564 2074  s synchronized t
-000145a0: 6f20 6469 736b 2e0a 2020 2020 2020 2020  o disk..        
-000145b0: 3a74 7970 6520 7379 6e63 3a20 626f 6f6c  :type sync: bool
-000145c0: 207c 204e 6f6e 650a 2020 2020 2020 2020   | None.        
-000145d0: 3a70 6172 616d 2073 696c 656e 743a 2049  :param silent: I
-000145e0: 6620 7365 7420 746f 2054 7275 652c 206e  f set to True, n
-000145f0: 6f20 646f 6375 6d65 6e74 206d 6574 6164  o document metad
-00014600: 6174 6120 6973 2072 6574 7572 6e65 642e  ata is returned.
-00014610: 2054 6869 730a 2020 2020 2020 2020 2020   This.          
-00014620: 2020 6361 6e20 6265 2075 7365 6420 746f    can be used to
-00014630: 2073 6176 6520 7265 736f 7572 6365 732e   save resources.
-00014640: 0a20 2020 2020 2020 203a 7479 7065 2073  .        :type s
-00014650: 696c 656e 743a 2062 6f6f 6c0a 2020 2020  ilent: bool.    
-00014660: 2020 2020 3a70 6172 616d 2072 6566 696c      :param refil
-00014670: 6c5f 696e 6465 785f 6361 6368 6573 3a20  l_index_caches: 
-00014680: 5768 6574 6865 7220 746f 2061 6464 206e  Whether to add n
-00014690: 6577 2065 6e74 7269 6573 2074 6f20 696e  ew entries to in
-000146a0: 2d6d 656d 6f72 790a 2020 2020 2020 2020  -memory.        
-000146b0: 2020 2020 696e 6465 7820 6361 6368 6573      index caches
-000146c0: 2069 6620 646f 6375 6d65 6e74 206f 7065   if document ope
-000146d0: 7261 7469 6f6e 7320 6166 6665 6374 2074  rations affect t
-000146e0: 6865 2065 6467 6520 696e 6465 7820 6f72  he edge index or
-000146f0: 0a20 2020 2020 2020 2020 2020 2063 6163  .            cac
-00014700: 6865 2d65 6e61 626c 6564 2070 6572 7369  he-enabled persi
-00014710: 7374 656e 7420 696e 6465 7865 732e 0a20  stent indexes.. 
-00014720: 2020 2020 2020 203a 7479 7065 2072 6566         :type ref
-00014730: 696c 6c5f 696e 6465 785f 6361 6368 6573  ill_index_caches
-00014740: 3a20 626f 6f6c 207c 204e 6f6e 650a 2020  : bool | None.  
-00014750: 2020 2020 2020 3a72 6574 7572 6e3a 204c        :return: L
-00014760: 6973 7420 6f66 2064 6f63 756d 656e 7420  ist of document 
-00014770: 6d65 7461 6461 7461 2028 652e 672e 2064  metadata (e.g. d
-00014780: 6f63 756d 656e 7420 6b65 7973 2c20 7265  ocument keys, re
-00014790: 7669 7369 6f6e 7329 2061 6e64 0a20 2020  visions) and.   
-000147a0: 2020 2020 2020 2020 2061 6e79 2065 7863           any exc
-000147b0: 6570 7469 6f6e 732c 206f 7220 5472 7565  eptions, or True
-000147c0: 2069 6620 7061 7261 6d65 7465 7220 2a2a   if parameter **
-000147d0: 7369 6c65 6e74 2a2a 2077 6173 2073 6574  silent** was set
-000147e0: 2074 6f20 5472 7565 2e0a 2020 2020 2020   to True..      
-000147f0: 2020 3a72 7479 7065 3a20 5b64 6963 7420    :rtype: [dict 
-00014800: 7c20 4172 616e 676f 5365 7276 6572 4572  | ArangoServerEr
-00014810: 726f 725d 207c 2062 6f6f 6c0a 2020 2020  ror] | bool.    
-00014820: 2020 2020 3a72 6169 7365 2061 7261 6e67      :raise arang
-00014830: 6f2e 6578 6365 7074 696f 6e73 2e44 6f63  o.exceptions.Doc
-00014840: 756d 656e 7444 656c 6574 6545 7272 6f72  umentDeleteError
-00014850: 3a20 4966 2064 656c 6574 6520 6661 696c  : If delete fail
-00014860: 732e 0a20 2020 2020 2020 2022 2222 0a20  s..        """. 
-00014870: 2020 2020 2020 2070 6172 616d 733a 2050         params: P
-00014880: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
-00014890: 2020 2020 2020 2272 6574 7572 6e4f 6c64        "returnOld
-000148a0: 223a 2072 6574 7572 6e5f 6f6c 642c 0a20  ": return_old,. 
-000148b0: 2020 2020 2020 2020 2020 2022 6967 6e6f             "igno
-000148c0: 7265 5265 7673 223a 206e 6f74 2063 6865  reRevs": not che
-000148d0: 636b 5f72 6576 2c0a 2020 2020 2020 2020  ck_rev,.        
-000148e0: 2020 2020 226f 7665 7277 7269 7465 223a      "overwrite":
-000148f0: 206e 6f74 2063 6865 636b 5f72 6576 2c0a   not check_rev,.
-00014900: 2020 2020 2020 2020 2020 2020 2273 696c              "sil
-00014910: 656e 7422 3a20 7369 6c65 6e74 2c0a 2020  ent": silent,.  
-00014920: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-00014930: 6966 2073 796e 6320 6973 206e 6f74 204e  if sync is not N
-00014940: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00014950: 2070 6172 616d 735b 2277 6169 7446 6f72   params["waitFor
-00014960: 5379 6e63 225d 203d 2073 796e 630a 0a20  Sync"] = sync.. 
-00014970: 2020 2020 2020 2023 204e 6577 2069 6e20         # New in 
-00014980: 4172 616e 676f 4442 2033 2e39 2e36 2061  ArangoDB 3.9.6 a
-00014990: 6e64 2033 2e31 302e 320a 2020 2020 2020  nd 3.10.2.      
-000149a0: 2020 6966 2072 6566 696c 6c5f 696e 6465    if refill_inde
-000149b0: 785f 6361 6368 6573 2069 7320 6e6f 7420  x_caches is not 
-000149c0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-000149d0: 2020 7061 7261 6d73 5b22 7265 6669 6c6c    params["refill
-000149e0: 4361 6368 6573 225d 203d 2072 6566 696c  Caches"] = refil
-000149f0: 6c5f 696e 6465 785f 6361 6368 6573 0a0a  l_index_caches..
-00014a00: 2020 2020 2020 2020 646f 6375 6d65 6e74          document
-00014a10: 7320 3d20 5b0a 2020 2020 2020 2020 2020  s = [.          
-00014a20: 2020 7365 6c66 2e5f 656e 7375 7265 5f6b    self._ensure_k
-00014a30: 6579 5f69 6e5f 626f 6479 2864 6f63 2920  ey_in_body(doc) 
-00014a40: 6966 2069 7369 6e73 7461 6e63 6528 646f  if isinstance(do
-00014a50: 632c 2064 6963 7429 2065 6c73 6520 646f  c, dict) else do
-00014a60: 630a 2020 2020 2020 2020 2020 2020 666f  c.            fo
-00014a70: 7220 646f 6320 696e 2064 6f63 756d 656e  r doc in documen
-00014a80: 7473 0a20 2020 2020 2020 205d 0a0a 2020  ts.        ]..  
-00014a90: 2020 2020 2020 7265 7175 6573 7420 3d20        request = 
-00014aa0: 5265 7175 6573 7428 0a20 2020 2020 2020  Request(.       
-00014ab0: 2020 2020 206d 6574 686f 643d 2264 656c       method="del
-00014ac0: 6574 6522 2c0a 2020 2020 2020 2020 2020  ete",.          
-00014ad0: 2020 656e 6470 6f69 6e74 3d66 222f 5f61    endpoint=f"/_a
-00014ae0: 7069 2f64 6f63 756d 656e 742f 7b73 656c  pi/document/{sel
-00014af0: 662e 6e61 6d65 7d22 2c0a 2020 2020 2020  f.name}",.      
-00014b00: 2020 2020 2020 7061 7261 6d73 3d70 6172        params=par
-00014b10: 616d 732c 0a20 2020 2020 2020 2020 2020  ams,.           
-00014b20: 2064 6174 613d 646f 6375 6d65 6e74 732c   data=documents,
-00014b30: 0a20 2020 2020 2020 2020 2020 2077 7269  .            wri
-00014b40: 7465 3d73 656c 662e 6e61 6d65 2c0a 2020  te=self.name,.  
-00014b50: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00014b60: 2064 6566 2072 6573 706f 6e73 655f 6861   def response_ha
-00014b70: 6e64 6c65 7228 0a20 2020 2020 2020 2020  ndler(.         
-00014b80: 2020 2072 6573 703a 2052 6573 706f 6e73     resp: Respons
-00014b90: 652c 0a20 2020 2020 2020 2029 202d 3e20  e,.        ) -> 
-00014ba0: 556e 696f 6e5b 626f 6f6c 2c20 4c69 7374  Union[bool, List
-00014bb0: 5b55 6e69 6f6e 5b4a 736f 6e2c 2041 7261  [Union[Json, Ara
-00014bc0: 6e67 6f53 6572 7665 7245 7272 6f72 5d5d  ngoServerError]]
-00014bd0: 5d3a 0a20 2020 2020 2020 2020 2020 2069  ]:.            i
-00014be0: 6620 6e6f 7420 7265 7370 2e69 735f 7375  f not resp.is_su
-00014bf0: 6363 6573 733a 0a20 2020 2020 2020 2020  ccess:.         
-00014c00: 2020 2020 2020 2072 6169 7365 2044 6f63         raise Doc
-00014c10: 756d 656e 7444 656c 6574 6545 7272 6f72  umentDeleteError
-00014c20: 2872 6573 702c 2072 6571 7565 7374 290a  (resp, request).
-00014c30: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00014c40: 696c 656e 7420 6973 2054 7275 653a 0a20  ilent is True:. 
-00014c50: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00014c60: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
-00014c70: 2020 2020 2020 2020 7265 7375 6c74 733a          results:
-00014c80: 204c 6973 745b 556e 696f 6e5b 4a73 6f6e   List[Union[Json
-00014c90: 2c20 4172 616e 676f 5365 7276 6572 4572  , ArangoServerEr
-00014ca0: 726f 725d 5d20 3d20 5b5d 0a20 2020 2020  ror]] = [].     
-00014cb0: 2020 2020 2020 2066 6f72 2062 6f64 7920         for body 
-00014cc0: 696e 2072 6573 702e 626f 6479 3a0a 2020  in resp.body:.  
-00014cd0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00014ce0: 2022 5f69 6422 2069 6e20 626f 6479 3a0a   "_id" in body:.
-00014cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014d00: 2020 2020 7265 7375 6c74 732e 6170 7065      results.appe
-00014d10: 6e64 2862 6f64 7929 0a20 2020 2020 2020  nd(body).       
-00014d20: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00014d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014d40: 2020 2073 7562 5f72 6573 7020 3d20 7365     sub_resp = se
-00014d50: 6c66 2e5f 636f 6e6e 2e70 7265 705f 6275  lf._conn.prep_bu
-00014d60: 6c6b 5f65 7272 5f72 6573 706f 6e73 6528  lk_err_response(
-00014d70: 7265 7370 2c20 626f 6479 290a 0a20 2020  resp, body)..   
-00014d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014d90: 2065 7272 6f72 3a20 4172 616e 676f 5365   error: ArangoSe
-00014da0: 7276 6572 4572 726f 720a 2020 2020 2020  rverError.      
-00014db0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00014dc0: 2073 7562 5f72 6573 702e 6572 726f 725f   sub_resp.error_
-00014dd0: 636f 6465 203d 3d20 3132 3030 3a0a 2020  code == 1200:.  
-00014de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014df0: 2020 2020 2020 6572 726f 7220 3d20 446f        error = Do
-00014e00: 6375 6d65 6e74 5265 7669 7369 6f6e 4572  cumentRevisionEr
-00014e10: 726f 7228 7375 625f 7265 7370 2c20 7265  ror(sub_resp, re
-00014e20: 7175 6573 7429 0a20 2020 2020 2020 2020  quest).         
-00014e30: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00014e40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014e50: 2020 2020 2020 2020 2065 7272 6f72 203d           error =
-00014e60: 2044 6f63 756d 656e 7444 656c 6574 6545   DocumentDeleteE
-00014e70: 7272 6f72 2873 7562 5f72 6573 702c 2072  rror(sub_resp, r
-00014e80: 6571 7565 7374 290a 2020 2020 2020 2020  equest).        
-00014e90: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-00014ea0: 6c74 732e 6170 7065 6e64 2865 7272 6f72  lts.append(error
-00014eb0: 290a 0a20 2020 2020 2020 2020 2020 2072  )..            r
-00014ec0: 6574 7572 6e20 7265 7375 6c74 730a 0a20  eturn results.. 
-00014ed0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00014ee0: 6c66 2e5f 6578 6563 7574 6528 7265 7175  lf._execute(requ
-00014ef0: 6573 742c 2072 6573 706f 6e73 655f 6861  est, response_ha
-00014f00: 6e64 6c65 7229 0a0a 2020 2020 6465 6620  ndler)..    def 
-00014f10: 6465 6c65 7465 5f6d 6174 6368 280a 2020  delete_match(.  
-00014f20: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00014f30: 2020 2020 6669 6c74 6572 733a 204a 736f      filters: Jso
-00014f40: 6e2c 0a20 2020 2020 2020 206c 696d 6974  n,.        limit
-00014f50: 3a20 4f70 7469 6f6e 616c 5b69 6e74 5d20  : Optional[int] 
-00014f60: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00014f70: 7379 6e63 3a20 4f70 7469 6f6e 616c 5b62  sync: Optional[b
-00014f80: 6f6f 6c5d 203d 204e 6f6e 652c 0a20 2020  ool] = None,.   
-00014f90: 2020 2020 2061 6c6c 6f77 5f64 6972 7479       allow_dirty
-00014fa0: 5f72 6561 643a 2062 6f6f 6c20 3d20 4661  _read: bool = Fa
-00014fb0: 6c73 652c 0a20 2020 2029 202d 3e20 5265  lse,.    ) -> Re
-00014fc0: 7375 6c74 5b69 6e74 5d3a 0a20 2020 2020  sult[int]:.     
-00014fd0: 2020 2022 2222 4465 6c65 7465 206d 6174     """Delete mat
-00014fe0: 6368 696e 6720 646f 6375 6d65 6e74 732e  ching documents.
-00014ff0: 0a0a 2020 2020 2020 2020 2e2e 206e 6f74  ..        .. not
-00015000: 653a 3a0a 0a20 2020 2020 2020 2020 2020  e::..           
-00015010: 2049 6e20 6564 6765 2f76 6572 7465 7820   In edge/vertex 
-00015020: 636f 6c6c 6563 7469 6f6e 732c 2074 6869  collections, thi
-00015030: 7320 6d65 7468 6f64 2064 6f65 7320 4e4f  s method does NO
-00015040: 5420 7072 6f76 6964 6520 7468 650a 2020  T provide the.  
-00015050: 2020 2020 2020 2020 2020 7472 616e 7361            transa
-00015060: 6374 696f 6e61 6c20 6775 6172 616e 7465  ctional guarante
-00015070: 6573 2061 6e64 2076 616c 6964 6174 696f  es and validatio
-00015080: 6e73 2074 6861 7420 7369 6e67 6c65 2064  ns that single d
-00015090: 656c 6574 650a 2020 2020 2020 2020 2020  elete.          
-000150a0: 2020 6f70 6572 6174 696f 6e20 646f 6573    operation does
-000150b0: 2066 6f72 2067 7261 7068 732e 2049 6620   for graphs. If 
-000150c0: 7468 6573 6520 7072 6f70 6572 7469 6573  these properties
-000150d0: 2061 7265 2072 6571 7569 7265 642c 2073   are required, s
-000150e0: 6565 0a20 2020 2020 2020 2020 2020 203a  ee.            :
-000150f0: 6675 6e63 3a60 6172 616e 676f 2e64 6174  func:`arango.dat
-00015100: 6162 6173 652e 5374 616e 6461 7264 4461  abase.StandardDa
-00015110: 7461 6261 7365 2e62 6567 696e 5f62 6174  tabase.begin_bat
-00015120: 6368 5f65 7865 6375 7469 6f6e 600a 2020  ch_execution`.  
-00015130: 2020 2020 2020 2020 2020 666f 7220 616e            for an
-00015140: 2061 6c74 6572 6e61 7469 7665 2061 7070   alternative app
-00015150: 726f 6163 682e 0a0a 2020 2020 2020 2020  roach...        
-00015160: 3a70 6172 616d 2066 696c 7465 7273 3a20  :param filters: 
-00015170: 446f 6375 6d65 6e74 2066 696c 7465 7273  Document filters
-00015180: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
-00015190: 6669 6c74 6572 733a 2064 6963 740a 2020  filters: dict.  
-000151a0: 2020 2020 2020 3a70 6172 616d 206c 696d        :param lim
-000151b0: 6974 3a20 4d61 7820 6e75 6d62 6572 206f  it: Max number o
-000151c0: 6620 646f 6375 6d65 6e74 7320 746f 2064  f documents to d
-000151d0: 656c 6574 652e 2049 6620 7468 6520 6c69  elete. If the li
-000151e0: 6d69 7420 6973 206c 6f77 6572 0a20 2020  mit is lower.   
-000151f0: 2020 2020 2020 2020 2074 6861 6e20 7468           than th
-00015200: 6520 6e75 6d62 6572 206f 6620 6d61 7463  e number of matc
-00015210: 6865 6420 646f 6375 6d65 6e74 732c 2072  hed documents, r
-00015220: 616e 646f 6d20 646f 6375 6d65 6e74 7320  andom documents 
-00015230: 6172 6520 6368 6f73 656e 2e0a 2020 2020  are chosen..    
-00015240: 2020 2020 3a74 7970 6520 6c69 6d69 743a      :type limit:
-00015250: 2069 6e74 207c 204e 6f6e 650a 2020 2020   int | None.    
-00015260: 2020 2020 3a70 6172 616d 2073 796e 633a      :param sync:
-00015270: 2042 6c6f 636b 2075 6e74 696c 206f 7065   Block until ope
-00015280: 7261 7469 6f6e 2069 7320 7379 6e63 6872  ration is synchr
-00015290: 6f6e 697a 6564 2074 6f20 6469 736b 2e0a  onized to disk..
-000152a0: 2020 2020 2020 2020 3a74 7970 6520 7379          :type sy
-000152b0: 6e63 3a20 626f 6f6c 207c 204e 6f6e 650a  nc: bool | None.
-000152c0: 2020 2020 2020 2020 3a70 6172 616d 2061          :param a
-000152d0: 6c6c 6f77 5f64 6972 7479 5f72 6561 643a  llow_dirty_read:
-000152e0: 2041 6c6c 6f77 2072 6561 6473 2066 726f   Allow reads fro
-000152f0: 6d20 666f 6c6c 6f77 6572 7320 696e 2061  m followers in a
-00015300: 2063 6c75 7374 6572 2e0a 2020 2020 2020   cluster..      
-00015310: 2020 3a74 7970 6520 616c 6c6f 775f 6469    :type allow_di
-00015320: 7274 795f 7265 6164 3a20 626f 6f6c 0a20  rty_read: bool. 
-00015330: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
-00015340: 4e75 6d62 6572 206f 6620 646f 6375 6d65  Number of docume
-00015350: 6e74 7320 6465 6c65 7465 642e 0a20 2020  nts deleted..   
-00015360: 2020 2020 203a 7274 7970 653a 2069 6e74       :rtype: int
-00015370: 0a20 2020 2020 2020 203a 7261 6973 6520  .        :raise 
-00015380: 6172 616e 676f 2e65 7863 6570 7469 6f6e  arango.exception
-00015390: 732e 446f 6375 6d65 6e74 4465 6c65 7465  s.DocumentDelete
-000153a0: 4572 726f 723a 2049 6620 6465 6c65 7465  Error: If delete
-000153b0: 2066 6169 6c73 2e0a 2020 2020 2020 2020   fails..        
-000153c0: 2222 220a 2020 2020 2020 2020 6173 7365  """.        asse
-000153d0: 7274 2069 7369 6e73 7461 6e63 6528 6669  rt isinstance(fi
-000153e0: 6c74 6572 732c 2064 6963 7429 2c20 2266  lters, dict), "f
-000153f0: 696c 7465 7273 206d 7573 7420 6265 2061  ilters must be a
-00015400: 2064 6963 7422 0a20 2020 2020 2020 2061   dict".        a
-00015410: 7373 6572 7420 6973 5f6e 6f6e 655f 6f72  ssert is_none_or
-00015420: 5f69 6e74 286c 696d 6974 292c 2022 6c69  _int(limit), "li
-00015430: 6d69 7420 6d75 7374 2062 6520 6120 6e6f  mit must be a no
-00015440: 6e2d 6e65 6761 7469 7665 2069 6e74 220a  n-negative int".
-00015450: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-00015460: 735f 6e6f 6e65 5f6f 725f 626f 6f6c 2873  s_none_or_bool(s
-00015470: 796e 6329 2c20 2273 796e 6320 6d75 7374  ync), "sync must
-00015480: 2062 6520 4e6f 6e65 206f 7220 6120 626f   be None or a bo
-00015490: 6f6c 220a 0a20 2020 2020 2020 2023 2049  ol"..        # I
-000154a0: 6620 7468 6520 7761 6974 466f 7253 796e  f the waitForSyn
-000154b0: 6320 7061 7261 6d65 7465 7220 6973 206e  c parameter is n
-000154c0: 6f74 2073 7065 6369 6669 6564 206f 7220  ot specified or 
-000154d0: 7365 7420 746f 2066 616c 7365 2c0a 2020  set to false,.  
-000154e0: 2020 2020 2020 2320 7468 656e 2074 6865        # then the
-000154f0: 2063 6f6c 6c65 6374 696f 6ee2 8099 7320   collection...s 
-00015500: 6465 6661 756c 7420 7761 6974 466f 7253  default waitForS
-00015510: 796e 6320 6265 6861 7669 6f72 2069 7320  ync behavior is 
-00015520: 6170 706c 6965 642e 0a20 2020 2020 2020  applied..       
-00015530: 2073 796e 635f 7661 6c20 3d20 6622 7761   sync_val = f"wa
-00015540: 6974 466f 7253 796e 633a 207b 7379 6e63  itForSync: {sync
-00015550: 7d22 2069 6620 7379 6e63 2069 7320 6e6f  }" if sync is no
-00015560: 7420 4e6f 6e65 2065 6c73 6520 2222 0a0a  t None else ""..
-00015570: 2020 2020 2020 2020 7175 6572 7920 3d20          query = 
-00015580: 6622 2222 0a20 2020 2020 2020 2020 2020  f""".           
-00015590: 2046 4f52 2064 6f63 2049 4e20 4040 636f   FOR doc IN @@co
-000155a0: 6c6c 6563 7469 6f6e 0a20 2020 2020 2020  llection.       
-000155b0: 2020 2020 2020 2020 207b 6275 696c 645f           {build_
-000155c0: 6669 6c74 6572 5f63 6f6e 6469 7469 6f6e  filter_condition
-000155d0: 7328 6669 6c74 6572 7329 7d0a 2020 2020  s(filters)}.    
-000155e0: 2020 2020 2020 2020 2020 2020 7b66 224c              {f"L
-000155f0: 494d 4954 207b 6c69 6d69 747d 2220 6966  IMIT {limit}" if
-00015600: 206c 696d 6974 2069 7320 6e6f 7420 4e6f   limit is not No
-00015610: 6e65 2065 6c73 6520 2222 7d0a 2020 2020  ne else ""}.    
-00015620: 2020 2020 2020 2020 2020 2020 5245 4d4f              REMO
-00015630: 5645 2064 6f63 2049 4e20 4040 636f 6c6c  VE doc IN @@coll
-00015640: 6563 7469 6f6e 0a20 2020 2020 2020 2020  ection.         
-00015650: 2020 2020 2020 207b 6622 4f50 5449 4f4e         {f"OPTION
-00015660: 5320 7b7b 207b 7379 6e63 5f76 616c 7d20  S {{ {sync_val} 
-00015670: 7d7d 2220 6966 2073 796e 635f 7661 6c20  }}" if sync_val 
-00015680: 656c 7365 2022 227d 0a20 2020 2020 2020  else ""}.       
-00015690: 2022 2222 0a0a 2020 2020 2020 2020 6269   """..        bi
-000156a0: 6e64 5f76 6172 7320 3d20 7b22 4063 6f6c  nd_vars = {"@col
-000156b0: 6c65 6374 696f 6e22 3a20 7365 6c66 2e6e  lection": self.n
-000156c0: 616d 657d 0a0a 2020 2020 2020 2020 7265  ame}..        re
-000156d0: 7175 6573 7420 3d20 5265 7175 6573 7428  quest = Request(
-000156e0: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-000156f0: 686f 643d 2270 6f73 7422 2c0a 2020 2020  hod="post",.    
-00015700: 2020 2020 2020 2020 656e 6470 6f69 6e74          endpoint
-00015710: 3d22 2f5f 6170 692f 6375 7273 6f72 222c  ="/_api/cursor",
-00015720: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-00015730: 613d 7b22 7175 6572 7922 3a20 7175 6572  a={"query": quer
-00015740: 792c 2022 6269 6e64 5661 7273 223a 2062  y, "bindVars": b
-00015750: 696e 645f 7661 7273 7d2c 0a20 2020 2020  ind_vars},.     
-00015760: 2020 2020 2020 2077 7269 7465 3d73 656c         write=sel
-00015770: 662e 6e61 6d65 2c0a 2020 2020 2020 2020  f.name,.        
-00015780: 2020 2020 6865 6164 6572 733d 7b22 782d      headers={"x-
-00015790: 6172 616e 676f 2d61 6c6c 6f77 2d64 6972  arango-allow-dir
-000157a0: 7479 2d72 6561 6422 3a20 2274 7275 6522  ty-read": "true"
-000157b0: 7d20 6966 2061 6c6c 6f77 5f64 6972 7479  } if allow_dirty
-000157c0: 5f72 6561 6420 656c 7365 204e 6f6e 652c  _read else None,
-000157d0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-000157e0: 2020 2020 6465 6620 7265 7370 6f6e 7365      def response
-000157f0: 5f68 616e 646c 6572 2872 6573 703a 2052  _handler(resp: R
-00015800: 6573 706f 6e73 6529 202d 3e20 696e 743a  esponse) -> int:
-00015810: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00015820: 7265 7370 2e69 735f 7375 6363 6573 733a  resp.is_success:
-00015830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015840: 2072 6573 756c 743a 2069 6e74 203d 2072   result: int = r
-00015850: 6573 702e 626f 6479 5b22 6578 7472 6122  esp.body["extra"
-00015860: 5d5b 2273 7461 7473 225d 5b22 7772 6974  ]["stats"]["writ
-00015870: 6573 4578 6563 7574 6564 225d 0a20 2020  esExecuted"].   
-00015880: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-00015890: 7572 6e20 7265 7375 6c74 0a20 2020 2020  urn result.     
-000158a0: 2020 2020 2020 2072 6169 7365 2044 6f63         raise Doc
-000158b0: 756d 656e 7444 656c 6574 6545 7272 6f72  umentDeleteError
-000158c0: 2872 6573 702c 2072 6571 7565 7374 290a  (resp, request).
-000158d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000158e0: 7365 6c66 2e5f 6578 6563 7574 6528 7265  self._execute(re
-000158f0: 7175 6573 742c 2072 6573 706f 6e73 655f  quest, response_
-00015900: 6861 6e64 6c65 7229 0a0a 2020 2020 6465  handler)..    de
-00015910: 6620 696d 706f 7274 5f62 756c 6b28 0a20  f import_bulk(. 
-00015920: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00015930: 2020 2020 2064 6f63 756d 656e 7473 3a20       documents: 
-00015940: 5365 7175 656e 6365 5b4a 736f 6e5d 2c0a  Sequence[Json],.
-00015950: 2020 2020 2020 2020 6861 6c74 5f6f 6e5f          halt_on_
-00015960: 6572 726f 723a 2062 6f6f 6c20 3d20 5472  error: bool = Tr
-00015970: 7565 2c0a 2020 2020 2020 2020 6465 7461  ue,.        deta
-00015980: 696c 733a 2062 6f6f 6c20 3d20 5472 7565  ils: bool = True
-00015990: 2c0a 2020 2020 2020 2020 6672 6f6d 5f70  ,.        from_p
-000159a0: 7265 6669 783a 204f 7074 696f 6e61 6c5b  refix: Optional[
-000159b0: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
-000159c0: 2020 2020 2074 6f5f 7072 6566 6978 3a20       to_prefix: 
-000159d0: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
-000159e0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6f76  None,.        ov
-000159f0: 6572 7772 6974 653a 204f 7074 696f 6e61  erwrite: Optiona
-00015a00: 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65 2c0a  l[bool] = None,.
-00015a10: 2020 2020 2020 2020 6f6e 5f64 7570 6c69          on_dupli
-00015a20: 6361 7465 3a20 4f70 7469 6f6e 616c 5b73  cate: Optional[s
-00015a30: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
-00015a40: 2020 2020 7379 6e63 3a20 4f70 7469 6f6e      sync: Option
-00015a50: 616c 5b62 6f6f 6c5d 203d 204e 6f6e 652c  al[bool] = None,
-00015a60: 0a20 2020 2020 2020 2062 6174 6368 5f73  .        batch_s
-00015a70: 697a 653a 204f 7074 696f 6e61 6c5b 696e  ize: Optional[in
-00015a80: 745d 203d 204e 6f6e 652c 0a20 2020 2029  t] = None,.    )
-00015a90: 202d 3e20 556e 696f 6e5b 5265 7375 6c74   -> Union[Result
-00015aa0: 5b4a 736f 6e5d 2c20 4c69 7374 5b52 6573  [Json], List[Res
-00015ab0: 756c 745b 4a73 6f6e 5d5d 5d3a 0a20 2020  ult[Json]]]:.   
-00015ac0: 2020 2020 2022 2222 496e 7365 7274 206d       """Insert m
-00015ad0: 756c 7469 706c 6520 646f 6375 6d65 6e74  ultiple document
-00015ae0: 7320 696e 746f 2074 6865 2063 6f6c 6c65  s into the colle
-00015af0: 6374 696f 6e2e 0a0a 2020 2020 2020 2020  ction...        
-00015b00: 2e2e 206e 6f74 653a 3a0a 0a20 2020 2020  .. note::..     
-00015b10: 2020 2020 2020 2054 6869 7320 6d65 7468         This meth
-00015b20: 6f64 2069 7320 6661 7374 6572 2074 6861  od is faster tha
-00015b30: 6e20 3a66 756e 633a 6061 7261 6e67 6f2e  n :func:`arango.
-00015b40: 636f 6c6c 6563 7469 6f6e 2e43 6f6c 6c65  collection.Colle
-00015b50: 6374 696f 6e2e 696e 7365 7274 5f6d 616e  ction.insert_man
-00015b60: 7960 0a20 2020 2020 2020 2020 2020 2062  y`.            b
-00015b70: 7574 2064 6f65 7320 6e6f 7420 7265 7475  ut does not retu
-00015b80: 726e 2061 7320 6d61 6e79 2064 6574 6169  rn as many detai
-00015b90: 6c73 2e0a 0a20 2020 2020 2020 202e 2e20  ls...        .. 
-00015ba0: 6e6f 7465 3a3a 0a0a 2020 2020 2020 2020  note::..        
-00015bb0: 2020 2020 496e 2065 6467 652f 7665 7274      In edge/vert
-00015bc0: 6578 2063 6f6c 6c65 6374 696f 6e73 2c20  ex collections, 
-00015bd0: 7468 6973 206d 6574 686f 6420 646f 6573  this method does
-00015be0: 204e 4f54 2070 726f 7669 6465 2074 6865   NOT provide the
-00015bf0: 0a20 2020 2020 2020 2020 2020 2074 7261  .            tra
-00015c00: 6e73 6163 7469 6f6e 616c 2067 7561 7261  nsactional guara
-00015c10: 6e74 6565 7320 616e 6420 7661 6c69 6461  ntees and valida
-00015c20: 7469 6f6e 7320 7468 6174 2073 696e 676c  tions that singl
-00015c30: 6520 696e 7365 7274 0a20 2020 2020 2020  e insert.       
-00015c40: 2020 2020 206f 7065 7261 7469 6f6e 2064       operation d
-00015c50: 6f65 7320 666f 7220 6772 6170 6873 2e20  oes for graphs. 
-00015c60: 4966 2074 6865 7365 2070 726f 7065 7274  If these propert
-00015c70: 6965 7320 6172 6520 7265 7175 6972 6564  ies are required
-00015c80: 2c20 7365 650a 2020 2020 2020 2020 2020  , see.          
-00015c90: 2020 3a66 756e 633a 6061 7261 6e67 6f2e    :func:`arango.
-00015ca0: 6461 7461 6261 7365 2e53 7461 6e64 6172  database.Standar
-00015cb0: 6444 6174 6162 6173 652e 6265 6769 6e5f  dDatabase.begin_
-00015cc0: 6261 7463 685f 6578 6563 7574 696f 6e60  batch_execution`
-00015cd0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00015ce0: 2061 6e20 616c 7465 726e 6174 6976 6520   an alternative 
-00015cf0: 6170 7072 6f61 6368 2e0a 0a20 2020 2020  approach...     
-00015d00: 2020 203a 7061 7261 6d20 646f 6375 6d65     :param docume
-00015d10: 6e74 733a 204c 6973 7420 6f66 206e 6577  nts: List of new
-00015d20: 2064 6f63 756d 656e 7473 2074 6f20 696e   documents to in
-00015d30: 7365 7274 2e20 4966 2074 6865 7920 636f  sert. If they co
-00015d40: 6e74 6169 6e20 7468 650a 2020 2020 2020  ntain the.      
-00015d50: 2020 2020 2020 225f 6b65 7922 206f 7220        "_key" or 
-00015d60: 225f 6964 2220 6669 656c 6473 2c20 7468  "_id" fields, th
-00015d70: 6520 7661 6c75 6573 2061 7265 2075 7365  e values are use
-00015d80: 6420 6173 2074 6865 206b 6579 7320 6f66  d as the keys of
-00015d90: 2074 6865 206e 6577 0a20 2020 2020 2020   the new.       
-00015da0: 2020 2020 2064 6f63 756d 656e 7473 2028       documents (
-00015db0: 6175 746f 2d67 656e 6572 6174 6564 206f  auto-generated o
-00015dc0: 7468 6572 7769 7365 292e 2041 6e79 2022  therwise). Any "
-00015dd0: 5f72 6576 2220 6669 656c 6420 6973 2069  _rev" field is i
-00015de0: 676e 6f72 6564 2e0a 2020 2020 2020 2020  gnored..        
-00015df0: 3a74 7970 6520 646f 6375 6d65 6e74 733a  :type documents:
-00015e00: 205b 6469 6374 5d0a 2020 2020 2020 2020   [dict].        
-00015e10: 3a70 6172 616d 2068 616c 745f 6f6e 5f65  :param halt_on_e
-00015e20: 7272 6f72 3a20 4861 6c74 2074 6865 2065  rror: Halt the e
-00015e30: 6e74 6972 6520 696d 706f 7274 206f 6e20  ntire import on 
-00015e40: 616e 2065 7272 6f72 2e0a 2020 2020 2020  an error..      
-00015e50: 2020 3a74 7970 6520 6861 6c74 5f6f 6e5f    :type halt_on_
-00015e60: 6572 726f 723a 2062 6f6f 6c0a 2020 2020  error: bool.    
-00015e70: 2020 2020 3a70 6172 616d 2064 6574 6169      :param detai
-00015e80: 6c73 3a20 4966 2073 6574 2074 6f20 5472  ls: If set to Tr
-00015e90: 7565 2c20 7468 6520 7265 7475 726e 6564  ue, the returned
-00015ea0: 2072 6573 756c 7420 7769 6c6c 2069 6e63   result will inc
-00015eb0: 6c75 6465 2061 6e0a 2020 2020 2020 2020  lude an.        
-00015ec0: 2020 2020 6164 6469 7469 6f6e 616c 206c      additional l
-00015ed0: 6973 7420 6f66 2064 6574 6169 6c65 6420  ist of detailed 
-00015ee0: 6572 726f 7220 6d65 7373 6167 6573 2e0a  error messages..
-00015ef0: 2020 2020 2020 2020 3a74 7970 6520 6465          :type de
-00015f00: 7461 696c 733a 2062 6f6f 6c0a 2020 2020  tails: bool.    
-00015f10: 2020 2020 3a70 6172 616d 2066 726f 6d5f      :param from_
-00015f20: 7072 6566 6978 3a20 5374 7269 6e67 2070  prefix: String p
-00015f30: 7265 6669 7820 7072 6570 656e 6465 6420  refix prepended 
-00015f40: 746f 2074 6865 2076 616c 7565 206f 6620  to the value of 
-00015f50: 225f 6672 6f6d 220a 2020 2020 2020 2020  "_from".        
-00015f60: 2020 2020 6669 656c 6420 696e 2065 6163      field in eac
-00015f70: 6820 6564 6765 2064 6f63 756d 656e 7420  h edge document 
-00015f80: 696e 7365 7274 6564 2e20 466f 7220 6578  inserted. For ex
-00015f90: 616d 706c 652c 2070 7265 6669 7820 2266  ample, prefix "f
-00015fa0: 6f6f 220a 2020 2020 2020 2020 2020 2020  oo".            
-00015fb0: 7072 6570 656e 6465 6420 746f 2022 5f66  prepended to "_f
-00015fc0: 726f 6d22 3a20 2262 6172 2220 7769 6c6c  rom": "bar" will
-00015fd0: 2072 6573 756c 7420 696e 2022 5f66 726f   result in "_fro
-00015fe0: 6d22 3a20 2266 6f6f 2f62 6172 222e 0a20  m": "foo/bar".. 
-00015ff0: 2020 2020 2020 2020 2020 2041 7070 6c69             Appli
-00016000: 6573 206f 6e6c 7920 746f 2065 6467 6520  es only to edge 
-00016010: 636f 6c6c 6563 7469 6f6e 732e 0a20 2020  collections..   
-00016020: 2020 2020 203a 7479 7065 2066 726f 6d5f       :type from_
-00016030: 7072 6566 6978 3a20 7374 720a 2020 2020  prefix: str.    
-00016040: 2020 2020 3a70 6172 616d 2074 6f5f 7072      :param to_pr
-00016050: 6566 6978 3a20 5374 7269 6e67 2070 7265  efix: String pre
-00016060: 6669 7820 7072 6570 656e 6465 6420 746f  fix prepended to
-00016070: 2074 6865 2076 616c 7565 206f 6620 225f   the value of "_
-00016080: 746f 2220 6669 656c 640a 2020 2020 2020  to" field.      
-00016090: 2020 2020 2020 696e 2065 6467 6520 646f        in edge do
-000160a0: 6375 6d65 6e74 2069 6e73 6572 7465 642e  cument inserted.
-000160b0: 2046 6f72 2065 7861 6d70 6c65 2c20 7072   For example, pr
-000160c0: 6566 6978 2022 666f 6f22 2070 7265 7065  efix "foo" prepe
-000160d0: 6e64 6564 2074 6f0a 2020 2020 2020 2020  nded to.        
-000160e0: 2020 2020 225f 746f 223a 2022 6261 7222      "_to": "bar"
-000160f0: 2077 696c 6c20 7265 7375 6c74 2069 6e20   will result in 
-00016100: 225f 746f 223a 2022 666f 6f2f 6261 7222  "_to": "foo/bar"
-00016110: 2e20 4170 706c 6965 7320 6f6e 6c79 2074  . Applies only t
-00016120: 6f20 6564 6765 0a20 2020 2020 2020 2020  o edge.         
-00016130: 2020 2063 6f6c 6c65 6374 696f 6e73 2e0a     collections..
-00016140: 2020 2020 2020 2020 3a74 7970 6520 746f          :type to
-00016150: 5f70 7265 6669 783a 2073 7472 0a20 2020  _prefix: str.   
-00016160: 2020 2020 203a 7061 7261 6d20 6f76 6572       :param over
-00016170: 7772 6974 653a 2049 6620 7365 7420 746f  write: If set to
-00016180: 2054 7275 652c 2061 6c6c 2065 7869 7374   True, all exist
-00016190: 696e 6720 646f 6375 6d65 6e74 7320 6172  ing documents ar
-000161a0: 6520 7265 6d6f 7665 640a 2020 2020 2020  e removed.      
-000161b0: 2020 2020 2020 7072 696f 7220 746f 2074        prior to t
-000161c0: 6865 2069 6d70 6f72 742e 2049 6e64 6578  he import. Index
-000161d0: 6573 2061 7265 2073 7469 6c6c 2070 7265  es are still pre
-000161e0: 7365 7276 6564 2e0a 2020 2020 2020 2020  served..        
-000161f0: 3a74 7970 6520 6f76 6572 7772 6974 653a  :type overwrite:
-00016200: 2062 6f6f 6c0a 2020 2020 2020 2020 3a70   bool.        :p
-00016210: 6172 616d 206f 6e5f 6475 706c 6963 6174  aram on_duplicat
-00016220: 653a 2041 6374 696f 6e20 746f 2074 616b  e: Action to tak
-00016230: 6520 6f6e 2075 6e69 7175 6520 6b65 7920  e on unique key 
-00016240: 636f 6e73 7472 6169 6e74 2076 696f 6c61  constraint viola
-00016250: 7469 6f6e 730a 2020 2020 2020 2020 2020  tions.          
-00016260: 2020 2866 6f72 2064 6f63 756d 656e 7473    (for documents
-00016270: 2077 6974 6820 225f 6b65 7922 2066 6965   with "_key" fie
-00016280: 6c64 7329 2e20 416c 6c6f 7765 6420 7661  lds). Allowed va
-00016290: 6c75 6573 2061 7265 2022 6572 726f 7222  lues are "error"
-000162a0: 2028 646f 0a20 2020 2020 2020 2020 2020   (do.           
-000162b0: 206e 6f74 2069 6d70 6f72 7420 7468 6520   not import the 
-000162c0: 6e65 7720 646f 6375 6d65 6e74 7320 616e  new documents an
-000162d0: 6420 636f 756e 7420 7468 656d 2061 7320  d count them as 
-000162e0: 6572 726f 7273 292c 2022 7570 6461 7465  errors), "update
-000162f0: 220a 2020 2020 2020 2020 2020 2020 2875  ".            (u
-00016300: 7064 6174 6520 7468 6520 6578 6973 7469  pdate the existi
-00016310: 6e67 2064 6f63 756d 656e 7473 2077 6869  ng documents whi
-00016320: 6c65 2070 7265 7365 7276 696e 6720 616e  le preserving an
-00016330: 7920 6669 656c 6473 206d 6973 7369 6e67  y fields missing
-00016340: 0a20 2020 2020 2020 2020 2020 2069 6e20  .            in 
-00016350: 7468 6520 6e65 7720 6f6e 6573 292c 2022  the new ones), "
-00016360: 7265 706c 6163 6522 2028 7265 706c 6163  replace" (replac
-00016370: 6520 7468 6520 6578 6973 7469 6e67 2064  e the existing d
-00016380: 6f63 756d 656e 7473 2077 6974 680a 2020  ocuments with.  
-00016390: 2020 2020 2020 2020 2020 6e65 7720 6f6e            new on
-000163a0: 6573 292c 2061 6e64 2020 2269 676e 6f72  es), and  "ignor
-000163b0: 6522 2028 646f 206e 6f74 2069 6d70 6f72  e" (do not impor
-000163c0: 7420 7468 6520 6e65 7720 646f 6375 6d65  t the new docume
-000163d0: 6e74 7320 616e 6420 636f 756e 740a 2020  nts and count.  
-000163e0: 2020 2020 2020 2020 2020 7468 656d 2061            them a
-000163f0: 7320 6967 6e6f 7265 642c 2061 7320 6f70  s ignored, as op
-00016400: 706f 7365 6420 746f 2063 6f75 6e74 696e  posed to countin
-00016410: 6720 7468 656d 2061 7320 6572 726f 7273  g them as errors
-00016420: 292e 204f 7074 696f 6e73 0a20 2020 2020  ). Options.     
-00016430: 2020 2020 2020 2022 7570 6461 7465 2220         "update" 
-00016440: 616e 6420 2272 6570 6c61 6365 2220 6d61  and "replace" ma
-00016450: 7920 6661 696c 206f 6e20 7365 636f 6e64  y fail on second
-00016460: 6172 7920 756e 6971 7565 206b 6579 2063  ary unique key c
-00016470: 6f6e 7374 7261 696e 740a 2020 2020 2020  onstraint.      
-00016480: 2020 2020 2020 7669 6f6c 6174 696f 6e73        violations
-00016490: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
-000164a0: 6f6e 5f64 7570 6c69 6361 7465 3a20 7374  on_duplicate: st
-000164b0: 720a 2020 2020 2020 2020 3a70 6172 616d  r.        :param
-000164c0: 2073 796e 633a 2042 6c6f 636b 2075 6e74   sync: Block unt
-000164d0: 696c 206f 7065 7261 7469 6f6e 2069 7320  il operation is 
-000164e0: 7379 6e63 6872 6f6e 697a 6564 2074 6f20  synchronized to 
-000164f0: 6469 736b 2e0a 2020 2020 2020 2020 3a74  disk..        :t
-00016500: 7970 6520 7379 6e63 3a20 626f 6f6c 207c  ype sync: bool |
-00016510: 204e 6f6e 650a 2020 2020 2020 2020 3a70   None.        :p
-00016520: 6172 616d 2062 6174 6368 5f73 697a 653a  aram batch_size:
-00016530: 2053 706c 6974 2075 7020 2a2a 646f 6375   Split up **docu
-00016540: 6d65 6e74 732a 2a20 696e 746f 2062 6174  ments** into bat
-00016550: 6368 6573 206f 6620 6d61 7820 6c65 6e67  ches of max leng
-00016560: 7468 0a20 2020 2020 2020 2020 2020 202a  th.            *
-00016570: 2a62 6174 6368 5f73 697a 652a 2a20 616e  *batch_size** an
-00016580: 6420 696d 706f 7274 2074 6865 6d20 696e  d import them in
-00016590: 2061 206c 6f6f 7020 6f6e 2074 6865 2063   a loop on the c
-000165a0: 6c69 656e 7420 7369 6465 2e20 4966 0a20  lient side. If. 
-000165b0: 2020 2020 2020 2020 2020 202a 2a62 6174             **bat
-000165c0: 6368 5f73 697a 652a 2a20 6973 2073 7065  ch_size** is spe
-000165d0: 6369 6669 6564 2c20 7468 6520 7265 7475  cified, the retu
-000165e0: 726e 2074 7970 6520 6f66 2074 6869 7320  rn type of this 
-000165f0: 6d65 7468 6f64 0a20 2020 2020 2020 2020  method.         
-00016600: 2020 2063 6861 6e67 6573 2066 726f 6d20     changes from 
-00016610: 6120 7265 7375 6c74 206f 626a 6563 7420  a result object 
-00016620: 746f 2061 206c 6973 7420 6f66 2072 6573  to a list of res
-00016630: 756c 7420 6f62 6a65 6374 732e 0a20 2020  ult objects..   
-00016640: 2020 2020 2020 2020 2049 4d50 4f52 5441           IMPORTA
-00016650: 4e54 204e 4f54 453a 2074 6869 7320 7061  NT NOTE: this pa
-00016660: 7261 6d65 7465 7220 6d61 7920 676f 2074  rameter may go t
-00016670: 6872 6f75 6768 2062 7265 616b 696e 6720  hrough breaking 
-00016680: 6368 616e 6765 730a 2020 2020 2020 2020  changes.        
-00016690: 2020 2020 696e 2074 6865 2066 7574 7572      in the futur
-000166a0: 6520 7768 6572 6520 7468 6520 7265 7475  e where the retu
-000166b0: 726e 2074 7970 6520 6d61 7920 6e6f 7420  rn type may not 
-000166c0: 6265 2061 206c 6973 7420 6f66 2072 6573  be a list of res
-000166d0: 756c 740a 2020 2020 2020 2020 2020 2020  ult.            
-000166e0: 6f62 6a65 6374 7320 616e 796d 6f72 652e  objects anymore.
-000166f0: 2055 7365 2069 7420 6174 2079 6f75 7220   Use it at your 
-00016700: 6f77 6e20 7269 736b 2c20 616e 6420 6176  own risk, and av
-00016710: 6f69 640a 2020 2020 2020 2020 2020 2020  oid.            
-00016720: 6465 7065 6e64 696e 6720 6f6e 2074 6865  depending on the
-00016730: 2072 6574 7572 6e20 7661 6c75 6520 6966   return value if
-00016740: 2070 6f73 7369 626c 652e 2043 616e 6e6f   possible. Canno
-00016750: 7420 6265 2075 7365 6420 7769 7468 0a20  t be used with. 
-00016760: 2020 2020 2020 2020 2020 2070 6172 616d             param
-00016770: 6574 6572 202a 2a6f 7665 7277 7269 7465  eter **overwrite
-00016780: 2a2a 2e0a 2020 2020 2020 2020 3a74 7970  **..        :typ
-00016790: 6520 6261 7463 685f 7369 7a65 3a20 696e  e batch_size: in
-000167a0: 740a 2020 2020 2020 2020 3a72 6574 7572  t.        :retur
-000167b0: 6e3a 2052 6573 756c 7420 6f66 2074 6865  n: Result of the
-000167c0: 2062 756c 6b20 696d 706f 7274 2e0a 2020   bulk import..  
-000167d0: 2020 2020 2020 3a72 7479 7065 3a20 6469        :rtype: di
-000167e0: 6374 207c 206c 6973 745b 6469 6374 5d0a  ct | list[dict].
-000167f0: 2020 2020 2020 2020 3a72 6169 7365 2061          :raise a
-00016800: 7261 6e67 6f2e 6578 6365 7074 696f 6e73  rango.exceptions
-00016810: 2e44 6f63 756d 656e 7449 6e73 6572 7445  .DocumentInsertE
-00016820: 7272 6f72 3a20 4966 2069 6d70 6f72 7420  rror: If import 
-00016830: 6661 696c 732e 0a20 2020 2020 2020 2022  fails..        "
-00016840: 2222 0a20 2020 2020 2020 2069 6620 6f76  "".        if ov
-00016850: 6572 7772 6974 6520 616e 6420 6261 7463  erwrite and batc
-00016860: 685f 7369 7a65 2069 7320 6e6f 7420 4e6f  h_size is not No
-00016870: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00016880: 6d73 6720 3d20 2243 616e 6e6f 7420 7573  msg = "Cannot us
-00016890: 6520 7061 7261 6d65 7465 7220 2762 6174  e parameter 'bat
-000168a0: 6368 5f73 697a 6527 2069 6620 276f 7665  ch_size' if 'ove
-000168b0: 7277 7269 7465 2720 6973 2073 6574 2074  rwrite' is set t
-000168c0: 6f20 5472 7565 220a 2020 2020 2020 2020  o True".        
-000168d0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-000168e0: 7272 6f72 286d 7367 290a 0a20 2020 2020  rror(msg)..     
-000168f0: 2020 2064 6f63 756d 656e 7473 203d 205b     documents = [
-00016900: 7365 6c66 2e5f 656e 7375 7265 5f6b 6579  self._ensure_key
-00016910: 5f66 726f 6d5f 6964 2864 6f63 2920 666f  _from_id(doc) fo
-00016920: 7220 646f 6320 696e 2064 6f63 756d 656e  r doc in documen
-00016930: 7473 5d0a 0a20 2020 2020 2020 2070 6172  ts]..        par
-00016940: 616d 733a 2050 6172 616d 7320 3d20 7b22  ams: Params = {"
-00016950: 7479 7065 223a 2022 6172 7261 7922 2c20  type": "array", 
-00016960: 2263 6f6c 6c65 6374 696f 6e22 3a20 7365  "collection": se
-00016970: 6c66 2e6e 616d 657d 0a20 2020 2020 2020  lf.name}.       
-00016980: 2069 6620 6861 6c74 5f6f 6e5f 6572 726f   if halt_on_erro
-00016990: 7220 6973 206e 6f74 204e 6f6e 653a 0a20  r is not None:. 
-000169a0: 2020 2020 2020 2020 2020 2070 6172 616d             param
-000169b0: 735b 2263 6f6d 706c 6574 6522 5d20 3d20  s["complete"] = 
-000169c0: 6861 6c74 5f6f 6e5f 6572 726f 720a 2020  halt_on_error.  
-000169d0: 2020 2020 2020 6966 2064 6574 6169 6c73        if details
-000169e0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-000169f0: 2020 2020 2020 2020 2020 7061 7261 6d73            params
-00016a00: 5b22 6465 7461 696c 7322 5d20 3d20 6465  ["details"] = de
-00016a10: 7461 696c 730a 2020 2020 2020 2020 6966  tails.        if
-00016a20: 2066 726f 6d5f 7072 6566 6978 2069 7320   from_prefix is 
-00016a30: 6e6f 7420 4e6f 6e65 3a20 2023 2070 7261  not None:  # pra
-00016a40: 676d 613a 206e 6f20 636f 7665 720a 2020  gma: no cover.  
-00016a50: 2020 2020 2020 2020 2020 7061 7261 6d73            params
-00016a60: 5b22 6672 6f6d 5072 6566 6978 225d 203d  ["fromPrefix"] =
-00016a70: 2066 726f 6d5f 7072 6566 6978 0a20 2020   from_prefix.   
-00016a80: 2020 2020 2069 6620 746f 5f70 7265 6669       if to_prefi
-00016a90: 7820 6973 206e 6f74 204e 6f6e 653a 2020  x is not None:  
-00016aa0: 2320 7072 6167 6d61 3a20 6e6f 2063 6f76  # pragma: no cov
-00016ab0: 6572 0a20 2020 2020 2020 2020 2020 2070  er.            p
-00016ac0: 6172 616d 735b 2274 6f50 7265 6669 7822  arams["toPrefix"
-00016ad0: 5d20 3d20 746f 5f70 7265 6669 780a 2020  ] = to_prefix.  
-00016ae0: 2020 2020 2020 6966 206f 7665 7277 7269        if overwri
-00016af0: 7465 2069 7320 6e6f 7420 4e6f 6e65 3a0a  te is not None:.
-00016b00: 2020 2020 2020 2020 2020 2020 7061 7261              para
-00016b10: 6d73 5b22 6f76 6572 7772 6974 6522 5d20  ms["overwrite"] 
-00016b20: 3d20 6f76 6572 7772 6974 650a 2020 2020  = overwrite.    
-00016b30: 2020 2020 6966 206f 6e5f 6475 706c 6963      if on_duplic
-00016b40: 6174 6520 6973 206e 6f74 204e 6f6e 653a  ate is not None:
-00016b50: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
-00016b60: 616d 735b 226f 6e44 7570 6c69 6361 7465  ams["onDuplicate
-00016b70: 225d 203d 206f 6e5f 6475 706c 6963 6174  "] = on_duplicat
-00016b80: 650a 2020 2020 2020 2020 6966 2073 796e  e.        if syn
-00016b90: 6320 6973 206e 6f74 204e 6f6e 653a 0a20  c is not None:. 
-00016ba0: 2020 2020 2020 2020 2020 2070 6172 616d             param
-00016bb0: 735b 2277 6169 7446 6f72 5379 6e63 225d  s["waitForSync"]
-00016bc0: 203d 2073 796e 630a 0a20 2020 2020 2020   = sync..       
-00016bd0: 2064 6566 2072 6573 706f 6e73 655f 6861   def response_ha
-00016be0: 6e64 6c65 7228 7265 7370 3a20 5265 7370  ndler(resp: Resp
-00016bf0: 6f6e 7365 2920 2d3e 204a 736f 6e3a 0a20  onse) -> Json:. 
-00016c00: 2020 2020 2020 2020 2020 2069 6620 7265             if re
-00016c10: 7370 2e69 735f 7375 6363 6573 733a 0a20  sp.is_success:. 
-00016c20: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00016c30: 6573 756c 743a 204a 736f 6e20 3d20 7265  esult: Json = re
-00016c40: 7370 2e62 6f64 790a 2020 2020 2020 2020  sp.body.        
-00016c50: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-00016c60: 6573 756c 740a 2020 2020 2020 2020 2020  esult.          
-00016c70: 2020 7261 6973 6520 446f 6375 6d65 6e74    raise Document
-00016c80: 496e 7365 7274 4572 726f 7228 7265 7370  InsertError(resp
-00016c90: 2c20 7265 7175 6573 7429 0a0a 2020 2020  , request)..    
-00016ca0: 2020 2020 6966 2062 6174 6368 5f73 697a      if batch_siz
-00016cb0: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
-00016cc0: 2020 2020 2020 2072 6571 7565 7374 203d         request =
-00016cd0: 2052 6571 7565 7374 280a 2020 2020 2020   Request(.      
-00016ce0: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
-00016cf0: 3d22 706f 7374 222c 0a20 2020 2020 2020  ="post",.       
-00016d00: 2020 2020 2020 2020 2065 6e64 706f 696e           endpoin
-00016d10: 743d 222f 5f61 7069 2f69 6d70 6f72 7422  t="/_api/import"
-00016d20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00016d30: 2020 6461 7461 3d64 6f63 756d 656e 7473    data=documents
-00016d40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00016d50: 2020 7061 7261 6d73 3d70 6172 616d 732c    params=params,
-00016d60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016d70: 2077 7269 7465 3d73 656c 662e 6e61 6d65   write=self.name
-00016d80: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-00016d90: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00016da0: 7572 6e20 7365 6c66 2e5f 6578 6563 7574  urn self._execut
-00016db0: 6528 7265 7175 6573 742c 2072 6573 706f  e(request, respo
-00016dc0: 6e73 655f 6861 6e64 6c65 7229 0a20 2020  nse_handler).   
-00016dd0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00016de0: 2020 2020 2020 2072 6573 756c 7473 203d         results =
-00016df0: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
-00016e00: 666f 7220 6261 7463 6820 696e 2067 6574  for batch in get
-00016e10: 5f62 6174 6368 6573 2864 6f63 756d 656e  _batches(documen
-00016e20: 7473 2c20 6261 7463 685f 7369 7a65 293a  ts, batch_size):
-00016e30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016e40: 2072 6571 7565 7374 203d 2052 6571 7565   request = Reque
-00016e50: 7374 280a 2020 2020 2020 2020 2020 2020  st(.            
-00016e60: 2020 2020 2020 2020 6d65 7468 6f64 3d22          method="
-00016e70: 706f 7374 222c 0a20 2020 2020 2020 2020  post",.         
-00016e80: 2020 2020 2020 2020 2020 2065 6e64 706f             endpo
-00016e90: 696e 743d 222f 5f61 7069 2f69 6d70 6f72  int="/_api/impor
-00016ea0: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
-00016eb0: 2020 2020 2020 2020 6461 7461 3d62 6174          data=bat
-00016ec0: 6368 2c0a 2020 2020 2020 2020 2020 2020  ch,.            
-00016ed0: 2020 2020 2020 2020 7061 7261 6d73 3d70          params=p
-00016ee0: 6172 616d 732c 0a20 2020 2020 2020 2020  arams,.         
-00016ef0: 2020 2020 2020 2020 2020 2077 7269 7465             write
-00016f00: 3d73 656c 662e 6e61 6d65 2c0a 2020 2020  =self.name,.    
-00016f10: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00016f20: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00016f30: 7375 6c74 732e 6170 7065 6e64 2873 656c  sults.append(sel
-00016f40: 662e 5f65 7865 6375 7465 2872 6571 7565  f._execute(reque
-00016f50: 7374 2c20 7265 7370 6f6e 7365 5f68 616e  st, response_han
-00016f60: 646c 6572 2929 0a0a 2020 2020 2020 2020  dler))..        
-00016f70: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
-00016f80: 7473 0a0a 0a63 6c61 7373 2053 7461 6e64  ts...class Stand
-00016f90: 6172 6443 6f6c 6c65 6374 696f 6e28 436f  ardCollection(Co
-00016fa0: 6c6c 6563 7469 6f6e 293a 0a20 2020 2022  llection):.    "
-00016fb0: 2222 5374 616e 6461 7264 2041 7261 6e67  ""Standard Arang
-00016fc0: 6f44 4220 636f 6c6c 6563 7469 6f6e 2041  oDB collection A
-00016fd0: 5049 2077 7261 7070 6572 2e22 2222 0a0a  PI wrapper."""..
-00016fe0: 2020 2020 6465 6620 5f5f 7265 7072 5f5f      def __repr__
-00016ff0: 2873 656c 6629 202d 3e20 7374 723a 0a20  (self) -> str:. 
-00017000: 2020 2020 2020 2072 6574 7572 6e20 6622         return f"
-00017010: 3c53 7461 6e64 6172 6443 6f6c 6c65 6374  <StandardCollect
-00017020: 696f 6e20 7b73 656c 662e 6e61 6d65 7d3e  ion {self.name}>
-00017030: 220a 0a20 2020 2064 6566 205f 5f67 6574  "..    def __get
-00017040: 6974 656d 5f5f 2873 656c 662c 206b 6579  item__(self, key
-00017050: 3a20 556e 696f 6e5b 7374 722c 204a 736f  : Union[str, Jso
-00017060: 6e5d 2920 2d3e 2052 6573 756c 745b 4f70  n]) -> Result[Op
-00017070: 7469 6f6e 616c 5b4a 736f 6e5d 5d3a 0a20  tional[Json]]:. 
-00017080: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00017090: 6c66 2e67 6574 286b 6579 290a 0a20 2020  lf.get(key)..   
-000170a0: 2064 6566 2067 6574 280a 2020 2020 2020   def get(.      
-000170b0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-000170c0: 646f 6375 6d65 6e74 3a20 556e 696f 6e5b  document: Union[
-000170d0: 7374 722c 204a 736f 6e5d 2c0a 2020 2020  str, Json],.    
-000170e0: 2020 2020 7265 763a 204f 7074 696f 6e61      rev: Optiona
-000170f0: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
-00017100: 2020 2020 2020 2063 6865 636b 5f72 6576         check_rev
-00017110: 3a20 626f 6f6c 203d 2054 7275 652c 0a20  : bool = True,. 
-00017120: 2020 2020 2020 2061 6c6c 6f77 5f64 6972         allow_dir
-00017130: 7479 5f72 6561 643a 2062 6f6f 6c20 3d20  ty_read: bool = 
-00017140: 4661 6c73 652c 0a20 2020 2029 202d 3e20  False,.    ) -> 
-00017150: 5265 7375 6c74 5b4f 7074 696f 6e61 6c5b  Result[Optional[
-00017160: 4a73 6f6e 5d5d 3a0a 2020 2020 2020 2020  Json]]:.        
-00017170: 2222 2252 6574 7572 6e20 6120 646f 6375  """Return a docu
-00017180: 6d65 6e74 2e0a 0a20 2020 2020 2020 203a  ment...        :
-00017190: 7061 7261 6d20 646f 6375 6d65 6e74 3a20  param document: 
-000171a0: 446f 6375 6d65 6e74 2049 442c 206b 6579  Document ID, key
-000171b0: 206f 7220 626f 6479 2e20 446f 6375 6d65   or body. Docume
-000171c0: 6e74 2062 6f64 7920 6d75 7374 2063 6f6e  nt body must con
-000171d0: 7461 696e 0a20 2020 2020 2020 2020 2020  tain.           
-000171e0: 2074 6865 2022 5f69 6422 206f 7220 225f   the "_id" or "_
-000171f0: 6b65 7922 2066 6965 6c64 2e0a 2020 2020  key" field..    
-00017200: 2020 2020 3a74 7970 6520 646f 6375 6d65      :type docume
-00017210: 6e74 3a20 7374 7220 7c20 6469 6374 0a20  nt: str | dict. 
-00017220: 2020 2020 2020 203a 7061 7261 6d20 7265         :param re
-00017230: 763a 2045 7870 6563 7465 6420 646f 6375  v: Expected docu
-00017240: 6d65 6e74 2072 6576 6973 696f 6e2e 204f  ment revision. O
-00017250: 7665 7272 6964 6573 2074 6865 2076 616c  verrides the val
-00017260: 7565 206f 6620 225f 7265 7622 0a20 2020  ue of "_rev".   
-00017270: 2020 2020 2020 2020 2066 6965 6c64 2069           field i
-00017280: 6e20 2a2a 646f 6375 6d65 6e74 2a2a 2069  n **document** i
-00017290: 6620 7072 6573 656e 742e 0a20 2020 2020  f present..     
-000172a0: 2020 203a 7479 7065 2072 6576 3a20 7374     :type rev: st
-000172b0: 7220 7c20 4e6f 6e65 0a20 2020 2020 2020  r | None.       
-000172c0: 203a 7061 7261 6d20 6368 6563 6b5f 7265   :param check_re
-000172d0: 763a 2049 6620 7365 7420 746f 2054 7275  v: If set to Tru
-000172e0: 652c 2072 6576 6973 696f 6e20 6f66 202a  e, revision of *
-000172f0: 2a64 6f63 756d 656e 742a 2a20 2869 6620  *document** (if 
-00017300: 6769 7665 6e29 0a20 2020 2020 2020 2020  given).         
-00017310: 2020 2069 7320 636f 6d70 6172 6564 2061     is compared a
-00017320: 6761 696e 7374 2074 6865 2072 6576 6973  gainst the revis
-00017330: 696f 6e20 6f66 2074 6172 6765 7420 646f  ion of target do
-00017340: 6375 6d65 6e74 2e0a 2020 2020 2020 2020  cument..        
-00017350: 3a74 7970 6520 6368 6563 6b5f 7265 763a  :type check_rev:
-00017360: 2062 6f6f 6c0a 2020 2020 2020 2020 3a70   bool.        :p
-00017370: 6172 616d 2061 6c6c 6f77 5f64 6972 7479  aram allow_dirty
-00017380: 5f72 6561 643a 2041 6c6c 6f77 2072 6561  _read: Allow rea
-00017390: 6473 2066 726f 6d20 666f 6c6c 6f77 6572  ds from follower
-000173a0: 7320 696e 2061 2063 6c75 7374 6572 2e0a  s in a cluster..
-000173b0: 2020 2020 2020 2020 3a74 7970 6520 616c          :type al
-000173c0: 6c6f 775f 6469 7274 795f 7265 6164 3a20  low_dirty_read: 
-000173d0: 626f 6f6c 0a20 2020 2020 2020 203a 7265  bool.        :re
-000173e0: 7475 726e 3a20 446f 6375 6d65 6e74 2c20  turn: Document, 
-000173f0: 6f72 204e 6f6e 6520 6966 206e 6f74 2066  or None if not f
-00017400: 6f75 6e64 2e0a 2020 2020 2020 2020 3a72  ound..        :r
-00017410: 7479 7065 3a20 6469 6374 207c 204e 6f6e  type: dict | Non
-00017420: 650a 2020 2020 2020 2020 3a72 6169 7365  e.        :raise
-00017430: 2061 7261 6e67 6f2e 6578 6365 7074 696f   arango.exceptio
-00017440: 6e73 2e44 6f63 756d 656e 7447 6574 4572  ns.DocumentGetEr
-00017450: 726f 723a 2049 6620 7265 7472 6965 7661  ror: If retrieva
-00017460: 6c20 6661 696c 732e 0a20 2020 2020 2020  l fails..       
-00017470: 203a 7261 6973 6520 6172 616e 676f 2e65   :raise arango.e
-00017480: 7863 6570 7469 6f6e 732e 446f 6375 6d65  xceptions.Docume
-00017490: 6e74 5265 7669 7369 6f6e 4572 726f 723a  ntRevisionError:
-000174a0: 2049 6620 7265 7669 7369 6f6e 7320 6d69   If revisions mi
-000174b0: 736d 6174 6368 2e0a 2020 2020 2020 2020  smatch..        
-000174c0: 2222 220a 2020 2020 2020 2020 6861 6e64  """.        hand
-000174d0: 6c65 2c20 626f 6479 2c20 6865 6164 6572  le, body, header
-000174e0: 7320 3d20 7365 6c66 2e5f 7072 6570 5f66  s = self._prep_f
-000174f0: 726f 6d5f 646f 6328 646f 6375 6d65 6e74  rom_doc(document
-00017500: 2c20 7265 762c 2063 6865 636b 5f72 6576  , rev, check_rev
-00017510: 290a 0a20 2020 2020 2020 2069 6620 616c  )..        if al
-00017520: 6c6f 775f 6469 7274 795f 7265 6164 3a0a  low_dirty_read:.
-00017530: 2020 2020 2020 2020 2020 2020 6865 6164              head
-00017540: 6572 735b 2278 2d61 7261 6e67 6f2d 616c  ers["x-arango-al
-00017550: 6c6f 772d 6469 7274 792d 7265 6164 225d  low-dirty-read"]
-00017560: 203d 2022 7472 7565 220a 0a20 2020 2020   = "true"..     
-00017570: 2020 2072 6571 7565 7374 203d 2052 6571     request = Req
-00017580: 7565 7374 280a 2020 2020 2020 2020 2020  uest(.          
-00017590: 2020 6d65 7468 6f64 3d22 6765 7422 2c0a    method="get",.
-000175a0: 2020 2020 2020 2020 2020 2020 656e 6470              endp
-000175b0: 6f69 6e74 3d66 222f 5f61 7069 2f64 6f63  oint=f"/_api/doc
-000175c0: 756d 656e 742f 7b68 616e 646c 657d 222c  ument/{handle}",
-000175d0: 0a20 2020 2020 2020 2020 2020 2068 6561  .            hea
-000175e0: 6465 7273 3d68 6561 6465 7273 2c0a 2020  ders=headers,.  
-000175f0: 2020 2020 2020 2020 2020 7265 6164 3d73            read=s
-00017600: 656c 662e 6e61 6d65 2c0a 2020 2020 2020  elf.name,.      
-00017610: 2020 290a 0a20 2020 2020 2020 2064 6566    )..        def
-00017620: 2072 6573 706f 6e73 655f 6861 6e64 6c65   response_handle
-00017630: 7228 7265 7370 3a20 5265 7370 6f6e 7365  r(resp: Response
-00017640: 2920 2d3e 204f 7074 696f 6e61 6c5b 4a73  ) -> Optional[Js
-00017650: 6f6e 5d3a 0a20 2020 2020 2020 2020 2020  on]:.           
-00017660: 2069 6620 7265 7370 2e65 7272 6f72 5f63   if resp.error_c
-00017670: 6f64 6520 3d3d 2031 3230 323a 0a20 2020  ode == 1202:.   
-00017680: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-00017690: 7572 6e20 4e6f 6e65 0a20 2020 2020 2020  urn None.       
-000176a0: 2020 2020 2069 6620 7265 7370 2e73 7461       if resp.sta
-000176b0: 7475 735f 636f 6465 203d 3d20 3431 323a  tus_code == 412:
-000176c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000176d0: 2072 6169 7365 2044 6f63 756d 656e 7452   raise DocumentR
-000176e0: 6576 6973 696f 6e45 7272 6f72 2872 6573  evisionError(res
-000176f0: 702c 2072 6571 7565 7374 290a 2020 2020  p, request).    
-00017700: 2020 2020 2020 2020 6966 206e 6f74 2072          if not r
-00017710: 6573 702e 6973 5f73 7563 6365 7373 3a0a  esp.is_success:.
-00017720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017730: 7261 6973 6520 446f 6375 6d65 6e74 4765  raise DocumentGe
-00017740: 7445 7272 6f72 2872 6573 702c 2072 6571  tError(resp, req
-00017750: 7565 7374 290a 0a20 2020 2020 2020 2020  uest)..         
-00017760: 2020 2072 6573 756c 743a 204a 736f 6e20     result: Json 
-00017770: 3d20 7265 7370 2e62 6f64 790a 2020 2020  = resp.body.    
-00017780: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-00017790: 6573 756c 740a 0a20 2020 2020 2020 2072  esult..        r
-000177a0: 6574 7572 6e20 7365 6c66 2e5f 6578 6563  eturn self._exec
-000177b0: 7574 6528 7265 7175 6573 742c 2072 6573  ute(request, res
-000177c0: 706f 6e73 655f 6861 6e64 6c65 7229 0a0a  ponse_handler)..
-000177d0: 2020 2020 6465 6620 696e 7365 7274 280a      def insert(.
-000177e0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-000177f0: 2020 2020 2020 646f 6375 6d65 6e74 3a20        document: 
-00017800: 4a73 6f6e 2c0a 2020 2020 2020 2020 7265  Json,.        re
-00017810: 7475 726e 5f6e 6577 3a20 626f 6f6c 203d  turn_new: bool =
-00017820: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
-00017830: 7379 6e63 3a20 4f70 7469 6f6e 616c 5b62  sync: Optional[b
-00017840: 6f6f 6c5d 203d 204e 6f6e 652c 0a20 2020  ool] = None,.   
-00017850: 2020 2020 2073 696c 656e 743a 2062 6f6f       silent: boo
-00017860: 6c20 3d20 4661 6c73 652c 0a20 2020 2020  l = False,.     
-00017870: 2020 206f 7665 7277 7269 7465 3a20 626f     overwrite: bo
-00017880: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
-00017890: 2020 2020 7265 7475 726e 5f6f 6c64 3a20      return_old: 
-000178a0: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
-000178b0: 2020 2020 2020 6f76 6572 7772 6974 655f        overwrite_
-000178c0: 6d6f 6465 3a20 4f70 7469 6f6e 616c 5b73  mode: Optional[s
-000178d0: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
-000178e0: 2020 2020 6b65 6570 5f6e 6f6e 653a 204f      keep_none: O
-000178f0: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
-00017900: 4e6f 6e65 2c0a 2020 2020 2020 2020 6d65  None,.        me
-00017910: 7267 653a 204f 7074 696f 6e61 6c5b 626f  rge: Optional[bo
-00017920: 6f6c 5d20 3d20 4e6f 6e65 2c0a 2020 2020  ol] = None,.    
-00017930: 2020 2020 7265 6669 6c6c 5f69 6e64 6578      refill_index
-00017940: 5f63 6163 6865 733a 204f 7074 696f 6e61  _caches: Optiona
-00017950: 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65 2c0a  l[bool] = None,.
-00017960: 2020 2020 2920 2d3e 2052 6573 756c 745b      ) -> Result[
-00017970: 556e 696f 6e5b 626f 6f6c 2c20 4a73 6f6e  Union[bool, Json
-00017980: 5d5d 3a0a 2020 2020 2020 2020 2222 2249  ]]:.        """I
-00017990: 6e73 6572 7420 6120 6e65 7720 646f 6375  nsert a new docu
-000179a0: 6d65 6e74 2e0a 0a20 2020 2020 2020 203a  ment...        :
-000179b0: 7061 7261 6d20 646f 6375 6d65 6e74 3a20  param document: 
-000179c0: 446f 6375 6d65 6e74 2074 6f20 696e 7365  Document to inse
-000179d0: 7274 2e20 4966 2069 7420 636f 6e74 6169  rt. If it contai
-000179e0: 6e73 2074 6865 2022 5f6b 6579 2220 6f72  ns the "_key" or
-000179f0: 2022 5f69 6422 0a20 2020 2020 2020 2020   "_id".         
-00017a00: 2020 2066 6965 6c64 2c20 7468 6520 7661     field, the va
-00017a10: 6c75 6520 6973 2075 7365 6420 6173 2074  lue is used as t
-00017a20: 6865 206b 6579 206f 6620 7468 6520 6e65  he key of the ne
-00017a30: 7720 646f 6375 6d65 6e74 2028 6f74 6865  w document (othe
-00017a40: 7277 6973 650a 2020 2020 2020 2020 2020  rwise.          
-00017a50: 2020 6974 2069 7320 6175 746f 2d67 656e    it is auto-gen
-00017a60: 6572 6174 6564 292e 2041 6e79 2022 5f72  erated). Any "_r
-00017a70: 6576 2220 6669 656c 6420 6973 2069 676e  ev" field is ign
-00017a80: 6f72 6564 2e0a 2020 2020 2020 2020 3a74  ored..        :t
-00017a90: 7970 6520 646f 6375 6d65 6e74 3a20 6469  ype document: di
-00017aa0: 6374 0a20 2020 2020 2020 203a 7061 7261  ct.        :para
-00017ab0: 6d20 7265 7475 726e 5f6e 6577 3a20 496e  m return_new: In
-00017ac0: 636c 7564 6520 626f 6479 206f 6620 7468  clude body of th
-00017ad0: 6520 6e65 7720 646f 6375 6d65 6e74 2069  e new document i
-00017ae0: 6e20 7468 6520 7265 7475 726e 6564 0a20  n the returned. 
-00017af0: 2020 2020 2020 2020 2020 206d 6574 6164             metad
-00017b00: 6174 612e 2049 676e 6f72 6564 2069 6620  ata. Ignored if 
-00017b10: 7061 7261 6d65 7465 7220 2a2a 7369 6c65  parameter **sile
-00017b20: 6e74 2a2a 2069 7320 7365 7420 746f 2054  nt** is set to T
-00017b30: 7275 652e 0a20 2020 2020 2020 203a 7479  rue..        :ty
-00017b40: 7065 2072 6574 7572 6e5f 6e65 773a 2062  pe return_new: b
-00017b50: 6f6f 6c0a 2020 2020 2020 2020 3a70 6172  ool.        :par
-00017b60: 616d 2073 796e 633a 2042 6c6f 636b 2075  am sync: Block u
-00017b70: 6e74 696c 206f 7065 7261 7469 6f6e 2069  ntil operation i
-00017b80: 7320 7379 6e63 6872 6f6e 697a 6564 2074  s synchronized t
-00017b90: 6f20 6469 736b 2e0a 2020 2020 2020 2020  o disk..        
-00017ba0: 3a74 7970 6520 7379 6e63 3a20 626f 6f6c  :type sync: bool
-00017bb0: 207c 204e 6f6e 650a 2020 2020 2020 2020   | None.        
-00017bc0: 3a70 6172 616d 2073 696c 656e 743a 2049  :param silent: I
-00017bd0: 6620 7365 7420 746f 2054 7275 652c 206e  f set to True, n
-00017be0: 6f20 646f 6375 6d65 6e74 206d 6574 6164  o document metad
-00017bf0: 6174 6120 6973 2072 6574 7572 6e65 642e  ata is returned.
-00017c00: 2054 6869 730a 2020 2020 2020 2020 2020   This.          
-00017c10: 2020 6361 6e20 6265 2075 7365 6420 746f    can be used to
-00017c20: 2073 6176 6520 7265 736f 7572 6365 732e   save resources.
-00017c30: 0a20 2020 2020 2020 203a 7479 7065 2073  .        :type s
-00017c40: 696c 656e 743a 2062 6f6f 6c0a 2020 2020  ilent: bool.    
-00017c50: 2020 2020 3a70 6172 616d 206f 7665 7277      :param overw
-00017c60: 7269 7465 3a20 4966 2073 6574 2074 6f20  rite: If set to 
-00017c70: 5472 7565 2c20 6f70 6572 6174 696f 6e20  True, operation 
-00017c80: 646f 6573 206e 6f74 2066 6169 6c20 6f6e  does not fail on
-00017c90: 2064 7570 6c69 6361 7465 0a20 2020 2020   duplicate.     
-00017ca0: 2020 2020 2020 206b 6579 2061 6e64 2065         key and e
-00017cb0: 7869 7374 696e 6720 646f 6375 6d65 6e74  xisting document
-00017cc0: 2069 7320 6f76 6572 7772 6974 7465 6e20   is overwritten 
-00017cd0: 2872 6570 6c61 6365 2d69 6e73 6572 7429  (replace-insert)
-00017ce0: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
-00017cf0: 6f76 6572 7772 6974 653a 2062 6f6f 6c0a  overwrite: bool.
-00017d00: 2020 2020 2020 2020 3a70 6172 616d 2072          :param r
-00017d10: 6574 7572 6e5f 6f6c 643a 2049 6e63 6c75  eturn_old: Inclu
-00017d20: 6465 2062 6f64 7920 6f66 2074 6865 206f  de body of the o
-00017d30: 6c64 2064 6f63 756d 656e 7420 6966 206f  ld document if o
-00017d40: 7665 7277 7269 7474 656e 2e0a 2020 2020  verwritten..    
-00017d50: 2020 2020 2020 2020 4967 6e6f 7265 6420          Ignored 
-00017d60: 6966 2070 6172 616d 6574 6572 202a 2a73  if parameter **s
-00017d70: 696c 656e 742a 2a20 6973 2073 6574 2074  ilent** is set t
-00017d80: 6f20 5472 7565 2e0a 2020 2020 2020 2020  o True..        
-00017d90: 3a74 7970 6520 7265 7475 726e 5f6f 6c64  :type return_old
-00017da0: 3a20 626f 6f6c 0a20 2020 2020 2020 203a  : bool.        :
-00017db0: 7061 7261 6d20 6f76 6572 7772 6974 655f  param overwrite_
-00017dc0: 6d6f 6465 3a20 4f76 6572 7772 6974 6520  mode: Overwrite 
-00017dd0: 6265 6861 7669 6f72 2075 7365 6420 7768  behavior used wh
-00017de0: 656e 2074 6865 2064 6f63 756d 656e 7420  en the document 
-00017df0: 6b65 790a 2020 2020 2020 2020 2020 2020  key.            
-00017e00: 6578 6973 7473 2061 6c72 6561 6479 2e20  exists already. 
-00017e10: 416c 6c6f 7765 6420 7661 6c75 6573 2061  Allowed values a
-00017e20: 7265 2022 7265 706c 6163 6522 2028 7265  re "replace" (re
-00017e30: 706c 6163 652d 696e 7365 7274 2920 6f72  place-insert) or
-00017e40: 0a20 2020 2020 2020 2020 2020 2022 7570  .            "up
-00017e50: 6461 7465 2220 2875 7064 6174 652d 696e  date" (update-in
-00017e60: 7365 7274 292e 2049 6d70 6c69 6369 746c  sert). Implicitl
-00017e70: 7920 7365 7473 2074 6865 2076 616c 7565  y sets the value
-00017e80: 206f 6620 7061 7261 6d65 7465 720a 2020   of parameter.  
-00017e90: 2020 2020 2020 2020 2020 2a2a 6f76 6572            **over
-00017ea0: 7772 6974 652a 2a2e 0a20 2020 2020 2020  write**..       
-00017eb0: 203a 7479 7065 206f 7665 7277 7269 7465   :type overwrite
-00017ec0: 5f6d 6f64 653a 2073 7472 207c 204e 6f6e  _mode: str | Non
-00017ed0: 650a 2020 2020 2020 2020 3a70 6172 616d  e.        :param
-00017ee0: 206b 6565 705f 6e6f 6e65 3a20 4966 2073   keep_none: If s
-00017ef0: 6574 2074 6f20 5472 7565 2c20 6669 656c  et to True, fiel
-00017f00: 6473 2077 6974 6820 7661 6c75 6520 4e6f  ds with value No
-00017f10: 6e65 2061 7265 2072 6574 6169 6e65 640a  ne are retained.
-00017f20: 2020 2020 2020 2020 2020 2020 696e 2074              in t
-00017f30: 6865 2064 6f63 756d 656e 742e 204f 7468  he document. Oth
-00017f40: 6572 7769 7365 2c20 7468 6579 2061 7265  erwise, they are
-00017f50: 2072 656d 6f76 6564 2063 6f6d 706c 6574   removed complet
-00017f60: 656c 792e 2041 7070 6c69 6573 0a20 2020  ely. Applies.   
-00017f70: 2020 2020 2020 2020 206f 6e6c 7920 7768           only wh
-00017f80: 656e 202a 2a6f 7665 7277 7269 7465 5f6d  en **overwrite_m
-00017f90: 6f64 652a 2a20 6973 2073 6574 2074 6f20  ode** is set to 
-00017fa0: 2275 7064 6174 6522 2028 7570 6461 7465  "update" (update
-00017fb0: 2d69 6e73 6572 7429 2e0a 2020 2020 2020  -insert)..      
-00017fc0: 2020 3a74 7970 6520 6b65 6570 5f6e 6f6e    :type keep_non
-00017fd0: 653a 2062 6f6f 6c20 7c20 4e6f 6e65 0a20  e: bool | None. 
-00017fe0: 2020 2020 2020 203a 7061 7261 6d20 6d65         :param me
-00017ff0: 7267 653a 2049 6620 7365 7420 746f 2054  rge: If set to T
-00018000: 7275 6520 2864 6566 6175 6c74 292c 2073  rue (default), s
-00018010: 7562 2d64 6963 7469 6f6e 6172 6965 7320  ub-dictionaries 
-00018020: 6172 6520 6d65 7267 6564 0a20 2020 2020  are merged.     
-00018030: 2020 2020 2020 2069 6e73 7465 6164 206f         instead o
-00018040: 6620 7468 6520 6e65 7720 6f6e 6520 6f76  f the new one ov
-00018050: 6572 7772 6974 696e 6720 7468 6520 6f6c  erwriting the ol
-00018060: 6420 6f6e 652e 2041 7070 6c69 6573 206f  d one. Applies o
-00018070: 6e6c 7920 7768 656e 0a20 2020 2020 2020  nly when.       
-00018080: 2020 2020 202a 2a6f 7665 7277 7269 7465       **overwrite
-00018090: 5f6d 6f64 652a 2a20 6973 2073 6574 2074  _mode** is set t
-000180a0: 6f20 2275 7064 6174 6522 2028 7570 6461  o "update" (upda
-000180b0: 7465 2d69 6e73 6572 7429 2e0a 2020 2020  te-insert)..    
-000180c0: 2020 2020 3a74 7970 6520 6d65 7267 653a      :type merge:
-000180d0: 2062 6f6f 6c20 7c20 4e6f 6e65 0a20 2020   bool | None.   
-000180e0: 2020 2020 203a 7061 7261 6d20 7265 6669       :param refi
-000180f0: 6c6c 5f69 6e64 6578 5f63 6163 6865 733a  ll_index_caches:
-00018100: 2057 6865 7468 6572 2074 6f20 6164 6420   Whether to add 
-00018110: 6e65 7720 656e 7472 6965 7320 746f 2069  new entries to i
-00018120: 6e2d 6d65 6d6f 7279 0a20 2020 2020 2020  n-memory.       
-00018130: 2020 2020 2069 6e64 6578 2063 6163 6865       index cache
-00018140: 7320 6966 2064 6f63 756d 656e 7420 696e  s if document in
-00018150: 7365 7274 696f 6e73 2061 6666 6563 7420  sertions affect 
-00018160: 7468 6520 6564 6765 2069 6e64 6578 206f  the edge index o
-00018170: 720a 2020 2020 2020 2020 2020 2020 6361  r.            ca
-00018180: 6368 652d 656e 6162 6c65 6420 7065 7273  che-enabled pers
-00018190: 6973 7465 6e74 2069 6e64 6578 6573 2e0a  istent indexes..
-000181a0: 2020 2020 2020 2020 3a74 7970 6520 7265          :type re
-000181b0: 6669 6c6c 5f69 6e64 6578 5f63 6163 6865  fill_index_cache
-000181c0: 733a 2062 6f6f 6c20 7c20 4e6f 6e65 0a20  s: bool | None. 
-000181d0: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
-000181e0: 446f 6375 6d65 6e74 206d 6574 6164 6174  Document metadat
-000181f0: 6120 2865 2e67 2e20 646f 6375 6d65 6e74  a (e.g. document
-00018200: 206b 6579 2c20 7265 7669 7369 6f6e 2920   key, revision) 
-00018210: 6f72 2054 7275 6520 6966 0a20 2020 2020  or True if.     
-00018220: 2020 2020 2020 2070 6172 616d 6574 6572         parameter
-00018230: 202a 2a73 696c 656e 742a 2a20 7761 7320   **silent** was 
-00018240: 7365 7420 746f 2054 7275 652e 0a20 2020  set to True..   
-00018250: 2020 2020 203a 7274 7970 653a 2062 6f6f       :rtype: boo
-00018260: 6c20 7c20 6469 6374 0a20 2020 2020 2020  l | dict.       
-00018270: 203a 7261 6973 6520 6172 616e 676f 2e65   :raise arango.e
-00018280: 7863 6570 7469 6f6e 732e 446f 6375 6d65  xceptions.Docume
-00018290: 6e74 496e 7365 7274 4572 726f 723a 2049  ntInsertError: I
-000182a0: 6620 696e 7365 7274 2066 6169 6c73 2e0a  f insert fails..
-000182b0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000182c0: 2020 2020 646f 6375 6d65 6e74 203d 2073      document = s
-000182d0: 656c 662e 5f65 6e73 7572 655f 6b65 795f  elf._ensure_key_
-000182e0: 6672 6f6d 5f69 6428 646f 6375 6d65 6e74  from_id(document
-000182f0: 290a 0a20 2020 2020 2020 2070 6172 616d  )..        param
-00018300: 733a 2050 6172 616d 7320 3d20 7b0a 2020  s: Params = {.  
-00018310: 2020 2020 2020 2020 2020 2272 6574 7572            "retur
-00018320: 6e4e 6577 223a 2072 6574 7572 6e5f 6e65  nNew": return_ne
-00018330: 772c 0a20 2020 2020 2020 2020 2020 2022  w,.            "
-00018340: 7369 6c65 6e74 223a 2073 696c 656e 742c  silent": silent,
-00018350: 0a20 2020 2020 2020 2020 2020 2022 6f76  .            "ov
-00018360: 6572 7772 6974 6522 3a20 6f76 6572 7772  erwrite": overwr
-00018370: 6974 652c 0a20 2020 2020 2020 2020 2020  ite,.           
-00018380: 2022 7265 7475 726e 4f6c 6422 3a20 7265   "returnOld": re
-00018390: 7475 726e 5f6f 6c64 2c0a 2020 2020 2020  turn_old,.      
-000183a0: 2020 7d0a 2020 2020 2020 2020 6966 2073    }.        if s
-000183b0: 796e 6320 6973 206e 6f74 204e 6f6e 653a  ync is not None:
-000183c0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
-000183d0: 616d 735b 2277 6169 7446 6f72 5379 6e63  ams["waitForSync
-000183e0: 225d 203d 2073 796e 630a 2020 2020 2020  "] = sync.      
-000183f0: 2020 6966 206f 7665 7277 7269 7465 5f6d    if overwrite_m
-00018400: 6f64 6520 6973 206e 6f74 204e 6f6e 653a  ode is not None:
-00018410: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
-00018420: 616d 735b 226f 7665 7277 7269 7465 4d6f  ams["overwriteMo
-00018430: 6465 225d 203d 206f 7665 7277 7269 7465  de"] = overwrite
-00018440: 5f6d 6f64 650a 2020 2020 2020 2020 6966  _mode.        if
-00018450: 206b 6565 705f 6e6f 6e65 2069 7320 6e6f   keep_none is no
-00018460: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00018470: 2020 2020 7061 7261 6d73 5b22 6b65 6570      params["keep
-00018480: 4e75 6c6c 225d 203d 206b 6565 705f 6e6f  Null"] = keep_no
-00018490: 6e65 0a20 2020 2020 2020 2069 6620 6d65  ne.        if me
-000184a0: 7267 6520 6973 206e 6f74 204e 6f6e 653a  rge is not None:
-000184b0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
-000184c0: 616d 735b 226d 6572 6765 4f62 6a65 6374  ams["mergeObject
-000184d0: 7322 5d20 3d20 6d65 7267 650a 0a20 2020  s"] = merge..   
-000184e0: 2020 2020 2023 204e 6577 2069 6e20 4172       # New in Ar
-000184f0: 616e 676f 4442 2033 2e39 2e36 2061 6e64  angoDB 3.9.6 and
-00018500: 2033 2e31 302e 320a 2020 2020 2020 2020   3.10.2.        
-00018510: 6966 2072 6566 696c 6c5f 696e 6465 785f  if refill_index_
-00018520: 6361 6368 6573 2069 7320 6e6f 7420 4e6f  caches is not No
-00018530: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00018540: 7061 7261 6d73 5b22 7265 6669 6c6c 496e  params["refillIn
-00018550: 6465 7843 6163 6865 7322 5d20 3d20 7265  dexCaches"] = re
-00018560: 6669 6c6c 5f69 6e64 6578 5f63 6163 6865  fill_index_cache
-00018570: 730a 0a20 2020 2020 2020 2072 6571 7565  s..        reque
-00018580: 7374 203d 2052 6571 7565 7374 280a 2020  st = Request(.  
-00018590: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
-000185a0: 3d22 706f 7374 222c 0a20 2020 2020 2020  ="post",.       
-000185b0: 2020 2020 2065 6e64 706f 696e 743d 6622       endpoint=f"
-000185c0: 2f5f 6170 692f 646f 6375 6d65 6e74 2f7b  /_api/document/{
-000185d0: 7365 6c66 2e6e 616d 657d 222c 0a20 2020  self.name}",.   
-000185e0: 2020 2020 2020 2020 2064 6174 613d 646f           data=do
-000185f0: 6375 6d65 6e74 2c0a 2020 2020 2020 2020  cument,.        
-00018600: 2020 2020 7061 7261 6d73 3d70 6172 616d      params=param
-00018610: 732c 0a20 2020 2020 2020 2020 2020 2077  s,.            w
-00018620: 7269 7465 3d73 656c 662e 6e61 6d65 2c0a  rite=self.name,.
-00018630: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00018640: 2020 2064 6566 2072 6573 706f 6e73 655f     def response_
-00018650: 6861 6e64 6c65 7228 7265 7370 3a20 5265  handler(resp: Re
-00018660: 7370 6f6e 7365 2920 2d3e 2055 6e69 6f6e  sponse) -> Union
-00018670: 5b62 6f6f 6c2c 204a 736f 6e5d 3a0a 2020  [bool, Json]:.  
-00018680: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-00018690: 2072 6573 702e 6973 5f73 7563 6365 7373   resp.is_success
-000186a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000186b0: 2020 7261 6973 6520 446f 6375 6d65 6e74    raise Document
-000186c0: 496e 7365 7274 4572 726f 7228 7265 7370  InsertError(resp
-000186d0: 2c20 7265 7175 6573 7429 0a0a 2020 2020  , request)..    
-000186e0: 2020 2020 2020 2020 6966 2073 696c 656e          if silen
-000186f0: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
-00018700: 2020 2072 6574 7572 6e20 5472 7565 0a0a     return True..
-00018710: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-00018720: 6c74 3a20 4a73 6f6e 203d 2072 6573 702e  lt: Json = resp.
-00018730: 626f 6479 0a20 2020 2020 2020 2020 2020  body.           
-00018740: 2069 6620 225f 6f6c 6452 6576 2220 696e   if "_oldRev" in
-00018750: 2072 6573 756c 743a 0a20 2020 2020 2020   result:.       
-00018760: 2020 2020 2020 2020 2072 6573 756c 745b           result[
-00018770: 225f 6f6c 645f 7265 7622 5d20 3d20 7265  "_old_rev"] = re
-00018780: 7375 6c74 2e70 6f70 2822 5f6f 6c64 5265  sult.pop("_oldRe
-00018790: 7622 290a 2020 2020 2020 2020 2020 2020  v").            
-000187a0: 7265 7475 726e 2072 6573 756c 740a 0a20  return result.. 
-000187b0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000187c0: 6c66 2e5f 6578 6563 7574 6528 7265 7175  lf._execute(requ
-000187d0: 6573 742c 2072 6573 706f 6e73 655f 6861  est, response_ha
-000187e0: 6e64 6c65 7229 0a0a 2020 2020 6465 6620  ndler)..    def 
-000187f0: 7570 6461 7465 280a 2020 2020 2020 2020  update(.        
-00018800: 7365 6c66 2c0a 2020 2020 2020 2020 646f  self,.        do
-00018810: 6375 6d65 6e74 3a20 4a73 6f6e 2c0a 2020  cument: Json,.  
-00018820: 2020 2020 2020 6368 6563 6b5f 7265 763a        check_rev:
-00018830: 2062 6f6f 6c20 3d20 5472 7565 2c0a 2020   bool = True,.  
-00018840: 2020 2020 2020 6d65 7267 653a 2062 6f6f        merge: boo
-00018850: 6c20 3d20 5472 7565 2c0a 2020 2020 2020  l = True,.      
-00018860: 2020 6b65 6570 5f6e 6f6e 653a 2062 6f6f    keep_none: boo
-00018870: 6c20 3d20 5472 7565 2c0a 2020 2020 2020  l = True,.      
-00018880: 2020 7265 7475 726e 5f6e 6577 3a20 626f    return_new: bo
-00018890: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
-000188a0: 2020 2020 7265 7475 726e 5f6f 6c64 3a20      return_old: 
-000188b0: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
-000188c0: 2020 2020 2020 7379 6e63 3a20 4f70 7469        sync: Opti
-000188d0: 6f6e 616c 5b62 6f6f 6c5d 203d 204e 6f6e  onal[bool] = Non
-000188e0: 652c 0a20 2020 2020 2020 2073 696c 656e  e,.        silen
-000188f0: 743a 2062 6f6f 6c20 3d20 4661 6c73 652c  t: bool = False,
-00018900: 0a20 2020 2020 2020 2072 6566 696c 6c5f  .        refill_
-00018910: 696e 6465 785f 6361 6368 6573 3a20 4f70  index_caches: Op
-00018920: 7469 6f6e 616c 5b62 6f6f 6c5d 203d 204e  tional[bool] = N
-00018930: 6f6e 652c 0a20 2020 2029 202d 3e20 5265  one,.    ) -> Re
-00018940: 7375 6c74 5b55 6e69 6f6e 5b62 6f6f 6c2c  sult[Union[bool,
-00018950: 204a 736f 6e5d 5d3a 0a20 2020 2020 2020   Json]]:.       
-00018960: 2022 2222 5570 6461 7465 2061 2064 6f63   """Update a doc
-00018970: 756d 656e 742e 0a0a 2020 2020 2020 2020  ument...        
-00018980: 3a70 6172 616d 2064 6f63 756d 656e 743a  :param document:
-00018990: 2050 6172 7469 616c 206f 7220 6675 6c6c   Partial or full
-000189a0: 2064 6f63 756d 656e 7420 7769 7468 2074   document with t
-000189b0: 6865 2075 7064 6174 6564 2076 616c 7565  he updated value
-000189c0: 732e 2049 740a 2020 2020 2020 2020 2020  s. It.          
-000189d0: 2020 6d75 7374 2063 6f6e 7461 696e 2074    must contain t
-000189e0: 6865 2022 5f69 6422 206f 7220 225f 6b65  he "_id" or "_ke
-000189f0: 7922 2066 6965 6c64 2e0a 2020 2020 2020  y" field..      
-00018a00: 2020 3a74 7970 6520 646f 6375 6d65 6e74    :type document
-00018a10: 3a20 6469 6374 0a20 2020 2020 2020 203a  : dict.        :
-00018a20: 7061 7261 6d20 6368 6563 6b5f 7265 763a  param check_rev:
-00018a30: 2049 6620 7365 7420 746f 2054 7275 652c   If set to True,
-00018a40: 2072 6576 6973 696f 6e20 6f66 202a 2a64   revision of **d
-00018a50: 6f63 756d 656e 742a 2a20 2869 6620 6769  ocument** (if gi
-00018a60: 7665 6e29 0a20 2020 2020 2020 2020 2020  ven).           
-00018a70: 2069 7320 636f 6d70 6172 6564 2061 6761   is compared aga
-00018a80: 696e 7374 2074 6865 2072 6576 6973 696f  inst the revisio
-00018a90: 6e20 6f66 2074 6172 6765 7420 646f 6375  n of target docu
-00018aa0: 6d65 6e74 2e0a 2020 2020 2020 2020 3a74  ment..        :t
-00018ab0: 7970 6520 6368 6563 6b5f 7265 763a 2062  ype check_rev: b
-00018ac0: 6f6f 6c0a 2020 2020 2020 2020 3a70 6172  ool.        :par
-00018ad0: 616d 206d 6572 6765 3a20 4966 2073 6574  am merge: If set
-00018ae0: 2074 6f20 5472 7565 2c20 7375 622d 6469   to True, sub-di
-00018af0: 6374 696f 6e61 7269 6573 2061 7265 206d  ctionaries are m
-00018b00: 6572 6765 6420 696e 7374 6561 6420 6f66  erged instead of
-00018b10: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
-00018b20: 206e 6577 206f 6e65 206f 7665 7277 7269   new one overwri
-00018b30: 7469 6e67 2074 6865 206f 6c64 206f 6e65  ting the old one
-00018b40: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
-00018b50: 6d65 7267 653a 2062 6f6f 6c20 7c20 4e6f  merge: bool | No
-00018b60: 6e65 0a20 2020 2020 2020 203a 7061 7261  ne.        :para
-00018b70: 6d20 6b65 6570 5f6e 6f6e 653a 2049 6620  m keep_none: If 
-00018b80: 7365 7420 746f 2054 7275 652c 2066 6965  set to True, fie
-00018b90: 6c64 7320 7769 7468 2076 616c 7565 204e  lds with value N
-00018ba0: 6f6e 6520 6172 6520 7265 7461 696e 6564  one are retained
-00018bb0: 0a20 2020 2020 2020 2020 2020 2069 6e20  .            in 
-00018bc0: 7468 6520 646f 6375 6d65 6e74 2e20 4f74  the document. Ot
-00018bd0: 6865 7277 6973 652c 2074 6865 7920 6172  herwise, they ar
-00018be0: 6520 7265 6d6f 7665 6420 636f 6d70 6c65  e removed comple
-00018bf0: 7465 6c79 2e0a 2020 2020 2020 2020 3a74  tely..        :t
-00018c00: 7970 6520 6b65 6570 5f6e 6f6e 653a 2062  ype keep_none: b
-00018c10: 6f6f 6c20 7c20 4e6f 6e65 0a20 2020 2020  ool | None.     
-00018c20: 2020 203a 7061 7261 6d20 7265 7475 726e     :param return
-00018c30: 5f6e 6577 3a20 496e 636c 7564 6520 626f  _new: Include bo
-00018c40: 6479 206f 6620 7468 6520 6e65 7720 646f  dy of the new do
-00018c50: 6375 6d65 6e74 2069 6e20 7468 6520 7265  cument in the re
-00018c60: 7475 726e 6564 0a20 2020 2020 2020 2020  turned.         
-00018c70: 2020 206d 6574 6164 6174 612e 2049 676e     metadata. Ign
-00018c80: 6f72 6564 2069 6620 7061 7261 6d65 7465  ored if paramete
-00018c90: 7220 2a2a 7369 6c65 6e74 2a2a 2069 7320  r **silent** is 
-00018ca0: 7365 7420 746f 2054 7275 652e 0a20 2020  set to True..   
-00018cb0: 2020 2020 203a 7479 7065 2072 6574 7572       :type retur
-00018cc0: 6e5f 6e65 773a 2062 6f6f 6c0a 2020 2020  n_new: bool.    
-00018cd0: 2020 2020 3a70 6172 616d 2072 6574 7572      :param retur
-00018ce0: 6e5f 6f6c 643a 2049 6e63 6c75 6465 2062  n_old: Include b
-00018cf0: 6f64 7920 6f66 2074 6865 206f 6c64 2064  ody of the old d
-00018d00: 6f63 756d 656e 7420 696e 2074 6865 2072  ocument in the r
-00018d10: 6574 7572 6e65 640a 2020 2020 2020 2020  eturned.        
-00018d20: 2020 2020 6d65 7461 6461 7461 2e20 4967      metadata. Ig
-00018d30: 6e6f 7265 6420 6966 2070 6172 616d 6574  nored if paramet
-00018d40: 6572 202a 2a73 696c 656e 742a 2a20 6973  er **silent** is
-00018d50: 2073 6574 2074 6f20 5472 7565 2e0a 2020   set to True..  
-00018d60: 2020 2020 2020 3a74 7970 6520 7265 7475        :type retu
-00018d70: 726e 5f6f 6c64 3a20 626f 6f6c 0a20 2020  rn_old: bool.   
-00018d80: 2020 2020 203a 7061 7261 6d20 7379 6e63       :param sync
-00018d90: 3a20 426c 6f63 6b20 756e 7469 6c20 6f70  : Block until op
-00018da0: 6572 6174 696f 6e20 6973 2073 796e 6368  eration is synch
-00018db0: 726f 6e69 7a65 6420 746f 2064 6973 6b2e  ronized to disk.
-00018dc0: 0a20 2020 2020 2020 203a 7479 7065 2073  .        :type s
-00018dd0: 796e 633a 2062 6f6f 6c20 7c20 4e6f 6e65  ync: bool | None
-00018de0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00018df0: 7369 6c65 6e74 3a20 4966 2073 6574 2074  silent: If set t
-00018e00: 6f20 5472 7565 2c20 6e6f 2064 6f63 756d  o True, no docum
-00018e10: 656e 7420 6d65 7461 6461 7461 2069 7320  ent metadata is 
-00018e20: 7265 7475 726e 6564 2e20 5468 6973 0a20  returned. This. 
-00018e30: 2020 2020 2020 2020 2020 2063 616e 2062             can b
-00018e40: 6520 7573 6564 2074 6f20 7361 7665 2072  e used to save r
-00018e50: 6573 6f75 7263 6573 2e0a 2020 2020 2020  esources..      
-00018e60: 2020 3a74 7970 6520 7369 6c65 6e74 3a20    :type silent: 
-00018e70: 626f 6f6c 0a20 2020 2020 2020 203a 7061  bool.        :pa
-00018e80: 7261 6d20 7265 6669 6c6c 5f69 6e64 6578  ram refill_index
-00018e90: 5f63 6163 6865 733a 2057 6865 7468 6572  _caches: Whether
-00018ea0: 2074 6f20 6164 6420 6e65 7720 656e 7472   to add new entr
-00018eb0: 6965 7320 746f 2069 6e2d 6d65 6d6f 7279  ies to in-memory
-00018ec0: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
-00018ed0: 6578 2063 6163 6865 7320 6966 2064 6f63  ex caches if doc
-00018ee0: 756d 656e 7420 696e 7365 7274 696f 6e73  ument insertions
-00018ef0: 2061 6666 6563 7420 7468 6520 6564 6765   affect the edge
-00018f00: 2069 6e64 6578 206f 720a 2020 2020 2020   index or.      
-00018f10: 2020 2020 2020 6361 6368 652d 656e 6162        cache-enab
-00018f20: 6c65 6420 7065 7273 6973 7465 6e74 2069  led persistent i
-00018f30: 6e64 6578 6573 2e0a 2020 2020 2020 2020  ndexes..        
-00018f40: 3a74 7970 6520 7265 6669 6c6c 5f69 6e64  :type refill_ind
-00018f50: 6578 5f63 6163 6865 733a 2062 6f6f 6c20  ex_caches: bool 
-00018f60: 7c20 4e6f 6e65 0a20 2020 2020 2020 203a  | None.        :
-00018f70: 7265 7475 726e 3a20 446f 6375 6d65 6e74  return: Document
-00018f80: 206d 6574 6164 6174 6120 2865 2e67 2e20   metadata (e.g. 
-00018f90: 646f 6375 6d65 6e74 206b 6579 2c20 7265  document key, re
-00018fa0: 7669 7369 6f6e 2920 6f72 2054 7275 6520  vision) or True 
-00018fb0: 6966 0a20 2020 2020 2020 2020 2020 2070  if.            p
-00018fc0: 6172 616d 6574 6572 202a 2a73 696c 656e  arameter **silen
-00018fd0: 742a 2a20 7761 7320 7365 7420 746f 2054  t** was set to T
-00018fe0: 7275 652e 0a20 2020 2020 2020 203a 7274  rue..        :rt
-00018ff0: 7970 653a 2062 6f6f 6c20 7c20 6469 6374  ype: bool | dict
-00019000: 0a20 2020 2020 2020 203a 7261 6973 6520  .        :raise 
-00019010: 6172 616e 676f 2e65 7863 6570 7469 6f6e  arango.exception
-00019020: 732e 446f 6375 6d65 6e74 5570 6461 7465  s.DocumentUpdate
-00019030: 4572 726f 723a 2049 6620 7570 6461 7465  Error: If update
-00019040: 2066 6169 6c73 2e0a 2020 2020 2020 2020   fails..        
-00019050: 3a72 6169 7365 2061 7261 6e67 6f2e 6578  :raise arango.ex
-00019060: 6365 7074 696f 6e73 2e44 6f63 756d 656e  ceptions.Documen
-00019070: 7452 6576 6973 696f 6e45 7272 6f72 3a20  tRevisionError: 
-00019080: 4966 2072 6576 6973 696f 6e73 206d 6973  If revisions mis
-00019090: 6d61 7463 682e 0a20 2020 2020 2020 2022  match..        "
-000190a0: 2222 0a20 2020 2020 2020 2070 6172 616d  "".        param
-000190b0: 733a 2050 6172 616d 7320 3d20 7b0a 2020  s: Params = {.  
-000190c0: 2020 2020 2020 2020 2020 226b 6565 704e            "keepN
-000190d0: 756c 6c22 3a20 6b65 6570 5f6e 6f6e 652c  ull": keep_none,
-000190e0: 0a20 2020 2020 2020 2020 2020 2022 6d65  .            "me
-000190f0: 7267 654f 626a 6563 7473 223a 206d 6572  rgeObjects": mer
-00019100: 6765 2c0a 2020 2020 2020 2020 2020 2020  ge,.            
-00019110: 2272 6574 7572 6e4e 6577 223a 2072 6574  "returnNew": ret
-00019120: 7572 6e5f 6e65 772c 0a20 2020 2020 2020  urn_new,.       
-00019130: 2020 2020 2022 7265 7475 726e 4f6c 6422       "returnOld"
-00019140: 3a20 7265 7475 726e 5f6f 6c64 2c0a 2020  : return_old,.  
-00019150: 2020 2020 2020 2020 2020 2269 676e 6f72            "ignor
-00019160: 6552 6576 7322 3a20 6e6f 7420 6368 6563  eRevs": not chec
-00019170: 6b5f 7265 762c 0a20 2020 2020 2020 2020  k_rev,.         
-00019180: 2020 2022 6f76 6572 7772 6974 6522 3a20     "overwrite": 
-00019190: 6e6f 7420 6368 6563 6b5f 7265 762c 0a20  not check_rev,. 
-000191a0: 2020 2020 2020 2020 2020 2022 7369 6c65             "sile
-000191b0: 6e74 223a 2073 696c 656e 742c 0a20 2020  nt": silent,.   
-000191c0: 2020 2020 207d 0a20 2020 2020 2020 2069       }.        i
-000191d0: 6620 7379 6e63 2069 7320 6e6f 7420 4e6f  f sync is not No
-000191e0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-000191f0: 7061 7261 6d73 5b22 7761 6974 466f 7253  params["waitForS
-00019200: 796e 6322 5d20 3d20 7379 6e63 0a0a 2020  ync"] = sync..  
-00019210: 2020 2020 2020 2320 4e65 7720 696e 2041        # New in A
-00019220: 7261 6e67 6f44 4220 332e 392e 3620 616e  rangoDB 3.9.6 an
-00019230: 6420 332e 3130 2e32 0a20 2020 2020 2020  d 3.10.2.       
-00019240: 2069 6620 7265 6669 6c6c 5f69 6e64 6578   if refill_index
-00019250: 5f63 6163 6865 7320 6973 206e 6f74 204e  _caches is not N
-00019260: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00019270: 2070 6172 616d 735b 2272 6566 696c 6c49   params["refillI
-00019280: 6e64 6578 4361 6368 6573 225d 203d 2072  ndexCaches"] = r
-00019290: 6566 696c 6c5f 696e 6465 785f 6361 6368  efill_index_cach
-000192a0: 6573 0a0a 2020 2020 2020 2020 7265 7175  es..        requ
-000192b0: 6573 7420 3d20 5265 7175 6573 7428 0a20  est = Request(. 
-000192c0: 2020 2020 2020 2020 2020 206d 6574 686f             metho
-000192d0: 643d 2270 6174 6368 222c 0a20 2020 2020  d="patch",.     
-000192e0: 2020 2020 2020 2065 6e64 706f 696e 743d         endpoint=
-000192f0: 6622 2f5f 6170 692f 646f 6375 6d65 6e74  f"/_api/document
-00019300: 2f7b 7365 6c66 2e5f 6578 7472 6163 745f  /{self._extract_
-00019310: 6964 2864 6f63 756d 656e 7429 7d22 2c0a  id(document)}",.
-00019320: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00019330: 3d64 6f63 756d 656e 742c 0a20 2020 2020  =document,.     
-00019340: 2020 2020 2020 2070 6172 616d 733d 7061         params=pa
-00019350: 7261 6d73 2c0a 2020 2020 2020 2020 2020  rams,.          
-00019360: 2020 7772 6974 653d 7365 6c66 2e6e 616d    write=self.nam
-00019370: 652c 0a20 2020 2020 2020 2029 0a0a 2020  e,.        )..  
-00019380: 2020 2020 2020 6465 6620 7265 7370 6f6e        def respon
-00019390: 7365 5f68 616e 646c 6572 2872 6573 703a  se_handler(resp:
-000193a0: 2052 6573 706f 6e73 6529 202d 3e20 556e   Response) -> Un
-000193b0: 696f 6e5b 626f 6f6c 2c20 4a73 6f6e 5d3a  ion[bool, Json]:
-000193c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000193d0: 7265 7370 2e73 7461 7475 735f 636f 6465  resp.status_code
-000193e0: 203d 3d20 3431 323a 0a20 2020 2020 2020   == 412:.       
-000193f0: 2020 2020 2020 2020 2072 6169 7365 2044           raise D
-00019400: 6f63 756d 656e 7452 6576 6973 696f 6e45  ocumentRevisionE
-00019410: 7272 6f72 2872 6573 702c 2072 6571 7565  rror(resp, reque
-00019420: 7374 290a 2020 2020 2020 2020 2020 2020  st).            
-00019430: 656c 6966 206e 6f74 2072 6573 702e 6973  elif not resp.is
-00019440: 5f73 7563 6365 7373 3a0a 2020 2020 2020  _success:.      
-00019450: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00019460: 446f 6375 6d65 6e74 5570 6461 7465 4572  DocumentUpdateEr
-00019470: 726f 7228 7265 7370 2c20 7265 7175 6573  ror(resp, reques
-00019480: 7429 0a20 2020 2020 2020 2020 2020 2069  t).            i
-00019490: 6620 7369 6c65 6e74 2069 7320 5472 7565  f silent is True
-000194a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000194b0: 2020 7265 7475 726e 2054 7275 650a 0a20    return True.. 
-000194c0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-000194d0: 743a 204a 736f 6e20 3d20 7265 7370 2e62  t: Json = resp.b
-000194e0: 6f64 790a 2020 2020 2020 2020 2020 2020  ody.            
-000194f0: 7265 7375 6c74 5b22 5f6f 6c64 5f72 6576  result["_old_rev
-00019500: 225d 203d 2072 6573 756c 742e 706f 7028  "] = result.pop(
-00019510: 225f 6f6c 6452 6576 2229 0a20 2020 2020  "_oldRev").     
-00019520: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-00019530: 7375 6c74 0a0a 2020 2020 2020 2020 7265  sult..        re
-00019540: 7475 726e 2073 656c 662e 5f65 7865 6375  turn self._execu
-00019550: 7465 2872 6571 7565 7374 2c20 7265 7370  te(request, resp
-00019560: 6f6e 7365 5f68 616e 646c 6572 290a 0a20  onse_handler).. 
-00019570: 2020 2064 6566 2072 6570 6c61 6365 280a     def replace(.
-00019580: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00019590: 2020 2020 2020 646f 6375 6d65 6e74 3a20        document: 
-000195a0: 4a73 6f6e 2c0a 2020 2020 2020 2020 6368  Json,.        ch
-000195b0: 6563 6b5f 7265 763a 2062 6f6f 6c20 3d20  eck_rev: bool = 
-000195c0: 5472 7565 2c0a 2020 2020 2020 2020 7265  True,.        re
-000195d0: 7475 726e 5f6e 6577 3a20 626f 6f6c 203d  turn_new: bool =
-000195e0: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
-000195f0: 7265 7475 726e 5f6f 6c64 3a20 626f 6f6c  return_old: bool
-00019600: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
-00019610: 2020 7379 6e63 3a20 4f70 7469 6f6e 616c    sync: Optional
-00019620: 5b62 6f6f 6c5d 203d 204e 6f6e 652c 0a20  [bool] = None,. 
-00019630: 2020 2020 2020 2073 696c 656e 743a 2062         silent: b
-00019640: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
-00019650: 2020 2020 2072 6566 696c 6c5f 696e 6465       refill_inde
-00019660: 785f 6361 6368 6573 3a20 4f70 7469 6f6e  x_caches: Option
-00019670: 616c 5b62 6f6f 6c5d 203d 204e 6f6e 652c  al[bool] = None,
-00019680: 0a20 2020 2029 202d 3e20 5265 7375 6c74  .    ) -> Result
-00019690: 5b55 6e69 6f6e 5b62 6f6f 6c2c 204a 736f  [Union[bool, Jso
-000196a0: 6e5d 5d3a 0a20 2020 2020 2020 2022 2222  n]]:.        """
-000196b0: 5265 706c 6163 6520 6120 646f 6375 6d65  Replace a docume
-000196c0: 6e74 2e0a 0a20 2020 2020 2020 203a 7061  nt...        :pa
-000196d0: 7261 6d20 646f 6375 6d65 6e74 3a20 4e65  ram document: Ne
-000196e0: 7720 646f 6375 6d65 6e74 2074 6f20 7265  w document to re
-000196f0: 706c 6163 6520 7468 6520 6f6c 6420 6f6e  place the old on
-00019700: 6520 7769 7468 2e20 4974 206d 7573 740a  e with. It must.
-00019710: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
-00019720: 6169 6e20 7468 6520 225f 6964 2220 6f72  ain the "_id" or
-00019730: 2022 5f6b 6579 2220 6669 656c 642e 2045   "_key" field. E
-00019740: 6467 6520 646f 6375 6d65 6e74 206d 7573  dge document mus
-00019750: 7420 616c 736f 2068 6176 650a 2020 2020  t also have.    
-00019760: 2020 2020 2020 2020 225f 6672 6f6d 2220          "_from" 
-00019770: 616e 6420 225f 746f 2220 6669 656c 6473  and "_to" fields
-00019780: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
-00019790: 646f 6375 6d65 6e74 3a20 6469 6374 0a20  document: dict. 
-000197a0: 2020 2020 2020 203a 7061 7261 6d20 6368         :param ch
-000197b0: 6563 6b5f 7265 763a 2049 6620 7365 7420  eck_rev: If set 
-000197c0: 746f 2054 7275 652c 2072 6576 6973 696f  to True, revisio
-000197d0: 6e20 6f66 202a 2a64 6f63 756d 656e 742a  n of **document*
-000197e0: 2a20 2869 6620 6769 7665 6e29 0a20 2020  * (if given).   
-000197f0: 2020 2020 2020 2020 2069 7320 636f 6d70           is comp
-00019800: 6172 6564 2061 6761 696e 7374 2074 6865  ared against the
-00019810: 2072 6576 6973 696f 6e20 6f66 2074 6172   revision of tar
-00019820: 6765 7420 646f 6375 6d65 6e74 2e0a 2020  get document..  
-00019830: 2020 2020 2020 3a74 7970 6520 6368 6563        :type chec
-00019840: 6b5f 7265 763a 2062 6f6f 6c0a 2020 2020  k_rev: bool.    
-00019850: 2020 2020 3a70 6172 616d 2072 6574 7572      :param retur
-00019860: 6e5f 6e65 773a 2049 6e63 6c75 6465 2062  n_new: Include b
-00019870: 6f64 7920 6f66 2074 6865 206e 6577 2064  ody of the new d
-00019880: 6f63 756d 656e 7420 696e 2074 6865 2072  ocument in the r
-00019890: 6574 7572 6e65 640a 2020 2020 2020 2020  eturned.        
-000198a0: 2020 2020 6d65 7461 6461 7461 2e20 4967      metadata. Ig
-000198b0: 6e6f 7265 6420 6966 2070 6172 616d 6574  nored if paramet
-000198c0: 6572 202a 2a73 696c 656e 742a 2a20 6973  er **silent** is
-000198d0: 2073 6574 2074 6f20 5472 7565 2e0a 2020   set to True..  
-000198e0: 2020 2020 2020 3a74 7970 6520 7265 7475        :type retu
-000198f0: 726e 5f6e 6577 3a20 626f 6f6c 0a20 2020  rn_new: bool.   
-00019900: 2020 2020 203a 7061 7261 6d20 7265 7475       :param retu
-00019910: 726e 5f6f 6c64 3a20 496e 636c 7564 6520  rn_old: Include 
-00019920: 626f 6479 206f 6620 7468 6520 6f6c 6420  body of the old 
-00019930: 646f 6375 6d65 6e74 2069 6e20 7468 6520  document in the 
-00019940: 7265 7475 726e 6564 0a20 2020 2020 2020  returned.       
-00019950: 2020 2020 206d 6574 6164 6174 612e 2049       metadata. I
-00019960: 676e 6f72 6564 2069 6620 7061 7261 6d65  gnored if parame
-00019970: 7465 7220 2a2a 7369 6c65 6e74 2a2a 2069  ter **silent** i
-00019980: 7320 7365 7420 746f 2054 7275 652e 0a20  s set to True.. 
-00019990: 2020 2020 2020 203a 7479 7065 2072 6574         :type ret
-000199a0: 7572 6e5f 6f6c 643a 2062 6f6f 6c0a 2020  urn_old: bool.  
-000199b0: 2020 2020 2020 3a70 6172 616d 2073 796e        :param syn
-000199c0: 633a 2042 6c6f 636b 2075 6e74 696c 206f  c: Block until o
-000199d0: 7065 7261 7469 6f6e 2069 7320 7379 6e63  peration is sync
-000199e0: 6872 6f6e 697a 6564 2074 6f20 6469 736b  hronized to disk
-000199f0: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
-00019a00: 7379 6e63 3a20 626f 6f6c 207c 204e 6f6e  sync: bool | Non
-00019a10: 650a 2020 2020 2020 2020 3a70 6172 616d  e.        :param
-00019a20: 2073 696c 656e 743a 2049 6620 7365 7420   silent: If set 
-00019a30: 746f 2054 7275 652c 206e 6f20 646f 6375  to True, no docu
-00019a40: 6d65 6e74 206d 6574 6164 6174 6120 6973  ment metadata is
-00019a50: 2072 6574 7572 6e65 642e 2054 6869 730a   returned. This.
-00019a60: 2020 2020 2020 2020 2020 2020 6361 6e20              can 
-00019a70: 6265 2075 7365 6420 746f 2073 6176 6520  be used to save 
-00019a80: 7265 736f 7572 6365 732e 0a20 2020 2020  resources..     
-00019a90: 2020 203a 7479 7065 2073 696c 656e 743a     :type silent:
-00019aa0: 2062 6f6f 6c0a 2020 2020 2020 2020 3a70   bool.        :p
-00019ab0: 6172 616d 2072 6566 696c 6c5f 696e 6465  aram refill_inde
-00019ac0: 785f 6361 6368 6573 3a20 5768 6574 6865  x_caches: Whethe
-00019ad0: 7220 746f 2061 6464 206e 6577 2065 6e74  r to add new ent
-00019ae0: 7269 6573 2074 6f20 696e 2d6d 656d 6f72  ries to in-memor
-00019af0: 790a 2020 2020 2020 2020 2020 2020 696e  y.            in
-00019b00: 6465 7820 6361 6368 6573 2069 6620 646f  dex caches if do
-00019b10: 6375 6d65 6e74 2069 6e73 6572 7469 6f6e  cument insertion
-00019b20: 7320 6166 6665 6374 2074 6865 2065 6467  s affect the edg
-00019b30: 6520 696e 6465 7820 6f72 0a20 2020 2020  e index or.     
-00019b40: 2020 2020 2020 2063 6163 6865 2d65 6e61         cache-ena
-00019b50: 626c 6564 2070 6572 7369 7374 656e 7420  bled persistent 
-00019b60: 696e 6465 7865 732e 0a20 2020 2020 2020  indexes..       
-00019b70: 203a 7479 7065 2072 6566 696c 6c5f 696e   :type refill_in
-00019b80: 6465 785f 6361 6368 6573 3a20 626f 6f6c  dex_caches: bool
-00019b90: 207c 204e 6f6e 650a 2020 2020 2020 2020   | None.        
-00019ba0: 3a72 6574 7572 6e3a 2044 6f63 756d 656e  :return: Documen
-00019bb0: 7420 6d65 7461 6461 7461 2028 652e 672e  t metadata (e.g.
-00019bc0: 2064 6f63 756d 656e 7420 6b65 792c 2072   document key, r
-00019bd0: 6576 6973 696f 6e29 206f 7220 5472 7565  evision) or True
-00019be0: 2069 660a 2020 2020 2020 2020 2020 2020   if.            
-00019bf0: 7061 7261 6d65 7465 7220 2a2a 7369 6c65  parameter **sile
-00019c00: 6e74 2a2a 2077 6173 2073 6574 2074 6f20  nt** was set to 
-00019c10: 5472 7565 2e0a 2020 2020 2020 2020 3a72  True..        :r
-00019c20: 7479 7065 3a20 626f 6f6c 207c 2064 6963  type: bool | dic
-00019c30: 740a 2020 2020 2020 2020 3a72 6169 7365  t.        :raise
-00019c40: 2061 7261 6e67 6f2e 6578 6365 7074 696f   arango.exceptio
-00019c50: 6e73 2e44 6f63 756d 656e 7452 6570 6c61  ns.DocumentRepla
-00019c60: 6365 4572 726f 723a 2049 6620 7265 706c  ceError: If repl
-00019c70: 6163 6520 6661 696c 732e 0a20 2020 2020  ace fails..     
-00019c80: 2020 203a 7261 6973 6520 6172 616e 676f     :raise arango
-00019c90: 2e65 7863 6570 7469 6f6e 732e 446f 6375  .exceptions.Docu
-00019ca0: 6d65 6e74 5265 7669 7369 6f6e 4572 726f  mentRevisionErro
-00019cb0: 723a 2049 6620 7265 7669 7369 6f6e 7320  r: If revisions 
-00019cc0: 6d69 736d 6174 6368 2e0a 2020 2020 2020  mismatch..      
-00019cd0: 2020 2222 220a 2020 2020 2020 2020 7061    """.        pa
-00019ce0: 7261 6d73 3a20 5061 7261 6d73 203d 207b  rams: Params = {
-00019cf0: 0a20 2020 2020 2020 2020 2020 2022 7265  .            "re
-00019d00: 7475 726e 4e65 7722 3a20 7265 7475 726e  turnNew": return
-00019d10: 5f6e 6577 2c0a 2020 2020 2020 2020 2020  _new,.          
-00019d20: 2020 2272 6574 7572 6e4f 6c64 223a 2072    "returnOld": r
-00019d30: 6574 7572 6e5f 6f6c 642c 0a20 2020 2020  eturn_old,.     
-00019d40: 2020 2020 2020 2022 6967 6e6f 7265 5265         "ignoreRe
-00019d50: 7673 223a 206e 6f74 2063 6865 636b 5f72  vs": not check_r
-00019d60: 6576 2c0a 2020 2020 2020 2020 2020 2020  ev,.            
-00019d70: 226f 7665 7277 7269 7465 223a 206e 6f74  "overwrite": not
-00019d80: 2063 6865 636b 5f72 6576 2c0a 2020 2020   check_rev,.    
-00019d90: 2020 2020 2020 2020 2273 696c 656e 7422          "silent"
-00019da0: 3a20 7369 6c65 6e74 2c0a 2020 2020 2020  : silent,.      
-00019db0: 2020 7d0a 2020 2020 2020 2020 6966 2073    }.        if s
-00019dc0: 796e 6320 6973 206e 6f74 204e 6f6e 653a  ync is not None:
-00019dd0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
-00019de0: 616d 735b 2277 6169 7446 6f72 5379 6e63  ams["waitForSync
-00019df0: 225d 203d 2073 796e 630a 0a20 2020 2020  "] = sync..     
-00019e00: 2020 2023 204e 6577 2069 6e20 4172 616e     # New in Aran
-00019e10: 676f 4442 2033 2e39 2e36 2061 6e64 2033  goDB 3.9.6 and 3
-00019e20: 2e31 302e 320a 2020 2020 2020 2020 6966  .10.2.        if
-00019e30: 2072 6566 696c 6c5f 696e 6465 785f 6361   refill_index_ca
-00019e40: 6368 6573 2069 7320 6e6f 7420 4e6f 6e65  ches is not None
-00019e50: 3a0a 2020 2020 2020 2020 2020 2020 7061  :.            pa
-00019e60: 7261 6d73 5b22 7265 6669 6c6c 496e 6465  rams["refillInde
-00019e70: 7843 6163 6865 7322 5d20 3d20 7265 6669  xCaches"] = refi
-00019e80: 6c6c 5f69 6e64 6578 5f63 6163 6865 730a  ll_index_caches.
-00019e90: 0a20 2020 2020 2020 2072 6571 7565 7374  .        request
-00019ea0: 203d 2052 6571 7565 7374 280a 2020 2020   = Request(.    
-00019eb0: 2020 2020 2020 2020 6d65 7468 6f64 3d22          method="
-00019ec0: 7075 7422 2c0a 2020 2020 2020 2020 2020  put",.          
-00019ed0: 2020 656e 6470 6f69 6e74 3d66 222f 5f61    endpoint=f"/_a
-00019ee0: 7069 2f64 6f63 756d 656e 742f 7b73 656c  pi/document/{sel
-00019ef0: 662e 5f65 7874 7261 6374 5f69 6428 646f  f._extract_id(do
-00019f00: 6375 6d65 6e74 297d 222c 0a20 2020 2020  cument)}",.     
-00019f10: 2020 2020 2020 2070 6172 616d 733d 7061         params=pa
-00019f20: 7261 6d73 2c0a 2020 2020 2020 2020 2020  rams,.          
-00019f30: 2020 6461 7461 3d64 6f63 756d 656e 742c    data=document,
-00019f40: 0a20 2020 2020 2020 2020 2020 2077 7269  .            wri
-00019f50: 7465 3d73 656c 662e 6e61 6d65 2c0a 2020  te=self.name,.  
-00019f60: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00019f70: 2064 6566 2072 6573 706f 6e73 655f 6861   def response_ha
-00019f80: 6e64 6c65 7228 7265 7370 3a20 5265 7370  ndler(resp: Resp
-00019f90: 6f6e 7365 2920 2d3e 2055 6e69 6f6e 5b62  onse) -> Union[b
-00019fa0: 6f6f 6c2c 204a 736f 6e5d 3a0a 2020 2020  ool, Json]:.    
-00019fb0: 2020 2020 2020 2020 6966 2072 6573 702e          if resp.
-00019fc0: 7374 6174 7573 5f63 6f64 6520 3d3d 2034  status_code == 4
-00019fd0: 3132 3a0a 2020 2020 2020 2020 2020 2020  12:.            
-00019fe0: 2020 2020 7261 6973 6520 446f 6375 6d65      raise Docume
-00019ff0: 6e74 5265 7669 7369 6f6e 4572 726f 7228  ntRevisionError(
-0001a000: 7265 7370 2c20 7265 7175 6573 7429 0a20  resp, request). 
-0001a010: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-0001a020: 7420 7265 7370 2e69 735f 7375 6363 6573  t resp.is_succes
-0001a030: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-0001a040: 2020 2072 6169 7365 2044 6f63 756d 656e     raise Documen
-0001a050: 7452 6570 6c61 6365 4572 726f 7228 7265  tReplaceError(re
-0001a060: 7370 2c20 7265 7175 6573 7429 0a0a 2020  sp, request)..  
-0001a070: 2020 2020 2020 2020 2020 6966 2073 696c            if sil
-0001a080: 656e 7420 6973 2054 7275 653a 0a20 2020  ent is True:.   
-0001a090: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-0001a0a0: 7572 6e20 5472 7565 0a0a 2020 2020 2020  urn True..      
-0001a0b0: 2020 2020 2020 7265 7375 6c74 3a20 4a73        result: Js
-0001a0c0: 6f6e 203d 2072 6573 702e 626f 6479 0a20  on = resp.body. 
-0001a0d0: 2020 2020 2020 2020 2020 2069 6620 225f             if "_
-0001a0e0: 6f6c 6452 6576 2220 696e 2072 6573 756c  oldRev" in resul
-0001a0f0: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
-0001a100: 2020 2072 6573 756c 745b 225f 6f6c 645f     result["_old_
-0001a110: 7265 7622 5d20 3d20 7265 7375 6c74 2e70  rev"] = result.p
-0001a120: 6f70 2822 5f6f 6c64 5265 7622 290a 2020  op("_oldRev").  
-0001a130: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001a140: 2072 6573 756c 740a 0a20 2020 2020 2020   result..       
-0001a150: 2072 6574 7572 6e20 7365 6c66 2e5f 6578   return self._ex
-0001a160: 6563 7574 6528 7265 7175 6573 742c 2072  ecute(request, r
-0001a170: 6573 706f 6e73 655f 6861 6e64 6c65 7229  esponse_handler)
-0001a180: 0a0a 2020 2020 6465 6620 6465 6c65 7465  ..    def delete
-0001a190: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0001a1a0: 2020 2020 2020 2020 646f 6375 6d65 6e74          document
-0001a1b0: 3a20 556e 696f 6e5b 7374 722c 204a 736f  : Union[str, Jso
-0001a1c0: 6e5d 2c0a 2020 2020 2020 2020 7265 763a  n],.        rev:
-0001a1d0: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
-0001a1e0: 204e 6f6e 652c 0a20 2020 2020 2020 2063   None,.        c
-0001a1f0: 6865 636b 5f72 6576 3a20 626f 6f6c 203d  heck_rev: bool =
-0001a200: 2054 7275 652c 0a20 2020 2020 2020 2069   True,.        i
-0001a210: 676e 6f72 655f 6d69 7373 696e 673a 2062  gnore_missing: b
-0001a220: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
-0001a230: 2020 2020 2072 6574 7572 6e5f 6f6c 643a       return_old:
-0001a240: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
-0001a250: 2020 2020 2020 2073 796e 633a 204f 7074         sync: Opt
-0001a260: 696f 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f  ional[bool] = No
-0001a270: 6e65 2c0a 2020 2020 2020 2020 7369 6c65  ne,.        sile
-0001a280: 6e74 3a20 626f 6f6c 203d 2046 616c 7365  nt: bool = False
-0001a290: 2c0a 2020 2020 2020 2020 7265 6669 6c6c  ,.        refill
-0001a2a0: 5f69 6e64 6578 5f63 6163 6865 733a 204f  _index_caches: O
-0001a2b0: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
-0001a2c0: 4e6f 6e65 2c0a 2020 2020 2920 2d3e 2052  None,.    ) -> R
-0001a2d0: 6573 756c 745b 556e 696f 6e5b 626f 6f6c  esult[Union[bool
-0001a2e0: 2c20 4a73 6f6e 5d5d 3a0a 2020 2020 2020  , Json]]:.      
-0001a2f0: 2020 2222 2244 656c 6574 6520 6120 646f    """Delete a do
-0001a300: 6375 6d65 6e74 2e0a 0a20 2020 2020 2020  cument...       
-0001a310: 203a 7061 7261 6d20 646f 6375 6d65 6e74   :param document
-0001a320: 3a20 446f 6375 6d65 6e74 2049 442c 206b  : Document ID, k
-0001a330: 6579 206f 7220 626f 6479 2e20 446f 6375  ey or body. Docu
-0001a340: 6d65 6e74 2062 6f64 7920 6d75 7374 2063  ment body must c
-0001a350: 6f6e 7461 696e 0a20 2020 2020 2020 2020  ontain.         
-0001a360: 2020 2074 6865 2022 5f69 6422 206f 7220     the "_id" or 
-0001a370: 225f 6b65 7922 2066 6965 6c64 2e0a 2020  "_key" field..  
-0001a380: 2020 2020 2020 3a74 7970 6520 646f 6375        :type docu
-0001a390: 6d65 6e74 3a20 7374 7220 7c20 6469 6374  ment: str | dict
-0001a3a0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0001a3b0: 7265 763a 2045 7870 6563 7465 6420 646f  rev: Expected do
-0001a3c0: 6375 6d65 6e74 2072 6576 6973 696f 6e2e  cument revision.
-0001a3d0: 204f 7665 7272 6964 6573 2074 6865 2076   Overrides the v
-0001a3e0: 616c 7565 206f 6620 225f 7265 7622 0a20  alue of "_rev". 
-0001a3f0: 2020 2020 2020 2020 2020 2066 6965 6c64             field
-0001a400: 2069 6e20 2a2a 646f 6375 6d65 6e74 2a2a   in **document**
-0001a410: 2069 6620 7072 6573 656e 742e 0a20 2020   if present..   
-0001a420: 2020 2020 203a 7479 7065 2072 6576 3a20       :type rev: 
-0001a430: 7374 7220 7c20 4e6f 6e65 0a20 2020 2020  str | None.     
-0001a440: 2020 203a 7061 7261 6d20 6368 6563 6b5f     :param check_
-0001a450: 7265 763a 2049 6620 7365 7420 746f 2054  rev: If set to T
-0001a460: 7275 652c 2072 6576 6973 696f 6e20 6f66  rue, revision of
-0001a470: 202a 2a64 6f63 756d 656e 742a 2a20 2869   **document** (i
-0001a480: 6620 6769 7665 6e29 0a20 2020 2020 2020  f given).       
-0001a490: 2020 2020 2069 7320 636f 6d70 6172 6564       is compared
-0001a4a0: 2061 6761 696e 7374 2074 6865 2072 6576   against the rev
-0001a4b0: 6973 696f 6e20 6f66 2074 6172 6765 7420  ision of target 
-0001a4c0: 646f 6375 6d65 6e74 2e0a 2020 2020 2020  document..      
-0001a4d0: 2020 3a74 7970 6520 6368 6563 6b5f 7265    :type check_re
-0001a4e0: 763a 2062 6f6f 6c0a 2020 2020 2020 2020  v: bool.        
-0001a4f0: 3a70 6172 616d 2069 676e 6f72 655f 6d69  :param ignore_mi
-0001a500: 7373 696e 673a 2044 6f20 6e6f 7420 7261  ssing: Do not ra
-0001a510: 6973 6520 616e 2065 7863 6570 7469 6f6e  ise an exception
-0001a520: 206f 6e20 6d69 7373 696e 6720 646f 6375   on missing docu
-0001a530: 6d65 6e74 2e0a 2020 2020 2020 2020 2020  ment..          
-0001a540: 2020 5468 6973 2070 6172 616d 6574 6572    This parameter
-0001a550: 2068 6173 206e 6f20 6566 6665 6374 2069   has no effect i
-0001a560: 6e20 7472 616e 7361 6374 696f 6e73 2077  n transactions w
-0001a570: 6865 7265 2061 6e20 6578 6365 7074 696f  here an exceptio
-0001a580: 6e20 6973 0a20 2020 2020 2020 2020 2020  n is.           
-0001a590: 2061 6c77 6179 7320 7261 6973 6564 206f   always raised o
-0001a5a0: 6e20 6661 696c 7572 6573 2e0a 2020 2020  n failures..    
-0001a5b0: 2020 2020 3a74 7970 6520 6967 6e6f 7265      :type ignore
-0001a5c0: 5f6d 6973 7369 6e67 3a20 626f 6f6c 0a20  _missing: bool. 
-0001a5d0: 2020 2020 2020 203a 7061 7261 6d20 7265         :param re
-0001a5e0: 7475 726e 5f6f 6c64 3a20 496e 636c 7564  turn_old: Includ
-0001a5f0: 6520 626f 6479 206f 6620 7468 6520 6f6c  e body of the ol
-0001a600: 6420 646f 6375 6d65 6e74 2069 6e20 7468  d document in th
-0001a610: 6520 7265 7475 726e 6564 0a20 2020 2020  e returned.     
-0001a620: 2020 2020 2020 206d 6574 6164 6174 612e         metadata.
-0001a630: 2049 676e 6f72 6564 2069 6620 7061 7261   Ignored if para
-0001a640: 6d65 7465 7220 2a2a 7369 6c65 6e74 2a2a  meter **silent**
-0001a650: 2069 7320 7365 7420 746f 2054 7275 652e   is set to True.
-0001a660: 0a20 2020 2020 2020 203a 7479 7065 2072  .        :type r
-0001a670: 6574 7572 6e5f 6f6c 643a 2062 6f6f 6c0a  eturn_old: bool.
-0001a680: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
-0001a690: 796e 633a 2042 6c6f 636b 2075 6e74 696c  ync: Block until
-0001a6a0: 206f 7065 7261 7469 6f6e 2069 7320 7379   operation is sy
-0001a6b0: 6e63 6872 6f6e 697a 6564 2074 6f20 6469  nchronized to di
-0001a6c0: 736b 2e0a 2020 2020 2020 2020 3a74 7970  sk..        :typ
-0001a6d0: 6520 7379 6e63 3a20 626f 6f6c 207c 204e  e sync: bool | N
-0001a6e0: 6f6e 650a 2020 2020 2020 2020 3a70 6172  one.        :par
-0001a6f0: 616d 2073 696c 656e 743a 2049 6620 7365  am silent: If se
-0001a700: 7420 746f 2054 7275 652c 206e 6f20 646f  t to True, no do
-0001a710: 6375 6d65 6e74 206d 6574 6164 6174 6120  cument metadata 
-0001a720: 6973 2072 6574 7572 6e65 642e 2054 6869  is returned. Thi
-0001a730: 730a 2020 2020 2020 2020 2020 2020 6361  s.            ca
-0001a740: 6e20 6265 2075 7365 6420 746f 2073 6176  n be used to sav
-0001a750: 6520 7265 736f 7572 6365 732e 0a20 2020  e resources..   
-0001a760: 2020 2020 203a 7479 7065 2073 696c 656e       :type silen
-0001a770: 743a 2062 6f6f 6c0a 2020 2020 2020 2020  t: bool.        
-0001a780: 3a70 6172 616d 2072 6566 696c 6c5f 696e  :param refill_in
-0001a790: 6465 785f 6361 6368 6573 3a20 5768 6574  dex_caches: Whet
-0001a7a0: 6865 7220 746f 2061 6464 206e 6577 2065  her to add new e
-0001a7b0: 6e74 7269 6573 2074 6f20 696e 2d6d 656d  ntries to in-mem
-0001a7c0: 6f72 790a 2020 2020 2020 2020 2020 2020  ory.            
-0001a7d0: 696e 6465 7820 6361 6368 6573 2069 6620  index caches if 
-0001a7e0: 646f 6375 6d65 6e74 206f 7065 7261 7469  document operati
-0001a7f0: 6f6e 7320 6166 6665 6374 2074 6865 2065  ons affect the e
-0001a800: 6467 6520 696e 6465 7820 6f72 0a20 2020  dge index or.   
-0001a810: 2020 2020 2020 2020 2063 6163 6865 2d65           cache-e
-0001a820: 6e61 626c 6564 2070 6572 7369 7374 656e  nabled persisten
-0001a830: 7420 696e 6465 7865 732e 0a20 2020 2020  t indexes..     
-0001a840: 2020 203a 7479 7065 2072 6566 696c 6c5f     :type refill_
-0001a850: 696e 6465 785f 6361 6368 6573 3a20 626f  index_caches: bo
-0001a860: 6f6c 207c 204e 6f6e 650a 2020 2020 2020  ol | None.      
-0001a870: 2020 3a72 6574 7572 6e3a 2044 6f63 756d    :return: Docum
-0001a880: 656e 7420 6d65 7461 6461 7461 2028 652e  ent metadata (e.
-0001a890: 672e 2064 6f63 756d 656e 7420 6b65 792c  g. document key,
-0001a8a0: 2072 6576 6973 696f 6e29 2c20 6f72 2054   revision), or T
-0001a8b0: 7275 6520 6966 0a20 2020 2020 2020 2020  rue if.         
-0001a8c0: 2020 2070 6172 616d 6574 6572 202a 2a73     parameter **s
-0001a8d0: 696c 656e 742a 2a20 7761 7320 7365 7420  ilent** was set 
-0001a8e0: 746f 2054 7275 652c 206f 7220 4661 6c73  to True, or Fals
-0001a8f0: 6520 6966 2064 6f63 756d 656e 7420 7761  e if document wa
-0001a900: 7320 6e6f 740a 2020 2020 2020 2020 2020  s not.          
-0001a910: 2020 666f 756e 6420 616e 6420 2a2a 6967    found and **ig
-0001a920: 6e6f 7265 5f6d 6973 7369 6e67 2a2a 2077  nore_missing** w
-0001a930: 6173 2073 6574 2074 6f20 5472 7565 2028  as set to True (
-0001a940: 646f 6573 206e 6f74 2061 7070 6c79 2069  does not apply i
-0001a950: 6e0a 2020 2020 2020 2020 2020 2020 7472  n.            tr
-0001a960: 616e 7361 6374 696f 6e73 292e 0a20 2020  ansactions)..   
-0001a970: 2020 2020 203a 7274 7970 653a 2062 6f6f       :rtype: boo
-0001a980: 6c20 7c20 6469 6374 0a20 2020 2020 2020  l | dict.       
-0001a990: 203a 7261 6973 6520 6172 616e 676f 2e65   :raise arango.e
-0001a9a0: 7863 6570 7469 6f6e 732e 446f 6375 6d65  xceptions.Docume
-0001a9b0: 6e74 4465 6c65 7465 4572 726f 723a 2049  ntDeleteError: I
-0001a9c0: 6620 6465 6c65 7465 2066 6169 6c73 2e0a  f delete fails..
-0001a9d0: 2020 2020 2020 2020 3a72 6169 7365 2061          :raise a
-0001a9e0: 7261 6e67 6f2e 6578 6365 7074 696f 6e73  rango.exceptions
-0001a9f0: 2e44 6f63 756d 656e 7452 6576 6973 696f  .DocumentRevisio
-0001aa00: 6e45 7272 6f72 3a20 4966 2072 6576 6973  nError: If revis
-0001aa10: 696f 6e73 206d 6973 6d61 7463 682e 0a20  ions mismatch.. 
-0001aa20: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001aa30: 2020 2068 616e 646c 652c 2062 6f64 792c     handle, body,
-0001aa40: 2068 6561 6465 7273 203d 2073 656c 662e   headers = self.
-0001aa50: 5f70 7265 705f 6672 6f6d 5f64 6f63 2864  _prep_from_doc(d
-0001aa60: 6f63 756d 656e 742c 2072 6576 2c20 6368  ocument, rev, ch
-0001aa70: 6563 6b5f 7265 7629 0a0a 2020 2020 2020  eck_rev)..      
-0001aa80: 2020 7061 7261 6d73 3a20 5061 7261 6d73    params: Params
-0001aa90: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-0001aaa0: 2022 7265 7475 726e 4f6c 6422 3a20 7265   "returnOld": re
-0001aab0: 7475 726e 5f6f 6c64 2c0a 2020 2020 2020  turn_old,.      
-0001aac0: 2020 2020 2020 2269 676e 6f72 6552 6576        "ignoreRev
-0001aad0: 7322 3a20 6e6f 7420 6368 6563 6b5f 7265  s": not check_re
-0001aae0: 762c 0a20 2020 2020 2020 2020 2020 2022  v,.            "
-0001aaf0: 6f76 6572 7772 6974 6522 3a20 6e6f 7420  overwrite": not 
-0001ab00: 6368 6563 6b5f 7265 762c 0a20 2020 2020  check_rev,.     
-0001ab10: 2020 2020 2020 2022 7369 6c65 6e74 223a         "silent":
-0001ab20: 2073 696c 656e 742c 0a20 2020 2020 2020   silent,.       
-0001ab30: 207d 0a20 2020 2020 2020 2069 6620 7379   }.        if sy
-0001ab40: 6e63 2069 7320 6e6f 7420 4e6f 6e65 3a0a  nc is not None:.
-0001ab50: 2020 2020 2020 2020 2020 2020 7061 7261              para
-0001ab60: 6d73 5b22 7761 6974 466f 7253 796e 6322  ms["waitForSync"
-0001ab70: 5d20 3d20 7379 6e63 0a0a 2020 2020 2020  ] = sync..      
-0001ab80: 2020 2320 4e65 7720 696e 2041 7261 6e67    # New in Arang
-0001ab90: 6f44 4220 332e 392e 3620 616e 6420 332e  oDB 3.9.6 and 3.
-0001aba0: 3130 2e32 0a20 2020 2020 2020 2069 6620  10.2.        if 
-0001abb0: 7265 6669 6c6c 5f69 6e64 6578 5f63 6163  refill_index_cac
-0001abc0: 6865 7320 6973 206e 6f74 204e 6f6e 653a  hes is not None:
-0001abd0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
-0001abe0: 616d 735b 2272 6566 696c 6c49 6e64 6578  ams["refillIndex
-0001abf0: 4361 6368 6573 225d 203d 2072 6566 696c  Caches"] = refil
-0001ac00: 6c5f 696e 6465 785f 6361 6368 6573 0a0a  l_index_caches..
-0001ac10: 2020 2020 2020 2020 7265 7175 6573 7420          request 
-0001ac20: 3d20 5265 7175 6573 7428 0a20 2020 2020  = Request(.     
-0001ac30: 2020 2020 2020 206d 6574 686f 643d 2264         method="d
-0001ac40: 656c 6574 6522 2c0a 2020 2020 2020 2020  elete",.        
-0001ac50: 2020 2020 656e 6470 6f69 6e74 3d66 222f      endpoint=f"/
-0001ac60: 5f61 7069 2f64 6f63 756d 656e 742f 7b68  _api/document/{h
-0001ac70: 616e 646c 657d 222c 0a20 2020 2020 2020  andle}",.       
-0001ac80: 2020 2020 2070 6172 616d 733d 7061 7261       params=para
-0001ac90: 6d73 2c0a 2020 2020 2020 2020 2020 2020  ms,.            
-0001aca0: 6865 6164 6572 733d 6865 6164 6572 732c  headers=headers,
-0001acb0: 0a20 2020 2020 2020 2020 2020 2077 7269  .            wri
-0001acc0: 7465 3d73 656c 662e 6e61 6d65 2c0a 2020  te=self.name,.  
-0001acd0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0001ace0: 2064 6566 2072 6573 706f 6e73 655f 6861   def response_ha
-0001acf0: 6e64 6c65 7228 7265 7370 3a20 5265 7370  ndler(resp: Resp
-0001ad00: 6f6e 7365 2920 2d3e 2055 6e69 6f6e 5b62  onse) -> Union[b
-0001ad10: 6f6f 6c2c 204a 736f 6e5d 3a0a 2020 2020  ool, Json]:.    
-0001ad20: 2020 2020 2020 2020 6966 2072 6573 702e          if resp.
-0001ad30: 6572 726f 725f 636f 6465 203d 3d20 3132  error_code == 12
-0001ad40: 3032 2061 6e64 2069 676e 6f72 655f 6d69  02 and ignore_mi
-0001ad50: 7373 696e 673a 0a20 2020 2020 2020 2020  ssing:.         
-0001ad60: 2020 2020 2020 2072 6574 7572 6e20 4661         return Fa
-0001ad70: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-0001ad80: 6966 2072 6573 702e 7374 6174 7573 5f63  if resp.status_c
-0001ad90: 6f64 6520 3d3d 2034 3132 3a0a 2020 2020  ode == 412:.    
-0001ada0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0001adb0: 6520 446f 6375 6d65 6e74 5265 7669 7369  e DocumentRevisi
-0001adc0: 6f6e 4572 726f 7228 7265 7370 2c20 7265  onError(resp, re
-0001add0: 7175 6573 7429 0a20 2020 2020 2020 2020  quest).         
-0001ade0: 2020 2069 6620 6e6f 7420 7265 7370 2e69     if not resp.i
-0001adf0: 735f 7375 6363 6573 733a 0a20 2020 2020  s_success:.     
-0001ae00: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0001ae10: 2044 6f63 756d 656e 7444 656c 6574 6545   DocumentDeleteE
-0001ae20: 7272 6f72 2872 6573 702c 2072 6571 7565  rror(resp, reque
-0001ae30: 7374 290a 2020 2020 2020 2020 2020 2020  st).            
-0001ae40: 7265 7475 726e 2054 7275 6520 6966 2073  return True if s
-0001ae50: 696c 656e 7420 656c 7365 2072 6573 702e  ilent else resp.
-0001ae60: 626f 6479 0a0a 2020 2020 2020 2020 7265  body..        re
-0001ae70: 7475 726e 2073 656c 662e 5f65 7865 6375  turn self._execu
-0001ae80: 7465 2872 6571 7565 7374 2c20 7265 7370  te(request, resp
-0001ae90: 6f6e 7365 5f68 616e 646c 6572 290a 0a0a  onse_handler)...
-0001aea0: 636c 6173 7320 5665 7274 6578 436f 6c6c  class VertexColl
-0001aeb0: 6563 7469 6f6e 2843 6f6c 6c65 6374 696f  ection(Collectio
-0001aec0: 6e29 3a0a 2020 2020 2222 2256 6572 7465  n):.    """Verte
-0001aed0: 7820 636f 6c6c 6563 7469 6f6e 2041 5049  x collection API
-0001aee0: 2077 7261 7070 6572 2e0a 0a20 2020 203a   wrapper...    :
-0001aef0: 7061 7261 6d20 636f 6e6e 6563 7469 6f6e  param connection
-0001af00: 3a20 4854 5450 2063 6f6e 6e65 6374 696f  : HTTP connectio
-0001af10: 6e2e 0a20 2020 203a 7061 7261 6d20 6578  n..    :param ex
-0001af20: 6563 7574 6f72 3a20 4150 4920 6578 6563  ecutor: API exec
-0001af30: 7574 6f72 2e0a 2020 2020 3a70 6172 616d  utor..    :param
-0001af40: 2067 7261 7068 3a20 4772 6170 6820 6e61   graph: Graph na
-0001af50: 6d65 2e0a 2020 2020 3a70 6172 616d 206e  me..    :param n
-0001af60: 616d 653a 2056 6572 7465 7820 636f 6c6c  ame: Vertex coll
-0001af70: 6563 7469 6f6e 206e 616d 652e 0a20 2020  ection name..   
-0001af80: 2022 2222 0a0a 2020 2020 6465 6620 5f5f   """..    def __
-0001af90: 696e 6974 5f5f 280a 2020 2020 2020 2020  init__(.        
-0001afa0: 7365 6c66 2c20 636f 6e6e 6563 7469 6f6e  self, connection
-0001afb0: 3a20 436f 6e6e 6563 7469 6f6e 2c20 6578  : Connection, ex
-0001afc0: 6563 7574 6f72 3a20 4170 6945 7865 6375  ecutor: ApiExecu
-0001afd0: 746f 722c 2067 7261 7068 3a20 7374 722c  tor, graph: str,
-0001afe0: 206e 616d 653a 2073 7472 0a20 2020 2029   name: str.    )
-0001aff0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-0001b000: 2020 7375 7065 7228 292e 5f5f 696e 6974    super().__init
-0001b010: 5f5f 2863 6f6e 6e65 6374 696f 6e2c 2065  __(connection, e
-0001b020: 7865 6375 746f 722c 206e 616d 6529 0a20  xecutor, name). 
-0001b030: 2020 2020 2020 2073 656c 662e 5f67 7261         self._gra
-0001b040: 7068 203d 2067 7261 7068 0a0a 2020 2020  ph = graph..    
-0001b050: 6465 6620 5f5f 7265 7072 5f5f 2873 656c  def __repr__(sel
-0001b060: 6629 202d 3e20 7374 723a 0a20 2020 2020  f) -> str:.     
-0001b070: 2020 2072 6574 7572 6e20 6622 3c56 6572     return f"<Ver
-0001b080: 7465 7843 6f6c 6c65 6374 696f 6e20 7b73  texCollection {s
-0001b090: 656c 662e 6e61 6d65 7d3e 220a 0a20 2020  elf.name}>"..   
-0001b0a0: 2064 6566 205f 5f67 6574 6974 656d 5f5f   def __getitem__
-0001b0b0: 2873 656c 662c 206b 6579 3a20 556e 696f  (self, key: Unio
-0001b0c0: 6e5b 7374 722c 204a 736f 6e5d 2920 2d3e  n[str, Json]) ->
-0001b0d0: 2052 6573 756c 745b 4f70 7469 6f6e 616c   Result[Optional
-0001b0e0: 5b4a 736f 6e5d 5d3a 0a20 2020 2020 2020  [Json]]:.       
-0001b0f0: 2072 6574 7572 6e20 7365 6c66 2e67 6574   return self.get
-0001b100: 286b 6579 290a 0a20 2020 2040 7072 6f70  (key)..    @prop
-0001b110: 6572 7479 0a20 2020 2064 6566 2067 7261  erty.    def gra
-0001b120: 7068 2873 656c 6629 202d 3e20 7374 723a  ph(self) -> str:
-0001b130: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-0001b140: 726e 2074 6865 2067 7261 7068 206e 616d  rn the graph nam
-0001b150: 652e 0a0a 2020 2020 2020 2020 3a72 6574  e...        :ret
-0001b160: 7572 6e3a 2047 7261 7068 206e 616d 652e  urn: Graph name.
-0001b170: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
-0001b180: 2073 7472 0a20 2020 2020 2020 2022 2222   str.        """
-0001b190: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001b1a0: 7365 6c66 2e5f 6772 6170 680a 0a20 2020  self._graph..   
-0001b1b0: 2064 6566 2067 6574 280a 2020 2020 2020   def get(.      
-0001b1c0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-0001b1d0: 7665 7274 6578 3a20 556e 696f 6e5b 7374  vertex: Union[st
-0001b1e0: 722c 204a 736f 6e5d 2c0a 2020 2020 2020  r, Json],.      
-0001b1f0: 2020 7265 763a 204f 7074 696f 6e61 6c5b    rev: Optional[
-0001b200: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
-0001b210: 2020 2020 2063 6865 636b 5f72 6576 3a20       check_rev: 
-0001b220: 626f 6f6c 203d 2054 7275 652c 0a20 2020  bool = True,.   
-0001b230: 2029 202d 3e20 5265 7375 6c74 5b4f 7074   ) -> Result[Opt
-0001b240: 696f 6e61 6c5b 4a73 6f6e 5d5d 3a0a 2020  ional[Json]]:.  
-0001b250: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
-0001b260: 6120 7665 7274 6578 2064 6f63 756d 656e  a vertex documen
-0001b270: 742e 0a0a 2020 2020 2020 2020 3a70 6172  t...        :par
-0001b280: 616d 2076 6572 7465 783a 2056 6572 7465  am vertex: Verte
-0001b290: 7820 646f 6375 6d65 6e74 2049 442c 206b  x document ID, k
-0001b2a0: 6579 206f 7220 626f 6479 2e20 446f 6375  ey or body. Docu
-0001b2b0: 6d65 6e74 2062 6f64 7920 6d75 7374 0a20  ment body must. 
-0001b2c0: 2020 2020 2020 2020 2020 2063 6f6e 7461             conta
-0001b2d0: 696e 2074 6865 2022 5f69 6422 206f 7220  in the "_id" or 
-0001b2e0: 225f 6b65 7922 2066 6965 6c64 2e0a 2020  "_key" field..  
-0001b2f0: 2020 2020 2020 3a74 7970 6520 7665 7274        :type vert
-0001b300: 6578 3a20 7374 7220 7c20 6469 6374 0a20  ex: str | dict. 
-0001b310: 2020 2020 2020 203a 7061 7261 6d20 7265         :param re
-0001b320: 763a 2045 7870 6563 7465 6420 646f 6375  v: Expected docu
-0001b330: 6d65 6e74 2072 6576 6973 696f 6e2e 204f  ment revision. O
-0001b340: 7665 7272 6964 6573 2074 6865 2076 616c  verrides the val
-0001b350: 7565 206f 6620 225f 7265 7622 0a20 2020  ue of "_rev".   
-0001b360: 2020 2020 2020 2020 2066 6965 6c64 2069           field i
-0001b370: 6e20 2a2a 7665 7274 6578 2a2a 2069 6620  n **vertex** if 
-0001b380: 7072 6573 656e 742e 0a20 2020 2020 2020  present..       
-0001b390: 203a 7479 7065 2072 6576 3a20 7374 7220   :type rev: str 
-0001b3a0: 7c20 4e6f 6e65 0a20 2020 2020 2020 203a  | None.        :
-0001b3b0: 7061 7261 6d20 6368 6563 6b5f 7265 763a  param check_rev:
-0001b3c0: 2049 6620 7365 7420 746f 2054 7275 652c   If set to True,
-0001b3d0: 2072 6576 6973 696f 6e20 6f66 202a 2a76   revision of **v
-0001b3e0: 6572 7465 782a 2a20 2869 6620 6769 7665  ertex** (if give
-0001b3f0: 6e29 2069 730a 2020 2020 2020 2020 2020  n) is.          
-0001b400: 2020 636f 6d70 6172 6564 2061 6761 696e    compared again
-0001b410: 7374 2074 6865 2072 6576 6973 696f 6e20  st the revision 
-0001b420: 6f66 2074 6172 6765 7420 7665 7274 6578  of target vertex
-0001b430: 2064 6f63 756d 656e 742e 0a20 2020 2020   document..     
-0001b440: 2020 203a 7479 7065 2063 6865 636b 5f72     :type check_r
-0001b450: 6576 3a20 626f 6f6c 0a20 2020 2020 2020  ev: bool.       
-0001b460: 203a 7265 7475 726e 3a20 5665 7274 6578   :return: Vertex
-0001b470: 2064 6f63 756d 656e 7420 6f72 204e 6f6e   document or Non
-0001b480: 6520 6966 206e 6f74 2066 6f75 6e64 2e0a  e if not found..
-0001b490: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
-0001b4a0: 6469 6374 207c 204e 6f6e 650a 2020 2020  dict | None.    
-0001b4b0: 2020 2020 3a72 6169 7365 2061 7261 6e67      :raise arang
-0001b4c0: 6f2e 6578 6365 7074 696f 6e73 2e44 6f63  o.exceptions.Doc
-0001b4d0: 756d 656e 7447 6574 4572 726f 723a 2049  umentGetError: I
-0001b4e0: 6620 7265 7472 6965 7661 6c20 6661 696c  f retrieval fail
-0001b4f0: 732e 0a20 2020 2020 2020 203a 7261 6973  s..        :rais
-0001b500: 6520 6172 616e 676f 2e65 7863 6570 7469  e arango.excepti
-0001b510: 6f6e 732e 446f 6375 6d65 6e74 5265 7669  ons.DocumentRevi
-0001b520: 7369 6f6e 4572 726f 723a 2049 6620 7265  sionError: If re
-0001b530: 7669 7369 6f6e 7320 6d69 736d 6174 6368  visions mismatch
-0001b540: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0001b550: 2020 2020 2020 6861 6e64 6c65 2c20 626f        handle, bo
-0001b560: 6479 2c20 6865 6164 6572 7320 3d20 7365  dy, headers = se
-0001b570: 6c66 2e5f 7072 6570 5f66 726f 6d5f 646f  lf._prep_from_do
-0001b580: 6328 7665 7274 6578 2c20 7265 762c 2063  c(vertex, rev, c
-0001b590: 6865 636b 5f72 6576 290a 0a20 2020 2020  heck_rev)..     
-0001b5a0: 2020 2072 6571 7565 7374 203d 2052 6571     request = Req
-0001b5b0: 7565 7374 280a 2020 2020 2020 2020 2020  uest(.          
-0001b5c0: 2020 6d65 7468 6f64 3d22 6765 7422 2c0a    method="get",.
-0001b5d0: 2020 2020 2020 2020 2020 2020 656e 6470              endp
-0001b5e0: 6f69 6e74 3d66 222f 5f61 7069 2f67 6861  oint=f"/_api/gha
-0001b5f0: 7269 616c 2f7b 7365 6c66 2e5f 6772 6170  rial/{self._grap
-0001b600: 687d 2f76 6572 7465 782f 7b68 616e 646c  h}/vertex/{handl
-0001b610: 657d 222c 0a20 2020 2020 2020 2020 2020  e}",.           
-0001b620: 2068 6561 6465 7273 3d68 6561 6465 7273   headers=headers
-0001b630: 2c0a 2020 2020 2020 2020 2020 2020 7265  ,.            re
-0001b640: 6164 3d73 656c 662e 6e61 6d65 2c0a 2020  ad=self.name,.  
-0001b650: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0001b660: 2064 6566 2072 6573 706f 6e73 655f 6861   def response_ha
-0001b670: 6e64 6c65 7228 7265 7370 3a20 5265 7370  ndler(resp: Resp
-0001b680: 6f6e 7365 2920 2d3e 204f 7074 696f 6e61  onse) -> Optiona
-0001b690: 6c5b 4a73 6f6e 5d3a 0a20 2020 2020 2020  l[Json]:.       
-0001b6a0: 2020 2020 2069 6620 7265 7370 2e65 7272       if resp.err
-0001b6b0: 6f72 5f63 6f64 6520 3d3d 2031 3230 323a  or_code == 1202:
-0001b6c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b6d0: 2072 6574 7572 6e20 4e6f 6e65 0a20 2020   return None.   
-0001b6e0: 2020 2020 2020 2020 2069 6620 7265 7370           if resp
-0001b6f0: 2e73 7461 7475 735f 636f 6465 203d 3d20  .status_code == 
-0001b700: 3431 323a 0a20 2020 2020 2020 2020 2020  412:.           
-0001b710: 2020 2020 2072 6169 7365 2044 6f63 756d       raise Docum
-0001b720: 656e 7452 6576 6973 696f 6e45 7272 6f72  entRevisionError
-0001b730: 2872 6573 702c 2072 6571 7565 7374 290a  (resp, request).
-0001b740: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-0001b750: 6f74 2072 6573 702e 6973 5f73 7563 6365  ot resp.is_succe
-0001b760: 7373 3a0a 2020 2020 2020 2020 2020 2020  ss:.            
-0001b770: 2020 2020 7261 6973 6520 446f 6375 6d65      raise Docume
-0001b780: 6e74 4765 7445 7272 6f72 2872 6573 702c  ntGetError(resp,
-0001b790: 2072 6571 7565 7374 290a 2020 2020 2020   request).      
-0001b7a0: 2020 2020 2020 7265 7375 6c74 3a20 4a73        result: Js
-0001b7b0: 6f6e 203d 2072 6573 702e 626f 6479 5b22  on = resp.body["
-0001b7c0: 7665 7274 6578 225d 0a20 2020 2020 2020  vertex"].       
-0001b7d0: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
-0001b7e0: 6c74 0a0a 2020 2020 2020 2020 7265 7475  lt..        retu
-0001b7f0: 726e 2073 656c 662e 5f65 7865 6375 7465  rn self._execute
-0001b800: 2872 6571 7565 7374 2c20 7265 7370 6f6e  (request, respon
-0001b810: 7365 5f68 616e 646c 6572 290a 0a20 2020  se_handler)..   
-0001b820: 2064 6566 2069 6e73 6572 7428 0a20 2020   def insert(.   
-0001b830: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0001b840: 2020 2076 6572 7465 783a 204a 736f 6e2c     vertex: Json,
-0001b850: 0a20 2020 2020 2020 2073 796e 633a 204f  .        sync: O
-0001b860: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
-0001b870: 4e6f 6e65 2c0a 2020 2020 2020 2020 7369  None,.        si
-0001b880: 6c65 6e74 3a20 626f 6f6c 203d 2046 616c  lent: bool = Fal
-0001b890: 7365 2c0a 2020 2020 2020 2020 7265 7475  se,.        retu
-0001b8a0: 726e 5f6e 6577 3a20 626f 6f6c 203d 2046  rn_new: bool = F
-0001b8b0: 616c 7365 2c0a 2020 2020 2920 2d3e 2052  alse,.    ) -> R
-0001b8c0: 6573 756c 745b 556e 696f 6e5b 626f 6f6c  esult[Union[bool
-0001b8d0: 2c20 4a73 6f6e 5d5d 3a0a 2020 2020 2020  , Json]]:.      
-0001b8e0: 2020 2222 2249 6e73 6572 7420 6120 6e65    """Insert a ne
-0001b8f0: 7720 7665 7274 6578 2064 6f63 756d 656e  w vertex documen
-0001b900: 742e 0a0a 2020 2020 2020 2020 3a70 6172  t...        :par
-0001b910: 616d 2076 6572 7465 783a 204e 6577 2076  am vertex: New v
-0001b920: 6572 7465 7820 646f 6375 6d65 6e74 2074  ertex document t
-0001b930: 6f20 696e 7365 7274 2e20 4966 2069 7420  o insert. If it 
-0001b940: 6861 7320 225f 6b65 7922 206f 7220 225f  has "_key" or "_
-0001b950: 6964 220a 2020 2020 2020 2020 2020 2020  id".            
-0001b960: 6669 656c 642c 2069 7473 2076 616c 7565  field, its value
-0001b970: 2069 7320 7573 6564 2061 7320 6b65 7920   is used as key 
-0001b980: 6f66 2074 6865 206e 6577 2076 6572 7465  of the new verte
-0001b990: 7820 286f 7468 6572 7769 7365 2069 7420  x (otherwise it 
-0001b9a0: 6973 0a20 2020 2020 2020 2020 2020 2061  is.            a
-0001b9b0: 7574 6f2d 6765 6e65 7261 7465 6429 2e20  uto-generated). 
-0001b9c0: 416e 7920 225f 7265 7622 2066 6965 6c64  Any "_rev" field
-0001b9d0: 2069 7320 6967 6e6f 7265 642e 0a20 2020   is ignored..   
-0001b9e0: 2020 2020 203a 7479 7065 2076 6572 7465       :type verte
-0001b9f0: 783a 2064 6963 740a 2020 2020 2020 2020  x: dict.        
-0001ba00: 3a70 6172 616d 2073 796e 633a 2042 6c6f  :param sync: Blo
-0001ba10: 636b 2075 6e74 696c 206f 7065 7261 7469  ck until operati
-0001ba20: 6f6e 2069 7320 7379 6e63 6872 6f6e 697a  on is synchroniz
-0001ba30: 6564 2074 6f20 6469 736b 2e0a 2020 2020  ed to disk..    
-0001ba40: 2020 2020 3a74 7970 6520 7379 6e63 3a20      :type sync: 
-0001ba50: 626f 6f6c 207c 204e 6f6e 650a 2020 2020  bool | None.    
-0001ba60: 2020 2020 3a70 6172 616d 2073 696c 656e      :param silen
-0001ba70: 743a 2049 6620 7365 7420 746f 2054 7275  t: If set to Tru
-0001ba80: 652c 206e 6f20 646f 6375 6d65 6e74 206d  e, no document m
-0001ba90: 6574 6164 6174 6120 6973 2072 6574 7572  etadata is retur
-0001baa0: 6e65 642e 2054 6869 730a 2020 2020 2020  ned. This.      
-0001bab0: 2020 2020 2020 6361 6e20 6265 2075 7365        can be use
-0001bac0: 6420 746f 2073 6176 6520 7265 736f 7572  d to save resour
-0001bad0: 6365 732e 0a20 2020 2020 2020 203a 7479  ces..        :ty
-0001bae0: 7065 2073 696c 656e 743a 2062 6f6f 6c0a  pe silent: bool.
-0001baf0: 2020 2020 2020 2020 3a70 6172 616d 2072          :param r
-0001bb00: 6574 7572 6e5f 6e65 773a 2049 6e63 6c75  eturn_new: Inclu
-0001bb10: 6465 2062 6f64 7920 6f66 2074 6865 206e  de body of the n
-0001bb20: 6577 2064 6f63 756d 656e 7420 696e 2074  ew document in t
-0001bb30: 6865 2072 6574 7572 6e65 640a 2020 2020  he returned.    
-0001bb40: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
-0001bb50: 2e20 4967 6e6f 7265 6420 6966 2070 6172  . Ignored if par
-0001bb60: 616d 6574 6572 202a 2a73 696c 656e 742a  ameter **silent*
-0001bb70: 2a20 6973 2073 6574 2074 6f20 5472 7565  * is set to True
-0001bb80: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
-0001bb90: 7265 7475 726e 5f6e 6577 3a20 626f 6f6c  return_new: bool
-0001bba0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-0001bbb0: 3a20 446f 6375 6d65 6e74 206d 6574 6164  : Document metad
-0001bbc0: 6174 6120 2865 2e67 2e20 646f 6375 6d65  ata (e.g. docume
-0001bbd0: 6e74 206b 6579 2c20 7265 7669 7369 6f6e  nt key, revision
-0001bbe0: 292c 206f 7220 5472 7565 2069 660a 2020  ), or True if.  
-0001bbf0: 2020 2020 2020 2020 2020 7061 7261 6d65            parame
-0001bc00: 7465 7220 2a2a 7369 6c65 6e74 2a2a 2077  ter **silent** w
-0001bc10: 6173 2073 6574 2074 6f20 5472 7565 2e0a  as set to True..
-0001bc20: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
-0001bc30: 626f 6f6c 207c 2064 6963 740a 2020 2020  bool | dict.    
-0001bc40: 2020 2020 3a72 6169 7365 2061 7261 6e67      :raise arang
-0001bc50: 6f2e 6578 6365 7074 696f 6e73 2e44 6f63  o.exceptions.Doc
-0001bc60: 756d 656e 7449 6e73 6572 7445 7272 6f72  umentInsertError
-0001bc70: 3a20 4966 2069 6e73 6572 7420 6661 696c  : If insert fail
-0001bc80: 732e 0a20 2020 2020 2020 2022 2222 0a20  s..        """. 
-0001bc90: 2020 2020 2020 2076 6572 7465 7820 3d20         vertex = 
-0001bca0: 7365 6c66 2e5f 656e 7375 7265 5f6b 6579  self._ensure_key
-0001bcb0: 5f66 726f 6d5f 6964 2876 6572 7465 7829  _from_id(vertex)
-0001bcc0: 0a0a 2020 2020 2020 2020 7061 7261 6d73  ..        params
-0001bcd0: 3a20 5061 7261 6d73 203d 207b 2273 696c  : Params = {"sil
-0001bce0: 656e 7422 3a20 7369 6c65 6e74 2c20 2272  ent": silent, "r
-0001bcf0: 6574 7572 6e4e 6577 223a 2072 6574 7572  eturnNew": retur
-0001bd00: 6e5f 6e65 777d 0a20 2020 2020 2020 2069  n_new}.        i
-0001bd10: 6620 7379 6e63 2069 7320 6e6f 7420 4e6f  f sync is not No
-0001bd20: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0001bd30: 7061 7261 6d73 5b22 7761 6974 466f 7253  params["waitForS
-0001bd40: 796e 6322 5d20 3d20 7379 6e63 0a0a 2020  ync"] = sync..  
-0001bd50: 2020 2020 2020 7265 7175 6573 7420 3d20        request = 
-0001bd60: 5265 7175 6573 7428 0a20 2020 2020 2020  Request(.       
-0001bd70: 2020 2020 206d 6574 686f 643d 2270 6f73       method="pos
-0001bd80: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
-0001bd90: 656e 6470 6f69 6e74 3d66 222f 5f61 7069  endpoint=f"/_api
-0001bda0: 2f67 6861 7269 616c 2f7b 7365 6c66 2e5f  /gharial/{self._
-0001bdb0: 6772 6170 687d 2f76 6572 7465 782f 7b73  graph}/vertex/{s
-0001bdc0: 656c 662e 6e61 6d65 7d22 2c0a 2020 2020  elf.name}",.    
-0001bdd0: 2020 2020 2020 2020 6461 7461 3d76 6572          data=ver
-0001bde0: 7465 782c 0a20 2020 2020 2020 2020 2020  tex,.           
-0001bdf0: 2070 6172 616d 733d 7061 7261 6d73 2c0a   params=params,.
-0001be00: 2020 2020 2020 2020 2020 2020 7772 6974              writ
-0001be10: 653d 7365 6c66 2e6e 616d 652c 0a20 2020  e=self.name,.   
-0001be20: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-0001be30: 6465 6620 7265 7370 6f6e 7365 5f68 616e  def response_han
-0001be40: 646c 6572 2872 6573 703a 2052 6573 706f  dler(resp: Respo
-0001be50: 6e73 6529 202d 3e20 556e 696f 6e5b 626f  nse) -> Union[bo
-0001be60: 6f6c 2c20 4a73 6f6e 5d3a 0a20 2020 2020  ol, Json]:.     
-0001be70: 2020 2020 2020 2069 6620 6e6f 7420 7265         if not re
-0001be80: 7370 2e69 735f 7375 6363 6573 733a 0a20  sp.is_success:. 
-0001be90: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0001bea0: 6169 7365 2044 6f63 756d 656e 7449 6e73  aise DocumentIns
-0001beb0: 6572 7445 7272 6f72 2872 6573 702c 2072  ertError(resp, r
-0001bec0: 6571 7565 7374 290a 2020 2020 2020 2020  equest).        
-0001bed0: 2020 2020 6966 2073 696c 656e 743a 0a20      if silent:. 
-0001bee0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0001bef0: 6574 7572 6e20 5472 7565 0a20 2020 2020  eturn True.     
-0001bf00: 2020 2020 2020 2072 6574 7572 6e20 666f         return fo
-0001bf10: 726d 6174 5f76 6572 7465 7828 7265 7370  rmat_vertex(resp
-0001bf20: 2e62 6f64 7929 0a0a 2020 2020 2020 2020  .body)..        
-0001bf30: 7265 7475 726e 2073 656c 662e 5f65 7865  return self._exe
-0001bf40: 6375 7465 2872 6571 7565 7374 2c20 7265  cute(request, re
-0001bf50: 7370 6f6e 7365 5f68 616e 646c 6572 290a  sponse_handler).
-0001bf60: 0a20 2020 2064 6566 2075 7064 6174 6528  .    def update(
-0001bf70: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0001bf80: 2020 2020 2020 2076 6572 7465 783a 204a         vertex: J
-0001bf90: 736f 6e2c 0a20 2020 2020 2020 2063 6865  son,.        che
-0001bfa0: 636b 5f72 6576 3a20 626f 6f6c 203d 2054  ck_rev: bool = T
-0001bfb0: 7275 652c 0a20 2020 2020 2020 206b 6565  rue,.        kee
-0001bfc0: 705f 6e6f 6e65 3a20 626f 6f6c 203d 2054  p_none: bool = T
-0001bfd0: 7275 652c 0a20 2020 2020 2020 2073 796e  rue,.        syn
-0001bfe0: 633a 204f 7074 696f 6e61 6c5b 626f 6f6c  c: Optional[bool
-0001bff0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-0001c000: 2020 7369 6c65 6e74 3a20 626f 6f6c 203d    silent: bool =
-0001c010: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
-0001c020: 7265 7475 726e 5f6f 6c64 3a20 626f 6f6c  return_old: bool
-0001c030: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
-0001c040: 2020 7265 7475 726e 5f6e 6577 3a20 626f    return_new: bo
-0001c050: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
-0001c060: 2920 2d3e 2052 6573 756c 745b 556e 696f  ) -> Result[Unio
-0001c070: 6e5b 626f 6f6c 2c20 4a73 6f6e 5d5d 3a0a  n[bool, Json]]:.
-0001c080: 2020 2020 2020 2020 2222 2255 7064 6174          """Updat
-0001c090: 6520 6120 7665 7274 6578 2064 6f63 756d  e a vertex docum
-0001c0a0: 656e 742e 0a0a 2020 2020 2020 2020 3a70  ent...        :p
-0001c0b0: 6172 616d 2076 6572 7465 783a 2050 6172  aram vertex: Par
-0001c0c0: 7469 616c 206f 7220 6675 6c6c 2076 6572  tial or full ver
-0001c0d0: 7465 7820 646f 6375 6d65 6e74 2077 6974  tex document wit
-0001c0e0: 6820 7570 6461 7465 6420 7661 6c75 6573  h updated values
-0001c0f0: 2e20 4974 0a20 2020 2020 2020 2020 2020  . It.           
-0001c100: 206d 7573 7420 636f 6e74 6169 6e20 7468   must contain th
-0001c110: 6520 225f 6b65 7922 206f 7220 225f 6964  e "_key" or "_id
-0001c120: 2220 6669 656c 642e 0a20 2020 2020 2020  " field..       
-0001c130: 203a 7479 7065 2076 6572 7465 783a 2064   :type vertex: d
-0001c140: 6963 740a 2020 2020 2020 2020 3a70 6172  ict.        :par
-0001c150: 616d 2063 6865 636b 5f72 6576 3a20 4966  am check_rev: If
-0001c160: 2073 6574 2074 6f20 5472 7565 2c20 7265   set to True, re
-0001c170: 7669 7369 6f6e 206f 6620 2a2a 7665 7274  vision of **vert
-0001c180: 6578 2a2a 2028 6966 2067 6976 656e 2920  ex** (if given) 
-0001c190: 6973 0a20 2020 2020 2020 2020 2020 2063  is.            c
-0001c1a0: 6f6d 7061 7265 6420 6167 6169 6e73 7420  ompared against 
-0001c1b0: 7468 6520 7265 7669 7369 6f6e 206f 6620  the revision of 
-0001c1c0: 7461 7267 6574 2076 6572 7465 7820 646f  target vertex do
-0001c1d0: 6375 6d65 6e74 2e0a 2020 2020 2020 2020  cument..        
-0001c1e0: 3a74 7970 6520 6368 6563 6b5f 7265 763a  :type check_rev:
-0001c1f0: 2062 6f6f 6c0a 2020 2020 2020 2020 3a70   bool.        :p
-0001c200: 6172 616d 206b 6565 705f 6e6f 6e65 3a20  aram keep_none: 
-0001c210: 4966 2073 6574 2074 6f20 5472 7565 2c20  If set to True, 
-0001c220: 6669 656c 6473 2077 6974 6820 7661 6c75  fields with valu
-0001c230: 6520 4e6f 6e65 2061 7265 2072 6574 6169  e None are retai
-0001c240: 6e65 640a 2020 2020 2020 2020 2020 2020  ned.            
-0001c250: 696e 2074 6865 2064 6f63 756d 656e 742e  in the document.
-0001c260: 2049 6620 7365 7420 746f 2046 616c 7365   If set to False
-0001c270: 2c20 7468 6579 2061 7265 2072 656d 6f76  , they are remov
-0001c280: 6564 2063 6f6d 706c 6574 656c 792e 0a20  ed completely.. 
-0001c290: 2020 2020 2020 203a 7479 7065 206b 6565         :type kee
-0001c2a0: 705f 6e6f 6e65 3a20 626f 6f6c 207c 204e  p_none: bool | N
-0001c2b0: 6f6e 650a 2020 2020 2020 2020 3a70 6172  one.        :par
-0001c2c0: 616d 2073 796e 633a 2042 6c6f 636b 2075  am sync: Block u
-0001c2d0: 6e74 696c 206f 7065 7261 7469 6f6e 2069  ntil operation i
-0001c2e0: 7320 7379 6e63 6872 6f6e 697a 6564 2074  s synchronized t
-0001c2f0: 6f20 6469 736b 2e0a 2020 2020 2020 2020  o disk..        
-0001c300: 3a74 7970 6520 7379 6e63 3a20 626f 6f6c  :type sync: bool
-0001c310: 207c 204e 6f6e 650a 2020 2020 2020 2020   | None.        
-0001c320: 3a70 6172 616d 2073 696c 656e 743a 2049  :param silent: I
-0001c330: 6620 7365 7420 746f 2054 7275 652c 206e  f set to True, n
-0001c340: 6f20 646f 6375 6d65 6e74 206d 6574 6164  o document metad
-0001c350: 6174 6120 6973 2072 6574 7572 6e65 642e  ata is returned.
-0001c360: 2054 6869 730a 2020 2020 2020 2020 2020   This.          
-0001c370: 2020 6361 6e20 6265 2075 7365 6420 746f    can be used to
-0001c380: 2073 6176 6520 7265 736f 7572 6365 732e   save resources.
-0001c390: 0a20 2020 2020 2020 203a 7479 7065 2073  .        :type s
-0001c3a0: 696c 656e 743a 2062 6f6f 6c0a 2020 2020  ilent: bool.    
-0001c3b0: 2020 2020 3a70 6172 616d 2072 6574 7572      :param retur
-0001c3c0: 6e5f 6f6c 643a 2049 6e63 6c75 6465 2062  n_old: Include b
-0001c3d0: 6f64 7920 6f66 2074 6865 206f 6c64 2064  ody of the old d
-0001c3e0: 6f63 756d 656e 7420 696e 2074 6865 2072  ocument in the r
-0001c3f0: 6574 7572 6e65 640a 2020 2020 2020 2020  eturned.        
-0001c400: 2020 2020 6d65 7461 6461 7461 2e20 4967      metadata. Ig
-0001c410: 6e6f 7265 6420 6966 2070 6172 616d 6574  nored if paramet
-0001c420: 6572 202a 2a73 696c 656e 742a 2a20 6973  er **silent** is
-0001c430: 2073 6574 2074 6f20 5472 7565 2e0a 2020   set to True..  
-0001c440: 2020 2020 2020 3a74 7970 6520 7265 7475        :type retu
-0001c450: 726e 5f6f 6c64 3a20 626f 6f6c 0a20 2020  rn_old: bool.   
-0001c460: 2020 2020 203a 7061 7261 6d20 7265 7475       :param retu
-0001c470: 726e 5f6e 6577 3a20 496e 636c 7564 6520  rn_new: Include 
-0001c480: 626f 6479 206f 6620 7468 6520 6e65 7720  body of the new 
-0001c490: 646f 6375 6d65 6e74 2069 6e20 7468 6520  document in the 
-0001c4a0: 7265 7475 726e 6564 0a20 2020 2020 2020  returned.       
-0001c4b0: 2020 2020 206d 6574 6164 6174 612e 2049       metadata. I
-0001c4c0: 676e 6f72 6564 2069 6620 7061 7261 6d65  gnored if parame
-0001c4d0: 7465 7220 2a2a 7369 6c65 6e74 2a2a 2069  ter **silent** i
-0001c4e0: 7320 7365 7420 746f 2054 7275 652e 0a20  s set to True.. 
-0001c4f0: 2020 2020 2020 203a 7479 7065 2072 6574         :type ret
-0001c500: 7572 6e5f 6e65 773a 2062 6f6f 6c0a 2020  urn_new: bool.  
-0001c510: 2020 2020 2020 3a72 6574 7572 6e3a 2044        :return: D
-0001c520: 6f63 756d 656e 7420 6d65 7461 6461 7461  ocument metadata
-0001c530: 2028 652e 672e 2064 6f63 756d 656e 7420   (e.g. document 
-0001c540: 6b65 792c 2072 6576 6973 696f 6e29 206f  key, revision) o
-0001c550: 7220 5472 7565 2069 660a 2020 2020 2020  r True if.      
-0001c560: 2020 2020 2020 7061 7261 6d65 7465 7220        parameter 
-0001c570: 2a2a 7369 6c65 6e74 2a2a 2077 6173 2073  **silent** was s
-0001c580: 6574 2074 6f20 5472 7565 2e0a 2020 2020  et to True..    
-0001c590: 2020 2020 3a72 7479 7065 3a20 626f 6f6c      :rtype: bool
-0001c5a0: 207c 2064 6963 740a 2020 2020 2020 2020   | dict.        
-0001c5b0: 3a72 6169 7365 2061 7261 6e67 6f2e 6578  :raise arango.ex
-0001c5c0: 6365 7074 696f 6e73 2e44 6f63 756d 656e  ceptions.Documen
-0001c5d0: 7455 7064 6174 6545 7272 6f72 3a20 4966  tUpdateError: If
-0001c5e0: 2075 7064 6174 6520 6661 696c 732e 0a20   update fails.. 
-0001c5f0: 2020 2020 2020 203a 7261 6973 6520 6172         :raise ar
-0001c600: 616e 676f 2e65 7863 6570 7469 6f6e 732e  ango.exceptions.
-0001c610: 446f 6375 6d65 6e74 5265 7669 7369 6f6e  DocumentRevision
-0001c620: 4572 726f 723a 2049 6620 7265 7669 7369  Error: If revisi
-0001c630: 6f6e 7320 6d69 736d 6174 6368 2e0a 2020  ons mismatch..  
-0001c640: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001c650: 2020 7665 7274 6578 5f69 642c 2068 6561    vertex_id, hea
-0001c660: 6465 7273 203d 2073 656c 662e 5f70 7265  ders = self._pre
-0001c670: 705f 6672 6f6d 5f62 6f64 7928 7665 7274  p_from_body(vert
-0001c680: 6578 2c20 6368 6563 6b5f 7265 7629 0a0a  ex, check_rev)..
-0001c690: 2020 2020 2020 2020 7061 7261 6d73 3a20          params: 
-0001c6a0: 5061 7261 6d73 203d 207b 0a20 2020 2020  Params = {.     
-0001c6b0: 2020 2020 2020 2022 6b65 6570 4e75 6c6c         "keepNull
-0001c6c0: 223a 206b 6565 705f 6e6f 6e65 2c0a 2020  ": keep_none,.  
-0001c6d0: 2020 2020 2020 2020 2020 226f 7665 7277            "overw
-0001c6e0: 7269 7465 223a 206e 6f74 2063 6865 636b  rite": not check
-0001c6f0: 5f72 6576 2c0a 2020 2020 2020 2020 2020  _rev,.          
-0001c700: 2020 2273 696c 656e 7422 3a20 7369 6c65    "silent": sile
-0001c710: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
-0001c720: 2272 6574 7572 6e4e 6577 223a 2072 6574  "returnNew": ret
-0001c730: 7572 6e5f 6e65 772c 0a20 2020 2020 2020  urn_new,.       
-0001c740: 2020 2020 2022 7265 7475 726e 4f6c 6422       "returnOld"
-0001c750: 3a20 7265 7475 726e 5f6f 6c64 2c0a 2020  : return_old,.  
-0001c760: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-0001c770: 6966 2073 796e 6320 6973 206e 6f74 204e  if sync is not N
-0001c780: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0001c790: 2070 6172 616d 735b 2277 6169 7446 6f72   params["waitFor
-0001c7a0: 5379 6e63 225d 203d 2073 796e 630a 0a20  Sync"] = sync.. 
-0001c7b0: 2020 2020 2020 2072 6571 7565 7374 203d         request =
-0001c7c0: 2052 6571 7565 7374 280a 2020 2020 2020   Request(.      
-0001c7d0: 2020 2020 2020 6d65 7468 6f64 3d22 7061        method="pa
-0001c7e0: 7463 6822 2c0a 2020 2020 2020 2020 2020  tch",.          
-0001c7f0: 2020 656e 6470 6f69 6e74 3d66 222f 5f61    endpoint=f"/_a
-0001c800: 7069 2f67 6861 7269 616c 2f7b 7365 6c66  pi/gharial/{self
-0001c810: 2e5f 6772 6170 687d 2f76 6572 7465 782f  ._graph}/vertex/
-0001c820: 7b76 6572 7465 785f 6964 7d22 2c0a 2020  {vertex_id}",.  
-0001c830: 2020 2020 2020 2020 2020 6865 6164 6572            header
-0001c840: 733d 6865 6164 6572 732c 0a20 2020 2020  s=headers,.     
-0001c850: 2020 2020 2020 2070 6172 616d 733d 7061         params=pa
-0001c860: 7261 6d73 2c0a 2020 2020 2020 2020 2020  rams,.          
-0001c870: 2020 6461 7461 3d76 6572 7465 782c 0a20    data=vertex,. 
-0001c880: 2020 2020 2020 2020 2020 2077 7269 7465             write
-0001c890: 3d73 656c 662e 6e61 6d65 2c0a 2020 2020  =self.name,.    
-0001c8a0: 2020 2020 290a 0a20 2020 2020 2020 2064      )..        d
-0001c8b0: 6566 2072 6573 706f 6e73 655f 6861 6e64  ef response_hand
-0001c8c0: 6c65 7228 7265 7370 3a20 5265 7370 6f6e  ler(resp: Respon
-0001c8d0: 7365 2920 2d3e 2055 6e69 6f6e 5b62 6f6f  se) -> Union[boo
-0001c8e0: 6c2c 204a 736f 6e5d 3a0a 2020 2020 2020  l, Json]:.      
-0001c8f0: 2020 2020 2020 6966 2072 6573 702e 7374        if resp.st
-0001c900: 6174 7573 5f63 6f64 6520 3d3d 2034 3132  atus_code == 412
-0001c910: 3a20 2023 2070 7261 676d 613a 206e 6f20  :  # pragma: no 
-0001c920: 636f 7665 720a 2020 2020 2020 2020 2020  cover.          
-0001c930: 2020 2020 2020 7261 6973 6520 446f 6375        raise Docu
-0001c940: 6d65 6e74 5265 7669 7369 6f6e 4572 726f  mentRevisionErro
-0001c950: 7228 7265 7370 2c20 7265 7175 6573 7429  r(resp, request)
-0001c960: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-0001c970: 6620 6e6f 7420 7265 7370 2e69 735f 7375  f not resp.is_su
-0001c980: 6363 6573 733a 0a20 2020 2020 2020 2020  ccess:.         
-0001c990: 2020 2020 2020 2072 6169 7365 2044 6f63         raise Doc
-0001c9a0: 756d 656e 7455 7064 6174 6545 7272 6f72  umentUpdateError
-0001c9b0: 2872 6573 702c 2072 6571 7565 7374 290a  (resp, request).
-0001c9c0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0001c9d0: 696c 656e 7420 6973 2054 7275 653a 0a20  ilent is True:. 
-0001c9e0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0001c9f0: 6574 7572 6e20 5472 7565 0a20 2020 2020  eturn True.     
-0001ca00: 2020 2020 2020 2072 6574 7572 6e20 666f         return fo
-0001ca10: 726d 6174 5f76 6572 7465 7828 7265 7370  rmat_vertex(resp
-0001ca20: 2e62 6f64 7929 0a0a 2020 2020 2020 2020  .body)..        
-0001ca30: 7265 7475 726e 2073 656c 662e 5f65 7865  return self._exe
-0001ca40: 6375 7465 2872 6571 7565 7374 2c20 7265  cute(request, re
-0001ca50: 7370 6f6e 7365 5f68 616e 646c 6572 290a  sponse_handler).
-0001ca60: 0a20 2020 2064 6566 2072 6570 6c61 6365  .    def replace
-0001ca70: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0001ca80: 2020 2020 2020 2020 7665 7274 6578 3a20          vertex: 
-0001ca90: 4a73 6f6e 2c0a 2020 2020 2020 2020 6368  Json,.        ch
-0001caa0: 6563 6b5f 7265 763a 2062 6f6f 6c20 3d20  eck_rev: bool = 
-0001cab0: 5472 7565 2c0a 2020 2020 2020 2020 7379  True,.        sy
-0001cac0: 6e63 3a20 4f70 7469 6f6e 616c 5b62 6f6f  nc: Optional[boo
-0001cad0: 6c5d 203d 204e 6f6e 652c 0a20 2020 2020  l] = None,.     
-0001cae0: 2020 2073 696c 656e 743a 2062 6f6f 6c20     silent: bool 
-0001caf0: 3d20 4661 6c73 652c 0a20 2020 2020 2020  = False,.       
-0001cb00: 2072 6574 7572 6e5f 6f6c 643a 2062 6f6f   return_old: boo
-0001cb10: 6c20 3d20 4661 6c73 652c 0a20 2020 2020  l = False,.     
-0001cb20: 2020 2072 6574 7572 6e5f 6e65 773a 2062     return_new: b
-0001cb30: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
-0001cb40: 2029 202d 3e20 5265 7375 6c74 5b55 6e69   ) -> Result[Uni
-0001cb50: 6f6e 5b62 6f6f 6c2c 204a 736f 6e5d 5d3a  on[bool, Json]]:
-0001cb60: 0a20 2020 2020 2020 2022 2222 5265 706c  .        """Repl
-0001cb70: 6163 6520 6120 7665 7274 6578 2064 6f63  ace a vertex doc
-0001cb80: 756d 656e 742e 0a0a 2020 2020 2020 2020  ument...        
-0001cb90: 3a70 6172 616d 2076 6572 7465 783a 204e  :param vertex: N
-0001cba0: 6577 2076 6572 7465 7820 646f 6375 6d65  ew vertex docume
-0001cbb0: 6e74 2074 6f20 7265 706c 6163 6520 7468  nt to replace th
-0001cbc0: 6520 6f6c 6420 6f6e 6520 7769 7468 2e20  e old one with. 
-0001cbd0: 4974 206d 7573 740a 2020 2020 2020 2020  It must.        
-0001cbe0: 2020 2020 636f 6e74 6169 6e20 7468 6520      contain the 
-0001cbf0: 225f 6b65 7922 206f 7220 225f 6964 2220  "_key" or "_id" 
-0001cc00: 6669 656c 642e 0a20 2020 2020 2020 203a  field..        :
-0001cc10: 7479 7065 2076 6572 7465 783a 2064 6963  type vertex: dic
-0001cc20: 740a 2020 2020 2020 2020 3a70 6172 616d  t.        :param
-0001cc30: 2063 6865 636b 5f72 6576 3a20 4966 2073   check_rev: If s
-0001cc40: 6574 2074 6f20 5472 7565 2c20 7265 7669  et to True, revi
-0001cc50: 7369 6f6e 206f 6620 2a2a 7665 7274 6578  sion of **vertex
-0001cc60: 2a2a 2028 6966 2067 6976 656e 2920 6973  ** (if given) is
-0001cc70: 0a20 2020 2020 2020 2020 2020 2063 6f6d  .            com
-0001cc80: 7061 7265 6420 6167 6169 6e73 7420 7468  pared against th
-0001cc90: 6520 7265 7669 7369 6f6e 206f 6620 7461  e revision of ta
-0001cca0: 7267 6574 2076 6572 7465 7820 646f 6375  rget vertex docu
-0001ccb0: 6d65 6e74 2e0a 2020 2020 2020 2020 3a74  ment..        :t
-0001ccc0: 7970 6520 6368 6563 6b5f 7265 763a 2062  ype check_rev: b
-0001ccd0: 6f6f 6c0a 2020 2020 2020 2020 3a70 6172  ool.        :par
-0001cce0: 616d 2073 796e 633a 2042 6c6f 636b 2075  am sync: Block u
-0001ccf0: 6e74 696c 206f 7065 7261 7469 6f6e 2069  ntil operation i
-0001cd00: 7320 7379 6e63 6872 6f6e 697a 6564 2074  s synchronized t
-0001cd10: 6f20 6469 736b 2e0a 2020 2020 2020 2020  o disk..        
-0001cd20: 3a74 7970 6520 7379 6e63 3a20 626f 6f6c  :type sync: bool
-0001cd30: 207c 204e 6f6e 650a 2020 2020 2020 2020   | None.        
-0001cd40: 3a70 6172 616d 2073 696c 656e 743a 2049  :param silent: I
-0001cd50: 6620 7365 7420 746f 2054 7275 652c 206e  f set to True, n
-0001cd60: 6f20 646f 6375 6d65 6e74 206d 6574 6164  o document metad
-0001cd70: 6174 6120 6973 2072 6574 7572 6e65 642e  ata is returned.
-0001cd80: 2054 6869 730a 2020 2020 2020 2020 2020   This.          
-0001cd90: 2020 6361 6e20 6265 2075 7365 6420 746f    can be used to
-0001cda0: 2073 6176 6520 7265 736f 7572 6365 732e   save resources.
-0001cdb0: 0a20 2020 2020 2020 203a 7479 7065 2073  .        :type s
-0001cdc0: 696c 656e 743a 2062 6f6f 6c0a 2020 2020  ilent: bool.    
-0001cdd0: 2020 2020 3a70 6172 616d 2072 6574 7572      :param retur
-0001cde0: 6e5f 6f6c 643a 2049 6e63 6c75 6465 2062  n_old: Include b
-0001cdf0: 6f64 7920 6f66 2074 6865 206f 6c64 2064  ody of the old d
-0001ce00: 6f63 756d 656e 7420 696e 2074 6865 2072  ocument in the r
-0001ce10: 6574 7572 6e65 640a 2020 2020 2020 2020  eturned.        
-0001ce20: 2020 2020 6d65 7461 6461 7461 2e20 4967      metadata. Ig
-0001ce30: 6e6f 7265 6420 6966 2070 6172 616d 6574  nored if paramet
-0001ce40: 6572 202a 2a73 696c 656e 742a 2a20 6973  er **silent** is
-0001ce50: 2073 6574 2074 6f20 5472 7565 2e0a 2020   set to True..  
-0001ce60: 2020 2020 2020 3a74 7970 6520 7265 7475        :type retu
-0001ce70: 726e 5f6f 6c64 3a20 626f 6f6c 0a20 2020  rn_old: bool.   
-0001ce80: 2020 2020 203a 7061 7261 6d20 7265 7475       :param retu
-0001ce90: 726e 5f6e 6577 3a20 496e 636c 7564 6520  rn_new: Include 
-0001cea0: 626f 6479 206f 6620 7468 6520 6e65 7720  body of the new 
-0001ceb0: 646f 6375 6d65 6e74 2069 6e20 7468 6520  document in the 
-0001cec0: 7265 7475 726e 6564 0a20 2020 2020 2020  returned.       
-0001ced0: 2020 2020 206d 6574 6164 6174 612e 2049       metadata. I
-0001cee0: 676e 6f72 6564 2069 6620 7061 7261 6d65  gnored if parame
-0001cef0: 7465 7220 2a2a 7369 6c65 6e74 2a2a 2069  ter **silent** i
-0001cf00: 7320 7365 7420 746f 2054 7275 652e 0a20  s set to True.. 
-0001cf10: 2020 2020 2020 203a 7479 7065 2072 6574         :type ret
-0001cf20: 7572 6e5f 6e65 773a 2062 6f6f 6c0a 2020  urn_new: bool.  
-0001cf30: 2020 2020 2020 3a72 6574 7572 6e3a 2044        :return: D
-0001cf40: 6f63 756d 656e 7420 6d65 7461 6461 7461  ocument metadata
-0001cf50: 2028 652e 672e 2064 6f63 756d 656e 7420   (e.g. document 
-0001cf60: 6b65 792c 2072 6576 6973 696f 6e29 206f  key, revision) o
-0001cf70: 7220 5472 7565 2069 660a 2020 2020 2020  r True if.      
-0001cf80: 2020 2020 2020 7061 7261 6d65 7465 7220        parameter 
-0001cf90: 2a2a 7369 6c65 6e74 2a2a 2077 6173 2073  **silent** was s
-0001cfa0: 6574 2074 6f20 5472 7565 2e0a 2020 2020  et to True..    
-0001cfb0: 2020 2020 3a72 7479 7065 3a20 626f 6f6c      :rtype: bool
-0001cfc0: 207c 2064 6963 740a 2020 2020 2020 2020   | dict.        
-0001cfd0: 3a72 6169 7365 2061 7261 6e67 6f2e 6578  :raise arango.ex
-0001cfe0: 6365 7074 696f 6e73 2e44 6f63 756d 656e  ceptions.Documen
-0001cff0: 7452 6570 6c61 6365 4572 726f 723a 2049  tReplaceError: I
-0001d000: 6620 7265 706c 6163 6520 6661 696c 732e  f replace fails.
-0001d010: 0a20 2020 2020 2020 203a 7261 6973 6520  .        :raise 
-0001d020: 6172 616e 676f 2e65 7863 6570 7469 6f6e  arango.exception
-0001d030: 732e 446f 6375 6d65 6e74 5265 7669 7369  s.DocumentRevisi
-0001d040: 6f6e 4572 726f 723a 2049 6620 7265 7669  onError: If revi
-0001d050: 7369 6f6e 7320 6d69 736d 6174 6368 2e0a  sions mismatch..
-0001d060: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001d070: 2020 2020 7665 7274 6578 5f69 642c 2068      vertex_id, h
-0001d080: 6561 6465 7273 203d 2073 656c 662e 5f70  eaders = self._p
-0001d090: 7265 705f 6672 6f6d 5f62 6f64 7928 7665  rep_from_body(ve
-0001d0a0: 7274 6578 2c20 6368 6563 6b5f 7265 7629  rtex, check_rev)
-0001d0b0: 0a0a 2020 2020 2020 2020 7061 7261 6d73  ..        params
-0001d0c0: 3a20 5061 7261 6d73 203d 207b 0a20 2020  : Params = {.   
-0001d0d0: 2020 2020 2020 2020 2022 7369 6c65 6e74           "silent
-0001d0e0: 223a 2073 696c 656e 742c 0a20 2020 2020  ": silent,.     
-0001d0f0: 2020 2020 2020 2022 7265 7475 726e 4e65         "returnNe
-0001d100: 7722 3a20 7265 7475 726e 5f6e 6577 2c0a  w": return_new,.
-0001d110: 2020 2020 2020 2020 2020 2020 2272 6574              "ret
-0001d120: 7572 6e4f 6c64 223a 2072 6574 7572 6e5f  urnOld": return_
-0001d130: 6f6c 642c 0a20 2020 2020 2020 207d 0a20  old,.        }. 
-0001d140: 2020 2020 2020 2069 6620 7379 6e63 2069         if sync i
-0001d150: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0001d160: 2020 2020 2020 2020 7061 7261 6d73 5b22          params["
-0001d170: 7761 6974 466f 7253 796e 6322 5d20 3d20  waitForSync"] = 
-0001d180: 7379 6e63 0a0a 2020 2020 2020 2020 7265  sync..        re
-0001d190: 7175 6573 7420 3d20 5265 7175 6573 7428  quest = Request(
-0001d1a0: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-0001d1b0: 686f 643d 2270 7574 222c 0a20 2020 2020  hod="put",.     
-0001d1c0: 2020 2020 2020 2065 6e64 706f 696e 743d         endpoint=
-0001d1d0: 6622 2f5f 6170 692f 6768 6172 6961 6c2f  f"/_api/gharial/
-0001d1e0: 7b73 656c 662e 5f67 7261 7068 7d2f 7665  {self._graph}/ve
-0001d1f0: 7274 6578 2f7b 7665 7274 6578 5f69 647d  rtex/{vertex_id}
-0001d200: 222c 0a20 2020 2020 2020 2020 2020 2068  ",.            h
-0001d210: 6561 6465 7273 3d68 6561 6465 7273 2c0a  eaders=headers,.
-0001d220: 2020 2020 2020 2020 2020 2020 7061 7261              para
-0001d230: 6d73 3d70 6172 616d 732c 0a20 2020 2020  ms=params,.     
-0001d240: 2020 2020 2020 2064 6174 613d 7665 7274         data=vert
-0001d250: 6578 2c0a 2020 2020 2020 2020 2020 2020  ex,.            
-0001d260: 7772 6974 653d 7365 6c66 2e6e 616d 652c  write=self.name,
-0001d270: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-0001d280: 2020 2020 6465 6620 7265 7370 6f6e 7365      def response
-0001d290: 5f68 616e 646c 6572 2872 6573 703a 2052  _handler(resp: R
-0001d2a0: 6573 706f 6e73 6529 202d 3e20 556e 696f  esponse) -> Unio
-0001d2b0: 6e5b 626f 6f6c 2c20 4a73 6f6e 5d3a 0a20  n[bool, Json]:. 
-0001d2c0: 2020 2020 2020 2020 2020 2069 6620 7265             if re
-0001d2d0: 7370 2e73 7461 7475 735f 636f 6465 203d  sp.status_code =
-0001d2e0: 3d20 3431 323a 2020 2320 7072 6167 6d61  = 412:  # pragma
-0001d2f0: 3a20 6e6f 2063 6f76 6572 0a20 2020 2020  : no cover.     
-0001d300: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0001d310: 2044 6f63 756d 656e 7452 6576 6973 696f   DocumentRevisio
-0001d320: 6e45 7272 6f72 2872 6573 702c 2072 6571  nError(resp, req
-0001d330: 7565 7374 290a 2020 2020 2020 2020 2020  uest).          
-0001d340: 2020 656c 6966 206e 6f74 2072 6573 702e    elif not resp.
-0001d350: 6973 5f73 7563 6365 7373 3a0a 2020 2020  is_success:.    
-0001d360: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0001d370: 6520 446f 6375 6d65 6e74 5265 706c 6163  e DocumentReplac
-0001d380: 6545 7272 6f72 2872 6573 702c 2072 6571  eError(resp, req
-0001d390: 7565 7374 290a 2020 2020 2020 2020 2020  uest).          
-0001d3a0: 2020 6966 2073 696c 656e 7420 6973 2054    if silent is T
-0001d3b0: 7275 653a 0a20 2020 2020 2020 2020 2020  rue:.           
-0001d3c0: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
-0001d3d0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0001d3e0: 7572 6e20 666f 726d 6174 5f76 6572 7465  urn format_verte
-0001d3f0: 7828 7265 7370 2e62 6f64 7929 0a0a 2020  x(resp.body)..  
-0001d400: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0001d410: 662e 5f65 7865 6375 7465 2872 6571 7565  f._execute(reque
-0001d420: 7374 2c20 7265 7370 6f6e 7365 5f68 616e  st, response_han
-0001d430: 646c 6572 290a 0a20 2020 2064 6566 2064  dler)..    def d
-0001d440: 656c 6574 6528 0a20 2020 2020 2020 2073  elete(.        s
-0001d450: 656c 662c 0a20 2020 2020 2020 2076 6572  elf,.        ver
-0001d460: 7465 783a 2055 6e69 6f6e 5b73 7472 2c20  tex: Union[str, 
-0001d470: 4a73 6f6e 5d2c 0a20 2020 2020 2020 2072  Json],.        r
-0001d480: 6576 3a20 4f70 7469 6f6e 616c 5b73 7472  ev: Optional[str
-0001d490: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-0001d4a0: 2020 6368 6563 6b5f 7265 763a 2062 6f6f    check_rev: boo
-0001d4b0: 6c20 3d20 5472 7565 2c0a 2020 2020 2020  l = True,.      
-0001d4c0: 2020 6967 6e6f 7265 5f6d 6973 7369 6e67    ignore_missing
-0001d4d0: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
-0001d4e0: 2020 2020 2020 2020 7379 6e63 3a20 4f70          sync: Op
-0001d4f0: 7469 6f6e 616c 5b62 6f6f 6c5d 203d 204e  tional[bool] = N
-0001d500: 6f6e 652c 0a20 2020 2020 2020 2072 6574  one,.        ret
-0001d510: 7572 6e5f 6f6c 643a 2062 6f6f 6c20 3d20  urn_old: bool = 
-0001d520: 4661 6c73 652c 0a20 2020 2029 202d 3e20  False,.    ) -> 
-0001d530: 5265 7375 6c74 5b55 6e69 6f6e 5b62 6f6f  Result[Union[boo
-0001d540: 6c2c 204a 736f 6e5d 5d3a 0a20 2020 2020  l, Json]]:.     
-0001d550: 2020 2022 2222 4465 6c65 7465 2061 2076     """Delete a v
-0001d560: 6572 7465 7820 646f 6375 6d65 6e74 2e20  ertex document. 
-0001d570: 416c 6c20 636f 6e6e 6563 7465 6420 6564  All connected ed
-0001d580: 6765 7320 6172 6520 616c 736f 2064 656c  ges are also del
-0001d590: 6574 6564 2e0a 0a20 2020 2020 2020 203a  eted...        :
-0001d5a0: 7061 7261 6d20 7665 7274 6578 3a20 5665  param vertex: Ve
-0001d5b0: 7274 6578 2064 6f63 756d 656e 7420 4944  rtex document ID
-0001d5c0: 2c20 6b65 7920 6f72 2062 6f64 792e 2044  , key or body. D
-0001d5d0: 6f63 756d 656e 7420 626f 6479 206d 7573  ocument body mus
-0001d5e0: 740a 2020 2020 2020 2020 2020 2020 636f  t.            co
-0001d5f0: 6e74 6169 6e20 7468 6520 225f 6964 2220  ntain the "_id" 
-0001d600: 6f72 2022 5f6b 6579 2220 6669 656c 642e  or "_key" field.
-0001d610: 0a20 2020 2020 2020 203a 7479 7065 2076  .        :type v
-0001d620: 6572 7465 783a 2073 7472 207c 2064 6963  ertex: str | dic
-0001d630: 740a 2020 2020 2020 2020 3a70 6172 616d  t.        :param
-0001d640: 2072 6576 3a20 4578 7065 6374 6564 2064   rev: Expected d
-0001d650: 6f63 756d 656e 7420 7265 7669 7369 6f6e  ocument revision
-0001d660: 2e20 4f76 6572 7269 6465 7320 7468 6520  . Overrides the 
-0001d670: 7661 6c75 6520 6f66 2022 5f72 6576 220a  value of "_rev".
-0001d680: 2020 2020 2020 2020 2020 2020 6669 656c              fiel
-0001d690: 6420 696e 202a 2a76 6572 7465 782a 2a20  d in **vertex** 
-0001d6a0: 6966 2070 7265 7365 6e74 2e0a 2020 2020  if present..    
-0001d6b0: 2020 2020 3a74 7970 6520 7265 763a 2073      :type rev: s
-0001d6c0: 7472 207c 204e 6f6e 650a 2020 2020 2020  tr | None.      
-0001d6d0: 2020 3a70 6172 616d 2063 6865 636b 5f72    :param check_r
-0001d6e0: 6576 3a20 4966 2073 6574 2074 6f20 5472  ev: If set to Tr
-0001d6f0: 7565 2c20 7265 7669 7369 6f6e 206f 6620  ue, revision of 
-0001d700: 2a2a 7665 7274 6578 2a2a 2028 6966 2067  **vertex** (if g
-0001d710: 6976 656e 2920 6973 0a20 2020 2020 2020  iven) is.       
-0001d720: 2020 2020 2063 6f6d 7061 7265 6420 6167       compared ag
-0001d730: 6169 6e73 7420 7468 6520 7265 7669 7369  ainst the revisi
-0001d740: 6f6e 206f 6620 7461 7267 6574 2076 6572  on of target ver
-0001d750: 7465 7820 646f 6375 6d65 6e74 2e0a 2020  tex document..  
-0001d760: 2020 2020 2020 3a74 7970 6520 6368 6563        :type chec
-0001d770: 6b5f 7265 763a 2062 6f6f 6c0a 2020 2020  k_rev: bool.    
-0001d780: 2020 2020 3a70 6172 616d 2069 676e 6f72      :param ignor
-0001d790: 655f 6d69 7373 696e 673a 2044 6f20 6e6f  e_missing: Do no
-0001d7a0: 7420 7261 6973 6520 616e 2065 7863 6570  t raise an excep
-0001d7b0: 7469 6f6e 206f 6e20 6d69 7373 696e 6720  tion on missing 
-0001d7c0: 646f 6375 6d65 6e74 2e0a 2020 2020 2020  document..      
-0001d7d0: 2020 2020 2020 5468 6973 2070 6172 616d        This param
-0001d7e0: 6574 6572 2068 6173 206e 6f20 6566 6665  eter has no effe
-0001d7f0: 6374 2069 6e20 7472 616e 7361 6374 696f  ct in transactio
-0001d800: 6e73 2077 6865 7265 2061 6e20 6578 6365  ns where an exce
-0001d810: 7074 696f 6e20 6973 0a20 2020 2020 2020  ption is.       
-0001d820: 2020 2020 2061 6c77 6179 7320 7261 6973       always rais
-0001d830: 6564 206f 6e20 6661 696c 7572 6573 2e0a  ed on failures..
-0001d840: 2020 2020 2020 2020 3a74 7970 6520 6967          :type ig
-0001d850: 6e6f 7265 5f6d 6973 7369 6e67 3a20 626f  nore_missing: bo
-0001d860: 6f6c 0a20 2020 2020 2020 203a 7061 7261  ol.        :para
-0001d870: 6d20 7379 6e63 3a20 426c 6f63 6b20 756e  m sync: Block un
-0001d880: 7469 6c20 6f70 6572 6174 696f 6e20 6973  til operation is
-0001d890: 2073 796e 6368 726f 6e69 7a65 6420 746f   synchronized to
-0001d8a0: 2064 6973 6b2e 0a20 2020 2020 2020 203a   disk..        :
-0001d8b0: 7479 7065 2073 796e 633a 2062 6f6f 6c20  type sync: bool 
-0001d8c0: 7c20 4e6f 6e65 0a20 2020 2020 2020 203a  | None.        :
-0001d8d0: 7061 7261 6d20 7265 7475 726e 5f6f 6c64  param return_old
-0001d8e0: 3a20 5265 7475 726e 2062 6f64 7920 6f66  : Return body of
-0001d8f0: 2074 6865 206f 6c64 2064 6f63 756d 656e   the old documen
-0001d900: 7420 696e 2074 6865 2072 6573 756c 742e  t in the result.
-0001d910: 0a20 2020 2020 2020 203a 7479 7065 2072  .        :type r
-0001d920: 6574 7572 6e5f 6f6c 643a 2062 6f6f 6c0a  eturn_old: bool.
-0001d930: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-0001d940: 2054 7275 6520 6966 2076 6572 7465 7820   True if vertex 
-0001d950: 7761 7320 6465 6c65 7465 6420 7375 6363  was deleted succ
-0001d960: 6573 7366 756c 6c79 2c20 4661 6c73 6520  essfully, False 
-0001d970: 6966 2076 6572 7465 7820 7761 730a 2020  if vertex was.  
-0001d980: 2020 2020 2020 2020 2020 6e6f 7420 666f            not fo
-0001d990: 756e 6420 616e 6420 2a2a 6967 6e6f 7265  und and **ignore
-0001d9a0: 5f6d 6973 7369 6e67 2a2a 2077 6173 2073  _missing** was s
-0001d9b0: 6574 2074 6f20 5472 7565 2028 646f 6573  et to True (does
-0001d9c0: 206e 6f74 2061 7070 6c79 2069 6e0a 2020   not apply in.  
-0001d9d0: 2020 2020 2020 2020 2020 7472 616e 7361            transa
-0001d9e0: 6374 696f 6e73 292e 204f 6c64 2064 6f63  ctions). Old doc
-0001d9f0: 756d 656e 7420 6973 2072 6574 7572 6e65  ument is returne
-0001da00: 6420 6966 202a 2a72 6574 7572 6e5f 6f6c  d if **return_ol
-0001da10: 642a 2a20 6973 2073 6574 2074 6f0a 2020  d** is set to.  
-0001da20: 2020 2020 2020 2020 2020 5472 7565 2e0a            True..
-0001da30: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
-0001da40: 626f 6f6c 207c 2064 6963 740a 2020 2020  bool | dict.    
-0001da50: 2020 2020 3a72 6169 7365 2061 7261 6e67      :raise arang
-0001da60: 6f2e 6578 6365 7074 696f 6e73 2e44 6f63  o.exceptions.Doc
-0001da70: 756d 656e 7444 656c 6574 6545 7272 6f72  umentDeleteError
-0001da80: 3a20 4966 2064 656c 6574 6520 6661 696c  : If delete fail
-0001da90: 732e 0a20 2020 2020 2020 203a 7261 6973  s..        :rais
-0001daa0: 6520 6172 616e 676f 2e65 7863 6570 7469  e arango.excepti
-0001dab0: 6f6e 732e 446f 6375 6d65 6e74 5265 7669  ons.DocumentRevi
-0001dac0: 7369 6f6e 4572 726f 723a 2049 6620 7265  sionError: If re
-0001dad0: 7669 7369 6f6e 7320 6d69 736d 6174 6368  visions mismatch
-0001dae0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0001daf0: 2020 2020 2020 6861 6e64 6c65 2c20 5f2c        handle, _,
-0001db00: 2068 6561 6465 7273 203d 2073 656c 662e   headers = self.
-0001db10: 5f70 7265 705f 6672 6f6d 5f64 6f63 2876  _prep_from_doc(v
-0001db20: 6572 7465 782c 2072 6576 2c20 6368 6563  ertex, rev, chec
-0001db30: 6b5f 7265 7629 0a0a 2020 2020 2020 2020  k_rev)..        
-0001db40: 7061 7261 6d73 3a20 5061 7261 6d73 203d  params: Params =
-0001db50: 207b 2272 6574 7572 6e4f 6c64 223a 2072   {"returnOld": r
-0001db60: 6574 7572 6e5f 6f6c 647d 0a20 2020 2020  eturn_old}.     
-0001db70: 2020 2069 6620 7379 6e63 2069 7320 6e6f     if sync is no
-0001db80: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-0001db90: 2020 2020 7061 7261 6d73 5b22 7761 6974      params["wait
-0001dba0: 466f 7253 796e 6322 5d20 3d20 7379 6e63  ForSync"] = sync
-0001dbb0: 0a0a 2020 2020 2020 2020 7265 7175 6573  ..        reques
-0001dbc0: 7420 3d20 5265 7175 6573 7428 0a20 2020  t = Request(.   
-0001dbd0: 2020 2020 2020 2020 206d 6574 686f 643d           method=
-0001dbe0: 2264 656c 6574 6522 2c0a 2020 2020 2020  "delete",.      
-0001dbf0: 2020 2020 2020 656e 6470 6f69 6e74 3d66        endpoint=f
-0001dc00: 222f 5f61 7069 2f67 6861 7269 616c 2f7b  "/_api/gharial/{
-0001dc10: 7365 6c66 2e5f 6772 6170 687d 2f76 6572  self._graph}/ver
-0001dc20: 7465 782f 7b68 616e 646c 657d 222c 0a20  tex/{handle}",. 
-0001dc30: 2020 2020 2020 2020 2020 2070 6172 616d             param
-0001dc40: 733d 7061 7261 6d73 2c0a 2020 2020 2020  s=params,.      
-0001dc50: 2020 2020 2020 6865 6164 6572 733d 6865        headers=he
-0001dc60: 6164 6572 732c 0a20 2020 2020 2020 2020  aders,.         
-0001dc70: 2020 2077 7269 7465 3d73 656c 662e 6e61     write=self.na
-0001dc80: 6d65 2c0a 2020 2020 2020 2020 290a 0a20  me,.        ).. 
-0001dc90: 2020 2020 2020 2064 6566 2072 6573 706f         def respo
-0001dca0: 6e73 655f 6861 6e64 6c65 7228 7265 7370  nse_handler(resp
-0001dcb0: 3a20 5265 7370 6f6e 7365 2920 2d3e 2055  : Response) -> U
-0001dcc0: 6e69 6f6e 5b62 6f6f 6c2c 204a 736f 6e5d  nion[bool, Json]
-0001dcd0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-0001dce0: 2072 6573 702e 6572 726f 725f 636f 6465   resp.error_code
-0001dcf0: 203d 3d20 3132 3032 2061 6e64 2069 676e   == 1202 and ign
-0001dd00: 6f72 655f 6d69 7373 696e 673a 0a20 2020  ore_missing:.   
-0001dd10: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-0001dd20: 7572 6e20 4661 6c73 650a 2020 2020 2020  urn False.      
-0001dd30: 2020 2020 2020 6966 2072 6573 702e 7374        if resp.st
-0001dd40: 6174 7573 5f63 6f64 6520 3d3d 2034 3132  atus_code == 412
-0001dd50: 3a20 2023 2070 7261 676d 613a 206e 6f20  :  # pragma: no 
-0001dd60: 636f 7665 720a 2020 2020 2020 2020 2020  cover.          
-0001dd70: 2020 2020 2020 7261 6973 6520 446f 6375        raise Docu
-0001dd80: 6d65 6e74 5265 7669 7369 6f6e 4572 726f  mentRevisionErro
-0001dd90: 7228 7265 7370 2c20 7265 7175 6573 7429  r(resp, request)
-0001dda0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001ddb0: 6e6f 7420 7265 7370 2e69 735f 7375 6363  not resp.is_succ
-0001ddc0: 6573 733a 0a20 2020 2020 2020 2020 2020  ess:.           
-0001ddd0: 2020 2020 2072 6169 7365 2044 6f63 756d       raise Docum
-0001dde0: 656e 7444 656c 6574 6545 7272 6f72 2872  entDeleteError(r
-0001ddf0: 6573 702c 2072 6571 7565 7374 290a 0a20  esp, request).. 
-0001de00: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-0001de10: 743a 204a 736f 6e20 3d20 7265 7370 2e62  t: Json = resp.b
-0001de20: 6f64 790a 2020 2020 2020 2020 2020 2020  ody.            
-0001de30: 7265 7475 726e 207b 226f 6c64 223a 2072  return {"old": r
-0001de40: 6573 756c 745b 226f 6c64 225d 7d20 6966  esult["old"]} if
-0001de50: 2072 6574 7572 6e5f 6f6c 6420 656c 7365   return_old else
-0001de60: 2054 7275 650a 0a20 2020 2020 2020 2072   True..        r
-0001de70: 6574 7572 6e20 7365 6c66 2e5f 6578 6563  eturn self._exec
-0001de80: 7574 6528 7265 7175 6573 742c 2072 6573  ute(request, res
-0001de90: 706f 6e73 655f 6861 6e64 6c65 7229 0a0a  ponse_handler)..
-0001dea0: 0a63 6c61 7373 2045 6467 6543 6f6c 6c65  .class EdgeColle
-0001deb0: 6374 696f 6e28 436f 6c6c 6563 7469 6f6e  ction(Collection
-0001dec0: 293a 0a20 2020 2022 2222 4172 616e 676f  ):.    """Arango
-0001ded0: 4442 2065 6467 6520 636f 6c6c 6563 7469  DB edge collecti
-0001dee0: 6f6e 2041 5049 2077 7261 7070 6572 2e0a  on API wrapper..
-0001def0: 0a20 2020 203a 7061 7261 6d20 636f 6e6e  .    :param conn
-0001df00: 6563 7469 6f6e 3a20 4854 5450 2063 6f6e  ection: HTTP con
-0001df10: 6e65 6374 696f 6e2e 0a20 2020 203a 7061  nection..    :pa
-0001df20: 7261 6d20 6578 6563 7574 6f72 3a20 4150  ram executor: AP
-0001df30: 4920 6578 6563 7574 6f72 2e0a 2020 2020  I executor..    
-0001df40: 3a70 6172 616d 2067 7261 7068 3a20 4772  :param graph: Gr
-0001df50: 6170 6820 6e61 6d65 2e0a 2020 2020 3a70  aph name..    :p
-0001df60: 6172 616d 206e 616d 653a 2045 6467 6520  aram name: Edge 
-0001df70: 636f 6c6c 6563 7469 6f6e 206e 616d 652e  collection name.
-0001df80: 0a20 2020 2022 2222 0a0a 2020 2020 6465  .    """..    de
-0001df90: 6620 5f5f 696e 6974 5f5f 280a 2020 2020  f __init__(.    
-0001dfa0: 2020 2020 7365 6c66 2c20 636f 6e6e 6563      self, connec
-0001dfb0: 7469 6f6e 3a20 436f 6e6e 6563 7469 6f6e  tion: Connection
-0001dfc0: 2c20 6578 6563 7574 6f72 3a20 4170 6945  , executor: ApiE
-0001dfd0: 7865 6375 746f 722c 2067 7261 7068 3a20  xecutor, graph: 
-0001dfe0: 7374 722c 206e 616d 653a 2073 7472 0a20  str, name: str. 
-0001dff0: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-0001e000: 2020 2020 2020 7375 7065 7228 292e 5f5f        super().__
-0001e010: 696e 6974 5f5f 2863 6f6e 6e65 6374 696f  init__(connectio
-0001e020: 6e2c 2065 7865 6375 746f 722c 206e 616d  n, executor, nam
-0001e030: 6529 0a20 2020 2020 2020 2073 656c 662e  e).        self.
-0001e040: 5f67 7261 7068 203d 2067 7261 7068 0a0a  _graph = graph..
-0001e050: 2020 2020 6465 6620 5f5f 7265 7072 5f5f      def __repr__
-0001e060: 2873 656c 6629 202d 3e20 7374 723a 0a20  (self) -> str:. 
-0001e070: 2020 2020 2020 2072 6574 7572 6e20 6622         return f"
-0001e080: 3c45 6467 6543 6f6c 6c65 6374 696f 6e20  <EdgeCollection 
-0001e090: 7b73 656c 662e 6e61 6d65 7d3e 220a 0a20  {self.name}>".. 
-0001e0a0: 2020 2064 6566 205f 5f67 6574 6974 656d     def __getitem
-0001e0b0: 5f5f 2873 656c 662c 206b 6579 3a20 556e  __(self, key: Un
-0001e0c0: 696f 6e5b 7374 722c 204a 736f 6e5d 2920  ion[str, Json]) 
-0001e0d0: 2d3e 2052 6573 756c 745b 4f70 7469 6f6e  -> Result[Option
-0001e0e0: 616c 5b4a 736f 6e5d 5d3a 0a20 2020 2020  al[Json]]:.     
-0001e0f0: 2020 2072 6574 7572 6e20 7365 6c66 2e67     return self.g
-0001e100: 6574 286b 6579 290a 0a20 2020 2040 7072  et(key)..    @pr
-0001e110: 6f70 6572 7479 0a20 2020 2064 6566 2067  operty.    def g
-0001e120: 7261 7068 2873 656c 6629 202d 3e20 7374  raph(self) -> st
-0001e130: 723a 0a20 2020 2020 2020 2022 2222 5265  r:.        """Re
-0001e140: 7475 726e 2074 6865 2067 7261 7068 206e  turn the graph n
-0001e150: 616d 652e 0a0a 2020 2020 2020 2020 3a72  ame...        :r
-0001e160: 6574 7572 6e3a 2047 7261 7068 206e 616d  eturn: Graph nam
-0001e170: 652e 0a20 2020 2020 2020 203a 7274 7970  e..        :rtyp
-0001e180: 653a 2073 7472 0a20 2020 2020 2020 2022  e: str.        "
-0001e190: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-0001e1a0: 6e20 7365 6c66 2e5f 6772 6170 680a 0a20  n self._graph.. 
-0001e1b0: 2020 2064 6566 2067 6574 280a 2020 2020     def get(.    
-0001e1c0: 2020 2020 7365 6c66 2c20 6564 6765 3a20      self, edge: 
-0001e1d0: 556e 696f 6e5b 7374 722c 204a 736f 6e5d  Union[str, Json]
-0001e1e0: 2c20 7265 763a 204f 7074 696f 6e61 6c5b  , rev: Optional[
-0001e1f0: 7374 725d 203d 204e 6f6e 652c 2063 6865  str] = None, che
-0001e200: 636b 5f72 6576 3a20 626f 6f6c 203d 2054  ck_rev: bool = T
-0001e210: 7275 650a 2020 2020 2920 2d3e 2052 6573  rue.    ) -> Res
-0001e220: 756c 745b 4f70 7469 6f6e 616c 5b4a 736f  ult[Optional[Jso
-0001e230: 6e5d 5d3a 0a20 2020 2020 2020 2022 2222  n]]:.        """
-0001e240: 5265 7475 726e 2061 6e20 6564 6765 2064  Return an edge d
-0001e250: 6f63 756d 656e 742e 0a0a 2020 2020 2020  ocument...      
-0001e260: 2020 3a70 6172 616d 2065 6467 653a 2045    :param edge: E
-0001e270: 6467 6520 646f 6375 6d65 6e74 2049 442c  dge document ID,
-0001e280: 206b 6579 206f 7220 626f 6479 2e20 446f   key or body. Do
-0001e290: 6375 6d65 6e74 2062 6f64 7920 6d75 7374  cument body must
-0001e2a0: 2063 6f6e 7461 696e 0a20 2020 2020 2020   contain.       
-0001e2b0: 2020 2020 2074 6865 2022 5f69 6422 206f       the "_id" o
-0001e2c0: 7220 225f 6b65 7922 2066 6965 6c64 2e0a  r "_key" field..
-0001e2d0: 2020 2020 2020 2020 3a74 7970 6520 6564          :type ed
-0001e2e0: 6765 3a20 7374 7220 7c20 6469 6374 0a20  ge: str | dict. 
-0001e2f0: 2020 2020 2020 203a 7061 7261 6d20 7265         :param re
-0001e300: 763a 2045 7870 6563 7465 6420 646f 6375  v: Expected docu
-0001e310: 6d65 6e74 2072 6576 6973 696f 6e2e 204f  ment revision. O
-0001e320: 7665 7272 6964 6573 2074 6865 2076 616c  verrides the val
-0001e330: 7565 206f 6620 225f 7265 7622 0a20 2020  ue of "_rev".   
-0001e340: 2020 2020 2020 2020 2066 6965 6c64 2069           field i
-0001e350: 6e20 2a2a 6564 6765 2a2a 2069 6620 7072  n **edge** if pr
-0001e360: 6573 656e 742e 0a20 2020 2020 2020 203a  esent..        :
-0001e370: 7479 7065 2072 6576 3a20 7374 7220 7c20  type rev: str | 
-0001e380: 4e6f 6e65 0a20 2020 2020 2020 203a 7061  None.        :pa
-0001e390: 7261 6d20 6368 6563 6b5f 7265 763a 2049  ram check_rev: I
-0001e3a0: 6620 7365 7420 746f 2054 7275 652c 2072  f set to True, r
-0001e3b0: 6576 6973 696f 6e20 6f66 202a 2a65 6467  evision of **edg
-0001e3c0: 652a 2a20 2869 6620 6769 7665 6e29 2069  e** (if given) i
-0001e3d0: 730a 2020 2020 2020 2020 2020 2020 636f  s.            co
-0001e3e0: 6d70 6172 6564 2061 6761 696e 7374 2074  mpared against t
-0001e3f0: 6865 2072 6576 6973 696f 6e20 6f66 2074  he revision of t
-0001e400: 6172 6765 7420 6564 6765 2064 6f63 756d  arget edge docum
-0001e410: 656e 742e 0a20 2020 2020 2020 203a 7479  ent..        :ty
-0001e420: 7065 2063 6865 636b 5f72 6576 3a20 626f  pe check_rev: bo
-0001e430: 6f6c 0a20 2020 2020 2020 203a 7265 7475  ol.        :retu
-0001e440: 726e 3a20 4564 6765 2064 6f63 756d 656e  rn: Edge documen
-0001e450: 7420 6f72 204e 6f6e 6520 6966 206e 6f74  t or None if not
-0001e460: 2066 6f75 6e64 2e0a 2020 2020 2020 2020   found..        
-0001e470: 3a72 7479 7065 3a20 6469 6374 207c 204e  :rtype: dict | N
-0001e480: 6f6e 650a 2020 2020 2020 2020 3a72 6169  one.        :rai
-0001e490: 7365 2061 7261 6e67 6f2e 6578 6365 7074  se arango.except
-0001e4a0: 696f 6e73 2e44 6f63 756d 656e 7447 6574  ions.DocumentGet
-0001e4b0: 4572 726f 723a 2049 6620 7265 7472 6965  Error: If retrie
-0001e4c0: 7661 6c20 6661 696c 732e 0a20 2020 2020  val fails..     
-0001e4d0: 2020 203a 7261 6973 6520 6172 616e 676f     :raise arango
-0001e4e0: 2e65 7863 6570 7469 6f6e 732e 446f 6375  .exceptions.Docu
-0001e4f0: 6d65 6e74 5265 7669 7369 6f6e 4572 726f  mentRevisionErro
-0001e500: 723a 2049 6620 7265 7669 7369 6f6e 7320  r: If revisions 
-0001e510: 6d69 736d 6174 6368 2e0a 2020 2020 2020  mismatch..      
-0001e520: 2020 2222 220a 2020 2020 2020 2020 6861    """.        ha
-0001e530: 6e64 6c65 2c20 626f 6479 2c20 6865 6164  ndle, body, head
-0001e540: 6572 7320 3d20 7365 6c66 2e5f 7072 6570  ers = self._prep
-0001e550: 5f66 726f 6d5f 646f 6328 6564 6765 2c20  _from_doc(edge, 
-0001e560: 7265 762c 2063 6865 636b 5f72 6576 290a  rev, check_rev).
-0001e570: 0a20 2020 2020 2020 2072 6571 7565 7374  .        request
-0001e580: 203d 2052 6571 7565 7374 280a 2020 2020   = Request(.    
-0001e590: 2020 2020 2020 2020 6d65 7468 6f64 3d22          method="
-0001e5a0: 6765 7422 2c0a 2020 2020 2020 2020 2020  get",.          
-0001e5b0: 2020 656e 6470 6f69 6e74 3d66 222f 5f61    endpoint=f"/_a
-0001e5c0: 7069 2f67 6861 7269 616c 2f7b 7365 6c66  pi/gharial/{self
-0001e5d0: 2e5f 6772 6170 687d 2f65 6467 652f 7b68  ._graph}/edge/{h
-0001e5e0: 616e 646c 657d 222c 0a20 2020 2020 2020  andle}",.       
-0001e5f0: 2020 2020 2068 6561 6465 7273 3d68 6561       headers=hea
-0001e600: 6465 7273 2c0a 2020 2020 2020 2020 2020  ders,.          
-0001e610: 2020 7265 6164 3d73 656c 662e 6e61 6d65    read=self.name
-0001e620: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-0001e630: 2020 2020 2064 6566 2072 6573 706f 6e73       def respons
-0001e640: 655f 6861 6e64 6c65 7228 7265 7370 3a20  e_handler(resp: 
-0001e650: 5265 7370 6f6e 7365 2920 2d3e 204f 7074  Response) -> Opt
-0001e660: 696f 6e61 6c5b 4a73 6f6e 5d3a 0a20 2020  ional[Json]:.   
-0001e670: 2020 2020 2020 2020 2069 6620 7265 7370           if resp
-0001e680: 2e65 7272 6f72 5f63 6f64 6520 3d3d 2031  .error_code == 1
-0001e690: 3230 323a 0a20 2020 2020 2020 2020 2020  202:.           
-0001e6a0: 2020 2020 2072 6574 7572 6e20 4e6f 6e65       return None
-0001e6b0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001e6c0: 7265 7370 2e73 7461 7475 735f 636f 6465  resp.status_code
-0001e6d0: 203d 3d20 3431 323a 2020 2320 7072 6167   == 412:  # prag
-0001e6e0: 6d61 3a20 6e6f 2063 6f76 6572 0a20 2020  ma: no cover.   
-0001e6f0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0001e700: 7365 2044 6f63 756d 656e 7452 6576 6973  se DocumentRevis
-0001e710: 696f 6e45 7272 6f72 2872 6573 702c 2072  ionError(resp, r
-0001e720: 6571 7565 7374 290a 2020 2020 2020 2020  equest).        
-0001e730: 2020 2020 6966 206e 6f74 2072 6573 702e      if not resp.
-0001e740: 6973 5f73 7563 6365 7373 3a0a 2020 2020  is_success:.    
-0001e750: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0001e760: 6520 446f 6375 6d65 6e74 4765 7445 7272  e DocumentGetErr
-0001e770: 6f72 2872 6573 702c 2072 6571 7565 7374  or(resp, request
-0001e780: 290a 0a20 2020 2020 2020 2020 2020 2072  )..            r
-0001e790: 6573 756c 743a 204a 736f 6e20 3d20 7265  esult: Json = re
-0001e7a0: 7370 2e62 6f64 795b 2265 6467 6522 5d0a  sp.body["edge"].
-0001e7b0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001e7c0: 726e 2072 6573 756c 740a 0a20 2020 2020  rn result..     
-0001e7d0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-0001e7e0: 6578 6563 7574 6528 7265 7175 6573 742c  execute(request,
-0001e7f0: 2072 6573 706f 6e73 655f 6861 6e64 6c65   response_handle
-0001e800: 7229 0a0a 2020 2020 6465 6620 696e 7365  r)..    def inse
-0001e810: 7274 280a 2020 2020 2020 2020 7365 6c66  rt(.        self
-0001e820: 2c0a 2020 2020 2020 2020 6564 6765 3a20  ,.        edge: 
-0001e830: 4a73 6f6e 2c0a 2020 2020 2020 2020 7379  Json,.        sy
-0001e840: 6e63 3a20 4f70 7469 6f6e 616c 5b62 6f6f  nc: Optional[boo
-0001e850: 6c5d 203d 204e 6f6e 652c 0a20 2020 2020  l] = None,.     
-0001e860: 2020 2073 696c 656e 743a 2062 6f6f 6c20     silent: bool 
-0001e870: 3d20 4661 6c73 652c 0a20 2020 2020 2020  = False,.       
-0001e880: 2072 6574 7572 6e5f 6e65 773a 2062 6f6f   return_new: boo
-0001e890: 6c20 3d20 4661 6c73 652c 0a20 2020 2029  l = False,.    )
-0001e8a0: 202d 3e20 5265 7375 6c74 5b55 6e69 6f6e   -> Result[Union
-0001e8b0: 5b62 6f6f 6c2c 204a 736f 6e5d 5d3a 0a20  [bool, Json]]:. 
-0001e8c0: 2020 2020 2020 2022 2222 496e 7365 7274         """Insert
-0001e8d0: 2061 206e 6577 2065 6467 6520 646f 6375   a new edge docu
-0001e8e0: 6d65 6e74 2e0a 0a20 2020 2020 2020 203a  ment...        :
-0001e8f0: 7061 7261 6d20 6564 6765 3a20 4e65 7720  param edge: New 
-0001e900: 6564 6765 2064 6f63 756d 656e 7420 746f  edge document to
-0001e910: 2069 6e73 6572 742e 2049 7420 6d75 7374   insert. It must
-0001e920: 2063 6f6e 7461 696e 2022 5f66 726f 6d22   contain "_from"
-0001e930: 2061 6e64 0a20 2020 2020 2020 2020 2020   and.           
-0001e940: 2022 5f74 6f22 2066 6965 6c64 732e 2049   "_to" fields. I
-0001e950: 6620 6974 2068 6173 2022 5f6b 6579 2220  f it has "_key" 
-0001e960: 6f72 2022 5f69 6422 2066 6965 6c64 2c20  or "_id" field, 
-0001e970: 6974 7320 7661 6c75 6520 6973 2075 7365  its value is use
-0001e980: 640a 2020 2020 2020 2020 2020 2020 6173  d.            as
-0001e990: 206b 6579 206f 6620 7468 6520 6e65 7720   key of the new 
-0001e9a0: 6564 6765 2064 6f63 756d 656e 7420 286f  edge document (o
-0001e9b0: 7468 6572 7769 7365 2069 7420 6973 2061  therwise it is a
-0001e9c0: 7574 6f2d 6765 6e65 7261 7465 6429 2e0a  uto-generated)..
-0001e9d0: 2020 2020 2020 2020 2020 2020 416e 7920              Any 
-0001e9e0: 225f 7265 7622 2066 6965 6c64 2069 7320  "_rev" field is 
-0001e9f0: 6967 6e6f 7265 642e 0a20 2020 2020 2020  ignored..       
-0001ea00: 203a 7479 7065 2065 6467 653a 2064 6963   :type edge: dic
-0001ea10: 740a 2020 2020 2020 2020 3a70 6172 616d  t.        :param
-0001ea20: 2073 796e 633a 2042 6c6f 636b 2075 6e74   sync: Block unt
-0001ea30: 696c 206f 7065 7261 7469 6f6e 2069 7320  il operation is 
-0001ea40: 7379 6e63 6872 6f6e 697a 6564 2074 6f20  synchronized to 
-0001ea50: 6469 736b 2e0a 2020 2020 2020 2020 3a74  disk..        :t
-0001ea60: 7970 6520 7379 6e63 3a20 626f 6f6c 207c  ype sync: bool |
-0001ea70: 204e 6f6e 650a 2020 2020 2020 2020 3a70   None.        :p
-0001ea80: 6172 616d 2073 696c 656e 743a 2049 6620  aram silent: If 
-0001ea90: 7365 7420 746f 2054 7275 652c 206e 6f20  set to True, no 
-0001eaa0: 646f 6375 6d65 6e74 206d 6574 6164 6174  document metadat
-0001eab0: 6120 6973 2072 6574 7572 6e65 642e 2054  a is returned. T
-0001eac0: 6869 730a 2020 2020 2020 2020 2020 2020  his.            
-0001ead0: 6361 6e20 6265 2075 7365 6420 746f 2073  can be used to s
-0001eae0: 6176 6520 7265 736f 7572 6365 732e 0a20  ave resources.. 
-0001eaf0: 2020 2020 2020 203a 7479 7065 2073 696c         :type sil
-0001eb00: 656e 743a 2062 6f6f 6c0a 2020 2020 2020  ent: bool.      
-0001eb10: 2020 3a70 6172 616d 2072 6574 7572 6e5f    :param return_
-0001eb20: 6e65 773a 2049 6e63 6c75 6465 2062 6f64  new: Include bod
-0001eb30: 7920 6f66 2074 6865 206e 6577 2064 6f63  y of the new doc
-0001eb40: 756d 656e 7420 696e 2074 6865 2072 6574  ument in the ret
-0001eb50: 7572 6e65 640a 2020 2020 2020 2020 2020  urned.          
-0001eb60: 2020 6d65 7461 6461 7461 2e20 4967 6e6f    metadata. Igno
-0001eb70: 7265 6420 6966 2070 6172 616d 6574 6572  red if parameter
-0001eb80: 202a 2a73 696c 656e 742a 2a20 6973 2073   **silent** is s
-0001eb90: 6574 2074 6f20 5472 7565 2e0a 2020 2020  et to True..    
-0001eba0: 2020 2020 3a74 7970 6520 7265 7475 726e      :type return
-0001ebb0: 5f6e 6577 3a20 626f 6f6c 0a20 2020 2020  _new: bool.     
-0001ebc0: 2020 203a 7265 7475 726e 3a20 446f 6375     :return: Docu
-0001ebd0: 6d65 6e74 206d 6574 6164 6174 6120 2865  ment metadata (e
-0001ebe0: 2e67 2e20 646f 6375 6d65 6e74 206b 6579  .g. document key
-0001ebf0: 2c20 7265 7669 7369 6f6e 2920 6f72 2054  , revision) or T
-0001ec00: 7275 6520 6966 0a20 2020 2020 2020 2020  rue if.         
-0001ec10: 2020 2070 6172 616d 6574 6572 202a 2a73     parameter **s
-0001ec20: 696c 656e 742a 2a20 7761 7320 7365 7420  ilent** was set 
-0001ec30: 746f 2054 7275 652e 0a20 2020 2020 2020  to True..       
-0001ec40: 203a 7274 7970 653a 2062 6f6f 6c20 7c20   :rtype: bool | 
-0001ec50: 6469 6374 0a20 2020 2020 2020 203a 7261  dict.        :ra
-0001ec60: 6973 6520 6172 616e 676f 2e65 7863 6570  ise arango.excep
-0001ec70: 7469 6f6e 732e 446f 6375 6d65 6e74 496e  tions.DocumentIn
-0001ec80: 7365 7274 4572 726f 723a 2049 6620 696e  sertError: If in
-0001ec90: 7365 7274 2066 6169 6c73 2e0a 2020 2020  sert fails..    
-0001eca0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001ecb0: 6564 6765 203d 2073 656c 662e 5f65 6e73  edge = self._ens
-0001ecc0: 7572 655f 6b65 795f 6672 6f6d 5f69 6428  ure_key_from_id(
-0001ecd0: 6564 6765 290a 0a20 2020 2020 2020 2070  edge)..        p
-0001ece0: 6172 616d 733a 2050 6172 616d 7320 3d20  arams: Params = 
-0001ecf0: 7b22 7369 6c65 6e74 223a 2073 696c 656e  {"silent": silen
-0001ed00: 742c 2022 7265 7475 726e 4e65 7722 3a20  t, "returnNew": 
-0001ed10: 7265 7475 726e 5f6e 6577 7d0a 2020 2020  return_new}.    
-0001ed20: 2020 2020 6966 2073 796e 6320 6973 206e      if sync is n
-0001ed30: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-0001ed40: 2020 2020 2070 6172 616d 735b 2277 6169       params["wai
-0001ed50: 7446 6f72 5379 6e63 225d 203d 2073 796e  tForSync"] = syn
-0001ed60: 630a 0a20 2020 2020 2020 2072 6571 7565  c..        reque
-0001ed70: 7374 203d 2052 6571 7565 7374 280a 2020  st = Request(.  
-0001ed80: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
-0001ed90: 3d22 706f 7374 222c 0a20 2020 2020 2020  ="post",.       
-0001eda0: 2020 2020 2065 6e64 706f 696e 743d 6622       endpoint=f"
-0001edb0: 2f5f 6170 692f 6768 6172 6961 6c2f 7b73  /_api/gharial/{s
-0001edc0: 656c 662e 5f67 7261 7068 7d2f 6564 6765  elf._graph}/edge
-0001edd0: 2f7b 7365 6c66 2e6e 616d 657d 222c 0a20  /{self.name}",. 
-0001ede0: 2020 2020 2020 2020 2020 2064 6174 613d             data=
-0001edf0: 6564 6765 2c0a 2020 2020 2020 2020 2020  edge,.          
-0001ee00: 2020 7061 7261 6d73 3d70 6172 616d 732c    params=params,
-0001ee10: 0a20 2020 2020 2020 2020 2020 2077 7269  .            wri
-0001ee20: 7465 3d73 656c 662e 6e61 6d65 2c0a 2020  te=self.name,.  
-0001ee30: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0001ee40: 2064 6566 2072 6573 706f 6e73 655f 6861   def response_ha
-0001ee50: 6e64 6c65 7228 7265 7370 3a20 5265 7370  ndler(resp: Resp
-0001ee60: 6f6e 7365 2920 2d3e 2055 6e69 6f6e 5b62  onse) -> Union[b
-0001ee70: 6f6f 6c2c 204a 736f 6e5d 3a0a 2020 2020  ool, Json]:.    
-0001ee80: 2020 2020 2020 2020 6966 206e 6f74 2072          if not r
-0001ee90: 6573 702e 6973 5f73 7563 6365 7373 3a0a  esp.is_success:.
-0001eea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001eeb0: 7261 6973 6520 446f 6375 6d65 6e74 496e  raise DocumentIn
-0001eec0: 7365 7274 4572 726f 7228 7265 7370 2c20  sertError(resp, 
-0001eed0: 7265 7175 6573 7429 0a20 2020 2020 2020  request).       
-0001eee0: 2020 2020 2069 6620 7369 6c65 6e74 3a0a       if silent:.
-0001eef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ef00: 7265 7475 726e 2054 7275 650a 2020 2020  return True.    
-0001ef10: 2020 2020 2020 2020 7265 7475 726e 2066          return f
-0001ef20: 6f72 6d61 745f 6564 6765 2872 6573 702e  ormat_edge(resp.
-0001ef30: 626f 6479 290a 0a20 2020 2020 2020 2072  body)..        r
-0001ef40: 6574 7572 6e20 7365 6c66 2e5f 6578 6563  eturn self._exec
-0001ef50: 7574 6528 7265 7175 6573 742c 2072 6573  ute(request, res
-0001ef60: 706f 6e73 655f 6861 6e64 6c65 7229 0a0a  ponse_handler)..
-0001ef70: 2020 2020 6465 6620 7570 6461 7465 280a      def update(.
-0001ef80: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0001ef90: 2020 2020 2020 6564 6765 3a20 4a73 6f6e        edge: Json
-0001efa0: 2c0a 2020 2020 2020 2020 6368 6563 6b5f  ,.        check_
-0001efb0: 7265 763a 2062 6f6f 6c20 3d20 5472 7565  rev: bool = True
-0001efc0: 2c0a 2020 2020 2020 2020 6b65 6570 5f6e  ,.        keep_n
-0001efd0: 6f6e 653a 2062 6f6f 6c20 3d20 5472 7565  one: bool = True
-0001efe0: 2c0a 2020 2020 2020 2020 7379 6e63 3a20  ,.        sync: 
-0001eff0: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 203d  Optional[bool] =
-0001f000: 204e 6f6e 652c 0a20 2020 2020 2020 2073   None,.        s
-0001f010: 696c 656e 743a 2062 6f6f 6c20 3d20 4661  ilent: bool = Fa
-0001f020: 6c73 652c 0a20 2020 2020 2020 2072 6574  lse,.        ret
-0001f030: 7572 6e5f 6f6c 643a 2062 6f6f 6c20 3d20  urn_old: bool = 
-0001f040: 4661 6c73 652c 0a20 2020 2020 2020 2072  False,.        r
-0001f050: 6574 7572 6e5f 6e65 773a 2062 6f6f 6c20  eturn_new: bool 
-0001f060: 3d20 4661 6c73 652c 0a20 2020 2029 202d  = False,.    ) -
-0001f070: 3e20 5265 7375 6c74 5b55 6e69 6f6e 5b62  > Result[Union[b
-0001f080: 6f6f 6c2c 204a 736f 6e5d 5d3a 0a20 2020  ool, Json]]:.   
-0001f090: 2020 2020 2022 2222 5570 6461 7465 2061       """Update a
-0001f0a0: 6e20 6564 6765 2064 6f63 756d 656e 742e  n edge document.
-0001f0b0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0001f0c0: 2065 6467 653a 2050 6172 7469 616c 206f   edge: Partial o
-0001f0d0: 7220 6675 6c6c 2065 6467 6520 646f 6375  r full edge docu
-0001f0e0: 6d65 6e74 2077 6974 6820 7570 6461 7465  ment with update
-0001f0f0: 6420 7661 6c75 6573 2e20 4974 206d 7573  d values. It mus
-0001f100: 740a 2020 2020 2020 2020 2020 2020 636f  t.            co
-0001f110: 6e74 6169 6e20 7468 6520 225f 6b65 7922  ntain the "_key"
-0001f120: 206f 7220 225f 6964 2220 6669 656c 642e   or "_id" field.
-0001f130: 0a20 2020 2020 2020 203a 7479 7065 2065  .        :type e
-0001f140: 6467 653a 2064 6963 740a 2020 2020 2020  dge: dict.      
-0001f150: 2020 3a70 6172 616d 2063 6865 636b 5f72    :param check_r
-0001f160: 6576 3a20 4966 2073 6574 2074 6f20 5472  ev: If set to Tr
-0001f170: 7565 2c20 7265 7669 7369 6f6e 206f 6620  ue, revision of 
-0001f180: 2a2a 6564 6765 2a2a 2028 6966 2067 6976  **edge** (if giv
-0001f190: 656e 2920 6973 0a20 2020 2020 2020 2020  en) is.         
-0001f1a0: 2020 2063 6f6d 7061 7265 6420 6167 6169     compared agai
-0001f1b0: 6e73 7420 7468 6520 7265 7669 7369 6f6e  nst the revision
-0001f1c0: 206f 6620 7461 7267 6574 2065 6467 6520   of target edge 
-0001f1d0: 646f 6375 6d65 6e74 2e0a 2020 2020 2020  document..      
-0001f1e0: 2020 3a74 7970 6520 6368 6563 6b5f 7265    :type check_re
-0001f1f0: 763a 2062 6f6f 6c0a 2020 2020 2020 2020  v: bool.        
-0001f200: 3a70 6172 616d 206b 6565 705f 6e6f 6e65  :param keep_none
-0001f210: 3a20 4966 2073 6574 2074 6f20 5472 7565  : If set to True
-0001f220: 2c20 6669 656c 6473 2077 6974 6820 7661  , fields with va
-0001f230: 6c75 6520 4e6f 6e65 2061 7265 2072 6574  lue None are ret
-0001f240: 6169 6e65 640a 2020 2020 2020 2020 2020  ained.          
-0001f250: 2020 696e 2074 6865 2064 6f63 756d 656e    in the documen
-0001f260: 742e 2049 6620 7365 7420 746f 2046 616c  t. If set to Fal
-0001f270: 7365 2c20 7468 6579 2061 7265 2072 656d  se, they are rem
-0001f280: 6f76 6564 2063 6f6d 706c 6574 656c 792e  oved completely.
-0001f290: 0a20 2020 2020 2020 203a 7479 7065 206b  .        :type k
-0001f2a0: 6565 705f 6e6f 6e65 3a20 626f 6f6c 207c  eep_none: bool |
-0001f2b0: 204e 6f6e 650a 2020 2020 2020 2020 3a70   None.        :p
-0001f2c0: 6172 616d 2073 796e 633a 2042 6c6f 636b  aram sync: Block
-0001f2d0: 2075 6e74 696c 206f 7065 7261 7469 6f6e   until operation
-0001f2e0: 2069 7320 7379 6e63 6872 6f6e 697a 6564   is synchronized
-0001f2f0: 2074 6f20 6469 736b 2e0a 2020 2020 2020   to disk..      
-0001f300: 2020 3a74 7970 6520 7379 6e63 3a20 626f    :type sync: bo
-0001f310: 6f6c 207c 204e 6f6e 650a 2020 2020 2020  ol | None.      
-0001f320: 2020 3a70 6172 616d 2073 696c 656e 743a    :param silent:
-0001f330: 2049 6620 7365 7420 746f 2054 7275 652c   If set to True,
-0001f340: 206e 6f20 646f 6375 6d65 6e74 206d 6574   no document met
-0001f350: 6164 6174 6120 6973 2072 6574 7572 6e65  adata is returne
-0001f360: 642e 2054 6869 730a 2020 2020 2020 2020  d. This.        
-0001f370: 2020 2020 6361 6e20 6265 2075 7365 6420      can be used 
-0001f380: 746f 2073 6176 6520 7265 736f 7572 6365  to save resource
-0001f390: 732e 0a20 2020 2020 2020 203a 7479 7065  s..        :type
-0001f3a0: 2073 696c 656e 743a 2062 6f6f 6c0a 2020   silent: bool.  
-0001f3b0: 2020 2020 2020 3a70 6172 616d 2072 6574        :param ret
-0001f3c0: 7572 6e5f 6f6c 643a 2049 6e63 6c75 6465  urn_old: Include
-0001f3d0: 2062 6f64 7920 6f66 2074 6865 206f 6c64   body of the old
-0001f3e0: 2064 6f63 756d 656e 7420 696e 2074 6865   document in the
-0001f3f0: 2072 6574 7572 6e65 640a 2020 2020 2020   returned.      
-0001f400: 2020 2020 2020 6d65 7461 6461 7461 2e20        metadata. 
-0001f410: 4967 6e6f 7265 6420 6966 2070 6172 616d  Ignored if param
-0001f420: 6574 6572 202a 2a73 696c 656e 742a 2a20  eter **silent** 
-0001f430: 6973 2073 6574 2074 6f20 5472 7565 2e0a  is set to True..
-0001f440: 2020 2020 2020 2020 3a74 7970 6520 7265          :type re
-0001f450: 7475 726e 5f6f 6c64 3a20 626f 6f6c 0a20  turn_old: bool. 
-0001f460: 2020 2020 2020 203a 7061 7261 6d20 7265         :param re
-0001f470: 7475 726e 5f6e 6577 3a20 496e 636c 7564  turn_new: Includ
-0001f480: 6520 626f 6479 206f 6620 7468 6520 6e65  e body of the ne
-0001f490: 7720 646f 6375 6d65 6e74 2069 6e20 7468  w document in th
-0001f4a0: 6520 7265 7475 726e 6564 0a20 2020 2020  e returned.     
-0001f4b0: 2020 2020 2020 206d 6574 6164 6174 612e         metadata.
-0001f4c0: 2049 676e 6f72 6564 2069 6620 7061 7261   Ignored if para
-0001f4d0: 6d65 7465 7220 2a2a 7369 6c65 6e74 2a2a  meter **silent**
-0001f4e0: 2069 7320 7365 7420 746f 2054 7275 652e   is set to True.
-0001f4f0: 0a20 2020 2020 2020 203a 7479 7065 2072  .        :type r
-0001f500: 6574 7572 6e5f 6e65 773a 2062 6f6f 6c0a  eturn_new: bool.
-0001f510: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-0001f520: 2044 6f63 756d 656e 7420 6d65 7461 6461   Document metada
-0001f530: 7461 2028 652e 672e 2064 6f63 756d 656e  ta (e.g. documen
-0001f540: 7420 6b65 792c 2072 6576 6973 696f 6e29  t key, revision)
-0001f550: 206f 7220 5472 7565 2069 660a 2020 2020   or True if.    
-0001f560: 2020 2020 2020 2020 7061 7261 6d65 7465          paramete
-0001f570: 7220 2a2a 7369 6c65 6e74 2a2a 2077 6173  r **silent** was
-0001f580: 2073 6574 2074 6f20 5472 7565 2e0a 2020   set to True..  
-0001f590: 2020 2020 2020 3a72 7479 7065 3a20 626f        :rtype: bo
-0001f5a0: 6f6c 207c 2064 6963 740a 2020 2020 2020  ol | dict.      
-0001f5b0: 2020 3a72 6169 7365 2061 7261 6e67 6f2e    :raise arango.
-0001f5c0: 6578 6365 7074 696f 6e73 2e44 6f63 756d  exceptions.Docum
-0001f5d0: 656e 7455 7064 6174 6545 7272 6f72 3a20  entUpdateError: 
-0001f5e0: 4966 2075 7064 6174 6520 6661 696c 732e  If update fails.
-0001f5f0: 0a20 2020 2020 2020 203a 7261 6973 6520  .        :raise 
-0001f600: 6172 616e 676f 2e65 7863 6570 7469 6f6e  arango.exception
-0001f610: 732e 446f 6375 6d65 6e74 5265 7669 7369  s.DocumentRevisi
-0001f620: 6f6e 4572 726f 723a 2049 6620 7265 7669  onError: If revi
-0001f630: 7369 6f6e 7320 6d69 736d 6174 6368 2e0a  sions mismatch..
-0001f640: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001f650: 2020 2020 6564 6765 5f69 642c 2068 6561      edge_id, hea
-0001f660: 6465 7273 203d 2073 656c 662e 5f70 7265  ders = self._pre
-0001f670: 705f 6672 6f6d 5f62 6f64 7928 6564 6765  p_from_body(edge
-0001f680: 2c20 6368 6563 6b5f 7265 7629 0a0a 2020  , check_rev)..  
-0001f690: 2020 2020 2020 7061 7261 6d73 3a20 5061        params: Pa
-0001f6a0: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
-0001f6b0: 2020 2020 2022 6b65 6570 4e75 6c6c 223a       "keepNull":
-0001f6c0: 206b 6565 705f 6e6f 6e65 2c0a 2020 2020   keep_none,.    
-0001f6d0: 2020 2020 2020 2020 226f 7665 7277 7269          "overwri
-0001f6e0: 7465 223a 206e 6f74 2063 6865 636b 5f72  te": not check_r
-0001f6f0: 6576 2c0a 2020 2020 2020 2020 2020 2020  ev,.            
-0001f700: 2273 696c 656e 7422 3a20 7369 6c65 6e74  "silent": silent
-0001f710: 2c0a 2020 2020 2020 2020 2020 2020 2272  ,.            "r
-0001f720: 6574 7572 6e4e 6577 223a 2072 6574 7572  eturnNew": retur
-0001f730: 6e5f 6e65 772c 0a20 2020 2020 2020 2020  n_new,.         
-0001f740: 2020 2022 7265 7475 726e 4f6c 6422 3a20     "returnOld": 
-0001f750: 7265 7475 726e 5f6f 6c64 2c0a 2020 2020  return_old,.    
-0001f760: 2020 2020 7d0a 2020 2020 2020 2020 6966      }.        if
-0001f770: 2073 796e 6320 6973 206e 6f74 204e 6f6e   sync is not Non
-0001f780: 653a 0a20 2020 2020 2020 2020 2020 2070  e:.            p
-0001f790: 6172 616d 735b 2277 6169 7446 6f72 5379  arams["waitForSy
-0001f7a0: 6e63 225d 203d 2073 796e 630a 0a20 2020  nc"] = sync..   
-0001f7b0: 2020 2020 2072 6571 7565 7374 203d 2052       request = R
-0001f7c0: 6571 7565 7374 280a 2020 2020 2020 2020  equest(.        
-0001f7d0: 2020 2020 6d65 7468 6f64 3d22 7061 7463      method="patc
-0001f7e0: 6822 2c0a 2020 2020 2020 2020 2020 2020  h",.            
-0001f7f0: 656e 6470 6f69 6e74 3d66 222f 5f61 7069  endpoint=f"/_api
-0001f800: 2f67 6861 7269 616c 2f7b 7365 6c66 2e5f  /gharial/{self._
-0001f810: 6772 6170 687d 2f65 6467 652f 7b65 6467  graph}/edge/{edg
-0001f820: 655f 6964 7d22 2c0a 2020 2020 2020 2020  e_id}",.        
-0001f830: 2020 2020 6865 6164 6572 733d 6865 6164      headers=head
-0001f840: 6572 732c 0a20 2020 2020 2020 2020 2020  ers,.           
-0001f850: 2070 6172 616d 733d 7061 7261 6d73 2c0a   params=params,.
-0001f860: 2020 2020 2020 2020 2020 2020 6461 7461              data
-0001f870: 3d65 6467 652c 0a20 2020 2020 2020 2020  =edge,.         
-0001f880: 2020 2077 7269 7465 3d73 656c 662e 6e61     write=self.na
-0001f890: 6d65 2c0a 2020 2020 2020 2020 290a 0a20  me,.        ).. 
-0001f8a0: 2020 2020 2020 2064 6566 2072 6573 706f         def respo
-0001f8b0: 6e73 655f 6861 6e64 6c65 7228 7265 7370  nse_handler(resp
-0001f8c0: 3a20 5265 7370 6f6e 7365 2920 2d3e 2055  : Response) -> U
-0001f8d0: 6e69 6f6e 5b62 6f6f 6c2c 204a 736f 6e5d  nion[bool, Json]
-0001f8e0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-0001f8f0: 2072 6573 702e 7374 6174 7573 5f63 6f64   resp.status_cod
-0001f900: 6520 3d3d 2034 3132 3a20 2023 2070 7261  e == 412:  # pra
-0001f910: 676d 613a 206e 6f20 636f 7665 720a 2020  gma: no cover.  
-0001f920: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-0001f930: 6973 6520 446f 6375 6d65 6e74 5265 7669  ise DocumentRevi
-0001f940: 7369 6f6e 4572 726f 7228 7265 7370 2c20  sionError(resp, 
-0001f950: 7265 7175 6573 7429 0a20 2020 2020 2020  request).       
-0001f960: 2020 2020 2069 6620 6e6f 7420 7265 7370       if not resp
-0001f970: 2e69 735f 7375 6363 6573 733a 0a20 2020  .is_success:.   
-0001f980: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0001f990: 7365 2044 6f63 756d 656e 7455 7064 6174  se DocumentUpdat
-0001f9a0: 6545 7272 6f72 2872 6573 702c 2072 6571  eError(resp, req
-0001f9b0: 7565 7374 290a 2020 2020 2020 2020 2020  uest).          
-0001f9c0: 2020 6966 2073 696c 656e 7420 6973 2054    if silent is T
-0001f9d0: 7275 653a 0a20 2020 2020 2020 2020 2020  rue:.           
-0001f9e0: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
-0001f9f0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0001fa00: 7572 6e20 666f 726d 6174 5f65 6467 6528  urn format_edge(
-0001fa10: 7265 7370 2e62 6f64 7929 0a0a 2020 2020  resp.body)..    
-0001fa20: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0001fa30: 5f65 7865 6375 7465 2872 6571 7565 7374  _execute(request
-0001fa40: 2c20 7265 7370 6f6e 7365 5f68 616e 646c  , response_handl
-0001fa50: 6572 290a 0a20 2020 2064 6566 2072 6570  er)..    def rep
-0001fa60: 6c61 6365 280a 2020 2020 2020 2020 7365  lace(.        se
-0001fa70: 6c66 2c0a 2020 2020 2020 2020 6564 6765  lf,.        edge
-0001fa80: 3a20 4a73 6f6e 2c0a 2020 2020 2020 2020  : Json,.        
-0001fa90: 6368 6563 6b5f 7265 763a 2062 6f6f 6c20  check_rev: bool 
-0001faa0: 3d20 5472 7565 2c0a 2020 2020 2020 2020  = True,.        
-0001fab0: 7379 6e63 3a20 4f70 7469 6f6e 616c 5b62  sync: Optional[b
-0001fac0: 6f6f 6c5d 203d 204e 6f6e 652c 0a20 2020  ool] = None,.   
-0001fad0: 2020 2020 2073 696c 656e 743a 2062 6f6f       silent: boo
-0001fae0: 6c20 3d20 4661 6c73 652c 0a20 2020 2020  l = False,.     
-0001faf0: 2020 2072 6574 7572 6e5f 6f6c 643a 2062     return_old: b
-0001fb00: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
-0001fb10: 2020 2020 2072 6574 7572 6e5f 6e65 773a       return_new:
-0001fb20: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
-0001fb30: 2020 2029 202d 3e20 5265 7375 6c74 5b55     ) -> Result[U
-0001fb40: 6e69 6f6e 5b62 6f6f 6c2c 204a 736f 6e5d  nion[bool, Json]
-0001fb50: 5d3a 0a20 2020 2020 2020 2022 2222 5265  ]:.        """Re
-0001fb60: 706c 6163 6520 616e 2065 6467 6520 646f  place an edge do
-0001fb70: 6375 6d65 6e74 2e0a 0a20 2020 2020 2020  cument...       
-0001fb80: 203a 7061 7261 6d20 6564 6765 3a20 4e65   :param edge: Ne
-0001fb90: 7720 6564 6765 2064 6f63 756d 656e 7420  w edge document 
-0001fba0: 746f 2072 6570 6c61 6365 2074 6865 206f  to replace the o
-0001fbb0: 6c64 206f 6e65 2077 6974 682e 2049 7420  ld one with. It 
-0001fbc0: 6d75 7374 0a20 2020 2020 2020 2020 2020  must.           
-0001fbd0: 2063 6f6e 7461 696e 2074 6865 2022 5f6b   contain the "_k
-0001fbe0: 6579 2220 6f72 2022 5f69 6422 2066 6965  ey" or "_id" fie
-0001fbf0: 6c64 2e20 4974 206d 7573 7420 616c 736f  ld. It must also
-0001fc00: 2063 6f6e 7461 696e 2074 6865 2022 5f66   contain the "_f
-0001fc10: 726f 6d22 0a20 2020 2020 2020 2020 2020  rom".           
-0001fc20: 2061 6e64 2022 5f74 6f22 2066 6965 6c64   and "_to" field
-0001fc30: 732e 0a20 2020 2020 2020 203a 7479 7065  s..        :type
-0001fc40: 2065 6467 653a 2064 6963 740a 2020 2020   edge: dict.    
-0001fc50: 2020 2020 3a70 6172 616d 2063 6865 636b      :param check
-0001fc60: 5f72 6576 3a20 4966 2073 6574 2074 6f20  _rev: If set to 
-0001fc70: 5472 7565 2c20 7265 7669 7369 6f6e 206f  True, revision o
-0001fc80: 6620 2a2a 6564 6765 2a2a 2028 6966 2067  f **edge** (if g
-0001fc90: 6976 656e 2920 6973 0a20 2020 2020 2020  iven) is.       
-0001fca0: 2020 2020 2063 6f6d 7061 7265 6420 6167       compared ag
-0001fcb0: 6169 6e73 7420 7468 6520 7265 7669 7369  ainst the revisi
-0001fcc0: 6f6e 206f 6620 7461 7267 6574 2065 6467  on of target edg
-0001fcd0: 6520 646f 6375 6d65 6e74 2e0a 2020 2020  e document..    
-0001fce0: 2020 2020 3a74 7970 6520 6368 6563 6b5f      :type check_
-0001fcf0: 7265 763a 2062 6f6f 6c0a 2020 2020 2020  rev: bool.      
-0001fd00: 2020 3a70 6172 616d 2073 796e 633a 2042    :param sync: B
-0001fd10: 6c6f 636b 2075 6e74 696c 206f 7065 7261  lock until opera
-0001fd20: 7469 6f6e 2069 7320 7379 6e63 6872 6f6e  tion is synchron
-0001fd30: 697a 6564 2074 6f20 6469 736b 2e0a 2020  ized to disk..  
-0001fd40: 2020 2020 2020 3a74 7970 6520 7379 6e63        :type sync
-0001fd50: 3a20 626f 6f6c 207c 204e 6f6e 650a 2020  : bool | None.  
-0001fd60: 2020 2020 2020 3a70 6172 616d 2073 696c        :param sil
-0001fd70: 656e 743a 2049 6620 7365 7420 746f 2054  ent: If set to T
-0001fd80: 7275 652c 206e 6f20 646f 6375 6d65 6e74  rue, no document
-0001fd90: 206d 6574 6164 6174 6120 6973 2072 6574   metadata is ret
-0001fda0: 7572 6e65 642e 2054 6869 730a 2020 2020  urned. This.    
-0001fdb0: 2020 2020 2020 2020 6361 6e20 6265 2075          can be u
-0001fdc0: 7365 6420 746f 2073 6176 6520 7265 736f  sed to save reso
-0001fdd0: 7572 6365 732e 0a20 2020 2020 2020 203a  urces..        :
-0001fde0: 7479 7065 2073 696c 656e 743a 2062 6f6f  type silent: boo
-0001fdf0: 6c0a 2020 2020 2020 2020 3a70 6172 616d  l.        :param
-0001fe00: 2072 6574 7572 6e5f 6f6c 643a 2049 6e63   return_old: Inc
-0001fe10: 6c75 6465 2062 6f64 7920 6f66 2074 6865  lude body of the
-0001fe20: 206f 6c64 2064 6f63 756d 656e 7420 696e   old document in
-0001fe30: 2074 6865 2072 6574 7572 6e65 640a 2020   the returned.  
-0001fe40: 2020 2020 2020 2020 2020 6d65 7461 6461            metada
-0001fe50: 7461 2e20 4967 6e6f 7265 6420 6966 2070  ta. Ignored if p
-0001fe60: 6172 616d 6574 6572 202a 2a73 696c 656e  arameter **silen
-0001fe70: 742a 2a20 6973 2073 6574 2074 6f20 5472  t** is set to Tr
-0001fe80: 7565 2e0a 2020 2020 2020 2020 3a74 7970  ue..        :typ
-0001fe90: 6520 7265 7475 726e 5f6f 6c64 3a20 626f  e return_old: bo
-0001fea0: 6f6c 0a20 2020 2020 2020 203a 7061 7261  ol.        :para
-0001feb0: 6d20 7265 7475 726e 5f6e 6577 3a20 496e  m return_new: In
-0001fec0: 636c 7564 6520 626f 6479 206f 6620 7468  clude body of th
-0001fed0: 6520 6e65 7720 646f 6375 6d65 6e74 2069  e new document i
-0001fee0: 6e20 7468 6520 7265 7475 726e 6564 0a20  n the returned. 
-0001fef0: 2020 2020 2020 2020 2020 206d 6574 6164             metad
-0001ff00: 6174 612e 2049 676e 6f72 6564 2069 6620  ata. Ignored if 
-0001ff10: 7061 7261 6d65 7465 7220 2a2a 7369 6c65  parameter **sile
-0001ff20: 6e74 2a2a 2069 7320 7365 7420 746f 2054  nt** is set to T
-0001ff30: 7275 652e 0a20 2020 2020 2020 203a 7479  rue..        :ty
-0001ff40: 7065 2072 6574 7572 6e5f 6e65 773a 2062  pe return_new: b
-0001ff50: 6f6f 6c0a 2020 2020 2020 2020 3a72 6574  ool.        :ret
-0001ff60: 7572 6e3a 2044 6f63 756d 656e 7420 6d65  urn: Document me
-0001ff70: 7461 6461 7461 2028 652e 672e 2064 6f63  tadata (e.g. doc
-0001ff80: 756d 656e 7420 6b65 792c 2072 6576 6973  ument key, revis
-0001ff90: 696f 6e29 206f 7220 5472 7565 2069 660a  ion) or True if.
-0001ffa0: 2020 2020 2020 2020 2020 2020 7061 7261              para
-0001ffb0: 6d65 7465 7220 2a2a 7369 6c65 6e74 2a2a  meter **silent**
-0001ffc0: 2077 6173 2073 6574 2074 6f20 5472 7565   was set to True
-0001ffd0: 2e0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
-0001ffe0: 3a20 626f 6f6c 207c 2064 6963 740a 2020  : bool | dict.  
-0001fff0: 2020 2020 2020 3a72 6169 7365 2061 7261        :raise ara
-00020000: 6e67 6f2e 6578 6365 7074 696f 6e73 2e44  ngo.exceptions.D
-00020010: 6f63 756d 656e 7452 6570 6c61 6365 4572  ocumentReplaceEr
-00020020: 726f 723a 2049 6620 7265 706c 6163 6520  ror: If replace 
-00020030: 6661 696c 732e 0a20 2020 2020 2020 203a  fails..        :
-00020040: 7261 6973 6520 6172 616e 676f 2e65 7863  raise arango.exc
-00020050: 6570 7469 6f6e 732e 446f 6375 6d65 6e74  eptions.Document
-00020060: 5265 7669 7369 6f6e 4572 726f 723a 2049  RevisionError: I
-00020070: 6620 7265 7669 7369 6f6e 7320 6d69 736d  f revisions mism
-00020080: 6174 6368 2e0a 2020 2020 2020 2020 2222  atch..        ""
-00020090: 220a 2020 2020 2020 2020 6564 6765 5f69  ".        edge_i
-000200a0: 642c 2068 6561 6465 7273 203d 2073 656c  d, headers = sel
-000200b0: 662e 5f70 7265 705f 6672 6f6d 5f62 6f64  f._prep_from_bod
-000200c0: 7928 6564 6765 2c20 6368 6563 6b5f 7265  y(edge, check_re
-000200d0: 7629 0a0a 2020 2020 2020 2020 7061 7261  v)..        para
-000200e0: 6d73 3a20 5061 7261 6d73 203d 207b 0a20  ms: Params = {. 
-000200f0: 2020 2020 2020 2020 2020 2022 7369 6c65             "sile
-00020100: 6e74 223a 2073 696c 656e 742c 0a20 2020  nt": silent,.   
-00020110: 2020 2020 2020 2020 2022 7265 7475 726e           "return
-00020120: 4e65 7722 3a20 7265 7475 726e 5f6e 6577  New": return_new
-00020130: 2c0a 2020 2020 2020 2020 2020 2020 2272  ,.            "r
-00020140: 6574 7572 6e4f 6c64 223a 2072 6574 7572  eturnOld": retur
-00020150: 6e5f 6f6c 642c 0a20 2020 2020 2020 207d  n_old,.        }
-00020160: 0a20 2020 2020 2020 2069 6620 7379 6e63  .        if sync
-00020170: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-00020180: 2020 2020 2020 2020 2020 7061 7261 6d73            params
-00020190: 5b22 7761 6974 466f 7253 796e 6322 5d20  ["waitForSync"] 
-000201a0: 3d20 7379 6e63 0a0a 2020 2020 2020 2020  = sync..        
-000201b0: 7265 7175 6573 7420 3d20 5265 7175 6573  request = Reques
-000201c0: 7428 0a20 2020 2020 2020 2020 2020 206d  t(.            m
-000201d0: 6574 686f 643d 2270 7574 222c 0a20 2020  ethod="put",.   
-000201e0: 2020 2020 2020 2020 2065 6e64 706f 696e           endpoin
-000201f0: 743d 6622 2f5f 6170 692f 6768 6172 6961  t=f"/_api/gharia
-00020200: 6c2f 7b73 656c 662e 5f67 7261 7068 7d2f  l/{self._graph}/
-00020210: 6564 6765 2f7b 6564 6765 5f69 647d 222c  edge/{edge_id}",
-00020220: 0a20 2020 2020 2020 2020 2020 2068 6561  .            hea
-00020230: 6465 7273 3d68 6561 6465 7273 2c0a 2020  ders=headers,.  
-00020240: 2020 2020 2020 2020 2020 7061 7261 6d73            params
-00020250: 3d70 6172 616d 732c 0a20 2020 2020 2020  =params,.       
-00020260: 2020 2020 2064 6174 613d 6564 6765 2c0a       data=edge,.
-00020270: 2020 2020 2020 2020 2020 2020 7772 6974              writ
-00020280: 653d 7365 6c66 2e6e 616d 652c 0a20 2020  e=self.name,.   
-00020290: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-000202a0: 6465 6620 7265 7370 6f6e 7365 5f68 616e  def response_han
-000202b0: 646c 6572 2872 6573 703a 2052 6573 706f  dler(resp: Respo
-000202c0: 6e73 6529 202d 3e20 556e 696f 6e5b 626f  nse) -> Union[bo
-000202d0: 6f6c 2c20 4a73 6f6e 5d3a 0a20 2020 2020  ol, Json]:.     
-000202e0: 2020 2020 2020 2069 6620 7265 7370 2e73         if resp.s
-000202f0: 7461 7475 735f 636f 6465 203d 3d20 3431  tatus_code == 41
-00020300: 323a 2020 2320 7072 6167 6d61 3a20 6e6f  2:  # pragma: no
-00020310: 2063 6f76 6572 0a20 2020 2020 2020 2020   cover.         
-00020320: 2020 2020 2020 2072 6169 7365 2044 6f63         raise Doc
-00020330: 756d 656e 7452 6576 6973 696f 6e45 7272  umentRevisionErr
-00020340: 6f72 2872 6573 702c 2072 6571 7565 7374  or(resp, request
-00020350: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-00020360: 206e 6f74 2072 6573 702e 6973 5f73 7563   not resp.is_suc
-00020370: 6365 7373 3a0a 2020 2020 2020 2020 2020  cess:.          
-00020380: 2020 2020 2020 7261 6973 6520 446f 6375        raise Docu
-00020390: 6d65 6e74 5265 706c 6163 6545 7272 6f72  mentReplaceError
-000203a0: 2872 6573 702c 2072 6571 7565 7374 290a  (resp, request).
-000203b0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-000203c0: 696c 656e 7420 6973 2054 7275 653a 0a20  ilent is True:. 
-000203d0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000203e0: 6574 7572 6e20 5472 7565 0a20 2020 2020  eturn True.     
-000203f0: 2020 2020 2020 2072 6574 7572 6e20 666f         return fo
-00020400: 726d 6174 5f65 6467 6528 7265 7370 2e62  rmat_edge(resp.b
-00020410: 6f64 7929 0a0a 2020 2020 2020 2020 7265  ody)..        re
-00020420: 7475 726e 2073 656c 662e 5f65 7865 6375  turn self._execu
-00020430: 7465 2872 6571 7565 7374 2c20 7265 7370  te(request, resp
-00020440: 6f6e 7365 5f68 616e 646c 6572 290a 0a20  onse_handler).. 
-00020450: 2020 2064 6566 2064 656c 6574 6528 0a20     def delete(. 
-00020460: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00020470: 2020 2020 2065 6467 653a 2055 6e69 6f6e       edge: Union
-00020480: 5b73 7472 2c20 4a73 6f6e 5d2c 0a20 2020  [str, Json],.   
-00020490: 2020 2020 2072 6576 3a20 4f70 7469 6f6e       rev: Option
-000204a0: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
-000204b0: 2020 2020 2020 2020 6368 6563 6b5f 7265          check_re
-000204c0: 763a 2062 6f6f 6c20 3d20 5472 7565 2c0a  v: bool = True,.
-000204d0: 2020 2020 2020 2020 6967 6e6f 7265 5f6d          ignore_m
-000204e0: 6973 7369 6e67 3a20 626f 6f6c 203d 2046  issing: bool = F
-000204f0: 616c 7365 2c0a 2020 2020 2020 2020 7379  alse,.        sy
-00020500: 6e63 3a20 4f70 7469 6f6e 616c 5b62 6f6f  nc: Optional[boo
-00020510: 6c5d 203d 204e 6f6e 652c 0a20 2020 2020  l] = None,.     
-00020520: 2020 2072 6574 7572 6e5f 6f6c 643a 2062     return_old: b
-00020530: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
-00020540: 2029 202d 3e20 5265 7375 6c74 5b55 6e69   ) -> Result[Uni
-00020550: 6f6e 5b62 6f6f 6c2c 204a 736f 6e5d 5d3a  on[bool, Json]]:
-00020560: 0a20 2020 2020 2020 2022 2222 4465 6c65  .        """Dele
-00020570: 7465 2061 6e20 6564 6765 2064 6f63 756d  te an edge docum
-00020580: 656e 742e 0a0a 2020 2020 2020 2020 3a70  ent...        :p
-00020590: 6172 616d 2065 6467 653a 2045 6467 6520  aram edge: Edge 
-000205a0: 646f 6375 6d65 6e74 2049 442c 206b 6579  document ID, key
-000205b0: 206f 7220 626f 6479 2e20 446f 6375 6d65   or body. Docume
-000205c0: 6e74 2062 6f64 7920 6d75 7374 2063 6f6e  nt body must con
-000205d0: 7461 696e 0a20 2020 2020 2020 2020 2020  tain.           
-000205e0: 2074 6865 2022 5f69 6422 206f 7220 225f   the "_id" or "_
-000205f0: 6b65 7922 2066 6965 6c64 2e0a 2020 2020  key" field..    
-00020600: 2020 2020 3a74 7970 6520 6564 6765 3a20      :type edge: 
-00020610: 7374 7220 7c20 6469 6374 0a20 2020 2020  str | dict.     
-00020620: 2020 203a 7061 7261 6d20 7265 763a 2045     :param rev: E
-00020630: 7870 6563 7465 6420 646f 6375 6d65 6e74  xpected document
-00020640: 2072 6576 6973 696f 6e2e 204f 7665 7272   revision. Overr
-00020650: 6964 6573 2074 6865 2076 616c 7565 206f  ides the value o
-00020660: 6620 225f 7265 7622 0a20 2020 2020 2020  f "_rev".       
-00020670: 2020 2020 2066 6965 6c64 2069 6e20 2a2a       field in **
-00020680: 6564 6765 2a2a 2069 6620 7072 6573 656e  edge** if presen
-00020690: 742e 0a20 2020 2020 2020 203a 7479 7065  t..        :type
-000206a0: 2072 6576 3a20 7374 7220 7c20 4e6f 6e65   rev: str | None
-000206b0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-000206c0: 6368 6563 6b5f 7265 763a 2049 6620 7365  check_rev: If se
-000206d0: 7420 746f 2054 7275 652c 2072 6576 6973  t to True, revis
-000206e0: 696f 6e20 6f66 202a 2a65 6467 652a 2a20  ion of **edge** 
-000206f0: 2869 6620 6769 7665 6e29 2069 730a 2020  (if given) is.  
-00020700: 2020 2020 2020 2020 2020 636f 6d70 6172            compar
-00020710: 6564 2061 6761 696e 7374 2074 6865 2072  ed against the r
-00020720: 6576 6973 696f 6e20 6f66 2074 6172 6765  evision of targe
-00020730: 7420 6564 6765 2064 6f63 756d 656e 742e  t edge document.
-00020740: 0a20 2020 2020 2020 203a 7479 7065 2063  .        :type c
-00020750: 6865 636b 5f72 6576 3a20 626f 6f6c 0a20  heck_rev: bool. 
-00020760: 2020 2020 2020 203a 7061 7261 6d20 6967         :param ig
-00020770: 6e6f 7265 5f6d 6973 7369 6e67 3a20 446f  nore_missing: Do
-00020780: 206e 6f74 2072 6169 7365 2061 6e20 6578   not raise an ex
-00020790: 6365 7074 696f 6e20 6f6e 206d 6973 7369  ception on missi
-000207a0: 6e67 2064 6f63 756d 656e 742e 0a20 2020  ng document..   
-000207b0: 2020 2020 2020 2020 2054 6869 7320 7061           This pa
-000207c0: 7261 6d65 7465 7220 6861 7320 6e6f 2065  rameter has no e
-000207d0: 6666 6563 7420 696e 2074 7261 6e73 6163  ffect in transac
-000207e0: 7469 6f6e 7320 7768 6572 6520 616e 2065  tions where an e
-000207f0: 7863 6570 7469 6f6e 2069 730a 2020 2020  xception is.    
-00020800: 2020 2020 2020 2020 616c 7761 7973 2072          always r
-00020810: 6169 7365 6420 6f6e 2066 6169 6c75 7265  aised on failure
-00020820: 732e 0a20 2020 2020 2020 203a 7479 7065  s..        :type
-00020830: 2069 676e 6f72 655f 6d69 7373 696e 673a   ignore_missing:
-00020840: 2062 6f6f 6c0a 2020 2020 2020 2020 3a70   bool.        :p
-00020850: 6172 616d 2073 796e 633a 2042 6c6f 636b  aram sync: Block
-00020860: 2075 6e74 696c 206f 7065 7261 7469 6f6e   until operation
-00020870: 2069 7320 7379 6e63 6872 6f6e 697a 6564   is synchronized
-00020880: 2074 6f20 6469 736b 2e0a 2020 2020 2020   to disk..      
-00020890: 2020 3a74 7970 6520 7379 6e63 3a20 626f    :type sync: bo
-000208a0: 6f6c 207c 204e 6f6e 650a 2020 2020 2020  ol | None.      
-000208b0: 2020 3a70 6172 616d 2072 6574 7572 6e5f    :param return_
-000208c0: 6f6c 643a 2052 6574 7572 6e20 626f 6479  old: Return body
-000208d0: 206f 6620 7468 6520 6f6c 6420 646f 6375   of the old docu
-000208e0: 6d65 6e74 2069 6e20 7468 6520 7265 7375  ment in the resu
-000208f0: 6c74 2e0a 2020 2020 2020 2020 3a74 7970  lt..        :typ
-00020900: 6520 7265 7475 726e 5f6f 6c64 3a20 626f  e return_old: bo
-00020910: 6f6c 0a20 2020 2020 2020 203a 7265 7475  ol.        :retu
-00020920: 726e 3a20 5472 7565 2069 6620 6564 6765  rn: True if edge
-00020930: 2077 6173 2064 656c 6574 6564 2073 7563   was deleted suc
-00020940: 6365 7373 6675 6c6c 792c 2046 616c 7365  cessfully, False
-00020950: 2069 6620 6564 6765 2077 6173 206e 6f74   if edge was not
-00020960: 0a20 2020 2020 2020 2020 2020 2066 6f75  .            fou
-00020970: 6e64 2061 6e64 202a 2a69 676e 6f72 655f  nd and **ignore_
-00020980: 6d69 7373 696e 672a 2a20 7761 7320 7365  missing** was se
-00020990: 7420 746f 2054 7275 6520 2864 6f65 7320  t to True (does 
-000209a0: 6e6f 7420 2061 7070 6c79 2069 6e0a 2020  not  apply in.  
-000209b0: 2020 2020 2020 2020 2020 7472 616e 7361            transa
-000209c0: 6374 696f 6e73 292e 0a20 2020 2020 2020  ctions)..       
-000209d0: 203a 7274 7970 653a 2062 6f6f 6c0a 2020   :rtype: bool.  
-000209e0: 2020 2020 2020 3a72 6169 7365 2061 7261        :raise ara
-000209f0: 6e67 6f2e 6578 6365 7074 696f 6e73 2e44  ngo.exceptions.D
-00020a00: 6f63 756d 656e 7444 656c 6574 6545 7272  ocumentDeleteErr
-00020a10: 6f72 3a20 4966 2064 656c 6574 6520 6661  or: If delete fa
-00020a20: 696c 732e 0a20 2020 2020 2020 203a 7261  ils..        :ra
-00020a30: 6973 6520 6172 616e 676f 2e65 7863 6570  ise arango.excep
-00020a40: 7469 6f6e 732e 446f 6375 6d65 6e74 5265  tions.DocumentRe
-00020a50: 7669 7369 6f6e 4572 726f 723a 2049 6620  visionError: If 
-00020a60: 7265 7669 7369 6f6e 7320 6d69 736d 6174  revisions mismat
-00020a70: 6368 2e0a 2020 2020 2020 2020 2222 220a  ch..        """.
-00020a80: 2020 2020 2020 2020 6861 6e64 6c65 2c20          handle, 
-00020a90: 5f2c 2068 6561 6465 7273 203d 2073 656c  _, headers = sel
-00020aa0: 662e 5f70 7265 705f 6672 6f6d 5f64 6f63  f._prep_from_doc
-00020ab0: 2865 6467 652c 2072 6576 2c20 6368 6563  (edge, rev, chec
-00020ac0: 6b5f 7265 7629 0a0a 2020 2020 2020 2020  k_rev)..        
-00020ad0: 7061 7261 6d73 3a20 5061 7261 6d73 203d  params: Params =
-00020ae0: 207b 2272 6574 7572 6e4f 6c64 223a 2072   {"returnOld": r
-00020af0: 6574 7572 6e5f 6f6c 647d 0a20 2020 2020  eturn_old}.     
-00020b00: 2020 2069 6620 7379 6e63 2069 7320 6e6f     if sync is no
-00020b10: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00020b20: 2020 2020 7061 7261 6d73 5b22 7761 6974      params["wait
-00020b30: 466f 7253 796e 6322 5d20 3d20 7379 6e63  ForSync"] = sync
-00020b40: 0a0a 2020 2020 2020 2020 7265 7175 6573  ..        reques
-00020b50: 7420 3d20 5265 7175 6573 7428 0a20 2020  t = Request(.   
-00020b60: 2020 2020 2020 2020 206d 6574 686f 643d           method=
-00020b70: 2264 656c 6574 6522 2c0a 2020 2020 2020  "delete",.      
-00020b80: 2020 2020 2020 656e 6470 6f69 6e74 3d66        endpoint=f
-00020b90: 222f 5f61 7069 2f67 6861 7269 616c 2f7b  "/_api/gharial/{
-00020ba0: 7365 6c66 2e5f 6772 6170 687d 2f65 6467  self._graph}/edg
-00020bb0: 652f 7b68 616e 646c 657d 222c 0a20 2020  e/{handle}",.   
-00020bc0: 2020 2020 2020 2020 2070 6172 616d 733d           params=
-00020bd0: 7061 7261 6d73 2c0a 2020 2020 2020 2020  params,.        
-00020be0: 2020 2020 6865 6164 6572 733d 6865 6164      headers=head
-00020bf0: 6572 732c 0a20 2020 2020 2020 2020 2020  ers,.           
-00020c00: 2077 7269 7465 3d73 656c 662e 6e61 6d65   write=self.name
-00020c10: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-00020c20: 2020 2020 2064 6566 2072 6573 706f 6e73       def respons
-00020c30: 655f 6861 6e64 6c65 7228 7265 7370 3a20  e_handler(resp: 
-00020c40: 5265 7370 6f6e 7365 2920 2d3e 2055 6e69  Response) -> Uni
-00020c50: 6f6e 5b62 6f6f 6c2c 204a 736f 6e5d 3a0a  on[bool, Json]:.
-00020c60: 2020 2020 2020 2020 2020 2020 6966 2072              if r
-00020c70: 6573 702e 6572 726f 725f 636f 6465 203d  esp.error_code =
-00020c80: 3d20 3132 3032 2061 6e64 2069 676e 6f72  = 1202 and ignor
-00020c90: 655f 6d69 7373 696e 673a 0a20 2020 2020  e_missing:.     
-00020ca0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00020cb0: 6e20 4661 6c73 650a 2020 2020 2020 2020  n False.        
-00020cc0: 2020 2020 6966 2072 6573 702e 7374 6174      if resp.stat
-00020cd0: 7573 5f63 6f64 6520 3d3d 2034 3132 3a20  us_code == 412: 
-00020ce0: 2023 2070 7261 676d 613a 206e 6f20 636f   # pragma: no co
-00020cf0: 7665 720a 2020 2020 2020 2020 2020 2020  ver.            
-00020d00: 2020 2020 7261 6973 6520 446f 6375 6d65      raise Docume
-00020d10: 6e74 5265 7669 7369 6f6e 4572 726f 7228  ntRevisionError(
-00020d20: 7265 7370 2c20 7265 7175 6573 7429 0a20  resp, request). 
-00020d30: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-00020d40: 7420 7265 7370 2e69 735f 7375 6363 6573  t resp.is_succes
-00020d50: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-00020d60: 2020 2072 6169 7365 2044 6f63 756d 656e     raise Documen
-00020d70: 7444 656c 6574 6545 7272 6f72 2872 6573  tDeleteError(res
-00020d80: 702c 2072 6571 7565 7374 290a 0a20 2020  p, request)..   
-00020d90: 2020 2020 2020 2020 2072 6573 756c 743a           result:
-00020da0: 204a 736f 6e20 3d20 7265 7370 2e62 6f64   Json = resp.bod
-00020db0: 790a 2020 2020 2020 2020 2020 2020 7265  y.            re
-00020dc0: 7475 726e 207b 226f 6c64 223a 2072 6573  turn {"old": res
-00020dd0: 756c 745b 226f 6c64 225d 7d20 6966 2072  ult["old"]} if r
-00020de0: 6574 7572 6e5f 6f6c 6420 656c 7365 2054  eturn_old else T
-00020df0: 7275 650a 0a20 2020 2020 2020 2072 6574  rue..        ret
-00020e00: 7572 6e20 7365 6c66 2e5f 6578 6563 7574  urn self._execut
-00020e10: 6528 7265 7175 6573 742c 2072 6573 706f  e(request, respo
-00020e20: 6e73 655f 6861 6e64 6c65 7229 0a0a 2020  nse_handler)..  
-00020e30: 2020 6465 6620 6c69 6e6b 280a 2020 2020    def link(.    
-00020e40: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00020e50: 2020 6672 6f6d 5f76 6572 7465 783a 2055    from_vertex: U
-00020e60: 6e69 6f6e 5b73 7472 2c20 4a73 6f6e 5d2c  nion[str, Json],
-00020e70: 0a20 2020 2020 2020 2074 6f5f 7665 7274  .        to_vert
-00020e80: 6578 3a20 556e 696f 6e5b 7374 722c 204a  ex: Union[str, J
-00020e90: 736f 6e5d 2c0a 2020 2020 2020 2020 6461  son],.        da
-00020ea0: 7461 3a20 4f70 7469 6f6e 616c 5b4a 736f  ta: Optional[Jso
-00020eb0: 6e5d 203d 204e 6f6e 652c 0a20 2020 2020  n] = None,.     
-00020ec0: 2020 2073 796e 633a 204f 7074 696f 6e61     sync: Optiona
-00020ed0: 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65 2c0a  l[bool] = None,.
-00020ee0: 2020 2020 2020 2020 7369 6c65 6e74 3a20          silent: 
-00020ef0: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
-00020f00: 2020 2020 2020 7265 7475 726e 5f6e 6577        return_new
-00020f10: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
-00020f20: 2020 2020 2920 2d3e 2052 6573 756c 745b      ) -> Result[
-00020f30: 556e 696f 6e5b 626f 6f6c 2c20 4a73 6f6e  Union[bool, Json
-00020f40: 5d5d 3a0a 2020 2020 2020 2020 2222 2249  ]]:.        """I
-00020f50: 6e73 6572 7420 6120 6e65 7720 6564 6765  nsert a new edge
-00020f60: 2064 6f63 756d 656e 7420 6c69 6e6b 696e   document linkin
-00020f70: 6720 7468 6520 6769 7665 6e20 7665 7274  g the given vert
-00020f80: 6963 6573 2e0a 0a20 2020 2020 2020 203a  ices...        :
-00020f90: 7061 7261 6d20 6672 6f6d 5f76 6572 7465  param from_verte
-00020fa0: 783a 2022 4672 6f6d 2220 7665 7274 6578  x: "From" vertex
-00020fb0: 2064 6f63 756d 656e 7420 4944 206f 7220   document ID or 
-00020fc0: 626f 6479 2077 6974 6820 225f 6964 2220  body with "_id" 
-00020fd0: 6669 656c 642e 0a20 2020 2020 2020 203a  field..        :
-00020fe0: 7479 7065 2066 726f 6d5f 7665 7274 6578  type from_vertex
-00020ff0: 3a20 7374 7220 7c20 6469 6374 0a20 2020  : str | dict.   
-00021000: 2020 2020 203a 7061 7261 6d20 746f 5f76       :param to_v
-00021010: 6572 7465 783a 2022 546f 2220 7665 7274  ertex: "To" vert
-00021020: 6578 2064 6f63 756d 656e 7420 4944 206f  ex document ID o
-00021030: 7220 626f 6479 2077 6974 6820 225f 6964  r body with "_id
-00021040: 2220 6669 656c 642e 0a20 2020 2020 2020  " field..       
-00021050: 203a 7479 7065 2074 6f5f 7665 7274 6578   :type to_vertex
-00021060: 3a20 7374 7220 7c20 6469 6374 0a20 2020  : str | dict.   
-00021070: 2020 2020 203a 7061 7261 6d20 6461 7461       :param data
-00021080: 3a20 416e 7920 6578 7472 6120 6461 7461  : Any extra data
-00021090: 2066 6f72 2074 6865 206e 6577 2065 6467   for the new edg
-000210a0: 6520 646f 6375 6d65 6e74 2e20 4966 2069  e document. If i
-000210b0: 7420 6861 7320 225f 6b65 7922 0a20 2020  t has "_key".   
-000210c0: 2020 2020 2020 2020 206f 7220 225f 6964           or "_id
-000210d0: 2220 6669 656c 642c 2069 7473 2076 616c  " field, its val
-000210e0: 7565 2069 7320 7573 6564 2061 7320 6b65  ue is used as ke
-000210f0: 7920 6f66 2074 6865 206e 6577 2065 6467  y of the new edg
-00021100: 6520 646f 6375 6d65 6e74 0a20 2020 2020  e document.     
-00021110: 2020 2020 2020 2028 6f74 6865 7277 6973         (otherwis
-00021120: 6520 6974 2069 7320 6175 746f 2d67 656e  e it is auto-gen
-00021130: 6572 6174 6564 292e 0a20 2020 2020 2020  erated)..       
-00021140: 203a 7479 7065 2064 6174 613a 2064 6963   :type data: dic
-00021150: 7420 7c20 4e6f 6e65 0a20 2020 2020 2020  t | None.       
-00021160: 203a 7061 7261 6d20 7379 6e63 3a20 426c   :param sync: Bl
-00021170: 6f63 6b20 756e 7469 6c20 6f70 6572 6174  ock until operat
-00021180: 696f 6e20 6973 2073 796e 6368 726f 6e69  ion is synchroni
-00021190: 7a65 6420 746f 2064 6973 6b2e 0a20 2020  zed to disk..   
-000211a0: 2020 2020 203a 7479 7065 2073 796e 633a       :type sync:
-000211b0: 2062 6f6f 6c20 7c20 4e6f 6e65 0a20 2020   bool | None.   
-000211c0: 2020 2020 203a 7061 7261 6d20 7369 6c65       :param sile
-000211d0: 6e74 3a20 4966 2073 6574 2074 6f20 5472  nt: If set to Tr
-000211e0: 7565 2c20 6e6f 2064 6f63 756d 656e 7420  ue, no document 
-000211f0: 6d65 7461 6461 7461 2069 7320 7265 7475  metadata is retu
-00021200: 726e 6564 2e20 5468 6973 0a20 2020 2020  rned. This.     
-00021210: 2020 2020 2020 2063 616e 2062 6520 7573         can be us
-00021220: 6564 2074 6f20 7361 7665 2072 6573 6f75  ed to save resou
-00021230: 7263 6573 2e0a 2020 2020 2020 2020 3a74  rces..        :t
-00021240: 7970 6520 7369 6c65 6e74 3a20 626f 6f6c  ype silent: bool
-00021250: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00021260: 7265 7475 726e 5f6e 6577 3a20 496e 636c  return_new: Incl
-00021270: 7564 6520 626f 6479 206f 6620 7468 6520  ude body of the 
-00021280: 6e65 7720 646f 6375 6d65 6e74 2069 6e20  new document in 
-00021290: 7468 6520 7265 7475 726e 6564 0a20 2020  the returned.   
-000212a0: 2020 2020 2020 2020 206d 6574 6164 6174           metadat
-000212b0: 612e 2049 676e 6f72 6564 2069 6620 7061  a. Ignored if pa
-000212c0: 7261 6d65 7465 7220 2a2a 7369 6c65 6e74  rameter **silent
-000212d0: 2a2a 2069 7320 7365 7420 746f 2054 7275  ** is set to Tru
-000212e0: 652e 0a20 2020 2020 2020 203a 7479 7065  e..        :type
-000212f0: 2072 6574 7572 6e5f 6e65 773a 2062 6f6f   return_new: boo
-00021300: 6c0a 2020 2020 2020 2020 3a72 6574 7572  l.        :retur
-00021310: 6e3a 2044 6f63 756d 656e 7420 6d65 7461  n: Document meta
-00021320: 6461 7461 2028 652e 672e 2064 6f63 756d  data (e.g. docum
-00021330: 656e 7420 6b65 792c 2072 6576 6973 696f  ent key, revisio
-00021340: 6e29 206f 7220 5472 7565 2069 660a 2020  n) or True if.  
-00021350: 2020 2020 2020 2020 2020 7061 7261 6d65            parame
-00021360: 7465 7220 2a2a 7369 6c65 6e74 2a2a 2077  ter **silent** w
-00021370: 6173 2073 6574 2074 6f20 5472 7565 2e0a  as set to True..
-00021380: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
-00021390: 626f 6f6c 207c 2064 6963 740a 2020 2020  bool | dict.    
-000213a0: 2020 2020 3a72 6169 7365 2061 7261 6e67      :raise arang
-000213b0: 6f2e 6578 6365 7074 696f 6e73 2e44 6f63  o.exceptions.Doc
-000213c0: 756d 656e 7449 6e73 6572 7445 7272 6f72  umentInsertError
-000213d0: 3a20 4966 2069 6e73 6572 7420 6661 696c  : If insert fail
-000213e0: 732e 0a20 2020 2020 2020 2022 2222 0a20  s..        """. 
-000213f0: 2020 2020 2020 2065 6467 6520 3d20 7b22         edge = {"
-00021400: 5f66 726f 6d22 3a20 6765 745f 646f 635f  _from": get_doc_
-00021410: 6964 2866 726f 6d5f 7665 7274 6578 292c  id(from_vertex),
-00021420: 2022 5f74 6f22 3a20 6765 745f 646f 635f   "_to": get_doc_
-00021430: 6964 2874 6f5f 7665 7274 6578 297d 0a20  id(to_vertex)}. 
-00021440: 2020 2020 2020 2069 6620 6461 7461 2069         if data i
-00021450: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-00021460: 2020 2020 2020 2020 6564 6765 2e75 7064          edge.upd
-00021470: 6174 6528 7365 6c66 2e5f 656e 7375 7265  ate(self._ensure
-00021480: 5f6b 6579 5f66 726f 6d5f 6964 2864 6174  _key_from_id(dat
-00021490: 6129 290a 2020 2020 2020 2020 7265 7475  a)).        retu
-000214a0: 726e 2073 656c 662e 696e 7365 7274 2865  rn self.insert(e
-000214b0: 6467 652c 2073 796e 633d 7379 6e63 2c20  dge, sync=sync, 
-000214c0: 7369 6c65 6e74 3d73 696c 656e 742c 2072  silent=silent, r
-000214d0: 6574 7572 6e5f 6e65 773d 7265 7475 726e  eturn_new=return
-000214e0: 5f6e 6577 290a 0a20 2020 2064 6566 2065  _new)..    def e
-000214f0: 6467 6573 280a 2020 2020 2020 2020 7365  dges(.        se
-00021500: 6c66 2c0a 2020 2020 2020 2020 7665 7274  lf,.        vert
-00021510: 6578 3a20 556e 696f 6e5b 7374 722c 204a  ex: Union[str, J
-00021520: 736f 6e5d 2c0a 2020 2020 2020 2020 6469  son],.        di
-00021530: 7265 6374 696f 6e3a 204f 7074 696f 6e61  rection: Optiona
-00021540: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
-00021550: 2020 2020 2020 2061 6c6c 6f77 5f64 6972         allow_dir
-00021560: 7479 5f72 6561 643a 2062 6f6f 6c20 3d20  ty_read: bool = 
-00021570: 4661 6c73 652c 0a20 2020 2029 202d 3e20  False,.    ) -> 
-00021580: 5265 7375 6c74 5b4a 736f 6e5d 3a0a 2020  Result[Json]:.  
-00021590: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
-000215a0: 7468 6520 6564 6765 2064 6f63 756d 656e  the edge documen
-000215b0: 7473 2063 6f6d 696e 6720 696e 2061 6e64  ts coming in and
-000215c0: 2f6f 7220 6f75 7420 6f66 2074 6865 2076  /or out of the v
-000215d0: 6572 7465 782e 0a0a 2020 2020 2020 2020  ertex...        
-000215e0: 3a70 6172 616d 2076 6572 7465 783a 2056  :param vertex: V
-000215f0: 6572 7465 7820 646f 6375 6d65 6e74 2049  ertex document I
-00021600: 4420 6f72 2062 6f64 7920 7769 7468 2022  D or body with "
-00021610: 5f69 6422 2066 6965 6c64 2e0a 2020 2020  _id" field..    
-00021620: 2020 2020 3a74 7970 6520 7665 7274 6578      :type vertex
-00021630: 3a20 7374 7220 7c20 6469 6374 0a20 2020  : str | dict.   
-00021640: 2020 2020 203a 7061 7261 6d20 6469 7265       :param dire
-00021650: 6374 696f 6e3a 2054 6865 2064 6972 6563  ction: The direc
-00021660: 7469 6f6e 206f 6620 7468 6520 6564 6765  tion of the edge
-00021670: 732e 2041 6c6c 6f77 6564 2076 616c 7565  s. Allowed value
-00021680: 7320 6172 6520 2269 6e22 0a20 2020 2020  s are "in".     
-00021690: 2020 2020 2020 2061 6e64 2022 6f75 7422         and "out"
-000216a0: 2e20 4966 206e 6f74 2073 6574 2c20 6564  . If not set, ed
-000216b0: 6765 7320 696e 2062 6f74 6820 6469 7265  ges in both dire
-000216c0: 6374 696f 6e73 2061 7265 2072 6574 7572  ctions are retur
-000216d0: 6e65 642e 0a20 2020 2020 2020 203a 7479  ned..        :ty
-000216e0: 7065 2064 6972 6563 7469 6f6e 3a20 7374  pe direction: st
-000216f0: 720a 2020 2020 2020 2020 3a70 6172 616d  r.        :param
-00021700: 2061 6c6c 6f77 5f64 6972 7479 5f72 6561   allow_dirty_rea
-00021710: 643a 2041 6c6c 6f77 2072 6561 6473 2066  d: Allow reads f
-00021720: 726f 6d20 666f 6c6c 6f77 6572 7320 696e  rom followers in
-00021730: 2061 2063 6c75 7374 6572 2e0a 2020 2020   a cluster..    
-00021740: 2020 2020 3a74 7970 6520 616c 6c6f 775f      :type allow_
-00021750: 6469 7274 795f 7265 6164 3a20 626f 6f6c  dirty_read: bool
-00021760: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-00021770: 3a20 4c69 7374 206f 6620 6564 6765 7320  : List of edges 
-00021780: 616e 6420 7374 6174 6973 7469 6373 2e0a  and statistics..
-00021790: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
-000217a0: 6469 6374 0a20 2020 2020 2020 203a 7261  dict.        :ra
-000217b0: 6973 6520 6172 616e 676f 2e65 7863 6570  ise arango.excep
-000217c0: 7469 6f6e 732e 4564 6765 4c69 7374 4572  tions.EdgeListEr
-000217d0: 726f 723a 2049 6620 7265 7472 6965 7661  ror: If retrieva
-000217e0: 6c20 6661 696c 732e 0a20 2020 2020 2020  l fails..       
-000217f0: 2022 2222 0a20 2020 2020 2020 2070 6172   """.        par
-00021800: 616d 733a 2050 6172 616d 7320 3d20 7b22  ams: Params = {"
-00021810: 7665 7274 6578 223a 2067 6574 5f64 6f63  vertex": get_doc
-00021820: 5f69 6428 7665 7274 6578 297d 0a20 2020  _id(vertex)}.   
-00021830: 2020 2020 2069 6620 6469 7265 6374 696f       if directio
-00021840: 6e20 6973 206e 6f74 204e 6f6e 653a 0a20  n is not None:. 
-00021850: 2020 2020 2020 2020 2020 2070 6172 616d             param
-00021860: 735b 2264 6972 6563 7469 6f6e 225d 203d  s["direction"] =
-00021870: 2064 6972 6563 7469 6f6e 0a0a 2020 2020   direction..    
-00021880: 2020 2020 7265 7175 6573 7420 3d20 5265      request = Re
-00021890: 7175 6573 7428 0a20 2020 2020 2020 2020  quest(.         
-000218a0: 2020 206d 6574 686f 643d 2267 6574 222c     method="get",
-000218b0: 0a20 2020 2020 2020 2020 2020 2065 6e64  .            end
-000218c0: 706f 696e 743d 6622 2f5f 6170 692f 6564  point=f"/_api/ed
-000218d0: 6765 732f 7b73 656c 662e 6e61 6d65 7d22  ges/{self.name}"
-000218e0: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
-000218f0: 7261 6d73 3d70 6172 616d 732c 0a20 2020  rams=params,.   
-00021900: 2020 2020 2020 2020 2072 6561 643d 7365           read=se
-00021910: 6c66 2e6e 616d 652c 0a20 2020 2020 2020  lf.name,.       
-00021920: 2020 2020 2068 6561 6465 7273 3d7b 2278       headers={"x
-00021930: 2d61 7261 6e67 6f2d 616c 6c6f 772d 6469  -arango-allow-di
-00021940: 7274 792d 7265 6164 223a 2022 7472 7565  rty-read": "true
-00021950: 227d 2069 6620 616c 6c6f 775f 6469 7274  "} if allow_dirt
-00021960: 795f 7265 6164 2065 6c73 6520 4e6f 6e65  y_read else None
-00021970: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-00021980: 2020 2020 2064 6566 2072 6573 706f 6e73       def respons
-00021990: 655f 6861 6e64 6c65 7228 7265 7370 3a20  e_handler(resp: 
-000219a0: 5265 7370 6f6e 7365 2920 2d3e 204a 736f  Response) -> Jso
-000219b0: 6e3a 0a20 2020 2020 2020 2020 2020 2069  n:.            i
-000219c0: 6620 6e6f 7420 7265 7370 2e69 735f 7375  f not resp.is_su
-000219d0: 6363 6573 733a 0a20 2020 2020 2020 2020  ccess:.         
-000219e0: 2020 2020 2020 2072 6169 7365 2045 6467         raise Edg
-000219f0: 654c 6973 7445 7272 6f72 2872 6573 702c  eListError(resp,
-00021a00: 2072 6571 7565 7374 290a 2020 2020 2020   request).      
-00021a10: 2020 2020 2020 7374 6174 7320 3d20 7265        stats = re
-00021a20: 7370 2e62 6f64 795b 2273 7461 7473 225d  sp.body["stats"]
-00021a30: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00021a40: 7572 6e20 7b0a 2020 2020 2020 2020 2020  urn {.          
-00021a50: 2020 2020 2020 2265 6467 6573 223a 2072        "edges": r
-00021a60: 6573 702e 626f 6479 5b22 6564 6765 7322  esp.body["edges"
-00021a70: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-00021a80: 2020 2022 7374 6174 7322 3a20 7b0a 2020     "stats": {.  
-00021a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021aa0: 2020 2266 696c 7465 7265 6422 3a20 7374    "filtered": st
-00021ab0: 6174 735b 2266 696c 7465 7265 6422 5d2c  ats["filtered"],
-00021ac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021ad0: 2020 2020 2022 7363 616e 6e65 645f 696e       "scanned_in
-00021ae0: 6465 7822 3a20 7374 6174 735b 2273 6361  dex": stats["sca
-00021af0: 6e6e 6564 496e 6465 7822 5d2c 0a20 2020  nnedIndex"],.   
-00021b00: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
-00021b10: 2020 2020 2020 2020 2020 2020 7d0a 0a20              }.. 
-00021b20: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00021b30: 6c66 2e5f 6578 6563 7574 6528 7265 7175  lf._execute(requ
-00021b40: 6573 742c 2072 6573 706f 6e73 655f 6861  est, response_ha
-00021b50: 6e64 6c65 7229 0a                        ndler).
+0000b5d0: 666f 726d 6174 7465 723a 2062 6f6f 6c0a  formatter: bool.
+0000b5e0: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
+0000b5f0: 204e 6577 2069 6e64 6578 2064 6574 6169   New index detai
+0000b600: 6c73 2e0a 2020 2020 2020 2020 3a72 7479  ls..        :rty
+0000b610: 7065 3a20 6469 6374 0a20 2020 2020 2020  pe: dict.       
+0000b620: 203a 7261 6973 6520 6172 616e 676f 2e65   :raise arango.e
+0000b630: 7863 6570 7469 6f6e 732e 496e 6465 7843  xceptions.IndexC
+0000b640: 7265 6174 6545 7272 6f72 3a20 4966 2063  reateError: If c
+0000b650: 7265 6174 6520 6661 696c 732e 0a20 2020  reate fails..   
+0000b660: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0000b670: 2072 6571 7565 7374 203d 2052 6571 7565   request = Reque
+0000b680: 7374 280a 2020 2020 2020 2020 2020 2020  st(.            
+0000b690: 6d65 7468 6f64 3d22 706f 7374 222c 0a20  method="post",. 
+0000b6a0: 2020 2020 2020 2020 2020 2065 6e64 706f             endpo
+0000b6b0: 696e 743d 222f 5f61 7069 2f69 6e64 6578  int="/_api/index
+0000b6c0: 222c 0a20 2020 2020 2020 2020 2020 2064  ",.            d
+0000b6d0: 6174 613d 6461 7461 2c0a 2020 2020 2020  ata=data,.      
+0000b6e0: 2020 2020 2020 7061 7261 6d73 3d7b 2263        params={"c
+0000b6f0: 6f6c 6c65 6374 696f 6e22 3a20 7365 6c66  ollection": self
+0000b700: 2e6e 616d 657d 2c0a 2020 2020 2020 2020  .name},.        
+0000b710: 290a 0a20 2020 2020 2020 2064 6566 2072  )..        def r
+0000b720: 6573 706f 6e73 655f 6861 6e64 6c65 7228  esponse_handler(
+0000b730: 7265 7370 3a20 5265 7370 6f6e 7365 2920  resp: Response) 
+0000b740: 2d3e 204a 736f 6e3a 0a20 2020 2020 2020  -> Json:.       
+0000b750: 2020 2020 2069 6620 6e6f 7420 7265 7370       if not resp
+0000b760: 2e69 735f 7375 6363 6573 733a 0a20 2020  .is_success:.   
+0000b770: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0000b780: 7365 2049 6e64 6578 4372 6561 7465 4572  se IndexCreateEr
+0000b790: 726f 7228 7265 7370 2c20 7265 7175 6573  ror(resp, reques
+0000b7a0: 7429 0a20 2020 2020 2020 2020 2020 2072  t).            r
+0000b7b0: 6574 7572 6e20 666f 726d 6174 5f69 6e64  eturn format_ind
+0000b7c0: 6578 2872 6573 702e 626f 6479 2c20 666f  ex(resp.body, fo
+0000b7d0: 726d 6174 7465 7229 0a0a 2020 2020 2020  rmatter)..      
+0000b7e0: 2020 7265 7475 726e 2073 656c 662e 5f65    return self._e
+0000b7f0: 7865 6375 7465 2872 6571 7565 7374 2c20  xecute(request, 
+0000b800: 7265 7370 6f6e 7365 5f68 616e 646c 6572  response_handler
+0000b810: 290a 0a20 2020 2064 6566 2061 6464 5f68  )..    def add_h
+0000b820: 6173 685f 696e 6465 7828 0a20 2020 2020  ash_index(.     
+0000b830: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0000b840: 2066 6965 6c64 733a 2053 6571 7565 6e63   fields: Sequenc
+0000b850: 655b 7374 725d 2c0a 2020 2020 2020 2020  e[str],.        
+0000b860: 756e 6971 7565 3a20 4f70 7469 6f6e 616c  unique: Optional
+0000b870: 5b62 6f6f 6c5d 203d 204e 6f6e 652c 0a20  [bool] = None,. 
+0000b880: 2020 2020 2020 2073 7061 7273 653a 204f         sparse: O
+0000b890: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
+0000b8a0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6465  None,.        de
+0000b8b0: 6475 706c 6963 6174 653a 204f 7074 696f  duplicate: Optio
+0000b8c0: 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65  nal[bool] = None
+0000b8d0: 2c0a 2020 2020 2020 2020 6e61 6d65 3a20  ,.        name: 
+0000b8e0: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
+0000b8f0: 4e6f 6e65 2c0a 2020 2020 2020 2020 696e  None,.        in
+0000b900: 5f62 6163 6b67 726f 756e 643a 204f 7074  _background: Opt
+0000b910: 696f 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f  ional[bool] = No
+0000b920: 6e65 2c0a 2020 2020 2920 2d3e 2052 6573  ne,.    ) -> Res
+0000b930: 756c 745b 4a73 6f6e 5d3a 0a20 2020 2020  ult[Json]:.     
+0000b940: 2020 2022 2222 4372 6561 7465 2061 206e     """Create a n
+0000b950: 6577 2068 6173 6820 696e 6465 782e 0a0a  ew hash index...
+0000b960: 2020 2020 2020 2020 2e2e 2077 6172 6e69          .. warni
+0000b970: 6e67 3a3a 0a0a 2020 2020 2020 2020 2020  ng::..          
+0000b980: 2020 5468 6520 696e 6465 7820 7479 7065    The index type
+0000b990: 7320 6068 6173 6860 2061 6e64 2060 736b  s `hash` and `sk
+0000b9a0: 6970 6c69 7374 6020 6172 6520 616c 6961  iplist` are alia
+0000b9b0: 7365 7320 666f 7220 7468 6520 7065 7273  ses for the pers
+0000b9c0: 6973 7465 6e74 0a20 2020 2020 2020 2020  istent.         
+0000b9d0: 2020 2069 6e64 6578 2074 7970 6520 616e     index type an
+0000b9e0: 6420 7368 6f75 6c64 206e 6f20 6c6f 6e67  d should no long
+0000b9f0: 6572 2062 6520 7573 6564 2074 6f20 6372  er be used to cr
+0000ba00: 6561 7465 206e 6577 2069 6e64 6578 6573  eate new indexes
+0000ba10: 2e20 5468 650a 2020 2020 2020 2020 2020  . The.          
+0000ba20: 2020 616c 6961 7365 7320 7769 6c6c 2062    aliases will b
+0000ba30: 6520 7265 6d6f 7665 6420 696e 2061 2066  e removed in a f
+0000ba40: 7574 7572 6520 7665 7273 696f 6e2e 0a0a  uture version...
+0000ba50: 2020 2020 2020 2020 3a70 6172 616d 2066          :param f
+0000ba60: 6965 6c64 733a 2044 6f63 756d 656e 7420  ields: Document 
+0000ba70: 6669 656c 6473 2074 6f20 696e 6465 782e  fields to index.
+0000ba80: 0a20 2020 2020 2020 203a 7479 7065 2066  .        :type f
+0000ba90: 6965 6c64 733a 205b 7374 725d 0a20 2020  ields: [str].   
+0000baa0: 2020 2020 203a 7061 7261 6d20 756e 6971       :param uniq
+0000bab0: 7565 3a20 5768 6574 6865 7220 7468 6520  ue: Whether the 
+0000bac0: 696e 6465 7820 6973 2075 6e69 7175 652e  index is unique.
+0000bad0: 0a20 2020 2020 2020 203a 7479 7065 2075  .        :type u
+0000bae0: 6e69 7175 653a 2062 6f6f 6c20 7c20 4e6f  nique: bool | No
+0000baf0: 6e65 0a20 2020 2020 2020 203a 7061 7261  ne.        :para
+0000bb00: 6d20 7370 6172 7365 3a20 4966 2073 6574  m sparse: If set
+0000bb10: 2074 6f20 5472 7565 2c20 646f 6375 6d65   to True, docume
+0000bb20: 6e74 7320 7769 7468 204e 6f6e 6520 696e  nts with None in
+0000bb30: 2074 6865 2066 6965 6c64 0a20 2020 2020   the field.     
+0000bb40: 2020 2020 2020 2061 7265 2061 6c73 6f20         are also 
+0000bb50: 696e 6465 7865 642e 2049 6620 7365 7420  indexed. If set 
+0000bb60: 746f 2046 616c 7365 2c20 7468 6579 2061  to False, they a
+0000bb70: 7265 2073 6b69 7070 6564 2e0a 2020 2020  re skipped..    
+0000bb80: 2020 2020 3a74 7970 6520 7370 6172 7365      :type sparse
+0000bb90: 3a20 626f 6f6c 207c 204e 6f6e 650a 2020  : bool | None.  
+0000bba0: 2020 2020 2020 3a70 6172 616d 2064 6564        :param ded
+0000bbb0: 7570 6c69 6361 7465 3a20 4966 2073 6574  uplicate: If set
+0000bbc0: 2074 6f20 5472 7565 2c20 696e 7365 7274   to True, insert
+0000bbd0: 696e 6720 6475 706c 6963 6174 6520 696e  ing duplicate in
+0000bbe0: 6465 7820 7661 6c75 6573 0a20 2020 2020  dex values.     
+0000bbf0: 2020 2020 2020 2066 726f 6d20 7468 6520         from the 
+0000bc00: 7361 6d65 2064 6f63 756d 656e 7420 7472  same document tr
+0000bc10: 6967 6765 7273 2075 6e69 7175 6520 636f  iggers unique co
+0000bc20: 6e73 7472 6169 6e74 2065 7272 6f72 732e  nstraint errors.
+0000bc30: 0a20 2020 2020 2020 203a 7479 7065 2064  .        :type d
+0000bc40: 6564 7570 6c69 6361 7465 3a20 626f 6f6c  eduplicate: bool
+0000bc50: 207c 204e 6f6e 650a 2020 2020 2020 2020   | None.        
+0000bc60: 3a70 6172 616d 206e 616d 653a 204f 7074  :param name: Opt
+0000bc70: 696f 6e61 6c20 6e61 6d65 2066 6f72 2074  ional name for t
+0000bc80: 6865 2069 6e64 6578 2e0a 2020 2020 2020  he index..      
+0000bc90: 2020 3a74 7970 6520 6e61 6d65 3a20 7374    :type name: st
+0000bca0: 7220 7c20 4e6f 6e65 0a20 2020 2020 2020  r | None.       
+0000bcb0: 203a 7061 7261 6d20 696e 5f62 6163 6b67   :param in_backg
+0000bcc0: 726f 756e 643a 2044 6f20 6e6f 7420 686f  round: Do not ho
+0000bcd0: 6c64 2074 6865 2063 6f6c 6c65 6374 696f  ld the collectio
+0000bce0: 6e20 6c6f 636b 2e0a 2020 2020 2020 2020  n lock..        
+0000bcf0: 3a74 7970 6520 696e 5f62 6163 6b67 726f  :type in_backgro
+0000bd00: 756e 643a 2062 6f6f 6c20 7c20 4e6f 6e65  und: bool | None
+0000bd10: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+0000bd20: 3a20 4e65 7720 696e 6465 7820 6465 7461  : New index deta
+0000bd30: 696c 732e 0a20 2020 2020 2020 203a 7274  ils..        :rt
+0000bd40: 7970 653a 2064 6963 740a 2020 2020 2020  ype: dict.      
+0000bd50: 2020 3a72 6169 7365 2061 7261 6e67 6f2e    :raise arango.
+0000bd60: 6578 6365 7074 696f 6e73 2e49 6e64 6578  exceptions.Index
+0000bd70: 4372 6561 7465 4572 726f 723a 2049 6620  CreateError: If 
+0000bd80: 6372 6561 7465 2066 6169 6c73 2e0a 2020  create fails..  
+0000bd90: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0000bda0: 2020 6d20 3d20 2261 6464 5f68 6173 685f    m = "add_hash_
+0000bdb0: 696e 6465 7820 6973 2064 6570 7265 6361  index is depreca
+0000bdc0: 7465 642e 2055 7369 6e67 2061 6464 5f69  ted. Using add_i
+0000bdd0: 6e64 6578 2077 6974 6820 7b27 7479 7065  ndex with {'type
+0000bde0: 273a 2027 6861 7368 277d 2069 6e73 7465  ': 'hash'} inste
+0000bdf0: 6164 2e22 2020 2320 6e6f 7161 3a20 4535  ad."  # noqa: E5
+0000be00: 3031 0a20 2020 2020 2020 2077 6172 6e28  01.        warn(
+0000be10: 6d2c 2044 6570 7265 6361 7469 6f6e 5761  m, DeprecationWa
+0000be20: 726e 696e 672c 2073 7461 636b 6c65 7665  rning, stackleve
+0000be30: 6c3d 3229 0a0a 2020 2020 2020 2020 6461  l=2)..        da
+0000be40: 7461 3a20 4a73 6f6e 203d 207b 2274 7970  ta: Json = {"typ
+0000be50: 6522 3a20 2268 6173 6822 2c20 2266 6965  e": "hash", "fie
+0000be60: 6c64 7322 3a20 6669 656c 6473 7d0a 0a20  lds": fields}.. 
+0000be70: 2020 2020 2020 2069 6620 756e 6971 7565         if unique
+0000be80: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+0000be90: 2020 2020 2020 2020 2020 6461 7461 5b22            data["
+0000bea0: 756e 6971 7565 225d 203d 2075 6e69 7175  unique"] = uniqu
+0000beb0: 650a 2020 2020 2020 2020 6966 2073 7061  e.        if spa
+0000bec0: 7273 6520 6973 206e 6f74 204e 6f6e 653a  rse is not None:
+0000bed0: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
+0000bee0: 615b 2273 7061 7273 6522 5d20 3d20 7370  a["sparse"] = sp
+0000bef0: 6172 7365 0a20 2020 2020 2020 2069 6620  arse.        if 
+0000bf00: 6465 6475 706c 6963 6174 6520 6973 206e  deduplicate is n
+0000bf10: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+0000bf20: 2020 2020 2064 6174 615b 2264 6564 7570       data["dedup
+0000bf30: 6c69 6361 7465 225d 203d 2064 6564 7570  licate"] = dedup
+0000bf40: 6c69 6361 7465 0a20 2020 2020 2020 2069  licate.        i
+0000bf50: 6620 6e61 6d65 2069 7320 6e6f 7420 4e6f  f name is not No
+0000bf60: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0000bf70: 6461 7461 5b22 6e61 6d65 225d 203d 206e  data["name"] = n
+0000bf80: 616d 650a 2020 2020 2020 2020 6966 2069  ame.        if i
+0000bf90: 6e5f 6261 636b 6772 6f75 6e64 2069 7320  n_background is 
+0000bfa0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+0000bfb0: 2020 2020 2020 6461 7461 5b22 696e 4261        data["inBa
+0000bfc0: 636b 6772 6f75 6e64 225d 203d 2069 6e5f  ckground"] = in_
+0000bfd0: 6261 636b 6772 6f75 6e64 0a0a 2020 2020  background..    
+0000bfe0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000bff0: 6164 645f 696e 6465 7828 6461 7461 2c20  add_index(data, 
+0000c000: 666f 726d 6174 7465 723d 5472 7565 290a  formatter=True).
+0000c010: 0a20 2020 2064 6566 2061 6464 5f73 6b69  .    def add_ski
+0000c020: 706c 6973 745f 696e 6465 7828 0a20 2020  plist_index(.   
+0000c030: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+0000c040: 2020 2066 6965 6c64 733a 2053 6571 7565     fields: Seque
+0000c050: 6e63 655b 7374 725d 2c0a 2020 2020 2020  nce[str],.      
+0000c060: 2020 756e 6971 7565 3a20 4f70 7469 6f6e    unique: Option
+0000c070: 616c 5b62 6f6f 6c5d 203d 204e 6f6e 652c  al[bool] = None,
+0000c080: 0a20 2020 2020 2020 2073 7061 7273 653a  .        sparse:
+0000c090: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
+0000c0a0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+0000c0b0: 6465 6475 706c 6963 6174 653a 204f 7074  deduplicate: Opt
+0000c0c0: 696f 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f  ional[bool] = No
+0000c0d0: 6e65 2c0a 2020 2020 2020 2020 6e61 6d65  ne,.        name
+0000c0e0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+0000c0f0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+0000c100: 696e 5f62 6163 6b67 726f 756e 643a 204f  in_background: O
+0000c110: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
+0000c120: 4e6f 6e65 2c0a 2020 2020 2920 2d3e 2052  None,.    ) -> R
+0000c130: 6573 756c 745b 4a73 6f6e 5d3a 0a20 2020  esult[Json]:.   
+0000c140: 2020 2020 2022 2222 4372 6561 7465 2061       """Create a
+0000c150: 206e 6577 2073 6b69 706c 6973 7420 696e   new skiplist in
+0000c160: 6465 782e 0a0a 2020 2020 2020 2020 2e2e  dex...        ..
+0000c170: 2077 6172 6e69 6e67 3a3a 0a0a 2020 2020   warning::..    
+0000c180: 2020 2020 2020 2020 5468 6520 696e 6465          The inde
+0000c190: 7820 7479 7065 7320 6068 6173 6860 2061  x types `hash` a
+0000c1a0: 6e64 2060 736b 6970 6c69 7374 6020 6172  nd `skiplist` ar
+0000c1b0: 6520 616c 6961 7365 7320 666f 7220 7468  e aliases for th
+0000c1c0: 6520 7065 7273 6973 7465 6e74 0a20 2020  e persistent.   
+0000c1d0: 2020 2020 2020 2020 2069 6e64 6578 2074           index t
+0000c1e0: 7970 6520 616e 6420 7368 6f75 6c64 206e  ype and should n
+0000c1f0: 6f20 6c6f 6e67 6572 2062 6520 7573 6564  o longer be used
+0000c200: 2074 6f20 6372 6561 7465 206e 6577 2069   to create new i
+0000c210: 6e64 6578 6573 2e20 5468 650a 2020 2020  ndexes. The.    
+0000c220: 2020 2020 2020 2020 616c 6961 7365 7320          aliases 
+0000c230: 7769 6c6c 2062 6520 7265 6d6f 7665 6420  will be removed 
+0000c240: 696e 2061 2066 7574 7572 6520 7665 7273  in a future vers
+0000c250: 696f 6e2e 0a0a 2020 2020 2020 2020 3a70  ion...        :p
+0000c260: 6172 616d 2066 6965 6c64 733a 2044 6f63  aram fields: Doc
+0000c270: 756d 656e 7420 6669 656c 6473 2074 6f20  ument fields to 
+0000c280: 696e 6465 782e 0a20 2020 2020 2020 203a  index..        :
+0000c290: 7479 7065 2066 6965 6c64 733a 205b 7374  type fields: [st
+0000c2a0: 725d 0a20 2020 2020 2020 203a 7061 7261  r].        :para
+0000c2b0: 6d20 756e 6971 7565 3a20 5768 6574 6865  m unique: Whethe
+0000c2c0: 7220 7468 6520 696e 6465 7820 6973 2075  r the index is u
+0000c2d0: 6e69 7175 652e 0a20 2020 2020 2020 203a  nique..        :
+0000c2e0: 7479 7065 2075 6e69 7175 653a 2062 6f6f  type unique: boo
+0000c2f0: 6c20 7c20 4e6f 6e65 0a20 2020 2020 2020  l | None.       
+0000c300: 203a 7061 7261 6d20 7370 6172 7365 3a20   :param sparse: 
+0000c310: 4966 2073 6574 2074 6f20 5472 7565 2c20  If set to True, 
+0000c320: 646f 6375 6d65 6e74 7320 7769 7468 204e  documents with N
+0000c330: 6f6e 6520 696e 2074 6865 2066 6965 6c64  one in the field
+0000c340: 0a20 2020 2020 2020 2020 2020 2061 7265  .            are
+0000c350: 2061 6c73 6f20 696e 6465 7865 642e 2049   also indexed. I
+0000c360: 6620 7365 7420 746f 2046 616c 7365 2c20  f set to False, 
+0000c370: 7468 6579 2061 7265 2073 6b69 7070 6564  they are skipped
+0000c380: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
+0000c390: 7370 6172 7365 3a20 626f 6f6c 207c 204e  sparse: bool | N
+0000c3a0: 6f6e 650a 2020 2020 2020 2020 3a70 6172  one.        :par
+0000c3b0: 616d 2064 6564 7570 6c69 6361 7465 3a20  am deduplicate: 
+0000c3c0: 4966 2073 6574 2074 6f20 5472 7565 2c20  If set to True, 
+0000c3d0: 696e 7365 7274 696e 6720 6475 706c 6963  inserting duplic
+0000c3e0: 6174 6520 696e 6465 7820 7661 6c75 6573  ate index values
+0000c3f0: 0a20 2020 2020 2020 2020 2020 2066 726f  .            fro
+0000c400: 6d20 7468 6520 7361 6d65 2064 6f63 756d  m the same docum
+0000c410: 656e 7420 7472 6967 6765 7273 2075 6e69  ent triggers uni
+0000c420: 7175 6520 636f 6e73 7472 6169 6e74 2065  que constraint e
+0000c430: 7272 6f72 732e 0a20 2020 2020 2020 203a  rrors..        :
+0000c440: 7479 7065 2064 6564 7570 6c69 6361 7465  type deduplicate
+0000c450: 3a20 626f 6f6c 207c 204e 6f6e 650a 2020  : bool | None.  
+0000c460: 2020 2020 2020 3a70 6172 616d 206e 616d        :param nam
+0000c470: 653a 204f 7074 696f 6e61 6c20 6e61 6d65  e: Optional name
+0000c480: 2066 6f72 2074 6865 2069 6e64 6578 2e0a   for the index..
+0000c490: 2020 2020 2020 2020 3a74 7970 6520 6e61          :type na
+0000c4a0: 6d65 3a20 7374 7220 7c20 4e6f 6e65 0a20  me: str | None. 
+0000c4b0: 2020 2020 2020 203a 7061 7261 6d20 696e         :param in
+0000c4c0: 5f62 6163 6b67 726f 756e 643a 2044 6f20  _background: Do 
+0000c4d0: 6e6f 7420 686f 6c64 2074 6865 2063 6f6c  not hold the col
+0000c4e0: 6c65 6374 696f 6e20 6c6f 636b 2e0a 2020  lection lock..  
+0000c4f0: 2020 2020 2020 3a74 7970 6520 696e 5f62        :type in_b
+0000c500: 6163 6b67 726f 756e 643a 2062 6f6f 6c20  ackground: bool 
+0000c510: 7c20 4e6f 6e65 0a20 2020 2020 2020 203a  | None.        :
+0000c520: 7265 7475 726e 3a20 4e65 7720 696e 6465  return: New inde
+0000c530: 7820 6465 7461 696c 732e 0a20 2020 2020  x details..     
+0000c540: 2020 203a 7274 7970 653a 2064 6963 740a     :rtype: dict.
+0000c550: 2020 2020 2020 2020 3a72 6169 7365 2061          :raise a
+0000c560: 7261 6e67 6f2e 6578 6365 7074 696f 6e73  rango.exceptions
+0000c570: 2e49 6e64 6578 4372 6561 7465 4572 726f  .IndexCreateErro
+0000c580: 723a 2049 6620 6372 6561 7465 2066 6169  r: If create fai
+0000c590: 6c73 2e0a 2020 2020 2020 2020 2222 220a  ls..        """.
+0000c5a0: 2020 2020 2020 2020 6d20 3d20 2261 6464          m = "add
+0000c5b0: 5f73 6b69 706c 6973 745f 696e 6465 7820  _skiplist_index 
+0000c5c0: 6973 2064 6570 7265 6361 7465 642e 2055  is deprecated. U
+0000c5d0: 7369 6e67 2061 6464 5f69 6e64 6578 2077  sing add_index w
+0000c5e0: 6974 6820 7b27 7479 7065 273a 2027 736b  ith {'type': 'sk
+0000c5f0: 6970 6c69 7374 277d 2069 6e73 7465 6164  iplist'} instead
+0000c600: 2e22 2020 2320 6e6f 7161 3a20 4535 3031  ."  # noqa: E501
+0000c610: 0a20 2020 2020 2020 2077 6172 6e28 6d2c  .        warn(m,
+0000c620: 2044 6570 7265 6361 7469 6f6e 5761 726e   DeprecationWarn
+0000c630: 696e 672c 2073 7461 636b 6c65 7665 6c3d  ing, stacklevel=
+0000c640: 3229 0a0a 2020 2020 2020 2020 6461 7461  2)..        data
+0000c650: 3a20 4a73 6f6e 203d 207b 2274 7970 6522  : Json = {"type"
+0000c660: 3a20 2273 6b69 706c 6973 7422 2c20 2266  : "skiplist", "f
+0000c670: 6965 6c64 7322 3a20 6669 656c 6473 7d0a  ields": fields}.
+0000c680: 0a20 2020 2020 2020 2069 6620 756e 6971  .        if uniq
+0000c690: 7565 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ue is not None:.
+0000c6a0: 2020 2020 2020 2020 2020 2020 6461 7461              data
+0000c6b0: 5b22 756e 6971 7565 225d 203d 2075 6e69  ["unique"] = uni
+0000c6c0: 7175 650a 2020 2020 2020 2020 6966 2073  que.        if s
+0000c6d0: 7061 7273 6520 6973 206e 6f74 204e 6f6e  parse is not Non
+0000c6e0: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
+0000c6f0: 6174 615b 2273 7061 7273 6522 5d20 3d20  ata["sparse"] = 
+0000c700: 7370 6172 7365 0a20 2020 2020 2020 2069  sparse.        i
+0000c710: 6620 6465 6475 706c 6963 6174 6520 6973  f deduplicate is
+0000c720: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+0000c730: 2020 2020 2020 2064 6174 615b 2264 6564         data["ded
+0000c740: 7570 6c69 6361 7465 225d 203d 2064 6564  uplicate"] = ded
+0000c750: 7570 6c69 6361 7465 0a20 2020 2020 2020  uplicate.       
+0000c760: 2069 6620 6e61 6d65 2069 7320 6e6f 7420   if name is not 
+0000c770: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000c780: 2020 6461 7461 5b22 6e61 6d65 225d 203d    data["name"] =
+0000c790: 206e 616d 650a 2020 2020 2020 2020 6966   name.        if
+0000c7a0: 2069 6e5f 6261 636b 6772 6f75 6e64 2069   in_background i
+0000c7b0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+0000c7c0: 2020 2020 2020 2020 6461 7461 5b22 696e          data["in
+0000c7d0: 4261 636b 6772 6f75 6e64 225d 203d 2069  Background"] = i
+0000c7e0: 6e5f 6261 636b 6772 6f75 6e64 0a0a 2020  n_background..  
+0000c7f0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000c800: 662e 6164 645f 696e 6465 7828 6461 7461  f.add_index(data
+0000c810: 2c20 666f 726d 6174 7465 723d 5472 7565  , formatter=True
+0000c820: 290a 0a20 2020 2064 6566 2061 6464 5f67  )..    def add_g
+0000c830: 656f 5f69 6e64 6578 280a 2020 2020 2020  eo_index(.      
+0000c840: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+0000c850: 6669 656c 6473 3a20 4669 656c 6473 2c0a  fields: Fields,.
+0000c860: 2020 2020 2020 2020 6765 6f5f 6a73 6f6e          geo_json
+0000c870: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
+0000c880: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0000c890: 206e 616d 653a 204f 7074 696f 6e61 6c5b   name: Optional[
+0000c8a0: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+0000c8b0: 2020 2020 2069 6e5f 6261 636b 6772 6f75       in_backgrou
+0000c8c0: 6e64 3a20 4f70 7469 6f6e 616c 5b62 6f6f  nd: Optional[boo
+0000c8d0: 6c5d 203d 204e 6f6e 652c 0a20 2020 2020  l] = None,.     
+0000c8e0: 2020 206c 6567 6163 7950 6f6c 7967 6f6e     legacyPolygon
+0000c8f0: 733a 204f 7074 696f 6e61 6c5b 626f 6f6c  s: Optional[bool
+0000c900: 5d20 3d20 4661 6c73 652c 0a20 2020 2029  ] = False,.    )
+0000c910: 202d 3e20 5265 7375 6c74 5b4a 736f 6e5d   -> Result[Json]
+0000c920: 3a0a 2020 2020 2020 2020 2222 2243 7265  :.        """Cre
+0000c930: 6174 6520 6120 6e65 7720 6765 6f2d 7370  ate a new geo-sp
+0000c940: 6174 6961 6c20 696e 6465 782e 0a0a 2020  atial index...  
+0000c950: 2020 2020 2020 3a70 6172 616d 2066 6965        :param fie
+0000c960: 6c64 733a 2041 2073 696e 676c 6520 646f  lds: A single do
+0000c970: 6375 6d65 6e74 2066 6965 6c64 206f 7220  cument field or 
+0000c980: 6120 6c69 7374 206f 6620 646f 6375 6d65  a list of docume
+0000c990: 6e74 2066 6965 6c64 732e 2049 660a 2020  nt fields. If.  
+0000c9a0: 2020 2020 2020 2020 2020 6120 7369 6e67            a sing
+0000c9b0: 6c65 2066 6965 6c64 2069 7320 6769 7665  le field is give
+0000c9c0: 6e2c 2074 6865 2066 6965 6c64 206d 7573  n, the field mus
+0000c9d0: 7420 6861 7665 2076 616c 7565 7320 7468  t have values th
+0000c9e0: 6174 2061 7265 206c 6973 7473 0a20 2020  at are lists.   
+0000c9f0: 2020 2020 2020 2020 2077 6974 6820 6174           with at
+0000ca00: 206c 6561 7374 2074 776f 2066 6c6f 6174   least two float
+0000ca10: 732e 2044 6f63 756d 656e 7473 2077 6974  s. Documents wit
+0000ca20: 6820 6d69 7373 696e 6720 6669 656c 6473  h missing fields
+0000ca30: 206f 7220 696e 7661 6c69 640a 2020 2020   or invalid.    
+0000ca40: 2020 2020 2020 2020 7661 6c75 6573 2061          values a
+0000ca50: 7265 2065 7863 6c75 6465 642e 0a20 2020  re excluded..   
+0000ca60: 2020 2020 203a 7479 7065 2066 6965 6c64       :type field
+0000ca70: 733a 2073 7472 207c 205b 7374 725d 0a20  s: str | [str]. 
+0000ca80: 2020 2020 2020 203a 7061 7261 6d20 6765         :param ge
+0000ca90: 6f5f 6a73 6f6e 3a20 5768 6574 6865 7220  o_json: Whether 
+0000caa0: 746f 2075 7365 2047 656f 4a53 4f4e 2064  to use GeoJSON d
+0000cab0: 6174 612d 666f 726d 6174 206f 7220 6e6f  ata-format or no
+0000cac0: 742e 2054 6869 730a 2020 2020 2020 2020  t. This.        
+0000cad0: 2020 2020 7061 7261 6d65 7465 7220 6861      parameter ha
+0000cae0: 7320 6265 656e 2072 656e 616d 6564 2066  s been renamed f
+0000caf0: 726f 6d20 606f 7264 6572 6564 602e 2053  rom `ordered`. S
+0000cb00: 6565 2047 6974 6875 6220 4973 7375 650a  ee Github Issue.
+0000cb10: 2020 2020 2020 2020 2020 2020 2332 3334              #234
+0000cb20: 2066 6f72 206d 6f72 6520 6465 7461 696c   for more detail
+0000cb30: 732e 0a20 2020 2020 2020 203a 7479 7065  s..        :type
+0000cb40: 2067 656f 5f6a 736f 6e3a 2062 6f6f 6c20   geo_json: bool 
+0000cb50: 7c20 4e6f 6e65 0a20 2020 2020 2020 203a  | None.        :
+0000cb60: 7061 7261 6d20 6e61 6d65 3a20 4f70 7469  param name: Opti
+0000cb70: 6f6e 616c 206e 616d 6520 666f 7220 7468  onal name for th
+0000cb80: 6520 696e 6465 782e 0a20 2020 2020 2020  e index..       
+0000cb90: 203a 7479 7065 206e 616d 653a 2073 7472   :type name: str
+0000cba0: 207c 204e 6f6e 650a 2020 2020 2020 2020   | None.        
+0000cbb0: 3a70 6172 616d 2069 6e5f 6261 636b 6772  :param in_backgr
+0000cbc0: 6f75 6e64 3a20 446f 206e 6f74 2068 6f6c  ound: Do not hol
+0000cbd0: 6420 7468 6520 636f 6c6c 6563 7469 6f6e  d the collection
+0000cbe0: 206c 6f63 6b2e 0a20 2020 2020 2020 203a   lock..        :
+0000cbf0: 7479 7065 2069 6e5f 6261 636b 6772 6f75  type in_backgrou
+0000cc00: 6e64 3a20 626f 6f6c 207c 204e 6f6e 650a  nd: bool | None.
+0000cc10: 2020 2020 2020 2020 3a70 6172 616d 206c          :param l
+0000cc20: 6567 6163 7950 6f6c 7967 6f6e 733a 2057  egacyPolygons: W
+0000cc30: 6865 7468 6572 206f 7220 6e6f 7420 746f  hether or not to
+0000cc40: 2075 7365 2075 7365 2074 6865 206f 6c64   use use the old
+0000cc50: 2c20 7072 652d 332e 3130 2072 756c 6573  , pre-3.10 rules
+0000cc60: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0000cc70: 2074 6865 2070 6172 7369 6e67 2047 656f   the parsing Geo
+0000cc80: 4a53 4f4e 2070 6f6c 7967 6f6e 730a 2020  JSON polygons.  
+0000cc90: 2020 2020 2020 3a74 7970 6520 6c65 6761        :type lega
+0000cca0: 6379 506f 6c79 676f 6e73 3a20 626f 6f6c  cyPolygons: bool
+0000ccb0: 207c 204e 6f6e 650a 2020 2020 2020 2020   | None.        
+0000ccc0: 3a72 6574 7572 6e3a 204e 6577 2069 6e64  :return: New ind
+0000ccd0: 6578 2064 6574 6169 6c73 2e0a 2020 2020  ex details..    
+0000cce0: 2020 2020 3a72 7479 7065 3a20 6469 6374      :rtype: dict
+0000ccf0: 0a20 2020 2020 2020 203a 7261 6973 6520  .        :raise 
+0000cd00: 6172 616e 676f 2e65 7863 6570 7469 6f6e  arango.exception
+0000cd10: 732e 496e 6465 7843 7265 6174 6545 7272  s.IndexCreateErr
+0000cd20: 6f72 3a20 4966 2063 7265 6174 6520 6661  or: If create fa
+0000cd30: 696c 732e 0a20 2020 2020 2020 2022 2222  ils..        """
+0000cd40: 0a20 2020 2020 2020 206d 203d 2022 6164  .        m = "ad
+0000cd50: 645f 6765 6f5f 696e 6465 7820 6973 2064  d_geo_index is d
+0000cd60: 6570 7265 6361 7465 642e 2055 7369 6e67  eprecated. Using
+0000cd70: 2061 6464 5f69 6e64 6578 2077 6974 6820   add_index with 
+0000cd80: 7b27 7479 7065 273a 2027 6765 6f27 7d20  {'type': 'geo'} 
+0000cd90: 696e 7374 6561 642e 2220 2023 206e 6f71  instead."  # noq
+0000cda0: 613a 2045 3530 310a 2020 2020 2020 2020  a: E501.        
+0000cdb0: 7761 726e 286d 2c20 4465 7072 6563 6174  warn(m, Deprecat
+0000cdc0: 696f 6e57 6172 6e69 6e67 2c20 7374 6163  ionWarning, stac
+0000cdd0: 6b6c 6576 656c 3d32 290a 0a20 2020 2020  klevel=2)..     
+0000cde0: 2020 2064 6174 613a 204a 736f 6e20 3d20     data: Json = 
+0000cdf0: 7b22 7479 7065 223a 2022 6765 6f22 2c20  {"type": "geo", 
+0000ce00: 2266 6965 6c64 7322 3a20 6669 656c 6473  "fields": fields
+0000ce10: 7d0a 0a20 2020 2020 2020 2069 6620 6765  }..        if ge
+0000ce20: 6f5f 6a73 6f6e 2069 7320 6e6f 7420 4e6f  o_json is not No
+0000ce30: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0000ce40: 6461 7461 5b22 6765 6f4a 736f 6e22 5d20  data["geoJson"] 
+0000ce50: 3d20 6765 6f5f 6a73 6f6e 0a20 2020 2020  = geo_json.     
+0000ce60: 2020 2069 6620 6e61 6d65 2069 7320 6e6f     if name is no
+0000ce70: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+0000ce80: 2020 2020 6461 7461 5b22 6e61 6d65 225d      data["name"]
+0000ce90: 203d 206e 616d 650a 2020 2020 2020 2020   = name.        
+0000cea0: 6966 2069 6e5f 6261 636b 6772 6f75 6e64  if in_background
+0000ceb0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+0000cec0: 2020 2020 2020 2020 2020 6461 7461 5b22            data["
+0000ced0: 696e 4261 636b 6772 6f75 6e64 225d 203d  inBackground"] =
+0000cee0: 2069 6e5f 6261 636b 6772 6f75 6e64 0a20   in_background. 
+0000cef0: 2020 2020 2020 2069 6620 6c65 6761 6379         if legacy
+0000cf00: 506f 6c79 676f 6e73 2069 7320 6e6f 7420  Polygons is not 
+0000cf10: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000cf20: 2020 6461 7461 5b22 6c65 6761 6379 506f    data["legacyPo
+0000cf30: 6c79 676f 6e73 225d 203d 206c 6567 6163  lygons"] = legac
+0000cf40: 7950 6f6c 7967 6f6e 730a 0a20 2020 2020  yPolygons..     
+0000cf50: 2020 2072 6574 7572 6e20 7365 6c66 2e61     return self.a
+0000cf60: 6464 5f69 6e64 6578 2864 6174 612c 2066  dd_index(data, f
+0000cf70: 6f72 6d61 7474 6572 3d54 7275 6529 0a0a  ormatter=True)..
+0000cf80: 2020 2020 6465 6620 6164 645f 6675 6c6c      def add_full
+0000cf90: 7465 7874 5f69 6e64 6578 280a 2020 2020  text_index(.    
+0000cfa0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+0000cfb0: 2020 6669 656c 6473 3a20 5365 7175 656e    fields: Sequen
+0000cfc0: 6365 5b73 7472 5d2c 0a20 2020 2020 2020  ce[str],.       
+0000cfd0: 206d 696e 5f6c 656e 6774 683a 204f 7074   min_length: Opt
+0000cfe0: 696f 6e61 6c5b 696e 745d 203d 204e 6f6e  ional[int] = Non
+0000cff0: 652c 0a20 2020 2020 2020 206e 616d 653a  e,.        name:
+0000d000: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
+0000d010: 204e 6f6e 652c 0a20 2020 2020 2020 2069   None,.        i
+0000d020: 6e5f 6261 636b 6772 6f75 6e64 3a20 4f70  n_background: Op
+0000d030: 7469 6f6e 616c 5b62 6f6f 6c5d 203d 204e  tional[bool] = N
+0000d040: 6f6e 652c 0a20 2020 2029 202d 3e20 5265  one,.    ) -> Re
+0000d050: 7375 6c74 5b4a 736f 6e5d 3a0a 2020 2020  sult[Json]:.    
+0000d060: 2020 2020 2222 2243 7265 6174 6520 6120      """Create a 
+0000d070: 6e65 7720 6675 6c6c 7465 7874 2069 6e64  new fulltext ind
+0000d080: 6578 2e0a 0a20 2020 2020 2020 202e 2e20  ex...        .. 
+0000d090: 7761 726e 696e 673a 3a0a 2020 2020 2020  warning::.      
+0000d0a0: 2020 2020 2020 5468 6973 206d 6574 686f        This metho
+0000d0b0: 6420 6973 2064 6570 7265 6361 7465 6420  d is deprecated 
+0000d0c0: 7369 6e63 6520 4172 616e 676f 4442 2033  since ArangoDB 3
+0000d0d0: 2e31 3020 616e 6420 7769 6c6c 2062 6520  .10 and will be 
+0000d0e0: 7265 6d6f 7665 640a 2020 2020 2020 2020  removed.        
+0000d0f0: 2020 2020 696e 2061 2066 7574 7572 6520      in a future 
+0000d100: 7665 7273 696f 6e20 6f66 2074 6865 2064  version of the d
+0000d110: 7269 7665 722e 0a0a 2020 2020 2020 2020  river...        
+0000d120: 3a70 6172 616d 2066 6965 6c64 733a 2044  :param fields: D
+0000d130: 6f63 756d 656e 7420 6669 656c 6473 2074  ocument fields t
+0000d140: 6f20 696e 6465 782e 0a20 2020 2020 2020  o index..       
+0000d150: 203a 7479 7065 2066 6965 6c64 733a 205b   :type fields: [
+0000d160: 7374 725d 0a20 2020 2020 2020 203a 7061  str].        :pa
+0000d170: 7261 6d20 6d69 6e5f 6c65 6e67 7468 3a20  ram min_length: 
+0000d180: 4d69 6e69 6d75 6d20 6e75 6d62 6572 206f  Minimum number o
+0000d190: 6620 6368 6172 6163 7465 7273 2074 6f20  f characters to 
+0000d1a0: 696e 6465 782e 0a20 2020 2020 2020 203a  index..        :
+0000d1b0: 7479 7065 206d 696e 5f6c 656e 6774 683a  type min_length:
+0000d1c0: 2069 6e74 207c 204e 6f6e 650a 2020 2020   int | None.    
+0000d1d0: 2020 2020 3a70 6172 616d 206e 616d 653a      :param name:
+0000d1e0: 204f 7074 696f 6e61 6c20 6e61 6d65 2066   Optional name f
+0000d1f0: 6f72 2074 6865 2069 6e64 6578 2e0a 2020  or the index..  
+0000d200: 2020 2020 2020 3a74 7970 6520 6e61 6d65        :type name
+0000d210: 3a20 7374 7220 7c20 4e6f 6e65 0a20 2020  : str | None.   
+0000d220: 2020 2020 203a 7061 7261 6d20 696e 5f62       :param in_b
+0000d230: 6163 6b67 726f 756e 643a 2044 6f20 6e6f  ackground: Do no
+0000d240: 7420 686f 6c64 2074 6865 2063 6f6c 6c65  t hold the colle
+0000d250: 6374 696f 6e20 6c6f 636b 2e0a 2020 2020  ction lock..    
+0000d260: 2020 2020 3a74 7970 6520 696e 5f62 6163      :type in_bac
+0000d270: 6b67 726f 756e 643a 2062 6f6f 6c20 7c20  kground: bool | 
+0000d280: 4e6f 6e65 0a20 2020 2020 2020 203a 7265  None.        :re
+0000d290: 7475 726e 3a20 4e65 7720 696e 6465 7820  turn: New index 
+0000d2a0: 6465 7461 696c 732e 0a20 2020 2020 2020  details..       
+0000d2b0: 203a 7274 7970 653a 2064 6963 740a 2020   :rtype: dict.  
+0000d2c0: 2020 2020 2020 3a72 6169 7365 2061 7261        :raise ara
+0000d2d0: 6e67 6f2e 6578 6365 7074 696f 6e73 2e49  ngo.exceptions.I
+0000d2e0: 6e64 6578 4372 6561 7465 4572 726f 723a  ndexCreateError:
+0000d2f0: 2049 6620 6372 6561 7465 2066 6169 6c73   If create fails
+0000d300: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0000d310: 2020 2020 2020 6d20 3d20 2261 6464 5f66        m = "add_f
+0000d320: 756c 6c74 6578 745f 696e 6465 7820 6973  ulltext_index is
+0000d330: 2064 6570 7265 6361 7465 642e 2055 7369   deprecated. Usi
+0000d340: 6e67 2061 6464 5f69 6e64 6578 2077 6974  ng add_index wit
+0000d350: 6820 7b27 7479 7065 273a 2027 6675 6c6c  h {'type': 'full
+0000d360: 7465 7874 277d 2069 6e73 7465 6164 2e22  text'} instead."
+0000d370: 2020 2320 6e6f 7161 3a20 4535 3031 0a20    # noqa: E501. 
+0000d380: 2020 2020 2020 2077 6172 6e28 6d2c 2044         warn(m, D
+0000d390: 6570 7265 6361 7469 6f6e 5761 726e 696e  eprecationWarnin
+0000d3a0: 672c 2073 7461 636b 6c65 7665 6c3d 3229  g, stacklevel=2)
+0000d3b0: 0a0a 2020 2020 2020 2020 6461 7461 3a20  ..        data: 
+0000d3c0: 4a73 6f6e 203d 207b 2274 7970 6522 3a20  Json = {"type": 
+0000d3d0: 2266 756c 6c74 6578 7422 2c20 2266 6965  "fulltext", "fie
+0000d3e0: 6c64 7322 3a20 6669 656c 6473 7d0a 0a20  lds": fields}.. 
+0000d3f0: 2020 2020 2020 2069 6620 6d69 6e5f 6c65         if min_le
+0000d400: 6e67 7468 2069 7320 6e6f 7420 4e6f 6e65  ngth is not None
+0000d410: 3a0a 2020 2020 2020 2020 2020 2020 6461  :.            da
+0000d420: 7461 5b22 6d69 6e4c 656e 6774 6822 5d20  ta["minLength"] 
+0000d430: 3d20 6d69 6e5f 6c65 6e67 7468 0a20 2020  = min_length.   
+0000d440: 2020 2020 2069 6620 6e61 6d65 2069 7320       if name is 
+0000d450: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+0000d460: 2020 2020 2020 6461 7461 5b22 6e61 6d65        data["name
+0000d470: 225d 203d 206e 616d 650a 2020 2020 2020  "] = name.      
+0000d480: 2020 6966 2069 6e5f 6261 636b 6772 6f75    if in_backgrou
+0000d490: 6e64 2069 7320 6e6f 7420 4e6f 6e65 3a0a  nd is not None:.
+0000d4a0: 2020 2020 2020 2020 2020 2020 6461 7461              data
+0000d4b0: 5b22 696e 4261 636b 6772 6f75 6e64 225d  ["inBackground"]
+0000d4c0: 203d 2069 6e5f 6261 636b 6772 6f75 6e64   = in_background
+0000d4d0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000d4e0: 2073 656c 662e 6164 645f 696e 6465 7828   self.add_index(
+0000d4f0: 6461 7461 2c20 666f 726d 6174 7465 723d  data, formatter=
+0000d500: 5472 7565 290a 0a20 2020 2064 6566 2061  True)..    def a
+0000d510: 6464 5f70 6572 7369 7374 656e 745f 696e  dd_persistent_in
+0000d520: 6465 7828 0a20 2020 2020 2020 2073 656c  dex(.        sel
+0000d530: 662c 0a20 2020 2020 2020 2066 6965 6c64  f,.        field
+0000d540: 733a 2053 6571 7565 6e63 655b 7374 725d  s: Sequence[str]
+0000d550: 2c0a 2020 2020 2020 2020 756e 6971 7565  ,.        unique
+0000d560: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
+0000d570: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0000d580: 2073 7061 7273 653a 204f 7074 696f 6e61   sparse: Optiona
+0000d590: 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65 2c0a  l[bool] = None,.
+0000d5a0: 2020 2020 2020 2020 6e61 6d65 3a20 4f70          name: Op
+0000d5b0: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
+0000d5c0: 6e65 2c0a 2020 2020 2020 2020 696e 5f62  ne,.        in_b
+0000d5d0: 6163 6b67 726f 756e 643a 204f 7074 696f  ackground: Optio
+0000d5e0: 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65  nal[bool] = None
+0000d5f0: 2c0a 2020 2020 2020 2020 7374 6f72 6564  ,.        stored
+0000d600: 5661 6c75 6573 3a20 4f70 7469 6f6e 616c  Values: Optional
+0000d610: 5b53 6571 7565 6e63 655b 7374 725d 5d20  [Sequence[str]] 
+0000d620: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+0000d630: 6361 6368 6545 6e61 626c 6564 3a20 4f70  cacheEnabled: Op
+0000d640: 7469 6f6e 616c 5b62 6f6f 6c5d 203d 204e  tional[bool] = N
+0000d650: 6f6e 652c 0a20 2020 2029 202d 3e20 5265  one,.    ) -> Re
+0000d660: 7375 6c74 5b4a 736f 6e5d 3a0a 2020 2020  sult[Json]:.    
+0000d670: 2020 2020 2222 2243 7265 6174 6520 6120      """Create a 
+0000d680: 6e65 7720 7065 7273 6973 7465 6e74 2069  new persistent i
+0000d690: 6e64 6578 2e0a 0a20 2020 2020 2020 2055  ndex...        U
+0000d6a0: 6e69 7175 6520 7065 7273 6973 7465 6e74  nique persistent
+0000d6b0: 2069 6e64 6578 6573 206f 6e20 6e6f 6e2d   indexes on non-
+0000d6c0: 7368 6172 6465 6420 6b65 7973 2061 7265  sharded keys are
+0000d6d0: 206e 6f74 2073 7570 706f 7274 6564 2069   not supported i
+0000d6e0: 6e20 610a 2020 2020 2020 2020 636c 7573  n a.        clus
+0000d6f0: 7465 722e 0a0a 2020 2020 2020 2020 3a70  ter...        :p
+0000d700: 6172 616d 2066 6965 6c64 733a 2044 6f63  aram fields: Doc
+0000d710: 756d 656e 7420 6669 656c 6473 2074 6f20  ument fields to 
+0000d720: 696e 6465 782e 0a20 2020 2020 2020 203a  index..        :
+0000d730: 7479 7065 2066 6965 6c64 733a 205b 7374  type fields: [st
+0000d740: 725d 0a20 2020 2020 2020 203a 7061 7261  r].        :para
+0000d750: 6d20 756e 6971 7565 3a20 5768 6574 6865  m unique: Whethe
+0000d760: 7220 7468 6520 696e 6465 7820 6973 2075  r the index is u
+0000d770: 6e69 7175 652e 0a20 2020 2020 2020 203a  nique..        :
+0000d780: 7479 7065 2075 6e69 7175 653a 2062 6f6f  type unique: boo
+0000d790: 6c20 7c20 4e6f 6e65 0a20 2020 2020 2020  l | None.       
+0000d7a0: 203a 7061 7261 6d20 7370 6172 7365 3a20   :param sparse: 
+0000d7b0: 4578 636c 7564 6520 646f 6375 6d65 6e74  Exclude document
+0000d7c0: 7320 7468 6174 2064 6f20 6e6f 7420 636f  s that do not co
+0000d7d0: 6e74 6169 6e20 6174 206c 6561 7374 206f  ntain at least o
+0000d7e0: 6e65 206f 660a 2020 2020 2020 2020 2020  ne of.          
+0000d7f0: 2020 7468 6520 696e 6465 7865 6420 6669    the indexed fi
+0000d800: 656c 6473 2c20 6f72 2064 6f63 756d 656e  elds, or documen
+0000d810: 7473 2074 6861 7420 6861 7665 2061 2076  ts that have a v
+0000d820: 616c 7565 206f 6620 4e6f 6e65 2069 6e20  alue of None in 
+0000d830: 616e 790a 2020 2020 2020 2020 2020 2020  any.            
+0000d840: 6f66 2074 6865 2069 6e64 6578 6564 2066  of the indexed f
+0000d850: 6965 6c64 732e 0a20 2020 2020 2020 203a  ields..        :
+0000d860: 7479 7065 2073 7061 7273 653a 2062 6f6f  type sparse: boo
+0000d870: 6c20 7c20 4e6f 6e65 0a20 2020 2020 2020  l | None.       
+0000d880: 203a 7061 7261 6d20 6e61 6d65 3a20 4f70   :param name: Op
+0000d890: 7469 6f6e 616c 206e 616d 6520 666f 7220  tional name for 
+0000d8a0: 7468 6520 696e 6465 782e 0a20 2020 2020  the index..     
+0000d8b0: 2020 203a 7479 7065 206e 616d 653a 2073     :type name: s
+0000d8c0: 7472 207c 204e 6f6e 650a 2020 2020 2020  tr | None.      
+0000d8d0: 2020 3a70 6172 616d 2069 6e5f 6261 636b    :param in_back
+0000d8e0: 6772 6f75 6e64 3a20 446f 206e 6f74 2068  ground: Do not h
+0000d8f0: 6f6c 6420 7468 6520 636f 6c6c 6563 7469  old the collecti
+0000d900: 6f6e 206c 6f63 6b2e 0a20 2020 2020 2020  on lock..       
+0000d910: 203a 7479 7065 2069 6e5f 6261 636b 6772   :type in_backgr
+0000d920: 6f75 6e64 3a20 626f 6f6c 207c 204e 6f6e  ound: bool | Non
+0000d930: 650a 2020 2020 2020 2020 3a70 6172 616d  e.        :param
+0000d940: 2073 746f 7265 6456 616c 7565 733a 2041   storedValues: A
+0000d950: 6464 6974 696f 6e61 6c20 6174 7472 6962  dditional attrib
+0000d960: 7574 6573 2074 6f20 696e 636c 7564 6520  utes to include 
+0000d970: 696e 2061 2070 6572 7369 7374 656e 740a  in a persistent.
+0000d980: 2020 2020 2020 2020 2020 2020 696e 6465              inde
+0000d990: 782e 2054 6865 7365 2061 6464 6974 696f  x. These additio
+0000d9a0: 6e61 6c20 6174 7472 6962 7574 6573 2063  nal attributes c
+0000d9b0: 616e 6e6f 7420 6265 2075 7365 6420 666f  annot be used fo
+0000d9c0: 7220 696e 6465 780a 2020 2020 2020 2020  r index.        
+0000d9d0: 2020 2020 6c6f 6f6b 7570 7320 6f72 2073      lookups or s
+0000d9e0: 6f72 7473 2c20 6275 7420 7468 6579 2063  orts, but they c
+0000d9f0: 616e 2062 6520 7573 6564 2066 6f72 2070  an be used for p
+0000da00: 726f 6a65 6374 696f 6e73 2e20 4d75 7374  rojections. Must
+0000da10: 2062 650a 2020 2020 2020 2020 2020 2020   be.            
+0000da20: 616e 2061 7272 6179 206f 6620 696e 6465  an array of inde
+0000da30: 7820 6174 7472 6962 7574 6520 7061 7468  x attribute path
+0000da40: 732e 2054 6865 7265 206d 7573 7420 6265  s. There must be
+0000da50: 206e 6f20 6f76 6572 6c61 7020 6f66 0a20   no overlap of. 
+0000da60: 2020 2020 2020 2020 2020 2061 7474 7269             attri
+0000da70: 6275 7465 2070 6174 6873 2062 6574 7765  bute paths betwe
+0000da80: 656e 2066 6965 6c64 7320 616e 6420 7374  en fields and st
+0000da90: 6f72 6564 5661 6c75 6573 2e20 5468 6520  oredValues. The 
+0000daa0: 6d61 7869 6d75 6d0a 2020 2020 2020 2020  maximum.        
+0000dab0: 2020 2020 6e75 6d62 6572 206f 6620 7661      number of va
+0000dac0: 6c75 6573 2069 7320 3332 2e0a 2020 2020  lues is 32..    
+0000dad0: 2020 2020 3a74 7970 6520 7374 6f72 6564      :type stored
+0000dae0: 5661 6c75 6573 3a20 5b73 7472 5d0a 2020  Values: [str].  
+0000daf0: 2020 2020 2020 3a70 6172 616d 2063 6163        :param cac
+0000db00: 6865 456e 6162 6c65 643a 2045 6e61 626c  heEnabled: Enabl
+0000db10: 6520 616e 2069 6e2d 6d65 6d6f 7279 2063  e an in-memory c
+0000db20: 6163 6865 2066 6f72 2069 6e64 6578 2076  ache for index v
+0000db30: 616c 7565 7320 666f 720a 2020 2020 2020  alues for.      
+0000db40: 2020 2020 2020 7065 7273 6973 7465 6e74        persistent
+0000db50: 2069 6e64 6578 6573 2e0a 2020 2020 2020   indexes..      
+0000db60: 2020 3a74 7970 6520 6361 6368 6545 6e61    :type cacheEna
+0000db70: 626c 6564 3a20 626f 6f6c 207c 204e 6f6e  bled: bool | Non
+0000db80: 650a 2020 2020 2020 2020 3a72 6574 7572  e.        :retur
+0000db90: 6e3a 204e 6577 2069 6e64 6578 2064 6574  n: New index det
+0000dba0: 6169 6c73 2e0a 2020 2020 2020 2020 3a72  ails..        :r
+0000dbb0: 7479 7065 3a20 6469 6374 0a20 2020 2020  type: dict.     
+0000dbc0: 2020 203a 7261 6973 6520 6172 616e 676f     :raise arango
+0000dbd0: 2e65 7863 6570 7469 6f6e 732e 496e 6465  .exceptions.Inde
+0000dbe0: 7843 7265 6174 6545 7272 6f72 3a20 4966  xCreateError: If
+0000dbf0: 2063 7265 6174 6520 6661 696c 732e 0a20   create fails.. 
+0000dc00: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000dc10: 2020 206d 203d 2022 6164 645f 7065 7273     m = "add_pers
+0000dc20: 6973 7465 6e74 5f69 6e64 6578 2069 7320  istent_index is 
+0000dc30: 6465 7072 6563 6174 6564 2e20 5573 696e  deprecated. Usin
+0000dc40: 6720 6164 645f 696e 6465 7820 7769 7468  g add_index with
+0000dc50: 207b 2774 7970 6527 3a20 2770 6572 7369   {'type': 'persi
+0000dc60: 7374 656e 7427 7d20 696e 7374 6561 642e  stent'} instead.
+0000dc70: 2220 2023 206e 6f71 613a 2045 3530 310a  "  # noqa: E501.
+0000dc80: 2020 2020 2020 2020 7761 726e 286d 2c20          warn(m, 
+0000dc90: 4465 7072 6563 6174 696f 6e57 6172 6e69  DeprecationWarni
+0000dca0: 6e67 2c20 7374 6163 6b6c 6576 656c 3d32  ng, stacklevel=2
+0000dcb0: 290a 0a20 2020 2020 2020 2064 6174 613a  )..        data:
+0000dcc0: 204a 736f 6e20 3d20 7b22 7479 7065 223a   Json = {"type":
+0000dcd0: 2022 7065 7273 6973 7465 6e74 222c 2022   "persistent", "
+0000dce0: 6669 656c 6473 223a 2066 6965 6c64 737d  fields": fields}
+0000dcf0: 0a0a 2020 2020 2020 2020 6966 2075 6e69  ..        if uni
+0000dd00: 7175 6520 6973 206e 6f74 204e 6f6e 653a  que is not None:
+0000dd10: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
+0000dd20: 615b 2275 6e69 7175 6522 5d20 3d20 756e  a["unique"] = un
+0000dd30: 6971 7565 0a20 2020 2020 2020 2069 6620  ique.        if 
+0000dd40: 7370 6172 7365 2069 7320 6e6f 7420 4e6f  sparse is not No
+0000dd50: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0000dd60: 6461 7461 5b22 7370 6172 7365 225d 203d  data["sparse"] =
+0000dd70: 2073 7061 7273 650a 2020 2020 2020 2020   sparse.        
+0000dd80: 6966 206e 616d 6520 6973 206e 6f74 204e  if name is not N
+0000dd90: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+0000dda0: 2064 6174 615b 226e 616d 6522 5d20 3d20   data["name"] = 
+0000ddb0: 6e61 6d65 0a20 2020 2020 2020 2069 6620  name.        if 
+0000ddc0: 696e 5f62 6163 6b67 726f 756e 6420 6973  in_background is
+0000ddd0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+0000dde0: 2020 2020 2020 2064 6174 615b 2269 6e42         data["inB
+0000ddf0: 6163 6b67 726f 756e 6422 5d20 3d20 696e  ackground"] = in
+0000de00: 5f62 6163 6b67 726f 756e 640a 2020 2020  _background.    
+0000de10: 2020 2020 6966 2073 746f 7265 6456 616c      if storedVal
+0000de20: 7565 7320 6973 206e 6f74 204e 6f6e 653a  ues is not None:
+0000de30: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
+0000de40: 615b 2273 746f 7265 6456 616c 7565 7322  a["storedValues"
+0000de50: 5d20 3d20 7374 6f72 6564 5661 6c75 6573  ] = storedValues
+0000de60: 0a20 2020 2020 2020 2069 6620 6361 6368  .        if cach
+0000de70: 6545 6e61 626c 6564 2069 7320 6e6f 7420  eEnabled is not 
+0000de80: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000de90: 2020 6461 7461 5b22 6361 6368 6545 6e61    data["cacheEna
+0000dea0: 626c 6564 225d 203d 2063 6163 6865 456e  bled"] = cacheEn
+0000deb0: 6162 6c65 640a 0a20 2020 2020 2020 2072  abled..        r
+0000dec0: 6574 7572 6e20 7365 6c66 2e61 6464 5f69  eturn self.add_i
+0000ded0: 6e64 6578 2864 6174 612c 2066 6f72 6d61  ndex(data, forma
+0000dee0: 7474 6572 3d54 7275 6529 0a0a 2020 2020  tter=True)..    
+0000def0: 6465 6620 6164 645f 7474 6c5f 696e 6465  def add_ttl_inde
+0000df00: 7828 0a20 2020 2020 2020 2073 656c 662c  x(.        self,
+0000df10: 0a20 2020 2020 2020 2066 6965 6c64 733a  .        fields:
+0000df20: 2053 6571 7565 6e63 655b 7374 725d 2c0a   Sequence[str],.
+0000df30: 2020 2020 2020 2020 6578 7069 7279 5f74          expiry_t
+0000df40: 696d 653a 2069 6e74 2c0a 2020 2020 2020  ime: int,.      
+0000df50: 2020 6e61 6d65 3a20 4f70 7469 6f6e 616c    name: Optional
+0000df60: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
+0000df70: 2020 2020 2020 696e 5f62 6163 6b67 726f        in_backgro
+0000df80: 756e 643a 204f 7074 696f 6e61 6c5b 626f  und: Optional[bo
+0000df90: 6f6c 5d20 3d20 4e6f 6e65 2c0a 2020 2020  ol] = None,.    
+0000dfa0: 2920 2d3e 2052 6573 756c 745b 4a73 6f6e  ) -> Result[Json
+0000dfb0: 5d3a 0a20 2020 2020 2020 2022 2222 4372  ]:.        """Cr
+0000dfc0: 6561 7465 2061 206e 6577 2054 544c 2028  eate a new TTL (
+0000dfd0: 7469 6d65 2d74 6f2d 6c69 7665 2920 696e  time-to-live) in
+0000dfe0: 6465 782e 0a0a 2020 2020 2020 2020 3a70  dex...        :p
+0000dff0: 6172 616d 2066 6965 6c64 733a 2044 6f63  aram fields: Doc
+0000e000: 756d 656e 7420 6669 656c 6420 746f 2069  ument field to i
+0000e010: 6e64 6578 2e0a 2020 2020 2020 2020 3a74  ndex..        :t
+0000e020: 7970 6520 6669 656c 6473 3a20 5b73 7472  ype fields: [str
+0000e030: 5d0a 2020 2020 2020 2020 3a70 6172 616d  ].        :param
+0000e040: 2065 7870 6972 795f 7469 6d65 3a20 5469   expiry_time: Ti
+0000e050: 6d65 206f 6620 6578 7069 7279 2069 6e20  me of expiry in 
+0000e060: 7365 636f 6e64 7320 6166 7465 7220 646f  seconds after do
+0000e070: 6375 6d65 6e74 2063 7265 6174 696f 6e2e  cument creation.
+0000e080: 0a20 2020 2020 2020 203a 7479 7065 2065  .        :type e
+0000e090: 7870 6972 795f 7469 6d65 3a20 696e 740a  xpiry_time: int.
+0000e0a0: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
+0000e0b0: 616d 653a 204f 7074 696f 6e61 6c20 6e61  ame: Optional na
+0000e0c0: 6d65 2066 6f72 2074 6865 2069 6e64 6578  me for the index
+0000e0d0: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
+0000e0e0: 6e61 6d65 3a20 7374 7220 7c20 4e6f 6e65  name: str | None
+0000e0f0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000e100: 696e 5f62 6163 6b67 726f 756e 643a 2044  in_background: D
+0000e110: 6f20 6e6f 7420 686f 6c64 2074 6865 2063  o not hold the c
+0000e120: 6f6c 6c65 6374 696f 6e20 6c6f 636b 2e0a  ollection lock..
+0000e130: 2020 2020 2020 2020 3a74 7970 6520 696e          :type in
+0000e140: 5f62 6163 6b67 726f 756e 643a 2062 6f6f  _background: boo
+0000e150: 6c20 7c20 4e6f 6e65 0a20 2020 2020 2020  l | None.       
+0000e160: 203a 7265 7475 726e 3a20 4e65 7720 696e   :return: New in
+0000e170: 6465 7820 6465 7461 696c 732e 0a20 2020  dex details..   
+0000e180: 2020 2020 203a 7274 7970 653a 2064 6963       :rtype: dic
+0000e190: 740a 2020 2020 2020 2020 3a72 6169 7365  t.        :raise
+0000e1a0: 2061 7261 6e67 6f2e 6578 6365 7074 696f   arango.exceptio
+0000e1b0: 6e73 2e49 6e64 6578 4372 6561 7465 4572  ns.IndexCreateEr
+0000e1c0: 726f 723a 2049 6620 6372 6561 7465 2066  ror: If create f
+0000e1d0: 6169 6c73 2e0a 2020 2020 2020 2020 2222  ails..        ""
+0000e1e0: 220a 2020 2020 2020 2020 6d20 3d20 2261  ".        m = "a
+0000e1f0: 6464 5f74 746c 5f69 6e64 6578 2069 7320  dd_ttl_index is 
+0000e200: 6465 7072 6563 6174 6564 2e20 5573 696e  deprecated. Usin
+0000e210: 6720 6164 645f 696e 6465 7820 7769 7468  g add_index with
+0000e220: 207b 2774 7970 6527 3a20 2774 746c 277d   {'type': 'ttl'}
+0000e230: 2069 6e73 7465 6164 2e22 2020 2320 6e6f   instead."  # no
+0000e240: 7161 3a20 4535 3031 0a20 2020 2020 2020  qa: E501.       
+0000e250: 2077 6172 6e28 6d2c 2044 6570 7265 6361   warn(m, Depreca
+0000e260: 7469 6f6e 5761 726e 696e 672c 2073 7461  tionWarning, sta
+0000e270: 636b 6c65 7665 6c3d 3229 0a0a 2020 2020  cklevel=2)..    
+0000e280: 2020 2020 6461 7461 3a20 4a73 6f6e 203d      data: Json =
+0000e290: 207b 2274 7970 6522 3a20 2274 746c 222c   {"type": "ttl",
+0000e2a0: 2022 6669 656c 6473 223a 2066 6965 6c64   "fields": field
+0000e2b0: 732c 2022 6578 7069 7265 4166 7465 7222  s, "expireAfter"
+0000e2c0: 3a20 6578 7069 7279 5f74 696d 657d 0a0a  : expiry_time}..
+0000e2d0: 2020 2020 2020 2020 6966 206e 616d 6520          if name 
+0000e2e0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0000e2f0: 2020 2020 2020 2020 2064 6174 615b 226e           data["n
+0000e300: 616d 6522 5d20 3d20 6e61 6d65 0a20 2020  ame"] = name.   
+0000e310: 2020 2020 2069 6620 696e 5f62 6163 6b67       if in_backg
+0000e320: 726f 756e 6420 6973 206e 6f74 204e 6f6e  round is not Non
+0000e330: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
+0000e340: 6174 615b 2269 6e42 6163 6b67 726f 756e  ata["inBackgroun
+0000e350: 6422 5d20 3d20 696e 5f62 6163 6b67 726f  d"] = in_backgro
+0000e360: 756e 640a 0a20 2020 2020 2020 2072 6574  und..        ret
+0000e370: 7572 6e20 7365 6c66 2e61 6464 5f69 6e64  urn self.add_ind
+0000e380: 6578 2864 6174 612c 2066 6f72 6d61 7474  ex(data, formatt
+0000e390: 6572 3d54 7275 6529 0a0a 2020 2020 6465  er=True)..    de
+0000e3a0: 6620 6164 645f 696e 7665 7274 6564 5f69  f add_inverted_i
+0000e3b0: 6e64 6578 280a 2020 2020 2020 2020 7365  ndex(.        se
+0000e3c0: 6c66 2c0a 2020 2020 2020 2020 6669 656c  lf,.        fiel
+0000e3d0: 6473 3a20 4a73 6f6e 2c0a 2020 2020 2020  ds: Json,.      
+0000e3e0: 2020 6e61 6d65 3a20 4f70 7469 6f6e 616c    name: Optional
+0000e3f0: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
+0000e400: 2020 2020 2020 696e 4261 636b 6772 6f75        inBackgrou
+0000e410: 6e64 3a20 4f70 7469 6f6e 616c 5b62 6f6f  nd: Optional[boo
+0000e420: 6c5d 203d 204e 6f6e 652c 0a20 2020 2020  l] = None,.     
+0000e430: 2020 2070 6172 616c 6c65 6c69 736d 3a20     parallelism: 
+0000e440: 4f70 7469 6f6e 616c 5b69 6e74 5d20 3d20  Optional[int] = 
+0000e450: 4e6f 6e65 2c0a 2020 2020 2020 2020 7072  None,.        pr
+0000e460: 696d 6172 7953 6f72 743a 204f 7074 696f  imarySort: Optio
+0000e470: 6e61 6c5b 4a73 6f6e 5d20 3d20 4e6f 6e65  nal[Json] = None
+0000e480: 2c0a 2020 2020 2020 2020 7374 6f72 6564  ,.        stored
+0000e490: 5661 6c75 6573 3a20 4f70 7469 6f6e 616c  Values: Optional
+0000e4a0: 5b53 6571 7565 6e63 655b 4a73 6f6e 5d5d  [Sequence[Json]]
+0000e4b0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0000e4c0: 2061 6e61 6c79 7a65 723a 204f 7074 696f   analyzer: Optio
+0000e4d0: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
+0000e4e0: 0a20 2020 2020 2020 2066 6561 7475 7265  .        feature
+0000e4f0: 733a 204f 7074 696f 6e61 6c5b 5365 7175  s: Optional[Sequ
+0000e500: 656e 6365 5b73 7472 5d5d 203d 204e 6f6e  ence[str]] = Non
+0000e510: 652c 0a20 2020 2020 2020 2069 6e63 6c75  e,.        inclu
+0000e520: 6465 416c 6c46 6965 6c64 733a 204f 7074  deAllFields: Opt
+0000e530: 696f 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f  ional[bool] = No
+0000e540: 6e65 2c0a 2020 2020 2020 2020 7472 6163  ne,.        trac
+0000e550: 6b4c 6973 7450 6f73 6974 696f 6e73 3a20  kListPositions: 
+0000e560: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 203d  Optional[bool] =
+0000e570: 204e 6f6e 652c 0a20 2020 2020 2020 2073   None,.        s
+0000e580: 6561 7263 6846 6965 6c64 3a20 4f70 7469  earchField: Opti
+0000e590: 6f6e 616c 5b62 6f6f 6c5d 203d 204e 6f6e  onal[bool] = Non
+0000e5a0: 652c 0a20 2020 2020 2020 2070 7269 6d61  e,.        prima
+0000e5b0: 7279 4b65 7943 6163 6865 3a20 4f70 7469  ryKeyCache: Opti
+0000e5c0: 6f6e 616c 5b62 6f6f 6c5d 203d 204e 6f6e  onal[bool] = Non
+0000e5d0: 652c 0a20 2020 2020 2020 2063 6163 6865  e,.        cache
+0000e5e0: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
+0000e5f0: 203d 204e 6f6e 652c 0a20 2020 2029 202d   = None,.    ) -
+0000e600: 3e20 5265 7375 6c74 5b4a 736f 6e5d 3a0a  > Result[Json]:.
+0000e610: 2020 2020 2020 2020 2222 2243 7265 6174          """Creat
+0000e620: 6520 6120 6e65 7720 696e 7665 7274 6564  e a new inverted
+0000e630: 2069 6e64 6578 2c20 696e 7472 6f64 7563   index, introduc
+0000e640: 6564 2069 6e20 7665 7273 696f 6e20 332e  ed in version 3.
+0000e650: 3130 2e0a 0a20 2020 2020 2020 203a 7061  10...        :pa
+0000e660: 7261 6d20 6669 656c 6473 3a20 446f 6375  ram fields: Docu
+0000e670: 6d65 6e74 2066 6965 6c64 7320 746f 2069  ment fields to i
+0000e680: 6e64 6578 2e0a 2020 2020 2020 2020 3a74  ndex..        :t
+0000e690: 7970 6520 6669 656c 6473 3a20 4a73 6f6e  ype fields: Json
+0000e6a0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000e6b0: 6e61 6d65 3a20 4f70 7469 6f6e 616c 206e  name: Optional n
+0000e6c0: 616d 6520 666f 7220 7468 6520 696e 6465  ame for the inde
+0000e6d0: 782e 0a20 2020 2020 2020 203a 7479 7065  x..        :type
+0000e6e0: 206e 616d 653a 2073 7472 207c 204e 6f6e   name: str | Non
+0000e6f0: 650a 2020 2020 2020 2020 3a70 6172 616d  e.        :param
+0000e700: 2069 6e42 6163 6b67 726f 756e 643a 2044   inBackground: D
+0000e710: 6f20 6e6f 7420 686f 6c64 2074 6865 2063  o not hold the c
+0000e720: 6f6c 6c65 6374 696f 6e20 6c6f 636b 2e0a  ollection lock..
+0000e730: 2020 2020 2020 2020 3a74 7970 6520 696e          :type in
+0000e740: 4261 636b 6772 6f75 6e64 3a20 626f 6f6c  Background: bool
+0000e750: 207c 204e 6f6e 650a 2020 2020 2020 2020   | None.        
+0000e760: 3a70 6172 616d 2070 6172 616c 6c65 6c69  :param paralleli
+0000e770: 736d 3a20 5468 6520 6e75 6d62 6572 206f  sm: The number o
+0000e780: 6620 7468 7265 6164 7320 746f 2075 7365  f threads to use
+0000e790: 2066 6f72 2069 6e64 6578 696e 6720 7468   for indexing th
+0000e7a0: 6520 6669 656c 6473 2e0a 2020 2020 2020  e fields..      
+0000e7b0: 2020 3a74 7970 6520 7061 7261 6c6c 656c    :type parallel
+0000e7c0: 6973 6d3a 2069 6e74 207c 204e 6f6e 650a  ism: int | None.
+0000e7d0: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
+0000e7e0: 7269 6d61 7279 536f 7274 3a20 5072 696d  rimarySort: Prim
+0000e7f0: 6172 7920 736f 7274 206f 7264 6572 2074  ary sort order t
+0000e800: 6f20 656e 6162 6c65 2061 6e20 4151 4c20  o enable an AQL 
+0000e810: 6f70 7469 6d69 7a61 7469 6f6e 2e0a 2020  optimization..  
+0000e820: 2020 2020 2020 3a74 7970 6520 7072 696d        :type prim
+0000e830: 6172 7953 6f72 743a 204f 7074 696f 6e61  arySort: Optiona
+0000e840: 6c5b 4a73 6f6e 5d0a 2020 2020 2020 2020  l[Json].        
+0000e850: 3a70 6172 616d 2073 746f 7265 6456 616c  :param storedVal
+0000e860: 7565 733a 2041 6e20 6172 7261 7920 6f66  ues: An array of
+0000e870: 206f 626a 6563 7473 2077 6974 6820 7061   objects with pa
+0000e880: 7468 7320 746f 2061 6464 6974 696f 6e61  ths to additiona
+0000e890: 6c0a 2020 2020 2020 2020 2020 2020 6174  l.            at
+0000e8a0: 7472 6962 7574 6573 2074 6f20 7374 6f72  tributes to stor
+0000e8b0: 6520 696e 2074 6865 2069 6e64 6578 2e0a  e in the index..
+0000e8c0: 2020 2020 2020 2020 3a74 7970 6520 7374          :type st
+0000e8d0: 6f72 6564 5661 6c75 6573 3a20 5365 7175  oredValues: Sequ
+0000e8e0: 656e 6365 5b4a 736f 6e5d 207c 204e 6f6e  ence[Json] | Non
+0000e8f0: 650a 2020 2020 2020 2020 3a70 6172 616d  e.        :param
+0000e900: 2061 6e61 6c79 7a65 723a 2041 6e61 6c79   analyzer: Analy
+0000e910: 7a65 7220 746f 2075 7365 2062 7920 6465  zer to use by de
+0000e920: 6661 756c 742e 0a20 2020 2020 2020 203a  fault..        :
+0000e930: 7479 7065 2061 6e61 6c79 7a65 723a 204f  type analyzer: O
+0000e940: 7074 696f 6e61 6c5b 7374 725d 0a20 2020  ptional[str].   
+0000e950: 2020 2020 203a 7061 7261 6d20 6665 6174       :param feat
+0000e960: 7572 6573 3a20 4c69 7374 206f 6620 416e  ures: List of An
+0000e970: 616c 797a 6572 2066 6561 7475 7265 732e  alyzer features.
+0000e980: 0a20 2020 2020 2020 203a 7479 7065 2066  .        :type f
+0000e990: 6561 7475 7265 733a 2053 6571 7565 6e63  eatures: Sequenc
+0000e9a0: 655b 7374 725d 207c 204e 6f6e 650a 2020  e[str] | None.  
+0000e9b0: 2020 2020 2020 3a70 6172 616d 2069 6e63        :param inc
+0000e9c0: 6c75 6465 416c 6c46 6965 6c64 733a 2054  ludeAllFields: T
+0000e9d0: 6869 7320 6f70 7469 6f6e 206f 6e6c 7920  his option only 
+0000e9e0: 6170 706c 6965 7320 6966 2079 6f75 2075  applies if you u
+0000e9f0: 7365 2074 6865 0a20 2020 2020 2020 2020  se the.         
+0000ea00: 2020 2069 6e76 6572 7465 6420 696e 6465     inverted inde
+0000ea10: 7820 696e 2073 6561 7263 682d 616c 6961  x in search-alia
+0000ea20: 7320 7669 6577 732e 0a20 2020 2020 2020  s views..       
+0000ea30: 203a 7479 7065 2069 6e63 6c75 6465 416c   :type includeAl
+0000ea40: 6c46 6965 6c64 733a 2062 6f6f 6c20 7c20  lFields: bool | 
+0000ea50: 4e6f 6e65 0a20 2020 2020 2020 203a 7061  None.        :pa
+0000ea60: 7261 6d20 7472 6163 6b4c 6973 7450 6f73  ram trackListPos
+0000ea70: 6974 696f 6e73 3a20 5468 6973 206f 7074  itions: This opt
+0000ea80: 696f 6e20 6f6e 6c79 2061 7070 6c69 6573  ion only applies
+0000ea90: 2069 6620 796f 7520 7573 6520 7468 650a   if you use the.
+0000eaa0: 2020 2020 2020 2020 2020 2020 696e 7665              inve
+0000eab0: 7274 6564 2069 6e64 6578 2069 6e20 7365  rted index in se
+0000eac0: 6172 6368 2d61 6c69 6173 2076 6965 7773  arch-alias views
+0000ead0: 2c20 616e 6420 7365 6172 6368 4669 656c  , and searchFiel
+0000eae0: 6420 6973 2074 7275 652e 0a20 2020 2020  d is true..     
+0000eaf0: 2020 203a 7479 7065 2074 7261 636b 4c69     :type trackLi
+0000eb00: 7374 506f 7369 7469 6f6e 733a 2062 6f6f  stPositions: boo
+0000eb10: 6c20 7c20 4e6f 6e65 0a20 2020 2020 2020  l | None.       
+0000eb20: 203a 7061 7261 6d20 7365 6172 6368 4669   :param searchFi
+0000eb30: 656c 643a 2054 6869 7320 6f70 7469 6f6e  eld: This option
+0000eb40: 206f 6e6c 7920 6170 706c 6965 7320 6966   only applies if
+0000eb50: 2079 6f75 2075 7365 2074 6865 2069 6e76   you use the inv
+0000eb60: 6572 7465 640a 2020 2020 2020 2020 2020  erted.          
+0000eb70: 2020 696e 6465 7820 696e 2073 6561 7263    index in searc
+0000eb80: 682d 616c 6961 7320 7669 6577 730a 2020  h-alias views.  
+0000eb90: 2020 2020 2020 3a74 7970 6520 7365 6172        :type sear
+0000eba0: 6368 4669 656c 643a 2062 6f6f 6c20 7c20  chField: bool | 
+0000ebb0: 4e6f 6e65 0a20 2020 2020 2020 203a 7061  None.        :pa
+0000ebc0: 7261 6d20 7072 696d 6172 794b 6579 4361  ram primaryKeyCa
+0000ebd0: 6368 653a 2041 6c77 6179 7320 6361 6368  che: Always cach
+0000ebe0: 6520 7468 6520 7072 696d 6172 7920 6b65  e the primary ke
+0000ebf0: 7920 636f 6c75 6d6e 2069 6e20 6d65 6d6f  y column in memo
+0000ec00: 7279 2e0a 2020 2020 2020 2020 3a74 7970  ry..        :typ
+0000ec10: 6520 7072 696d 6172 794b 6579 4361 6368  e primaryKeyCach
+0000ec20: 653a 2062 6f6f 6c20 7c20 4e6f 6e65 0a20  e: bool | None. 
+0000ec30: 2020 2020 2020 203a 7061 7261 6d20 6361         :param ca
+0000ec40: 6368 653a 2041 6c77 6179 7320 6361 6368  che: Always cach
+0000ec50: 6520 7468 6520 6669 656c 6420 6e6f 726d  e the field norm
+0000ec60: 616c 697a 6174 696f 6e20 7661 6c75 6573  alization values
+0000ec70: 2069 6e20 6d65 6d6f 7279 0a20 2020 2020   in memory.     
+0000ec80: 2020 2020 2020 2066 6f72 2061 6c6c 2066         for all f
+0000ec90: 6965 6c64 7320 6279 2064 6566 6175 6c74  ields by default
+0000eca0: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
+0000ecb0: 6361 6368 653a 2062 6f6f 6c20 7c20 4e6f  cache: bool | No
+0000ecc0: 6e65 0a20 2020 2020 2020 203a 7265 7475  ne.        :retu
+0000ecd0: 726e 3a20 4e65 7720 696e 6465 7820 6465  rn: New index de
+0000ece0: 7461 696c 732e 0a20 2020 2020 2020 203a  tails..        :
+0000ecf0: 7274 7970 653a 2064 6963 740a 2020 2020  rtype: dict.    
+0000ed00: 2020 2020 3a72 6169 7365 2061 7261 6e67      :raise arang
+0000ed10: 6f2e 6578 6365 7074 696f 6e73 2e49 6e64  o.exceptions.Ind
+0000ed20: 6578 4372 6561 7465 4572 726f 723a 2049  exCreateError: I
+0000ed30: 6620 6372 6561 7465 2066 6169 6c73 2e0a  f create fails..
+0000ed40: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000ed50: 2020 2020 6d20 3d20 2261 6464 5f69 6e76      m = "add_inv
+0000ed60: 6572 7465 645f 696e 6465 7820 6973 2064  erted_index is d
+0000ed70: 6570 7265 6361 7465 642e 2055 7369 6e67  eprecated. Using
+0000ed80: 2061 6464 5f69 6e64 6578 2077 6974 6820   add_index with 
+0000ed90: 7b27 7479 7065 273a 2027 696e 7665 7274  {'type': 'invert
+0000eda0: 6564 277d 2069 6e73 7465 6164 2e22 2020  ed'} instead."  
+0000edb0: 2320 6e6f 7161 3a20 4535 3031 0a20 2020  # noqa: E501.   
+0000edc0: 2020 2020 2077 6172 6e28 6d2c 2044 6570       warn(m, Dep
+0000edd0: 7265 6361 7469 6f6e 5761 726e 696e 672c  recationWarning,
+0000ede0: 2073 7461 636b 6c65 7665 6c3d 3229 0a0a   stacklevel=2)..
+0000edf0: 2020 2020 2020 2020 6461 7461 3a20 4a73          data: Js
+0000ee00: 6f6e 203d 207b 2274 7970 6522 3a20 2269  on = {"type": "i
+0000ee10: 6e76 6572 7465 6422 2c20 2266 6965 6c64  nverted", "field
+0000ee20: 7322 3a20 6669 656c 6473 7d0a 0a20 2020  s": fields}..   
+0000ee30: 2020 2020 2069 6620 6e61 6d65 2069 7320       if name is 
+0000ee40: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+0000ee50: 2020 2020 2020 6461 7461 5b22 6e61 6d65        data["name
+0000ee60: 225d 203d 206e 616d 650a 2020 2020 2020  "] = name.      
+0000ee70: 2020 6966 2069 6e42 6163 6b67 726f 756e    if inBackgroun
+0000ee80: 6420 6973 206e 6f74 204e 6f6e 653a 0a20  d is not None:. 
+0000ee90: 2020 2020 2020 2020 2020 2064 6174 615b             data[
+0000eea0: 2269 6e42 6163 6b67 726f 756e 6422 5d20  "inBackground"] 
+0000eeb0: 3d20 696e 4261 636b 6772 6f75 6e64 0a20  = inBackground. 
+0000eec0: 2020 2020 2020 2069 6620 7061 7261 6c6c         if parall
+0000eed0: 656c 6973 6d20 6973 206e 6f74 204e 6f6e  elism is not Non
+0000eee0: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
+0000eef0: 6174 615b 2270 6172 616c 6c65 6c69 736d  ata["parallelism
+0000ef00: 225d 203d 2070 6172 616c 6c65 6c69 736d  "] = parallelism
+0000ef10: 0a20 2020 2020 2020 2069 6620 7072 696d  .        if prim
+0000ef20: 6172 7953 6f72 7420 6973 206e 6f74 204e  arySort is not N
+0000ef30: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+0000ef40: 2064 6174 615b 2270 7269 6d61 7279 536f   data["primarySo
+0000ef50: 7274 225d 203d 2070 7269 6d61 7279 536f  rt"] = primarySo
+0000ef60: 7274 0a20 2020 2020 2020 2069 6620 7374  rt.        if st
+0000ef70: 6f72 6564 5661 6c75 6573 2069 7320 6e6f  oredValues is no
+0000ef80: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+0000ef90: 2020 2020 6461 7461 5b22 7374 6f72 6564      data["stored
+0000efa0: 5661 6c75 6573 225d 203d 2073 746f 7265  Values"] = store
+0000efb0: 6456 616c 7565 730a 2020 2020 2020 2020  dValues.        
+0000efc0: 6966 2061 6e61 6c79 7a65 7220 6973 206e  if analyzer is n
+0000efd0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+0000efe0: 2020 2020 2064 6174 615b 2261 6e61 6c79       data["analy
+0000eff0: 7a65 7222 5d20 3d20 616e 616c 797a 6572  zer"] = analyzer
+0000f000: 0a20 2020 2020 2020 2069 6620 6665 6174  .        if feat
+0000f010: 7572 6573 2069 7320 6e6f 7420 4e6f 6e65  ures is not None
+0000f020: 3a0a 2020 2020 2020 2020 2020 2020 6461  :.            da
+0000f030: 7461 5b22 6665 6174 7572 6573 225d 203d  ta["features"] =
+0000f040: 2066 6561 7475 7265 730a 2020 2020 2020   features.      
+0000f050: 2020 6966 2069 6e63 6c75 6465 416c 6c46    if includeAllF
+0000f060: 6965 6c64 7320 6973 206e 6f74 204e 6f6e  ields is not Non
+0000f070: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
+0000f080: 6174 615b 2269 6e63 6c75 6465 416c 6c46  ata["includeAllF
+0000f090: 6965 6c64 7322 5d20 3d20 696e 636c 7564  ields"] = includ
+0000f0a0: 6541 6c6c 4669 656c 6473 0a20 2020 2020  eAllFields.     
+0000f0b0: 2020 2069 6620 7472 6163 6b4c 6973 7450     if trackListP
+0000f0c0: 6f73 6974 696f 6e73 2069 7320 6e6f 7420  ositions is not 
+0000f0d0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000f0e0: 2020 6461 7461 5b22 7472 6163 6b4c 6973    data["trackLis
+0000f0f0: 7450 6f73 6974 696f 6e73 225d 203d 2074  tPositions"] = t
+0000f100: 7261 636b 4c69 7374 506f 7369 7469 6f6e  rackListPosition
+0000f110: 730a 2020 2020 2020 2020 6966 2073 6561  s.        if sea
+0000f120: 7263 6846 6965 6c64 2069 7320 6e6f 7420  rchField is not 
+0000f130: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000f140: 2020 6461 7461 5b22 7365 6172 6368 4669    data["searchFi
+0000f150: 656c 6422 5d20 3d20 7365 6172 6368 4669  eld"] = searchFi
+0000f160: 656c 640a 2020 2020 2020 2020 6966 2066  eld.        if f
+0000f170: 6965 6c64 7320 6973 206e 6f74 204e 6f6e  ields is not Non
+0000f180: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
+0000f190: 6174 615b 2266 6965 6c64 7322 5d20 3d20  ata["fields"] = 
+0000f1a0: 6669 656c 6473 0a20 2020 2020 2020 2069  fields.        i
+0000f1b0: 6620 7072 696d 6172 794b 6579 4361 6368  f primaryKeyCach
+0000f1c0: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
+0000f1d0: 2020 2020 2020 2020 2020 2064 6174 615b             data[
+0000f1e0: 2270 7269 6d61 7279 4b65 7943 6163 6865  "primaryKeyCache
+0000f1f0: 225d 203d 2070 7269 6d61 7279 4b65 7943  "] = primaryKeyC
+0000f200: 6163 6865 0a20 2020 2020 2020 2069 6620  ache.        if 
+0000f210: 6361 6368 6520 6973 206e 6f74 204e 6f6e  cache is not Non
+0000f220: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
+0000f230: 6174 615b 2263 6163 6865 225d 203d 2063  ata["cache"] = c
+0000f240: 6163 6865 0a0a 2020 2020 2020 2020 7265  ache..        re
+0000f250: 7475 726e 2073 656c 662e 6164 645f 696e  turn self.add_in
+0000f260: 6465 7828 6461 7461 2c20 666f 726d 6174  dex(data, format
+0000f270: 7465 723d 5472 7565 290a 0a20 2020 2064  ter=True)..    d
+0000f280: 6566 2064 656c 6574 655f 696e 6465 7828  ef delete_index(
+0000f290: 7365 6c66 2c20 696e 6465 785f 6964 3a20  self, index_id: 
+0000f2a0: 7374 722c 2069 676e 6f72 655f 6d69 7373  str, ignore_miss
+0000f2b0: 696e 673a 2062 6f6f 6c20 3d20 4661 6c73  ing: bool = Fals
+0000f2c0: 6529 202d 3e20 5265 7375 6c74 5b62 6f6f  e) -> Result[boo
+0000f2d0: 6c5d 3a0a 2020 2020 2020 2020 2222 2244  l]:.        """D
+0000f2e0: 656c 6574 6520 616e 2069 6e64 6578 2e0a  elete an index..
+0000f2f0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000f300: 696e 6465 785f 6964 3a20 496e 6465 7820  index_id: Index 
+0000f310: 4944 2e0a 2020 2020 2020 2020 3a74 7970  ID..        :typ
+0000f320: 6520 696e 6465 785f 6964 3a20 7374 720a  e index_id: str.
+0000f330: 2020 2020 2020 2020 3a70 6172 616d 2069          :param i
+0000f340: 676e 6f72 655f 6d69 7373 696e 673a 2044  gnore_missing: D
+0000f350: 6f20 6e6f 7420 7261 6973 6520 616e 2065  o not raise an e
+0000f360: 7863 6570 7469 6f6e 206f 6e20 6d69 7373  xception on miss
+0000f370: 696e 6720 696e 6465 782e 0a20 2020 2020  ing index..     
+0000f380: 2020 203a 7479 7065 2069 676e 6f72 655f     :type ignore_
+0000f390: 6d69 7373 696e 673a 2062 6f6f 6c0a 2020  missing: bool.  
+0000f3a0: 2020 2020 2020 3a72 6574 7572 6e3a 2054        :return: T
+0000f3b0: 7275 6520 6966 2069 6e64 6578 2077 6173  rue if index was
+0000f3c0: 2064 656c 6574 6564 2073 7563 6365 7373   deleted success
+0000f3d0: 6675 6c6c 792c 2046 616c 7365 2069 6620  fully, False if 
+0000f3e0: 696e 6465 7820 7761 730a 2020 2020 2020  index was.      
+0000f3f0: 2020 2020 2020 6e6f 7420 666f 756e 6420        not found 
+0000f400: 616e 6420 2a2a 6967 6e6f 7265 5f6d 6973  and **ignore_mis
+0000f410: 7369 6e67 2a2a 2077 6173 2073 6574 2074  sing** was set t
+0000f420: 6f20 5472 7565 2e0a 2020 2020 2020 2020  o True..        
+0000f430: 3a72 7479 7065 3a20 626f 6f6c 0a20 2020  :rtype: bool.   
+0000f440: 2020 2020 203a 7261 6973 6520 6172 616e       :raise aran
+0000f450: 676f 2e65 7863 6570 7469 6f6e 732e 496e  go.exceptions.In
+0000f460: 6465 7844 656c 6574 6545 7272 6f72 3a20  dexDeleteError: 
+0000f470: 4966 2064 656c 6574 6520 6661 696c 732e  If delete fails.
+0000f480: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0000f490: 2020 2020 2072 6571 7565 7374 203d 2052       request = R
+0000f4a0: 6571 7565 7374 280a 2020 2020 2020 2020  equest(.        
+0000f4b0: 2020 2020 6d65 7468 6f64 3d22 6465 6c65      method="dele
+0000f4c0: 7465 222c 2065 6e64 706f 696e 743d 6622  te", endpoint=f"
+0000f4d0: 2f5f 6170 692f 696e 6465 782f 7b73 656c  /_api/index/{sel
+0000f4e0: 662e 6e61 6d65 7d2f 7b69 6e64 6578 5f69  f.name}/{index_i
+0000f4f0: 647d 220a 2020 2020 2020 2020 290a 0a20  d}".        ).. 
+0000f500: 2020 2020 2020 2064 6566 2072 6573 706f         def respo
+0000f510: 6e73 655f 6861 6e64 6c65 7228 7265 7370  nse_handler(resp
+0000f520: 3a20 5265 7370 6f6e 7365 2920 2d3e 2062  : Response) -> b
+0000f530: 6f6f 6c3a 0a20 2020 2020 2020 2020 2020  ool:.           
+0000f540: 2069 6620 7265 7370 2e65 7272 6f72 5f63   if resp.error_c
+0000f550: 6f64 6520 3d3d 2031 3231 3220 616e 6420  ode == 1212 and 
+0000f560: 6967 6e6f 7265 5f6d 6973 7369 6e67 3a0a  ignore_missing:.
+0000f570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f580: 7265 7475 726e 2046 616c 7365 0a20 2020  return False.   
+0000f590: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+0000f5a0: 7265 7370 2e69 735f 7375 6363 6573 733a  resp.is_success:
+0000f5b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f5c0: 2072 6169 7365 2049 6e64 6578 4465 6c65   raise IndexDele
+0000f5d0: 7465 4572 726f 7228 7265 7370 2c20 7265  teError(resp, re
+0000f5e0: 7175 6573 7429 0a20 2020 2020 2020 2020  quest).         
+0000f5f0: 2020 2072 6574 7572 6e20 5472 7565 0a0a     return True..
+0000f600: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000f610: 656c 662e 5f65 7865 6375 7465 2872 6571  elf._execute(req
+0000f620: 7565 7374 2c20 7265 7370 6f6e 7365 5f68  uest, response_h
+0000f630: 616e 646c 6572 290a 0a20 2020 2064 6566  andler)..    def
+0000f640: 206c 6f61 645f 696e 6465 7865 7328 7365   load_indexes(se
+0000f650: 6c66 2920 2d3e 2052 6573 756c 745b 626f  lf) -> Result[bo
+0000f660: 6f6c 5d3a 0a20 2020 2020 2020 2022 2222  ol]:.        """
+0000f670: 4361 6368 6520 616c 6c20 696e 6465 7865  Cache all indexe
+0000f680: 7320 696e 2074 6865 2063 6f6c 6c65 6374  s in the collect
+0000f690: 696f 6e20 696e 746f 206d 656d 6f72 792e  ion into memory.
+0000f6a0: 0a0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
+0000f6b0: 6e3a 2054 7275 6520 6966 2069 6e64 6578  n: True if index
+0000f6c0: 2077 6173 206c 6f61 6465 6420 7375 6363   was loaded succ
+0000f6d0: 6573 7366 756c 6c79 2e0a 2020 2020 2020  essfully..      
+0000f6e0: 2020 3a72 7479 7065 3a20 626f 6f6c 0a20    :rtype: bool. 
+0000f6f0: 2020 2020 2020 203a 7261 6973 6520 6172         :raise ar
+0000f700: 616e 676f 2e65 7863 6570 7469 6f6e 732e  ango.exceptions.
+0000f710: 496e 6465 784c 6f61 6445 7272 6f72 3a20  IndexLoadError: 
+0000f720: 4966 206f 7065 7261 7469 6f6e 2066 6169  If operation fai
+0000f730: 6c73 2e0a 2020 2020 2020 2020 2222 220a  ls..        """.
+0000f740: 2020 2020 2020 2020 7265 7175 6573 7420          request 
+0000f750: 3d20 5265 7175 6573 7428 0a20 2020 2020  = Request(.     
+0000f760: 2020 2020 2020 206d 6574 686f 643d 2270         method="p
+0000f770: 7574 222c 0a20 2020 2020 2020 2020 2020  ut",.           
+0000f780: 2065 6e64 706f 696e 743d 6622 2f5f 6170   endpoint=f"/_ap
+0000f790: 692f 636f 6c6c 6563 7469 6f6e 2f7b 7365  i/collection/{se
+0000f7a0: 6c66 2e6e 616d 657d 2f6c 6f61 6449 6e64  lf.name}/loadInd
+0000f7b0: 6578 6573 496e 746f 4d65 6d6f 7279 222c  exesIntoMemory",
+0000f7c0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0000f7d0: 2020 2020 6465 6620 7265 7370 6f6e 7365      def response
+0000f7e0: 5f68 616e 646c 6572 2872 6573 703a 2052  _handler(resp: R
+0000f7f0: 6573 706f 6e73 6529 202d 3e20 626f 6f6c  esponse) -> bool
+0000f800: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+0000f810: 206e 6f74 2072 6573 702e 6973 5f73 7563   not resp.is_suc
+0000f820: 6365 7373 3a0a 2020 2020 2020 2020 2020  cess:.          
+0000f830: 2020 2020 2020 7261 6973 6520 496e 6465        raise Inde
+0000f840: 784c 6f61 6445 7272 6f72 2872 6573 702c  xLoadError(resp,
+0000f850: 2072 6571 7565 7374 290a 2020 2020 2020   request).      
+0000f860: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
+0000f870: 650a 0a20 2020 2020 2020 2072 6574 7572  e..        retur
+0000f880: 6e20 7365 6c66 2e5f 6578 6563 7574 6528  n self._execute(
+0000f890: 7265 7175 6573 742c 2072 6573 706f 6e73  request, respons
+0000f8a0: 655f 6861 6e64 6c65 7229 0a0a 2020 2020  e_handler)..    
+0000f8b0: 6465 6620 696e 7365 7274 5f6d 616e 7928  def insert_many(
+0000f8c0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+0000f8d0: 2020 2020 2020 2064 6f63 756d 656e 7473         documents
+0000f8e0: 3a20 5365 7175 656e 6365 5b4a 736f 6e5d  : Sequence[Json]
+0000f8f0: 2c0a 2020 2020 2020 2020 7265 7475 726e  ,.        return
+0000f900: 5f6e 6577 3a20 626f 6f6c 203d 2046 616c  _new: bool = Fal
+0000f910: 7365 2c0a 2020 2020 2020 2020 7379 6e63  se,.        sync
+0000f920: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
+0000f930: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0000f940: 2073 696c 656e 743a 2062 6f6f 6c20 3d20   silent: bool = 
+0000f950: 4661 6c73 652c 0a20 2020 2020 2020 206f  False,.        o
+0000f960: 7665 7277 7269 7465 3a20 626f 6f6c 203d  verwrite: bool =
+0000f970: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
+0000f980: 7265 7475 726e 5f6f 6c64 3a20 626f 6f6c  return_old: bool
+0000f990: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
+0000f9a0: 2020 6f76 6572 7772 6974 655f 6d6f 6465    overwrite_mode
+0000f9b0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+0000f9c0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+0000f9d0: 6b65 6570 5f6e 6f6e 653a 204f 7074 696f  keep_none: Optio
+0000f9e0: 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65  nal[bool] = None
+0000f9f0: 2c0a 2020 2020 2020 2020 6d65 7267 653a  ,.        merge:
+0000fa00: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
+0000fa10: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+0000fa20: 7265 6669 6c6c 5f69 6e64 6578 5f63 6163  refill_index_cac
+0000fa30: 6865 733a 204f 7074 696f 6e61 6c5b 626f  hes: Optional[bo
+0000fa40: 6f6c 5d20 3d20 4e6f 6e65 2c0a 2020 2020  ol] = None,.    
+0000fa50: 2020 2020 7665 7273 696f 6e5f 6174 7472      version_attr
+0000fa60: 6962 7574 653a 204f 7074 696f 6e61 6c5b  ibute: Optional[
+0000fa70: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+0000fa80: 2029 202d 3e20 5265 7375 6c74 5b55 6e69   ) -> Result[Uni
+0000fa90: 6f6e 5b62 6f6f 6c2c 204c 6973 745b 556e  on[bool, List[Un
+0000faa0: 696f 6e5b 4a73 6f6e 2c20 4172 616e 676f  ion[Json, Arango
+0000fab0: 5365 7276 6572 4572 726f 725d 5d5d 5d3a  ServerError]]]]:
+0000fac0: 0a20 2020 2020 2020 2022 2222 496e 7365  .        """Inse
+0000fad0: 7274 206d 756c 7469 706c 6520 646f 6375  rt multiple docu
+0000fae0: 6d65 6e74 732e 0a0a 2020 2020 2020 2020  ments...        
+0000faf0: 2e2e 206e 6f74 653a 3a0a 0a20 2020 2020  .. note::..     
+0000fb00: 2020 2020 2020 2049 6620 696e 7365 7274         If insert
+0000fb10: 696e 6720 6120 646f 6375 6d65 6e74 2066  ing a document f
+0000fb20: 6169 6c73 2c20 7468 6520 6578 6365 7074  ails, the except
+0000fb30: 696f 6e20 6973 206e 6f74 2072 6169 7365  ion is not raise
+0000fb40: 6420 6275 740a 2020 2020 2020 2020 2020  d but.          
+0000fb50: 2020 7265 7475 726e 6564 2061 7320 616e    returned as an
+0000fb60: 206f 626a 6563 7420 696e 2074 6865 2072   object in the r
+0000fb70: 6573 756c 7420 6c69 7374 2e20 4974 2069  esult list. It i
+0000fb80: 7320 7570 2074 6f20 796f 7520 746f 0a20  s up to you to. 
+0000fb90: 2020 2020 2020 2020 2020 2069 6e73 7065             inspe
+0000fba0: 6374 2074 6865 206c 6973 7420 746f 2064  ct the list to d
+0000fbb0: 6574 6572 6d69 6e65 2077 6869 6368 2064  etermine which d
+0000fbc0: 6f63 756d 656e 7473 2077 6572 6520 696e  ocuments were in
+0000fbd0: 7365 7274 6564 0a20 2020 2020 2020 2020  serted.         
+0000fbe0: 2020 2073 7563 6365 7373 6675 6c6c 7920     successfully 
+0000fbf0: 2872 6574 7572 6e73 2064 6f63 756d 656e  (returns documen
+0000fc00: 7420 6d65 7461 6461 7461 2920 616e 6420  t metadata) and 
+0000fc10: 7768 6963 6820 7765 7265 206e 6f74 0a20  which were not. 
+0000fc20: 2020 2020 2020 2020 2020 2028 7265 7475             (retu
+0000fc30: 726e 7320 6578 6365 7074 696f 6e20 6f62  rns exception ob
+0000fc40: 6a65 6374 292e 0a0a 2020 2020 2020 2020  ject)...        
+0000fc50: 2e2e 206e 6f74 653a 3a0a 0a20 2020 2020  .. note::..     
+0000fc60: 2020 2020 2020 2049 6e20 6564 6765 2f76         In edge/v
+0000fc70: 6572 7465 7820 636f 6c6c 6563 7469 6f6e  ertex collection
+0000fc80: 732c 2074 6869 7320 6d65 7468 6f64 2064  s, this method d
+0000fc90: 6f65 7320 4e4f 5420 7072 6f76 6964 6520  oes NOT provide 
+0000fca0: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
+0000fcb0: 7472 616e 7361 6374 696f 6e61 6c20 6775  transactional gu
+0000fcc0: 6172 616e 7465 6573 2061 6e64 2076 616c  arantees and val
+0000fcd0: 6964 6174 696f 6e73 2074 6861 7420 7369  idations that si
+0000fce0: 6e67 6c65 2069 6e73 6572 740a 2020 2020  ngle insert.    
+0000fcf0: 2020 2020 2020 2020 6f70 6572 6174 696f          operatio
+0000fd00: 6e20 646f 6573 2066 6f72 2067 7261 7068  n does for graph
+0000fd10: 732e 2049 6620 7468 6573 6520 7072 6f70  s. If these prop
+0000fd20: 6572 7469 6573 2061 7265 2072 6571 7569  erties are requi
+0000fd30: 7265 642c 2073 6565 0a20 2020 2020 2020  red, see.       
+0000fd40: 2020 2020 203a 6675 6e63 3a60 6172 616e       :func:`aran
+0000fd50: 676f 2e64 6174 6162 6173 652e 5374 616e  go.database.Stan
+0000fd60: 6461 7264 4461 7461 6261 7365 2e62 6567  dardDatabase.beg
+0000fd70: 696e 5f62 6174 6368 5f65 7865 6375 7469  in_batch_executi
+0000fd80: 6f6e 600a 2020 2020 2020 2020 2020 2020  on`.            
+0000fd90: 666f 7220 616e 2061 6c74 6572 6e61 7469  for an alternati
+0000fda0: 7665 2061 7070 726f 6163 682e 0a0a 2020  ve approach...  
+0000fdb0: 2020 2020 2020 3a70 6172 616d 2064 6f63        :param doc
+0000fdc0: 756d 656e 7473 3a20 4c69 7374 206f 6620  uments: List of 
+0000fdd0: 6e65 7720 646f 6375 6d65 6e74 7320 746f  new documents to
+0000fde0: 2069 6e73 6572 742e 2049 6620 7468 6579   insert. If they
+0000fdf0: 2063 6f6e 7461 696e 2074 6865 0a20 2020   contain the.   
+0000fe00: 2020 2020 2020 2020 2022 5f6b 6579 2220           "_key" 
+0000fe10: 6f72 2022 5f69 6422 2066 6965 6c64 732c  or "_id" fields,
+0000fe20: 2074 6865 2076 616c 7565 7320 6172 6520   the values are 
+0000fe30: 7573 6564 2061 7320 7468 6520 6b65 7973  used as the keys
+0000fe40: 206f 6620 7468 6520 6e65 770a 2020 2020   of the new.    
+0000fe50: 2020 2020 2020 2020 646f 6375 6d65 6e74          document
+0000fe60: 7320 2861 7574 6f2d 6765 6e65 7261 7465  s (auto-generate
+0000fe70: 6420 6f74 6865 7277 6973 6529 2e20 416e  d otherwise). An
+0000fe80: 7920 225f 7265 7622 2066 6965 6c64 2069  y "_rev" field i
+0000fe90: 7320 6967 6e6f 7265 642e 0a20 2020 2020  s ignored..     
+0000fea0: 2020 203a 7479 7065 2064 6f63 756d 656e     :type documen
+0000feb0: 7473 3a20 5b64 6963 745d 0a20 2020 2020  ts: [dict].     
+0000fec0: 2020 203a 7061 7261 6d20 7265 7475 726e     :param return
+0000fed0: 5f6e 6577 3a20 496e 636c 7564 6520 626f  _new: Include bo
+0000fee0: 6469 6573 206f 6620 7468 6520 6e65 7720  dies of the new 
+0000fef0: 646f 6375 6d65 6e74 7320 696e 2074 6865  documents in the
+0000ff00: 2072 6574 7572 6e65 640a 2020 2020 2020   returned.      
+0000ff10: 2020 2020 2020 6d65 7461 6461 7461 2e20        metadata. 
+0000ff20: 4967 6e6f 7265 6420 6966 2070 6172 616d  Ignored if param
+0000ff30: 6574 6572 202a 2a73 696c 656e 742a 2a20  eter **silent** 
+0000ff40: 6973 2073 6574 2074 6f20 5472 7565 0a20  is set to True. 
+0000ff50: 2020 2020 2020 203a 7479 7065 2072 6574         :type ret
+0000ff60: 7572 6e5f 6e65 773a 2062 6f6f 6c0a 2020  urn_new: bool.  
+0000ff70: 2020 2020 2020 3a70 6172 616d 2073 796e        :param syn
+0000ff80: 633a 2042 6c6f 636b 2075 6e74 696c 206f  c: Block until o
+0000ff90: 7065 7261 7469 6f6e 2069 7320 7379 6e63  peration is sync
+0000ffa0: 6872 6f6e 697a 6564 2074 6f20 6469 736b  hronized to disk
+0000ffb0: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
+0000ffc0: 7379 6e63 3a20 626f 6f6c 207c 204e 6f6e  sync: bool | Non
+0000ffd0: 650a 2020 2020 2020 2020 3a70 6172 616d  e.        :param
+0000ffe0: 2073 696c 656e 743a 2049 6620 7365 7420   silent: If set 
+0000fff0: 746f 2054 7275 652c 206e 6f20 646f 6375  to True, no docu
+00010000: 6d65 6e74 206d 6574 6164 6174 6120 6973  ment metadata is
+00010010: 2072 6574 7572 6e65 642e 2054 6869 730a   returned. This.
+00010020: 2020 2020 2020 2020 2020 2020 6361 6e20              can 
+00010030: 6265 2075 7365 6420 746f 2073 6176 6520  be used to save 
+00010040: 7265 736f 7572 6365 732e 0a20 2020 2020  resources..     
+00010050: 2020 203a 7479 7065 2073 696c 656e 743a     :type silent:
+00010060: 2062 6f6f 6c0a 2020 2020 2020 2020 3a70   bool.        :p
+00010070: 6172 616d 206f 7665 7277 7269 7465 3a20  aram overwrite: 
+00010080: 4966 2073 6574 2074 6f20 5472 7565 2c20  If set to True, 
+00010090: 6f70 6572 6174 696f 6e20 646f 6573 206e  operation does n
+000100a0: 6f74 2066 6169 6c20 6f6e 2064 7570 6c69  ot fail on dupli
+000100b0: 6361 7465 0a20 2020 2020 2020 2020 2020  cate.           
+000100c0: 206b 6579 7320 616e 6420 7468 6520 6578   keys and the ex
+000100d0: 6973 7469 6e67 2064 6f63 756d 656e 7473  isting documents
+000100e0: 2061 7265 2072 6570 6c61 6365 642e 0a20   are replaced.. 
+000100f0: 2020 2020 2020 203a 7479 7065 206f 7665         :type ove
+00010100: 7277 7269 7465 3a20 626f 6f6c 0a20 2020  rwrite: bool.   
+00010110: 2020 2020 203a 7061 7261 6d20 7265 7475       :param retu
+00010120: 726e 5f6f 6c64 3a20 496e 636c 7564 6520  rn_old: Include 
+00010130: 626f 6479 206f 6620 7468 6520 6f6c 6420  body of the old 
+00010140: 646f 6375 6d65 6e74 7320 6966 2072 6570  documents if rep
+00010150: 6c61 6365 642e 0a20 2020 2020 2020 2020  laced..         
+00010160: 2020 2041 7070 6c69 6573 206f 6e6c 7920     Applies only 
+00010170: 7768 656e 2076 616c 7565 206f 6620 2a2a  when value of **
+00010180: 6f76 6572 7772 6974 652a 2a20 6973 2073  overwrite** is s
+00010190: 6574 2074 6f20 5472 7565 2e0a 2020 2020  et to True..    
+000101a0: 2020 2020 3a74 7970 6520 7265 7475 726e      :type return
+000101b0: 5f6f 6c64 3a20 626f 6f6c 0a20 2020 2020  _old: bool.     
+000101c0: 2020 203a 7061 7261 6d20 6f76 6572 7772     :param overwr
+000101d0: 6974 655f 6d6f 6465 3a20 4f76 6572 7772  ite_mode: Overwr
+000101e0: 6974 6520 6265 6861 7669 6f72 2075 7365  ite behavior use
+000101f0: 6420 7768 656e 2074 6865 2064 6f63 756d  d when the docum
+00010200: 656e 7420 6b65 790a 2020 2020 2020 2020  ent key.        
+00010210: 2020 2020 6578 6973 7473 2061 6c72 6561      exists alrea
+00010220: 6479 2e20 416c 6c6f 7765 6420 7661 6c75  dy. Allowed valu
+00010230: 6573 2061 7265 2022 7265 706c 6163 6522  es are "replace"
+00010240: 2028 7265 706c 6163 652d 696e 7365 7274   (replace-insert
+00010250: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
+00010260: 7570 6461 7465 2220 2875 7064 6174 652d  update" (update-
+00010270: 696e 7365 7274 292c 2022 6967 6e6f 7265  insert), "ignore
+00010280: 2220 6f72 2022 636f 6e66 6c69 6374 222e  " or "conflict".
+00010290: 0a20 2020 2020 2020 2020 2020 2049 6d70  .            Imp
+000102a0: 6c69 6369 746c 7920 7365 7473 2074 6865  licitly sets the
+000102b0: 2076 616c 7565 206f 6620 7061 7261 6d65   value of parame
+000102c0: 7465 7220 2a2a 6f76 6572 7772 6974 652a  ter **overwrite*
+000102d0: 2a2e 0a20 2020 2020 2020 203a 7479 7065  *..        :type
+000102e0: 206f 7665 7277 7269 7465 5f6d 6f64 653a   overwrite_mode:
+000102f0: 2073 7472 207c 204e 6f6e 650a 2020 2020   str | None.    
+00010300: 2020 2020 3a70 6172 616d 206b 6565 705f      :param keep_
+00010310: 6e6f 6e65 3a20 4966 2073 6574 2074 6f20  none: If set to 
+00010320: 5472 7565 2c20 6669 656c 6473 2077 6974  True, fields wit
+00010330: 6820 7661 6c75 6520 4e6f 6e65 2061 7265  h value None are
+00010340: 2072 6574 6169 6e65 640a 2020 2020 2020   retained.      
+00010350: 2020 2020 2020 696e 2074 6865 2064 6f63        in the doc
+00010360: 756d 656e 742e 204f 7468 6572 7769 7365  ument. Otherwise
+00010370: 2c20 7468 6579 2061 7265 2072 656d 6f76  , they are remov
+00010380: 6564 2063 6f6d 706c 6574 656c 792e 2041  ed completely. A
+00010390: 7070 6c69 6573 0a20 2020 2020 2020 2020  pplies.         
+000103a0: 2020 206f 6e6c 7920 7768 656e 202a 2a6f     only when **o
+000103b0: 7665 7277 7269 7465 5f6d 6f64 652a 2a20  verwrite_mode** 
+000103c0: 6973 2073 6574 2074 6f20 2275 7064 6174  is set to "updat
+000103d0: 6522 2028 7570 6461 7465 2d69 6e73 6572  e" (update-inser
+000103e0: 7429 2e0a 2020 2020 2020 2020 3a74 7970  t)..        :typ
+000103f0: 6520 6b65 6570 5f6e 6f6e 653a 2062 6f6f  e keep_none: boo
+00010400: 6c20 7c20 4e6f 6e65 0a20 2020 2020 2020  l | None.       
+00010410: 203a 7061 7261 6d20 6d65 7267 653a 2049   :param merge: I
+00010420: 6620 7365 7420 746f 2054 7275 6520 2864  f set to True (d
+00010430: 6566 6175 6c74 292c 2073 7562 2d64 6963  efault), sub-dic
+00010440: 7469 6f6e 6172 6965 7320 6172 6520 6d65  tionaries are me
+00010450: 7267 6564 0a20 2020 2020 2020 2020 2020  rged.           
+00010460: 2069 6e73 7465 6164 206f 6620 7468 6520   instead of the 
+00010470: 6e65 7720 6f6e 6520 6f76 6572 7772 6974  new one overwrit
+00010480: 696e 6720 7468 6520 6f6c 6420 6f6e 652e  ing the old one.
+00010490: 2041 7070 6c69 6573 206f 6e6c 7920 7768   Applies only wh
+000104a0: 656e 0a20 2020 2020 2020 2020 2020 202a  en.            *
+000104b0: 2a6f 7665 7277 7269 7465 5f6d 6f64 652a  *overwrite_mode*
+000104c0: 2a20 6973 2073 6574 2074 6f20 2275 7064  * is set to "upd
+000104d0: 6174 6522 2028 7570 6461 7465 2d69 6e73  ate" (update-ins
+000104e0: 6572 7429 2e0a 2020 2020 2020 2020 3a74  ert)..        :t
+000104f0: 7970 6520 6d65 7267 653a 2062 6f6f 6c20  ype merge: bool 
+00010500: 7c20 4e6f 6e65 0a20 2020 2020 2020 203a  | None.        :
+00010510: 7061 7261 6d20 7265 6669 6c6c 5f69 6e64  param refill_ind
+00010520: 6578 5f63 6163 6865 733a 2057 6865 7468  ex_caches: Wheth
+00010530: 6572 2074 6f20 6164 6420 6e65 7720 656e  er to add new en
+00010540: 7472 6965 7320 746f 2069 6e2d 6d65 6d6f  tries to in-memo
+00010550: 7279 0a20 2020 2020 2020 2020 2020 2069  ry.            i
+00010560: 6e64 6578 2063 6163 6865 7320 6966 2064  ndex caches if d
+00010570: 6f63 756d 656e 7420 696e 7365 7274 696f  ocument insertio
+00010580: 6e73 2061 6666 6563 7420 7468 6520 6564  ns affect the ed
+00010590: 6765 2069 6e64 6578 206f 720a 2020 2020  ge index or.    
+000105a0: 2020 2020 2020 2020 6361 6368 652d 656e          cache-en
+000105b0: 6162 6c65 6420 7065 7273 6973 7465 6e74  abled persistent
+000105c0: 2069 6e64 6578 6573 2e0a 2020 2020 2020   indexes..      
+000105d0: 2020 3a74 7970 6520 7265 6669 6c6c 5f69    :type refill_i
+000105e0: 6e64 6578 5f63 6163 6865 733a 2062 6f6f  ndex_caches: boo
+000105f0: 6c20 7c20 4e6f 6e65 0a20 2020 2020 2020  l | None.       
+00010600: 203a 7061 7261 6d20 7665 7273 696f 6e5f   :param version_
+00010610: 6174 7472 6962 7574 653a 2073 7570 706f  attribute: suppo
+00010620: 7274 2066 6f72 2073 696d 706c 6520 6578  rt for simple ex
+00010630: 7465 726e 616c 2076 6572 7369 6f6e 696e  ternal versionin
+00010640: 6720 746f 0a20 2020 2020 2020 2020 2020  g to.           
+00010650: 2064 6f63 756d 656e 7420 6f70 6572 6174   document operat
+00010660: 696f 6e73 2e0a 2020 2020 2020 2020 3a74  ions..        :t
+00010670: 7970 6520 7665 7273 696f 6e5f 6174 7472  ype version_attr
+00010680: 6962 7574 653a 2073 7472 0a20 2020 2020  ibute: str.     
+00010690: 2020 203a 7265 7475 726e 3a20 4c69 7374     :return: List
+000106a0: 206f 6620 646f 6375 6d65 6e74 206d 6574   of document met
+000106b0: 6164 6174 6120 2865 2e67 2e20 646f 6375  adata (e.g. docu
+000106c0: 6d65 6e74 206b 6579 732c 2072 6576 6973  ment keys, revis
+000106d0: 696f 6e73 2920 616e 640a 2020 2020 2020  ions) and.      
+000106e0: 2020 2020 2020 616e 7920 6578 6365 7074        any except
+000106f0: 696f 6e2c 206f 7220 5472 7565 2069 6620  ion, or True if 
+00010700: 7061 7261 6d65 7465 7220 2a2a 7369 6c65  parameter **sile
+00010710: 6e74 2a2a 2077 6173 2073 6574 2074 6f20  nt** was set to 
+00010720: 5472 7565 2e0a 2020 2020 2020 2020 3a72  True..        :r
+00010730: 7479 7065 3a20 5b64 6963 7420 7c20 4172  type: [dict | Ar
+00010740: 616e 676f 5365 7276 6572 4572 726f 725d  angoServerError]
+00010750: 207c 2062 6f6f 6c0a 2020 2020 2020 2020   | bool.        
+00010760: 3a72 6169 7365 2061 7261 6e67 6f2e 6578  :raise arango.ex
+00010770: 6365 7074 696f 6e73 2e44 6f63 756d 656e  ceptions.Documen
+00010780: 7449 6e73 6572 7445 7272 6f72 3a20 4966  tInsertError: If
+00010790: 2069 6e73 6572 7420 6661 696c 732e 0a20   insert fails.. 
+000107a0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000107b0: 2020 2064 6f63 756d 656e 7473 203d 205b     documents = [
+000107c0: 7365 6c66 2e5f 656e 7375 7265 5f6b 6579  self._ensure_key
+000107d0: 5f66 726f 6d5f 6964 2864 6f63 2920 666f  _from_id(doc) fo
+000107e0: 7220 646f 6320 696e 2064 6f63 756d 656e  r doc in documen
+000107f0: 7473 5d0a 0a20 2020 2020 2020 2070 6172  ts]..        par
+00010800: 616d 733a 2050 6172 616d 7320 3d20 7b0a  ams: Params = {.
+00010810: 2020 2020 2020 2020 2020 2020 2272 6574              "ret
+00010820: 7572 6e4e 6577 223a 2072 6574 7572 6e5f  urnNew": return_
+00010830: 6e65 772c 0a20 2020 2020 2020 2020 2020  new,.           
+00010840: 2022 7369 6c65 6e74 223a 2073 696c 656e   "silent": silen
+00010850: 742c 0a20 2020 2020 2020 2020 2020 2022  t,.            "
+00010860: 6f76 6572 7772 6974 6522 3a20 6f76 6572  overwrite": over
+00010870: 7772 6974 652c 0a20 2020 2020 2020 2020  write,.         
+00010880: 2020 2022 7265 7475 726e 4f6c 6422 3a20     "returnOld": 
+00010890: 7265 7475 726e 5f6f 6c64 2c0a 2020 2020  return_old,.    
+000108a0: 2020 2020 7d0a 2020 2020 2020 2020 6966      }.        if
+000108b0: 2073 796e 6320 6973 206e 6f74 204e 6f6e   sync is not Non
+000108c0: 653a 0a20 2020 2020 2020 2020 2020 2070  e:.            p
+000108d0: 6172 616d 735b 2277 6169 7446 6f72 5379  arams["waitForSy
+000108e0: 6e63 225d 203d 2073 796e 630a 0a20 2020  nc"] = sync..   
+000108f0: 2020 2020 2069 6620 6f76 6572 7772 6974       if overwrit
+00010900: 655f 6d6f 6465 2069 7320 6e6f 7420 4e6f  e_mode is not No
+00010910: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00010920: 7061 7261 6d73 5b22 6f76 6572 7772 6974  params["overwrit
+00010930: 654d 6f64 6522 5d20 3d20 6f76 6572 7772  eMode"] = overwr
+00010940: 6974 655f 6d6f 6465 0a20 2020 2020 2020  ite_mode.       
+00010950: 2069 6620 6b65 6570 5f6e 6f6e 6520 6973   if keep_none is
+00010960: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00010970: 2020 2020 2020 2070 6172 616d 735b 226b         params["k
+00010980: 6565 704e 756c 6c22 5d20 3d20 6b65 6570  eepNull"] = keep
+00010990: 5f6e 6f6e 650a 2020 2020 2020 2020 6966  _none.        if
+000109a0: 206d 6572 6765 2069 7320 6e6f 7420 4e6f   merge is not No
+000109b0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+000109c0: 7061 7261 6d73 5b22 6d65 7267 654f 626a  params["mergeObj
+000109d0: 6563 7473 225d 203d 206d 6572 6765 0a20  ects"] = merge. 
+000109e0: 2020 2020 2020 2069 6620 7665 7273 696f         if versio
+000109f0: 6e5f 6174 7472 6962 7574 6520 6973 206e  n_attribute is n
+00010a00: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+00010a10: 2020 2020 2070 6172 616d 735b 2276 6572       params["ver
+00010a20: 7369 6f6e 4174 7472 6962 7574 6522 5d20  sionAttribute"] 
+00010a30: 3d20 7665 7273 696f 6e5f 6174 7472 6962  = version_attrib
+00010a40: 7574 650a 0a20 2020 2020 2020 2023 204e  ute..        # N
+00010a50: 6577 2069 6e20 4172 616e 676f 4442 2033  ew in ArangoDB 3
+00010a60: 2e39 2e36 2061 6e64 2033 2e31 302e 320a  .9.6 and 3.10.2.
+00010a70: 2020 2020 2020 2020 6966 2072 6566 696c          if refil
+00010a80: 6c5f 696e 6465 785f 6361 6368 6573 2069  l_index_caches i
+00010a90: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00010aa0: 2020 2020 2020 2020 7061 7261 6d73 5b22          params["
+00010ab0: 7265 6669 6c6c 496e 6465 7843 6163 6865  refillIndexCache
+00010ac0: 7322 5d20 3d20 7265 6669 6c6c 5f69 6e64  s"] = refill_ind
+00010ad0: 6578 5f63 6163 6865 730a 0a20 2020 2020  ex_caches..     
+00010ae0: 2020 2072 6571 7565 7374 203d 2052 6571     request = Req
+00010af0: 7565 7374 280a 2020 2020 2020 2020 2020  uest(.          
+00010b00: 2020 6d65 7468 6f64 3d22 706f 7374 222c    method="post",
+00010b10: 0a20 2020 2020 2020 2020 2020 2065 6e64  .            end
+00010b20: 706f 696e 743d 6622 2f5f 6170 692f 646f  point=f"/_api/do
+00010b30: 6375 6d65 6e74 2f7b 7365 6c66 2e6e 616d  cument/{self.nam
+00010b40: 657d 222c 0a20 2020 2020 2020 2020 2020  e}",.           
+00010b50: 2064 6174 613d 646f 6375 6d65 6e74 732c   data=documents,
+00010b60: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
+00010b70: 616d 733d 7061 7261 6d73 2c0a 2020 2020  ams=params,.    
+00010b80: 2020 2020 290a 0a20 2020 2020 2020 2064      )..        d
+00010b90: 6566 2072 6573 706f 6e73 655f 6861 6e64  ef response_hand
+00010ba0: 6c65 7228 0a20 2020 2020 2020 2020 2020  ler(.           
+00010bb0: 2072 6573 703a 2052 6573 706f 6e73 652c   resp: Response,
+00010bc0: 0a20 2020 2020 2020 2029 202d 3e20 556e  .        ) -> Un
+00010bd0: 696f 6e5b 626f 6f6c 2c20 4c69 7374 5b55  ion[bool, List[U
+00010be0: 6e69 6f6e 5b4a 736f 6e2c 2041 7261 6e67  nion[Json, Arang
+00010bf0: 6f53 6572 7665 7245 7272 6f72 5d5d 5d3a  oServerError]]]:
+00010c00: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00010c10: 6e6f 7420 7265 7370 2e69 735f 7375 6363  not resp.is_succ
+00010c20: 6573 733a 0a20 2020 2020 2020 2020 2020  ess:.           
+00010c30: 2020 2020 2072 6169 7365 2044 6f63 756d       raise Docum
+00010c40: 656e 7449 6e73 6572 7445 7272 6f72 2872  entInsertError(r
+00010c50: 6573 702c 2072 6571 7565 7374 290a 2020  esp, request).  
+00010c60: 2020 2020 2020 2020 2020 6966 2073 696c            if sil
+00010c70: 656e 7420 6973 2054 7275 653a 0a20 2020  ent is True:.   
+00010c80: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00010c90: 7572 6e20 5472 7565 0a0a 2020 2020 2020  urn True..      
+00010ca0: 2020 2020 2020 7265 7375 6c74 733a 204c        results: L
+00010cb0: 6973 745b 556e 696f 6e5b 4a73 6f6e 2c20  ist[Union[Json, 
+00010cc0: 4172 616e 676f 5365 7276 6572 4572 726f  ArangoServerErro
+00010cd0: 725d 5d20 3d20 5b5d 0a20 2020 2020 2020  r]] = [].       
+00010ce0: 2020 2020 2066 6f72 2062 6f64 7920 696e       for body in
+00010cf0: 2072 6573 702e 626f 6479 3a0a 2020 2020   resp.body:.    
+00010d00: 2020 2020 2020 2020 2020 2020 6966 2022              if "
+00010d10: 5f69 6422 2069 6e20 626f 6479 3a0a 2020  _id" in body:.  
+00010d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010d30: 2020 6966 2022 5f6f 6c64 5265 7622 2069    if "_oldRev" i
+00010d40: 6e20 626f 6479 3a0a 2020 2020 2020 2020  n body:.        
+00010d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010d60: 626f 6479 5b22 5f6f 6c64 5f72 6576 225d  body["_old_rev"]
+00010d70: 203d 2062 6f64 792e 706f 7028 225f 6f6c   = body.pop("_ol
+00010d80: 6452 6576 2229 0a20 2020 2020 2020 2020  dRev").         
+00010d90: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00010da0: 7473 2e61 7070 656e 6428 626f 6479 290a  ts.append(body).
+00010db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010dc0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00010dd0: 2020 2020 2020 2020 2020 7375 625f 7265            sub_re
+00010de0: 7370 203d 2073 656c 662e 5f63 6f6e 6e2e  sp = self._conn.
+00010df0: 7072 6570 5f62 756c 6b5f 6572 725f 7265  prep_bulk_err_re
+00010e00: 7370 6f6e 7365 2872 6573 702c 2062 6f64  sponse(resp, bod
+00010e10: 7929 0a20 2020 2020 2020 2020 2020 2020  y).             
+00010e20: 2020 2020 2020 2072 6573 756c 7473 2e61         results.a
+00010e30: 7070 656e 6428 446f 6375 6d65 6e74 496e  ppend(DocumentIn
+00010e40: 7365 7274 4572 726f 7228 7375 625f 7265  sertError(sub_re
+00010e50: 7370 2c20 7265 7175 6573 7429 290a 0a20  sp, request)).. 
+00010e60: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00010e70: 6e20 7265 7375 6c74 730a 0a20 2020 2020  n results..     
+00010e80: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00010e90: 6578 6563 7574 6528 7265 7175 6573 742c  execute(request,
+00010ea0: 2072 6573 706f 6e73 655f 6861 6e64 6c65   response_handle
+00010eb0: 7229 0a0a 2020 2020 6465 6620 7570 6461  r)..    def upda
+00010ec0: 7465 5f6d 616e 7928 0a20 2020 2020 2020  te_many(.       
+00010ed0: 2073 656c 662c 0a20 2020 2020 2020 2064   self,.        d
+00010ee0: 6f63 756d 656e 7473 3a20 5365 7175 656e  ocuments: Sequen
+00010ef0: 6365 5b4a 736f 6e5d 2c0a 2020 2020 2020  ce[Json],.      
+00010f00: 2020 6368 6563 6b5f 7265 763a 2062 6f6f    check_rev: boo
+00010f10: 6c20 3d20 5472 7565 2c0a 2020 2020 2020  l = True,.      
+00010f20: 2020 6d65 7267 653a 2062 6f6f 6c20 3d20    merge: bool = 
+00010f30: 5472 7565 2c0a 2020 2020 2020 2020 6b65  True,.        ke
+00010f40: 6570 5f6e 6f6e 653a 2062 6f6f 6c20 3d20  ep_none: bool = 
+00010f50: 5472 7565 2c0a 2020 2020 2020 2020 7265  True,.        re
+00010f60: 7475 726e 5f6e 6577 3a20 626f 6f6c 203d  turn_new: bool =
+00010f70: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
+00010f80: 7265 7475 726e 5f6f 6c64 3a20 626f 6f6c  return_old: bool
+00010f90: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
+00010fa0: 2020 7379 6e63 3a20 4f70 7469 6f6e 616c    sync: Optional
+00010fb0: 5b62 6f6f 6c5d 203d 204e 6f6e 652c 0a20  [bool] = None,. 
+00010fc0: 2020 2020 2020 2073 696c 656e 743a 2062         silent: b
+00010fd0: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
+00010fe0: 2020 2020 2072 6566 696c 6c5f 696e 6465       refill_inde
+00010ff0: 785f 6361 6368 6573 3a20 4f70 7469 6f6e  x_caches: Option
+00011000: 616c 5b62 6f6f 6c5d 203d 204e 6f6e 652c  al[bool] = None,
+00011010: 0a20 2020 2020 2020 2072 6169 7365 5f6f  .        raise_o
+00011020: 6e5f 646f 6375 6d65 6e74 5f65 7272 6f72  n_document_error
+00011030: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
+00011040: 2020 2020 2020 2020 7665 7273 696f 6e5f          version_
+00011050: 6174 7472 6962 7574 653a 204f 7074 696f  attribute: Optio
+00011060: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
+00011070: 0a20 2020 2029 202d 3e20 5265 7375 6c74  .    ) -> Result
+00011080: 5b55 6e69 6f6e 5b62 6f6f 6c2c 204c 6973  [Union[bool, Lis
+00011090: 745b 556e 696f 6e5b 4a73 6f6e 2c20 4172  t[Union[Json, Ar
+000110a0: 616e 676f 5365 7276 6572 4572 726f 725d  angoServerError]
+000110b0: 5d5d 5d3a 0a20 2020 2020 2020 2022 2222  ]]]:.        """
+000110c0: 5570 6461 7465 206d 756c 7469 706c 6520  Update multiple 
+000110d0: 646f 6375 6d65 6e74 732e 0a0a 2020 2020  documents...    
+000110e0: 2020 2020 2e2e 206e 6f74 653a 3a0a 0a20      .. note::.. 
+000110f0: 2020 2020 2020 2020 2020 2049 6620 7570             If up
+00011100: 6461 7469 6e67 2061 2064 6f63 756d 656e  dating a documen
+00011110: 7420 6661 696c 732c 2074 6865 2065 7863  t fails, the exc
+00011120: 6570 7469 6f6e 2069 7320 6e6f 7420 7261  eption is not ra
+00011130: 6973 6564 2062 7574 0a20 2020 2020 2020  ised but.       
+00011140: 2020 2020 2072 6574 7572 6e65 6420 6173       returned as
+00011150: 2061 6e20 6f62 6a65 6374 2069 6e20 7468   an object in th
+00011160: 6520 7265 7375 6c74 206c 6973 742e 2049  e result list. I
+00011170: 7420 6973 2075 7020 746f 2079 6f75 2074  t is up to you t
+00011180: 6f0a 2020 2020 2020 2020 2020 2020 696e  o.            in
+00011190: 7370 6563 7420 7468 6520 6c69 7374 2074  spect the list t
+000111a0: 6f20 6465 7465 726d 696e 6520 7768 6963  o determine whic
+000111b0: 6820 646f 6375 6d65 6e74 7320 7765 7265  h documents were
+000111c0: 2075 7064 6174 6564 0a20 2020 2020 2020   updated.       
+000111d0: 2020 2020 2073 7563 6365 7373 6675 6c6c       successfull
+000111e0: 7920 2872 6574 7572 6e73 2064 6f63 756d  y (returns docum
+000111f0: 656e 7420 6d65 7461 6461 7461 2920 616e  ent metadata) an
+00011200: 6420 7768 6963 6820 7765 7265 206e 6f74  d which were not
+00011210: 0a20 2020 2020 2020 2020 2020 2028 7265  .            (re
+00011220: 7475 726e 7320 6578 6365 7074 696f 6e20  turns exception 
+00011230: 6f62 6a65 6374 292e 2041 6c74 6572 6e61  object). Alterna
+00011240: 7469 7665 6c79 2c20 796f 7520 6361 6e20  tively, you can 
+00011250: 7265 6c79 206f 6e0a 2020 2020 2020 2020  rely on.        
+00011260: 2020 2020 7365 7474 696e 6720 2a2a 7261      setting **ra
+00011270: 6973 655f 6f6e 5f64 6f63 756d 656e 745f  ise_on_document_
+00011280: 6572 726f 722a 2a20 746f 2054 7275 6520  error** to True 
+00011290: 2864 6566 6175 6c74 7320 746f 2046 616c  (defaults to Fal
+000112a0: 7365 292e 0a0a 2020 2020 2020 2020 2e2e  se)...        ..
+000112b0: 206e 6f74 653a 3a0a 0a20 2020 2020 2020   note::..       
+000112c0: 2020 2020 2049 6e20 6564 6765 2f76 6572       In edge/ver
+000112d0: 7465 7820 636f 6c6c 6563 7469 6f6e 732c  tex collections,
+000112e0: 2074 6869 7320 6d65 7468 6f64 2064 6f65   this method doe
+000112f0: 7320 4e4f 5420 7072 6f76 6964 6520 7468  s NOT provide th
+00011300: 650a 2020 2020 2020 2020 2020 2020 7472  e.            tr
+00011310: 616e 7361 6374 696f 6e61 6c20 6775 6172  ansactional guar
+00011320: 616e 7465 6573 2061 6e64 2076 616c 6964  antees and valid
+00011330: 6174 696f 6e73 2074 6861 7420 7369 6e67  ations that sing
+00011340: 6c65 2075 7064 6174 650a 2020 2020 2020  le update.      
+00011350: 2020 2020 2020 6f70 6572 6174 696f 6e20        operation 
+00011360: 646f 6573 2066 6f72 2067 7261 7068 732e  does for graphs.
+00011370: 2049 6620 7468 6573 6520 7072 6f70 6572   If these proper
+00011380: 7469 6573 2061 7265 2072 6571 7569 7265  ties are require
+00011390: 642c 2073 6565 0a20 2020 2020 2020 2020  d, see.         
+000113a0: 2020 203a 6675 6e63 3a60 6172 616e 676f     :func:`arango
+000113b0: 2e64 6174 6162 6173 652e 5374 616e 6461  .database.Standa
+000113c0: 7264 4461 7461 6261 7365 2e62 6567 696e  rdDatabase.begin
+000113d0: 5f62 6174 6368 5f65 7865 6375 7469 6f6e  _batch_execution
+000113e0: 600a 2020 2020 2020 2020 2020 2020 666f  `.            fo
+000113f0: 7220 616e 2061 6c74 6572 6e61 7469 7665  r an alternative
+00011400: 2061 7070 726f 6163 682e 0a0a 2020 2020   approach...    
+00011410: 2020 2020 3a70 6172 616d 2064 6f63 756d      :param docum
+00011420: 656e 7473 3a20 5061 7274 6961 6c20 6f72  ents: Partial or
+00011430: 2066 756c 6c20 646f 6375 6d65 6e74 7320   full documents 
+00011440: 7769 7468 2074 6865 2075 7064 6174 6564  with the updated
+00011450: 2076 616c 7565 732e 0a20 2020 2020 2020   values..       
+00011460: 2020 2020 2054 6865 7920 6d75 7374 2063       They must c
+00011470: 6f6e 7461 696e 2074 6865 2022 5f69 6422  ontain the "_id"
+00011480: 206f 7220 225f 6b65 7922 2066 6965 6c64   or "_key" field
+00011490: 732e 0a20 2020 2020 2020 203a 7479 7065  s..        :type
+000114a0: 2064 6f63 756d 656e 7473 3a20 5b64 6963   documents: [dic
+000114b0: 745d 0a20 2020 2020 2020 203a 7061 7261  t].        :para
+000114c0: 6d20 6368 6563 6b5f 7265 763a 2049 6620  m check_rev: If 
+000114d0: 7365 7420 746f 2054 7275 652c 2072 6576  set to True, rev
+000114e0: 6973 696f 6e73 206f 6620 2a2a 646f 6375  isions of **docu
+000114f0: 6d65 6e74 732a 2a20 2869 6620 6769 7665  ments** (if give
+00011500: 6e29 0a20 2020 2020 2020 2020 2020 2061  n).            a
+00011510: 7265 2063 6f6d 7061 7265 6420 6167 6169  re compared agai
+00011520: 6e73 7420 7468 6520 7265 7669 7369 6f6e  nst the revision
+00011530: 7320 6f66 2074 6172 6765 7420 646f 6375  s of target docu
+00011540: 6d65 6e74 732e 0a20 2020 2020 2020 203a  ments..        :
+00011550: 7479 7065 2063 6865 636b 5f72 6576 3a20  type check_rev: 
+00011560: 626f 6f6c 0a20 2020 2020 2020 203a 7061  bool.        :pa
+00011570: 7261 6d20 6d65 7267 653a 2049 6620 7365  ram merge: If se
+00011580: 7420 746f 2054 7275 652c 2073 7562 2d64  t to True, sub-d
+00011590: 6963 7469 6f6e 6172 6965 7320 6172 6520  ictionaries are 
+000115a0: 6d65 7267 6564 2069 6e73 7465 6164 206f  merged instead o
+000115b0: 660a 2020 2020 2020 2020 2020 2020 7468  f.            th
+000115c0: 6520 6e65 7720 6f6e 6573 206f 7665 7277  e new ones overw
+000115d0: 7269 7469 6e67 2074 6865 206f 6c64 206f  riting the old o
+000115e0: 6e65 732e 0a20 2020 2020 2020 203a 7479  nes..        :ty
+000115f0: 7065 206d 6572 6765 3a20 626f 6f6c 207c  pe merge: bool |
+00011600: 204e 6f6e 650a 2020 2020 2020 2020 3a70   None.        :p
+00011610: 6172 616d 206b 6565 705f 6e6f 6e65 3a20  aram keep_none: 
+00011620: 4966 2073 6574 2074 6f20 5472 7565 2c20  If set to True, 
+00011630: 6669 656c 6473 2077 6974 6820 7661 6c75  fields with valu
+00011640: 6520 4e6f 6e65 2061 7265 2072 6574 6169  e None are retai
+00011650: 6e65 640a 2020 2020 2020 2020 2020 2020  ned.            
+00011660: 696e 2074 6865 2064 6f63 756d 656e 742e  in the document.
+00011670: 204f 7468 6572 7769 7365 2c20 7468 6579   Otherwise, they
+00011680: 2061 7265 2072 656d 6f76 6564 2063 6f6d   are removed com
+00011690: 706c 6574 656c 792e 0a20 2020 2020 2020  pletely..       
+000116a0: 203a 7479 7065 206b 6565 705f 6e6f 6e65   :type keep_none
+000116b0: 3a20 626f 6f6c 207c 204e 6f6e 650a 2020  : bool | None.  
+000116c0: 2020 2020 2020 3a70 6172 616d 2072 6574        :param ret
+000116d0: 7572 6e5f 6e65 773a 2049 6e63 6c75 6465  urn_new: Include
+000116e0: 2062 6f64 7920 6f66 2074 6865 206e 6577   body of the new
+000116f0: 2064 6f63 756d 656e 7420 696e 2074 6865   document in the
+00011700: 2072 6574 7572 6e65 640a 2020 2020 2020   returned.      
+00011710: 2020 2020 2020 6d65 7461 6461 7461 2e20        metadata. 
+00011720: 4967 6e6f 7265 6420 6966 2070 6172 616d  Ignored if param
+00011730: 6574 6572 202a 2a73 696c 656e 742a 2a20  eter **silent** 
+00011740: 6973 2073 6574 2074 6f20 5472 7565 2e0a  is set to True..
+00011750: 2020 2020 2020 2020 3a74 7970 6520 7265          :type re
+00011760: 7475 726e 5f6e 6577 3a20 626f 6f6c 0a20  turn_new: bool. 
+00011770: 2020 2020 2020 203a 7061 7261 6d20 7265         :param re
+00011780: 7475 726e 5f6f 6c64 3a20 496e 636c 7564  turn_old: Includ
+00011790: 6520 626f 6479 206f 6620 7468 6520 6f6c  e body of the ol
+000117a0: 6420 646f 6375 6d65 6e74 2069 6e20 7468  d document in th
+000117b0: 6520 7265 7475 726e 6564 0a20 2020 2020  e returned.     
+000117c0: 2020 2020 2020 206d 6574 6164 6174 612e         metadata.
+000117d0: 2049 676e 6f72 6564 2069 6620 7061 7261   Ignored if para
+000117e0: 6d65 7465 7220 2a2a 7369 6c65 6e74 2a2a  meter **silent**
+000117f0: 2069 7320 7365 7420 746f 2054 7275 652e   is set to True.
+00011800: 0a20 2020 2020 2020 203a 7479 7065 2072  .        :type r
+00011810: 6574 7572 6e5f 6f6c 643a 2062 6f6f 6c0a  eturn_old: bool.
+00011820: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
+00011830: 796e 633a 2042 6c6f 636b 2075 6e74 696c  ync: Block until
+00011840: 206f 7065 7261 7469 6f6e 2069 7320 7379   operation is sy
+00011850: 6e63 6872 6f6e 697a 6564 2074 6f20 6469  nchronized to di
+00011860: 736b 2e0a 2020 2020 2020 2020 3a74 7970  sk..        :typ
+00011870: 6520 7379 6e63 3a20 626f 6f6c 207c 204e  e sync: bool | N
+00011880: 6f6e 650a 2020 2020 2020 2020 3a70 6172  one.        :par
+00011890: 616d 2073 696c 656e 743a 2049 6620 7365  am silent: If se
+000118a0: 7420 746f 2054 7275 652c 206e 6f20 646f  t to True, no do
+000118b0: 6375 6d65 6e74 206d 6574 6164 6174 6120  cument metadata 
+000118c0: 6973 2072 6574 7572 6e65 642e 2054 6869  is returned. Thi
+000118d0: 730a 2020 2020 2020 2020 2020 2020 6361  s.            ca
+000118e0: 6e20 6265 2075 7365 6420 746f 2073 6176  n be used to sav
+000118f0: 6520 7265 736f 7572 6365 732e 0a20 2020  e resources..   
+00011900: 2020 2020 203a 7479 7065 2073 696c 656e       :type silen
+00011910: 743a 2062 6f6f 6c0a 2020 2020 2020 2020  t: bool.        
+00011920: 3a70 6172 616d 2072 6566 696c 6c5f 696e  :param refill_in
+00011930: 6465 785f 6361 6368 6573 3a20 5768 6574  dex_caches: Whet
+00011940: 6865 7220 746f 2061 6464 206e 6577 2065  her to add new e
+00011950: 6e74 7269 6573 2074 6f20 696e 2d6d 656d  ntries to in-mem
+00011960: 6f72 790a 2020 2020 2020 2020 2020 2020  ory.            
+00011970: 696e 6465 7820 6361 6368 6573 2069 6620  index caches if 
+00011980: 646f 6375 6d65 6e74 206f 7065 7261 7469  document operati
+00011990: 6f6e 7320 6166 6665 6374 2074 6865 2065  ons affect the e
+000119a0: 6467 6520 696e 6465 7820 6f72 0a20 2020  dge index or.   
+000119b0: 2020 2020 2020 2020 2063 6163 6865 2d65           cache-e
+000119c0: 6e61 626c 6564 2070 6572 7369 7374 656e  nabled persisten
+000119d0: 7420 696e 6465 7865 732e 0a20 2020 2020  t indexes..     
+000119e0: 2020 203a 7479 7065 2072 6566 696c 6c5f     :type refill_
+000119f0: 696e 6465 785f 6361 6368 6573 3a20 626f  index_caches: bo
+00011a00: 6f6c 207c 204e 6f6e 650a 2020 2020 2020  ol | None.      
+00011a10: 2020 3a70 6172 616d 2072 6169 7365 5f6f    :param raise_o
+00011a20: 6e5f 646f 6375 6d65 6e74 5f65 7272 6f72  n_document_error
+00011a30: 3a20 5768 6574 6865 7220 746f 2072 6169  : Whether to rai
+00011a40: 7365 2069 6620 6120 446f 6375 6d65 6e74  se if a Document
+00011a50: 5265 7669 7369 6f6e 4572 726f 720a 2020  RevisionError.  
+00011a60: 2020 2020 2020 2020 2020 6f72 2061 2044            or a D
+00011a70: 6f63 756d 656e 7455 7064 6174 6545 7272  ocumentUpdateErr
+00011a80: 6f72 2069 7320 656e 636f 756e 7465 7265  or is encountere
+00011a90: 6420 6f6e 2061 6e20 696e 6469 7669 6475  d on an individu
+00011aa0: 616c 2064 6f63 756d 656e 742c 0a20 2020  al document,.   
+00011ab0: 2020 2020 2020 2020 2061 7320 6f70 706f           as oppo
+00011ac0: 7365 6420 746f 2072 6574 7572 6e69 6e67  sed to returning
+00011ad0: 2074 6865 2065 7272 6f72 2061 7320 616e   the error as an
+00011ae0: 206f 626a 6563 7420 696e 2074 6865 2072   object in the r
+00011af0: 6573 756c 7420 6c69 7374 2e0a 2020 2020  esult list..    
+00011b00: 2020 2020 2020 2020 4465 6661 756c 7473          Defaults
+00011b10: 2074 6f20 4661 6c73 652e 0a20 2020 2020   to False..     
+00011b20: 2020 203a 7479 7065 2072 6169 7365 5f6f     :type raise_o
+00011b30: 6e5f 646f 6375 6d65 6e74 5f65 7272 6f72  n_document_error
+00011b40: 3a20 626f 6f6c 0a20 2020 2020 2020 203a  : bool.        :
+00011b50: 7061 7261 6d20 7665 7273 696f 6e5f 6174  param version_at
+00011b60: 7472 6962 7574 653a 2073 7570 706f 7274  tribute: support
+00011b70: 2066 6f72 2073 696d 706c 6520 6578 7465   for simple exte
+00011b80: 726e 616c 2076 6572 7369 6f6e 696e 6720  rnal versioning 
+00011b90: 746f 0a20 2020 2020 2020 2020 2020 2064  to.            d
+00011ba0: 6f63 756d 656e 7420 6f70 6572 6174 696f  ocument operatio
+00011bb0: 6e73 2e0a 2020 2020 2020 2020 3a74 7970  ns..        :typ
+00011bc0: 6520 7665 7273 696f 6e5f 6174 7472 6962  e version_attrib
+00011bd0: 7574 653a 2073 7472 0a20 2020 2020 2020  ute: str.       
+00011be0: 203a 7265 7475 726e 3a20 4c69 7374 206f   :return: List o
+00011bf0: 6620 646f 6375 6d65 6e74 206d 6574 6164  f document metad
+00011c00: 6174 6120 2865 2e67 2e20 646f 6375 6d65  ata (e.g. docume
+00011c10: 6e74 206b 6579 732c 2072 6576 6973 696f  nt keys, revisio
+00011c20: 6e73 2920 616e 640a 2020 2020 2020 2020  ns) and.        
+00011c30: 2020 2020 616e 7920 6578 6365 7074 696f      any exceptio
+00011c40: 6e73 2c20 6f72 2054 7275 6520 6966 2070  ns, or True if p
+00011c50: 6172 616d 6574 6572 202a 2a73 696c 656e  arameter **silen
+00011c60: 742a 2a20 7761 7320 7365 7420 746f 2054  t** was set to T
+00011c70: 7275 652e 0a20 2020 2020 2020 203a 7274  rue..        :rt
+00011c80: 7970 653a 205b 6469 6374 207c 2041 7261  ype: [dict | Ara
+00011c90: 6e67 6f45 7272 6f72 5d20 7c20 626f 6f6c  ngoError] | bool
+00011ca0: 0a20 2020 2020 2020 203a 7261 6973 6520  .        :raise 
+00011cb0: 6172 616e 676f 2e65 7863 6570 7469 6f6e  arango.exception
+00011cc0: 732e 446f 6375 6d65 6e74 5570 6461 7465  s.DocumentUpdate
+00011cd0: 4572 726f 723a 2049 6620 7570 6461 7465  Error: If update
+00011ce0: 2066 6169 6c73 2e0a 2020 2020 2020 2020   fails..        
+00011cf0: 2222 220a 2020 2020 2020 2020 7061 7261  """.        para
+00011d00: 6d73 3a20 5061 7261 6d73 203d 207b 0a20  ms: Params = {. 
+00011d10: 2020 2020 2020 2020 2020 2022 6b65 6570             "keep
+00011d20: 4e75 6c6c 223a 206b 6565 705f 6e6f 6e65  Null": keep_none
+00011d30: 2c0a 2020 2020 2020 2020 2020 2020 226d  ,.            "m
+00011d40: 6572 6765 4f62 6a65 6374 7322 3a20 6d65  ergeObjects": me
+00011d50: 7267 652c 0a20 2020 2020 2020 2020 2020  rge,.           
+00011d60: 2022 7265 7475 726e 4e65 7722 3a20 7265   "returnNew": re
+00011d70: 7475 726e 5f6e 6577 2c0a 2020 2020 2020  turn_new,.      
+00011d80: 2020 2020 2020 2272 6574 7572 6e4f 6c64        "returnOld
+00011d90: 223a 2072 6574 7572 6e5f 6f6c 642c 0a20  ": return_old,. 
+00011da0: 2020 2020 2020 2020 2020 2022 6967 6e6f             "igno
+00011db0: 7265 5265 7673 223a 206e 6f74 2063 6865  reRevs": not che
+00011dc0: 636b 5f72 6576 2c0a 2020 2020 2020 2020  ck_rev,.        
+00011dd0: 2020 2020 226f 7665 7277 7269 7465 223a      "overwrite":
+00011de0: 206e 6f74 2063 6865 636b 5f72 6576 2c0a   not check_rev,.
+00011df0: 2020 2020 2020 2020 2020 2020 2273 696c              "sil
+00011e00: 656e 7422 3a20 7369 6c65 6e74 2c0a 2020  ent": silent,.  
+00011e10: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+00011e20: 6966 2073 796e 6320 6973 206e 6f74 204e  if sync is not N
+00011e30: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00011e40: 2070 6172 616d 735b 2277 6169 7446 6f72   params["waitFor
+00011e50: 5379 6e63 225d 203d 2073 796e 630a 2020  Sync"] = sync.  
+00011e60: 2020 2020 2020 6966 2076 6572 7369 6f6e        if version
+00011e70: 5f61 7474 7269 6275 7465 2069 7320 6e6f  _attribute is no
+00011e80: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+00011e90: 2020 2020 7061 7261 6d73 5b22 7665 7273      params["vers
+00011ea0: 696f 6e41 7474 7269 6275 7465 225d 203d  ionAttribute"] =
+00011eb0: 2076 6572 7369 6f6e 5f61 7474 7269 6275   version_attribu
+00011ec0: 7465 0a0a 2020 2020 2020 2020 2320 4e65  te..        # Ne
+00011ed0: 7720 696e 2041 7261 6e67 6f44 4220 332e  w in ArangoDB 3.
+00011ee0: 392e 3620 616e 6420 332e 3130 2e32 0a20  9.6 and 3.10.2. 
+00011ef0: 2020 2020 2020 2069 6620 7265 6669 6c6c         if refill
+00011f00: 5f69 6e64 6578 5f63 6163 6865 7320 6973  _index_caches is
+00011f10: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00011f20: 2020 2020 2020 2070 6172 616d 735b 2272         params["r
+00011f30: 6566 696c 6c49 6e64 6578 4361 6368 6573  efillIndexCaches
+00011f40: 225d 203d 2072 6566 696c 6c5f 696e 6465  "] = refill_inde
+00011f50: 785f 6361 6368 6573 0a0a 2020 2020 2020  x_caches..      
+00011f60: 2020 646f 6375 6d65 6e74 7320 3d20 5b73    documents = [s
+00011f70: 656c 662e 5f65 6e73 7572 655f 6b65 795f  elf._ensure_key_
+00011f80: 696e 5f62 6f64 7928 646f 6329 2066 6f72  in_body(doc) for
+00011f90: 2064 6f63 2069 6e20 646f 6375 6d65 6e74   doc in document
+00011fa0: 735d 0a0a 2020 2020 2020 2020 7265 7175  s]..        requ
+00011fb0: 6573 7420 3d20 5265 7175 6573 7428 0a20  est = Request(. 
+00011fc0: 2020 2020 2020 2020 2020 206d 6574 686f             metho
+00011fd0: 643d 2270 6174 6368 222c 0a20 2020 2020  d="patch",.     
+00011fe0: 2020 2020 2020 2065 6e64 706f 696e 743d         endpoint=
+00011ff0: 6622 2f5f 6170 692f 646f 6375 6d65 6e74  f"/_api/document
+00012000: 2f7b 7365 6c66 2e6e 616d 657d 222c 0a20  /{self.name}",. 
+00012010: 2020 2020 2020 2020 2020 2064 6174 613d             data=
+00012020: 646f 6375 6d65 6e74 732c 0a20 2020 2020  documents,.     
+00012030: 2020 2020 2020 2070 6172 616d 733d 7061         params=pa
+00012040: 7261 6d73 2c0a 2020 2020 2020 2020 2020  rams,.          
+00012050: 2020 7772 6974 653d 7365 6c66 2e6e 616d    write=self.nam
+00012060: 652c 0a20 2020 2020 2020 2029 0a0a 2020  e,.        )..  
+00012070: 2020 2020 2020 6465 6620 7265 7370 6f6e        def respon
+00012080: 7365 5f68 616e 646c 6572 280a 2020 2020  se_handler(.    
+00012090: 2020 2020 2020 2020 7265 7370 3a20 5265          resp: Re
+000120a0: 7370 6f6e 7365 2c0a 2020 2020 2020 2020  sponse,.        
+000120b0: 2920 2d3e 2055 6e69 6f6e 5b62 6f6f 6c2c  ) -> Union[bool,
+000120c0: 204c 6973 745b 556e 696f 6e5b 4a73 6f6e   List[Union[Json
+000120d0: 2c20 4172 616e 676f 5365 7276 6572 4572  , ArangoServerEr
+000120e0: 726f 725d 5d5d 3a0a 2020 2020 2020 2020  ror]]]:.        
+000120f0: 2020 2020 6966 206e 6f74 2072 6573 702e      if not resp.
+00012100: 6973 5f73 7563 6365 7373 3a0a 2020 2020  is_success:.    
+00012110: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00012120: 6520 446f 6375 6d65 6e74 5570 6461 7465  e DocumentUpdate
+00012130: 4572 726f 7228 7265 7370 2c20 7265 7175  Error(resp, requ
+00012140: 6573 7429 0a20 2020 2020 2020 2020 2020  est).           
+00012150: 2069 6620 7369 6c65 6e74 2069 7320 5472   if silent is Tr
+00012160: 7565 3a0a 2020 2020 2020 2020 2020 2020  ue:.            
+00012170: 2020 2020 7265 7475 726e 2054 7275 650a      return True.
+00012180: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+00012190: 756c 7473 203d 205b 5d0a 2020 2020 2020  ults = [].      
+000121a0: 2020 2020 2020 666f 7220 626f 6479 2069        for body i
+000121b0: 6e20 7265 7370 2e62 6f64 793a 0a20 2020  n resp.body:.   
+000121c0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000121d0: 225f 6964 2220 696e 2062 6f64 793a 0a20  "_id" in body:. 
+000121e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000121f0: 2020 2062 6f64 795b 225f 6f6c 645f 7265     body["_old_re
+00012200: 7622 5d20 3d20 626f 6479 2e70 6f70 2822  v"] = body.pop("
+00012210: 5f6f 6c64 5265 7622 290a 2020 2020 2020  _oldRev").      
+00012220: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00012230: 7375 6c74 732e 6170 7065 6e64 2862 6f64  sults.append(bod
+00012240: 7929 0a20 2020 2020 2020 2020 2020 2020  y).             
+00012250: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00012260: 2020 2020 2020 2020 2020 2020 2073 7562               sub
+00012270: 5f72 6573 7020 3d20 7365 6c66 2e5f 636f  _resp = self._co
+00012280: 6e6e 2e70 7265 705f 6275 6c6b 5f65 7272  nn.prep_bulk_err
+00012290: 5f72 6573 706f 6e73 6528 7265 7370 2c20  _response(resp, 
+000122a0: 626f 6479 290a 0a20 2020 2020 2020 2020  body)..         
+000122b0: 2020 2020 2020 2020 2020 2065 7272 6f72             error
+000122c0: 3a20 4172 616e 676f 5365 7276 6572 4572  : ArangoServerEr
+000122d0: 726f 720a 2020 2020 2020 2020 2020 2020  ror.            
+000122e0: 2020 2020 2020 2020 6966 2073 7562 5f72          if sub_r
+000122f0: 6573 702e 6572 726f 725f 636f 6465 203d  esp.error_code =
+00012300: 3d20 3132 3030 3a0a 2020 2020 2020 2020  = 1200:.        
+00012310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012320: 6572 726f 7220 3d20 446f 6375 6d65 6e74  error = Document
+00012330: 5265 7669 7369 6f6e 4572 726f 7228 7375  RevisionError(su
+00012340: 625f 7265 7370 2c20 7265 7175 6573 7429  b_resp, request)
+00012350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012360: 2020 2020 2065 6c73 653a 2020 2320 7072       else:  # pr
+00012370: 6167 6d61 3a20 6e6f 2063 6f76 6572 0a20  agma: no cover. 
+00012380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012390: 2020 2020 2020 2065 7272 6f72 203d 2044         error = D
+000123a0: 6f63 756d 656e 7455 7064 6174 6545 7272  ocumentUpdateErr
+000123b0: 6f72 2873 7562 5f72 6573 702c 2072 6571  or(sub_resp, req
+000123c0: 7565 7374 290a 0a20 2020 2020 2020 2020  uest)..         
+000123d0: 2020 2020 2020 2020 2020 2069 6620 7261             if ra
+000123e0: 6973 655f 6f6e 5f64 6f63 756d 656e 745f  ise_on_document_
+000123f0: 6572 726f 723a 0a20 2020 2020 2020 2020  error:.         
+00012400: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00012410: 6169 7365 2065 7272 6f72 0a0a 2020 2020  aise error..    
+00012420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012430: 7265 7375 6c74 732e 6170 7065 6e64 2865  results.append(e
+00012440: 7272 6f72 290a 0a20 2020 2020 2020 2020  rror)..         
+00012450: 2020 2072 6574 7572 6e20 7265 7375 6c74     return result
+00012460: 730a 0a20 2020 2020 2020 2072 6574 7572  s..        retur
+00012470: 6e20 7365 6c66 2e5f 6578 6563 7574 6528  n self._execute(
+00012480: 7265 7175 6573 742c 2072 6573 706f 6e73  request, respons
+00012490: 655f 6861 6e64 6c65 7229 0a0a 2020 2020  e_handler)..    
+000124a0: 6465 6620 7570 6461 7465 5f6d 6174 6368  def update_match
+000124b0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+000124c0: 2020 2020 2020 2020 6669 6c74 6572 733a          filters:
+000124d0: 204a 736f 6e2c 0a20 2020 2020 2020 2062   Json,.        b
+000124e0: 6f64 793a 204a 736f 6e2c 0a20 2020 2020  ody: Json,.     
+000124f0: 2020 206c 696d 6974 3a20 4f70 7469 6f6e     limit: Option
+00012500: 616c 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a  al[int] = None,.
+00012510: 2020 2020 2020 2020 6b65 6570 5f6e 6f6e          keep_non
+00012520: 653a 2062 6f6f 6c20 3d20 5472 7565 2c0a  e: bool = True,.
+00012530: 2020 2020 2020 2020 7379 6e63 3a20 4f70          sync: Op
+00012540: 7469 6f6e 616c 5b62 6f6f 6c5d 203d 204e  tional[bool] = N
+00012550: 6f6e 652c 0a20 2020 2020 2020 206d 6572  one,.        mer
+00012560: 6765 3a20 626f 6f6c 203d 2054 7275 652c  ge: bool = True,
+00012570: 0a20 2020 2020 2020 2061 6c6c 6f77 5f64  .        allow_d
+00012580: 6972 7479 5f72 6561 643a 2062 6f6f 6c20  irty_read: bool 
+00012590: 3d20 4661 6c73 652c 0a20 2020 2029 202d  = False,.    ) -
+000125a0: 3e20 5265 7375 6c74 5b69 6e74 5d3a 0a20  > Result[int]:. 
+000125b0: 2020 2020 2020 2022 2222 5570 6461 7465         """Update
+000125c0: 206d 6174 6368 696e 6720 646f 6375 6d65   matching docume
+000125d0: 6e74 732e 0a0a 2020 2020 2020 2020 2e2e  nts...        ..
+000125e0: 206e 6f74 653a 3a0a 0a20 2020 2020 2020   note::..       
+000125f0: 2020 2020 2049 6e20 6564 6765 2f76 6572       In edge/ver
+00012600: 7465 7820 636f 6c6c 6563 7469 6f6e 732c  tex collections,
+00012610: 2074 6869 7320 6d65 7468 6f64 2064 6f65   this method doe
+00012620: 7320 4e4f 5420 7072 6f76 6964 6520 7468  s NOT provide th
+00012630: 650a 2020 2020 2020 2020 2020 2020 7472  e.            tr
+00012640: 616e 7361 6374 696f 6e61 6c20 6775 6172  ansactional guar
+00012650: 616e 7465 6573 2061 6e64 2076 616c 6964  antees and valid
+00012660: 6174 696f 6e73 2074 6861 7420 7369 6e67  ations that sing
+00012670: 6c65 2075 7064 6174 650a 2020 2020 2020  le update.      
+00012680: 2020 2020 2020 6f70 6572 6174 696f 6e20        operation 
+00012690: 646f 6573 2066 6f72 2067 7261 7068 732e  does for graphs.
+000126a0: 2049 6620 7468 6573 6520 7072 6f70 6572   If these proper
+000126b0: 7469 6573 2061 7265 2072 6571 7569 7265  ties are require
+000126c0: 642c 2073 6565 0a20 2020 2020 2020 2020  d, see.         
+000126d0: 2020 203a 6675 6e63 3a60 6172 616e 676f     :func:`arango
+000126e0: 2e64 6174 6162 6173 652e 5374 616e 6461  .database.Standa
+000126f0: 7264 4461 7461 6261 7365 2e62 6567 696e  rdDatabase.begin
+00012700: 5f62 6174 6368 5f65 7865 6375 7469 6f6e  _batch_execution
+00012710: 600a 2020 2020 2020 2020 2020 2020 666f  `.            fo
+00012720: 7220 616e 2061 6c74 6572 6e61 7469 7665  r an alternative
+00012730: 2061 7070 726f 6163 682e 0a0a 2020 2020   approach...    
+00012740: 2020 2020 3a70 6172 616d 2066 696c 7465      :param filte
+00012750: 7273 3a20 446f 6375 6d65 6e74 2066 696c  rs: Document fil
+00012760: 7465 7273 2e0a 2020 2020 2020 2020 3a74  ters..        :t
+00012770: 7970 6520 6669 6c74 6572 733a 2064 6963  ype filters: dic
+00012780: 740a 2020 2020 2020 2020 3a70 6172 616d  t.        :param
+00012790: 2062 6f64 793a 2046 756c 6c20 6f72 2070   body: Full or p
+000127a0: 6172 7469 616c 2064 6f63 756d 656e 7420  artial document 
+000127b0: 626f 6479 2077 6974 6820 7468 6520 7570  body with the up
+000127c0: 6461 7465 732e 0a20 2020 2020 2020 203a  dates..        :
+000127d0: 7479 7065 2062 6f64 793a 2064 6963 740a  type body: dict.
+000127e0: 2020 2020 2020 2020 3a70 6172 616d 206c          :param l
+000127f0: 696d 6974 3a20 4d61 7820 6e75 6d62 6572  imit: Max number
+00012800: 206f 6620 646f 6375 6d65 6e74 7320 746f   of documents to
+00012810: 2075 7064 6174 652e 2049 6620 7468 6520   update. If the 
+00012820: 6c69 6d69 7420 6973 206c 6f77 6572 0a20  limit is lower. 
+00012830: 2020 2020 2020 2020 2020 2074 6861 6e20             than 
+00012840: 7468 6520 6e75 6d62 6572 206f 6620 6d61  the number of ma
+00012850: 7463 6865 6420 646f 6375 6d65 6e74 732c  tched documents,
+00012860: 2072 616e 646f 6d20 646f 6375 6d65 6e74   random document
+00012870: 7320 6172 650a 2020 2020 2020 2020 2020  s are.          
+00012880: 2020 6368 6f73 656e 2e20 5468 6973 2070    chosen. This p
+00012890: 6172 616d 6574 6572 2069 7320 6e6f 7420  arameter is not 
+000128a0: 7375 7070 6f72 7465 6420 6f6e 2073 6861  supported on sha
+000128b0: 7264 6564 2063 6f6c 6c65 6374 696f 6e73  rded collections
+000128c0: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
+000128d0: 6c69 6d69 743a 2069 6e74 207c 204e 6f6e  limit: int | Non
+000128e0: 650a 2020 2020 2020 2020 3a70 6172 616d  e.        :param
+000128f0: 206b 6565 705f 6e6f 6e65 3a20 4966 2073   keep_none: If s
+00012900: 6574 2074 6f20 5472 7565 2c20 6669 656c  et to True, fiel
+00012910: 6473 2077 6974 6820 7661 6c75 6520 4e6f  ds with value No
+00012920: 6e65 2061 7265 2072 6574 6169 6e65 640a  ne are retained.
+00012930: 2020 2020 2020 2020 2020 2020 696e 2074              in t
+00012940: 6865 2064 6f63 756d 656e 742e 204f 7468  he document. Oth
+00012950: 6572 7769 7365 2c20 7468 6579 2061 7265  erwise, they are
+00012960: 2072 656d 6f76 6564 2063 6f6d 706c 6574   removed complet
+00012970: 656c 792e 0a20 2020 2020 2020 203a 7479  ely..        :ty
+00012980: 7065 206b 6565 705f 6e6f 6e65 3a20 626f  pe keep_none: bo
+00012990: 6f6c 207c 204e 6f6e 650a 2020 2020 2020  ol | None.      
+000129a0: 2020 3a70 6172 616d 2073 796e 633a 2042    :param sync: B
+000129b0: 6c6f 636b 2075 6e74 696c 206f 7065 7261  lock until opera
+000129c0: 7469 6f6e 2069 7320 7379 6e63 6872 6f6e  tion is synchron
+000129d0: 697a 6564 2074 6f20 6469 736b 2e0a 2020  ized to disk..  
+000129e0: 2020 2020 2020 3a74 7970 6520 7379 6e63        :type sync
+000129f0: 3a20 626f 6f6c 207c 204e 6f6e 650a 2020  : bool | None.  
+00012a00: 2020 2020 2020 3a70 6172 616d 206d 6572        :param mer
+00012a10: 6765 3a20 4966 2073 6574 2074 6f20 5472  ge: If set to Tr
+00012a20: 7565 2c20 7375 622d 6469 6374 696f 6e61  ue, sub-dictiona
+00012a30: 7269 6573 2061 7265 206d 6572 6765 6420  ries are merged 
+00012a40: 696e 7374 6561 6420 6f66 0a20 2020 2020  instead of.     
+00012a50: 2020 2020 2020 2074 6865 206e 6577 206f         the new o
+00012a60: 6e65 7320 6f76 6572 7772 6974 696e 6720  nes overwriting 
+00012a70: 7468 6520 6f6c 6420 6f6e 6573 2e0a 2020  the old ones..  
+00012a80: 2020 2020 2020 3a74 7970 6520 6d65 7267        :type merg
+00012a90: 653a 2062 6f6f 6c20 7c20 4e6f 6e65 0a20  e: bool | None. 
+00012aa0: 2020 2020 2020 203a 7061 7261 6d20 616c         :param al
+00012ab0: 6c6f 775f 6469 7274 795f 7265 6164 3a20  low_dirty_read: 
+00012ac0: 416c 6c6f 7720 7265 6164 7320 6672 6f6d  Allow reads from
+00012ad0: 2066 6f6c 6c6f 7765 7273 2069 6e20 6120   followers in a 
+00012ae0: 636c 7573 7465 722e 0a20 2020 2020 2020  cluster..       
+00012af0: 203a 7479 7065 2061 6c6c 6f77 5f64 6972   :type allow_dir
+00012b00: 7479 5f72 6561 643a 2062 6f6f 6c0a 2020  ty_read: bool.  
+00012b10: 2020 2020 2020 3a72 6574 7572 6e3a 204e        :return: N
+00012b20: 756d 6265 7220 6f66 2064 6f63 756d 656e  umber of documen
+00012b30: 7473 2075 7064 6174 6564 2e0a 2020 2020  ts updated..    
+00012b40: 2020 2020 3a72 7479 7065 3a20 696e 740a      :rtype: int.
+00012b50: 2020 2020 2020 2020 3a72 6169 7365 2061          :raise a
+00012b60: 7261 6e67 6f2e 6578 6365 7074 696f 6e73  rango.exceptions
+00012b70: 2e44 6f63 756d 656e 7455 7064 6174 6545  .DocumentUpdateE
+00012b80: 7272 6f72 3a20 4966 2075 7064 6174 6520  rror: If update 
+00012b90: 6661 696c 732e 0a20 2020 2020 2020 2022  fails..        "
+00012ba0: 2222 0a20 2020 2020 2020 2061 7373 6572  "".        asser
+00012bb0: 7420 6973 696e 7374 616e 6365 2866 696c  t isinstance(fil
+00012bc0: 7465 7273 2c20 6469 6374 292c 2022 6669  ters, dict), "fi
+00012bd0: 6c74 6572 7320 6d75 7374 2062 6520 6120  lters must be a 
+00012be0: 6469 6374 220a 2020 2020 2020 2020 6173  dict".        as
+00012bf0: 7365 7274 2069 735f 6e6f 6e65 5f6f 725f  sert is_none_or_
+00012c00: 696e 7428 6c69 6d69 7429 2c20 226c 696d  int(limit), "lim
+00012c10: 6974 206d 7573 7420 6265 2061 206e 6f6e  it must be a non
+00012c20: 2d6e 6567 6174 6976 6520 696e 7422 0a20  -negative int". 
+00012c30: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+00012c40: 5f6e 6f6e 655f 6f72 5f62 6f6f 6c28 7379  _none_or_bool(sy
+00012c50: 6e63 292c 2022 7379 6e63 206d 7573 7420  nc), "sync must 
+00012c60: 6265 204e 6f6e 6520 6f72 2061 2062 6f6f  be None or a boo
+00012c70: 6c22 0a0a 2020 2020 2020 2020 2320 4966  l"..        # If
+00012c80: 2074 6865 2077 6169 7446 6f72 5379 6e63   the waitForSync
+00012c90: 2070 6172 616d 6574 6572 2069 7320 6e6f   parameter is no
+00012ca0: 7420 7370 6563 6966 6965 6420 6f72 2073  t specified or s
+00012cb0: 6574 2074 6f20 6661 6c73 652c 0a20 2020  et to false,.   
+00012cc0: 2020 2020 2023 2074 6865 6e20 7468 6520       # then the 
+00012cd0: 636f 6c6c 6563 7469 6f6e e280 9973 2064  collection...s d
+00012ce0: 6566 6175 6c74 2077 6169 7446 6f72 5379  efault waitForSy
+00012cf0: 6e63 2062 6568 6176 696f 7220 6973 2061  nc behavior is a
+00012d00: 7070 6c69 6564 2e0a 2020 2020 2020 2020  pplied..        
+00012d10: 7379 6e63 5f76 616c 203d 2066 222c 2077  sync_val = f", w
+00012d20: 6169 7446 6f72 5379 6e63 3a20 7b73 796e  aitForSync: {syn
+00012d30: 637d 2220 6966 2073 796e 6320 6973 206e  c}" if sync is n
+00012d40: 6f74 204e 6f6e 6520 656c 7365 2022 220a  ot None else "".
+00012d50: 0a20 2020 2020 2020 2071 7565 7279 203d  .        query =
+00012d60: 2066 2222 220a 2020 2020 2020 2020 2020   f""".          
+00012d70: 2020 464f 5220 646f 6320 494e 2040 4063    FOR doc IN @@c
+00012d80: 6f6c 6c65 6374 696f 6e0a 2020 2020 2020  ollection.      
+00012d90: 2020 2020 2020 2020 2020 7b62 7569 6c64            {build
+00012da0: 5f66 696c 7465 725f 636f 6e64 6974 696f  _filter_conditio
+00012db0: 6e73 2866 696c 7465 7273 297d 0a20 2020  ns(filters)}.   
+00012dc0: 2020 2020 2020 2020 2020 2020 207b 6622               {f"
+00012dd0: 4c49 4d49 5420 7b6c 696d 6974 7d22 2069  LIMIT {limit}" i
+00012de0: 6620 6c69 6d69 7420 6973 206e 6f74 204e  f limit is not N
+00012df0: 6f6e 6520 656c 7365 2022 227d 0a20 2020  one else ""}.   
+00012e00: 2020 2020 2020 2020 2020 2020 2055 5044               UPD
+00012e10: 4154 4520 646f 6320 5749 5448 2040 626f  ATE doc WITH @bo
+00012e20: 6479 2049 4e20 4040 636f 6c6c 6563 7469  dy IN @@collecti
+00012e30: 6f6e 0a20 2020 2020 2020 2020 2020 2020  on.             
+00012e40: 2020 204f 5054 494f 4e53 207b 7b20 6b65     OPTIONS {{ ke
+00012e50: 6570 4e75 6c6c 3a20 406b 6565 705f 6e6f  epNull: @keep_no
+00012e60: 6e65 2c20 6d65 7267 654f 626a 6563 7473  ne, mergeObjects
+00012e70: 3a20 406d 6572 6765 207b 7379 6e63 5f76  : @merge {sync_v
+00012e80: 616c 7d20 7d7d 0a20 2020 2020 2020 2022  al} }}.        "
+00012e90: 2222 2020 2320 6e6f 7161 3a20 4532 3031  ""  # noqa: E201
+00012ea0: 2045 3230 320a 0a20 2020 2020 2020 2062   E202..        b
+00012eb0: 696e 645f 7661 7273 203d 207b 0a20 2020  ind_vars = {.   
+00012ec0: 2020 2020 2020 2020 2022 4063 6f6c 6c65           "@colle
+00012ed0: 6374 696f 6e22 3a20 7365 6c66 2e6e 616d  ction": self.nam
+00012ee0: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
+00012ef0: 626f 6479 223a 2062 6f64 792c 0a20 2020  body": body,.   
+00012f00: 2020 2020 2020 2020 2022 6b65 6570 5f6e           "keep_n
+00012f10: 6f6e 6522 3a20 6b65 6570 5f6e 6f6e 652c  one": keep_none,
+00012f20: 0a20 2020 2020 2020 2020 2020 2022 6d65  .            "me
+00012f30: 7267 6522 3a20 6d65 7267 652c 0a20 2020  rge": merge,.   
+00012f40: 2020 2020 207d 0a0a 2020 2020 2020 2020       }..        
+00012f50: 7265 7175 6573 7420 3d20 5265 7175 6573  request = Reques
+00012f60: 7428 0a20 2020 2020 2020 2020 2020 206d  t(.            m
+00012f70: 6574 686f 643d 2270 6f73 7422 2c0a 2020  ethod="post",.  
+00012f80: 2020 2020 2020 2020 2020 656e 6470 6f69            endpoi
+00012f90: 6e74 3d22 2f5f 6170 692f 6375 7273 6f72  nt="/_api/cursor
+00012fa0: 222c 0a20 2020 2020 2020 2020 2020 2064  ",.            d
+00012fb0: 6174 613d 7b22 7175 6572 7922 3a20 7175  ata={"query": qu
+00012fc0: 6572 792c 2022 6269 6e64 5661 7273 223a  ery, "bindVars":
+00012fd0: 2062 696e 645f 7661 7273 7d2c 0a20 2020   bind_vars},.   
+00012fe0: 2020 2020 2020 2020 2077 7269 7465 3d73           write=s
+00012ff0: 656c 662e 6e61 6d65 2c0a 2020 2020 2020  elf.name,.      
+00013000: 2020 2020 2020 6865 6164 6572 733d 7b22        headers={"
+00013010: 782d 6172 616e 676f 2d61 6c6c 6f77 2d64  x-arango-allow-d
+00013020: 6972 7479 2d72 6561 6422 3a20 2274 7275  irty-read": "tru
+00013030: 6522 7d20 6966 2061 6c6c 6f77 5f64 6972  e"} if allow_dir
+00013040: 7479 5f72 6561 6420 656c 7365 204e 6f6e  ty_read else Non
+00013050: 652c 0a20 2020 2020 2020 2029 0a0a 2020  e,.        )..  
+00013060: 2020 2020 2020 6465 6620 7265 7370 6f6e        def respon
+00013070: 7365 5f68 616e 646c 6572 2872 6573 703a  se_handler(resp:
+00013080: 2052 6573 706f 6e73 6529 202d 3e20 696e   Response) -> in
+00013090: 743a 0a20 2020 2020 2020 2020 2020 2069  t:.            i
+000130a0: 6620 7265 7370 2e69 735f 7375 6363 6573  f resp.is_succes
+000130b0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+000130c0: 2020 2072 6573 756c 743a 2069 6e74 203d     result: int =
+000130d0: 2072 6573 702e 626f 6479 5b22 6578 7472   resp.body["extr
+000130e0: 6122 5d5b 2273 7461 7473 225d 5b22 7772  a"]["stats"]["wr
+000130f0: 6974 6573 4578 6563 7574 6564 225d 0a20  itesExecuted"]. 
+00013100: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00013110: 6574 7572 6e20 7265 7375 6c74 0a20 2020  eturn result.   
+00013120: 2020 2020 2020 2020 2072 6169 7365 2044           raise D
+00013130: 6f63 756d 656e 7455 7064 6174 6545 7272  ocumentUpdateErr
+00013140: 6f72 2872 6573 702c 2072 6571 7565 7374  or(resp, request
+00013150: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+00013160: 6e20 7365 6c66 2e5f 6578 6563 7574 6528  n self._execute(
+00013170: 7265 7175 6573 742c 2072 6573 706f 6e73  request, respons
+00013180: 655f 6861 6e64 6c65 7229 0a0a 2020 2020  e_handler)..    
+00013190: 6465 6620 7265 706c 6163 655f 6d61 6e79  def replace_many
+000131a0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+000131b0: 2020 2020 2020 2020 646f 6375 6d65 6e74          document
+000131c0: 733a 2053 6571 7565 6e63 655b 4a73 6f6e  s: Sequence[Json
+000131d0: 5d2c 0a20 2020 2020 2020 2063 6865 636b  ],.        check
+000131e0: 5f72 6576 3a20 626f 6f6c 203d 2054 7275  _rev: bool = Tru
+000131f0: 652c 0a20 2020 2020 2020 2072 6574 7572  e,.        retur
+00013200: 6e5f 6e65 773a 2062 6f6f 6c20 3d20 4661  n_new: bool = Fa
+00013210: 6c73 652c 0a20 2020 2020 2020 2072 6574  lse,.        ret
+00013220: 7572 6e5f 6f6c 643a 2062 6f6f 6c20 3d20  urn_old: bool = 
+00013230: 4661 6c73 652c 0a20 2020 2020 2020 2073  False,.        s
+00013240: 796e 633a 204f 7074 696f 6e61 6c5b 626f  ync: Optional[bo
+00013250: 6f6c 5d20 3d20 4e6f 6e65 2c0a 2020 2020  ol] = None,.    
+00013260: 2020 2020 7369 6c65 6e74 3a20 626f 6f6c      silent: bool
+00013270: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
+00013280: 2020 7265 6669 6c6c 5f69 6e64 6578 5f63    refill_index_c
+00013290: 6163 6865 733a 204f 7074 696f 6e61 6c5b  aches: Optional[
+000132a0: 626f 6f6c 5d20 3d20 4e6f 6e65 2c0a 2020  bool] = None,.  
+000132b0: 2020 2020 2020 7665 7273 696f 6e5f 6174        version_at
+000132c0: 7472 6962 7574 653a 204f 7074 696f 6e61  tribute: Optiona
+000132d0: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
+000132e0: 2020 2029 202d 3e20 5265 7375 6c74 5b55     ) -> Result[U
+000132f0: 6e69 6f6e 5b62 6f6f 6c2c 204c 6973 745b  nion[bool, List[
+00013300: 556e 696f 6e5b 4a73 6f6e 2c20 4172 616e  Union[Json, Aran
+00013310: 676f 5365 7276 6572 4572 726f 725d 5d5d  goServerError]]]
+00013320: 5d3a 0a20 2020 2020 2020 2022 2222 5265  ]:.        """Re
+00013330: 706c 6163 6520 6d75 6c74 6970 6c65 2064  place multiple d
+00013340: 6f63 756d 656e 7473 2e0a 0a20 2020 2020  ocuments...     
+00013350: 2020 202e 2e20 6e6f 7465 3a3a 0a0a 2020     .. note::..  
+00013360: 2020 2020 2020 2020 2020 4966 2072 6570            If rep
+00013370: 6c61 6369 6e67 2061 2064 6f63 756d 656e  lacing a documen
+00013380: 7420 6661 696c 732c 2074 6865 2065 7863  t fails, the exc
+00013390: 6570 7469 6f6e 2069 7320 6e6f 7420 7261  eption is not ra
+000133a0: 6973 6564 2062 7574 0a20 2020 2020 2020  ised but.       
+000133b0: 2020 2020 2072 6574 7572 6e65 6420 6173       returned as
+000133c0: 2061 6e20 6f62 6a65 6374 2069 6e20 7468   an object in th
+000133d0: 6520 7265 7375 6c74 206c 6973 742e 2049  e result list. I
+000133e0: 7420 6973 2075 7020 746f 2079 6f75 2074  t is up to you t
+000133f0: 6f0a 2020 2020 2020 2020 2020 2020 696e  o.            in
+00013400: 7370 6563 7420 7468 6520 6c69 7374 2074  spect the list t
+00013410: 6f20 6465 7465 726d 696e 6520 7768 6963  o determine whic
+00013420: 6820 646f 6375 6d65 6e74 7320 7765 7265  h documents were
+00013430: 2072 6570 6c61 6365 640a 2020 2020 2020   replaced.      
+00013440: 2020 2020 2020 7375 6363 6573 7366 756c        successful
+00013450: 6c79 2028 7265 7475 726e 7320 646f 6375  ly (returns docu
+00013460: 6d65 6e74 206d 6574 6164 6174 6129 2061  ment metadata) a
+00013470: 6e64 2077 6869 6368 2077 6572 6520 6e6f  nd which were no
+00013480: 740a 2020 2020 2020 2020 2020 2020 2872  t.            (r
+00013490: 6574 7572 6e73 2065 7863 6570 7469 6f6e  eturns exception
+000134a0: 206f 626a 6563 7429 2e0a 0a20 2020 2020   object)...     
+000134b0: 2020 202e 2e20 6e6f 7465 3a3a 0a0a 2020     .. note::..  
+000134c0: 2020 2020 2020 2020 2020 496e 2065 6467            In edg
+000134d0: 652f 7665 7274 6578 2063 6f6c 6c65 6374  e/vertex collect
+000134e0: 696f 6e73 2c20 7468 6973 206d 6574 686f  ions, this metho
+000134f0: 6420 646f 6573 204e 4f54 2070 726f 7669  d does NOT provi
+00013500: 6465 2074 6865 0a20 2020 2020 2020 2020  de the.         
+00013510: 2020 2074 7261 6e73 6163 7469 6f6e 616c     transactional
+00013520: 2067 7561 7261 6e74 6565 7320 616e 6420   guarantees and 
+00013530: 7661 6c69 6461 7469 6f6e 7320 7468 6174  validations that
+00013540: 2073 696e 676c 6520 7265 706c 6163 650a   single replace.
+00013550: 2020 2020 2020 2020 2020 2020 6f70 6572              oper
+00013560: 6174 696f 6e20 646f 6573 2066 6f72 2067  ation does for g
+00013570: 7261 7068 732e 2049 6620 7468 6573 6520  raphs. If these 
+00013580: 7072 6f70 6572 7469 6573 2061 7265 2072  properties are r
+00013590: 6571 7569 7265 642c 2073 6565 0a20 2020  equired, see.   
+000135a0: 2020 2020 2020 2020 203a 6675 6e63 3a60           :func:`
+000135b0: 6172 616e 676f 2e64 6174 6162 6173 652e  arango.database.
+000135c0: 5374 616e 6461 7264 4461 7461 6261 7365  StandardDatabase
+000135d0: 2e62 6567 696e 5f62 6174 6368 5f65 7865  .begin_batch_exe
+000135e0: 6375 7469 6f6e 600a 2020 2020 2020 2020  cution`.        
+000135f0: 2020 2020 666f 7220 616e 2061 6c74 6572      for an alter
+00013600: 6e61 7469 7665 2061 7070 726f 6163 682e  native approach.
+00013610: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00013620: 2064 6f63 756d 656e 7473 3a20 4e65 7720   documents: New 
+00013630: 646f 6375 6d65 6e74 7320 746f 2072 6570  documents to rep
+00013640: 6c61 6365 2074 6865 206f 6c64 206f 6e65  lace the old one
+00013650: 7320 7769 7468 2e20 5468 6579 206d 7573  s with. They mus
+00013660: 740a 2020 2020 2020 2020 2020 2020 636f  t.            co
+00013670: 6e74 6169 6e20 7468 6520 225f 6964 2220  ntain the "_id" 
+00013680: 6f72 2022 5f6b 6579 2220 6669 656c 6473  or "_key" fields
+00013690: 2e20 4564 6765 2064 6f63 756d 656e 7473  . Edge documents
+000136a0: 206d 7573 7420 616c 736f 2068 6176 650a   must also have.
+000136b0: 2020 2020 2020 2020 2020 2020 225f 6672              "_fr
+000136c0: 6f6d 2220 616e 6420 225f 746f 2220 6669  om" and "_to" fi
+000136d0: 656c 6473 2e0a 2020 2020 2020 2020 3a74  elds..        :t
+000136e0: 7970 6520 646f 6375 6d65 6e74 733a 205b  ype documents: [
+000136f0: 6469 6374 5d0a 2020 2020 2020 2020 3a70  dict].        :p
+00013700: 6172 616d 2063 6865 636b 5f72 6576 3a20  aram check_rev: 
+00013710: 4966 2073 6574 2074 6f20 5472 7565 2c20  If set to True, 
+00013720: 7265 7669 7369 6f6e 7320 6f66 202a 2a64  revisions of **d
+00013730: 6f63 756d 656e 7473 2a2a 2028 6966 2067  ocuments** (if g
+00013740: 6976 656e 290a 2020 2020 2020 2020 2020  iven).          
+00013750: 2020 6172 6520 636f 6d70 6172 6564 2061    are compared a
+00013760: 6761 696e 7374 2074 6865 2072 6576 6973  gainst the revis
+00013770: 696f 6e73 206f 6620 7461 7267 6574 2064  ions of target d
+00013780: 6f63 756d 656e 7473 2e0a 2020 2020 2020  ocuments..      
+00013790: 2020 3a74 7970 6520 6368 6563 6b5f 7265    :type check_re
+000137a0: 763a 2062 6f6f 6c0a 2020 2020 2020 2020  v: bool.        
+000137b0: 3a70 6172 616d 2072 6574 7572 6e5f 6e65  :param return_ne
+000137c0: 773a 2049 6e63 6c75 6465 2062 6f64 7920  w: Include body 
+000137d0: 6f66 2074 6865 206e 6577 2064 6f63 756d  of the new docum
+000137e0: 656e 7420 696e 2074 6865 2072 6574 7572  ent in the retur
+000137f0: 6e65 640a 2020 2020 2020 2020 2020 2020  ned.            
+00013800: 6d65 7461 6461 7461 2e20 4967 6e6f 7265  metadata. Ignore
+00013810: 6420 6966 2070 6172 616d 6574 6572 202a  d if parameter *
+00013820: 2a73 696c 656e 742a 2a20 6973 2073 6574  *silent** is set
+00013830: 2074 6f20 5472 7565 2e0a 2020 2020 2020   to True..      
+00013840: 2020 3a74 7970 6520 7265 7475 726e 5f6e    :type return_n
+00013850: 6577 3a20 626f 6f6c 0a20 2020 2020 2020  ew: bool.       
+00013860: 203a 7061 7261 6d20 7265 7475 726e 5f6f   :param return_o
+00013870: 6c64 3a20 496e 636c 7564 6520 626f 6479  ld: Include body
+00013880: 206f 6620 7468 6520 6f6c 6420 646f 6375   of the old docu
+00013890: 6d65 6e74 2069 6e20 7468 6520 7265 7475  ment in the retu
+000138a0: 726e 6564 0a20 2020 2020 2020 2020 2020  rned.           
+000138b0: 206d 6574 6164 6174 612e 2049 676e 6f72   metadata. Ignor
+000138c0: 6564 2069 6620 7061 7261 6d65 7465 7220  ed if parameter 
+000138d0: 2a2a 7369 6c65 6e74 2a2a 2069 7320 7365  **silent** is se
+000138e0: 7420 746f 2054 7275 652e 0a20 2020 2020  t to True..     
+000138f0: 2020 203a 7479 7065 2072 6574 7572 6e5f     :type return_
+00013900: 6f6c 643a 2062 6f6f 6c0a 2020 2020 2020  old: bool.      
+00013910: 2020 3a70 6172 616d 2073 796e 633a 2042    :param sync: B
+00013920: 6c6f 636b 2075 6e74 696c 206f 7065 7261  lock until opera
+00013930: 7469 6f6e 2069 7320 7379 6e63 6872 6f6e  tion is synchron
+00013940: 697a 6564 2074 6f20 6469 736b 2e0a 2020  ized to disk..  
+00013950: 2020 2020 2020 3a74 7970 6520 7379 6e63        :type sync
+00013960: 3a20 626f 6f6c 207c 204e 6f6e 650a 2020  : bool | None.  
+00013970: 2020 2020 2020 3a70 6172 616d 2073 696c        :param sil
+00013980: 656e 743a 2049 6620 7365 7420 746f 2054  ent: If set to T
+00013990: 7275 652c 206e 6f20 646f 6375 6d65 6e74  rue, no document
+000139a0: 206d 6574 6164 6174 6120 6973 2072 6574   metadata is ret
+000139b0: 7572 6e65 642e 2054 6869 730a 2020 2020  urned. This.    
+000139c0: 2020 2020 2020 2020 6361 6e20 6265 2075          can be u
+000139d0: 7365 6420 746f 2073 6176 6520 7265 736f  sed to save reso
+000139e0: 7572 6365 732e 0a20 2020 2020 2020 203a  urces..        :
+000139f0: 7479 7065 2073 696c 656e 743a 2062 6f6f  type silent: boo
+00013a00: 6c0a 2020 2020 2020 2020 3a70 6172 616d  l.        :param
+00013a10: 2072 6566 696c 6c5f 696e 6465 785f 6361   refill_index_ca
+00013a20: 6368 6573 3a20 5768 6574 6865 7220 746f  ches: Whether to
+00013a30: 2061 6464 206e 6577 2065 6e74 7269 6573   add new entries
+00013a40: 2074 6f20 696e 2d6d 656d 6f72 790a 2020   to in-memory.  
+00013a50: 2020 2020 2020 2020 2020 696e 6465 7820            index 
+00013a60: 6361 6368 6573 2069 6620 646f 6375 6d65  caches if docume
+00013a70: 6e74 206f 7065 7261 7469 6f6e 7320 6166  nt operations af
+00013a80: 6665 6374 2074 6865 2065 6467 6520 696e  fect the edge in
+00013a90: 6465 7820 6f72 0a20 2020 2020 2020 2020  dex or.         
+00013aa0: 2020 2063 6163 6865 2d65 6e61 626c 6564     cache-enabled
+00013ab0: 2070 6572 7369 7374 656e 7420 696e 6465   persistent inde
+00013ac0: 7865 732e 0a20 2020 2020 2020 203a 7479  xes..        :ty
+00013ad0: 7065 2072 6566 696c 6c5f 696e 6465 785f  pe refill_index_
+00013ae0: 6361 6368 6573 3a20 626f 6f6c 207c 204e  caches: bool | N
+00013af0: 6f6e 650a 2020 2020 2020 2020 3a70 6172  one.        :par
+00013b00: 616d 2076 6572 7369 6f6e 5f61 7474 7269  am version_attri
+00013b10: 6275 7465 3a20 7375 7070 6f72 7420 666f  bute: support fo
+00013b20: 7220 7369 6d70 6c65 2065 7874 6572 6e61  r simple externa
+00013b30: 6c20 7665 7273 696f 6e69 6e67 2074 6f0a  l versioning to.
+00013b40: 2020 2020 2020 2020 2020 2020 646f 6375              docu
+00013b50: 6d65 6e74 206f 7065 7261 7469 6f6e 732e  ment operations.
+00013b60: 0a20 2020 2020 2020 203a 7479 7065 2076  .        :type v
+00013b70: 6572 7369 6f6e 5f61 7474 7269 6275 7465  ersion_attribute
+00013b80: 3a20 7374 720a 2020 2020 2020 2020 3a72  : str.        :r
+00013b90: 6574 7572 6e3a 204c 6973 7420 6f66 2064  eturn: List of d
+00013ba0: 6f63 756d 656e 7420 6d65 7461 6461 7461  ocument metadata
+00013bb0: 2028 652e 672e 2064 6f63 756d 656e 7420   (e.g. document 
+00013bc0: 6b65 7973 2c20 7265 7669 7369 6f6e 7329  keys, revisions)
+00013bd0: 2061 6e64 0a20 2020 2020 2020 2020 2020   and.           
+00013be0: 2061 6e79 2065 7863 6570 7469 6f6e 732c   any exceptions,
+00013bf0: 206f 7220 5472 7565 2069 6620 7061 7261   or True if para
+00013c00: 6d65 7465 7220 2a2a 7369 6c65 6e74 2a2a  meter **silent**
+00013c10: 2077 6173 2073 6574 2074 6f20 5472 7565   was set to True
+00013c20: 2e0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
+00013c30: 3a20 5b64 6963 7420 7c20 4172 616e 676f  : [dict | Arango
+00013c40: 5365 7276 6572 4572 726f 725d 207c 2062  ServerError] | b
+00013c50: 6f6f 6c0a 2020 2020 2020 2020 3a72 6169  ool.        :rai
+00013c60: 7365 2061 7261 6e67 6f2e 6578 6365 7074  se arango.except
+00013c70: 696f 6e73 2e44 6f63 756d 656e 7452 6570  ions.DocumentRep
+00013c80: 6c61 6365 4572 726f 723a 2049 6620 7265  laceError: If re
+00013c90: 706c 6163 6520 6661 696c 732e 0a20 2020  place fails..   
+00013ca0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00013cb0: 2070 6172 616d 733a 2050 6172 616d 7320   params: Params 
+00013cc0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+00013cd0: 2272 6574 7572 6e4e 6577 223a 2072 6574  "returnNew": ret
+00013ce0: 7572 6e5f 6e65 772c 0a20 2020 2020 2020  urn_new,.       
+00013cf0: 2020 2020 2022 7265 7475 726e 4f6c 6422       "returnOld"
+00013d00: 3a20 7265 7475 726e 5f6f 6c64 2c0a 2020  : return_old,.  
+00013d10: 2020 2020 2020 2020 2020 2269 676e 6f72            "ignor
+00013d20: 6552 6576 7322 3a20 6e6f 7420 6368 6563  eRevs": not chec
+00013d30: 6b5f 7265 762c 0a20 2020 2020 2020 2020  k_rev,.         
+00013d40: 2020 2022 6f76 6572 7772 6974 6522 3a20     "overwrite": 
+00013d50: 6e6f 7420 6368 6563 6b5f 7265 762c 0a20  not check_rev,. 
+00013d60: 2020 2020 2020 2020 2020 2022 7369 6c65             "sile
+00013d70: 6e74 223a 2073 696c 656e 742c 0a20 2020  nt": silent,.   
+00013d80: 2020 2020 207d 0a20 2020 2020 2020 2069       }.        i
+00013d90: 6620 7379 6e63 2069 7320 6e6f 7420 4e6f  f sync is not No
+00013da0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00013db0: 7061 7261 6d73 5b22 7761 6974 466f 7253  params["waitForS
+00013dc0: 796e 6322 5d20 3d20 7379 6e63 0a20 2020  ync"] = sync.   
+00013dd0: 2020 2020 2069 6620 7665 7273 696f 6e5f       if version_
+00013de0: 6174 7472 6962 7574 6520 6973 206e 6f74  attribute is not
+00013df0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00013e00: 2020 2070 6172 616d 735b 2276 6572 7369     params["versi
+00013e10: 6f6e 4174 7472 6962 7574 6522 5d20 3d20  onAttribute"] = 
+00013e20: 7665 7273 696f 6e5f 6174 7472 6962 7574  version_attribut
+00013e30: 650a 0a20 2020 2020 2020 2023 204e 6577  e..        # New
+00013e40: 2069 6e20 4172 616e 676f 4442 2033 2e39   in ArangoDB 3.9
+00013e50: 2e36 2061 6e64 2033 2e31 302e 320a 2020  .6 and 3.10.2.  
+00013e60: 2020 2020 2020 6966 2072 6566 696c 6c5f        if refill_
+00013e70: 696e 6465 785f 6361 6368 6573 2069 7320  index_caches is 
+00013e80: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00013e90: 2020 2020 2020 7061 7261 6d73 5b22 7265        params["re
+00013ea0: 6669 6c6c 496e 6465 7843 6163 6865 7322  fillIndexCaches"
+00013eb0: 5d20 3d20 7265 6669 6c6c 5f69 6e64 6578  ] = refill_index
+00013ec0: 5f63 6163 6865 730a 0a20 2020 2020 2020  _caches..       
+00013ed0: 2064 6f63 756d 656e 7473 203d 205b 7365   documents = [se
+00013ee0: 6c66 2e5f 656e 7375 7265 5f6b 6579 5f69  lf._ensure_key_i
+00013ef0: 6e5f 626f 6479 2864 6f63 2920 666f 7220  n_body(doc) for 
+00013f00: 646f 6320 696e 2064 6f63 756d 656e 7473  doc in documents
+00013f10: 5d0a 0a20 2020 2020 2020 2072 6571 7565  ]..        reque
+00013f20: 7374 203d 2052 6571 7565 7374 280a 2020  st = Request(.  
+00013f30: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+00013f40: 3d22 7075 7422 2c0a 2020 2020 2020 2020  ="put",.        
+00013f50: 2020 2020 656e 6470 6f69 6e74 3d66 222f      endpoint=f"/
+00013f60: 5f61 7069 2f64 6f63 756d 656e 742f 7b73  _api/document/{s
+00013f70: 656c 662e 6e61 6d65 7d22 2c0a 2020 2020  elf.name}",.    
+00013f80: 2020 2020 2020 2020 7061 7261 6d73 3d70          params=p
+00013f90: 6172 616d 732c 0a20 2020 2020 2020 2020  arams,.         
+00013fa0: 2020 2064 6174 613d 646f 6375 6d65 6e74     data=document
+00013fb0: 732c 0a20 2020 2020 2020 2020 2020 2077  s,.            w
+00013fc0: 7269 7465 3d73 656c 662e 6e61 6d65 2c0a  rite=self.name,.
+00013fd0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00013fe0: 2020 2064 6566 2072 6573 706f 6e73 655f     def response_
+00013ff0: 6861 6e64 6c65 7228 0a20 2020 2020 2020  handler(.       
+00014000: 2020 2020 2072 6573 703a 2052 6573 706f       resp: Respo
+00014010: 6e73 652c 0a20 2020 2020 2020 2029 202d  nse,.        ) -
+00014020: 3e20 556e 696f 6e5b 626f 6f6c 2c20 4c69  > Union[bool, Li
+00014030: 7374 5b55 6e69 6f6e 5b4a 736f 6e2c 2041  st[Union[Json, A
+00014040: 7261 6e67 6f53 6572 7665 7245 7272 6f72  rangoServerError
+00014050: 5d5d 5d3a 0a20 2020 2020 2020 2020 2020  ]]]:.           
+00014060: 2069 6620 6e6f 7420 7265 7370 2e69 735f   if not resp.is_
+00014070: 7375 6363 6573 733a 0a20 2020 2020 2020  success:.       
+00014080: 2020 2020 2020 2020 2072 6169 7365 2044           raise D
+00014090: 6f63 756d 656e 7452 6570 6c61 6365 4572  ocumentReplaceEr
+000140a0: 726f 7228 7265 7370 2c20 7265 7175 6573  ror(resp, reques
+000140b0: 7429 0a20 2020 2020 2020 2020 2020 2069  t).            i
+000140c0: 6620 7369 6c65 6e74 2069 7320 5472 7565  f silent is True
+000140d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000140e0: 2020 7265 7475 726e 2054 7275 650a 0a20    return True.. 
+000140f0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00014100: 7473 3a20 4c69 7374 5b55 6e69 6f6e 5b4a  ts: List[Union[J
+00014110: 736f 6e2c 2041 7261 6e67 6f53 6572 7665  son, ArangoServe
+00014120: 7245 7272 6f72 5d5d 203d 205b 5d0a 2020  rError]] = [].  
+00014130: 2020 2020 2020 2020 2020 666f 7220 626f            for bo
+00014140: 6479 2069 6e20 7265 7370 2e62 6f64 793a  dy in resp.body:
+00014150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014160: 2069 6620 225f 6964 2220 696e 2062 6f64   if "_id" in bod
+00014170: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+00014180: 2020 2020 2020 2062 6f64 795b 225f 6f6c         body["_ol
+00014190: 645f 7265 7622 5d20 3d20 626f 6479 2e70  d_rev"] = body.p
+000141a0: 6f70 2822 5f6f 6c64 5265 7622 290a 2020  op("_oldRev").  
+000141b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000141c0: 2020 7265 7375 6c74 732e 6170 7065 6e64    results.append
+000141d0: 2862 6f64 7929 0a20 2020 2020 2020 2020  (body).         
+000141e0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000141f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014200: 2073 7562 5f72 6573 7020 3d20 7365 6c66   sub_resp = self
+00014210: 2e5f 636f 6e6e 2e70 7265 705f 6275 6c6b  ._conn.prep_bulk
+00014220: 5f65 7272 5f72 6573 706f 6e73 6528 7265  _err_response(re
+00014230: 7370 2c20 626f 6479 290a 0a20 2020 2020  sp, body)..     
+00014240: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00014250: 7272 6f72 3a20 4172 616e 676f 5365 7276  rror: ArangoServ
+00014260: 6572 4572 726f 720a 2020 2020 2020 2020  erError.        
+00014270: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00014280: 7562 5f72 6573 702e 6572 726f 725f 636f  ub_resp.error_co
+00014290: 6465 203d 3d20 3132 3030 3a0a 2020 2020  de == 1200:.    
+000142a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000142b0: 2020 2020 6572 726f 7220 3d20 446f 6375      error = Docu
+000142c0: 6d65 6e74 5265 7669 7369 6f6e 4572 726f  mentRevisionErro
+000142d0: 7228 7375 625f 7265 7370 2c20 7265 7175  r(sub_resp, requ
+000142e0: 6573 7429 0a20 2020 2020 2020 2020 2020  est).           
+000142f0: 2020 2020 2020 2020 2065 6c73 653a 2020           else:  
+00014300: 2320 7072 6167 6d61 3a20 6e6f 2063 6f76  # pragma: no cov
+00014310: 6572 0a20 2020 2020 2020 2020 2020 2020  er.             
+00014320: 2020 2020 2020 2020 2020 2065 7272 6f72             error
+00014330: 203d 2044 6f63 756d 656e 7452 6570 6c61   = DocumentRepla
+00014340: 6365 4572 726f 7228 7375 625f 7265 7370  ceError(sub_resp
+00014350: 2c20 7265 7175 6573 7429 0a0a 2020 2020  , request)..    
+00014360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014370: 7265 7375 6c74 732e 6170 7065 6e64 2865  results.append(e
+00014380: 7272 6f72 290a 0a20 2020 2020 2020 2020  rror)..         
+00014390: 2020 2072 6574 7572 6e20 7265 7375 6c74     return result
+000143a0: 730a 0a20 2020 2020 2020 2072 6574 7572  s..        retur
+000143b0: 6e20 7365 6c66 2e5f 6578 6563 7574 6528  n self._execute(
+000143c0: 7265 7175 6573 742c 2072 6573 706f 6e73  request, respons
+000143d0: 655f 6861 6e64 6c65 7229 0a0a 2020 2020  e_handler)..    
+000143e0: 6465 6620 7265 706c 6163 655f 6d61 7463  def replace_matc
+000143f0: 6828 0a20 2020 2020 2020 2073 656c 662c  h(.        self,
+00014400: 0a20 2020 2020 2020 2066 696c 7465 7273  .        filters
+00014410: 3a20 4a73 6f6e 2c0a 2020 2020 2020 2020  : Json,.        
+00014420: 626f 6479 3a20 4a73 6f6e 2c0a 2020 2020  body: Json,.    
+00014430: 2020 2020 6c69 6d69 743a 204f 7074 696f      limit: Optio
+00014440: 6e61 6c5b 696e 745d 203d 204e 6f6e 652c  nal[int] = None,
+00014450: 0a20 2020 2020 2020 2073 796e 633a 204f  .        sync: O
+00014460: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
+00014470: 4e6f 6e65 2c0a 2020 2020 2020 2020 616c  None,.        al
+00014480: 6c6f 775f 6469 7274 795f 7265 6164 3a20  low_dirty_read: 
+00014490: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+000144a0: 2020 2920 2d3e 2052 6573 756c 745b 696e    ) -> Result[in
+000144b0: 745d 3a0a 2020 2020 2020 2020 2222 2252  t]:.        """R
+000144c0: 6570 6c61 6365 206d 6174 6368 696e 6720  eplace matching 
+000144d0: 646f 6375 6d65 6e74 732e 0a0a 2020 2020  documents...    
+000144e0: 2020 2020 2e2e 206e 6f74 653a 3a0a 0a20      .. note::.. 
+000144f0: 2020 2020 2020 2020 2020 2049 6e20 6564             In ed
+00014500: 6765 2f76 6572 7465 7820 636f 6c6c 6563  ge/vertex collec
+00014510: 7469 6f6e 732c 2074 6869 7320 6d65 7468  tions, this meth
+00014520: 6f64 2064 6f65 7320 4e4f 5420 7072 6f76  od does NOT prov
+00014530: 6964 6520 7468 650a 2020 2020 2020 2020  ide the.        
+00014540: 2020 2020 7472 616e 7361 6374 696f 6e61      transactiona
+00014550: 6c20 6775 6172 616e 7465 6573 2061 6e64  l guarantees and
+00014560: 2076 616c 6964 6174 696f 6e73 2074 6861   validations tha
+00014570: 7420 7369 6e67 6c65 2072 6570 6c61 6365  t single replace
+00014580: 0a20 2020 2020 2020 2020 2020 206f 7065  .            ope
+00014590: 7261 7469 6f6e 2064 6f65 7320 666f 7220  ration does for 
+000145a0: 6772 6170 6873 2e20 4966 2074 6865 7365  graphs. If these
+000145b0: 2070 726f 7065 7274 6965 7320 6172 6520   properties are 
+000145c0: 7265 7175 6972 6564 2c20 7365 650a 2020  required, see.  
+000145d0: 2020 2020 2020 2020 2020 3a66 756e 633a            :func:
+000145e0: 6061 7261 6e67 6f2e 6461 7461 6261 7365  `arango.database
+000145f0: 2e53 7461 6e64 6172 6444 6174 6162 6173  .StandardDatabas
+00014600: 652e 6265 6769 6e5f 6261 7463 685f 6578  e.begin_batch_ex
+00014610: 6563 7574 696f 6e60 0a20 2020 2020 2020  ecution`.       
+00014620: 2020 2020 2066 6f72 2061 6e20 616c 7465       for an alte
+00014630: 726e 6174 6976 6520 6170 7072 6f61 6368  rnative approach
+00014640: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+00014650: 6d20 6669 6c74 6572 733a 2044 6f63 756d  m filters: Docum
+00014660: 656e 7420 6669 6c74 6572 732e 0a20 2020  ent filters..   
+00014670: 2020 2020 203a 7479 7065 2066 696c 7465       :type filte
+00014680: 7273 3a20 6469 6374 0a20 2020 2020 2020  rs: dict.       
+00014690: 203a 7061 7261 6d20 626f 6479 3a20 4e65   :param body: Ne
+000146a0: 7720 646f 6375 6d65 6e74 2062 6f64 792e  w document body.
+000146b0: 0a20 2020 2020 2020 203a 7479 7065 2062  .        :type b
+000146c0: 6f64 793a 2064 6963 740a 2020 2020 2020  ody: dict.      
+000146d0: 2020 3a70 6172 616d 206c 696d 6974 3a20    :param limit: 
+000146e0: 4d61 7820 6e75 6d62 6572 206f 6620 646f  Max number of do
+000146f0: 6375 6d65 6e74 7320 746f 2072 6570 6c61  cuments to repla
+00014700: 6365 2e20 4966 2074 6865 206c 696d 6974  ce. If the limit
+00014710: 2069 7320 6c6f 7765 720a 2020 2020 2020   is lower.      
+00014720: 2020 2020 2020 7468 616e 2074 6865 206e        than the n
+00014730: 756d 6265 7220 6f66 206d 6174 6368 6564  umber of matched
+00014740: 2064 6f63 756d 656e 7473 2c20 7261 6e64   documents, rand
+00014750: 6f6d 2064 6f63 756d 656e 7473 2061 7265  om documents are
+00014760: 2063 686f 7365 6e2e 0a20 2020 2020 2020   chosen..       
+00014770: 203a 7479 7065 206c 696d 6974 3a20 696e   :type limit: in
+00014780: 7420 7c20 4e6f 6e65 0a20 2020 2020 2020  t | None.       
+00014790: 203a 7061 7261 6d20 7379 6e63 3a20 426c   :param sync: Bl
+000147a0: 6f63 6b20 756e 7469 6c20 6f70 6572 6174  ock until operat
+000147b0: 696f 6e20 6973 2073 796e 6368 726f 6e69  ion is synchroni
+000147c0: 7a65 6420 746f 2064 6973 6b2e 0a20 2020  zed to disk..   
+000147d0: 2020 2020 203a 7479 7065 2073 796e 633a       :type sync:
+000147e0: 2062 6f6f 6c20 7c20 4e6f 6e65 0a20 2020   bool | None.   
+000147f0: 2020 2020 203a 7061 7261 6d20 616c 6c6f       :param allo
+00014800: 775f 6469 7274 795f 7265 6164 3a20 416c  w_dirty_read: Al
+00014810: 6c6f 7720 7265 6164 7320 6672 6f6d 2066  low reads from f
+00014820: 6f6c 6c6f 7765 7273 2069 6e20 6120 636c  ollowers in a cl
+00014830: 7573 7465 722e 0a20 2020 2020 2020 203a  uster..        :
+00014840: 7479 7065 2061 6c6c 6f77 5f64 6972 7479  type allow_dirty
+00014850: 5f72 6561 643a 2062 6f6f 6c0a 2020 2020  _read: bool.    
+00014860: 2020 2020 3a72 6574 7572 6e3a 204e 756d      :return: Num
+00014870: 6265 7220 6f66 2064 6f63 756d 656e 7473  ber of documents
+00014880: 2072 6570 6c61 6365 642e 0a20 2020 2020   replaced..     
+00014890: 2020 203a 7274 7970 653a 2069 6e74 0a20     :rtype: int. 
+000148a0: 2020 2020 2020 203a 7261 6973 6520 6172         :raise ar
+000148b0: 616e 676f 2e65 7863 6570 7469 6f6e 732e  ango.exceptions.
+000148c0: 446f 6375 6d65 6e74 5265 706c 6163 6545  DocumentReplaceE
+000148d0: 7272 6f72 3a20 4966 2072 6570 6c61 6365  rror: If replace
+000148e0: 2066 6169 6c73 2e0a 2020 2020 2020 2020   fails..        
+000148f0: 2222 220a 2020 2020 2020 2020 6173 7365  """.        asse
+00014900: 7274 2069 7369 6e73 7461 6e63 6528 6669  rt isinstance(fi
+00014910: 6c74 6572 732c 2064 6963 7429 2c20 2266  lters, dict), "f
+00014920: 696c 7465 7273 206d 7573 7420 6265 2061  ilters must be a
+00014930: 2064 6963 7422 0a20 2020 2020 2020 2061   dict".        a
+00014940: 7373 6572 7420 6973 5f6e 6f6e 655f 6f72  ssert is_none_or
+00014950: 5f69 6e74 286c 696d 6974 292c 2022 6c69  _int(limit), "li
+00014960: 6d69 7420 6d75 7374 2062 6520 6120 6e6f  mit must be a no
+00014970: 6e2d 6e65 6761 7469 7665 2069 6e74 220a  n-negative int".
+00014980: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00014990: 735f 6e6f 6e65 5f6f 725f 626f 6f6c 2873  s_none_or_bool(s
+000149a0: 796e 6329 2c20 2273 796e 6320 6d75 7374  ync), "sync must
+000149b0: 2062 6520 4e6f 6e65 206f 7220 6120 626f   be None or a bo
+000149c0: 6f6c 220a 0a20 2020 2020 2020 2023 2049  ol"..        # I
+000149d0: 6620 7468 6520 7761 6974 466f 7253 796e  f the waitForSyn
+000149e0: 6320 7061 7261 6d65 7465 7220 6973 206e  c parameter is n
+000149f0: 6f74 2073 7065 6369 6669 6564 206f 7220  ot specified or 
+00014a00: 7365 7420 746f 2066 616c 7365 2c0a 2020  set to false,.  
+00014a10: 2020 2020 2020 2320 7468 656e 2074 6865        # then the
+00014a20: 2063 6f6c 6c65 6374 696f 6ee2 8099 7320   collection...s 
+00014a30: 6465 6661 756c 7420 7761 6974 466f 7253  default waitForS
+00014a40: 796e 6320 6265 6861 7669 6f72 2069 7320  ync behavior is 
+00014a50: 6170 706c 6965 642e 0a20 2020 2020 2020  applied..       
+00014a60: 2073 796e 635f 7661 6c20 3d20 6622 7761   sync_val = f"wa
+00014a70: 6974 466f 7253 796e 633a 207b 7379 6e63  itForSync: {sync
+00014a80: 7d22 2069 6620 7379 6e63 2069 7320 6e6f  }" if sync is no
+00014a90: 7420 4e6f 6e65 2065 6c73 6520 2222 0a0a  t None else ""..
+00014aa0: 2020 2020 2020 2020 7175 6572 7920 3d20          query = 
+00014ab0: 6622 2222 0a20 2020 2020 2020 2020 2020  f""".           
+00014ac0: 2046 4f52 2064 6f63 2049 4e20 4040 636f   FOR doc IN @@co
+00014ad0: 6c6c 6563 7469 6f6e 0a20 2020 2020 2020  llection.       
+00014ae0: 2020 2020 2020 2020 207b 6275 696c 645f           {build_
+00014af0: 6669 6c74 6572 5f63 6f6e 6469 7469 6f6e  filter_condition
+00014b00: 7328 6669 6c74 6572 7329 7d0a 2020 2020  s(filters)}.    
+00014b10: 2020 2020 2020 2020 2020 2020 7b66 224c              {f"L
+00014b20: 494d 4954 207b 6c69 6d69 747d 2220 6966  IMIT {limit}" if
+00014b30: 206c 696d 6974 2069 7320 6e6f 7420 4e6f   limit is not No
+00014b40: 6e65 2065 6c73 6520 2222 7d0a 2020 2020  ne else ""}.    
+00014b50: 2020 2020 2020 2020 2020 2020 5245 504c              REPL
+00014b60: 4143 4520 646f 6320 5749 5448 2040 626f  ACE doc WITH @bo
+00014b70: 6479 2049 4e20 4040 636f 6c6c 6563 7469  dy IN @@collecti
+00014b80: 6f6e 0a20 2020 2020 2020 2020 2020 2020  on.             
+00014b90: 2020 207b 6622 4f50 5449 4f4e 5320 7b7b     {f"OPTIONS {{
+00014ba0: 207b 7379 6e63 5f76 616c 7d20 7d7d 2220   {sync_val} }}" 
+00014bb0: 6966 2073 796e 635f 7661 6c20 656c 7365  if sync_val else
+00014bc0: 2022 227d 0a20 2020 2020 2020 2022 2222   ""}.        """
+00014bd0: 2020 2320 6e6f 7161 3a20 4532 3031 2045    # noqa: E201 E
+00014be0: 3230 320a 0a20 2020 2020 2020 2062 696e  202..        bin
+00014bf0: 645f 7661 7273 203d 207b 2240 636f 6c6c  d_vars = {"@coll
+00014c00: 6563 7469 6f6e 223a 2073 656c 662e 6e61  ection": self.na
+00014c10: 6d65 2c20 2262 6f64 7922 3a20 626f 6479  me, "body": body
+00014c20: 7d0a 0a20 2020 2020 2020 2072 6571 7565  }..        reque
+00014c30: 7374 203d 2052 6571 7565 7374 280a 2020  st = Request(.  
+00014c40: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+00014c50: 3d22 706f 7374 222c 0a20 2020 2020 2020  ="post",.       
+00014c60: 2020 2020 2065 6e64 706f 696e 743d 222f       endpoint="/
+00014c70: 5f61 7069 2f63 7572 736f 7222 2c0a 2020  _api/cursor",.  
+00014c80: 2020 2020 2020 2020 2020 6461 7461 3d7b            data={
+00014c90: 2271 7565 7279 223a 2071 7565 7279 2c20  "query": query, 
+00014ca0: 2262 696e 6456 6172 7322 3a20 6269 6e64  "bindVars": bind
+00014cb0: 5f76 6172 737d 2c0a 2020 2020 2020 2020  _vars},.        
+00014cc0: 2020 2020 7772 6974 653d 7365 6c66 2e6e      write=self.n
+00014cd0: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
+00014ce0: 2068 6561 6465 7273 3d7b 2278 2d61 7261   headers={"x-ara
+00014cf0: 6e67 6f2d 616c 6c6f 772d 6469 7274 792d  ngo-allow-dirty-
+00014d00: 7265 6164 223a 2022 7472 7565 227d 2069  read": "true"} i
+00014d10: 6620 616c 6c6f 775f 6469 7274 795f 7265  f allow_dirty_re
+00014d20: 6164 2065 6c73 6520 4e6f 6e65 2c0a 2020  ad else None,.  
+00014d30: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00014d40: 2064 6566 2072 6573 706f 6e73 655f 6861   def response_ha
+00014d50: 6e64 6c65 7228 7265 7370 3a20 5265 7370  ndler(resp: Resp
+00014d60: 6f6e 7365 2920 2d3e 2069 6e74 3a0a 2020  onse) -> int:.  
+00014d70: 2020 2020 2020 2020 2020 6966 2072 6573            if res
+00014d80: 702e 6973 5f73 7563 6365 7373 3a0a 2020  p.is_success:.  
+00014d90: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00014da0: 7375 6c74 3a20 696e 7420 3d20 7265 7370  sult: int = resp
+00014db0: 2e62 6f64 795b 2265 7874 7261 225d 5b22  .body["extra"]["
+00014dc0: 7374 6174 7322 5d5b 2277 7269 7465 7345  stats"]["writesE
+00014dd0: 7865 6375 7465 6422 5d0a 2020 2020 2020  xecuted"].      
+00014de0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00014df0: 2072 6573 756c 740a 2020 2020 2020 2020   result.        
+00014e00: 2020 2020 7261 6973 6520 446f 6375 6d65      raise Docume
+00014e10: 6e74 5265 706c 6163 6545 7272 6f72 2872  ntReplaceError(r
+00014e20: 6573 702c 2072 6571 7565 7374 290a 0a20  esp, request).. 
+00014e30: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00014e40: 6c66 2e5f 6578 6563 7574 6528 7265 7175  lf._execute(requ
+00014e50: 6573 742c 2072 6573 706f 6e73 655f 6861  est, response_ha
+00014e60: 6e64 6c65 7229 0a0a 2020 2020 6465 6620  ndler)..    def 
+00014e70: 6465 6c65 7465 5f6d 616e 7928 0a20 2020  delete_many(.   
+00014e80: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00014e90: 2020 2064 6f63 756d 656e 7473 3a20 5365     documents: Se
+00014ea0: 7175 656e 6365 5b4a 736f 6e5d 2c0a 2020  quence[Json],.  
+00014eb0: 2020 2020 2020 7265 7475 726e 5f6f 6c64        return_old
+00014ec0: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
+00014ed0: 2020 2020 2020 2020 6368 6563 6b5f 7265          check_re
+00014ee0: 763a 2062 6f6f 6c20 3d20 5472 7565 2c0a  v: bool = True,.
+00014ef0: 2020 2020 2020 2020 7379 6e63 3a20 4f70          sync: Op
+00014f00: 7469 6f6e 616c 5b62 6f6f 6c5d 203d 204e  tional[bool] = N
+00014f10: 6f6e 652c 0a20 2020 2020 2020 2073 696c  one,.        sil
+00014f20: 656e 743a 2062 6f6f 6c20 3d20 4661 6c73  ent: bool = Fals
+00014f30: 652c 0a20 2020 2020 2020 2072 6566 696c  e,.        refil
+00014f40: 6c5f 696e 6465 785f 6361 6368 6573 3a20  l_index_caches: 
+00014f50: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 203d  Optional[bool] =
+00014f60: 204e 6f6e 652c 0a20 2020 2029 202d 3e20   None,.    ) -> 
+00014f70: 5265 7375 6c74 5b55 6e69 6f6e 5b62 6f6f  Result[Union[boo
+00014f80: 6c2c 204c 6973 745b 556e 696f 6e5b 4a73  l, List[Union[Js
+00014f90: 6f6e 2c20 4172 616e 676f 5365 7276 6572  on, ArangoServer
+00014fa0: 4572 726f 725d 5d5d 5d3a 0a20 2020 2020  Error]]]]:.     
+00014fb0: 2020 2022 2222 4465 6c65 7465 206d 756c     """Delete mul
+00014fc0: 7469 706c 6520 646f 6375 6d65 6e74 732e  tiple documents.
+00014fd0: 0a0a 2020 2020 2020 2020 2e2e 206e 6f74  ..        .. not
+00014fe0: 653a 3a0a 0a20 2020 2020 2020 2020 2020  e::..           
+00014ff0: 2049 6620 6465 6c65 7469 6e67 2061 2064   If deleting a d
+00015000: 6f63 756d 656e 7420 6661 696c 732c 2074  ocument fails, t
+00015010: 6865 2065 7863 6570 7469 6f6e 2069 7320  he exception is 
+00015020: 6e6f 7420 7261 6973 6564 2062 7574 0a20  not raised but. 
+00015030: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00015040: 6e65 6420 6173 2061 6e20 6f62 6a65 6374  ned as an object
+00015050: 2069 6e20 7468 6520 7265 7375 6c74 206c   in the result l
+00015060: 6973 742e 2049 7420 6973 2075 7020 746f  ist. It is up to
+00015070: 2079 6f75 2074 6f0a 2020 2020 2020 2020   you to.        
+00015080: 2020 2020 696e 7370 6563 7420 7468 6520      inspect the 
+00015090: 6c69 7374 2074 6f20 6465 7465 726d 696e  list to determin
+000150a0: 6520 7768 6963 6820 646f 6375 6d65 6e74  e which document
+000150b0: 7320 7765 7265 2064 656c 6574 6564 0a20  s were deleted. 
+000150c0: 2020 2020 2020 2020 2020 2073 7563 6365             succe
+000150d0: 7373 6675 6c6c 7920 2872 6574 7572 6e73  ssfully (returns
+000150e0: 2064 6f63 756d 656e 7420 6d65 7461 6461   document metada
+000150f0: 7461 2920 616e 6420 7768 6963 6820 7765  ta) and which we
+00015100: 7265 206e 6f74 0a20 2020 2020 2020 2020  re not.         
+00015110: 2020 2028 7265 7475 726e 7320 6578 6365     (returns exce
+00015120: 7074 696f 6e20 6f62 6a65 6374 292e 0a0a  ption object)...
+00015130: 2020 2020 2020 2020 2e2e 206e 6f74 653a          .. note:
+00015140: 3a0a 0a20 2020 2020 2020 2020 2020 2049  :..            I
+00015150: 6e20 6564 6765 2f76 6572 7465 7820 636f  n edge/vertex co
+00015160: 6c6c 6563 7469 6f6e 732c 2074 6869 7320  llections, this 
+00015170: 6d65 7468 6f64 2064 6f65 7320 4e4f 5420  method does NOT 
+00015180: 7072 6f76 6964 6520 7468 650a 2020 2020  provide the.    
+00015190: 2020 2020 2020 2020 7472 616e 7361 6374          transact
+000151a0: 696f 6e61 6c20 6775 6172 616e 7465 6573  ional guarantees
+000151b0: 2061 6e64 2076 616c 6964 6174 696f 6e73   and validations
+000151c0: 2074 6861 7420 7369 6e67 6c65 2064 656c   that single del
+000151d0: 6574 650a 2020 2020 2020 2020 2020 2020  ete.            
+000151e0: 6f70 6572 6174 696f 6e20 646f 6573 2066  operation does f
+000151f0: 6f72 2067 7261 7068 732e 2049 6620 7468  or graphs. If th
+00015200: 6573 6520 7072 6f70 6572 7469 6573 2061  ese properties a
+00015210: 7265 2072 6571 7569 7265 642c 2073 6565  re required, see
+00015220: 0a20 2020 2020 2020 2020 2020 203a 6675  .            :fu
+00015230: 6e63 3a60 6172 616e 676f 2e64 6174 6162  nc:`arango.datab
+00015240: 6173 652e 5374 616e 6461 7264 4461 7461  ase.StandardData
+00015250: 6261 7365 2e62 6567 696e 5f62 6174 6368  base.begin_batch
+00015260: 5f65 7865 6375 7469 6f6e 600a 2020 2020  _execution`.    
+00015270: 2020 2020 2020 2020 666f 7220 616e 2061          for an a
+00015280: 6c74 6572 6e61 7469 7665 2061 7070 726f  lternative appro
+00015290: 6163 682e 0a0a 2020 2020 2020 2020 3a70  ach...        :p
+000152a0: 6172 616d 2064 6f63 756d 656e 7473 3a20  aram documents: 
+000152b0: 446f 6375 6d65 6e74 2049 4473 2c20 6b65  Document IDs, ke
+000152c0: 7973 206f 7220 626f 6469 6573 2e20 446f  ys or bodies. Do
+000152d0: 6375 6d65 6e74 2062 6f64 6965 7320 6d75  cument bodies mu
+000152e0: 7374 0a20 2020 2020 2020 2020 2020 2063  st.            c
+000152f0: 6f6e 7461 696e 2074 6865 2022 5f69 6422  ontain the "_id"
+00015300: 206f 7220 225f 6b65 7922 2066 6965 6c64   or "_key" field
+00015310: 732e 0a20 2020 2020 2020 203a 7479 7065  s..        :type
+00015320: 2064 6f63 756d 656e 7473 3a20 5b73 7472   documents: [str
+00015330: 207c 2064 6963 745d 0a20 2020 2020 2020   | dict].       
+00015340: 203a 7061 7261 6d20 7265 7475 726e 5f6f   :param return_o
+00015350: 6c64 3a20 496e 636c 7564 6520 626f 6469  ld: Include bodi
+00015360: 6573 206f 6620 7468 6520 6f6c 6420 646f  es of the old do
+00015370: 6375 6d65 6e74 7320 696e 2074 6865 2072  cuments in the r
+00015380: 6573 756c 742e 0a20 2020 2020 2020 203a  esult..        :
+00015390: 7479 7065 2072 6574 7572 6e5f 6f6c 643a  type return_old:
+000153a0: 2062 6f6f 6c0a 2020 2020 2020 2020 3a70   bool.        :p
+000153b0: 6172 616d 2063 6865 636b 5f72 6576 3a20  aram check_rev: 
+000153c0: 4966 2073 6574 2074 6f20 5472 7565 2c20  If set to True, 
+000153d0: 7265 7669 7369 6f6e 7320 6f66 202a 2a64  revisions of **d
+000153e0: 6f63 756d 656e 7473 2a2a 2028 6966 2067  ocuments** (if g
+000153f0: 6976 656e 290a 2020 2020 2020 2020 2020  iven).          
+00015400: 2020 6172 6520 636f 6d70 6172 6564 2061    are compared a
+00015410: 6761 696e 7374 2074 6865 2072 6576 6973  gainst the revis
+00015420: 696f 6e73 206f 6620 7461 7267 6574 2064  ions of target d
+00015430: 6f63 756d 656e 7473 2e0a 2020 2020 2020  ocuments..      
+00015440: 2020 3a74 7970 6520 6368 6563 6b5f 7265    :type check_re
+00015450: 763a 2062 6f6f 6c0a 2020 2020 2020 2020  v: bool.        
+00015460: 3a70 6172 616d 2073 796e 633a 2042 6c6f  :param sync: Blo
+00015470: 636b 2075 6e74 696c 206f 7065 7261 7469  ck until operati
+00015480: 6f6e 2069 7320 7379 6e63 6872 6f6e 697a  on is synchroniz
+00015490: 6564 2074 6f20 6469 736b 2e0a 2020 2020  ed to disk..    
+000154a0: 2020 2020 3a74 7970 6520 7379 6e63 3a20      :type sync: 
+000154b0: 626f 6f6c 207c 204e 6f6e 650a 2020 2020  bool | None.    
+000154c0: 2020 2020 3a70 6172 616d 2073 696c 656e      :param silen
+000154d0: 743a 2049 6620 7365 7420 746f 2054 7275  t: If set to Tru
+000154e0: 652c 206e 6f20 646f 6375 6d65 6e74 206d  e, no document m
+000154f0: 6574 6164 6174 6120 6973 2072 6574 7572  etadata is retur
+00015500: 6e65 642e 2054 6869 730a 2020 2020 2020  ned. This.      
+00015510: 2020 2020 2020 6361 6e20 6265 2075 7365        can be use
+00015520: 6420 746f 2073 6176 6520 7265 736f 7572  d to save resour
+00015530: 6365 732e 0a20 2020 2020 2020 203a 7479  ces..        :ty
+00015540: 7065 2073 696c 656e 743a 2062 6f6f 6c0a  pe silent: bool.
+00015550: 2020 2020 2020 2020 3a70 6172 616d 2072          :param r
+00015560: 6566 696c 6c5f 696e 6465 785f 6361 6368  efill_index_cach
+00015570: 6573 3a20 5768 6574 6865 7220 746f 2061  es: Whether to a
+00015580: 6464 206e 6577 2065 6e74 7269 6573 2074  dd new entries t
+00015590: 6f20 696e 2d6d 656d 6f72 790a 2020 2020  o in-memory.    
+000155a0: 2020 2020 2020 2020 696e 6465 7820 6361          index ca
+000155b0: 6368 6573 2069 6620 646f 6375 6d65 6e74  ches if document
+000155c0: 206f 7065 7261 7469 6f6e 7320 6166 6665   operations affe
+000155d0: 6374 2074 6865 2065 6467 6520 696e 6465  ct the edge inde
+000155e0: 7820 6f72 0a20 2020 2020 2020 2020 2020  x or.           
+000155f0: 2063 6163 6865 2d65 6e61 626c 6564 2070   cache-enabled p
+00015600: 6572 7369 7374 656e 7420 696e 6465 7865  ersistent indexe
+00015610: 732e 0a20 2020 2020 2020 203a 7479 7065  s..        :type
+00015620: 2072 6566 696c 6c5f 696e 6465 785f 6361   refill_index_ca
+00015630: 6368 6573 3a20 626f 6f6c 207c 204e 6f6e  ches: bool | Non
+00015640: 650a 2020 2020 2020 2020 3a72 6574 7572  e.        :retur
+00015650: 6e3a 204c 6973 7420 6f66 2064 6f63 756d  n: List of docum
+00015660: 656e 7420 6d65 7461 6461 7461 2028 652e  ent metadata (e.
+00015670: 672e 2064 6f63 756d 656e 7420 6b65 7973  g. document keys
+00015680: 2c20 7265 7669 7369 6f6e 7329 2061 6e64  , revisions) and
+00015690: 0a20 2020 2020 2020 2020 2020 2061 6e79  .            any
+000156a0: 2065 7863 6570 7469 6f6e 732c 206f 7220   exceptions, or 
+000156b0: 5472 7565 2069 6620 7061 7261 6d65 7465  True if paramete
+000156c0: 7220 2a2a 7369 6c65 6e74 2a2a 2077 6173  r **silent** was
+000156d0: 2073 6574 2074 6f20 5472 7565 2e0a 2020   set to True..  
+000156e0: 2020 2020 2020 3a72 7479 7065 3a20 5b64        :rtype: [d
+000156f0: 6963 7420 7c20 4172 616e 676f 5365 7276  ict | ArangoServ
+00015700: 6572 4572 726f 725d 207c 2062 6f6f 6c0a  erError] | bool.
+00015710: 2020 2020 2020 2020 3a72 6169 7365 2061          :raise a
+00015720: 7261 6e67 6f2e 6578 6365 7074 696f 6e73  rango.exceptions
+00015730: 2e44 6f63 756d 656e 7444 656c 6574 6545  .DocumentDeleteE
+00015740: 7272 6f72 3a20 4966 2064 656c 6574 6520  rror: If delete 
+00015750: 6661 696c 732e 0a20 2020 2020 2020 2022  fails..        "
+00015760: 2222 0a20 2020 2020 2020 2070 6172 616d  "".        param
+00015770: 733a 2050 6172 616d 7320 3d20 7b0a 2020  s: Params = {.  
+00015780: 2020 2020 2020 2020 2020 2272 6574 7572            "retur
+00015790: 6e4f 6c64 223a 2072 6574 7572 6e5f 6f6c  nOld": return_ol
+000157a0: 642c 0a20 2020 2020 2020 2020 2020 2022  d,.            "
+000157b0: 6967 6e6f 7265 5265 7673 223a 206e 6f74  ignoreRevs": not
+000157c0: 2063 6865 636b 5f72 6576 2c0a 2020 2020   check_rev,.    
+000157d0: 2020 2020 2020 2020 226f 7665 7277 7269          "overwri
+000157e0: 7465 223a 206e 6f74 2063 6865 636b 5f72  te": not check_r
+000157f0: 6576 2c0a 2020 2020 2020 2020 2020 2020  ev,.            
+00015800: 2273 696c 656e 7422 3a20 7369 6c65 6e74  "silent": silent
+00015810: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
+00015820: 2020 2020 6966 2073 796e 6320 6973 206e      if sync is n
+00015830: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+00015840: 2020 2020 2070 6172 616d 735b 2277 6169       params["wai
+00015850: 7446 6f72 5379 6e63 225d 203d 2073 796e  tForSync"] = syn
+00015860: 630a 0a20 2020 2020 2020 2023 204e 6577  c..        # New
+00015870: 2069 6e20 4172 616e 676f 4442 2033 2e39   in ArangoDB 3.9
+00015880: 2e36 2061 6e64 2033 2e31 302e 320a 2020  .6 and 3.10.2.  
+00015890: 2020 2020 2020 6966 2072 6566 696c 6c5f        if refill_
+000158a0: 696e 6465 785f 6361 6368 6573 2069 7320  index_caches is 
+000158b0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+000158c0: 2020 2020 2020 7061 7261 6d73 5b22 7265        params["re
+000158d0: 6669 6c6c 4361 6368 6573 225d 203d 2072  fillCaches"] = r
+000158e0: 6566 696c 6c5f 696e 6465 785f 6361 6368  efill_index_cach
+000158f0: 6573 0a0a 2020 2020 2020 2020 646f 6375  es..        docu
+00015900: 6d65 6e74 7320 3d20 5b0a 2020 2020 2020  ments = [.      
+00015910: 2020 2020 2020 7365 6c66 2e5f 656e 7375        self._ensu
+00015920: 7265 5f6b 6579 5f69 6e5f 626f 6479 2864  re_key_in_body(d
+00015930: 6f63 2920 6966 2069 7369 6e73 7461 6e63  oc) if isinstanc
+00015940: 6528 646f 632c 2064 6963 7429 2065 6c73  e(doc, dict) els
+00015950: 6520 646f 630a 2020 2020 2020 2020 2020  e doc.          
+00015960: 2020 666f 7220 646f 6320 696e 2064 6f63    for doc in doc
+00015970: 756d 656e 7473 0a20 2020 2020 2020 205d  uments.        ]
+00015980: 0a0a 2020 2020 2020 2020 7265 7175 6573  ..        reques
+00015990: 7420 3d20 5265 7175 6573 7428 0a20 2020  t = Request(.   
+000159a0: 2020 2020 2020 2020 206d 6574 686f 643d           method=
+000159b0: 2264 656c 6574 6522 2c0a 2020 2020 2020  "delete",.      
+000159c0: 2020 2020 2020 656e 6470 6f69 6e74 3d66        endpoint=f
+000159d0: 222f 5f61 7069 2f64 6f63 756d 656e 742f  "/_api/document/
+000159e0: 7b73 656c 662e 6e61 6d65 7d22 2c0a 2020  {self.name}",.  
+000159f0: 2020 2020 2020 2020 2020 7061 7261 6d73            params
+00015a00: 3d70 6172 616d 732c 0a20 2020 2020 2020  =params,.       
+00015a10: 2020 2020 2064 6174 613d 646f 6375 6d65       data=docume
+00015a20: 6e74 732c 0a20 2020 2020 2020 2020 2020  nts,.           
+00015a30: 2077 7269 7465 3d73 656c 662e 6e61 6d65   write=self.name
+00015a40: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+00015a50: 2020 2020 2064 6566 2072 6573 706f 6e73       def respons
+00015a60: 655f 6861 6e64 6c65 7228 0a20 2020 2020  e_handler(.     
+00015a70: 2020 2020 2020 2072 6573 703a 2052 6573         resp: Res
+00015a80: 706f 6e73 652c 0a20 2020 2020 2020 2029  ponse,.        )
+00015a90: 202d 3e20 556e 696f 6e5b 626f 6f6c 2c20   -> Union[bool, 
+00015aa0: 4c69 7374 5b55 6e69 6f6e 5b4a 736f 6e2c  List[Union[Json,
+00015ab0: 2041 7261 6e67 6f53 6572 7665 7245 7272   ArangoServerErr
+00015ac0: 6f72 5d5d 5d3a 0a20 2020 2020 2020 2020  or]]]:.         
+00015ad0: 2020 2069 6620 6e6f 7420 7265 7370 2e69     if not resp.i
+00015ae0: 735f 7375 6363 6573 733a 0a20 2020 2020  s_success:.     
+00015af0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00015b00: 2044 6f63 756d 656e 7444 656c 6574 6545   DocumentDeleteE
+00015b10: 7272 6f72 2872 6573 702c 2072 6571 7565  rror(resp, reque
+00015b20: 7374 290a 2020 2020 2020 2020 2020 2020  st).            
+00015b30: 6966 2073 696c 656e 7420 6973 2054 7275  if silent is Tru
+00015b40: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00015b50: 2020 2072 6574 7572 6e20 5472 7565 0a0a     return True..
+00015b60: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+00015b70: 6c74 733a 204c 6973 745b 556e 696f 6e5b  lts: List[Union[
+00015b80: 4a73 6f6e 2c20 4172 616e 676f 5365 7276  Json, ArangoServ
+00015b90: 6572 4572 726f 725d 5d20 3d20 5b5d 0a20  erError]] = []. 
+00015ba0: 2020 2020 2020 2020 2020 2066 6f72 2062             for b
+00015bb0: 6f64 7920 696e 2072 6573 702e 626f 6479  ody in resp.body
+00015bc0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00015bd0: 2020 6966 2022 5f69 6422 2069 6e20 626f    if "_id" in bo
+00015be0: 6479 3a0a 2020 2020 2020 2020 2020 2020  dy:.            
+00015bf0: 2020 2020 2020 2020 7265 7375 6c74 732e          results.
+00015c00: 6170 7065 6e64 2862 6f64 7929 0a20 2020  append(body).   
+00015c10: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00015c20: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00015c30: 2020 2020 2020 2073 7562 5f72 6573 7020         sub_resp 
+00015c40: 3d20 7365 6c66 2e5f 636f 6e6e 2e70 7265  = self._conn.pre
+00015c50: 705f 6275 6c6b 5f65 7272 5f72 6573 706f  p_bulk_err_respo
+00015c60: 6e73 6528 7265 7370 2c20 626f 6479 290a  nse(resp, body).
+00015c70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015c80: 2020 2020 2065 7272 6f72 3a20 4172 616e       error: Aran
+00015c90: 676f 5365 7276 6572 4572 726f 720a 2020  goServerError.  
+00015ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015cb0: 2020 6966 2073 7562 5f72 6573 702e 6572    if sub_resp.er
+00015cc0: 726f 725f 636f 6465 203d 3d20 3132 3030  ror_code == 1200
+00015cd0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00015ce0: 2020 2020 2020 2020 2020 6572 726f 7220            error 
+00015cf0: 3d20 446f 6375 6d65 6e74 5265 7669 7369  = DocumentRevisi
+00015d00: 6f6e 4572 726f 7228 7375 625f 7265 7370  onError(sub_resp
+00015d10: 2c20 7265 7175 6573 7429 0a20 2020 2020  , request).     
+00015d20: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00015d30: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00015d40: 2020 2020 2020 2020 2020 2020 2065 7272               err
+00015d50: 6f72 203d 2044 6f63 756d 656e 7444 656c  or = DocumentDel
+00015d60: 6574 6545 7272 6f72 2873 7562 5f72 6573  eteError(sub_res
+00015d70: 702c 2072 6571 7565 7374 290a 2020 2020  p, request).    
+00015d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d90: 7265 7375 6c74 732e 6170 7065 6e64 2865  results.append(e
+00015da0: 7272 6f72 290a 0a20 2020 2020 2020 2020  rror)..         
+00015db0: 2020 2072 6574 7572 6e20 7265 7375 6c74     return result
+00015dc0: 730a 0a20 2020 2020 2020 2072 6574 7572  s..        retur
+00015dd0: 6e20 7365 6c66 2e5f 6578 6563 7574 6528  n self._execute(
+00015de0: 7265 7175 6573 742c 2072 6573 706f 6e73  request, respons
+00015df0: 655f 6861 6e64 6c65 7229 0a0a 2020 2020  e_handler)..    
+00015e00: 6465 6620 6465 6c65 7465 5f6d 6174 6368  def delete_match
+00015e10: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00015e20: 2020 2020 2020 2020 6669 6c74 6572 733a          filters:
+00015e30: 204a 736f 6e2c 0a20 2020 2020 2020 206c   Json,.        l
+00015e40: 696d 6974 3a20 4f70 7469 6f6e 616c 5b69  imit: Optional[i
+00015e50: 6e74 5d20 3d20 4e6f 6e65 2c0a 2020 2020  nt] = None,.    
+00015e60: 2020 2020 7379 6e63 3a20 4f70 7469 6f6e      sync: Option
+00015e70: 616c 5b62 6f6f 6c5d 203d 204e 6f6e 652c  al[bool] = None,
+00015e80: 0a20 2020 2020 2020 2061 6c6c 6f77 5f64  .        allow_d
+00015e90: 6972 7479 5f72 6561 643a 2062 6f6f 6c20  irty_read: bool 
+00015ea0: 3d20 4661 6c73 652c 0a20 2020 2029 202d  = False,.    ) -
+00015eb0: 3e20 5265 7375 6c74 5b69 6e74 5d3a 0a20  > Result[int]:. 
+00015ec0: 2020 2020 2020 2022 2222 4465 6c65 7465         """Delete
+00015ed0: 206d 6174 6368 696e 6720 646f 6375 6d65   matching docume
+00015ee0: 6e74 732e 0a0a 2020 2020 2020 2020 2e2e  nts...        ..
+00015ef0: 206e 6f74 653a 3a0a 0a20 2020 2020 2020   note::..       
+00015f00: 2020 2020 2049 6e20 6564 6765 2f76 6572       In edge/ver
+00015f10: 7465 7820 636f 6c6c 6563 7469 6f6e 732c  tex collections,
+00015f20: 2074 6869 7320 6d65 7468 6f64 2064 6f65   this method doe
+00015f30: 7320 4e4f 5420 7072 6f76 6964 6520 7468  s NOT provide th
+00015f40: 650a 2020 2020 2020 2020 2020 2020 7472  e.            tr
+00015f50: 616e 7361 6374 696f 6e61 6c20 6775 6172  ansactional guar
+00015f60: 616e 7465 6573 2061 6e64 2076 616c 6964  antees and valid
+00015f70: 6174 696f 6e73 2074 6861 7420 7369 6e67  ations that sing
+00015f80: 6c65 2064 656c 6574 650a 2020 2020 2020  le delete.      
+00015f90: 2020 2020 2020 6f70 6572 6174 696f 6e20        operation 
+00015fa0: 646f 6573 2066 6f72 2067 7261 7068 732e  does for graphs.
+00015fb0: 2049 6620 7468 6573 6520 7072 6f70 6572   If these proper
+00015fc0: 7469 6573 2061 7265 2072 6571 7569 7265  ties are require
+00015fd0: 642c 2073 6565 0a20 2020 2020 2020 2020  d, see.         
+00015fe0: 2020 203a 6675 6e63 3a60 6172 616e 676f     :func:`arango
+00015ff0: 2e64 6174 6162 6173 652e 5374 616e 6461  .database.Standa
+00016000: 7264 4461 7461 6261 7365 2e62 6567 696e  rdDatabase.begin
+00016010: 5f62 6174 6368 5f65 7865 6375 7469 6f6e  _batch_execution
+00016020: 600a 2020 2020 2020 2020 2020 2020 666f  `.            fo
+00016030: 7220 616e 2061 6c74 6572 6e61 7469 7665  r an alternative
+00016040: 2061 7070 726f 6163 682e 0a0a 2020 2020   approach...    
+00016050: 2020 2020 3a70 6172 616d 2066 696c 7465      :param filte
+00016060: 7273 3a20 446f 6375 6d65 6e74 2066 696c  rs: Document fil
+00016070: 7465 7273 2e0a 2020 2020 2020 2020 3a74  ters..        :t
+00016080: 7970 6520 6669 6c74 6572 733a 2064 6963  ype filters: dic
+00016090: 740a 2020 2020 2020 2020 3a70 6172 616d  t.        :param
+000160a0: 206c 696d 6974 3a20 4d61 7820 6e75 6d62   limit: Max numb
+000160b0: 6572 206f 6620 646f 6375 6d65 6e74 7320  er of documents 
+000160c0: 746f 2064 656c 6574 652e 2049 6620 7468  to delete. If th
+000160d0: 6520 6c69 6d69 7420 6973 206c 6f77 6572  e limit is lower
+000160e0: 0a20 2020 2020 2020 2020 2020 2074 6861  .            tha
+000160f0: 6e20 7468 6520 6e75 6d62 6572 206f 6620  n the number of 
+00016100: 6d61 7463 6865 6420 646f 6375 6d65 6e74  matched document
+00016110: 732c 2072 616e 646f 6d20 646f 6375 6d65  s, random docume
+00016120: 6e74 7320 6172 6520 6368 6f73 656e 2e0a  nts are chosen..
+00016130: 2020 2020 2020 2020 3a74 7970 6520 6c69          :type li
+00016140: 6d69 743a 2069 6e74 207c 204e 6f6e 650a  mit: int | None.
+00016150: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
+00016160: 796e 633a 2042 6c6f 636b 2075 6e74 696c  ync: Block until
+00016170: 206f 7065 7261 7469 6f6e 2069 7320 7379   operation is sy
+00016180: 6e63 6872 6f6e 697a 6564 2074 6f20 6469  nchronized to di
+00016190: 736b 2e0a 2020 2020 2020 2020 3a74 7970  sk..        :typ
+000161a0: 6520 7379 6e63 3a20 626f 6f6c 207c 204e  e sync: bool | N
+000161b0: 6f6e 650a 2020 2020 2020 2020 3a70 6172  one.        :par
+000161c0: 616d 2061 6c6c 6f77 5f64 6972 7479 5f72  am allow_dirty_r
+000161d0: 6561 643a 2041 6c6c 6f77 2072 6561 6473  ead: Allow reads
+000161e0: 2066 726f 6d20 666f 6c6c 6f77 6572 7320   from followers 
+000161f0: 696e 2061 2063 6c75 7374 6572 2e0a 2020  in a cluster..  
+00016200: 2020 2020 2020 3a74 7970 6520 616c 6c6f        :type allo
+00016210: 775f 6469 7274 795f 7265 6164 3a20 626f  w_dirty_read: bo
+00016220: 6f6c 0a20 2020 2020 2020 203a 7265 7475  ol.        :retu
+00016230: 726e 3a20 4e75 6d62 6572 206f 6620 646f  rn: Number of do
+00016240: 6375 6d65 6e74 7320 6465 6c65 7465 642e  cuments deleted.
+00016250: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
+00016260: 2069 6e74 0a20 2020 2020 2020 203a 7261   int.        :ra
+00016270: 6973 6520 6172 616e 676f 2e65 7863 6570  ise arango.excep
+00016280: 7469 6f6e 732e 446f 6375 6d65 6e74 4465  tions.DocumentDe
+00016290: 6c65 7465 4572 726f 723a 2049 6620 6465  leteError: If de
+000162a0: 6c65 7465 2066 6169 6c73 2e0a 2020 2020  lete fails..    
+000162b0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000162c0: 6173 7365 7274 2069 7369 6e73 7461 6e63  assert isinstanc
+000162d0: 6528 6669 6c74 6572 732c 2064 6963 7429  e(filters, dict)
+000162e0: 2c20 2266 696c 7465 7273 206d 7573 7420  , "filters must 
+000162f0: 6265 2061 2064 6963 7422 0a20 2020 2020  be a dict".     
+00016300: 2020 2061 7373 6572 7420 6973 5f6e 6f6e     assert is_non
+00016310: 655f 6f72 5f69 6e74 286c 696d 6974 292c  e_or_int(limit),
+00016320: 2022 6c69 6d69 7420 6d75 7374 2062 6520   "limit must be 
+00016330: 6120 6e6f 6e2d 6e65 6761 7469 7665 2069  a non-negative i
+00016340: 6e74 220a 2020 2020 2020 2020 6173 7365  nt".        asse
+00016350: 7274 2069 735f 6e6f 6e65 5f6f 725f 626f  rt is_none_or_bo
+00016360: 6f6c 2873 796e 6329 2c20 2273 796e 6320  ol(sync), "sync 
+00016370: 6d75 7374 2062 6520 4e6f 6e65 206f 7220  must be None or 
+00016380: 6120 626f 6f6c 220a 0a20 2020 2020 2020  a bool"..       
+00016390: 2023 2049 6620 7468 6520 7761 6974 466f   # If the waitFo
+000163a0: 7253 796e 6320 7061 7261 6d65 7465 7220  rSync parameter 
+000163b0: 6973 206e 6f74 2073 7065 6369 6669 6564  is not specified
+000163c0: 206f 7220 7365 7420 746f 2066 616c 7365   or set to false
+000163d0: 2c0a 2020 2020 2020 2020 2320 7468 656e  ,.        # then
+000163e0: 2074 6865 2063 6f6c 6c65 6374 696f 6ee2   the collection.
+000163f0: 8099 7320 6465 6661 756c 7420 7761 6974  ..s default wait
+00016400: 466f 7253 796e 6320 6265 6861 7669 6f72  ForSync behavior
+00016410: 2069 7320 6170 706c 6965 642e 0a20 2020   is applied..   
+00016420: 2020 2020 2073 796e 635f 7661 6c20 3d20       sync_val = 
+00016430: 6622 7761 6974 466f 7253 796e 633a 207b  f"waitForSync: {
+00016440: 7379 6e63 7d22 2069 6620 7379 6e63 2069  sync}" if sync i
+00016450: 7320 6e6f 7420 4e6f 6e65 2065 6c73 6520  s not None else 
+00016460: 2222 0a0a 2020 2020 2020 2020 7175 6572  ""..        quer
+00016470: 7920 3d20 6622 2222 0a20 2020 2020 2020  y = f""".       
+00016480: 2020 2020 2046 4f52 2064 6f63 2049 4e20       FOR doc IN 
+00016490: 4040 636f 6c6c 6563 7469 6f6e 0a20 2020  @@collection.   
+000164a0: 2020 2020 2020 2020 2020 2020 207b 6275               {bu
+000164b0: 696c 645f 6669 6c74 6572 5f63 6f6e 6469  ild_filter_condi
+000164c0: 7469 6f6e 7328 6669 6c74 6572 7329 7d0a  tions(filters)}.
+000164d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000164e0: 7b66 224c 494d 4954 207b 6c69 6d69 747d  {f"LIMIT {limit}
+000164f0: 2220 6966 206c 696d 6974 2069 7320 6e6f  " if limit is no
+00016500: 7420 4e6f 6e65 2065 6c73 6520 2222 7d0a  t None else ""}.
+00016510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016520: 5245 4d4f 5645 2064 6f63 2049 4e20 4040  REMOVE doc IN @@
+00016530: 636f 6c6c 6563 7469 6f6e 0a20 2020 2020  collection.     
+00016540: 2020 2020 2020 2020 2020 207b 6622 4f50             {f"OP
+00016550: 5449 4f4e 5320 7b7b 207b 7379 6e63 5f76  TIONS {{ {sync_v
+00016560: 616c 7d20 7d7d 2220 6966 2073 796e 635f  al} }}" if sync_
+00016570: 7661 6c20 656c 7365 2022 227d 0a20 2020  val else ""}.   
+00016580: 2020 2020 2022 2222 2020 2320 6e6f 7161       """  # noqa
+00016590: 3a20 4532 3031 2045 3230 320a 0a20 2020  : E201 E202..   
+000165a0: 2020 2020 2062 696e 645f 7661 7273 203d       bind_vars =
+000165b0: 207b 2240 636f 6c6c 6563 7469 6f6e 223a   {"@collection":
+000165c0: 2073 656c 662e 6e61 6d65 7d0a 0a20 2020   self.name}..   
+000165d0: 2020 2020 2072 6571 7565 7374 203d 2052       request = R
+000165e0: 6571 7565 7374 280a 2020 2020 2020 2020  equest(.        
+000165f0: 2020 2020 6d65 7468 6f64 3d22 706f 7374      method="post
+00016600: 222c 0a20 2020 2020 2020 2020 2020 2065  ",.            e
+00016610: 6e64 706f 696e 743d 222f 5f61 7069 2f63  ndpoint="/_api/c
+00016620: 7572 736f 7222 2c0a 2020 2020 2020 2020  ursor",.        
+00016630: 2020 2020 6461 7461 3d7b 2271 7565 7279      data={"query
+00016640: 223a 2071 7565 7279 2c20 2262 696e 6456  ": query, "bindV
+00016650: 6172 7322 3a20 6269 6e64 5f76 6172 737d  ars": bind_vars}
+00016660: 2c0a 2020 2020 2020 2020 2020 2020 7772  ,.            wr
+00016670: 6974 653d 7365 6c66 2e6e 616d 652c 0a20  ite=self.name,. 
+00016680: 2020 2020 2020 2020 2020 2068 6561 6465             heade
+00016690: 7273 3d7b 2278 2d61 7261 6e67 6f2d 616c  rs={"x-arango-al
+000166a0: 6c6f 772d 6469 7274 792d 7265 6164 223a  low-dirty-read":
+000166b0: 2022 7472 7565 227d 2069 6620 616c 6c6f   "true"} if allo
+000166c0: 775f 6469 7274 795f 7265 6164 2065 6c73  w_dirty_read els
+000166d0: 6520 4e6f 6e65 2c0a 2020 2020 2020 2020  e None,.        
+000166e0: 290a 0a20 2020 2020 2020 2064 6566 2072  )..        def r
+000166f0: 6573 706f 6e73 655f 6861 6e64 6c65 7228  esponse_handler(
+00016700: 7265 7370 3a20 5265 7370 6f6e 7365 2920  resp: Response) 
+00016710: 2d3e 2069 6e74 3a0a 2020 2020 2020 2020  -> int:.        
+00016720: 2020 2020 6966 2072 6573 702e 6973 5f73      if resp.is_s
+00016730: 7563 6365 7373 3a0a 2020 2020 2020 2020  uccess:.        
+00016740: 2020 2020 2020 2020 7265 7375 6c74 3a20          result: 
+00016750: 696e 7420 3d20 7265 7370 2e62 6f64 795b  int = resp.body[
+00016760: 2265 7874 7261 225d 5b22 7374 6174 7322  "extra"]["stats"
+00016770: 5d5b 2277 7269 7465 7345 7865 6375 7465  ]["writesExecute
+00016780: 6422 5d0a 2020 2020 2020 2020 2020 2020  d"].            
+00016790: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
+000167a0: 740a 2020 2020 2020 2020 2020 2020 7261  t.            ra
+000167b0: 6973 6520 446f 6375 6d65 6e74 4465 6c65  ise DocumentDele
+000167c0: 7465 4572 726f 7228 7265 7370 2c20 7265  teError(resp, re
+000167d0: 7175 6573 7429 0a0a 2020 2020 2020 2020  quest)..        
+000167e0: 7265 7475 726e 2073 656c 662e 5f65 7865  return self._exe
+000167f0: 6375 7465 2872 6571 7565 7374 2c20 7265  cute(request, re
+00016800: 7370 6f6e 7365 5f68 616e 646c 6572 290a  sponse_handler).
+00016810: 0a20 2020 2064 6566 2069 6d70 6f72 745f  .    def import_
+00016820: 6275 6c6b 280a 2020 2020 2020 2020 7365  bulk(.        se
+00016830: 6c66 2c0a 2020 2020 2020 2020 646f 6375  lf,.        docu
+00016840: 6d65 6e74 733a 2053 6571 7565 6e63 655b  ments: Sequence[
+00016850: 4a73 6f6e 5d2c 0a20 2020 2020 2020 2068  Json],.        h
+00016860: 616c 745f 6f6e 5f65 7272 6f72 3a20 626f  alt_on_error: bo
+00016870: 6f6c 203d 2054 7275 652c 0a20 2020 2020  ol = True,.     
+00016880: 2020 2064 6574 6169 6c73 3a20 626f 6f6c     details: bool
+00016890: 203d 2054 7275 652c 0a20 2020 2020 2020   = True,.       
+000168a0: 2066 726f 6d5f 7072 6566 6978 3a20 4f70   from_prefix: Op
+000168b0: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
+000168c0: 6e65 2c0a 2020 2020 2020 2020 746f 5f70  ne,.        to_p
+000168d0: 7265 6669 783a 204f 7074 696f 6e61 6c5b  refix: Optional[
+000168e0: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+000168f0: 2020 2020 206f 7665 7277 7269 7465 3a20       overwrite: 
+00016900: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 203d  Optional[bool] =
+00016910: 204e 6f6e 652c 0a20 2020 2020 2020 206f   None,.        o
+00016920: 6e5f 6475 706c 6963 6174 653a 204f 7074  n_duplicate: Opt
+00016930: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
+00016940: 652c 0a20 2020 2020 2020 2073 796e 633a  e,.        sync:
+00016950: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
+00016960: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+00016970: 6261 7463 685f 7369 7a65 3a20 4f70 7469  batch_size: Opti
+00016980: 6f6e 616c 5b69 6e74 5d20 3d20 4e6f 6e65  onal[int] = None
+00016990: 2c0a 2020 2020 2920 2d3e 2055 6e69 6f6e  ,.    ) -> Union
+000169a0: 5b52 6573 756c 745b 4a73 6f6e 5d2c 204c  [Result[Json], L
+000169b0: 6973 745b 5265 7375 6c74 5b4a 736f 6e5d  ist[Result[Json]
+000169c0: 5d5d 3a0a 2020 2020 2020 2020 2222 2249  ]]:.        """I
+000169d0: 6e73 6572 7420 6d75 6c74 6970 6c65 2064  nsert multiple d
+000169e0: 6f63 756d 656e 7473 2069 6e74 6f20 7468  ocuments into th
+000169f0: 6520 636f 6c6c 6563 7469 6f6e 2e0a 0a20  e collection... 
+00016a00: 2020 2020 2020 202e 2e20 6e6f 7465 3a3a         .. note::
+00016a10: 0a0a 2020 2020 2020 2020 2020 2020 5468  ..            Th
+00016a20: 6973 206d 6574 686f 6420 6973 2066 6173  is method is fas
+00016a30: 7465 7220 7468 616e 203a 6675 6e63 3a60  ter than :func:`
+00016a40: 6172 616e 676f 2e63 6f6c 6c65 6374 696f  arango.collectio
+00016a50: 6e2e 436f 6c6c 6563 7469 6f6e 2e69 6e73  n.Collection.ins
+00016a60: 6572 745f 6d61 6e79 600a 2020 2020 2020  ert_many`.      
+00016a70: 2020 2020 2020 6275 7420 646f 6573 206e        but does n
+00016a80: 6f74 2072 6574 7572 6e20 6173 206d 616e  ot return as man
+00016a90: 7920 6465 7461 696c 732e 0a0a 2020 2020  y details...    
+00016aa0: 2020 2020 2e2e 206e 6f74 653a 3a0a 0a20      .. note::.. 
+00016ab0: 2020 2020 2020 2020 2020 2049 6e20 6564             In ed
+00016ac0: 6765 2f76 6572 7465 7820 636f 6c6c 6563  ge/vertex collec
+00016ad0: 7469 6f6e 732c 2074 6869 7320 6d65 7468  tions, this meth
+00016ae0: 6f64 2064 6f65 7320 4e4f 5420 7072 6f76  od does NOT prov
+00016af0: 6964 6520 7468 650a 2020 2020 2020 2020  ide the.        
+00016b00: 2020 2020 7472 616e 7361 6374 696f 6e61      transactiona
+00016b10: 6c20 6775 6172 616e 7465 6573 2061 6e64  l guarantees and
+00016b20: 2076 616c 6964 6174 696f 6e73 2074 6861   validations tha
+00016b30: 7420 7369 6e67 6c65 2069 6e73 6572 740a  t single insert.
+00016b40: 2020 2020 2020 2020 2020 2020 6f70 6572              oper
+00016b50: 6174 696f 6e20 646f 6573 2066 6f72 2067  ation does for g
+00016b60: 7261 7068 732e 2049 6620 7468 6573 6520  raphs. If these 
+00016b70: 7072 6f70 6572 7469 6573 2061 7265 2072  properties are r
+00016b80: 6571 7569 7265 642c 2073 6565 0a20 2020  equired, see.   
+00016b90: 2020 2020 2020 2020 203a 6675 6e63 3a60           :func:`
+00016ba0: 6172 616e 676f 2e64 6174 6162 6173 652e  arango.database.
+00016bb0: 5374 616e 6461 7264 4461 7461 6261 7365  StandardDatabase
+00016bc0: 2e62 6567 696e 5f62 6174 6368 5f65 7865  .begin_batch_exe
+00016bd0: 6375 7469 6f6e 600a 2020 2020 2020 2020  cution`.        
+00016be0: 2020 2020 666f 7220 616e 2061 6c74 6572      for an alter
+00016bf0: 6e61 7469 7665 2061 7070 726f 6163 682e  native approach.
+00016c00: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00016c10: 2064 6f63 756d 656e 7473 3a20 4c69 7374   documents: List
+00016c20: 206f 6620 6e65 7720 646f 6375 6d65 6e74   of new document
+00016c30: 7320 746f 2069 6e73 6572 742e 2049 6620  s to insert. If 
+00016c40: 7468 6579 2063 6f6e 7461 696e 2074 6865  they contain the
+00016c50: 0a20 2020 2020 2020 2020 2020 2022 5f6b  .            "_k
+00016c60: 6579 2220 6f72 2022 5f69 6422 2066 6965  ey" or "_id" fie
+00016c70: 6c64 732c 2074 6865 2076 616c 7565 7320  lds, the values 
+00016c80: 6172 6520 7573 6564 2061 7320 7468 6520  are used as the 
+00016c90: 6b65 7973 206f 6620 7468 6520 6e65 770a  keys of the new.
+00016ca0: 2020 2020 2020 2020 2020 2020 646f 6375              docu
+00016cb0: 6d65 6e74 7320 2861 7574 6f2d 6765 6e65  ments (auto-gene
+00016cc0: 7261 7465 6420 6f74 6865 7277 6973 6529  rated otherwise)
+00016cd0: 2e20 416e 7920 225f 7265 7622 2066 6965  . Any "_rev" fie
+00016ce0: 6c64 2069 7320 6967 6e6f 7265 642e 0a20  ld is ignored.. 
+00016cf0: 2020 2020 2020 203a 7479 7065 2064 6f63         :type doc
+00016d00: 756d 656e 7473 3a20 5b64 6963 745d 0a20  uments: [dict]. 
+00016d10: 2020 2020 2020 203a 7061 7261 6d20 6861         :param ha
+00016d20: 6c74 5f6f 6e5f 6572 726f 723a 2048 616c  lt_on_error: Hal
+00016d30: 7420 7468 6520 656e 7469 7265 2069 6d70  t the entire imp
+00016d40: 6f72 7420 6f6e 2061 6e20 6572 726f 722e  ort on an error.
+00016d50: 0a20 2020 2020 2020 203a 7479 7065 2068  .        :type h
+00016d60: 616c 745f 6f6e 5f65 7272 6f72 3a20 626f  alt_on_error: bo
+00016d70: 6f6c 0a20 2020 2020 2020 203a 7061 7261  ol.        :para
+00016d80: 6d20 6465 7461 696c 733a 2049 6620 7365  m details: If se
+00016d90: 7420 746f 2054 7275 652c 2074 6865 2072  t to True, the r
+00016da0: 6574 7572 6e65 6420 7265 7375 6c74 2077  eturned result w
+00016db0: 696c 6c20 696e 636c 7564 6520 616e 0a20  ill include an. 
+00016dc0: 2020 2020 2020 2020 2020 2061 6464 6974             addit
+00016dd0: 696f 6e61 6c20 6c69 7374 206f 6620 6465  ional list of de
+00016de0: 7461 696c 6564 2065 7272 6f72 206d 6573  tailed error mes
+00016df0: 7361 6765 732e 0a20 2020 2020 2020 203a  sages..        :
+00016e00: 7479 7065 2064 6574 6169 6c73 3a20 626f  type details: bo
+00016e10: 6f6c 0a20 2020 2020 2020 203a 7061 7261  ol.        :para
+00016e20: 6d20 6672 6f6d 5f70 7265 6669 783a 2053  m from_prefix: S
+00016e30: 7472 696e 6720 7072 6566 6978 2070 7265  tring prefix pre
+00016e40: 7065 6e64 6564 2074 6f20 7468 6520 7661  pended to the va
+00016e50: 6c75 6520 6f66 2022 5f66 726f 6d22 0a20  lue of "_from". 
+00016e60: 2020 2020 2020 2020 2020 2066 6965 6c64             field
+00016e70: 2069 6e20 6561 6368 2065 6467 6520 646f   in each edge do
+00016e80: 6375 6d65 6e74 2069 6e73 6572 7465 642e  cument inserted.
+00016e90: 2046 6f72 2065 7861 6d70 6c65 2c20 7072   For example, pr
+00016ea0: 6566 6978 2022 666f 6f22 0a20 2020 2020  efix "foo".     
+00016eb0: 2020 2020 2020 2070 7265 7065 6e64 6564         prepended
+00016ec0: 2074 6f20 225f 6672 6f6d 223a 2022 6261   to "_from": "ba
+00016ed0: 7222 2077 696c 6c20 7265 7375 6c74 2069  r" will result i
+00016ee0: 6e20 225f 6672 6f6d 223a 2022 666f 6f2f  n "_from": "foo/
+00016ef0: 6261 7222 2e0a 2020 2020 2020 2020 2020  bar"..          
+00016f00: 2020 4170 706c 6965 7320 6f6e 6c79 2074    Applies only t
+00016f10: 6f20 6564 6765 2063 6f6c 6c65 6374 696f  o edge collectio
+00016f20: 6e73 2e0a 2020 2020 2020 2020 3a74 7970  ns..        :typ
+00016f30: 6520 6672 6f6d 5f70 7265 6669 783a 2073  e from_prefix: s
+00016f40: 7472 0a20 2020 2020 2020 203a 7061 7261  tr.        :para
+00016f50: 6d20 746f 5f70 7265 6669 783a 2053 7472  m to_prefix: Str
+00016f60: 696e 6720 7072 6566 6978 2070 7265 7065  ing prefix prepe
+00016f70: 6e64 6564 2074 6f20 7468 6520 7661 6c75  nded to the valu
+00016f80: 6520 6f66 2022 5f74 6f22 2066 6965 6c64  e of "_to" field
+00016f90: 0a20 2020 2020 2020 2020 2020 2069 6e20  .            in 
+00016fa0: 6564 6765 2064 6f63 756d 656e 7420 696e  edge document in
+00016fb0: 7365 7274 6564 2e20 466f 7220 6578 616d  serted. For exam
+00016fc0: 706c 652c 2070 7265 6669 7820 2266 6f6f  ple, prefix "foo
+00016fd0: 2220 7072 6570 656e 6465 6420 746f 0a20  " prepended to. 
+00016fe0: 2020 2020 2020 2020 2020 2022 5f74 6f22             "_to"
+00016ff0: 3a20 2262 6172 2220 7769 6c6c 2072 6573  : "bar" will res
+00017000: 756c 7420 696e 2022 5f74 6f22 3a20 2266  ult in "_to": "f
+00017010: 6f6f 2f62 6172 222e 2041 7070 6c69 6573  oo/bar". Applies
+00017020: 206f 6e6c 7920 746f 2065 6467 650a 2020   only to edge.  
+00017030: 2020 2020 2020 2020 2020 636f 6c6c 6563            collec
+00017040: 7469 6f6e 732e 0a20 2020 2020 2020 203a  tions..        :
+00017050: 7479 7065 2074 6f5f 7072 6566 6978 3a20  type to_prefix: 
+00017060: 7374 720a 2020 2020 2020 2020 3a70 6172  str.        :par
+00017070: 616d 206f 7665 7277 7269 7465 3a20 4966  am overwrite: If
+00017080: 2073 6574 2074 6f20 5472 7565 2c20 616c   set to True, al
+00017090: 6c20 6578 6973 7469 6e67 2064 6f63 756d  l existing docum
+000170a0: 656e 7473 2061 7265 2072 656d 6f76 6564  ents are removed
+000170b0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+000170c0: 6f72 2074 6f20 7468 6520 696d 706f 7274  or to the import
+000170d0: 2e20 496e 6465 7865 7320 6172 6520 7374  . Indexes are st
+000170e0: 696c 6c20 7072 6573 6572 7665 642e 0a20  ill preserved.. 
+000170f0: 2020 2020 2020 203a 7479 7065 206f 7665         :type ove
+00017100: 7277 7269 7465 3a20 626f 6f6c 0a20 2020  rwrite: bool.   
+00017110: 2020 2020 203a 7061 7261 6d20 6f6e 5f64       :param on_d
+00017120: 7570 6c69 6361 7465 3a20 4163 7469 6f6e  uplicate: Action
+00017130: 2074 6f20 7461 6b65 206f 6e20 756e 6971   to take on uniq
+00017140: 7565 206b 6579 2063 6f6e 7374 7261 696e  ue key constrain
+00017150: 7420 7669 6f6c 6174 696f 6e73 0a20 2020  t violations.   
+00017160: 2020 2020 2020 2020 2028 666f 7220 646f           (for do
+00017170: 6375 6d65 6e74 7320 7769 7468 2022 5f6b  cuments with "_k
+00017180: 6579 2220 6669 656c 6473 292e 2041 6c6c  ey" fields). All
+00017190: 6f77 6564 2076 616c 7565 7320 6172 6520  owed values are 
+000171a0: 2265 7272 6f72 2220 2864 6f0a 2020 2020  "error" (do.    
+000171b0: 2020 2020 2020 2020 6e6f 7420 696d 706f          not impo
+000171c0: 7274 2074 6865 206e 6577 2064 6f63 756d  rt the new docum
+000171d0: 656e 7473 2061 6e64 2063 6f75 6e74 2074  ents and count t
+000171e0: 6865 6d20 6173 2065 7272 6f72 7329 2c20  hem as errors), 
+000171f0: 2275 7064 6174 6522 0a20 2020 2020 2020  "update".       
+00017200: 2020 2020 2028 7570 6461 7465 2074 6865       (update the
+00017210: 2065 7869 7374 696e 6720 646f 6375 6d65   existing docume
+00017220: 6e74 7320 7768 696c 6520 7072 6573 6572  nts while preser
+00017230: 7669 6e67 2061 6e79 2066 6965 6c64 7320  ving any fields 
+00017240: 6d69 7373 696e 670a 2020 2020 2020 2020  missing.        
+00017250: 2020 2020 696e 2074 6865 206e 6577 206f      in the new o
+00017260: 6e65 7329 2c20 2272 6570 6c61 6365 2220  nes), "replace" 
+00017270: 2872 6570 6c61 6365 2074 6865 2065 7869  (replace the exi
+00017280: 7374 696e 6720 646f 6375 6d65 6e74 7320  sting documents 
+00017290: 7769 7468 0a20 2020 2020 2020 2020 2020  with.           
+000172a0: 206e 6577 206f 6e65 7329 2c20 616e 6420   new ones), and 
+000172b0: 2022 6967 6e6f 7265 2220 2864 6f20 6e6f   "ignore" (do no
+000172c0: 7420 696d 706f 7274 2074 6865 206e 6577  t import the new
+000172d0: 2064 6f63 756d 656e 7473 2061 6e64 2063   documents and c
+000172e0: 6f75 6e74 0a20 2020 2020 2020 2020 2020  ount.           
+000172f0: 2074 6865 6d20 6173 2069 676e 6f72 6564   them as ignored
+00017300: 2c20 6173 206f 7070 6f73 6564 2074 6f20  , as opposed to 
+00017310: 636f 756e 7469 6e67 2074 6865 6d20 6173  counting them as
+00017320: 2065 7272 6f72 7329 2e20 4f70 7469 6f6e   errors). Option
+00017330: 730a 2020 2020 2020 2020 2020 2020 2275  s.            "u
+00017340: 7064 6174 6522 2061 6e64 2022 7265 706c  pdate" and "repl
+00017350: 6163 6522 206d 6179 2066 6169 6c20 6f6e  ace" may fail on
+00017360: 2073 6563 6f6e 6461 7279 2075 6e69 7175   secondary uniqu
+00017370: 6520 6b65 7920 636f 6e73 7472 6169 6e74  e key constraint
+00017380: 0a20 2020 2020 2020 2020 2020 2076 696f  .            vio
+00017390: 6c61 7469 6f6e 732e 0a20 2020 2020 2020  lations..       
+000173a0: 203a 7479 7065 206f 6e5f 6475 706c 6963   :type on_duplic
+000173b0: 6174 653a 2073 7472 0a20 2020 2020 2020  ate: str.       
+000173c0: 203a 7061 7261 6d20 7379 6e63 3a20 426c   :param sync: Bl
+000173d0: 6f63 6b20 756e 7469 6c20 6f70 6572 6174  ock until operat
+000173e0: 696f 6e20 6973 2073 796e 6368 726f 6e69  ion is synchroni
+000173f0: 7a65 6420 746f 2064 6973 6b2e 0a20 2020  zed to disk..   
+00017400: 2020 2020 203a 7479 7065 2073 796e 633a       :type sync:
+00017410: 2062 6f6f 6c20 7c20 4e6f 6e65 0a20 2020   bool | None.   
+00017420: 2020 2020 203a 7061 7261 6d20 6261 7463       :param batc
+00017430: 685f 7369 7a65 3a20 5370 6c69 7420 7570  h_size: Split up
+00017440: 202a 2a64 6f63 756d 656e 7473 2a2a 2069   **documents** i
+00017450: 6e74 6f20 6261 7463 6865 7320 6f66 206d  nto batches of m
+00017460: 6178 206c 656e 6774 680a 2020 2020 2020  ax length.      
+00017470: 2020 2020 2020 2a2a 6261 7463 685f 7369        **batch_si
+00017480: 7a65 2a2a 2061 6e64 2069 6d70 6f72 7420  ze** and import 
+00017490: 7468 656d 2069 6e20 6120 6c6f 6f70 206f  them in a loop o
+000174a0: 6e20 7468 6520 636c 6965 6e74 2073 6964  n the client sid
+000174b0: 652e 2049 660a 2020 2020 2020 2020 2020  e. If.          
+000174c0: 2020 2a2a 6261 7463 685f 7369 7a65 2a2a    **batch_size**
+000174d0: 2069 7320 7370 6563 6966 6965 642c 2074   is specified, t
+000174e0: 6865 2072 6574 7572 6e20 7479 7065 206f  he return type o
+000174f0: 6620 7468 6973 206d 6574 686f 640a 2020  f this method.  
+00017500: 2020 2020 2020 2020 2020 6368 616e 6765            change
+00017510: 7320 6672 6f6d 2061 2072 6573 756c 7420  s from a result 
+00017520: 6f62 6a65 6374 2074 6f20 6120 6c69 7374  object to a list
+00017530: 206f 6620 7265 7375 6c74 206f 626a 6563   of result objec
+00017540: 7473 2e0a 2020 2020 2020 2020 2020 2020  ts..            
+00017550: 494d 504f 5254 414e 5420 4e4f 5445 3a20  IMPORTANT NOTE: 
+00017560: 7468 6973 2070 6172 616d 6574 6572 206d  this parameter m
+00017570: 6179 2067 6f20 7468 726f 7567 6820 6272  ay go through br
+00017580: 6561 6b69 6e67 2063 6861 6e67 6573 0a20  eaking changes. 
+00017590: 2020 2020 2020 2020 2020 2069 6e20 7468             in th
+000175a0: 6520 6675 7475 7265 2077 6865 7265 2074  e future where t
+000175b0: 6865 2072 6574 7572 6e20 7479 7065 206d  he return type m
+000175c0: 6179 206e 6f74 2062 6520 6120 6c69 7374  ay not be a list
+000175d0: 206f 6620 7265 7375 6c74 0a20 2020 2020   of result.     
+000175e0: 2020 2020 2020 206f 626a 6563 7473 2061         objects a
+000175f0: 6e79 6d6f 7265 2e20 5573 6520 6974 2061  nymore. Use it a
+00017600: 7420 796f 7572 206f 776e 2072 6973 6b2c  t your own risk,
+00017610: 2061 6e64 2061 766f 6964 0a20 2020 2020   and avoid.     
+00017620: 2020 2020 2020 2064 6570 656e 6469 6e67         depending
+00017630: 206f 6e20 7468 6520 7265 7475 726e 2076   on the return v
+00017640: 616c 7565 2069 6620 706f 7373 6962 6c65  alue if possible
+00017650: 2e20 4361 6e6e 6f74 2062 6520 7573 6564  . Cannot be used
+00017660: 2077 6974 680a 2020 2020 2020 2020 2020   with.          
+00017670: 2020 7061 7261 6d65 7465 7220 2a2a 6f76    parameter **ov
+00017680: 6572 7772 6974 652a 2a2e 0a20 2020 2020  erwrite**..     
+00017690: 2020 203a 7479 7065 2062 6174 6368 5f73     :type batch_s
+000176a0: 697a 653a 2069 6e74 0a20 2020 2020 2020  ize: int.       
+000176b0: 203a 7265 7475 726e 3a20 5265 7375 6c74   :return: Result
+000176c0: 206f 6620 7468 6520 6275 6c6b 2069 6d70   of the bulk imp
+000176d0: 6f72 742e 0a20 2020 2020 2020 203a 7274  ort..        :rt
+000176e0: 7970 653a 2064 6963 7420 7c20 6c69 7374  ype: dict | list
+000176f0: 5b64 6963 745d 0a20 2020 2020 2020 203a  [dict].        :
+00017700: 7261 6973 6520 6172 616e 676f 2e65 7863  raise arango.exc
+00017710: 6570 7469 6f6e 732e 446f 6375 6d65 6e74  eptions.Document
+00017720: 496e 7365 7274 4572 726f 723a 2049 6620  InsertError: If 
+00017730: 696d 706f 7274 2066 6169 6c73 2e0a 2020  import fails..  
+00017740: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00017750: 2020 6966 206f 7665 7277 7269 7465 2061    if overwrite a
+00017760: 6e64 2062 6174 6368 5f73 697a 6520 6973  nd batch_size is
+00017770: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00017780: 2020 2020 2020 206d 7367 203d 2022 4361         msg = "Ca
+00017790: 6e6e 6f74 2075 7365 2070 6172 616d 6574  nnot use paramet
+000177a0: 6572 2027 6261 7463 685f 7369 7a65 2720  er 'batch_size' 
+000177b0: 6966 2027 6f76 6572 7772 6974 6527 2069  if 'overwrite' i
+000177c0: 7320 7365 7420 746f 2054 7275 6522 0a20  s set to True". 
+000177d0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+000177e0: 2056 616c 7565 4572 726f 7228 6d73 6729   ValueError(msg)
+000177f0: 0a0a 2020 2020 2020 2020 646f 6375 6d65  ..        docume
+00017800: 6e74 7320 3d20 5b73 656c 662e 5f65 6e73  nts = [self._ens
+00017810: 7572 655f 6b65 795f 6672 6f6d 5f69 6428  ure_key_from_id(
+00017820: 646f 6329 2066 6f72 2064 6f63 2069 6e20  doc) for doc in 
+00017830: 646f 6375 6d65 6e74 735d 0a0a 2020 2020  documents]..    
+00017840: 2020 2020 7061 7261 6d73 3a20 5061 7261      params: Para
+00017850: 6d73 203d 207b 2274 7970 6522 3a20 2261  ms = {"type": "a
+00017860: 7272 6179 222c 2022 636f 6c6c 6563 7469  rray", "collecti
+00017870: 6f6e 223a 2073 656c 662e 6e61 6d65 7d0a  on": self.name}.
+00017880: 2020 2020 2020 2020 6966 2068 616c 745f          if halt_
+00017890: 6f6e 5f65 7272 6f72 2069 7320 6e6f 7420  on_error is not 
+000178a0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+000178b0: 2020 7061 7261 6d73 5b22 636f 6d70 6c65    params["comple
+000178c0: 7465 225d 203d 2068 616c 745f 6f6e 5f65  te"] = halt_on_e
+000178d0: 7272 6f72 0a20 2020 2020 2020 2069 6620  rror.        if 
+000178e0: 6465 7461 696c 7320 6973 206e 6f74 204e  details is not N
+000178f0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00017900: 2070 6172 616d 735b 2264 6574 6169 6c73   params["details
+00017910: 225d 203d 2064 6574 6169 6c73 0a20 2020  "] = details.   
+00017920: 2020 2020 2069 6620 6672 6f6d 5f70 7265       if from_pre
+00017930: 6669 7820 6973 206e 6f74 204e 6f6e 653a  fix is not None:
+00017940: 2020 2320 7072 6167 6d61 3a20 6e6f 2063    # pragma: no c
+00017950: 6f76 6572 0a20 2020 2020 2020 2020 2020  over.           
+00017960: 2070 6172 616d 735b 2266 726f 6d50 7265   params["fromPre
+00017970: 6669 7822 5d20 3d20 6672 6f6d 5f70 7265  fix"] = from_pre
+00017980: 6669 780a 2020 2020 2020 2020 6966 2074  fix.        if t
+00017990: 6f5f 7072 6566 6978 2069 7320 6e6f 7420  o_prefix is not 
+000179a0: 4e6f 6e65 3a20 2023 2070 7261 676d 613a  None:  # pragma:
+000179b0: 206e 6f20 636f 7665 720a 2020 2020 2020   no cover.      
+000179c0: 2020 2020 2020 7061 7261 6d73 5b22 746f        params["to
+000179d0: 5072 6566 6978 225d 203d 2074 6f5f 7072  Prefix"] = to_pr
+000179e0: 6566 6978 0a20 2020 2020 2020 2069 6620  efix.        if 
+000179f0: 6f76 6572 7772 6974 6520 6973 206e 6f74  overwrite is not
+00017a00: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00017a10: 2020 2070 6172 616d 735b 226f 7665 7277     params["overw
+00017a20: 7269 7465 225d 203d 206f 7665 7277 7269  rite"] = overwri
+00017a30: 7465 0a20 2020 2020 2020 2069 6620 6f6e  te.        if on
+00017a40: 5f64 7570 6c69 6361 7465 2069 7320 6e6f  _duplicate is no
+00017a50: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+00017a60: 2020 2020 7061 7261 6d73 5b22 6f6e 4475      params["onDu
+00017a70: 706c 6963 6174 6522 5d20 3d20 6f6e 5f64  plicate"] = on_d
+00017a80: 7570 6c69 6361 7465 0a20 2020 2020 2020  uplicate.       
+00017a90: 2069 6620 7379 6e63 2069 7320 6e6f 7420   if sync is not 
+00017aa0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00017ab0: 2020 7061 7261 6d73 5b22 7761 6974 466f    params["waitFo
+00017ac0: 7253 796e 6322 5d20 3d20 7379 6e63 0a0a  rSync"] = sync..
+00017ad0: 2020 2020 2020 2020 6465 6620 7265 7370          def resp
+00017ae0: 6f6e 7365 5f68 616e 646c 6572 2872 6573  onse_handler(res
+00017af0: 703a 2052 6573 706f 6e73 6529 202d 3e20  p: Response) -> 
+00017b00: 4a73 6f6e 3a0a 2020 2020 2020 2020 2020  Json:.          
+00017b10: 2020 6966 2072 6573 702e 6973 5f73 7563    if resp.is_suc
+00017b20: 6365 7373 3a0a 2020 2020 2020 2020 2020  cess:.          
+00017b30: 2020 2020 2020 7265 7375 6c74 3a20 4a73        result: Js
+00017b40: 6f6e 203d 2072 6573 702e 626f 6479 0a20  on = resp.body. 
+00017b50: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00017b60: 6574 7572 6e20 7265 7375 6c74 0a20 2020  eturn result.   
+00017b70: 2020 2020 2020 2020 2072 6169 7365 2044           raise D
+00017b80: 6f63 756d 656e 7449 6e73 6572 7445 7272  ocumentInsertErr
+00017b90: 6f72 2872 6573 702c 2072 6571 7565 7374  or(resp, request
+00017ba0: 290a 0a20 2020 2020 2020 2069 6620 6261  )..        if ba
+00017bb0: 7463 685f 7369 7a65 2069 7320 4e6f 6e65  tch_size is None
+00017bc0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00017bd0: 7175 6573 7420 3d20 5265 7175 6573 7428  quest = Request(
+00017be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017bf0: 206d 6574 686f 643d 2270 6f73 7422 2c0a   method="post",.
+00017c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017c10: 656e 6470 6f69 6e74 3d22 2f5f 6170 692f  endpoint="/_api/
+00017c20: 696d 706f 7274 222c 0a20 2020 2020 2020  import",.       
+00017c30: 2020 2020 2020 2020 2064 6174 613d 646f           data=do
+00017c40: 6375 6d65 6e74 732c 0a20 2020 2020 2020  cuments,.       
+00017c50: 2020 2020 2020 2020 2070 6172 616d 733d           params=
+00017c60: 7061 7261 6d73 2c0a 2020 2020 2020 2020  params,.        
+00017c70: 2020 2020 2020 2020 7772 6974 653d 7365          write=se
+00017c80: 6c66 2e6e 616d 652c 0a20 2020 2020 2020  lf.name,.       
+00017c90: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00017ca0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00017cb0: 5f65 7865 6375 7465 2872 6571 7565 7374  _execute(request
+00017cc0: 2c20 7265 7370 6f6e 7365 5f68 616e 646c  , response_handl
+00017cd0: 6572 290a 2020 2020 2020 2020 656c 7365  er).        else
+00017ce0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00017cf0: 7375 6c74 7320 3d20 5b5d 0a20 2020 2020  sults = [].     
+00017d00: 2020 2020 2020 2066 6f72 2062 6174 6368         for batch
+00017d10: 2069 6e20 6765 745f 6261 7463 6865 7328   in get_batches(
+00017d20: 646f 6375 6d65 6e74 732c 2062 6174 6368  documents, batch
+00017d30: 5f73 697a 6529 3a0a 2020 2020 2020 2020  _size):.        
+00017d40: 2020 2020 2020 2020 7265 7175 6573 7420          request 
+00017d50: 3d20 5265 7175 6573 7428 0a20 2020 2020  = Request(.     
+00017d60: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00017d70: 6574 686f 643d 2270 6f73 7422 2c0a 2020  ethod="post",.  
+00017d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017d90: 2020 656e 6470 6f69 6e74 3d22 2f5f 6170    endpoint="/_ap
+00017da0: 692f 696d 706f 7274 222c 0a20 2020 2020  i/import",.     
+00017db0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00017dc0: 6174 613d 6261 7463 682c 0a20 2020 2020  ata=batch,.     
+00017dd0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00017de0: 6172 616d 733d 7061 7261 6d73 2c0a 2020  arams=params,.  
+00017df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017e00: 2020 7772 6974 653d 7365 6c66 2e6e 616d    write=self.nam
+00017e10: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00017e20: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00017e30: 2020 2020 2072 6573 756c 7473 2e61 7070       results.app
+00017e40: 656e 6428 7365 6c66 2e5f 6578 6563 7574  end(self._execut
+00017e50: 6528 7265 7175 6573 742c 2072 6573 706f  e(request, respo
+00017e60: 6e73 655f 6861 6e64 6c65 7229 290a 0a20  nse_handler)).. 
+00017e70: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00017e80: 6e20 7265 7375 6c74 730a 0a0a 636c 6173  n results...clas
+00017e90: 7320 5374 616e 6461 7264 436f 6c6c 6563  s StandardCollec
+00017ea0: 7469 6f6e 2843 6f6c 6c65 6374 696f 6e29  tion(Collection)
+00017eb0: 3a0a 2020 2020 2222 2253 7461 6e64 6172  :.    """Standar
+00017ec0: 6420 4172 616e 676f 4442 2063 6f6c 6c65  d ArangoDB colle
+00017ed0: 6374 696f 6e20 4150 4920 7772 6170 7065  ction API wrappe
+00017ee0: 722e 2222 220a 0a20 2020 2064 6566 205f  r."""..    def _
+00017ef0: 5f72 6570 725f 5f28 7365 6c66 2920 2d3e  _repr__(self) ->
+00017f00: 2073 7472 3a0a 2020 2020 2020 2020 7265   str:.        re
+00017f10: 7475 726e 2066 223c 5374 616e 6461 7264  turn f"<Standard
+00017f20: 436f 6c6c 6563 7469 6f6e 207b 7365 6c66  Collection {self
+00017f30: 2e6e 616d 657d 3e22 0a0a 2020 2020 6465  .name}>"..    de
+00017f40: 6620 5f5f 6765 7469 7465 6d5f 5f28 7365  f __getitem__(se
+00017f50: 6c66 2c20 6b65 793a 2055 6e69 6f6e 5b73  lf, key: Union[s
+00017f60: 7472 2c20 4a73 6f6e 5d29 202d 3e20 5265  tr, Json]) -> Re
+00017f70: 7375 6c74 5b4f 7074 696f 6e61 6c5b 4a73  sult[Optional[Js
+00017f80: 6f6e 5d5d 3a0a 2020 2020 2020 2020 7265  on]]:.        re
+00017f90: 7475 726e 2073 656c 662e 6765 7428 6b65  turn self.get(ke
+00017fa0: 7929 0a0a 2020 2020 6465 6620 6765 7428  y)..    def get(
+00017fb0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00017fc0: 2020 2020 2020 2064 6f63 756d 656e 743a         document:
+00017fd0: 2055 6e69 6f6e 5b73 7472 2c20 4a73 6f6e   Union[str, Json
+00017fe0: 5d2c 0a20 2020 2020 2020 2072 6576 3a20  ],.        rev: 
+00017ff0: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
+00018000: 4e6f 6e65 2c0a 2020 2020 2020 2020 6368  None,.        ch
+00018010: 6563 6b5f 7265 763a 2062 6f6f 6c20 3d20  eck_rev: bool = 
+00018020: 5472 7565 2c0a 2020 2020 2020 2020 616c  True,.        al
+00018030: 6c6f 775f 6469 7274 795f 7265 6164 3a20  low_dirty_read: 
+00018040: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+00018050: 2020 2920 2d3e 2052 6573 756c 745b 4f70    ) -> Result[Op
+00018060: 7469 6f6e 616c 5b4a 736f 6e5d 5d3a 0a20  tional[Json]]:. 
+00018070: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+00018080: 2061 2064 6f63 756d 656e 742e 0a0a 2020   a document...  
+00018090: 2020 2020 2020 3a70 6172 616d 2064 6f63        :param doc
+000180a0: 756d 656e 743a 2044 6f63 756d 656e 7420  ument: Document 
+000180b0: 4944 2c20 6b65 7920 6f72 2062 6f64 792e  ID, key or body.
+000180c0: 2044 6f63 756d 656e 7420 626f 6479 206d   Document body m
+000180d0: 7573 7420 636f 6e74 6169 6e0a 2020 2020  ust contain.    
+000180e0: 2020 2020 2020 2020 7468 6520 225f 6964          the "_id
+000180f0: 2220 6f72 2022 5f6b 6579 2220 6669 656c  " or "_key" fiel
+00018100: 642e 0a20 2020 2020 2020 203a 7479 7065  d..        :type
+00018110: 2064 6f63 756d 656e 743a 2073 7472 207c   document: str |
+00018120: 2064 6963 740a 2020 2020 2020 2020 3a70   dict.        :p
+00018130: 6172 616d 2072 6576 3a20 4578 7065 6374  aram rev: Expect
+00018140: 6564 2064 6f63 756d 656e 7420 7265 7669  ed document revi
+00018150: 7369 6f6e 2e20 4f76 6572 7269 6465 7320  sion. Overrides 
+00018160: 7468 6520 7661 6c75 6520 6f66 2022 5f72  the value of "_r
+00018170: 6576 220a 2020 2020 2020 2020 2020 2020  ev".            
+00018180: 6669 656c 6420 696e 202a 2a64 6f63 756d  field in **docum
+00018190: 656e 742a 2a20 6966 2070 7265 7365 6e74  ent** if present
+000181a0: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
+000181b0: 7265 763a 2073 7472 207c 204e 6f6e 650a  rev: str | None.
+000181c0: 2020 2020 2020 2020 3a70 6172 616d 2063          :param c
+000181d0: 6865 636b 5f72 6576 3a20 4966 2073 6574  heck_rev: If set
+000181e0: 2074 6f20 5472 7565 2c20 7265 7669 7369   to True, revisi
+000181f0: 6f6e 206f 6620 2a2a 646f 6375 6d65 6e74  on of **document
+00018200: 2a2a 2028 6966 2067 6976 656e 290a 2020  ** (if given).  
+00018210: 2020 2020 2020 2020 2020 6973 2063 6f6d            is com
+00018220: 7061 7265 6420 6167 6169 6e73 7420 7468  pared against th
+00018230: 6520 7265 7669 7369 6f6e 206f 6620 7461  e revision of ta
+00018240: 7267 6574 2064 6f63 756d 656e 742e 0a20  rget document.. 
+00018250: 2020 2020 2020 203a 7479 7065 2063 6865         :type che
+00018260: 636b 5f72 6576 3a20 626f 6f6c 0a20 2020  ck_rev: bool.   
+00018270: 2020 2020 203a 7061 7261 6d20 616c 6c6f       :param allo
+00018280: 775f 6469 7274 795f 7265 6164 3a20 416c  w_dirty_read: Al
+00018290: 6c6f 7720 7265 6164 7320 6672 6f6d 2066  low reads from f
+000182a0: 6f6c 6c6f 7765 7273 2069 6e20 6120 636c  ollowers in a cl
+000182b0: 7573 7465 722e 0a20 2020 2020 2020 203a  uster..        :
+000182c0: 7479 7065 2061 6c6c 6f77 5f64 6972 7479  type allow_dirty
+000182d0: 5f72 6561 643a 2062 6f6f 6c0a 2020 2020  _read: bool.    
+000182e0: 2020 2020 3a72 6574 7572 6e3a 2044 6f63      :return: Doc
+000182f0: 756d 656e 742c 206f 7220 4e6f 6e65 2069  ument, or None i
+00018300: 6620 6e6f 7420 666f 756e 642e 0a20 2020  f not found..   
+00018310: 2020 2020 203a 7274 7970 653a 2064 6963       :rtype: dic
+00018320: 7420 7c20 4e6f 6e65 0a20 2020 2020 2020  t | None.       
+00018330: 203a 7261 6973 6520 6172 616e 676f 2e65   :raise arango.e
+00018340: 7863 6570 7469 6f6e 732e 446f 6375 6d65  xceptions.Docume
+00018350: 6e74 4765 7445 7272 6f72 3a20 4966 2072  ntGetError: If r
+00018360: 6574 7269 6576 616c 2066 6169 6c73 2e0a  etrieval fails..
+00018370: 2020 2020 2020 2020 3a72 6169 7365 2061          :raise a
+00018380: 7261 6e67 6f2e 6578 6365 7074 696f 6e73  rango.exceptions
+00018390: 2e44 6f63 756d 656e 7452 6576 6973 696f  .DocumentRevisio
+000183a0: 6e45 7272 6f72 3a20 4966 2072 6576 6973  nError: If revis
+000183b0: 696f 6e73 206d 6973 6d61 7463 682e 0a20  ions mismatch.. 
+000183c0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000183d0: 2020 2068 616e 646c 652c 2062 6f64 792c     handle, body,
+000183e0: 2068 6561 6465 7273 203d 2073 656c 662e   headers = self.
+000183f0: 5f70 7265 705f 6672 6f6d 5f64 6f63 2864  _prep_from_doc(d
+00018400: 6f63 756d 656e 742c 2072 6576 2c20 6368  ocument, rev, ch
+00018410: 6563 6b5f 7265 7629 0a0a 2020 2020 2020  eck_rev)..      
+00018420: 2020 6966 2061 6c6c 6f77 5f64 6972 7479    if allow_dirty
+00018430: 5f72 6561 643a 0a20 2020 2020 2020 2020  _read:.         
+00018440: 2020 2068 6561 6465 7273 5b22 782d 6172     headers["x-ar
+00018450: 616e 676f 2d61 6c6c 6f77 2d64 6972 7479  ango-allow-dirty
+00018460: 2d72 6561 6422 5d20 3d20 2274 7275 6522  -read"] = "true"
+00018470: 0a0a 2020 2020 2020 2020 7265 7175 6573  ..        reques
+00018480: 7420 3d20 5265 7175 6573 7428 0a20 2020  t = Request(.   
+00018490: 2020 2020 2020 2020 206d 6574 686f 643d           method=
+000184a0: 2267 6574 222c 0a20 2020 2020 2020 2020  "get",.         
+000184b0: 2020 2065 6e64 706f 696e 743d 6622 2f5f     endpoint=f"/_
+000184c0: 6170 692f 646f 6375 6d65 6e74 2f7b 6861  api/document/{ha
+000184d0: 6e64 6c65 7d22 2c0a 2020 2020 2020 2020  ndle}",.        
+000184e0: 2020 2020 6865 6164 6572 733d 6865 6164      headers=head
+000184f0: 6572 732c 0a20 2020 2020 2020 2020 2020  ers,.           
+00018500: 2072 6561 643d 7365 6c66 2e6e 616d 652c   read=self.name,
+00018510: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00018520: 2020 2020 6465 6620 7265 7370 6f6e 7365      def response
+00018530: 5f68 616e 646c 6572 2872 6573 703a 2052  _handler(resp: R
+00018540: 6573 706f 6e73 6529 202d 3e20 4f70 7469  esponse) -> Opti
+00018550: 6f6e 616c 5b4a 736f 6e5d 3a0a 2020 2020  onal[Json]:.    
+00018560: 2020 2020 2020 2020 6966 2072 6573 702e          if resp.
+00018570: 6572 726f 725f 636f 6465 203d 3d20 3132  error_code == 12
+00018580: 3032 3a0a 2020 2020 2020 2020 2020 2020  02:.            
+00018590: 2020 2020 7265 7475 726e 204e 6f6e 650a      return None.
+000185a0: 2020 2020 2020 2020 2020 2020 6966 2072              if r
+000185b0: 6573 702e 7374 6174 7573 5f63 6f64 6520  esp.status_code 
+000185c0: 3d3d 2034 3132 3a0a 2020 2020 2020 2020  == 412:.        
+000185d0: 2020 2020 2020 2020 7261 6973 6520 446f          raise Do
+000185e0: 6375 6d65 6e74 5265 7669 7369 6f6e 4572  cumentRevisionEr
+000185f0: 726f 7228 7265 7370 2c20 7265 7175 6573  ror(resp, reques
+00018600: 7429 0a20 2020 2020 2020 2020 2020 2069  t).            i
+00018610: 6620 6e6f 7420 7265 7370 2e69 735f 7375  f not resp.is_su
+00018620: 6363 6573 733a 0a20 2020 2020 2020 2020  ccess:.         
+00018630: 2020 2020 2020 2072 6169 7365 2044 6f63         raise Doc
+00018640: 756d 656e 7447 6574 4572 726f 7228 7265  umentGetError(re
+00018650: 7370 2c20 7265 7175 6573 7429 0a0a 2020  sp, request)..  
+00018660: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00018670: 3a20 4a73 6f6e 203d 2072 6573 702e 626f  : Json = resp.bo
+00018680: 6479 0a20 2020 2020 2020 2020 2020 2072  dy.            r
+00018690: 6574 7572 6e20 7265 7375 6c74 0a0a 2020  eturn result..  
+000186a0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000186b0: 662e 5f65 7865 6375 7465 2872 6571 7565  f._execute(reque
+000186c0: 7374 2c20 7265 7370 6f6e 7365 5f68 616e  st, response_han
+000186d0: 646c 6572 290a 0a20 2020 2064 6566 2069  dler)..    def i
+000186e0: 6e73 6572 7428 0a20 2020 2020 2020 2073  nsert(.        s
+000186f0: 656c 662c 0a20 2020 2020 2020 2064 6f63  elf,.        doc
+00018700: 756d 656e 743a 204a 736f 6e2c 0a20 2020  ument: Json,.   
+00018710: 2020 2020 2072 6574 7572 6e5f 6e65 773a       return_new:
+00018720: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
+00018730: 2020 2020 2020 2073 796e 633a 204f 7074         sync: Opt
+00018740: 696f 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f  ional[bool] = No
+00018750: 6e65 2c0a 2020 2020 2020 2020 7369 6c65  ne,.        sile
+00018760: 6e74 3a20 626f 6f6c 203d 2046 616c 7365  nt: bool = False
+00018770: 2c0a 2020 2020 2020 2020 6f76 6572 7772  ,.        overwr
+00018780: 6974 653a 2062 6f6f 6c20 3d20 4661 6c73  ite: bool = Fals
+00018790: 652c 0a20 2020 2020 2020 2072 6574 7572  e,.        retur
+000187a0: 6e5f 6f6c 643a 2062 6f6f 6c20 3d20 4661  n_old: bool = Fa
+000187b0: 6c73 652c 0a20 2020 2020 2020 206f 7665  lse,.        ove
+000187c0: 7277 7269 7465 5f6d 6f64 653a 204f 7074  rwrite_mode: Opt
+000187d0: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
+000187e0: 652c 0a20 2020 2020 2020 206b 6565 705f  e,.        keep_
+000187f0: 6e6f 6e65 3a20 4f70 7469 6f6e 616c 5b62  none: Optional[b
+00018800: 6f6f 6c5d 203d 204e 6f6e 652c 0a20 2020  ool] = None,.   
+00018810: 2020 2020 206d 6572 6765 3a20 4f70 7469       merge: Opti
+00018820: 6f6e 616c 5b62 6f6f 6c5d 203d 204e 6f6e  onal[bool] = Non
+00018830: 652c 0a20 2020 2020 2020 2072 6566 696c  e,.        refil
+00018840: 6c5f 696e 6465 785f 6361 6368 6573 3a20  l_index_caches: 
+00018850: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 203d  Optional[bool] =
+00018860: 204e 6f6e 652c 0a20 2020 2020 2020 2076   None,.        v
+00018870: 6572 7369 6f6e 5f61 7474 7269 6275 7465  ersion_attribute
+00018880: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+00018890: 3d20 4e6f 6e65 2c0a 2020 2020 2920 2d3e  = None,.    ) ->
+000188a0: 2052 6573 756c 745b 556e 696f 6e5b 626f   Result[Union[bo
+000188b0: 6f6c 2c20 4a73 6f6e 5d5d 3a0a 2020 2020  ol, Json]]:.    
+000188c0: 2020 2020 2222 2249 6e73 6572 7420 6120      """Insert a 
+000188d0: 6e65 7720 646f 6375 6d65 6e74 2e0a 0a20  new document... 
+000188e0: 2020 2020 2020 203a 7061 7261 6d20 646f         :param do
+000188f0: 6375 6d65 6e74 3a20 446f 6375 6d65 6e74  cument: Document
+00018900: 2074 6f20 696e 7365 7274 2e20 4966 2069   to insert. If i
+00018910: 7420 636f 6e74 6169 6e73 2074 6865 2022  t contains the "
+00018920: 5f6b 6579 2220 6f72 2022 5f69 6422 0a20  _key" or "_id". 
+00018930: 2020 2020 2020 2020 2020 2066 6965 6c64             field
+00018940: 2c20 7468 6520 7661 6c75 6520 6973 2075  , the value is u
+00018950: 7365 6420 6173 2074 6865 206b 6579 206f  sed as the key o
+00018960: 6620 7468 6520 6e65 7720 646f 6375 6d65  f the new docume
+00018970: 6e74 2028 6f74 6865 7277 6973 650a 2020  nt (otherwise.  
+00018980: 2020 2020 2020 2020 2020 6974 2069 7320            it is 
+00018990: 6175 746f 2d67 656e 6572 6174 6564 292e  auto-generated).
+000189a0: 2041 6e79 2022 5f72 6576 2220 6669 656c   Any "_rev" fiel
+000189b0: 6420 6973 2069 676e 6f72 6564 2e0a 2020  d is ignored..  
+000189c0: 2020 2020 2020 3a74 7970 6520 646f 6375        :type docu
+000189d0: 6d65 6e74 3a20 6469 6374 0a20 2020 2020  ment: dict.     
+000189e0: 2020 203a 7061 7261 6d20 7265 7475 726e     :param return
+000189f0: 5f6e 6577 3a20 496e 636c 7564 6520 626f  _new: Include bo
+00018a00: 6479 206f 6620 7468 6520 6e65 7720 646f  dy of the new do
+00018a10: 6375 6d65 6e74 2069 6e20 7468 6520 7265  cument in the re
+00018a20: 7475 726e 6564 0a20 2020 2020 2020 2020  turned.         
+00018a30: 2020 206d 6574 6164 6174 612e 2049 676e     metadata. Ign
+00018a40: 6f72 6564 2069 6620 7061 7261 6d65 7465  ored if paramete
+00018a50: 7220 2a2a 7369 6c65 6e74 2a2a 2069 7320  r **silent** is 
+00018a60: 7365 7420 746f 2054 7275 652e 0a20 2020  set to True..   
+00018a70: 2020 2020 203a 7479 7065 2072 6574 7572       :type retur
+00018a80: 6e5f 6e65 773a 2062 6f6f 6c0a 2020 2020  n_new: bool.    
+00018a90: 2020 2020 3a70 6172 616d 2073 796e 633a      :param sync:
+00018aa0: 2042 6c6f 636b 2075 6e74 696c 206f 7065   Block until ope
+00018ab0: 7261 7469 6f6e 2069 7320 7379 6e63 6872  ration is synchr
+00018ac0: 6f6e 697a 6564 2074 6f20 6469 736b 2e0a  onized to disk..
+00018ad0: 2020 2020 2020 2020 3a74 7970 6520 7379          :type sy
+00018ae0: 6e63 3a20 626f 6f6c 207c 204e 6f6e 650a  nc: bool | None.
+00018af0: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
+00018b00: 696c 656e 743a 2049 6620 7365 7420 746f  ilent: If set to
+00018b10: 2054 7275 652c 206e 6f20 646f 6375 6d65   True, no docume
+00018b20: 6e74 206d 6574 6164 6174 6120 6973 2072  nt metadata is r
+00018b30: 6574 7572 6e65 642e 2054 6869 730a 2020  eturned. This.  
+00018b40: 2020 2020 2020 2020 2020 6361 6e20 6265            can be
+00018b50: 2075 7365 6420 746f 2073 6176 6520 7265   used to save re
+00018b60: 736f 7572 6365 732e 0a20 2020 2020 2020  sources..       
+00018b70: 203a 7479 7065 2073 696c 656e 743a 2062   :type silent: b
+00018b80: 6f6f 6c0a 2020 2020 2020 2020 3a70 6172  ool.        :par
+00018b90: 616d 206f 7665 7277 7269 7465 3a20 4966  am overwrite: If
+00018ba0: 2073 6574 2074 6f20 5472 7565 2c20 6f70   set to True, op
+00018bb0: 6572 6174 696f 6e20 646f 6573 206e 6f74  eration does not
+00018bc0: 2066 6169 6c20 6f6e 2064 7570 6c69 6361   fail on duplica
+00018bd0: 7465 0a20 2020 2020 2020 2020 2020 206b  te.            k
+00018be0: 6579 2061 6e64 2065 7869 7374 696e 6720  ey and existing 
+00018bf0: 646f 6375 6d65 6e74 2069 7320 6f76 6572  document is over
+00018c00: 7772 6974 7465 6e20 2872 6570 6c61 6365  written (replace
+00018c10: 2d69 6e73 6572 7429 2e0a 2020 2020 2020  -insert)..      
+00018c20: 2020 3a74 7970 6520 6f76 6572 7772 6974    :type overwrit
+00018c30: 653a 2062 6f6f 6c0a 2020 2020 2020 2020  e: bool.        
+00018c40: 3a70 6172 616d 2072 6574 7572 6e5f 6f6c  :param return_ol
+00018c50: 643a 2049 6e63 6c75 6465 2062 6f64 7920  d: Include body 
+00018c60: 6f66 2074 6865 206f 6c64 2064 6f63 756d  of the old docum
+00018c70: 656e 7420 6966 206f 7665 7277 7269 7474  ent if overwritt
+00018c80: 656e 2e0a 2020 2020 2020 2020 2020 2020  en..            
+00018c90: 4967 6e6f 7265 6420 6966 2070 6172 616d  Ignored if param
+00018ca0: 6574 6572 202a 2a73 696c 656e 742a 2a20  eter **silent** 
+00018cb0: 6973 2073 6574 2074 6f20 5472 7565 2e0a  is set to True..
+00018cc0: 2020 2020 2020 2020 3a74 7970 6520 7265          :type re
+00018cd0: 7475 726e 5f6f 6c64 3a20 626f 6f6c 0a20  turn_old: bool. 
+00018ce0: 2020 2020 2020 203a 7061 7261 6d20 6f76         :param ov
+00018cf0: 6572 7772 6974 655f 6d6f 6465 3a20 4f76  erwrite_mode: Ov
+00018d00: 6572 7772 6974 6520 6265 6861 7669 6f72  erwrite behavior
+00018d10: 2075 7365 6420 7768 656e 2074 6865 2064   used when the d
+00018d20: 6f63 756d 656e 7420 6b65 790a 2020 2020  ocument key.    
+00018d30: 2020 2020 2020 2020 6578 6973 7473 2061          exists a
+00018d40: 6c72 6561 6479 2e20 416c 6c6f 7765 6420  lready. Allowed 
+00018d50: 7661 6c75 6573 2061 7265 2022 7265 706c  values are "repl
+00018d60: 6163 6522 2028 7265 706c 6163 652d 696e  ace" (replace-in
+00018d70: 7365 7274 2920 6f72 0a20 2020 2020 2020  sert) or.       
+00018d80: 2020 2020 2022 7570 6461 7465 2220 2875       "update" (u
+00018d90: 7064 6174 652d 696e 7365 7274 292e 2049  pdate-insert). I
+00018da0: 6d70 6c69 6369 746c 7920 7365 7473 2074  mplicitly sets t
+00018db0: 6865 2076 616c 7565 206f 6620 7061 7261  he value of para
+00018dc0: 6d65 7465 720a 2020 2020 2020 2020 2020  meter.          
+00018dd0: 2020 2a2a 6f76 6572 7772 6974 652a 2a2e    **overwrite**.
+00018de0: 0a20 2020 2020 2020 203a 7479 7065 206f  .        :type o
+00018df0: 7665 7277 7269 7465 5f6d 6f64 653a 2073  verwrite_mode: s
+00018e00: 7472 207c 204e 6f6e 650a 2020 2020 2020  tr | None.      
+00018e10: 2020 3a70 6172 616d 206b 6565 705f 6e6f    :param keep_no
+00018e20: 6e65 3a20 4966 2073 6574 2074 6f20 5472  ne: If set to Tr
+00018e30: 7565 2c20 6669 656c 6473 2077 6974 6820  ue, fields with 
+00018e40: 7661 6c75 6520 4e6f 6e65 2061 7265 2072  value None are r
+00018e50: 6574 6169 6e65 640a 2020 2020 2020 2020  etained.        
+00018e60: 2020 2020 696e 2074 6865 2064 6f63 756d      in the docum
+00018e70: 656e 742e 204f 7468 6572 7769 7365 2c20  ent. Otherwise, 
+00018e80: 7468 6579 2061 7265 2072 656d 6f76 6564  they are removed
+00018e90: 2063 6f6d 706c 6574 656c 792e 2041 7070   completely. App
+00018ea0: 6c69 6573 0a20 2020 2020 2020 2020 2020  lies.           
+00018eb0: 206f 6e6c 7920 7768 656e 202a 2a6f 7665   only when **ove
+00018ec0: 7277 7269 7465 5f6d 6f64 652a 2a20 6973  rwrite_mode** is
+00018ed0: 2073 6574 2074 6f20 2275 7064 6174 6522   set to "update"
+00018ee0: 2028 7570 6461 7465 2d69 6e73 6572 7429   (update-insert)
+00018ef0: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
+00018f00: 6b65 6570 5f6e 6f6e 653a 2062 6f6f 6c20  keep_none: bool 
+00018f10: 7c20 4e6f 6e65 0a20 2020 2020 2020 203a  | None.        :
+00018f20: 7061 7261 6d20 6d65 7267 653a 2049 6620  param merge: If 
+00018f30: 7365 7420 746f 2054 7275 6520 2864 6566  set to True (def
+00018f40: 6175 6c74 292c 2073 7562 2d64 6963 7469  ault), sub-dicti
+00018f50: 6f6e 6172 6965 7320 6172 6520 6d65 7267  onaries are merg
+00018f60: 6564 0a20 2020 2020 2020 2020 2020 2069  ed.            i
+00018f70: 6e73 7465 6164 206f 6620 7468 6520 6e65  nstead of the ne
+00018f80: 7720 6f6e 6520 6f76 6572 7772 6974 696e  w one overwritin
+00018f90: 6720 7468 6520 6f6c 6420 6f6e 652e 2041  g the old one. A
+00018fa0: 7070 6c69 6573 206f 6e6c 7920 7768 656e  pplies only when
+00018fb0: 0a20 2020 2020 2020 2020 2020 202a 2a6f  .            **o
+00018fc0: 7665 7277 7269 7465 5f6d 6f64 652a 2a20  verwrite_mode** 
+00018fd0: 6973 2073 6574 2074 6f20 2275 7064 6174  is set to "updat
+00018fe0: 6522 2028 7570 6461 7465 2d69 6e73 6572  e" (update-inser
+00018ff0: 7429 2e0a 2020 2020 2020 2020 3a74 7970  t)..        :typ
+00019000: 6520 6d65 7267 653a 2062 6f6f 6c20 7c20  e merge: bool | 
+00019010: 4e6f 6e65 0a20 2020 2020 2020 203a 7061  None.        :pa
+00019020: 7261 6d20 7265 6669 6c6c 5f69 6e64 6578  ram refill_index
+00019030: 5f63 6163 6865 733a 2057 6865 7468 6572  _caches: Whether
+00019040: 2074 6f20 6164 6420 6e65 7720 656e 7472   to add new entr
+00019050: 6965 7320 746f 2069 6e2d 6d65 6d6f 7279  ies to in-memory
+00019060: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
+00019070: 6578 2063 6163 6865 7320 6966 2064 6f63  ex caches if doc
+00019080: 756d 656e 7420 696e 7365 7274 696f 6e73  ument insertions
+00019090: 2061 6666 6563 7420 7468 6520 6564 6765   affect the edge
+000190a0: 2069 6e64 6578 206f 720a 2020 2020 2020   index or.      
+000190b0: 2020 2020 2020 6361 6368 652d 656e 6162        cache-enab
+000190c0: 6c65 6420 7065 7273 6973 7465 6e74 2069  led persistent i
+000190d0: 6e64 6578 6573 2e0a 2020 2020 2020 2020  ndexes..        
+000190e0: 3a74 7970 6520 7265 6669 6c6c 5f69 6e64  :type refill_ind
+000190f0: 6578 5f63 6163 6865 733a 2062 6f6f 6c20  ex_caches: bool 
+00019100: 7c20 4e6f 6e65 0a20 2020 2020 2020 203a  | None.        :
+00019110: 7061 7261 6d20 7665 7273 696f 6e5f 6174  param version_at
+00019120: 7472 6962 7574 653a 2073 7570 706f 7274  tribute: support
+00019130: 2066 6f72 2073 696d 706c 6520 6578 7465   for simple exte
+00019140: 726e 616c 2076 6572 7369 6f6e 696e 6720  rnal versioning 
+00019150: 746f 0a20 2020 2020 2020 2020 2020 2064  to.            d
+00019160: 6f63 756d 656e 7420 6f70 6572 6174 696f  ocument operatio
+00019170: 6e73 2e0a 2020 2020 2020 2020 3a74 7970  ns..        :typ
+00019180: 6520 7665 7273 696f 6e5f 6174 7472 6962  e version_attrib
+00019190: 7574 653a 2073 7472 0a20 2020 2020 2020  ute: str.       
+000191a0: 203a 7265 7475 726e 3a20 446f 6375 6d65   :return: Docume
+000191b0: 6e74 206d 6574 6164 6174 6120 2865 2e67  nt metadata (e.g
+000191c0: 2e20 646f 6375 6d65 6e74 206b 6579 2c20  . document key, 
+000191d0: 7265 7669 7369 6f6e 2920 6f72 2054 7275  revision) or Tru
+000191e0: 6520 6966 0a20 2020 2020 2020 2020 2020  e if.           
+000191f0: 2070 6172 616d 6574 6572 202a 2a73 696c   parameter **sil
+00019200: 656e 742a 2a20 7761 7320 7365 7420 746f  ent** was set to
+00019210: 2054 7275 652e 0a20 2020 2020 2020 203a   True..        :
+00019220: 7274 7970 653a 2062 6f6f 6c20 7c20 6469  rtype: bool | di
+00019230: 6374 0a20 2020 2020 2020 203a 7261 6973  ct.        :rais
+00019240: 6520 6172 616e 676f 2e65 7863 6570 7469  e arango.excepti
+00019250: 6f6e 732e 446f 6375 6d65 6e74 496e 7365  ons.DocumentInse
+00019260: 7274 4572 726f 723a 2049 6620 696e 7365  rtError: If inse
+00019270: 7274 2066 6169 6c73 2e0a 2020 2020 2020  rt fails..      
+00019280: 2020 2222 220a 2020 2020 2020 2020 646f    """.        do
+00019290: 6375 6d65 6e74 203d 2073 656c 662e 5f65  cument = self._e
+000192a0: 6e73 7572 655f 6b65 795f 6672 6f6d 5f69  nsure_key_from_i
+000192b0: 6428 646f 6375 6d65 6e74 290a 0a20 2020  d(document)..   
+000192c0: 2020 2020 2070 6172 616d 733a 2050 6172       params: Par
+000192d0: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
+000192e0: 2020 2020 2272 6574 7572 6e4e 6577 223a      "returnNew":
+000192f0: 2072 6574 7572 6e5f 6e65 772c 0a20 2020   return_new,.   
+00019300: 2020 2020 2020 2020 2022 7369 6c65 6e74           "silent
+00019310: 223a 2073 696c 656e 742c 0a20 2020 2020  ": silent,.     
+00019320: 2020 2020 2020 2022 6f76 6572 7772 6974         "overwrit
+00019330: 6522 3a20 6f76 6572 7772 6974 652c 0a20  e": overwrite,. 
+00019340: 2020 2020 2020 2020 2020 2022 7265 7475             "retu
+00019350: 726e 4f6c 6422 3a20 7265 7475 726e 5f6f  rnOld": return_o
+00019360: 6c64 2c0a 2020 2020 2020 2020 7d0a 2020  ld,.        }.  
+00019370: 2020 2020 2020 6966 2073 796e 6320 6973        if sync is
+00019380: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00019390: 2020 2020 2020 2070 6172 616d 735b 2277         params["w
+000193a0: 6169 7446 6f72 5379 6e63 225d 203d 2073  aitForSync"] = s
+000193b0: 796e 630a 2020 2020 2020 2020 6966 206f  ync.        if o
+000193c0: 7665 7277 7269 7465 5f6d 6f64 6520 6973  verwrite_mode is
+000193d0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+000193e0: 2020 2020 2020 2070 6172 616d 735b 226f         params["o
+000193f0: 7665 7277 7269 7465 4d6f 6465 225d 203d  verwriteMode"] =
+00019400: 206f 7665 7277 7269 7465 5f6d 6f64 650a   overwrite_mode.
+00019410: 2020 2020 2020 2020 6966 206b 6565 705f          if keep_
+00019420: 6e6f 6e65 2069 7320 6e6f 7420 4e6f 6e65  none is not None
+00019430: 3a0a 2020 2020 2020 2020 2020 2020 7061  :.            pa
+00019440: 7261 6d73 5b22 6b65 6570 4e75 6c6c 225d  rams["keepNull"]
+00019450: 203d 206b 6565 705f 6e6f 6e65 0a20 2020   = keep_none.   
+00019460: 2020 2020 2069 6620 6d65 7267 6520 6973       if merge is
+00019470: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00019480: 2020 2020 2020 2070 6172 616d 735b 226d         params["m
+00019490: 6572 6765 4f62 6a65 6374 7322 5d20 3d20  ergeObjects"] = 
+000194a0: 6d65 7267 650a 2020 2020 2020 2020 6966  merge.        if
+000194b0: 2076 6572 7369 6f6e 5f61 7474 7269 6275   version_attribu
+000194c0: 7465 2069 7320 6e6f 7420 4e6f 6e65 3a0a  te is not None:.
+000194d0: 2020 2020 2020 2020 2020 2020 7061 7261              para
+000194e0: 6d73 5b22 7665 7273 696f 6e41 7474 7269  ms["versionAttri
+000194f0: 6275 7465 225d 203d 2076 6572 7369 6f6e  bute"] = version
+00019500: 5f61 7474 7269 6275 7465 0a0a 2020 2020  _attribute..    
+00019510: 2020 2020 2320 4e65 7720 696e 2041 7261      # New in Ara
+00019520: 6e67 6f44 4220 332e 392e 3620 616e 6420  ngoDB 3.9.6 and 
+00019530: 332e 3130 2e32 0a20 2020 2020 2020 2069  3.10.2.        i
+00019540: 6620 7265 6669 6c6c 5f69 6e64 6578 5f63  f refill_index_c
+00019550: 6163 6865 7320 6973 206e 6f74 204e 6f6e  aches is not Non
+00019560: 653a 0a20 2020 2020 2020 2020 2020 2070  e:.            p
+00019570: 6172 616d 735b 2272 6566 696c 6c49 6e64  arams["refillInd
+00019580: 6578 4361 6368 6573 225d 203d 2072 6566  exCaches"] = ref
+00019590: 696c 6c5f 696e 6465 785f 6361 6368 6573  ill_index_caches
+000195a0: 0a0a 2020 2020 2020 2020 7265 7175 6573  ..        reques
+000195b0: 7420 3d20 5265 7175 6573 7428 0a20 2020  t = Request(.   
+000195c0: 2020 2020 2020 2020 206d 6574 686f 643d           method=
+000195d0: 2270 6f73 7422 2c0a 2020 2020 2020 2020  "post",.        
+000195e0: 2020 2020 656e 6470 6f69 6e74 3d66 222f      endpoint=f"/
+000195f0: 5f61 7069 2f64 6f63 756d 656e 742f 7b73  _api/document/{s
+00019600: 656c 662e 6e61 6d65 7d22 2c0a 2020 2020  elf.name}",.    
+00019610: 2020 2020 2020 2020 6461 7461 3d64 6f63          data=doc
+00019620: 756d 656e 742c 0a20 2020 2020 2020 2020  ument,.         
+00019630: 2020 2070 6172 616d 733d 7061 7261 6d73     params=params
+00019640: 2c0a 2020 2020 2020 2020 2020 2020 7772  ,.            wr
+00019650: 6974 653d 7365 6c66 2e6e 616d 652c 0a20  ite=self.name,. 
+00019660: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00019670: 2020 6465 6620 7265 7370 6f6e 7365 5f68    def response_h
+00019680: 616e 646c 6572 2872 6573 703a 2052 6573  andler(resp: Res
+00019690: 706f 6e73 6529 202d 3e20 556e 696f 6e5b  ponse) -> Union[
+000196a0: 626f 6f6c 2c20 4a73 6f6e 5d3a 0a20 2020  bool, Json]:.   
+000196b0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+000196c0: 7265 7370 2e69 735f 7375 6363 6573 733a  resp.is_success:
+000196d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000196e0: 2072 6169 7365 2044 6f63 756d 656e 7449   raise DocumentI
+000196f0: 6e73 6572 7445 7272 6f72 2872 6573 702c  nsertError(resp,
+00019700: 2072 6571 7565 7374 290a 0a20 2020 2020   request)..     
+00019710: 2020 2020 2020 2069 6620 7369 6c65 6e74         if silent
+00019720: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00019730: 2020 7265 7475 726e 2054 7275 650a 0a20    return True.. 
+00019740: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00019750: 743a 204a 736f 6e20 3d20 7265 7370 2e62  t: Json = resp.b
+00019760: 6f64 790a 2020 2020 2020 2020 2020 2020  ody.            
+00019770: 6966 2022 5f6f 6c64 5265 7622 2069 6e20  if "_oldRev" in 
+00019780: 7265 7375 6c74 3a0a 2020 2020 2020 2020  result:.        
+00019790: 2020 2020 2020 2020 7265 7375 6c74 5b22          result["
+000197a0: 5f6f 6c64 5f72 6576 225d 203d 2072 6573  _old_rev"] = res
+000197b0: 756c 742e 706f 7028 225f 6f6c 6452 6576  ult.pop("_oldRev
+000197c0: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
+000197d0: 6574 7572 6e20 7265 7375 6c74 0a0a 2020  eturn result..  
+000197e0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000197f0: 662e 5f65 7865 6375 7465 2872 6571 7565  f._execute(reque
+00019800: 7374 2c20 7265 7370 6f6e 7365 5f68 616e  st, response_han
+00019810: 646c 6572 290a 0a20 2020 2064 6566 2075  dler)..    def u
+00019820: 7064 6174 6528 0a20 2020 2020 2020 2073  pdate(.        s
+00019830: 656c 662c 0a20 2020 2020 2020 2064 6f63  elf,.        doc
+00019840: 756d 656e 743a 204a 736f 6e2c 0a20 2020  ument: Json,.   
+00019850: 2020 2020 2063 6865 636b 5f72 6576 3a20       check_rev: 
+00019860: 626f 6f6c 203d 2054 7275 652c 0a20 2020  bool = True,.   
+00019870: 2020 2020 206d 6572 6765 3a20 626f 6f6c       merge: bool
+00019880: 203d 2054 7275 652c 0a20 2020 2020 2020   = True,.       
+00019890: 206b 6565 705f 6e6f 6e65 3a20 626f 6f6c   keep_none: bool
+000198a0: 203d 2054 7275 652c 0a20 2020 2020 2020   = True,.       
+000198b0: 2072 6574 7572 6e5f 6e65 773a 2062 6f6f   return_new: boo
+000198c0: 6c20 3d20 4661 6c73 652c 0a20 2020 2020  l = False,.     
+000198d0: 2020 2072 6574 7572 6e5f 6f6c 643a 2062     return_old: b
+000198e0: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
+000198f0: 2020 2020 2073 796e 633a 204f 7074 696f       sync: Optio
+00019900: 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65  nal[bool] = None
+00019910: 2c0a 2020 2020 2020 2020 7369 6c65 6e74  ,.        silent
+00019920: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
+00019930: 2020 2020 2020 2020 7265 6669 6c6c 5f69          refill_i
+00019940: 6e64 6578 5f63 6163 6865 733a 204f 7074  ndex_caches: Opt
+00019950: 696f 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f  ional[bool] = No
+00019960: 6e65 2c0a 2020 2020 2020 2020 7665 7273  ne,.        vers
+00019970: 696f 6e5f 6174 7472 6962 7574 653a 204f  ion_attribute: O
+00019980: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
+00019990: 6f6e 652c 0a20 2020 2029 202d 3e20 5265  one,.    ) -> Re
+000199a0: 7375 6c74 5b55 6e69 6f6e 5b62 6f6f 6c2c  sult[Union[bool,
+000199b0: 204a 736f 6e5d 5d3a 0a20 2020 2020 2020   Json]]:.       
+000199c0: 2022 2222 5570 6461 7465 2061 2064 6f63   """Update a doc
+000199d0: 756d 656e 742e 0a0a 2020 2020 2020 2020  ument...        
+000199e0: 3a70 6172 616d 2064 6f63 756d 656e 743a  :param document:
+000199f0: 2050 6172 7469 616c 206f 7220 6675 6c6c   Partial or full
+00019a00: 2064 6f63 756d 656e 7420 7769 7468 2074   document with t
+00019a10: 6865 2075 7064 6174 6564 2076 616c 7565  he updated value
+00019a20: 732e 2049 740a 2020 2020 2020 2020 2020  s. It.          
+00019a30: 2020 6d75 7374 2063 6f6e 7461 696e 2074    must contain t
+00019a40: 6865 2022 5f69 6422 206f 7220 225f 6b65  he "_id" or "_ke
+00019a50: 7922 2066 6965 6c64 2e0a 2020 2020 2020  y" field..      
+00019a60: 2020 3a74 7970 6520 646f 6375 6d65 6e74    :type document
+00019a70: 3a20 6469 6374 0a20 2020 2020 2020 203a  : dict.        :
+00019a80: 7061 7261 6d20 6368 6563 6b5f 7265 763a  param check_rev:
+00019a90: 2049 6620 7365 7420 746f 2054 7275 652c   If set to True,
+00019aa0: 2072 6576 6973 696f 6e20 6f66 202a 2a64   revision of **d
+00019ab0: 6f63 756d 656e 742a 2a20 2869 6620 6769  ocument** (if gi
+00019ac0: 7665 6e29 0a20 2020 2020 2020 2020 2020  ven).           
+00019ad0: 2069 7320 636f 6d70 6172 6564 2061 6761   is compared aga
+00019ae0: 696e 7374 2074 6865 2072 6576 6973 696f  inst the revisio
+00019af0: 6e20 6f66 2074 6172 6765 7420 646f 6375  n of target docu
+00019b00: 6d65 6e74 2e0a 2020 2020 2020 2020 3a74  ment..        :t
+00019b10: 7970 6520 6368 6563 6b5f 7265 763a 2062  ype check_rev: b
+00019b20: 6f6f 6c0a 2020 2020 2020 2020 3a70 6172  ool.        :par
+00019b30: 616d 206d 6572 6765 3a20 4966 2073 6574  am merge: If set
+00019b40: 2074 6f20 5472 7565 2c20 7375 622d 6469   to True, sub-di
+00019b50: 6374 696f 6e61 7269 6573 2061 7265 206d  ctionaries are m
+00019b60: 6572 6765 6420 696e 7374 6561 6420 6f66  erged instead of
+00019b70: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
+00019b80: 206e 6577 206f 6e65 206f 7665 7277 7269   new one overwri
+00019b90: 7469 6e67 2074 6865 206f 6c64 206f 6e65  ting the old one
+00019ba0: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
+00019bb0: 6d65 7267 653a 2062 6f6f 6c20 7c20 4e6f  merge: bool | No
+00019bc0: 6e65 0a20 2020 2020 2020 203a 7061 7261  ne.        :para
+00019bd0: 6d20 6b65 6570 5f6e 6f6e 653a 2049 6620  m keep_none: If 
+00019be0: 7365 7420 746f 2054 7275 652c 2066 6965  set to True, fie
+00019bf0: 6c64 7320 7769 7468 2076 616c 7565 204e  lds with value N
+00019c00: 6f6e 6520 6172 6520 7265 7461 696e 6564  one are retained
+00019c10: 0a20 2020 2020 2020 2020 2020 2069 6e20  .            in 
+00019c20: 7468 6520 646f 6375 6d65 6e74 2e20 4f74  the document. Ot
+00019c30: 6865 7277 6973 652c 2074 6865 7920 6172  herwise, they ar
+00019c40: 6520 7265 6d6f 7665 6420 636f 6d70 6c65  e removed comple
+00019c50: 7465 6c79 2e0a 2020 2020 2020 2020 3a74  tely..        :t
+00019c60: 7970 6520 6b65 6570 5f6e 6f6e 653a 2062  ype keep_none: b
+00019c70: 6f6f 6c20 7c20 4e6f 6e65 0a20 2020 2020  ool | None.     
+00019c80: 2020 203a 7061 7261 6d20 7265 7475 726e     :param return
+00019c90: 5f6e 6577 3a20 496e 636c 7564 6520 626f  _new: Include bo
+00019ca0: 6479 206f 6620 7468 6520 6e65 7720 646f  dy of the new do
+00019cb0: 6375 6d65 6e74 2069 6e20 7468 6520 7265  cument in the re
+00019cc0: 7475 726e 6564 0a20 2020 2020 2020 2020  turned.         
+00019cd0: 2020 206d 6574 6164 6174 612e 2049 676e     metadata. Ign
+00019ce0: 6f72 6564 2069 6620 7061 7261 6d65 7465  ored if paramete
+00019cf0: 7220 2a2a 7369 6c65 6e74 2a2a 2069 7320  r **silent** is 
+00019d00: 7365 7420 746f 2054 7275 652e 0a20 2020  set to True..   
+00019d10: 2020 2020 203a 7479 7065 2072 6574 7572       :type retur
+00019d20: 6e5f 6e65 773a 2062 6f6f 6c0a 2020 2020  n_new: bool.    
+00019d30: 2020 2020 3a70 6172 616d 2072 6574 7572      :param retur
+00019d40: 6e5f 6f6c 643a 2049 6e63 6c75 6465 2062  n_old: Include b
+00019d50: 6f64 7920 6f66 2074 6865 206f 6c64 2064  ody of the old d
+00019d60: 6f63 756d 656e 7420 696e 2074 6865 2072  ocument in the r
+00019d70: 6574 7572 6e65 640a 2020 2020 2020 2020  eturned.        
+00019d80: 2020 2020 6d65 7461 6461 7461 2e20 4967      metadata. Ig
+00019d90: 6e6f 7265 6420 6966 2070 6172 616d 6574  nored if paramet
+00019da0: 6572 202a 2a73 696c 656e 742a 2a20 6973  er **silent** is
+00019db0: 2073 6574 2074 6f20 5472 7565 2e0a 2020   set to True..  
+00019dc0: 2020 2020 2020 3a74 7970 6520 7265 7475        :type retu
+00019dd0: 726e 5f6f 6c64 3a20 626f 6f6c 0a20 2020  rn_old: bool.   
+00019de0: 2020 2020 203a 7061 7261 6d20 7379 6e63       :param sync
+00019df0: 3a20 426c 6f63 6b20 756e 7469 6c20 6f70  : Block until op
+00019e00: 6572 6174 696f 6e20 6973 2073 796e 6368  eration is synch
+00019e10: 726f 6e69 7a65 6420 746f 2064 6973 6b2e  ronized to disk.
+00019e20: 0a20 2020 2020 2020 203a 7479 7065 2073  .        :type s
+00019e30: 796e 633a 2062 6f6f 6c20 7c20 4e6f 6e65  ync: bool | None
+00019e40: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00019e50: 7369 6c65 6e74 3a20 4966 2073 6574 2074  silent: If set t
+00019e60: 6f20 5472 7565 2c20 6e6f 2064 6f63 756d  o True, no docum
+00019e70: 656e 7420 6d65 7461 6461 7461 2069 7320  ent metadata is 
+00019e80: 7265 7475 726e 6564 2e20 5468 6973 0a20  returned. This. 
+00019e90: 2020 2020 2020 2020 2020 2063 616e 2062             can b
+00019ea0: 6520 7573 6564 2074 6f20 7361 7665 2072  e used to save r
+00019eb0: 6573 6f75 7263 6573 2e0a 2020 2020 2020  esources..      
+00019ec0: 2020 3a74 7970 6520 7369 6c65 6e74 3a20    :type silent: 
+00019ed0: 626f 6f6c 0a20 2020 2020 2020 203a 7061  bool.        :pa
+00019ee0: 7261 6d20 7265 6669 6c6c 5f69 6e64 6578  ram refill_index
+00019ef0: 5f63 6163 6865 733a 2057 6865 7468 6572  _caches: Whether
+00019f00: 2074 6f20 6164 6420 6e65 7720 656e 7472   to add new entr
+00019f10: 6965 7320 746f 2069 6e2d 6d65 6d6f 7279  ies to in-memory
+00019f20: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
+00019f30: 6578 2063 6163 6865 7320 6966 2064 6f63  ex caches if doc
+00019f40: 756d 656e 7420 696e 7365 7274 696f 6e73  ument insertions
+00019f50: 2061 6666 6563 7420 7468 6520 6564 6765   affect the edge
+00019f60: 2069 6e64 6578 206f 720a 2020 2020 2020   index or.      
+00019f70: 2020 2020 2020 6361 6368 652d 656e 6162        cache-enab
+00019f80: 6c65 6420 7065 7273 6973 7465 6e74 2069  led persistent i
+00019f90: 6e64 6578 6573 2e0a 2020 2020 2020 2020  ndexes..        
+00019fa0: 3a74 7970 6520 7265 6669 6c6c 5f69 6e64  :type refill_ind
+00019fb0: 6578 5f63 6163 6865 733a 2062 6f6f 6c20  ex_caches: bool 
+00019fc0: 7c20 4e6f 6e65 0a20 2020 2020 2020 203a  | None.        :
+00019fd0: 7061 7261 6d20 7665 7273 696f 6e5f 6174  param version_at
+00019fe0: 7472 6962 7574 653a 2073 7570 706f 7274  tribute: support
+00019ff0: 2066 6f72 2073 696d 706c 6520 6578 7465   for simple exte
+0001a000: 726e 616c 2076 6572 7369 6f6e 696e 670a  rnal versioning.
+0001a010: 2020 2020 2020 2020 2020 2020 746f 2064              to d
+0001a020: 6f63 756d 656e 7420 6f70 6572 6174 696f  ocument operatio
+0001a030: 6e73 2e0a 2020 2020 2020 2020 3a74 7970  ns..        :typ
+0001a040: 6520 7665 7273 696f 6e5f 6174 7472 6962  e version_attrib
+0001a050: 7574 653a 2073 7472 0a20 2020 2020 2020  ute: str.       
+0001a060: 203a 7265 7475 726e 3a20 446f 6375 6d65   :return: Docume
+0001a070: 6e74 206d 6574 6164 6174 6120 2865 2e67  nt metadata (e.g
+0001a080: 2e20 646f 6375 6d65 6e74 206b 6579 2c20  . document key, 
+0001a090: 7265 7669 7369 6f6e 2920 6f72 2054 7275  revision) or Tru
+0001a0a0: 6520 6966 0a20 2020 2020 2020 2020 2020  e if.           
+0001a0b0: 2070 6172 616d 6574 6572 202a 2a73 696c   parameter **sil
+0001a0c0: 656e 742a 2a20 7761 7320 7365 7420 746f  ent** was set to
+0001a0d0: 2054 7275 652e 0a20 2020 2020 2020 203a   True..        :
+0001a0e0: 7274 7970 653a 2062 6f6f 6c20 7c20 6469  rtype: bool | di
+0001a0f0: 6374 0a20 2020 2020 2020 203a 7261 6973  ct.        :rais
+0001a100: 6520 6172 616e 676f 2e65 7863 6570 7469  e arango.excepti
+0001a110: 6f6e 732e 446f 6375 6d65 6e74 5570 6461  ons.DocumentUpda
+0001a120: 7465 4572 726f 723a 2049 6620 7570 6461  teError: If upda
+0001a130: 7465 2066 6169 6c73 2e0a 2020 2020 2020  te fails..      
+0001a140: 2020 3a72 6169 7365 2061 7261 6e67 6f2e    :raise arango.
+0001a150: 6578 6365 7074 696f 6e73 2e44 6f63 756d  exceptions.Docum
+0001a160: 656e 7452 6576 6973 696f 6e45 7272 6f72  entRevisionError
+0001a170: 3a20 4966 2072 6576 6973 696f 6e73 206d  : If revisions m
+0001a180: 6973 6d61 7463 682e 0a20 2020 2020 2020  ismatch..       
+0001a190: 2022 2222 0a20 2020 2020 2020 2070 6172   """.        par
+0001a1a0: 616d 733a 2050 6172 616d 7320 3d20 7b0a  ams: Params = {.
+0001a1b0: 2020 2020 2020 2020 2020 2020 226b 6565              "kee
+0001a1c0: 704e 756c 6c22 3a20 6b65 6570 5f6e 6f6e  pNull": keep_non
+0001a1d0: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
+0001a1e0: 6d65 7267 654f 626a 6563 7473 223a 206d  mergeObjects": m
+0001a1f0: 6572 6765 2c0a 2020 2020 2020 2020 2020  erge,.          
+0001a200: 2020 2272 6574 7572 6e4e 6577 223a 2072    "returnNew": r
+0001a210: 6574 7572 6e5f 6e65 772c 0a20 2020 2020  eturn_new,.     
+0001a220: 2020 2020 2020 2022 7265 7475 726e 4f6c         "returnOl
+0001a230: 6422 3a20 7265 7475 726e 5f6f 6c64 2c0a  d": return_old,.
+0001a240: 2020 2020 2020 2020 2020 2020 2269 676e              "ign
+0001a250: 6f72 6552 6576 7322 3a20 6e6f 7420 6368  oreRevs": not ch
+0001a260: 6563 6b5f 7265 762c 0a20 2020 2020 2020  eck_rev,.       
+0001a270: 2020 2020 2022 6f76 6572 7772 6974 6522       "overwrite"
+0001a280: 3a20 6e6f 7420 6368 6563 6b5f 7265 762c  : not check_rev,
+0001a290: 0a20 2020 2020 2020 2020 2020 2022 7369  .            "si
+0001a2a0: 6c65 6e74 223a 2073 696c 656e 742c 0a20  lent": silent,. 
+0001a2b0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+0001a2c0: 2069 6620 7379 6e63 2069 7320 6e6f 7420   if sync is not 
+0001a2d0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0001a2e0: 2020 7061 7261 6d73 5b22 7761 6974 466f    params["waitFo
+0001a2f0: 7253 796e 6322 5d20 3d20 7379 6e63 0a0a  rSync"] = sync..
+0001a300: 2020 2020 2020 2020 6966 2076 6572 7369          if versi
+0001a310: 6f6e 5f61 7474 7269 6275 7465 2069 7320  on_attribute is 
+0001a320: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+0001a330: 2020 2020 2020 7061 7261 6d73 5b22 7665        params["ve
+0001a340: 7273 696f 6e41 7474 7269 6275 7465 225d  rsionAttribute"]
+0001a350: 203d 2076 6572 7369 6f6e 5f61 7474 7269   = version_attri
+0001a360: 6275 7465 0a0a 2020 2020 2020 2020 2320  bute..        # 
+0001a370: 4e65 7720 696e 2041 7261 6e67 6f44 4220  New in ArangoDB 
+0001a380: 332e 392e 3620 616e 6420 332e 3130 2e32  3.9.6 and 3.10.2
+0001a390: 0a20 2020 2020 2020 2069 6620 7265 6669  .        if refi
+0001a3a0: 6c6c 5f69 6e64 6578 5f63 6163 6865 7320  ll_index_caches 
+0001a3b0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0001a3c0: 2020 2020 2020 2020 2070 6172 616d 735b           params[
+0001a3d0: 2272 6566 696c 6c49 6e64 6578 4361 6368  "refillIndexCach
+0001a3e0: 6573 225d 203d 2072 6566 696c 6c5f 696e  es"] = refill_in
+0001a3f0: 6465 785f 6361 6368 6573 0a0a 2020 2020  dex_caches..    
+0001a400: 2020 2020 7265 7175 6573 7420 3d20 5265      request = Re
+0001a410: 7175 6573 7428 0a20 2020 2020 2020 2020  quest(.         
+0001a420: 2020 206d 6574 686f 643d 2270 6174 6368     method="patch
+0001a430: 222c 0a20 2020 2020 2020 2020 2020 2065  ",.            e
+0001a440: 6e64 706f 696e 743d 6622 2f5f 6170 692f  ndpoint=f"/_api/
+0001a450: 646f 6375 6d65 6e74 2f7b 7365 6c66 2e5f  document/{self._
+0001a460: 6578 7472 6163 745f 6964 2864 6f63 756d  extract_id(docum
+0001a470: 656e 7429 7d22 2c0a 2020 2020 2020 2020  ent)}",.        
+0001a480: 2020 2020 6461 7461 3d64 6f63 756d 656e      data=documen
+0001a490: 742c 0a20 2020 2020 2020 2020 2020 2070  t,.            p
+0001a4a0: 6172 616d 733d 7061 7261 6d73 2c0a 2020  arams=params,.  
+0001a4b0: 2020 2020 2020 2020 2020 7772 6974 653d            write=
+0001a4c0: 7365 6c66 2e6e 616d 652c 0a20 2020 2020  self.name,.     
+0001a4d0: 2020 2029 0a0a 2020 2020 2020 2020 6465     )..        de
+0001a4e0: 6620 7265 7370 6f6e 7365 5f68 616e 646c  f response_handl
+0001a4f0: 6572 2872 6573 703a 2052 6573 706f 6e73  er(resp: Respons
+0001a500: 6529 202d 3e20 556e 696f 6e5b 626f 6f6c  e) -> Union[bool
+0001a510: 2c20 4a73 6f6e 5d3a 0a20 2020 2020 2020  , Json]:.       
+0001a520: 2020 2020 2069 6620 7265 7370 2e73 7461       if resp.sta
+0001a530: 7475 735f 636f 6465 203d 3d20 3431 323a  tus_code == 412:
+0001a540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a550: 2072 6169 7365 2044 6f63 756d 656e 7452   raise DocumentR
+0001a560: 6576 6973 696f 6e45 7272 6f72 2872 6573  evisionError(res
+0001a570: 702c 2072 6571 7565 7374 290a 2020 2020  p, request).    
+0001a580: 2020 2020 2020 2020 656c 6966 206e 6f74          elif not
+0001a590: 2072 6573 702e 6973 5f73 7563 6365 7373   resp.is_success
+0001a5a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001a5b0: 2020 7261 6973 6520 446f 6375 6d65 6e74    raise Document
+0001a5c0: 5570 6461 7465 4572 726f 7228 7265 7370  UpdateError(resp
+0001a5d0: 2c20 7265 7175 6573 7429 0a20 2020 2020  , request).     
+0001a5e0: 2020 2020 2020 2069 6620 7369 6c65 6e74         if silent
+0001a5f0: 2069 7320 5472 7565 3a0a 2020 2020 2020   is True:.      
+0001a600: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001a610: 2054 7275 650a 0a20 2020 2020 2020 2020   True..         
+0001a620: 2020 2072 6573 756c 743a 204a 736f 6e20     result: Json 
+0001a630: 3d20 7265 7370 2e62 6f64 790a 2020 2020  = resp.body.    
+0001a640: 2020 2020 2020 2020 7265 7375 6c74 5b22          result["
+0001a650: 5f6f 6c64 5f72 6576 225d 203d 2072 6573  _old_rev"] = res
+0001a660: 756c 742e 706f 7028 225f 6f6c 6452 6576  ult.pop("_oldRev
+0001a670: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
+0001a680: 6574 7572 6e20 7265 7375 6c74 0a0a 2020  eturn result..  
+0001a690: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0001a6a0: 662e 5f65 7865 6375 7465 2872 6571 7565  f._execute(reque
+0001a6b0: 7374 2c20 7265 7370 6f6e 7365 5f68 616e  st, response_han
+0001a6c0: 646c 6572 290a 0a20 2020 2064 6566 2072  dler)..    def r
+0001a6d0: 6570 6c61 6365 280a 2020 2020 2020 2020  eplace(.        
+0001a6e0: 7365 6c66 2c0a 2020 2020 2020 2020 646f  self,.        do
+0001a6f0: 6375 6d65 6e74 3a20 4a73 6f6e 2c0a 2020  cument: Json,.  
+0001a700: 2020 2020 2020 6368 6563 6b5f 7265 763a        check_rev:
+0001a710: 2062 6f6f 6c20 3d20 5472 7565 2c0a 2020   bool = True,.  
+0001a720: 2020 2020 2020 7265 7475 726e 5f6e 6577        return_new
+0001a730: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
+0001a740: 2020 2020 2020 2020 7265 7475 726e 5f6f          return_o
+0001a750: 6c64 3a20 626f 6f6c 203d 2046 616c 7365  ld: bool = False
+0001a760: 2c0a 2020 2020 2020 2020 7379 6e63 3a20  ,.        sync: 
+0001a770: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 203d  Optional[bool] =
+0001a780: 204e 6f6e 652c 0a20 2020 2020 2020 2073   None,.        s
+0001a790: 696c 656e 743a 2062 6f6f 6c20 3d20 4661  ilent: bool = Fa
+0001a7a0: 6c73 652c 0a20 2020 2020 2020 2072 6566  lse,.        ref
+0001a7b0: 696c 6c5f 696e 6465 785f 6361 6368 6573  ill_index_caches
+0001a7c0: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
+0001a7d0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0001a7e0: 2076 6572 7369 6f6e 5f61 7474 7269 6275   version_attribu
+0001a7f0: 7465 3a20 4f70 7469 6f6e 616c 5b73 7472  te: Optional[str
+0001a800: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2920  ] = None,.    ) 
+0001a810: 2d3e 2052 6573 756c 745b 556e 696f 6e5b  -> Result[Union[
+0001a820: 626f 6f6c 2c20 4a73 6f6e 5d5d 3a0a 2020  bool, Json]]:.  
+0001a830: 2020 2020 2020 2222 2252 6570 6c61 6365        """Replace
+0001a840: 2061 2064 6f63 756d 656e 742e 0a0a 2020   a document...  
+0001a850: 2020 2020 2020 3a70 6172 616d 2064 6f63        :param doc
+0001a860: 756d 656e 743a 204e 6577 2064 6f63 756d  ument: New docum
+0001a870: 656e 7420 746f 2072 6570 6c61 6365 2074  ent to replace t
+0001a880: 6865 206f 6c64 206f 6e65 2077 6974 682e  he old one with.
+0001a890: 2049 7420 6d75 7374 0a20 2020 2020 2020   It must.       
+0001a8a0: 2020 2020 2063 6f6e 7461 696e 2074 6865       contain the
+0001a8b0: 2022 5f69 6422 206f 7220 225f 6b65 7922   "_id" or "_key"
+0001a8c0: 2066 6965 6c64 2e20 4564 6765 2064 6f63   field. Edge doc
+0001a8d0: 756d 656e 7420 6d75 7374 2061 6c73 6f20  ument must also 
+0001a8e0: 6861 7665 0a20 2020 2020 2020 2020 2020  have.           
+0001a8f0: 2022 5f66 726f 6d22 2061 6e64 2022 5f74   "_from" and "_t
+0001a900: 6f22 2066 6965 6c64 732e 0a20 2020 2020  o" fields..     
+0001a910: 2020 203a 7479 7065 2064 6f63 756d 656e     :type documen
+0001a920: 743a 2064 6963 740a 2020 2020 2020 2020  t: dict.        
+0001a930: 3a70 6172 616d 2063 6865 636b 5f72 6576  :param check_rev
+0001a940: 3a20 4966 2073 6574 2074 6f20 5472 7565  : If set to True
+0001a950: 2c20 7265 7669 7369 6f6e 206f 6620 2a2a  , revision of **
+0001a960: 646f 6375 6d65 6e74 2a2a 2028 6966 2067  document** (if g
+0001a970: 6976 656e 290a 2020 2020 2020 2020 2020  iven).          
+0001a980: 2020 6973 2063 6f6d 7061 7265 6420 6167    is compared ag
+0001a990: 6169 6e73 7420 7468 6520 7265 7669 7369  ainst the revisi
+0001a9a0: 6f6e 206f 6620 7461 7267 6574 2064 6f63  on of target doc
+0001a9b0: 756d 656e 742e 0a20 2020 2020 2020 203a  ument..        :
+0001a9c0: 7479 7065 2063 6865 636b 5f72 6576 3a20  type check_rev: 
+0001a9d0: 626f 6f6c 0a20 2020 2020 2020 203a 7061  bool.        :pa
+0001a9e0: 7261 6d20 7265 7475 726e 5f6e 6577 3a20  ram return_new: 
+0001a9f0: 496e 636c 7564 6520 626f 6479 206f 6620  Include body of 
+0001aa00: 7468 6520 6e65 7720 646f 6375 6d65 6e74  the new document
+0001aa10: 2069 6e20 7468 6520 7265 7475 726e 6564   in the returned
+0001aa20: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
+0001aa30: 6164 6174 612e 2049 676e 6f72 6564 2069  adata. Ignored i
+0001aa40: 6620 7061 7261 6d65 7465 7220 2a2a 7369  f parameter **si
+0001aa50: 6c65 6e74 2a2a 2069 7320 7365 7420 746f  lent** is set to
+0001aa60: 2054 7275 652e 0a20 2020 2020 2020 203a   True..        :
+0001aa70: 7479 7065 2072 6574 7572 6e5f 6e65 773a  type return_new:
+0001aa80: 2062 6f6f 6c0a 2020 2020 2020 2020 3a70   bool.        :p
+0001aa90: 6172 616d 2072 6574 7572 6e5f 6f6c 643a  aram return_old:
+0001aaa0: 2049 6e63 6c75 6465 2062 6f64 7920 6f66   Include body of
+0001aab0: 2074 6865 206f 6c64 2064 6f63 756d 656e   the old documen
+0001aac0: 7420 696e 2074 6865 2072 6574 7572 6e65  t in the returne
+0001aad0: 640a 2020 2020 2020 2020 2020 2020 6d65  d.            me
+0001aae0: 7461 6461 7461 2e20 4967 6e6f 7265 6420  tadata. Ignored 
+0001aaf0: 6966 2070 6172 616d 6574 6572 202a 2a73  if parameter **s
+0001ab00: 696c 656e 742a 2a20 6973 2073 6574 2074  ilent** is set t
+0001ab10: 6f20 5472 7565 2e0a 2020 2020 2020 2020  o True..        
+0001ab20: 3a74 7970 6520 7265 7475 726e 5f6f 6c64  :type return_old
+0001ab30: 3a20 626f 6f6c 0a20 2020 2020 2020 203a  : bool.        :
+0001ab40: 7061 7261 6d20 7379 6e63 3a20 426c 6f63  param sync: Bloc
+0001ab50: 6b20 756e 7469 6c20 6f70 6572 6174 696f  k until operatio
+0001ab60: 6e20 6973 2073 796e 6368 726f 6e69 7a65  n is synchronize
+0001ab70: 6420 746f 2064 6973 6b2e 0a20 2020 2020  d to disk..     
+0001ab80: 2020 203a 7479 7065 2073 796e 633a 2062     :type sync: b
+0001ab90: 6f6f 6c20 7c20 4e6f 6e65 0a20 2020 2020  ool | None.     
+0001aba0: 2020 203a 7061 7261 6d20 7369 6c65 6e74     :param silent
+0001abb0: 3a20 4966 2073 6574 2074 6f20 5472 7565  : If set to True
+0001abc0: 2c20 6e6f 2064 6f63 756d 656e 7420 6d65  , no document me
+0001abd0: 7461 6461 7461 2069 7320 7265 7475 726e  tadata is return
+0001abe0: 6564 2e20 5468 6973 0a20 2020 2020 2020  ed. This.       
+0001abf0: 2020 2020 2063 616e 2062 6520 7573 6564       can be used
+0001ac00: 2074 6f20 7361 7665 2072 6573 6f75 7263   to save resourc
+0001ac10: 6573 2e0a 2020 2020 2020 2020 3a74 7970  es..        :typ
+0001ac20: 6520 7369 6c65 6e74 3a20 626f 6f6c 0a20  e silent: bool. 
+0001ac30: 2020 2020 2020 203a 7061 7261 6d20 7265         :param re
+0001ac40: 6669 6c6c 5f69 6e64 6578 5f63 6163 6865  fill_index_cache
+0001ac50: 733a 2057 6865 7468 6572 2074 6f20 6164  s: Whether to ad
+0001ac60: 6420 6e65 7720 656e 7472 6965 7320 746f  d new entries to
+0001ac70: 2069 6e2d 6d65 6d6f 7279 0a20 2020 2020   in-memory.     
+0001ac80: 2020 2020 2020 2069 6e64 6578 2063 6163         index cac
+0001ac90: 6865 7320 6966 2064 6f63 756d 656e 7420  hes if document 
+0001aca0: 696e 7365 7274 696f 6e73 2061 6666 6563  insertions affec
+0001acb0: 7420 7468 6520 6564 6765 2069 6e64 6578  t the edge index
+0001acc0: 206f 720a 2020 2020 2020 2020 2020 2020   or.            
+0001acd0: 6361 6368 652d 656e 6162 6c65 6420 7065  cache-enabled pe
+0001ace0: 7273 6973 7465 6e74 2069 6e64 6578 6573  rsistent indexes
+0001acf0: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
+0001ad00: 7265 6669 6c6c 5f69 6e64 6578 5f63 6163  refill_index_cac
+0001ad10: 6865 733a 2062 6f6f 6c20 7c20 4e6f 6e65  hes: bool | None
+0001ad20: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001ad30: 7665 7273 696f 6e5f 6174 7472 6962 7574  version_attribut
+0001ad40: 653a 2073 7570 706f 7274 2066 6f72 2073  e: support for s
+0001ad50: 696d 706c 6520 6578 7465 726e 616c 2076  imple external v
+0001ad60: 6572 7369 6f6e 696e 6720 746f 0a20 2020  ersioning to.   
+0001ad70: 2020 2020 2020 2020 2064 6f63 756d 656e           documen
+0001ad80: 7420 6f70 6572 6174 696f 6e73 2e0a 2020  t operations..  
+0001ad90: 2020 2020 2020 3a74 7970 6520 7665 7273        :type vers
+0001ada0: 696f 6e5f 6174 7472 6962 7574 653a 2073  ion_attribute: s
+0001adb0: 7472 0a20 2020 2020 2020 203a 7265 7475  tr.        :retu
+0001adc0: 726e 3a20 446f 6375 6d65 6e74 206d 6574  rn: Document met
+0001add0: 6164 6174 6120 2865 2e67 2e20 646f 6375  adata (e.g. docu
+0001ade0: 6d65 6e74 206b 6579 2c20 7265 7669 7369  ment key, revisi
+0001adf0: 6f6e 2920 6f72 2054 7275 6520 6966 0a20  on) or True if. 
+0001ae00: 2020 2020 2020 2020 2020 2070 6172 616d             param
+0001ae10: 6574 6572 202a 2a73 696c 656e 742a 2a20  eter **silent** 
+0001ae20: 7761 7320 7365 7420 746f 2054 7275 652e  was set to True.
+0001ae30: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
+0001ae40: 2062 6f6f 6c20 7c20 6469 6374 0a20 2020   bool | dict.   
+0001ae50: 2020 2020 203a 7261 6973 6520 6172 616e       :raise aran
+0001ae60: 676f 2e65 7863 6570 7469 6f6e 732e 446f  go.exceptions.Do
+0001ae70: 6375 6d65 6e74 5265 706c 6163 6545 7272  cumentReplaceErr
+0001ae80: 6f72 3a20 4966 2072 6570 6c61 6365 2066  or: If replace f
+0001ae90: 6169 6c73 2e0a 2020 2020 2020 2020 3a72  ails..        :r
+0001aea0: 6169 7365 2061 7261 6e67 6f2e 6578 6365  aise arango.exce
+0001aeb0: 7074 696f 6e73 2e44 6f63 756d 656e 7452  ptions.DocumentR
+0001aec0: 6576 6973 696f 6e45 7272 6f72 3a20 4966  evisionError: If
+0001aed0: 2072 6576 6973 696f 6e73 206d 6973 6d61   revisions misma
+0001aee0: 7463 682e 0a20 2020 2020 2020 2022 2222  tch..        """
+0001aef0: 0a20 2020 2020 2020 2070 6172 616d 733a  .        params:
+0001af00: 2050 6172 616d 7320 3d20 7b0a 2020 2020   Params = {.    
+0001af10: 2020 2020 2020 2020 2272 6574 7572 6e4e          "returnN
+0001af20: 6577 223a 2072 6574 7572 6e5f 6e65 772c  ew": return_new,
+0001af30: 0a20 2020 2020 2020 2020 2020 2022 7265  .            "re
+0001af40: 7475 726e 4f6c 6422 3a20 7265 7475 726e  turnOld": return
+0001af50: 5f6f 6c64 2c0a 2020 2020 2020 2020 2020  _old,.          
+0001af60: 2020 2269 676e 6f72 6552 6576 7322 3a20    "ignoreRevs": 
+0001af70: 6e6f 7420 6368 6563 6b5f 7265 762c 0a20  not check_rev,. 
+0001af80: 2020 2020 2020 2020 2020 2022 6f76 6572             "over
+0001af90: 7772 6974 6522 3a20 6e6f 7420 6368 6563  write": not chec
+0001afa0: 6b5f 7265 762c 0a20 2020 2020 2020 2020  k_rev,.         
+0001afb0: 2020 2022 7369 6c65 6e74 223a 2073 696c     "silent": sil
+0001afc0: 656e 742c 0a20 2020 2020 2020 207d 0a20  ent,.        }. 
+0001afd0: 2020 2020 2020 2069 6620 7379 6e63 2069         if sync i
+0001afe0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+0001aff0: 2020 2020 2020 2020 7061 7261 6d73 5b22          params["
+0001b000: 7761 6974 466f 7253 796e 6322 5d20 3d20  waitForSync"] = 
+0001b010: 7379 6e63 0a0a 2020 2020 2020 2020 6966  sync..        if
+0001b020: 2076 6572 7369 6f6e 5f61 7474 7269 6275   version_attribu
+0001b030: 7465 2069 7320 6e6f 7420 4e6f 6e65 3a0a  te is not None:.
+0001b040: 2020 2020 2020 2020 2020 2020 7061 7261              para
+0001b050: 6d73 5b22 7665 7273 696f 6e41 7474 7269  ms["versionAttri
+0001b060: 6275 7465 225d 203d 2076 6572 7369 6f6e  bute"] = version
+0001b070: 5f61 7474 7269 6275 7465 0a0a 2020 2020  _attribute..    
+0001b080: 2020 2020 2320 4e65 7720 696e 2041 7261      # New in Ara
+0001b090: 6e67 6f44 4220 332e 392e 3620 616e 6420  ngoDB 3.9.6 and 
+0001b0a0: 332e 3130 2e32 0a20 2020 2020 2020 2069  3.10.2.        i
+0001b0b0: 6620 7265 6669 6c6c 5f69 6e64 6578 5f63  f refill_index_c
+0001b0c0: 6163 6865 7320 6973 206e 6f74 204e 6f6e  aches is not Non
+0001b0d0: 653a 0a20 2020 2020 2020 2020 2020 2070  e:.            p
+0001b0e0: 6172 616d 735b 2272 6566 696c 6c49 6e64  arams["refillInd
+0001b0f0: 6578 4361 6368 6573 225d 203d 2072 6566  exCaches"] = ref
+0001b100: 696c 6c5f 696e 6465 785f 6361 6368 6573  ill_index_caches
+0001b110: 0a0a 2020 2020 2020 2020 7265 7175 6573  ..        reques
+0001b120: 7420 3d20 5265 7175 6573 7428 0a20 2020  t = Request(.   
+0001b130: 2020 2020 2020 2020 206d 6574 686f 643d           method=
+0001b140: 2270 7574 222c 0a20 2020 2020 2020 2020  "put",.         
+0001b150: 2020 2065 6e64 706f 696e 743d 6622 2f5f     endpoint=f"/_
+0001b160: 6170 692f 646f 6375 6d65 6e74 2f7b 7365  api/document/{se
+0001b170: 6c66 2e5f 6578 7472 6163 745f 6964 2864  lf._extract_id(d
+0001b180: 6f63 756d 656e 7429 7d22 2c0a 2020 2020  ocument)}",.    
+0001b190: 2020 2020 2020 2020 7061 7261 6d73 3d70          params=p
+0001b1a0: 6172 616d 732c 0a20 2020 2020 2020 2020  arams,.         
+0001b1b0: 2020 2064 6174 613d 646f 6375 6d65 6e74     data=document
+0001b1c0: 2c0a 2020 2020 2020 2020 2020 2020 7772  ,.            wr
+0001b1d0: 6974 653d 7365 6c66 2e6e 616d 652c 0a20  ite=self.name,. 
+0001b1e0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0001b1f0: 2020 6465 6620 7265 7370 6f6e 7365 5f68    def response_h
+0001b200: 616e 646c 6572 2872 6573 703a 2052 6573  andler(resp: Res
+0001b210: 706f 6e73 6529 202d 3e20 556e 696f 6e5b  ponse) -> Union[
+0001b220: 626f 6f6c 2c20 4a73 6f6e 5d3a 0a20 2020  bool, Json]:.   
+0001b230: 2020 2020 2020 2020 2069 6620 7265 7370           if resp
+0001b240: 2e73 7461 7475 735f 636f 6465 203d 3d20  .status_code == 
+0001b250: 3431 323a 0a20 2020 2020 2020 2020 2020  412:.           
+0001b260: 2020 2020 2072 6169 7365 2044 6f63 756d       raise Docum
+0001b270: 656e 7452 6576 6973 696f 6e45 7272 6f72  entRevisionError
+0001b280: 2872 6573 702c 2072 6571 7565 7374 290a  (resp, request).
+0001b290: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+0001b2a0: 6f74 2072 6573 702e 6973 5f73 7563 6365  ot resp.is_succe
+0001b2b0: 7373 3a0a 2020 2020 2020 2020 2020 2020  ss:.            
+0001b2c0: 2020 2020 7261 6973 6520 446f 6375 6d65      raise Docume
+0001b2d0: 6e74 5265 706c 6163 6545 7272 6f72 2872  ntReplaceError(r
+0001b2e0: 6573 702c 2072 6571 7565 7374 290a 0a20  esp, request).. 
+0001b2f0: 2020 2020 2020 2020 2020 2069 6620 7369             if si
+0001b300: 6c65 6e74 2069 7320 5472 7565 3a0a 2020  lent is True:.  
+0001b310: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0001b320: 7475 726e 2054 7275 650a 0a20 2020 2020  turn True..     
+0001b330: 2020 2020 2020 2072 6573 756c 743a 204a         result: J
+0001b340: 736f 6e20 3d20 7265 7370 2e62 6f64 790a  son = resp.body.
+0001b350: 2020 2020 2020 2020 2020 2020 6966 2022              if "
+0001b360: 5f6f 6c64 5265 7622 2069 6e20 7265 7375  _oldRev" in resu
+0001b370: 6c74 3a0a 2020 2020 2020 2020 2020 2020  lt:.            
+0001b380: 2020 2020 7265 7375 6c74 5b22 5f6f 6c64      result["_old
+0001b390: 5f72 6576 225d 203d 2072 6573 756c 742e  _rev"] = result.
+0001b3a0: 706f 7028 225f 6f6c 6452 6576 2229 0a20  pop("_oldRev"). 
+0001b3b0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001b3c0: 6e20 7265 7375 6c74 0a0a 2020 2020 2020  n result..      
+0001b3d0: 2020 7265 7475 726e 2073 656c 662e 5f65    return self._e
+0001b3e0: 7865 6375 7465 2872 6571 7565 7374 2c20  xecute(request, 
+0001b3f0: 7265 7370 6f6e 7365 5f68 616e 646c 6572  response_handler
+0001b400: 290a 0a20 2020 2064 6566 2064 656c 6574  )..    def delet
+0001b410: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
+0001b420: 0a20 2020 2020 2020 2064 6f63 756d 656e  .        documen
+0001b430: 743a 2055 6e69 6f6e 5b73 7472 2c20 4a73  t: Union[str, Js
+0001b440: 6f6e 5d2c 0a20 2020 2020 2020 2072 6576  on],.        rev
+0001b450: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+0001b460: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+0001b470: 6368 6563 6b5f 7265 763a 2062 6f6f 6c20  check_rev: bool 
+0001b480: 3d20 5472 7565 2c0a 2020 2020 2020 2020  = True,.        
+0001b490: 6967 6e6f 7265 5f6d 6973 7369 6e67 3a20  ignore_missing: 
+0001b4a0: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+0001b4b0: 2020 2020 2020 7265 7475 726e 5f6f 6c64        return_old
+0001b4c0: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
+0001b4d0: 2020 2020 2020 2020 7379 6e63 3a20 4f70          sync: Op
+0001b4e0: 7469 6f6e 616c 5b62 6f6f 6c5d 203d 204e  tional[bool] = N
+0001b4f0: 6f6e 652c 0a20 2020 2020 2020 2073 696c  one,.        sil
+0001b500: 656e 743a 2062 6f6f 6c20 3d20 4661 6c73  ent: bool = Fals
+0001b510: 652c 0a20 2020 2020 2020 2072 6566 696c  e,.        refil
+0001b520: 6c5f 696e 6465 785f 6361 6368 6573 3a20  l_index_caches: 
+0001b530: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 203d  Optional[bool] =
+0001b540: 204e 6f6e 652c 0a20 2020 2029 202d 3e20   None,.    ) -> 
+0001b550: 5265 7375 6c74 5b55 6e69 6f6e 5b62 6f6f  Result[Union[boo
+0001b560: 6c2c 204a 736f 6e5d 5d3a 0a20 2020 2020  l, Json]]:.     
+0001b570: 2020 2022 2222 4465 6c65 7465 2061 2064     """Delete a d
+0001b580: 6f63 756d 656e 742e 0a0a 2020 2020 2020  ocument...      
+0001b590: 2020 3a70 6172 616d 2064 6f63 756d 656e    :param documen
+0001b5a0: 743a 2044 6f63 756d 656e 7420 4944 2c20  t: Document ID, 
+0001b5b0: 6b65 7920 6f72 2062 6f64 792e 2044 6f63  key or body. Doc
+0001b5c0: 756d 656e 7420 626f 6479 206d 7573 7420  ument body must 
+0001b5d0: 636f 6e74 6169 6e0a 2020 2020 2020 2020  contain.        
+0001b5e0: 2020 2020 7468 6520 225f 6964 2220 6f72      the "_id" or
+0001b5f0: 2022 5f6b 6579 2220 6669 656c 642e 0a20   "_key" field.. 
+0001b600: 2020 2020 2020 203a 7479 7065 2064 6f63         :type doc
+0001b610: 756d 656e 743a 2073 7472 207c 2064 6963  ument: str | dic
+0001b620: 740a 2020 2020 2020 2020 3a70 6172 616d  t.        :param
+0001b630: 2072 6576 3a20 4578 7065 6374 6564 2064   rev: Expected d
+0001b640: 6f63 756d 656e 7420 7265 7669 7369 6f6e  ocument revision
+0001b650: 2e20 4f76 6572 7269 6465 7320 7468 6520  . Overrides the 
+0001b660: 7661 6c75 6520 6f66 2022 5f72 6576 220a  value of "_rev".
+0001b670: 2020 2020 2020 2020 2020 2020 6669 656c              fiel
+0001b680: 6420 696e 202a 2a64 6f63 756d 656e 742a  d in **document*
+0001b690: 2a20 6966 2070 7265 7365 6e74 2e0a 2020  * if present..  
+0001b6a0: 2020 2020 2020 3a74 7970 6520 7265 763a        :type rev:
+0001b6b0: 2073 7472 207c 204e 6f6e 650a 2020 2020   str | None.    
+0001b6c0: 2020 2020 3a70 6172 616d 2063 6865 636b      :param check
+0001b6d0: 5f72 6576 3a20 4966 2073 6574 2074 6f20  _rev: If set to 
+0001b6e0: 5472 7565 2c20 7265 7669 7369 6f6e 206f  True, revision o
+0001b6f0: 6620 2a2a 646f 6375 6d65 6e74 2a2a 2028  f **document** (
+0001b700: 6966 2067 6976 656e 290a 2020 2020 2020  if given).      
+0001b710: 2020 2020 2020 6973 2063 6f6d 7061 7265        is compare
+0001b720: 6420 6167 6169 6e73 7420 7468 6520 7265  d against the re
+0001b730: 7669 7369 6f6e 206f 6620 7461 7267 6574  vision of target
+0001b740: 2064 6f63 756d 656e 742e 0a20 2020 2020   document..     
+0001b750: 2020 203a 7479 7065 2063 6865 636b 5f72     :type check_r
+0001b760: 6576 3a20 626f 6f6c 0a20 2020 2020 2020  ev: bool.       
+0001b770: 203a 7061 7261 6d20 6967 6e6f 7265 5f6d   :param ignore_m
+0001b780: 6973 7369 6e67 3a20 446f 206e 6f74 2072  issing: Do not r
+0001b790: 6169 7365 2061 6e20 6578 6365 7074 696f  aise an exceptio
+0001b7a0: 6e20 6f6e 206d 6973 7369 6e67 2064 6f63  n on missing doc
+0001b7b0: 756d 656e 742e 0a20 2020 2020 2020 2020  ument..         
+0001b7c0: 2020 2054 6869 7320 7061 7261 6d65 7465     This paramete
+0001b7d0: 7220 6861 7320 6e6f 2065 6666 6563 7420  r has no effect 
+0001b7e0: 696e 2074 7261 6e73 6163 7469 6f6e 7320  in transactions 
+0001b7f0: 7768 6572 6520 616e 2065 7863 6570 7469  where an excepti
+0001b800: 6f6e 2069 730a 2020 2020 2020 2020 2020  on is.          
+0001b810: 2020 616c 7761 7973 2072 6169 7365 6420    always raised 
+0001b820: 6f6e 2066 6169 6c75 7265 732e 0a20 2020  on failures..   
+0001b830: 2020 2020 203a 7479 7065 2069 676e 6f72       :type ignor
+0001b840: 655f 6d69 7373 696e 673a 2062 6f6f 6c0a  e_missing: bool.
+0001b850: 2020 2020 2020 2020 3a70 6172 616d 2072          :param r
+0001b860: 6574 7572 6e5f 6f6c 643a 2049 6e63 6c75  eturn_old: Inclu
+0001b870: 6465 2062 6f64 7920 6f66 2074 6865 206f  de body of the o
+0001b880: 6c64 2064 6f63 756d 656e 7420 696e 2074  ld document in t
+0001b890: 6865 2072 6574 7572 6e65 640a 2020 2020  he returned.    
+0001b8a0: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
+0001b8b0: 2e20 4967 6e6f 7265 6420 6966 2070 6172  . Ignored if par
+0001b8c0: 616d 6574 6572 202a 2a73 696c 656e 742a  ameter **silent*
+0001b8d0: 2a20 6973 2073 6574 2074 6f20 5472 7565  * is set to True
+0001b8e0: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
+0001b8f0: 7265 7475 726e 5f6f 6c64 3a20 626f 6f6c  return_old: bool
+0001b900: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001b910: 7379 6e63 3a20 426c 6f63 6b20 756e 7469  sync: Block unti
+0001b920: 6c20 6f70 6572 6174 696f 6e20 6973 2073  l operation is s
+0001b930: 796e 6368 726f 6e69 7a65 6420 746f 2064  ynchronized to d
+0001b940: 6973 6b2e 0a20 2020 2020 2020 203a 7479  isk..        :ty
+0001b950: 7065 2073 796e 633a 2062 6f6f 6c20 7c20  pe sync: bool | 
+0001b960: 4e6f 6e65 0a20 2020 2020 2020 203a 7061  None.        :pa
+0001b970: 7261 6d20 7369 6c65 6e74 3a20 4966 2073  ram silent: If s
+0001b980: 6574 2074 6f20 5472 7565 2c20 6e6f 2064  et to True, no d
+0001b990: 6f63 756d 656e 7420 6d65 7461 6461 7461  ocument metadata
+0001b9a0: 2069 7320 7265 7475 726e 6564 2e20 5468   is returned. Th
+0001b9b0: 6973 0a20 2020 2020 2020 2020 2020 2063  is.            c
+0001b9c0: 616e 2062 6520 7573 6564 2074 6f20 7361  an be used to sa
+0001b9d0: 7665 2072 6573 6f75 7263 6573 2e0a 2020  ve resources..  
+0001b9e0: 2020 2020 2020 3a74 7970 6520 7369 6c65        :type sile
+0001b9f0: 6e74 3a20 626f 6f6c 0a20 2020 2020 2020  nt: bool.       
+0001ba00: 203a 7061 7261 6d20 7265 6669 6c6c 5f69   :param refill_i
+0001ba10: 6e64 6578 5f63 6163 6865 733a 2057 6865  ndex_caches: Whe
+0001ba20: 7468 6572 2074 6f20 6164 6420 6e65 7720  ther to add new 
+0001ba30: 656e 7472 6965 7320 746f 2069 6e2d 6d65  entries to in-me
+0001ba40: 6d6f 7279 0a20 2020 2020 2020 2020 2020  mory.           
+0001ba50: 2069 6e64 6578 2063 6163 6865 7320 6966   index caches if
+0001ba60: 2064 6f63 756d 656e 7420 6f70 6572 6174   document operat
+0001ba70: 696f 6e73 2061 6666 6563 7420 7468 6520  ions affect the 
+0001ba80: 6564 6765 2069 6e64 6578 206f 720a 2020  edge index or.  
+0001ba90: 2020 2020 2020 2020 2020 6361 6368 652d            cache-
+0001baa0: 656e 6162 6c65 6420 7065 7273 6973 7465  enabled persiste
+0001bab0: 6e74 2069 6e64 6578 6573 2e0a 2020 2020  nt indexes..    
+0001bac0: 2020 2020 3a74 7970 6520 7265 6669 6c6c      :type refill
+0001bad0: 5f69 6e64 6578 5f63 6163 6865 733a 2062  _index_caches: b
+0001bae0: 6f6f 6c20 7c20 4e6f 6e65 0a20 2020 2020  ool | None.     
+0001baf0: 2020 203a 7265 7475 726e 3a20 446f 6375     :return: Docu
+0001bb00: 6d65 6e74 206d 6574 6164 6174 6120 2865  ment metadata (e
+0001bb10: 2e67 2e20 646f 6375 6d65 6e74 206b 6579  .g. document key
+0001bb20: 2c20 7265 7669 7369 6f6e 292c 206f 7220  , revision), or 
+0001bb30: 5472 7565 2069 660a 2020 2020 2020 2020  True if.        
+0001bb40: 2020 2020 7061 7261 6d65 7465 7220 2a2a      parameter **
+0001bb50: 7369 6c65 6e74 2a2a 2077 6173 2073 6574  silent** was set
+0001bb60: 2074 6f20 5472 7565 2c20 6f72 2046 616c   to True, or Fal
+0001bb70: 7365 2069 6620 646f 6375 6d65 6e74 2077  se if document w
+0001bb80: 6173 206e 6f74 0a20 2020 2020 2020 2020  as not.         
+0001bb90: 2020 2066 6f75 6e64 2061 6e64 202a 2a69     found and **i
+0001bba0: 676e 6f72 655f 6d69 7373 696e 672a 2a20  gnore_missing** 
+0001bbb0: 7761 7320 7365 7420 746f 2054 7275 6520  was set to True 
+0001bbc0: 2864 6f65 7320 6e6f 7420 6170 706c 7920  (does not apply 
+0001bbd0: 696e 0a20 2020 2020 2020 2020 2020 2074  in.            t
+0001bbe0: 7261 6e73 6163 7469 6f6e 7329 2e0a 2020  ransactions)..  
+0001bbf0: 2020 2020 2020 3a72 7479 7065 3a20 626f        :rtype: bo
+0001bc00: 6f6c 207c 2064 6963 740a 2020 2020 2020  ol | dict.      
+0001bc10: 2020 3a72 6169 7365 2061 7261 6e67 6f2e    :raise arango.
+0001bc20: 6578 6365 7074 696f 6e73 2e44 6f63 756d  exceptions.Docum
+0001bc30: 656e 7444 656c 6574 6545 7272 6f72 3a20  entDeleteError: 
+0001bc40: 4966 2064 656c 6574 6520 6661 696c 732e  If delete fails.
+0001bc50: 0a20 2020 2020 2020 203a 7261 6973 6520  .        :raise 
+0001bc60: 6172 616e 676f 2e65 7863 6570 7469 6f6e  arango.exception
+0001bc70: 732e 446f 6375 6d65 6e74 5265 7669 7369  s.DocumentRevisi
+0001bc80: 6f6e 4572 726f 723a 2049 6620 7265 7669  onError: If revi
+0001bc90: 7369 6f6e 7320 6d69 736d 6174 6368 2e0a  sions mismatch..
+0001bca0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0001bcb0: 2020 2020 6861 6e64 6c65 2c20 626f 6479      handle, body
+0001bcc0: 2c20 6865 6164 6572 7320 3d20 7365 6c66  , headers = self
+0001bcd0: 2e5f 7072 6570 5f66 726f 6d5f 646f 6328  ._prep_from_doc(
+0001bce0: 646f 6375 6d65 6e74 2c20 7265 762c 2063  document, rev, c
+0001bcf0: 6865 636b 5f72 6576 290a 0a20 2020 2020  heck_rev)..     
+0001bd00: 2020 2070 6172 616d 733a 2050 6172 616d     params: Param
+0001bd10: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+0001bd20: 2020 2272 6574 7572 6e4f 6c64 223a 2072    "returnOld": r
+0001bd30: 6574 7572 6e5f 6f6c 642c 0a20 2020 2020  eturn_old,.     
+0001bd40: 2020 2020 2020 2022 6967 6e6f 7265 5265         "ignoreRe
+0001bd50: 7673 223a 206e 6f74 2063 6865 636b 5f72  vs": not check_r
+0001bd60: 6576 2c0a 2020 2020 2020 2020 2020 2020  ev,.            
+0001bd70: 226f 7665 7277 7269 7465 223a 206e 6f74  "overwrite": not
+0001bd80: 2063 6865 636b 5f72 6576 2c0a 2020 2020   check_rev,.    
+0001bd90: 2020 2020 2020 2020 2273 696c 656e 7422          "silent"
+0001bda0: 3a20 7369 6c65 6e74 2c0a 2020 2020 2020  : silent,.      
+0001bdb0: 2020 7d0a 2020 2020 2020 2020 6966 2073    }.        if s
+0001bdc0: 796e 6320 6973 206e 6f74 204e 6f6e 653a  ync is not None:
+0001bdd0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
+0001bde0: 616d 735b 2277 6169 7446 6f72 5379 6e63  ams["waitForSync
+0001bdf0: 225d 203d 2073 796e 630a 0a20 2020 2020  "] = sync..     
+0001be00: 2020 2023 204e 6577 2069 6e20 4172 616e     # New in Aran
+0001be10: 676f 4442 2033 2e39 2e36 2061 6e64 2033  goDB 3.9.6 and 3
+0001be20: 2e31 302e 320a 2020 2020 2020 2020 6966  .10.2.        if
+0001be30: 2072 6566 696c 6c5f 696e 6465 785f 6361   refill_index_ca
+0001be40: 6368 6573 2069 7320 6e6f 7420 4e6f 6e65  ches is not None
+0001be50: 3a0a 2020 2020 2020 2020 2020 2020 7061  :.            pa
+0001be60: 7261 6d73 5b22 7265 6669 6c6c 496e 6465  rams["refillInde
+0001be70: 7843 6163 6865 7322 5d20 3d20 7265 6669  xCaches"] = refi
+0001be80: 6c6c 5f69 6e64 6578 5f63 6163 6865 730a  ll_index_caches.
+0001be90: 0a20 2020 2020 2020 2072 6571 7565 7374  .        request
+0001bea0: 203d 2052 6571 7565 7374 280a 2020 2020   = Request(.    
+0001beb0: 2020 2020 2020 2020 6d65 7468 6f64 3d22          method="
+0001bec0: 6465 6c65 7465 222c 0a20 2020 2020 2020  delete",.       
+0001bed0: 2020 2020 2065 6e64 706f 696e 743d 6622       endpoint=f"
+0001bee0: 2f5f 6170 692f 646f 6375 6d65 6e74 2f7b  /_api/document/{
+0001bef0: 6861 6e64 6c65 7d22 2c0a 2020 2020 2020  handle}",.      
+0001bf00: 2020 2020 2020 7061 7261 6d73 3d70 6172        params=par
+0001bf10: 616d 732c 0a20 2020 2020 2020 2020 2020  ams,.           
+0001bf20: 2068 6561 6465 7273 3d68 6561 6465 7273   headers=headers
+0001bf30: 2c0a 2020 2020 2020 2020 2020 2020 7772  ,.            wr
+0001bf40: 6974 653d 7365 6c66 2e6e 616d 652c 0a20  ite=self.name,. 
+0001bf50: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0001bf60: 2020 6465 6620 7265 7370 6f6e 7365 5f68    def response_h
+0001bf70: 616e 646c 6572 2872 6573 703a 2052 6573  andler(resp: Res
+0001bf80: 706f 6e73 6529 202d 3e20 556e 696f 6e5b  ponse) -> Union[
+0001bf90: 626f 6f6c 2c20 4a73 6f6e 5d3a 0a20 2020  bool, Json]:.   
+0001bfa0: 2020 2020 2020 2020 2069 6620 7265 7370           if resp
+0001bfb0: 2e65 7272 6f72 5f63 6f64 6520 3d3d 2031  .error_code == 1
+0001bfc0: 3230 3220 616e 6420 6967 6e6f 7265 5f6d  202 and ignore_m
+0001bfd0: 6973 7369 6e67 3a0a 2020 2020 2020 2020  issing:.        
+0001bfe0: 2020 2020 2020 2020 7265 7475 726e 2046          return F
+0001bff0: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
+0001c000: 2069 6620 7265 7370 2e73 7461 7475 735f   if resp.status_
+0001c010: 636f 6465 203d 3d20 3431 323a 0a20 2020  code == 412:.   
+0001c020: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0001c030: 7365 2044 6f63 756d 656e 7452 6576 6973  se DocumentRevis
+0001c040: 696f 6e45 7272 6f72 2872 6573 702c 2072  ionError(resp, r
+0001c050: 6571 7565 7374 290a 2020 2020 2020 2020  equest).        
+0001c060: 2020 2020 6966 206e 6f74 2072 6573 702e      if not resp.
+0001c070: 6973 5f73 7563 6365 7373 3a0a 2020 2020  is_success:.    
+0001c080: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0001c090: 6520 446f 6375 6d65 6e74 4465 6c65 7465  e DocumentDelete
+0001c0a0: 4572 726f 7228 7265 7370 2c20 7265 7175  Error(resp, requ
+0001c0b0: 6573 7429 0a20 2020 2020 2020 2020 2020  est).           
+0001c0c0: 2072 6574 7572 6e20 5472 7565 2069 6620   return True if 
+0001c0d0: 7369 6c65 6e74 2065 6c73 6520 7265 7370  silent else resp
+0001c0e0: 2e62 6f64 790a 0a20 2020 2020 2020 2072  .body..        r
+0001c0f0: 6574 7572 6e20 7365 6c66 2e5f 6578 6563  eturn self._exec
+0001c100: 7574 6528 7265 7175 6573 742c 2072 6573  ute(request, res
+0001c110: 706f 6e73 655f 6861 6e64 6c65 7229 0a0a  ponse_handler)..
+0001c120: 0a63 6c61 7373 2056 6572 7465 7843 6f6c  .class VertexCol
+0001c130: 6c65 6374 696f 6e28 436f 6c6c 6563 7469  lection(Collecti
+0001c140: 6f6e 293a 0a20 2020 2022 2222 5665 7274  on):.    """Vert
+0001c150: 6578 2063 6f6c 6c65 6374 696f 6e20 4150  ex collection AP
+0001c160: 4920 7772 6170 7065 722e 0a0a 2020 2020  I wrapper...    
+0001c170: 3a70 6172 616d 2063 6f6e 6e65 6374 696f  :param connectio
+0001c180: 6e3a 2048 5454 5020 636f 6e6e 6563 7469  n: HTTP connecti
+0001c190: 6f6e 2e0a 2020 2020 3a70 6172 616d 2065  on..    :param e
+0001c1a0: 7865 6375 746f 723a 2041 5049 2065 7865  xecutor: API exe
+0001c1b0: 6375 746f 722e 0a20 2020 203a 7061 7261  cutor..    :para
+0001c1c0: 6d20 6772 6170 683a 2047 7261 7068 206e  m graph: Graph n
+0001c1d0: 616d 652e 0a20 2020 203a 7061 7261 6d20  ame..    :param 
+0001c1e0: 6e61 6d65 3a20 5665 7274 6578 2063 6f6c  name: Vertex col
+0001c1f0: 6c65 6374 696f 6e20 6e61 6d65 2e0a 2020  lection name..  
+0001c200: 2020 2222 220a 0a20 2020 2064 6566 205f    """..    def _
+0001c210: 5f69 6e69 745f 5f28 0a20 2020 2020 2020  _init__(.       
+0001c220: 2073 656c 662c 2063 6f6e 6e65 6374 696f   self, connectio
+0001c230: 6e3a 2043 6f6e 6e65 6374 696f 6e2c 2065  n: Connection, e
+0001c240: 7865 6375 746f 723a 2041 7069 4578 6563  xecutor: ApiExec
+0001c250: 7574 6f72 2c20 6772 6170 683a 2073 7472  utor, graph: str
+0001c260: 2c20 6e61 6d65 3a20 7374 720a 2020 2020  , name: str.    
+0001c270: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+0001c280: 2020 2073 7570 6572 2829 2e5f 5f69 6e69     super().__ini
+0001c290: 745f 5f28 636f 6e6e 6563 7469 6f6e 2c20  t__(connection, 
+0001c2a0: 6578 6563 7574 6f72 2c20 6e61 6d65 290a  executor, name).
+0001c2b0: 2020 2020 2020 2020 7365 6c66 2e5f 6772          self._gr
+0001c2c0: 6170 6820 3d20 6772 6170 680a 0a20 2020  aph = graph..   
+0001c2d0: 2064 6566 205f 5f72 6570 725f 5f28 7365   def __repr__(se
+0001c2e0: 6c66 2920 2d3e 2073 7472 3a0a 2020 2020  lf) -> str:.    
+0001c2f0: 2020 2020 7265 7475 726e 2066 223c 5665      return f"<Ve
+0001c300: 7274 6578 436f 6c6c 6563 7469 6f6e 207b  rtexCollection {
+0001c310: 7365 6c66 2e6e 616d 657d 3e22 0a0a 2020  self.name}>"..  
+0001c320: 2020 6465 6620 5f5f 6765 7469 7465 6d5f    def __getitem_
+0001c330: 5f28 7365 6c66 2c20 6b65 793a 2055 6e69  _(self, key: Uni
+0001c340: 6f6e 5b73 7472 2c20 4a73 6f6e 5d29 202d  on[str, Json]) -
+0001c350: 3e20 5265 7375 6c74 5b4f 7074 696f 6e61  > Result[Optiona
+0001c360: 6c5b 4a73 6f6e 5d5d 3a0a 2020 2020 2020  l[Json]]:.      
+0001c370: 2020 7265 7475 726e 2073 656c 662e 6765    return self.ge
+0001c380: 7428 6b65 7929 0a0a 2020 2020 4070 726f  t(key)..    @pro
+0001c390: 7065 7274 790a 2020 2020 6465 6620 6772  perty.    def gr
+0001c3a0: 6170 6828 7365 6c66 2920 2d3e 2073 7472  aph(self) -> str
+0001c3b0: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
+0001c3c0: 7572 6e20 7468 6520 6772 6170 6820 6e61  urn the graph na
+0001c3d0: 6d65 2e0a 0a20 2020 2020 2020 203a 7265  me...        :re
+0001c3e0: 7475 726e 3a20 4772 6170 6820 6e61 6d65  turn: Graph name
+0001c3f0: 2e0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
+0001c400: 3a20 7374 720a 2020 2020 2020 2020 2222  : str.        ""
+0001c410: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+0001c420: 2073 656c 662e 5f67 7261 7068 0a0a 2020   self._graph..  
+0001c430: 2020 6465 6620 6765 7428 0a20 2020 2020    def get(.     
+0001c440: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0001c450: 2076 6572 7465 783a 2055 6e69 6f6e 5b73   vertex: Union[s
+0001c460: 7472 2c20 4a73 6f6e 5d2c 0a20 2020 2020  tr, Json],.     
+0001c470: 2020 2072 6576 3a20 4f70 7469 6f6e 616c     rev: Optional
+0001c480: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
+0001c490: 2020 2020 2020 6368 6563 6b5f 7265 763a        check_rev:
+0001c4a0: 2062 6f6f 6c20 3d20 5472 7565 2c0a 2020   bool = True,.  
+0001c4b0: 2020 2920 2d3e 2052 6573 756c 745b 4f70    ) -> Result[Op
+0001c4c0: 7469 6f6e 616c 5b4a 736f 6e5d 5d3a 0a20  tional[Json]]:. 
+0001c4d0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+0001c4e0: 2061 2076 6572 7465 7820 646f 6375 6d65   a vertex docume
+0001c4f0: 6e74 2e0a 0a20 2020 2020 2020 203a 7061  nt...        :pa
+0001c500: 7261 6d20 7665 7274 6578 3a20 5665 7274  ram vertex: Vert
+0001c510: 6578 2064 6f63 756d 656e 7420 4944 2c20  ex document ID, 
+0001c520: 6b65 7920 6f72 2062 6f64 792e 2044 6f63  key or body. Doc
+0001c530: 756d 656e 7420 626f 6479 206d 7573 740a  ument body must.
+0001c540: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
+0001c550: 6169 6e20 7468 6520 225f 6964 2220 6f72  ain the "_id" or
+0001c560: 2022 5f6b 6579 2220 6669 656c 642e 0a20   "_key" field.. 
+0001c570: 2020 2020 2020 203a 7479 7065 2076 6572         :type ver
+0001c580: 7465 783a 2073 7472 207c 2064 6963 740a  tex: str | dict.
+0001c590: 2020 2020 2020 2020 3a70 6172 616d 2072          :param r
+0001c5a0: 6576 3a20 4578 7065 6374 6564 2064 6f63  ev: Expected doc
+0001c5b0: 756d 656e 7420 7265 7669 7369 6f6e 2e20  ument revision. 
+0001c5c0: 4f76 6572 7269 6465 7320 7468 6520 7661  Overrides the va
+0001c5d0: 6c75 6520 6f66 2022 5f72 6576 220a 2020  lue of "_rev".  
+0001c5e0: 2020 2020 2020 2020 2020 6669 656c 6420            field 
+0001c5f0: 696e 202a 2a76 6572 7465 782a 2a20 6966  in **vertex** if
+0001c600: 2070 7265 7365 6e74 2e0a 2020 2020 2020   present..      
+0001c610: 2020 3a74 7970 6520 7265 763a 2073 7472    :type rev: str
+0001c620: 207c 204e 6f6e 650a 2020 2020 2020 2020   | None.        
+0001c630: 3a70 6172 616d 2063 6865 636b 5f72 6576  :param check_rev
+0001c640: 3a20 4966 2073 6574 2074 6f20 5472 7565  : If set to True
+0001c650: 2c20 7265 7669 7369 6f6e 206f 6620 2a2a  , revision of **
+0001c660: 7665 7274 6578 2a2a 2028 6966 2067 6976  vertex** (if giv
+0001c670: 656e 2920 6973 0a20 2020 2020 2020 2020  en) is.         
+0001c680: 2020 2063 6f6d 7061 7265 6420 6167 6169     compared agai
+0001c690: 6e73 7420 7468 6520 7265 7669 7369 6f6e  nst the revision
+0001c6a0: 206f 6620 7461 7267 6574 2076 6572 7465   of target verte
+0001c6b0: 7820 646f 6375 6d65 6e74 2e0a 2020 2020  x document..    
+0001c6c0: 2020 2020 3a74 7970 6520 6368 6563 6b5f      :type check_
+0001c6d0: 7265 763a 2062 6f6f 6c0a 2020 2020 2020  rev: bool.      
+0001c6e0: 2020 3a72 6574 7572 6e3a 2056 6572 7465    :return: Verte
+0001c6f0: 7820 646f 6375 6d65 6e74 206f 7220 4e6f  x document or No
+0001c700: 6e65 2069 6620 6e6f 7420 666f 756e 642e  ne if not found.
+0001c710: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
+0001c720: 2064 6963 7420 7c20 4e6f 6e65 0a20 2020   dict | None.   
+0001c730: 2020 2020 203a 7261 6973 6520 6172 616e       :raise aran
+0001c740: 676f 2e65 7863 6570 7469 6f6e 732e 446f  go.exceptions.Do
+0001c750: 6375 6d65 6e74 4765 7445 7272 6f72 3a20  cumentGetError: 
+0001c760: 4966 2072 6574 7269 6576 616c 2066 6169  If retrieval fai
+0001c770: 6c73 2e0a 2020 2020 2020 2020 3a72 6169  ls..        :rai
+0001c780: 7365 2061 7261 6e67 6f2e 6578 6365 7074  se arango.except
+0001c790: 696f 6e73 2e44 6f63 756d 656e 7452 6576  ions.DocumentRev
+0001c7a0: 6973 696f 6e45 7272 6f72 3a20 4966 2072  isionError: If r
+0001c7b0: 6576 6973 696f 6e73 206d 6973 6d61 7463  evisions mismatc
+0001c7c0: 682e 0a20 2020 2020 2020 2022 2222 0a20  h..        """. 
+0001c7d0: 2020 2020 2020 2068 616e 646c 652c 2062         handle, b
+0001c7e0: 6f64 792c 2068 6561 6465 7273 203d 2073  ody, headers = s
+0001c7f0: 656c 662e 5f70 7265 705f 6672 6f6d 5f64  elf._prep_from_d
+0001c800: 6f63 2876 6572 7465 782c 2072 6576 2c20  oc(vertex, rev, 
+0001c810: 6368 6563 6b5f 7265 7629 0a0a 2020 2020  check_rev)..    
+0001c820: 2020 2020 7265 7175 6573 7420 3d20 5265      request = Re
+0001c830: 7175 6573 7428 0a20 2020 2020 2020 2020  quest(.         
+0001c840: 2020 206d 6574 686f 643d 2267 6574 222c     method="get",
+0001c850: 0a20 2020 2020 2020 2020 2020 2065 6e64  .            end
+0001c860: 706f 696e 743d 6622 2f5f 6170 692f 6768  point=f"/_api/gh
+0001c870: 6172 6961 6c2f 7b73 656c 662e 5f67 7261  arial/{self._gra
+0001c880: 7068 7d2f 7665 7274 6578 2f7b 6861 6e64  ph}/vertex/{hand
+0001c890: 6c65 7d22 2c0a 2020 2020 2020 2020 2020  le}",.          
+0001c8a0: 2020 6865 6164 6572 733d 6865 6164 6572    headers=header
+0001c8b0: 732c 0a20 2020 2020 2020 2020 2020 2072  s,.            r
+0001c8c0: 6561 643d 7365 6c66 2e6e 616d 652c 0a20  ead=self.name,. 
+0001c8d0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0001c8e0: 2020 6465 6620 7265 7370 6f6e 7365 5f68    def response_h
+0001c8f0: 616e 646c 6572 2872 6573 703a 2052 6573  andler(resp: Res
+0001c900: 706f 6e73 6529 202d 3e20 4f70 7469 6f6e  ponse) -> Option
+0001c910: 616c 5b4a 736f 6e5d 3a0a 2020 2020 2020  al[Json]:.      
+0001c920: 2020 2020 2020 6966 2072 6573 702e 6572        if resp.er
+0001c930: 726f 725f 636f 6465 203d 3d20 3132 3032  ror_code == 1202
+0001c940: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001c950: 2020 7265 7475 726e 204e 6f6e 650a 2020    return None.  
+0001c960: 2020 2020 2020 2020 2020 6966 2072 6573            if res
+0001c970: 702e 7374 6174 7573 5f63 6f64 6520 3d3d  p.status_code ==
+0001c980: 2034 3132 3a0a 2020 2020 2020 2020 2020   412:.          
+0001c990: 2020 2020 2020 7261 6973 6520 446f 6375        raise Docu
+0001c9a0: 6d65 6e74 5265 7669 7369 6f6e 4572 726f  mentRevisionErro
+0001c9b0: 7228 7265 7370 2c20 7265 7175 6573 7429  r(resp, request)
+0001c9c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001c9d0: 6e6f 7420 7265 7370 2e69 735f 7375 6363  not resp.is_succ
+0001c9e0: 6573 733a 0a20 2020 2020 2020 2020 2020  ess:.           
+0001c9f0: 2020 2020 2072 6169 7365 2044 6f63 756d       raise Docum
+0001ca00: 656e 7447 6574 4572 726f 7228 7265 7370  entGetError(resp
+0001ca10: 2c20 7265 7175 6573 7429 0a20 2020 2020  , request).     
+0001ca20: 2020 2020 2020 2072 6573 756c 743a 204a         result: J
+0001ca30: 736f 6e20 3d20 7265 7370 2e62 6f64 795b  son = resp.body[
+0001ca40: 2276 6572 7465 7822 5d0a 2020 2020 2020  "vertex"].      
+0001ca50: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+0001ca60: 756c 740a 0a20 2020 2020 2020 2072 6574  ult..        ret
+0001ca70: 7572 6e20 7365 6c66 2e5f 6578 6563 7574  urn self._execut
+0001ca80: 6528 7265 7175 6573 742c 2072 6573 706f  e(request, respo
+0001ca90: 6e73 655f 6861 6e64 6c65 7229 0a0a 2020  nse_handler)..  
+0001caa0: 2020 6465 6620 696e 7365 7274 280a 2020    def insert(.  
+0001cab0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0001cac0: 2020 2020 7665 7274 6578 3a20 4a73 6f6e      vertex: Json
+0001cad0: 2c0a 2020 2020 2020 2020 7379 6e63 3a20  ,.        sync: 
+0001cae0: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 203d  Optional[bool] =
+0001caf0: 204e 6f6e 652c 0a20 2020 2020 2020 2073   None,.        s
+0001cb00: 696c 656e 743a 2062 6f6f 6c20 3d20 4661  ilent: bool = Fa
+0001cb10: 6c73 652c 0a20 2020 2020 2020 2072 6574  lse,.        ret
+0001cb20: 7572 6e5f 6e65 773a 2062 6f6f 6c20 3d20  urn_new: bool = 
+0001cb30: 4661 6c73 652c 0a20 2020 2029 202d 3e20  False,.    ) -> 
+0001cb40: 5265 7375 6c74 5b55 6e69 6f6e 5b62 6f6f  Result[Union[boo
+0001cb50: 6c2c 204a 736f 6e5d 5d3a 0a20 2020 2020  l, Json]]:.     
+0001cb60: 2020 2022 2222 496e 7365 7274 2061 206e     """Insert a n
+0001cb70: 6577 2076 6572 7465 7820 646f 6375 6d65  ew vertex docume
+0001cb80: 6e74 2e0a 0a20 2020 2020 2020 203a 7061  nt...        :pa
+0001cb90: 7261 6d20 7665 7274 6578 3a20 4e65 7720  ram vertex: New 
+0001cba0: 7665 7274 6578 2064 6f63 756d 656e 7420  vertex document 
+0001cbb0: 746f 2069 6e73 6572 742e 2049 6620 6974  to insert. If it
+0001cbc0: 2068 6173 2022 5f6b 6579 2220 6f72 2022   has "_key" or "
+0001cbd0: 5f69 6422 0a20 2020 2020 2020 2020 2020  _id".           
+0001cbe0: 2066 6965 6c64 2c20 6974 7320 7661 6c75   field, its valu
+0001cbf0: 6520 6973 2075 7365 6420 6173 206b 6579  e is used as key
+0001cc00: 206f 6620 7468 6520 6e65 7720 7665 7274   of the new vert
+0001cc10: 6578 2028 6f74 6865 7277 6973 6520 6974  ex (otherwise it
+0001cc20: 2069 730a 2020 2020 2020 2020 2020 2020   is.            
+0001cc30: 6175 746f 2d67 656e 6572 6174 6564 292e  auto-generated).
+0001cc40: 2041 6e79 2022 5f72 6576 2220 6669 656c   Any "_rev" fiel
+0001cc50: 6420 6973 2069 676e 6f72 6564 2e0a 2020  d is ignored..  
+0001cc60: 2020 2020 2020 3a74 7970 6520 7665 7274        :type vert
+0001cc70: 6578 3a20 6469 6374 0a20 2020 2020 2020  ex: dict.       
+0001cc80: 203a 7061 7261 6d20 7379 6e63 3a20 426c   :param sync: Bl
+0001cc90: 6f63 6b20 756e 7469 6c20 6f70 6572 6174  ock until operat
+0001cca0: 696f 6e20 6973 2073 796e 6368 726f 6e69  ion is synchroni
+0001ccb0: 7a65 6420 746f 2064 6973 6b2e 0a20 2020  zed to disk..   
+0001ccc0: 2020 2020 203a 7479 7065 2073 796e 633a       :type sync:
+0001ccd0: 2062 6f6f 6c20 7c20 4e6f 6e65 0a20 2020   bool | None.   
+0001cce0: 2020 2020 203a 7061 7261 6d20 7369 6c65       :param sile
+0001ccf0: 6e74 3a20 4966 2073 6574 2074 6f20 5472  nt: If set to Tr
+0001cd00: 7565 2c20 6e6f 2064 6f63 756d 656e 7420  ue, no document 
+0001cd10: 6d65 7461 6461 7461 2069 7320 7265 7475  metadata is retu
+0001cd20: 726e 6564 2e20 5468 6973 0a20 2020 2020  rned. This.     
+0001cd30: 2020 2020 2020 2063 616e 2062 6520 7573         can be us
+0001cd40: 6564 2074 6f20 7361 7665 2072 6573 6f75  ed to save resou
+0001cd50: 7263 6573 2e0a 2020 2020 2020 2020 3a74  rces..        :t
+0001cd60: 7970 6520 7369 6c65 6e74 3a20 626f 6f6c  ype silent: bool
+0001cd70: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001cd80: 7265 7475 726e 5f6e 6577 3a20 496e 636c  return_new: Incl
+0001cd90: 7564 6520 626f 6479 206f 6620 7468 6520  ude body of the 
+0001cda0: 6e65 7720 646f 6375 6d65 6e74 2069 6e20  new document in 
+0001cdb0: 7468 6520 7265 7475 726e 6564 0a20 2020  the returned.   
+0001cdc0: 2020 2020 2020 2020 206d 6574 6164 6174           metadat
+0001cdd0: 612e 2049 676e 6f72 6564 2069 6620 7061  a. Ignored if pa
+0001cde0: 7261 6d65 7465 7220 2a2a 7369 6c65 6e74  rameter **silent
+0001cdf0: 2a2a 2069 7320 7365 7420 746f 2054 7275  ** is set to Tru
+0001ce00: 652e 0a20 2020 2020 2020 203a 7479 7065  e..        :type
+0001ce10: 2072 6574 7572 6e5f 6e65 773a 2062 6f6f   return_new: boo
+0001ce20: 6c0a 2020 2020 2020 2020 3a72 6574 7572  l.        :retur
+0001ce30: 6e3a 2044 6f63 756d 656e 7420 6d65 7461  n: Document meta
+0001ce40: 6461 7461 2028 652e 672e 2064 6f63 756d  data (e.g. docum
+0001ce50: 656e 7420 6b65 792c 2072 6576 6973 696f  ent key, revisio
+0001ce60: 6e29 2c20 6f72 2054 7275 6520 6966 0a20  n), or True if. 
+0001ce70: 2020 2020 2020 2020 2020 2070 6172 616d             param
+0001ce80: 6574 6572 202a 2a73 696c 656e 742a 2a20  eter **silent** 
+0001ce90: 7761 7320 7365 7420 746f 2054 7275 652e  was set to True.
+0001cea0: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
+0001ceb0: 2062 6f6f 6c20 7c20 6469 6374 0a20 2020   bool | dict.   
+0001cec0: 2020 2020 203a 7261 6973 6520 6172 616e       :raise aran
+0001ced0: 676f 2e65 7863 6570 7469 6f6e 732e 446f  go.exceptions.Do
+0001cee0: 6375 6d65 6e74 496e 7365 7274 4572 726f  cumentInsertErro
+0001cef0: 723a 2049 6620 696e 7365 7274 2066 6169  r: If insert fai
+0001cf00: 6c73 2e0a 2020 2020 2020 2020 2222 220a  ls..        """.
+0001cf10: 2020 2020 2020 2020 7665 7274 6578 203d          vertex =
+0001cf20: 2073 656c 662e 5f65 6e73 7572 655f 6b65   self._ensure_ke
+0001cf30: 795f 6672 6f6d 5f69 6428 7665 7274 6578  y_from_id(vertex
+0001cf40: 290a 0a20 2020 2020 2020 2070 6172 616d  )..        param
+0001cf50: 733a 2050 6172 616d 7320 3d20 7b22 7369  s: Params = {"si
+0001cf60: 6c65 6e74 223a 2073 696c 656e 742c 2022  lent": silent, "
+0001cf70: 7265 7475 726e 4e65 7722 3a20 7265 7475  returnNew": retu
+0001cf80: 726e 5f6e 6577 7d0a 2020 2020 2020 2020  rn_new}.        
+0001cf90: 6966 2073 796e 6320 6973 206e 6f74 204e  if sync is not N
+0001cfa0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+0001cfb0: 2070 6172 616d 735b 2277 6169 7446 6f72   params["waitFor
+0001cfc0: 5379 6e63 225d 203d 2073 796e 630a 0a20  Sync"] = sync.. 
+0001cfd0: 2020 2020 2020 2072 6571 7565 7374 203d         request =
+0001cfe0: 2052 6571 7565 7374 280a 2020 2020 2020   Request(.      
+0001cff0: 2020 2020 2020 6d65 7468 6f64 3d22 706f        method="po
+0001d000: 7374 222c 0a20 2020 2020 2020 2020 2020  st",.           
+0001d010: 2065 6e64 706f 696e 743d 6622 2f5f 6170   endpoint=f"/_ap
+0001d020: 692f 6768 6172 6961 6c2f 7b73 656c 662e  i/gharial/{self.
+0001d030: 5f67 7261 7068 7d2f 7665 7274 6578 2f7b  _graph}/vertex/{
+0001d040: 7365 6c66 2e6e 616d 657d 222c 0a20 2020  self.name}",.   
+0001d050: 2020 2020 2020 2020 2064 6174 613d 7665           data=ve
+0001d060: 7274 6578 2c0a 2020 2020 2020 2020 2020  rtex,.          
+0001d070: 2020 7061 7261 6d73 3d70 6172 616d 732c    params=params,
+0001d080: 0a20 2020 2020 2020 2020 2020 2077 7269  .            wri
+0001d090: 7465 3d73 656c 662e 6e61 6d65 2c0a 2020  te=self.name,.  
+0001d0a0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+0001d0b0: 2064 6566 2072 6573 706f 6e73 655f 6861   def response_ha
+0001d0c0: 6e64 6c65 7228 7265 7370 3a20 5265 7370  ndler(resp: Resp
+0001d0d0: 6f6e 7365 2920 2d3e 2055 6e69 6f6e 5b62  onse) -> Union[b
+0001d0e0: 6f6f 6c2c 204a 736f 6e5d 3a0a 2020 2020  ool, Json]:.    
+0001d0f0: 2020 2020 2020 2020 6966 206e 6f74 2072          if not r
+0001d100: 6573 702e 6973 5f73 7563 6365 7373 3a0a  esp.is_success:.
+0001d110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d120: 7261 6973 6520 446f 6375 6d65 6e74 496e  raise DocumentIn
+0001d130: 7365 7274 4572 726f 7228 7265 7370 2c20  sertError(resp, 
+0001d140: 7265 7175 6573 7429 0a20 2020 2020 2020  request).       
+0001d150: 2020 2020 2069 6620 7369 6c65 6e74 3a0a       if silent:.
+0001d160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d170: 7265 7475 726e 2054 7275 650a 2020 2020  return True.    
+0001d180: 2020 2020 2020 2020 7265 7475 726e 2066          return f
+0001d190: 6f72 6d61 745f 7665 7274 6578 2872 6573  ormat_vertex(res
+0001d1a0: 702e 626f 6479 290a 0a20 2020 2020 2020  p.body)..       
+0001d1b0: 2072 6574 7572 6e20 7365 6c66 2e5f 6578   return self._ex
+0001d1c0: 6563 7574 6528 7265 7175 6573 742c 2072  ecute(request, r
+0001d1d0: 6573 706f 6e73 655f 6861 6e64 6c65 7229  esponse_handler)
+0001d1e0: 0a0a 2020 2020 6465 6620 7570 6461 7465  ..    def update
+0001d1f0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0001d200: 2020 2020 2020 2020 7665 7274 6578 3a20          vertex: 
+0001d210: 4a73 6f6e 2c0a 2020 2020 2020 2020 6368  Json,.        ch
+0001d220: 6563 6b5f 7265 763a 2062 6f6f 6c20 3d20  eck_rev: bool = 
+0001d230: 5472 7565 2c0a 2020 2020 2020 2020 6b65  True,.        ke
+0001d240: 6570 5f6e 6f6e 653a 2062 6f6f 6c20 3d20  ep_none: bool = 
+0001d250: 5472 7565 2c0a 2020 2020 2020 2020 7379  True,.        sy
+0001d260: 6e63 3a20 4f70 7469 6f6e 616c 5b62 6f6f  nc: Optional[boo
+0001d270: 6c5d 203d 204e 6f6e 652c 0a20 2020 2020  l] = None,.     
+0001d280: 2020 2073 696c 656e 743a 2062 6f6f 6c20     silent: bool 
+0001d290: 3d20 4661 6c73 652c 0a20 2020 2020 2020  = False,.       
+0001d2a0: 2072 6574 7572 6e5f 6f6c 643a 2062 6f6f   return_old: boo
+0001d2b0: 6c20 3d20 4661 6c73 652c 0a20 2020 2020  l = False,.     
+0001d2c0: 2020 2072 6574 7572 6e5f 6e65 773a 2062     return_new: b
+0001d2d0: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
+0001d2e0: 2029 202d 3e20 5265 7375 6c74 5b55 6e69   ) -> Result[Uni
+0001d2f0: 6f6e 5b62 6f6f 6c2c 204a 736f 6e5d 5d3a  on[bool, Json]]:
+0001d300: 0a20 2020 2020 2020 2022 2222 5570 6461  .        """Upda
+0001d310: 7465 2061 2076 6572 7465 7820 646f 6375  te a vertex docu
+0001d320: 6d65 6e74 2e0a 0a20 2020 2020 2020 203a  ment...        :
+0001d330: 7061 7261 6d20 7665 7274 6578 3a20 5061  param vertex: Pa
+0001d340: 7274 6961 6c20 6f72 2066 756c 6c20 7665  rtial or full ve
+0001d350: 7274 6578 2064 6f63 756d 656e 7420 7769  rtex document wi
+0001d360: 7468 2075 7064 6174 6564 2076 616c 7565  th updated value
+0001d370: 732e 2049 740a 2020 2020 2020 2020 2020  s. It.          
+0001d380: 2020 6d75 7374 2063 6f6e 7461 696e 2074    must contain t
+0001d390: 6865 2022 5f6b 6579 2220 6f72 2022 5f69  he "_key" or "_i
+0001d3a0: 6422 2066 6965 6c64 2e0a 2020 2020 2020  d" field..      
+0001d3b0: 2020 3a74 7970 6520 7665 7274 6578 3a20    :type vertex: 
+0001d3c0: 6469 6374 0a20 2020 2020 2020 203a 7061  dict.        :pa
+0001d3d0: 7261 6d20 6368 6563 6b5f 7265 763a 2049  ram check_rev: I
+0001d3e0: 6620 7365 7420 746f 2054 7275 652c 2072  f set to True, r
+0001d3f0: 6576 6973 696f 6e20 6f66 202a 2a76 6572  evision of **ver
+0001d400: 7465 782a 2a20 2869 6620 6769 7665 6e29  tex** (if given)
+0001d410: 2069 730a 2020 2020 2020 2020 2020 2020   is.            
+0001d420: 636f 6d70 6172 6564 2061 6761 696e 7374  compared against
+0001d430: 2074 6865 2072 6576 6973 696f 6e20 6f66   the revision of
+0001d440: 2074 6172 6765 7420 7665 7274 6578 2064   target vertex d
+0001d450: 6f63 756d 656e 742e 0a20 2020 2020 2020  ocument..       
+0001d460: 203a 7479 7065 2063 6865 636b 5f72 6576   :type check_rev
+0001d470: 3a20 626f 6f6c 0a20 2020 2020 2020 203a  : bool.        :
+0001d480: 7061 7261 6d20 6b65 6570 5f6e 6f6e 653a  param keep_none:
+0001d490: 2049 6620 7365 7420 746f 2054 7275 652c   If set to True,
+0001d4a0: 2066 6965 6c64 7320 7769 7468 2076 616c   fields with val
+0001d4b0: 7565 204e 6f6e 6520 6172 6520 7265 7461  ue None are reta
+0001d4c0: 696e 6564 0a20 2020 2020 2020 2020 2020  ined.           
+0001d4d0: 2069 6e20 7468 6520 646f 6375 6d65 6e74   in the document
+0001d4e0: 2e20 4966 2073 6574 2074 6f20 4661 6c73  . If set to Fals
+0001d4f0: 652c 2074 6865 7920 6172 6520 7265 6d6f  e, they are remo
+0001d500: 7665 6420 636f 6d70 6c65 7465 6c79 2e0a  ved completely..
+0001d510: 2020 2020 2020 2020 3a74 7970 6520 6b65          :type ke
+0001d520: 6570 5f6e 6f6e 653a 2062 6f6f 6c20 7c20  ep_none: bool | 
+0001d530: 4e6f 6e65 0a20 2020 2020 2020 203a 7061  None.        :pa
+0001d540: 7261 6d20 7379 6e63 3a20 426c 6f63 6b20  ram sync: Block 
+0001d550: 756e 7469 6c20 6f70 6572 6174 696f 6e20  until operation 
+0001d560: 6973 2073 796e 6368 726f 6e69 7a65 6420  is synchronized 
+0001d570: 746f 2064 6973 6b2e 0a20 2020 2020 2020  to disk..       
+0001d580: 203a 7479 7065 2073 796e 633a 2062 6f6f   :type sync: boo
+0001d590: 6c20 7c20 4e6f 6e65 0a20 2020 2020 2020  l | None.       
+0001d5a0: 203a 7061 7261 6d20 7369 6c65 6e74 3a20   :param silent: 
+0001d5b0: 4966 2073 6574 2074 6f20 5472 7565 2c20  If set to True, 
+0001d5c0: 6e6f 2064 6f63 756d 656e 7420 6d65 7461  no document meta
+0001d5d0: 6461 7461 2069 7320 7265 7475 726e 6564  data is returned
+0001d5e0: 2e20 5468 6973 0a20 2020 2020 2020 2020  . This.         
+0001d5f0: 2020 2063 616e 2062 6520 7573 6564 2074     can be used t
+0001d600: 6f20 7361 7665 2072 6573 6f75 7263 6573  o save resources
+0001d610: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
+0001d620: 7369 6c65 6e74 3a20 626f 6f6c 0a20 2020  silent: bool.   
+0001d630: 2020 2020 203a 7061 7261 6d20 7265 7475       :param retu
+0001d640: 726e 5f6f 6c64 3a20 496e 636c 7564 6520  rn_old: Include 
+0001d650: 626f 6479 206f 6620 7468 6520 6f6c 6420  body of the old 
+0001d660: 646f 6375 6d65 6e74 2069 6e20 7468 6520  document in the 
+0001d670: 7265 7475 726e 6564 0a20 2020 2020 2020  returned.       
+0001d680: 2020 2020 206d 6574 6164 6174 612e 2049       metadata. I
+0001d690: 676e 6f72 6564 2069 6620 7061 7261 6d65  gnored if parame
+0001d6a0: 7465 7220 2a2a 7369 6c65 6e74 2a2a 2069  ter **silent** i
+0001d6b0: 7320 7365 7420 746f 2054 7275 652e 0a20  s set to True.. 
+0001d6c0: 2020 2020 2020 203a 7479 7065 2072 6574         :type ret
+0001d6d0: 7572 6e5f 6f6c 643a 2062 6f6f 6c0a 2020  urn_old: bool.  
+0001d6e0: 2020 2020 2020 3a70 6172 616d 2072 6574        :param ret
+0001d6f0: 7572 6e5f 6e65 773a 2049 6e63 6c75 6465  urn_new: Include
+0001d700: 2062 6f64 7920 6f66 2074 6865 206e 6577   body of the new
+0001d710: 2064 6f63 756d 656e 7420 696e 2074 6865   document in the
+0001d720: 2072 6574 7572 6e65 640a 2020 2020 2020   returned.      
+0001d730: 2020 2020 2020 6d65 7461 6461 7461 2e20        metadata. 
+0001d740: 4967 6e6f 7265 6420 6966 2070 6172 616d  Ignored if param
+0001d750: 6574 6572 202a 2a73 696c 656e 742a 2a20  eter **silent** 
+0001d760: 6973 2073 6574 2074 6f20 5472 7565 2e0a  is set to True..
+0001d770: 2020 2020 2020 2020 3a74 7970 6520 7265          :type re
+0001d780: 7475 726e 5f6e 6577 3a20 626f 6f6c 0a20  turn_new: bool. 
+0001d790: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
+0001d7a0: 446f 6375 6d65 6e74 206d 6574 6164 6174  Document metadat
+0001d7b0: 6120 2865 2e67 2e20 646f 6375 6d65 6e74  a (e.g. document
+0001d7c0: 206b 6579 2c20 7265 7669 7369 6f6e 2920   key, revision) 
+0001d7d0: 6f72 2054 7275 6520 6966 0a20 2020 2020  or True if.     
+0001d7e0: 2020 2020 2020 2070 6172 616d 6574 6572         parameter
+0001d7f0: 202a 2a73 696c 656e 742a 2a20 7761 7320   **silent** was 
+0001d800: 7365 7420 746f 2054 7275 652e 0a20 2020  set to True..   
+0001d810: 2020 2020 203a 7274 7970 653a 2062 6f6f       :rtype: boo
+0001d820: 6c20 7c20 6469 6374 0a20 2020 2020 2020  l | dict.       
+0001d830: 203a 7261 6973 6520 6172 616e 676f 2e65   :raise arango.e
+0001d840: 7863 6570 7469 6f6e 732e 446f 6375 6d65  xceptions.Docume
+0001d850: 6e74 5570 6461 7465 4572 726f 723a 2049  ntUpdateError: I
+0001d860: 6620 7570 6461 7465 2066 6169 6c73 2e0a  f update fails..
+0001d870: 2020 2020 2020 2020 3a72 6169 7365 2061          :raise a
+0001d880: 7261 6e67 6f2e 6578 6365 7074 696f 6e73  rango.exceptions
+0001d890: 2e44 6f63 756d 656e 7452 6576 6973 696f  .DocumentRevisio
+0001d8a0: 6e45 7272 6f72 3a20 4966 2072 6576 6973  nError: If revis
+0001d8b0: 696f 6e73 206d 6973 6d61 7463 682e 0a20  ions mismatch.. 
+0001d8c0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0001d8d0: 2020 2076 6572 7465 785f 6964 2c20 6865     vertex_id, he
+0001d8e0: 6164 6572 7320 3d20 7365 6c66 2e5f 7072  aders = self._pr
+0001d8f0: 6570 5f66 726f 6d5f 626f 6479 2876 6572  ep_from_body(ver
+0001d900: 7465 782c 2063 6865 636b 5f72 6576 290a  tex, check_rev).
+0001d910: 0a20 2020 2020 2020 2070 6172 616d 733a  .        params:
+0001d920: 2050 6172 616d 7320 3d20 7b0a 2020 2020   Params = {.    
+0001d930: 2020 2020 2020 2020 226b 6565 704e 756c          "keepNul
+0001d940: 6c22 3a20 6b65 6570 5f6e 6f6e 652c 0a20  l": keep_none,. 
+0001d950: 2020 2020 2020 2020 2020 2022 6f76 6572             "over
+0001d960: 7772 6974 6522 3a20 6e6f 7420 6368 6563  write": not chec
+0001d970: 6b5f 7265 762c 0a20 2020 2020 2020 2020  k_rev,.         
+0001d980: 2020 2022 7369 6c65 6e74 223a 2073 696c     "silent": sil
+0001d990: 656e 742c 0a20 2020 2020 2020 2020 2020  ent,.           
+0001d9a0: 2022 7265 7475 726e 4e65 7722 3a20 7265   "returnNew": re
+0001d9b0: 7475 726e 5f6e 6577 2c0a 2020 2020 2020  turn_new,.      
+0001d9c0: 2020 2020 2020 2272 6574 7572 6e4f 6c64        "returnOld
+0001d9d0: 223a 2072 6574 7572 6e5f 6f6c 642c 0a20  ": return_old,. 
+0001d9e0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+0001d9f0: 2069 6620 7379 6e63 2069 7320 6e6f 7420   if sync is not 
+0001da00: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0001da10: 2020 7061 7261 6d73 5b22 7761 6974 466f    params["waitFo
+0001da20: 7253 796e 6322 5d20 3d20 7379 6e63 0a0a  rSync"] = sync..
+0001da30: 2020 2020 2020 2020 7265 7175 6573 7420          request 
+0001da40: 3d20 5265 7175 6573 7428 0a20 2020 2020  = Request(.     
+0001da50: 2020 2020 2020 206d 6574 686f 643d 2270         method="p
+0001da60: 6174 6368 222c 0a20 2020 2020 2020 2020  atch",.         
+0001da70: 2020 2065 6e64 706f 696e 743d 6622 2f5f     endpoint=f"/_
+0001da80: 6170 692f 6768 6172 6961 6c2f 7b73 656c  api/gharial/{sel
+0001da90: 662e 5f67 7261 7068 7d2f 7665 7274 6578  f._graph}/vertex
+0001daa0: 2f7b 7665 7274 6578 5f69 647d 222c 0a20  /{vertex_id}",. 
+0001dab0: 2020 2020 2020 2020 2020 2068 6561 6465             heade
+0001dac0: 7273 3d68 6561 6465 7273 2c0a 2020 2020  rs=headers,.    
+0001dad0: 2020 2020 2020 2020 7061 7261 6d73 3d70          params=p
+0001dae0: 6172 616d 732c 0a20 2020 2020 2020 2020  arams,.         
+0001daf0: 2020 2064 6174 613d 7665 7274 6578 2c0a     data=vertex,.
+0001db00: 2020 2020 2020 2020 2020 2020 7772 6974              writ
+0001db10: 653d 7365 6c66 2e6e 616d 652c 0a20 2020  e=self.name,.   
+0001db20: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0001db30: 6465 6620 7265 7370 6f6e 7365 5f68 616e  def response_han
+0001db40: 646c 6572 2872 6573 703a 2052 6573 706f  dler(resp: Respo
+0001db50: 6e73 6529 202d 3e20 556e 696f 6e5b 626f  nse) -> Union[bo
+0001db60: 6f6c 2c20 4a73 6f6e 5d3a 0a20 2020 2020  ol, Json]:.     
+0001db70: 2020 2020 2020 2069 6620 7265 7370 2e73         if resp.s
+0001db80: 7461 7475 735f 636f 6465 203d 3d20 3431  tatus_code == 41
+0001db90: 323a 2020 2320 7072 6167 6d61 3a20 6e6f  2:  # pragma: no
+0001dba0: 2063 6f76 6572 0a20 2020 2020 2020 2020   cover.         
+0001dbb0: 2020 2020 2020 2072 6169 7365 2044 6f63         raise Doc
+0001dbc0: 756d 656e 7452 6576 6973 696f 6e45 7272  umentRevisionErr
+0001dbd0: 6f72 2872 6573 702c 2072 6571 7565 7374  or(resp, request
+0001dbe0: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
+0001dbf0: 6966 206e 6f74 2072 6573 702e 6973 5f73  if not resp.is_s
+0001dc00: 7563 6365 7373 3a0a 2020 2020 2020 2020  uccess:.        
+0001dc10: 2020 2020 2020 2020 7261 6973 6520 446f          raise Do
+0001dc20: 6375 6d65 6e74 5570 6461 7465 4572 726f  cumentUpdateErro
+0001dc30: 7228 7265 7370 2c20 7265 7175 6573 7429  r(resp, request)
+0001dc40: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001dc50: 7369 6c65 6e74 2069 7320 5472 7565 3a0a  silent is True:.
+0001dc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dc70: 7265 7475 726e 2054 7275 650a 2020 2020  return True.    
+0001dc80: 2020 2020 2020 2020 7265 7475 726e 2066          return f
+0001dc90: 6f72 6d61 745f 7665 7274 6578 2872 6573  ormat_vertex(res
+0001dca0: 702e 626f 6479 290a 0a20 2020 2020 2020  p.body)..       
+0001dcb0: 2072 6574 7572 6e20 7365 6c66 2e5f 6578   return self._ex
+0001dcc0: 6563 7574 6528 7265 7175 6573 742c 2072  ecute(request, r
+0001dcd0: 6573 706f 6e73 655f 6861 6e64 6c65 7229  esponse_handler)
+0001dce0: 0a0a 2020 2020 6465 6620 7265 706c 6163  ..    def replac
+0001dcf0: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
+0001dd00: 0a20 2020 2020 2020 2076 6572 7465 783a  .        vertex:
+0001dd10: 204a 736f 6e2c 0a20 2020 2020 2020 2063   Json,.        c
+0001dd20: 6865 636b 5f72 6576 3a20 626f 6f6c 203d  heck_rev: bool =
+0001dd30: 2054 7275 652c 0a20 2020 2020 2020 2073   True,.        s
+0001dd40: 796e 633a 204f 7074 696f 6e61 6c5b 626f  ync: Optional[bo
+0001dd50: 6f6c 5d20 3d20 4e6f 6e65 2c0a 2020 2020  ol] = None,.    
+0001dd60: 2020 2020 7369 6c65 6e74 3a20 626f 6f6c      silent: bool
+0001dd70: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
+0001dd80: 2020 7265 7475 726e 5f6f 6c64 3a20 626f    return_old: bo
+0001dd90: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
+0001dda0: 2020 2020 7265 7475 726e 5f6e 6577 3a20      return_new: 
+0001ddb0: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+0001ddc0: 2020 2920 2d3e 2052 6573 756c 745b 556e    ) -> Result[Un
+0001ddd0: 696f 6e5b 626f 6f6c 2c20 4a73 6f6e 5d5d  ion[bool, Json]]
+0001dde0: 3a0a 2020 2020 2020 2020 2222 2252 6570  :.        """Rep
+0001ddf0: 6c61 6365 2061 2076 6572 7465 7820 646f  lace a vertex do
+0001de00: 6375 6d65 6e74 2e0a 0a20 2020 2020 2020  cument...       
+0001de10: 203a 7061 7261 6d20 7665 7274 6578 3a20   :param vertex: 
+0001de20: 4e65 7720 7665 7274 6578 2064 6f63 756d  New vertex docum
+0001de30: 656e 7420 746f 2072 6570 6c61 6365 2074  ent to replace t
+0001de40: 6865 206f 6c64 206f 6e65 2077 6974 682e  he old one with.
+0001de50: 2049 7420 6d75 7374 0a20 2020 2020 2020   It must.       
+0001de60: 2020 2020 2063 6f6e 7461 696e 2074 6865       contain the
+0001de70: 2022 5f6b 6579 2220 6f72 2022 5f69 6422   "_key" or "_id"
+0001de80: 2066 6965 6c64 2e0a 2020 2020 2020 2020   field..        
+0001de90: 3a74 7970 6520 7665 7274 6578 3a20 6469  :type vertex: di
+0001dea0: 6374 0a20 2020 2020 2020 203a 7061 7261  ct.        :para
+0001deb0: 6d20 6368 6563 6b5f 7265 763a 2049 6620  m check_rev: If 
+0001dec0: 7365 7420 746f 2054 7275 652c 2072 6576  set to True, rev
+0001ded0: 6973 696f 6e20 6f66 202a 2a76 6572 7465  ision of **verte
+0001dee0: 782a 2a20 2869 6620 6769 7665 6e29 2069  x** (if given) i
+0001def0: 730a 2020 2020 2020 2020 2020 2020 636f  s.            co
+0001df00: 6d70 6172 6564 2061 6761 696e 7374 2074  mpared against t
+0001df10: 6865 2072 6576 6973 696f 6e20 6f66 2074  he revision of t
+0001df20: 6172 6765 7420 7665 7274 6578 2064 6f63  arget vertex doc
+0001df30: 756d 656e 742e 0a20 2020 2020 2020 203a  ument..        :
+0001df40: 7479 7065 2063 6865 636b 5f72 6576 3a20  type check_rev: 
+0001df50: 626f 6f6c 0a20 2020 2020 2020 203a 7061  bool.        :pa
+0001df60: 7261 6d20 7379 6e63 3a20 426c 6f63 6b20  ram sync: Block 
+0001df70: 756e 7469 6c20 6f70 6572 6174 696f 6e20  until operation 
+0001df80: 6973 2073 796e 6368 726f 6e69 7a65 6420  is synchronized 
+0001df90: 746f 2064 6973 6b2e 0a20 2020 2020 2020  to disk..       
+0001dfa0: 203a 7479 7065 2073 796e 633a 2062 6f6f   :type sync: boo
+0001dfb0: 6c20 7c20 4e6f 6e65 0a20 2020 2020 2020  l | None.       
+0001dfc0: 203a 7061 7261 6d20 7369 6c65 6e74 3a20   :param silent: 
+0001dfd0: 4966 2073 6574 2074 6f20 5472 7565 2c20  If set to True, 
+0001dfe0: 6e6f 2064 6f63 756d 656e 7420 6d65 7461  no document meta
+0001dff0: 6461 7461 2069 7320 7265 7475 726e 6564  data is returned
+0001e000: 2e20 5468 6973 0a20 2020 2020 2020 2020  . This.         
+0001e010: 2020 2063 616e 2062 6520 7573 6564 2074     can be used t
+0001e020: 6f20 7361 7665 2072 6573 6f75 7263 6573  o save resources
+0001e030: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
+0001e040: 7369 6c65 6e74 3a20 626f 6f6c 0a20 2020  silent: bool.   
+0001e050: 2020 2020 203a 7061 7261 6d20 7265 7475       :param retu
+0001e060: 726e 5f6f 6c64 3a20 496e 636c 7564 6520  rn_old: Include 
+0001e070: 626f 6479 206f 6620 7468 6520 6f6c 6420  body of the old 
+0001e080: 646f 6375 6d65 6e74 2069 6e20 7468 6520  document in the 
+0001e090: 7265 7475 726e 6564 0a20 2020 2020 2020  returned.       
+0001e0a0: 2020 2020 206d 6574 6164 6174 612e 2049       metadata. I
+0001e0b0: 676e 6f72 6564 2069 6620 7061 7261 6d65  gnored if parame
+0001e0c0: 7465 7220 2a2a 7369 6c65 6e74 2a2a 2069  ter **silent** i
+0001e0d0: 7320 7365 7420 746f 2054 7275 652e 0a20  s set to True.. 
+0001e0e0: 2020 2020 2020 203a 7479 7065 2072 6574         :type ret
+0001e0f0: 7572 6e5f 6f6c 643a 2062 6f6f 6c0a 2020  urn_old: bool.  
+0001e100: 2020 2020 2020 3a70 6172 616d 2072 6574        :param ret
+0001e110: 7572 6e5f 6e65 773a 2049 6e63 6c75 6465  urn_new: Include
+0001e120: 2062 6f64 7920 6f66 2074 6865 206e 6577   body of the new
+0001e130: 2064 6f63 756d 656e 7420 696e 2074 6865   document in the
+0001e140: 2072 6574 7572 6e65 640a 2020 2020 2020   returned.      
+0001e150: 2020 2020 2020 6d65 7461 6461 7461 2e20        metadata. 
+0001e160: 4967 6e6f 7265 6420 6966 2070 6172 616d  Ignored if param
+0001e170: 6574 6572 202a 2a73 696c 656e 742a 2a20  eter **silent** 
+0001e180: 6973 2073 6574 2074 6f20 5472 7565 2e0a  is set to True..
+0001e190: 2020 2020 2020 2020 3a74 7970 6520 7265          :type re
+0001e1a0: 7475 726e 5f6e 6577 3a20 626f 6f6c 0a20  turn_new: bool. 
+0001e1b0: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
+0001e1c0: 446f 6375 6d65 6e74 206d 6574 6164 6174  Document metadat
+0001e1d0: 6120 2865 2e67 2e20 646f 6375 6d65 6e74  a (e.g. document
+0001e1e0: 206b 6579 2c20 7265 7669 7369 6f6e 2920   key, revision) 
+0001e1f0: 6f72 2054 7275 6520 6966 0a20 2020 2020  or True if.     
+0001e200: 2020 2020 2020 2070 6172 616d 6574 6572         parameter
+0001e210: 202a 2a73 696c 656e 742a 2a20 7761 7320   **silent** was 
+0001e220: 7365 7420 746f 2054 7275 652e 0a20 2020  set to True..   
+0001e230: 2020 2020 203a 7274 7970 653a 2062 6f6f       :rtype: boo
+0001e240: 6c20 7c20 6469 6374 0a20 2020 2020 2020  l | dict.       
+0001e250: 203a 7261 6973 6520 6172 616e 676f 2e65   :raise arango.e
+0001e260: 7863 6570 7469 6f6e 732e 446f 6375 6d65  xceptions.Docume
+0001e270: 6e74 5265 706c 6163 6545 7272 6f72 3a20  ntReplaceError: 
+0001e280: 4966 2072 6570 6c61 6365 2066 6169 6c73  If replace fails
+0001e290: 2e0a 2020 2020 2020 2020 3a72 6169 7365  ..        :raise
+0001e2a0: 2061 7261 6e67 6f2e 6578 6365 7074 696f   arango.exceptio
+0001e2b0: 6e73 2e44 6f63 756d 656e 7452 6576 6973  ns.DocumentRevis
+0001e2c0: 696f 6e45 7272 6f72 3a20 4966 2072 6576  ionError: If rev
+0001e2d0: 6973 696f 6e73 206d 6973 6d61 7463 682e  isions mismatch.
+0001e2e0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001e2f0: 2020 2020 2076 6572 7465 785f 6964 2c20       vertex_id, 
+0001e300: 6865 6164 6572 7320 3d20 7365 6c66 2e5f  headers = self._
+0001e310: 7072 6570 5f66 726f 6d5f 626f 6479 2876  prep_from_body(v
+0001e320: 6572 7465 782c 2063 6865 636b 5f72 6576  ertex, check_rev
+0001e330: 290a 0a20 2020 2020 2020 2070 6172 616d  )..        param
+0001e340: 733a 2050 6172 616d 7320 3d20 7b0a 2020  s: Params = {.  
+0001e350: 2020 2020 2020 2020 2020 2273 696c 656e            "silen
+0001e360: 7422 3a20 7369 6c65 6e74 2c0a 2020 2020  t": silent,.    
+0001e370: 2020 2020 2020 2020 2272 6574 7572 6e4e          "returnN
+0001e380: 6577 223a 2072 6574 7572 6e5f 6e65 772c  ew": return_new,
+0001e390: 0a20 2020 2020 2020 2020 2020 2022 7265  .            "re
+0001e3a0: 7475 726e 4f6c 6422 3a20 7265 7475 726e  turnOld": return
+0001e3b0: 5f6f 6c64 2c0a 2020 2020 2020 2020 7d0a  _old,.        }.
+0001e3c0: 2020 2020 2020 2020 6966 2073 796e 6320          if sync 
+0001e3d0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0001e3e0: 2020 2020 2020 2020 2070 6172 616d 735b           params[
+0001e3f0: 2277 6169 7446 6f72 5379 6e63 225d 203d  "waitForSync"] =
+0001e400: 2073 796e 630a 0a20 2020 2020 2020 2072   sync..        r
+0001e410: 6571 7565 7374 203d 2052 6571 7565 7374  equest = Request
+0001e420: 280a 2020 2020 2020 2020 2020 2020 6d65  (.            me
+0001e430: 7468 6f64 3d22 7075 7422 2c0a 2020 2020  thod="put",.    
+0001e440: 2020 2020 2020 2020 656e 6470 6f69 6e74          endpoint
+0001e450: 3d66 222f 5f61 7069 2f67 6861 7269 616c  =f"/_api/gharial
+0001e460: 2f7b 7365 6c66 2e5f 6772 6170 687d 2f76  /{self._graph}/v
+0001e470: 6572 7465 782f 7b76 6572 7465 785f 6964  ertex/{vertex_id
+0001e480: 7d22 2c0a 2020 2020 2020 2020 2020 2020  }",.            
+0001e490: 6865 6164 6572 733d 6865 6164 6572 732c  headers=headers,
+0001e4a0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
+0001e4b0: 616d 733d 7061 7261 6d73 2c0a 2020 2020  ams=params,.    
+0001e4c0: 2020 2020 2020 2020 6461 7461 3d76 6572          data=ver
+0001e4d0: 7465 782c 0a20 2020 2020 2020 2020 2020  tex,.           
+0001e4e0: 2077 7269 7465 3d73 656c 662e 6e61 6d65   write=self.name
+0001e4f0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+0001e500: 2020 2020 2064 6566 2072 6573 706f 6e73       def respons
+0001e510: 655f 6861 6e64 6c65 7228 7265 7370 3a20  e_handler(resp: 
+0001e520: 5265 7370 6f6e 7365 2920 2d3e 2055 6e69  Response) -> Uni
+0001e530: 6f6e 5b62 6f6f 6c2c 204a 736f 6e5d 3a0a  on[bool, Json]:.
+0001e540: 2020 2020 2020 2020 2020 2020 6966 2072              if r
+0001e550: 6573 702e 7374 6174 7573 5f63 6f64 6520  esp.status_code 
+0001e560: 3d3d 2034 3132 3a20 2023 2070 7261 676d  == 412:  # pragm
+0001e570: 613a 206e 6f20 636f 7665 720a 2020 2020  a: no cover.    
+0001e580: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0001e590: 6520 446f 6375 6d65 6e74 5265 7669 7369  e DocumentRevisi
+0001e5a0: 6f6e 4572 726f 7228 7265 7370 2c20 7265  onError(resp, re
+0001e5b0: 7175 6573 7429 0a20 2020 2020 2020 2020  quest).         
+0001e5c0: 2020 2065 6c69 6620 6e6f 7420 7265 7370     elif not resp
+0001e5d0: 2e69 735f 7375 6363 6573 733a 0a20 2020  .is_success:.   
+0001e5e0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0001e5f0: 7365 2044 6f63 756d 656e 7452 6570 6c61  se DocumentRepla
+0001e600: 6365 4572 726f 7228 7265 7370 2c20 7265  ceError(resp, re
+0001e610: 7175 6573 7429 0a20 2020 2020 2020 2020  quest).         
+0001e620: 2020 2069 6620 7369 6c65 6e74 2069 7320     if silent is 
+0001e630: 5472 7565 3a0a 2020 2020 2020 2020 2020  True:.          
+0001e640: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
+0001e650: 650a 2020 2020 2020 2020 2020 2020 7265  e.            re
+0001e660: 7475 726e 2066 6f72 6d61 745f 7665 7274  turn format_vert
+0001e670: 6578 2872 6573 702e 626f 6479 290a 0a20  ex(resp.body).. 
+0001e680: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0001e690: 6c66 2e5f 6578 6563 7574 6528 7265 7175  lf._execute(requ
+0001e6a0: 6573 742c 2072 6573 706f 6e73 655f 6861  est, response_ha
+0001e6b0: 6e64 6c65 7229 0a0a 2020 2020 6465 6620  ndler)..    def 
+0001e6c0: 6465 6c65 7465 280a 2020 2020 2020 2020  delete(.        
+0001e6d0: 7365 6c66 2c0a 2020 2020 2020 2020 7665  self,.        ve
+0001e6e0: 7274 6578 3a20 556e 696f 6e5b 7374 722c  rtex: Union[str,
+0001e6f0: 204a 736f 6e5d 2c0a 2020 2020 2020 2020   Json],.        
+0001e700: 7265 763a 204f 7074 696f 6e61 6c5b 7374  rev: Optional[st
+0001e710: 725d 203d 204e 6f6e 652c 0a20 2020 2020  r] = None,.     
+0001e720: 2020 2063 6865 636b 5f72 6576 3a20 626f     check_rev: bo
+0001e730: 6f6c 203d 2054 7275 652c 0a20 2020 2020  ol = True,.     
+0001e740: 2020 2069 676e 6f72 655f 6d69 7373 696e     ignore_missin
+0001e750: 673a 2062 6f6f 6c20 3d20 4661 6c73 652c  g: bool = False,
+0001e760: 0a20 2020 2020 2020 2073 796e 633a 204f  .        sync: O
+0001e770: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
+0001e780: 4e6f 6e65 2c0a 2020 2020 2020 2020 7265  None,.        re
+0001e790: 7475 726e 5f6f 6c64 3a20 626f 6f6c 203d  turn_old: bool =
+0001e7a0: 2046 616c 7365 2c0a 2020 2020 2920 2d3e   False,.    ) ->
+0001e7b0: 2052 6573 756c 745b 556e 696f 6e5b 626f   Result[Union[bo
+0001e7c0: 6f6c 2c20 4a73 6f6e 5d5d 3a0a 2020 2020  ol, Json]]:.    
+0001e7d0: 2020 2020 2222 2244 656c 6574 6520 6120      """Delete a 
+0001e7e0: 7665 7274 6578 2064 6f63 756d 656e 742e  vertex document.
+0001e7f0: 2041 6c6c 2063 6f6e 6e65 6374 6564 2065   All connected e
+0001e800: 6467 6573 2061 7265 2061 6c73 6f20 6465  dges are also de
+0001e810: 6c65 7465 642e 0a0a 2020 2020 2020 2020  leted...        
+0001e820: 3a70 6172 616d 2076 6572 7465 783a 2056  :param vertex: V
+0001e830: 6572 7465 7820 646f 6375 6d65 6e74 2049  ertex document I
+0001e840: 442c 206b 6579 206f 7220 626f 6479 2e20  D, key or body. 
+0001e850: 446f 6375 6d65 6e74 2062 6f64 7920 6d75  Document body mu
+0001e860: 7374 0a20 2020 2020 2020 2020 2020 2063  st.            c
+0001e870: 6f6e 7461 696e 2074 6865 2022 5f69 6422  ontain the "_id"
+0001e880: 206f 7220 225f 6b65 7922 2066 6965 6c64   or "_key" field
+0001e890: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
+0001e8a0: 7665 7274 6578 3a20 7374 7220 7c20 6469  vertex: str | di
+0001e8b0: 6374 0a20 2020 2020 2020 203a 7061 7261  ct.        :para
+0001e8c0: 6d20 7265 763a 2045 7870 6563 7465 6420  m rev: Expected 
+0001e8d0: 646f 6375 6d65 6e74 2072 6576 6973 696f  document revisio
+0001e8e0: 6e2e 204f 7665 7272 6964 6573 2074 6865  n. Overrides the
+0001e8f0: 2076 616c 7565 206f 6620 225f 7265 7622   value of "_rev"
+0001e900: 0a20 2020 2020 2020 2020 2020 2066 6965  .            fie
+0001e910: 6c64 2069 6e20 2a2a 7665 7274 6578 2a2a  ld in **vertex**
+0001e920: 2069 6620 7072 6573 656e 742e 0a20 2020   if present..   
+0001e930: 2020 2020 203a 7479 7065 2072 6576 3a20       :type rev: 
+0001e940: 7374 7220 7c20 4e6f 6e65 0a20 2020 2020  str | None.     
+0001e950: 2020 203a 7061 7261 6d20 6368 6563 6b5f     :param check_
+0001e960: 7265 763a 2049 6620 7365 7420 746f 2054  rev: If set to T
+0001e970: 7275 652c 2072 6576 6973 696f 6e20 6f66  rue, revision of
+0001e980: 202a 2a76 6572 7465 782a 2a20 2869 6620   **vertex** (if 
+0001e990: 6769 7665 6e29 2069 730a 2020 2020 2020  given) is.      
+0001e9a0: 2020 2020 2020 636f 6d70 6172 6564 2061        compared a
+0001e9b0: 6761 696e 7374 2074 6865 2072 6576 6973  gainst the revis
+0001e9c0: 696f 6e20 6f66 2074 6172 6765 7420 7665  ion of target ve
+0001e9d0: 7274 6578 2064 6f63 756d 656e 742e 0a20  rtex document.. 
+0001e9e0: 2020 2020 2020 203a 7479 7065 2063 6865         :type che
+0001e9f0: 636b 5f72 6576 3a20 626f 6f6c 0a20 2020  ck_rev: bool.   
+0001ea00: 2020 2020 203a 7061 7261 6d20 6967 6e6f       :param igno
+0001ea10: 7265 5f6d 6973 7369 6e67 3a20 446f 206e  re_missing: Do n
+0001ea20: 6f74 2072 6169 7365 2061 6e20 6578 6365  ot raise an exce
+0001ea30: 7074 696f 6e20 6f6e 206d 6973 7369 6e67  ption on missing
+0001ea40: 2064 6f63 756d 656e 742e 0a20 2020 2020   document..     
+0001ea50: 2020 2020 2020 2054 6869 7320 7061 7261         This para
+0001ea60: 6d65 7465 7220 6861 7320 6e6f 2065 6666  meter has no eff
+0001ea70: 6563 7420 696e 2074 7261 6e73 6163 7469  ect in transacti
+0001ea80: 6f6e 7320 7768 6572 6520 616e 2065 7863  ons where an exc
+0001ea90: 6570 7469 6f6e 2069 730a 2020 2020 2020  eption is.      
+0001eaa0: 2020 2020 2020 616c 7761 7973 2072 6169        always rai
+0001eab0: 7365 6420 6f6e 2066 6169 6c75 7265 732e  sed on failures.
+0001eac0: 0a20 2020 2020 2020 203a 7479 7065 2069  .        :type i
+0001ead0: 676e 6f72 655f 6d69 7373 696e 673a 2062  gnore_missing: b
+0001eae0: 6f6f 6c0a 2020 2020 2020 2020 3a70 6172  ool.        :par
+0001eaf0: 616d 2073 796e 633a 2042 6c6f 636b 2075  am sync: Block u
+0001eb00: 6e74 696c 206f 7065 7261 7469 6f6e 2069  ntil operation i
+0001eb10: 7320 7379 6e63 6872 6f6e 697a 6564 2074  s synchronized t
+0001eb20: 6f20 6469 736b 2e0a 2020 2020 2020 2020  o disk..        
+0001eb30: 3a74 7970 6520 7379 6e63 3a20 626f 6f6c  :type sync: bool
+0001eb40: 207c 204e 6f6e 650a 2020 2020 2020 2020   | None.        
+0001eb50: 3a70 6172 616d 2072 6574 7572 6e5f 6f6c  :param return_ol
+0001eb60: 643a 2052 6574 7572 6e20 626f 6479 206f  d: Return body o
+0001eb70: 6620 7468 6520 6f6c 6420 646f 6375 6d65  f the old docume
+0001eb80: 6e74 2069 6e20 7468 6520 7265 7375 6c74  nt in the result
+0001eb90: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
+0001eba0: 7265 7475 726e 5f6f 6c64 3a20 626f 6f6c  return_old: bool
+0001ebb0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+0001ebc0: 3a20 5472 7565 2069 6620 7665 7274 6578  : True if vertex
+0001ebd0: 2077 6173 2064 656c 6574 6564 2073 7563   was deleted suc
+0001ebe0: 6365 7373 6675 6c6c 792c 2046 616c 7365  cessfully, False
+0001ebf0: 2069 6620 7665 7274 6578 2077 6173 0a20   if vertex was. 
+0001ec00: 2020 2020 2020 2020 2020 206e 6f74 2066             not f
+0001ec10: 6f75 6e64 2061 6e64 202a 2a69 676e 6f72  ound and **ignor
+0001ec20: 655f 6d69 7373 696e 672a 2a20 7761 7320  e_missing** was 
+0001ec30: 7365 7420 746f 2054 7275 6520 2864 6f65  set to True (doe
+0001ec40: 7320 6e6f 7420 6170 706c 7920 696e 0a20  s not apply in. 
+0001ec50: 2020 2020 2020 2020 2020 2074 7261 6e73             trans
+0001ec60: 6163 7469 6f6e 7329 2e20 4f6c 6420 646f  actions). Old do
+0001ec70: 6375 6d65 6e74 2069 7320 7265 7475 726e  cument is return
+0001ec80: 6564 2069 6620 2a2a 7265 7475 726e 5f6f  ed if **return_o
+0001ec90: 6c64 2a2a 2069 7320 7365 7420 746f 0a20  ld** is set to. 
+0001eca0: 2020 2020 2020 2020 2020 2054 7275 652e             True.
+0001ecb0: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
+0001ecc0: 2062 6f6f 6c20 7c20 6469 6374 0a20 2020   bool | dict.   
+0001ecd0: 2020 2020 203a 7261 6973 6520 6172 616e       :raise aran
+0001ece0: 676f 2e65 7863 6570 7469 6f6e 732e 446f  go.exceptions.Do
+0001ecf0: 6375 6d65 6e74 4465 6c65 7465 4572 726f  cumentDeleteErro
+0001ed00: 723a 2049 6620 6465 6c65 7465 2066 6169  r: If delete fai
+0001ed10: 6c73 2e0a 2020 2020 2020 2020 3a72 6169  ls..        :rai
+0001ed20: 7365 2061 7261 6e67 6f2e 6578 6365 7074  se arango.except
+0001ed30: 696f 6e73 2e44 6f63 756d 656e 7452 6576  ions.DocumentRev
+0001ed40: 6973 696f 6e45 7272 6f72 3a20 4966 2072  isionError: If r
+0001ed50: 6576 6973 696f 6e73 206d 6973 6d61 7463  evisions mismatc
+0001ed60: 682e 0a20 2020 2020 2020 2022 2222 0a20  h..        """. 
+0001ed70: 2020 2020 2020 2068 616e 646c 652c 205f         handle, _
+0001ed80: 2c20 6865 6164 6572 7320 3d20 7365 6c66  , headers = self
+0001ed90: 2e5f 7072 6570 5f66 726f 6d5f 646f 6328  ._prep_from_doc(
+0001eda0: 7665 7274 6578 2c20 7265 762c 2063 6865  vertex, rev, che
+0001edb0: 636b 5f72 6576 290a 0a20 2020 2020 2020  ck_rev)..       
+0001edc0: 2070 6172 616d 733a 2050 6172 616d 7320   params: Params 
+0001edd0: 3d20 7b22 7265 7475 726e 4f6c 6422 3a20  = {"returnOld": 
+0001ede0: 7265 7475 726e 5f6f 6c64 7d0a 2020 2020  return_old}.    
+0001edf0: 2020 2020 6966 2073 796e 6320 6973 206e      if sync is n
+0001ee00: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+0001ee10: 2020 2020 2070 6172 616d 735b 2277 6169       params["wai
+0001ee20: 7446 6f72 5379 6e63 225d 203d 2073 796e  tForSync"] = syn
+0001ee30: 630a 0a20 2020 2020 2020 2072 6571 7565  c..        reque
+0001ee40: 7374 203d 2052 6571 7565 7374 280a 2020  st = Request(.  
+0001ee50: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+0001ee60: 3d22 6465 6c65 7465 222c 0a20 2020 2020  ="delete",.     
+0001ee70: 2020 2020 2020 2065 6e64 706f 696e 743d         endpoint=
+0001ee80: 6622 2f5f 6170 692f 6768 6172 6961 6c2f  f"/_api/gharial/
+0001ee90: 7b73 656c 662e 5f67 7261 7068 7d2f 7665  {self._graph}/ve
+0001eea0: 7274 6578 2f7b 6861 6e64 6c65 7d22 2c0a  rtex/{handle}",.
+0001eeb0: 2020 2020 2020 2020 2020 2020 7061 7261              para
+0001eec0: 6d73 3d70 6172 616d 732c 0a20 2020 2020  ms=params,.     
+0001eed0: 2020 2020 2020 2068 6561 6465 7273 3d68         headers=h
+0001eee0: 6561 6465 7273 2c0a 2020 2020 2020 2020  eaders,.        
+0001eef0: 2020 2020 7772 6974 653d 7365 6c66 2e6e      write=self.n
+0001ef00: 616d 652c 0a20 2020 2020 2020 2029 0a0a  ame,.        )..
+0001ef10: 2020 2020 2020 2020 6465 6620 7265 7370          def resp
+0001ef20: 6f6e 7365 5f68 616e 646c 6572 2872 6573  onse_handler(res
+0001ef30: 703a 2052 6573 706f 6e73 6529 202d 3e20  p: Response) -> 
+0001ef40: 556e 696f 6e5b 626f 6f6c 2c20 4a73 6f6e  Union[bool, Json
+0001ef50: 5d3a 0a20 2020 2020 2020 2020 2020 2069  ]:.            i
+0001ef60: 6620 7265 7370 2e65 7272 6f72 5f63 6f64  f resp.error_cod
+0001ef70: 6520 3d3d 2031 3230 3220 616e 6420 6967  e == 1202 and ig
+0001ef80: 6e6f 7265 5f6d 6973 7369 6e67 3a0a 2020  nore_missing:.  
+0001ef90: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0001efa0: 7475 726e 2046 616c 7365 0a20 2020 2020  turn False.     
+0001efb0: 2020 2020 2020 2069 6620 7265 7370 2e73         if resp.s
+0001efc0: 7461 7475 735f 636f 6465 203d 3d20 3431  tatus_code == 41
+0001efd0: 323a 2020 2320 7072 6167 6d61 3a20 6e6f  2:  # pragma: no
+0001efe0: 2063 6f76 6572 0a20 2020 2020 2020 2020   cover.         
+0001eff0: 2020 2020 2020 2072 6169 7365 2044 6f63         raise Doc
+0001f000: 756d 656e 7452 6576 6973 696f 6e45 7272  umentRevisionErr
+0001f010: 6f72 2872 6573 702c 2072 6571 7565 7374  or(resp, request
+0001f020: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+0001f030: 206e 6f74 2072 6573 702e 6973 5f73 7563   not resp.is_suc
+0001f040: 6365 7373 3a0a 2020 2020 2020 2020 2020  cess:.          
+0001f050: 2020 2020 2020 7261 6973 6520 446f 6375        raise Docu
+0001f060: 6d65 6e74 4465 6c65 7465 4572 726f 7228  mentDeleteError(
+0001f070: 7265 7370 2c20 7265 7175 6573 7429 0a0a  resp, request)..
+0001f080: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+0001f090: 6c74 3a20 4a73 6f6e 203d 2072 6573 702e  lt: Json = resp.
+0001f0a0: 626f 6479 0a20 2020 2020 2020 2020 2020  body.           
+0001f0b0: 2072 6574 7572 6e20 7b22 6f6c 6422 3a20   return {"old": 
+0001f0c0: 7265 7375 6c74 5b22 6f6c 6422 5d7d 2069  result["old"]} i
+0001f0d0: 6620 7265 7475 726e 5f6f 6c64 2065 6c73  f return_old els
+0001f0e0: 6520 5472 7565 0a0a 2020 2020 2020 2020  e True..        
+0001f0f0: 7265 7475 726e 2073 656c 662e 5f65 7865  return self._exe
+0001f100: 6375 7465 2872 6571 7565 7374 2c20 7265  cute(request, re
+0001f110: 7370 6f6e 7365 5f68 616e 646c 6572 290a  sponse_handler).
+0001f120: 0a0a 636c 6173 7320 4564 6765 436f 6c6c  ..class EdgeColl
+0001f130: 6563 7469 6f6e 2843 6f6c 6c65 6374 696f  ection(Collectio
+0001f140: 6e29 3a0a 2020 2020 2222 2241 7261 6e67  n):.    """Arang
+0001f150: 6f44 4220 6564 6765 2063 6f6c 6c65 6374  oDB edge collect
+0001f160: 696f 6e20 4150 4920 7772 6170 7065 722e  ion API wrapper.
+0001f170: 0a0a 2020 2020 3a70 6172 616d 2063 6f6e  ..    :param con
+0001f180: 6e65 6374 696f 6e3a 2048 5454 5020 636f  nection: HTTP co
+0001f190: 6e6e 6563 7469 6f6e 2e0a 2020 2020 3a70  nnection..    :p
+0001f1a0: 6172 616d 2065 7865 6375 746f 723a 2041  aram executor: A
+0001f1b0: 5049 2065 7865 6375 746f 722e 0a20 2020  PI executor..   
+0001f1c0: 203a 7061 7261 6d20 6772 6170 683a 2047   :param graph: G
+0001f1d0: 7261 7068 206e 616d 652e 0a20 2020 203a  raph name..    :
+0001f1e0: 7061 7261 6d20 6e61 6d65 3a20 4564 6765  param name: Edge
+0001f1f0: 2063 6f6c 6c65 6374 696f 6e20 6e61 6d65   collection name
+0001f200: 2e0a 2020 2020 2222 220a 0a20 2020 2064  ..    """..    d
+0001f210: 6566 205f 5f69 6e69 745f 5f28 0a20 2020  ef __init__(.   
+0001f220: 2020 2020 2073 656c 662c 2063 6f6e 6e65       self, conne
+0001f230: 6374 696f 6e3a 2043 6f6e 6e65 6374 696f  ction: Connectio
+0001f240: 6e2c 2065 7865 6375 746f 723a 2041 7069  n, executor: Api
+0001f250: 4578 6563 7574 6f72 2c20 6772 6170 683a  Executor, graph:
+0001f260: 2073 7472 2c20 6e61 6d65 3a20 7374 720a   str, name: str.
+0001f270: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+0001f280: 2020 2020 2020 2073 7570 6572 2829 2e5f         super()._
+0001f290: 5f69 6e69 745f 5f28 636f 6e6e 6563 7469  _init__(connecti
+0001f2a0: 6f6e 2c20 6578 6563 7574 6f72 2c20 6e61  on, executor, na
+0001f2b0: 6d65 290a 2020 2020 2020 2020 7365 6c66  me).        self
+0001f2c0: 2e5f 6772 6170 6820 3d20 6772 6170 680a  ._graph = graph.
+0001f2d0: 0a20 2020 2064 6566 205f 5f72 6570 725f  .    def __repr_
+0001f2e0: 5f28 7365 6c66 2920 2d3e 2073 7472 3a0a  _(self) -> str:.
+0001f2f0: 2020 2020 2020 2020 7265 7475 726e 2066          return f
+0001f300: 223c 4564 6765 436f 6c6c 6563 7469 6f6e  "<EdgeCollection
+0001f310: 207b 7365 6c66 2e6e 616d 657d 3e22 0a0a   {self.name}>"..
+0001f320: 2020 2020 6465 6620 5f5f 6765 7469 7465      def __getite
+0001f330: 6d5f 5f28 7365 6c66 2c20 6b65 793a 2055  m__(self, key: U
+0001f340: 6e69 6f6e 5b73 7472 2c20 4a73 6f6e 5d29  nion[str, Json])
+0001f350: 202d 3e20 5265 7375 6c74 5b4f 7074 696f   -> Result[Optio
+0001f360: 6e61 6c5b 4a73 6f6e 5d5d 3a0a 2020 2020  nal[Json]]:.    
+0001f370: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0001f380: 6765 7428 6b65 7929 0a0a 2020 2020 4070  get(key)..    @p
+0001f390: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+0001f3a0: 6772 6170 6828 7365 6c66 2920 2d3e 2073  graph(self) -> s
+0001f3b0: 7472 3a0a 2020 2020 2020 2020 2222 2252  tr:.        """R
+0001f3c0: 6574 7572 6e20 7468 6520 6772 6170 6820  eturn the graph 
+0001f3d0: 6e61 6d65 2e0a 0a20 2020 2020 2020 203a  name...        :
+0001f3e0: 7265 7475 726e 3a20 4772 6170 6820 6e61  return: Graph na
+0001f3f0: 6d65 2e0a 2020 2020 2020 2020 3a72 7479  me..        :rty
+0001f400: 7065 3a20 7374 720a 2020 2020 2020 2020  pe: str.        
+0001f410: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+0001f420: 726e 2073 656c 662e 5f67 7261 7068 0a0a  rn self._graph..
+0001f430: 2020 2020 6465 6620 6765 7428 0a20 2020      def get(.   
+0001f440: 2020 2020 2073 656c 662c 2065 6467 653a       self, edge:
+0001f450: 2055 6e69 6f6e 5b73 7472 2c20 4a73 6f6e   Union[str, Json
+0001f460: 5d2c 2072 6576 3a20 4f70 7469 6f6e 616c  ], rev: Optional
+0001f470: 5b73 7472 5d20 3d20 4e6f 6e65 2c20 6368  [str] = None, ch
+0001f480: 6563 6b5f 7265 763a 2062 6f6f 6c20 3d20  eck_rev: bool = 
+0001f490: 5472 7565 0a20 2020 2029 202d 3e20 5265  True.    ) -> Re
+0001f4a0: 7375 6c74 5b4f 7074 696f 6e61 6c5b 4a73  sult[Optional[Js
+0001f4b0: 6f6e 5d5d 3a0a 2020 2020 2020 2020 2222  on]]:.        ""
+0001f4c0: 2252 6574 7572 6e20 616e 2065 6467 6520  "Return an edge 
+0001f4d0: 646f 6375 6d65 6e74 2e0a 0a20 2020 2020  document...     
+0001f4e0: 2020 203a 7061 7261 6d20 6564 6765 3a20     :param edge: 
+0001f4f0: 4564 6765 2064 6f63 756d 656e 7420 4944  Edge document ID
+0001f500: 2c20 6b65 7920 6f72 2062 6f64 792e 2044  , key or body. D
+0001f510: 6f63 756d 656e 7420 626f 6479 206d 7573  ocument body mus
+0001f520: 7420 636f 6e74 6169 6e0a 2020 2020 2020  t contain.      
+0001f530: 2020 2020 2020 7468 6520 225f 6964 2220        the "_id" 
+0001f540: 6f72 2022 5f6b 6579 2220 6669 656c 642e  or "_key" field.
+0001f550: 0a20 2020 2020 2020 203a 7479 7065 2065  .        :type e
+0001f560: 6467 653a 2073 7472 207c 2064 6963 740a  dge: str | dict.
+0001f570: 2020 2020 2020 2020 3a70 6172 616d 2072          :param r
+0001f580: 6576 3a20 4578 7065 6374 6564 2064 6f63  ev: Expected doc
+0001f590: 756d 656e 7420 7265 7669 7369 6f6e 2e20  ument revision. 
+0001f5a0: 4f76 6572 7269 6465 7320 7468 6520 7661  Overrides the va
+0001f5b0: 6c75 6520 6f66 2022 5f72 6576 220a 2020  lue of "_rev".  
+0001f5c0: 2020 2020 2020 2020 2020 6669 656c 6420            field 
+0001f5d0: 696e 202a 2a65 6467 652a 2a20 6966 2070  in **edge** if p
+0001f5e0: 7265 7365 6e74 2e0a 2020 2020 2020 2020  resent..        
+0001f5f0: 3a74 7970 6520 7265 763a 2073 7472 207c  :type rev: str |
+0001f600: 204e 6f6e 650a 2020 2020 2020 2020 3a70   None.        :p
+0001f610: 6172 616d 2063 6865 636b 5f72 6576 3a20  aram check_rev: 
+0001f620: 4966 2073 6574 2074 6f20 5472 7565 2c20  If set to True, 
+0001f630: 7265 7669 7369 6f6e 206f 6620 2a2a 6564  revision of **ed
+0001f640: 6765 2a2a 2028 6966 2067 6976 656e 2920  ge** (if given) 
+0001f650: 6973 0a20 2020 2020 2020 2020 2020 2063  is.            c
+0001f660: 6f6d 7061 7265 6420 6167 6169 6e73 7420  ompared against 
+0001f670: 7468 6520 7265 7669 7369 6f6e 206f 6620  the revision of 
+0001f680: 7461 7267 6574 2065 6467 6520 646f 6375  target edge docu
+0001f690: 6d65 6e74 2e0a 2020 2020 2020 2020 3a74  ment..        :t
+0001f6a0: 7970 6520 6368 6563 6b5f 7265 763a 2062  ype check_rev: b
+0001f6b0: 6f6f 6c0a 2020 2020 2020 2020 3a72 6574  ool.        :ret
+0001f6c0: 7572 6e3a 2045 6467 6520 646f 6375 6d65  urn: Edge docume
+0001f6d0: 6e74 206f 7220 4e6f 6e65 2069 6620 6e6f  nt or None if no
+0001f6e0: 7420 666f 756e 642e 0a20 2020 2020 2020  t found..       
+0001f6f0: 203a 7274 7970 653a 2064 6963 7420 7c20   :rtype: dict | 
+0001f700: 4e6f 6e65 0a20 2020 2020 2020 203a 7261  None.        :ra
+0001f710: 6973 6520 6172 616e 676f 2e65 7863 6570  ise arango.excep
+0001f720: 7469 6f6e 732e 446f 6375 6d65 6e74 4765  tions.DocumentGe
+0001f730: 7445 7272 6f72 3a20 4966 2072 6574 7269  tError: If retri
+0001f740: 6576 616c 2066 6169 6c73 2e0a 2020 2020  eval fails..    
+0001f750: 2020 2020 3a72 6169 7365 2061 7261 6e67      :raise arang
+0001f760: 6f2e 6578 6365 7074 696f 6e73 2e44 6f63  o.exceptions.Doc
+0001f770: 756d 656e 7452 6576 6973 696f 6e45 7272  umentRevisionErr
+0001f780: 6f72 3a20 4966 2072 6576 6973 696f 6e73  or: If revisions
+0001f790: 206d 6973 6d61 7463 682e 0a20 2020 2020   mismatch..     
+0001f7a0: 2020 2022 2222 0a20 2020 2020 2020 2068     """.        h
+0001f7b0: 616e 646c 652c 2062 6f64 792c 2068 6561  andle, body, hea
+0001f7c0: 6465 7273 203d 2073 656c 662e 5f70 7265  ders = self._pre
+0001f7d0: 705f 6672 6f6d 5f64 6f63 2865 6467 652c  p_from_doc(edge,
+0001f7e0: 2072 6576 2c20 6368 6563 6b5f 7265 7629   rev, check_rev)
+0001f7f0: 0a0a 2020 2020 2020 2020 7265 7175 6573  ..        reques
+0001f800: 7420 3d20 5265 7175 6573 7428 0a20 2020  t = Request(.   
+0001f810: 2020 2020 2020 2020 206d 6574 686f 643d           method=
+0001f820: 2267 6574 222c 0a20 2020 2020 2020 2020  "get",.         
+0001f830: 2020 2065 6e64 706f 696e 743d 6622 2f5f     endpoint=f"/_
+0001f840: 6170 692f 6768 6172 6961 6c2f 7b73 656c  api/gharial/{sel
+0001f850: 662e 5f67 7261 7068 7d2f 6564 6765 2f7b  f._graph}/edge/{
+0001f860: 6861 6e64 6c65 7d22 2c0a 2020 2020 2020  handle}",.      
+0001f870: 2020 2020 2020 6865 6164 6572 733d 6865        headers=he
+0001f880: 6164 6572 732c 0a20 2020 2020 2020 2020  aders,.         
+0001f890: 2020 2072 6561 643d 7365 6c66 2e6e 616d     read=self.nam
+0001f8a0: 652c 0a20 2020 2020 2020 2029 0a0a 2020  e,.        )..  
+0001f8b0: 2020 2020 2020 6465 6620 7265 7370 6f6e        def respon
+0001f8c0: 7365 5f68 616e 646c 6572 2872 6573 703a  se_handler(resp:
+0001f8d0: 2052 6573 706f 6e73 6529 202d 3e20 4f70   Response) -> Op
+0001f8e0: 7469 6f6e 616c 5b4a 736f 6e5d 3a0a 2020  tional[Json]:.  
+0001f8f0: 2020 2020 2020 2020 2020 6966 2072 6573            if res
+0001f900: 702e 6572 726f 725f 636f 6465 203d 3d20  p.error_code == 
+0001f910: 3132 3032 3a0a 2020 2020 2020 2020 2020  1202:.          
+0001f920: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
+0001f930: 650a 2020 2020 2020 2020 2020 2020 6966  e.            if
+0001f940: 2072 6573 702e 7374 6174 7573 5f63 6f64   resp.status_cod
+0001f950: 6520 3d3d 2034 3132 3a20 2023 2070 7261  e == 412:  # pra
+0001f960: 676d 613a 206e 6f20 636f 7665 720a 2020  gma: no cover.  
+0001f970: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0001f980: 6973 6520 446f 6375 6d65 6e74 5265 7669  ise DocumentRevi
+0001f990: 7369 6f6e 4572 726f 7228 7265 7370 2c20  sionError(resp, 
+0001f9a0: 7265 7175 6573 7429 0a20 2020 2020 2020  request).       
+0001f9b0: 2020 2020 2069 6620 6e6f 7420 7265 7370       if not resp
+0001f9c0: 2e69 735f 7375 6363 6573 733a 0a20 2020  .is_success:.   
+0001f9d0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0001f9e0: 7365 2044 6f63 756d 656e 7447 6574 4572  se DocumentGetEr
+0001f9f0: 726f 7228 7265 7370 2c20 7265 7175 6573  ror(resp, reques
+0001fa00: 7429 0a0a 2020 2020 2020 2020 2020 2020  t)..            
+0001fa10: 7265 7375 6c74 3a20 4a73 6f6e 203d 2072  result: Json = r
+0001fa20: 6573 702e 626f 6479 5b22 6564 6765 225d  esp.body["edge"]
+0001fa30: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0001fa40: 7572 6e20 7265 7375 6c74 0a0a 2020 2020  urn result..    
+0001fa50: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0001fa60: 5f65 7865 6375 7465 2872 6571 7565 7374  _execute(request
+0001fa70: 2c20 7265 7370 6f6e 7365 5f68 616e 646c  , response_handl
+0001fa80: 6572 290a 0a20 2020 2064 6566 2069 6e73  er)..    def ins
+0001fa90: 6572 7428 0a20 2020 2020 2020 2073 656c  ert(.        sel
+0001faa0: 662c 0a20 2020 2020 2020 2065 6467 653a  f,.        edge:
+0001fab0: 204a 736f 6e2c 0a20 2020 2020 2020 2073   Json,.        s
+0001fac0: 796e 633a 204f 7074 696f 6e61 6c5b 626f  ync: Optional[bo
+0001fad0: 6f6c 5d20 3d20 4e6f 6e65 2c0a 2020 2020  ol] = None,.    
+0001fae0: 2020 2020 7369 6c65 6e74 3a20 626f 6f6c      silent: bool
+0001faf0: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
+0001fb00: 2020 7265 7475 726e 5f6e 6577 3a20 626f    return_new: bo
+0001fb10: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
+0001fb20: 2920 2d3e 2052 6573 756c 745b 556e 696f  ) -> Result[Unio
+0001fb30: 6e5b 626f 6f6c 2c20 4a73 6f6e 5d5d 3a0a  n[bool, Json]]:.
+0001fb40: 2020 2020 2020 2020 2222 2249 6e73 6572          """Inser
+0001fb50: 7420 6120 6e65 7720 6564 6765 2064 6f63  t a new edge doc
+0001fb60: 756d 656e 742e 0a0a 2020 2020 2020 2020  ument...        
+0001fb70: 3a70 6172 616d 2065 6467 653a 204e 6577  :param edge: New
+0001fb80: 2065 6467 6520 646f 6375 6d65 6e74 2074   edge document t
+0001fb90: 6f20 696e 7365 7274 2e20 4974 206d 7573  o insert. It mus
+0001fba0: 7420 636f 6e74 6169 6e20 225f 6672 6f6d  t contain "_from
+0001fbb0: 2220 616e 640a 2020 2020 2020 2020 2020  " and.          
+0001fbc0: 2020 225f 746f 2220 6669 656c 6473 2e20    "_to" fields. 
+0001fbd0: 4966 2069 7420 6861 7320 225f 6b65 7922  If it has "_key"
+0001fbe0: 206f 7220 225f 6964 2220 6669 656c 642c   or "_id" field,
+0001fbf0: 2069 7473 2076 616c 7565 2069 7320 7573   its value is us
+0001fc00: 6564 0a20 2020 2020 2020 2020 2020 2061  ed.            a
+0001fc10: 7320 6b65 7920 6f66 2074 6865 206e 6577  s key of the new
+0001fc20: 2065 6467 6520 646f 6375 6d65 6e74 2028   edge document (
+0001fc30: 6f74 6865 7277 6973 6520 6974 2069 7320  otherwise it is 
+0001fc40: 6175 746f 2d67 656e 6572 6174 6564 292e  auto-generated).
+0001fc50: 0a20 2020 2020 2020 2020 2020 2041 6e79  .            Any
+0001fc60: 2022 5f72 6576 2220 6669 656c 6420 6973   "_rev" field is
+0001fc70: 2069 676e 6f72 6564 2e0a 2020 2020 2020   ignored..      
+0001fc80: 2020 3a74 7970 6520 6564 6765 3a20 6469    :type edge: di
+0001fc90: 6374 0a20 2020 2020 2020 203a 7061 7261  ct.        :para
+0001fca0: 6d20 7379 6e63 3a20 426c 6f63 6b20 756e  m sync: Block un
+0001fcb0: 7469 6c20 6f70 6572 6174 696f 6e20 6973  til operation is
+0001fcc0: 2073 796e 6368 726f 6e69 7a65 6420 746f   synchronized to
+0001fcd0: 2064 6973 6b2e 0a20 2020 2020 2020 203a   disk..        :
+0001fce0: 7479 7065 2073 796e 633a 2062 6f6f 6c20  type sync: bool 
+0001fcf0: 7c20 4e6f 6e65 0a20 2020 2020 2020 203a  | None.        :
+0001fd00: 7061 7261 6d20 7369 6c65 6e74 3a20 4966  param silent: If
+0001fd10: 2073 6574 2074 6f20 5472 7565 2c20 6e6f   set to True, no
+0001fd20: 2064 6f63 756d 656e 7420 6d65 7461 6461   document metada
+0001fd30: 7461 2069 7320 7265 7475 726e 6564 2e20  ta is returned. 
+0001fd40: 5468 6973 0a20 2020 2020 2020 2020 2020  This.           
+0001fd50: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
+0001fd60: 7361 7665 2072 6573 6f75 7263 6573 2e0a  save resources..
+0001fd70: 2020 2020 2020 2020 3a74 7970 6520 7369          :type si
+0001fd80: 6c65 6e74 3a20 626f 6f6c 0a20 2020 2020  lent: bool.     
+0001fd90: 2020 203a 7061 7261 6d20 7265 7475 726e     :param return
+0001fda0: 5f6e 6577 3a20 496e 636c 7564 6520 626f  _new: Include bo
+0001fdb0: 6479 206f 6620 7468 6520 6e65 7720 646f  dy of the new do
+0001fdc0: 6375 6d65 6e74 2069 6e20 7468 6520 7265  cument in the re
+0001fdd0: 7475 726e 6564 0a20 2020 2020 2020 2020  turned.         
+0001fde0: 2020 206d 6574 6164 6174 612e 2049 676e     metadata. Ign
+0001fdf0: 6f72 6564 2069 6620 7061 7261 6d65 7465  ored if paramete
+0001fe00: 7220 2a2a 7369 6c65 6e74 2a2a 2069 7320  r **silent** is 
+0001fe10: 7365 7420 746f 2054 7275 652e 0a20 2020  set to True..   
+0001fe20: 2020 2020 203a 7479 7065 2072 6574 7572       :type retur
+0001fe30: 6e5f 6e65 773a 2062 6f6f 6c0a 2020 2020  n_new: bool.    
+0001fe40: 2020 2020 3a72 6574 7572 6e3a 2044 6f63      :return: Doc
+0001fe50: 756d 656e 7420 6d65 7461 6461 7461 2028  ument metadata (
+0001fe60: 652e 672e 2064 6f63 756d 656e 7420 6b65  e.g. document ke
+0001fe70: 792c 2072 6576 6973 696f 6e29 206f 7220  y, revision) or 
+0001fe80: 5472 7565 2069 660a 2020 2020 2020 2020  True if.        
+0001fe90: 2020 2020 7061 7261 6d65 7465 7220 2a2a      parameter **
+0001fea0: 7369 6c65 6e74 2a2a 2077 6173 2073 6574  silent** was set
+0001feb0: 2074 6f20 5472 7565 2e0a 2020 2020 2020   to True..      
+0001fec0: 2020 3a72 7479 7065 3a20 626f 6f6c 207c    :rtype: bool |
+0001fed0: 2064 6963 740a 2020 2020 2020 2020 3a72   dict.        :r
+0001fee0: 6169 7365 2061 7261 6e67 6f2e 6578 6365  aise arango.exce
+0001fef0: 7074 696f 6e73 2e44 6f63 756d 656e 7449  ptions.DocumentI
+0001ff00: 6e73 6572 7445 7272 6f72 3a20 4966 2069  nsertError: If i
+0001ff10: 6e73 6572 7420 6661 696c 732e 0a20 2020  nsert fails..   
+0001ff20: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001ff30: 2065 6467 6520 3d20 7365 6c66 2e5f 656e   edge = self._en
+0001ff40: 7375 7265 5f6b 6579 5f66 726f 6d5f 6964  sure_key_from_id
+0001ff50: 2865 6467 6529 0a0a 2020 2020 2020 2020  (edge)..        
+0001ff60: 7061 7261 6d73 3a20 5061 7261 6d73 203d  params: Params =
+0001ff70: 207b 2273 696c 656e 7422 3a20 7369 6c65   {"silent": sile
+0001ff80: 6e74 2c20 2272 6574 7572 6e4e 6577 223a  nt, "returnNew":
+0001ff90: 2072 6574 7572 6e5f 6e65 777d 0a20 2020   return_new}.   
+0001ffa0: 2020 2020 2069 6620 7379 6e63 2069 7320       if sync is 
+0001ffb0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+0001ffc0: 2020 2020 2020 7061 7261 6d73 5b22 7761        params["wa
+0001ffd0: 6974 466f 7253 796e 6322 5d20 3d20 7379  itForSync"] = sy
+0001ffe0: 6e63 0a0a 2020 2020 2020 2020 7265 7175  nc..        requ
+0001fff0: 6573 7420 3d20 5265 7175 6573 7428 0a20  est = Request(. 
+00020000: 2020 2020 2020 2020 2020 206d 6574 686f             metho
+00020010: 643d 2270 6f73 7422 2c0a 2020 2020 2020  d="post",.      
+00020020: 2020 2020 2020 656e 6470 6f69 6e74 3d66        endpoint=f
+00020030: 222f 5f61 7069 2f67 6861 7269 616c 2f7b  "/_api/gharial/{
+00020040: 7365 6c66 2e5f 6772 6170 687d 2f65 6467  self._graph}/edg
+00020050: 652f 7b73 656c 662e 6e61 6d65 7d22 2c0a  e/{self.name}",.
+00020060: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00020070: 3d65 6467 652c 0a20 2020 2020 2020 2020  =edge,.         
+00020080: 2020 2070 6172 616d 733d 7061 7261 6d73     params=params
+00020090: 2c0a 2020 2020 2020 2020 2020 2020 7772  ,.            wr
+000200a0: 6974 653d 7365 6c66 2e6e 616d 652c 0a20  ite=self.name,. 
+000200b0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+000200c0: 2020 6465 6620 7265 7370 6f6e 7365 5f68    def response_h
+000200d0: 616e 646c 6572 2872 6573 703a 2052 6573  andler(resp: Res
+000200e0: 706f 6e73 6529 202d 3e20 556e 696f 6e5b  ponse) -> Union[
+000200f0: 626f 6f6c 2c20 4a73 6f6e 5d3a 0a20 2020  bool, Json]:.   
+00020100: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+00020110: 7265 7370 2e69 735f 7375 6363 6573 733a  resp.is_success:
+00020120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020130: 2072 6169 7365 2044 6f63 756d 656e 7449   raise DocumentI
+00020140: 6e73 6572 7445 7272 6f72 2872 6573 702c  nsertError(resp,
+00020150: 2072 6571 7565 7374 290a 2020 2020 2020   request).      
+00020160: 2020 2020 2020 6966 2073 696c 656e 743a        if silent:
+00020170: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020180: 2072 6574 7572 6e20 5472 7565 0a20 2020   return True.   
+00020190: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000201a0: 666f 726d 6174 5f65 6467 6528 7265 7370  format_edge(resp
+000201b0: 2e62 6f64 7929 0a0a 2020 2020 2020 2020  .body)..        
+000201c0: 7265 7475 726e 2073 656c 662e 5f65 7865  return self._exe
+000201d0: 6375 7465 2872 6571 7565 7374 2c20 7265  cute(request, re
+000201e0: 7370 6f6e 7365 5f68 616e 646c 6572 290a  sponse_handler).
+000201f0: 0a20 2020 2064 6566 2075 7064 6174 6528  .    def update(
+00020200: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00020210: 2020 2020 2020 2065 6467 653a 204a 736f         edge: Jso
+00020220: 6e2c 0a20 2020 2020 2020 2063 6865 636b  n,.        check
+00020230: 5f72 6576 3a20 626f 6f6c 203d 2054 7275  _rev: bool = Tru
+00020240: 652c 0a20 2020 2020 2020 206b 6565 705f  e,.        keep_
+00020250: 6e6f 6e65 3a20 626f 6f6c 203d 2054 7275  none: bool = Tru
+00020260: 652c 0a20 2020 2020 2020 2073 796e 633a  e,.        sync:
+00020270: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
+00020280: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+00020290: 7369 6c65 6e74 3a20 626f 6f6c 203d 2046  silent: bool = F
+000202a0: 616c 7365 2c0a 2020 2020 2020 2020 7265  alse,.        re
+000202b0: 7475 726e 5f6f 6c64 3a20 626f 6f6c 203d  turn_old: bool =
+000202c0: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
+000202d0: 7265 7475 726e 5f6e 6577 3a20 626f 6f6c  return_new: bool
+000202e0: 203d 2046 616c 7365 2c0a 2020 2020 2920   = False,.    ) 
+000202f0: 2d3e 2052 6573 756c 745b 556e 696f 6e5b  -> Result[Union[
+00020300: 626f 6f6c 2c20 4a73 6f6e 5d5d 3a0a 2020  bool, Json]]:.  
+00020310: 2020 2020 2020 2222 2255 7064 6174 6520        """Update 
+00020320: 616e 2065 6467 6520 646f 6375 6d65 6e74  an edge document
+00020330: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+00020340: 6d20 6564 6765 3a20 5061 7274 6961 6c20  m edge: Partial 
+00020350: 6f72 2066 756c 6c20 6564 6765 2064 6f63  or full edge doc
+00020360: 756d 656e 7420 7769 7468 2075 7064 6174  ument with updat
+00020370: 6564 2076 616c 7565 732e 2049 7420 6d75  ed values. It mu
+00020380: 7374 0a20 2020 2020 2020 2020 2020 2063  st.            c
+00020390: 6f6e 7461 696e 2074 6865 2022 5f6b 6579  ontain the "_key
+000203a0: 2220 6f72 2022 5f69 6422 2066 6965 6c64  " or "_id" field
+000203b0: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
+000203c0: 6564 6765 3a20 6469 6374 0a20 2020 2020  edge: dict.     
+000203d0: 2020 203a 7061 7261 6d20 6368 6563 6b5f     :param check_
+000203e0: 7265 763a 2049 6620 7365 7420 746f 2054  rev: If set to T
+000203f0: 7275 652c 2072 6576 6973 696f 6e20 6f66  rue, revision of
+00020400: 202a 2a65 6467 652a 2a20 2869 6620 6769   **edge** (if gi
+00020410: 7665 6e29 2069 730a 2020 2020 2020 2020  ven) is.        
+00020420: 2020 2020 636f 6d70 6172 6564 2061 6761      compared aga
+00020430: 696e 7374 2074 6865 2072 6576 6973 696f  inst the revisio
+00020440: 6e20 6f66 2074 6172 6765 7420 6564 6765  n of target edge
+00020450: 2064 6f63 756d 656e 742e 0a20 2020 2020   document..     
+00020460: 2020 203a 7479 7065 2063 6865 636b 5f72     :type check_r
+00020470: 6576 3a20 626f 6f6c 0a20 2020 2020 2020  ev: bool.       
+00020480: 203a 7061 7261 6d20 6b65 6570 5f6e 6f6e   :param keep_non
+00020490: 653a 2049 6620 7365 7420 746f 2054 7275  e: If set to Tru
+000204a0: 652c 2066 6965 6c64 7320 7769 7468 2076  e, fields with v
+000204b0: 616c 7565 204e 6f6e 6520 6172 6520 7265  alue None are re
+000204c0: 7461 696e 6564 0a20 2020 2020 2020 2020  tained.         
+000204d0: 2020 2069 6e20 7468 6520 646f 6375 6d65     in the docume
+000204e0: 6e74 2e20 4966 2073 6574 2074 6f20 4661  nt. If set to Fa
+000204f0: 6c73 652c 2074 6865 7920 6172 6520 7265  lse, they are re
+00020500: 6d6f 7665 6420 636f 6d70 6c65 7465 6c79  moved completely
+00020510: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
+00020520: 6b65 6570 5f6e 6f6e 653a 2062 6f6f 6c20  keep_none: bool 
+00020530: 7c20 4e6f 6e65 0a20 2020 2020 2020 203a  | None.        :
+00020540: 7061 7261 6d20 7379 6e63 3a20 426c 6f63  param sync: Bloc
+00020550: 6b20 756e 7469 6c20 6f70 6572 6174 696f  k until operatio
+00020560: 6e20 6973 2073 796e 6368 726f 6e69 7a65  n is synchronize
+00020570: 6420 746f 2064 6973 6b2e 0a20 2020 2020  d to disk..     
+00020580: 2020 203a 7479 7065 2073 796e 633a 2062     :type sync: b
+00020590: 6f6f 6c20 7c20 4e6f 6e65 0a20 2020 2020  ool | None.     
+000205a0: 2020 203a 7061 7261 6d20 7369 6c65 6e74     :param silent
+000205b0: 3a20 4966 2073 6574 2074 6f20 5472 7565  : If set to True
+000205c0: 2c20 6e6f 2064 6f63 756d 656e 7420 6d65  , no document me
+000205d0: 7461 6461 7461 2069 7320 7265 7475 726e  tadata is return
+000205e0: 6564 2e20 5468 6973 0a20 2020 2020 2020  ed. This.       
+000205f0: 2020 2020 2063 616e 2062 6520 7573 6564       can be used
+00020600: 2074 6f20 7361 7665 2072 6573 6f75 7263   to save resourc
+00020610: 6573 2e0a 2020 2020 2020 2020 3a74 7970  es..        :typ
+00020620: 6520 7369 6c65 6e74 3a20 626f 6f6c 0a20  e silent: bool. 
+00020630: 2020 2020 2020 203a 7061 7261 6d20 7265         :param re
+00020640: 7475 726e 5f6f 6c64 3a20 496e 636c 7564  turn_old: Includ
+00020650: 6520 626f 6479 206f 6620 7468 6520 6f6c  e body of the ol
+00020660: 6420 646f 6375 6d65 6e74 2069 6e20 7468  d document in th
+00020670: 6520 7265 7475 726e 6564 0a20 2020 2020  e returned.     
+00020680: 2020 2020 2020 206d 6574 6164 6174 612e         metadata.
+00020690: 2049 676e 6f72 6564 2069 6620 7061 7261   Ignored if para
+000206a0: 6d65 7465 7220 2a2a 7369 6c65 6e74 2a2a  meter **silent**
+000206b0: 2069 7320 7365 7420 746f 2054 7275 652e   is set to True.
+000206c0: 0a20 2020 2020 2020 203a 7479 7065 2072  .        :type r
+000206d0: 6574 7572 6e5f 6f6c 643a 2062 6f6f 6c0a  eturn_old: bool.
+000206e0: 2020 2020 2020 2020 3a70 6172 616d 2072          :param r
+000206f0: 6574 7572 6e5f 6e65 773a 2049 6e63 6c75  eturn_new: Inclu
+00020700: 6465 2062 6f64 7920 6f66 2074 6865 206e  de body of the n
+00020710: 6577 2064 6f63 756d 656e 7420 696e 2074  ew document in t
+00020720: 6865 2072 6574 7572 6e65 640a 2020 2020  he returned.    
+00020730: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
+00020740: 2e20 4967 6e6f 7265 6420 6966 2070 6172  . Ignored if par
+00020750: 616d 6574 6572 202a 2a73 696c 656e 742a  ameter **silent*
+00020760: 2a20 6973 2073 6574 2074 6f20 5472 7565  * is set to True
+00020770: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
+00020780: 7265 7475 726e 5f6e 6577 3a20 626f 6f6c  return_new: bool
+00020790: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+000207a0: 3a20 446f 6375 6d65 6e74 206d 6574 6164  : Document metad
+000207b0: 6174 6120 2865 2e67 2e20 646f 6375 6d65  ata (e.g. docume
+000207c0: 6e74 206b 6579 2c20 7265 7669 7369 6f6e  nt key, revision
+000207d0: 2920 6f72 2054 7275 6520 6966 0a20 2020  ) or True if.   
+000207e0: 2020 2020 2020 2020 2070 6172 616d 6574           paramet
+000207f0: 6572 202a 2a73 696c 656e 742a 2a20 7761  er **silent** wa
+00020800: 7320 7365 7420 746f 2054 7275 652e 0a20  s set to True.. 
+00020810: 2020 2020 2020 203a 7274 7970 653a 2062         :rtype: b
+00020820: 6f6f 6c20 7c20 6469 6374 0a20 2020 2020  ool | dict.     
+00020830: 2020 203a 7261 6973 6520 6172 616e 676f     :raise arango
+00020840: 2e65 7863 6570 7469 6f6e 732e 446f 6375  .exceptions.Docu
+00020850: 6d65 6e74 5570 6461 7465 4572 726f 723a  mentUpdateError:
+00020860: 2049 6620 7570 6461 7465 2066 6169 6c73   If update fails
+00020870: 2e0a 2020 2020 2020 2020 3a72 6169 7365  ..        :raise
+00020880: 2061 7261 6e67 6f2e 6578 6365 7074 696f   arango.exceptio
+00020890: 6e73 2e44 6f63 756d 656e 7452 6576 6973  ns.DocumentRevis
+000208a0: 696f 6e45 7272 6f72 3a20 4966 2072 6576  ionError: If rev
+000208b0: 6973 696f 6e73 206d 6973 6d61 7463 682e  isions mismatch.
+000208c0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000208d0: 2020 2020 2065 6467 655f 6964 2c20 6865       edge_id, he
+000208e0: 6164 6572 7320 3d20 7365 6c66 2e5f 7072  aders = self._pr
+000208f0: 6570 5f66 726f 6d5f 626f 6479 2865 6467  ep_from_body(edg
+00020900: 652c 2063 6865 636b 5f72 6576 290a 0a20  e, check_rev).. 
+00020910: 2020 2020 2020 2070 6172 616d 733a 2050         params: P
+00020920: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
+00020930: 2020 2020 2020 226b 6565 704e 756c 6c22        "keepNull"
+00020940: 3a20 6b65 6570 5f6e 6f6e 652c 0a20 2020  : keep_none,.   
+00020950: 2020 2020 2020 2020 2022 6f76 6572 7772           "overwr
+00020960: 6974 6522 3a20 6e6f 7420 6368 6563 6b5f  ite": not check_
+00020970: 7265 762c 0a20 2020 2020 2020 2020 2020  rev,.           
+00020980: 2022 7369 6c65 6e74 223a 2073 696c 656e   "silent": silen
+00020990: 742c 0a20 2020 2020 2020 2020 2020 2022  t,.            "
+000209a0: 7265 7475 726e 4e65 7722 3a20 7265 7475  returnNew": retu
+000209b0: 726e 5f6e 6577 2c0a 2020 2020 2020 2020  rn_new,.        
+000209c0: 2020 2020 2272 6574 7572 6e4f 6c64 223a      "returnOld":
+000209d0: 2072 6574 7572 6e5f 6f6c 642c 0a20 2020   return_old,.   
+000209e0: 2020 2020 207d 0a20 2020 2020 2020 2069       }.        i
+000209f0: 6620 7379 6e63 2069 7320 6e6f 7420 4e6f  f sync is not No
+00020a00: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00020a10: 7061 7261 6d73 5b22 7761 6974 466f 7253  params["waitForS
+00020a20: 796e 6322 5d20 3d20 7379 6e63 0a0a 2020  ync"] = sync..  
+00020a30: 2020 2020 2020 7265 7175 6573 7420 3d20        request = 
+00020a40: 5265 7175 6573 7428 0a20 2020 2020 2020  Request(.       
+00020a50: 2020 2020 206d 6574 686f 643d 2270 6174       method="pat
+00020a60: 6368 222c 0a20 2020 2020 2020 2020 2020  ch",.           
+00020a70: 2065 6e64 706f 696e 743d 6622 2f5f 6170   endpoint=f"/_ap
+00020a80: 692f 6768 6172 6961 6c2f 7b73 656c 662e  i/gharial/{self.
+00020a90: 5f67 7261 7068 7d2f 6564 6765 2f7b 6564  _graph}/edge/{ed
+00020aa0: 6765 5f69 647d 222c 0a20 2020 2020 2020  ge_id}",.       
+00020ab0: 2020 2020 2068 6561 6465 7273 3d68 6561       headers=hea
+00020ac0: 6465 7273 2c0a 2020 2020 2020 2020 2020  ders,.          
+00020ad0: 2020 7061 7261 6d73 3d70 6172 616d 732c    params=params,
+00020ae0: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
+00020af0: 613d 6564 6765 2c0a 2020 2020 2020 2020  a=edge,.        
+00020b00: 2020 2020 7772 6974 653d 7365 6c66 2e6e      write=self.n
+00020b10: 616d 652c 0a20 2020 2020 2020 2029 0a0a  ame,.        )..
+00020b20: 2020 2020 2020 2020 6465 6620 7265 7370          def resp
+00020b30: 6f6e 7365 5f68 616e 646c 6572 2872 6573  onse_handler(res
+00020b40: 703a 2052 6573 706f 6e73 6529 202d 3e20  p: Response) -> 
+00020b50: 556e 696f 6e5b 626f 6f6c 2c20 4a73 6f6e  Union[bool, Json
+00020b60: 5d3a 0a20 2020 2020 2020 2020 2020 2069  ]:.            i
+00020b70: 6620 7265 7370 2e73 7461 7475 735f 636f  f resp.status_co
+00020b80: 6465 203d 3d20 3431 323a 2020 2320 7072  de == 412:  # pr
+00020b90: 6167 6d61 3a20 6e6f 2063 6f76 6572 0a20  agma: no cover. 
+00020ba0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00020bb0: 6169 7365 2044 6f63 756d 656e 7452 6576  aise DocumentRev
+00020bc0: 6973 696f 6e45 7272 6f72 2872 6573 702c  isionError(resp,
+00020bd0: 2072 6571 7565 7374 290a 2020 2020 2020   request).      
+00020be0: 2020 2020 2020 6966 206e 6f74 2072 6573        if not res
+00020bf0: 702e 6973 5f73 7563 6365 7373 3a0a 2020  p.is_success:.  
+00020c00: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00020c10: 6973 6520 446f 6375 6d65 6e74 5570 6461  ise DocumentUpda
+00020c20: 7465 4572 726f 7228 7265 7370 2c20 7265  teError(resp, re
+00020c30: 7175 6573 7429 0a20 2020 2020 2020 2020  quest).         
+00020c40: 2020 2069 6620 7369 6c65 6e74 2069 7320     if silent is 
+00020c50: 5472 7565 3a0a 2020 2020 2020 2020 2020  True:.          
+00020c60: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
+00020c70: 650a 2020 2020 2020 2020 2020 2020 7265  e.            re
+00020c80: 7475 726e 2066 6f72 6d61 745f 6564 6765  turn format_edge
+00020c90: 2872 6573 702e 626f 6479 290a 0a20 2020  (resp.body)..   
+00020ca0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00020cb0: 2e5f 6578 6563 7574 6528 7265 7175 6573  ._execute(reques
+00020cc0: 742c 2072 6573 706f 6e73 655f 6861 6e64  t, response_hand
+00020cd0: 6c65 7229 0a0a 2020 2020 6465 6620 7265  ler)..    def re
+00020ce0: 706c 6163 6528 0a20 2020 2020 2020 2073  place(.        s
+00020cf0: 656c 662c 0a20 2020 2020 2020 2065 6467  elf,.        edg
+00020d00: 653a 204a 736f 6e2c 0a20 2020 2020 2020  e: Json,.       
+00020d10: 2063 6865 636b 5f72 6576 3a20 626f 6f6c   check_rev: bool
+00020d20: 203d 2054 7275 652c 0a20 2020 2020 2020   = True,.       
+00020d30: 2073 796e 633a 204f 7074 696f 6e61 6c5b   sync: Optional[
+00020d40: 626f 6f6c 5d20 3d20 4e6f 6e65 2c0a 2020  bool] = None,.  
+00020d50: 2020 2020 2020 7369 6c65 6e74 3a20 626f        silent: bo
+00020d60: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
+00020d70: 2020 2020 7265 7475 726e 5f6f 6c64 3a20      return_old: 
+00020d80: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+00020d90: 2020 2020 2020 7265 7475 726e 5f6e 6577        return_new
+00020da0: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
+00020db0: 2020 2020 2920 2d3e 2052 6573 756c 745b      ) -> Result[
+00020dc0: 556e 696f 6e5b 626f 6f6c 2c20 4a73 6f6e  Union[bool, Json
+00020dd0: 5d5d 3a0a 2020 2020 2020 2020 2222 2252  ]]:.        """R
+00020de0: 6570 6c61 6365 2061 6e20 6564 6765 2064  eplace an edge d
+00020df0: 6f63 756d 656e 742e 0a0a 2020 2020 2020  ocument...      
+00020e00: 2020 3a70 6172 616d 2065 6467 653a 204e    :param edge: N
+00020e10: 6577 2065 6467 6520 646f 6375 6d65 6e74  ew edge document
+00020e20: 2074 6f20 7265 706c 6163 6520 7468 6520   to replace the 
+00020e30: 6f6c 6420 6f6e 6520 7769 7468 2e20 4974  old one with. It
+00020e40: 206d 7573 740a 2020 2020 2020 2020 2020   must.          
+00020e50: 2020 636f 6e74 6169 6e20 7468 6520 225f    contain the "_
+00020e60: 6b65 7922 206f 7220 225f 6964 2220 6669  key" or "_id" fi
+00020e70: 656c 642e 2049 7420 6d75 7374 2061 6c73  eld. It must als
+00020e80: 6f20 636f 6e74 6169 6e20 7468 6520 225f  o contain the "_
+00020e90: 6672 6f6d 220a 2020 2020 2020 2020 2020  from".          
+00020ea0: 2020 616e 6420 225f 746f 2220 6669 656c    and "_to" fiel
+00020eb0: 6473 2e0a 2020 2020 2020 2020 3a74 7970  ds..        :typ
+00020ec0: 6520 6564 6765 3a20 6469 6374 0a20 2020  e edge: dict.   
+00020ed0: 2020 2020 203a 7061 7261 6d20 6368 6563       :param chec
+00020ee0: 6b5f 7265 763a 2049 6620 7365 7420 746f  k_rev: If set to
+00020ef0: 2054 7275 652c 2072 6576 6973 696f 6e20   True, revision 
+00020f00: 6f66 202a 2a65 6467 652a 2a20 2869 6620  of **edge** (if 
+00020f10: 6769 7665 6e29 2069 730a 2020 2020 2020  given) is.      
+00020f20: 2020 2020 2020 636f 6d70 6172 6564 2061        compared a
+00020f30: 6761 696e 7374 2074 6865 2072 6576 6973  gainst the revis
+00020f40: 696f 6e20 6f66 2074 6172 6765 7420 6564  ion of target ed
+00020f50: 6765 2064 6f63 756d 656e 742e 0a20 2020  ge document..   
+00020f60: 2020 2020 203a 7479 7065 2063 6865 636b       :type check
+00020f70: 5f72 6576 3a20 626f 6f6c 0a20 2020 2020  _rev: bool.     
+00020f80: 2020 203a 7061 7261 6d20 7379 6e63 3a20     :param sync: 
+00020f90: 426c 6f63 6b20 756e 7469 6c20 6f70 6572  Block until oper
+00020fa0: 6174 696f 6e20 6973 2073 796e 6368 726f  ation is synchro
+00020fb0: 6e69 7a65 6420 746f 2064 6973 6b2e 0a20  nized to disk.. 
+00020fc0: 2020 2020 2020 203a 7479 7065 2073 796e         :type syn
+00020fd0: 633a 2062 6f6f 6c20 7c20 4e6f 6e65 0a20  c: bool | None. 
+00020fe0: 2020 2020 2020 203a 7061 7261 6d20 7369         :param si
+00020ff0: 6c65 6e74 3a20 4966 2073 6574 2074 6f20  lent: If set to 
+00021000: 5472 7565 2c20 6e6f 2064 6f63 756d 656e  True, no documen
+00021010: 7420 6d65 7461 6461 7461 2069 7320 7265  t metadata is re
+00021020: 7475 726e 6564 2e20 5468 6973 0a20 2020  turned. This.   
+00021030: 2020 2020 2020 2020 2063 616e 2062 6520           can be 
+00021040: 7573 6564 2074 6f20 7361 7665 2072 6573  used to save res
+00021050: 6f75 7263 6573 2e0a 2020 2020 2020 2020  ources..        
+00021060: 3a74 7970 6520 7369 6c65 6e74 3a20 626f  :type silent: bo
+00021070: 6f6c 0a20 2020 2020 2020 203a 7061 7261  ol.        :para
+00021080: 6d20 7265 7475 726e 5f6f 6c64 3a20 496e  m return_old: In
+00021090: 636c 7564 6520 626f 6479 206f 6620 7468  clude body of th
+000210a0: 6520 6f6c 6420 646f 6375 6d65 6e74 2069  e old document i
+000210b0: 6e20 7468 6520 7265 7475 726e 6564 0a20  n the returned. 
+000210c0: 2020 2020 2020 2020 2020 206d 6574 6164             metad
+000210d0: 6174 612e 2049 676e 6f72 6564 2069 6620  ata. Ignored if 
+000210e0: 7061 7261 6d65 7465 7220 2a2a 7369 6c65  parameter **sile
+000210f0: 6e74 2a2a 2069 7320 7365 7420 746f 2054  nt** is set to T
+00021100: 7275 652e 0a20 2020 2020 2020 203a 7479  rue..        :ty
+00021110: 7065 2072 6574 7572 6e5f 6f6c 643a 2062  pe return_old: b
+00021120: 6f6f 6c0a 2020 2020 2020 2020 3a70 6172  ool.        :par
+00021130: 616d 2072 6574 7572 6e5f 6e65 773a 2049  am return_new: I
+00021140: 6e63 6c75 6465 2062 6f64 7920 6f66 2074  nclude body of t
+00021150: 6865 206e 6577 2064 6f63 756d 656e 7420  he new document 
+00021160: 696e 2074 6865 2072 6574 7572 6e65 640a  in the returned.
+00021170: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
+00021180: 6461 7461 2e20 4967 6e6f 7265 6420 6966  data. Ignored if
+00021190: 2070 6172 616d 6574 6572 202a 2a73 696c   parameter **sil
+000211a0: 656e 742a 2a20 6973 2073 6574 2074 6f20  ent** is set to 
+000211b0: 5472 7565 2e0a 2020 2020 2020 2020 3a74  True..        :t
+000211c0: 7970 6520 7265 7475 726e 5f6e 6577 3a20  ype return_new: 
+000211d0: 626f 6f6c 0a20 2020 2020 2020 203a 7265  bool.        :re
+000211e0: 7475 726e 3a20 446f 6375 6d65 6e74 206d  turn: Document m
+000211f0: 6574 6164 6174 6120 2865 2e67 2e20 646f  etadata (e.g. do
+00021200: 6375 6d65 6e74 206b 6579 2c20 7265 7669  cument key, revi
+00021210: 7369 6f6e 2920 6f72 2054 7275 6520 6966  sion) or True if
+00021220: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
+00021230: 616d 6574 6572 202a 2a73 696c 656e 742a  ameter **silent*
+00021240: 2a20 7761 7320 7365 7420 746f 2054 7275  * was set to Tru
+00021250: 652e 0a20 2020 2020 2020 203a 7274 7970  e..        :rtyp
+00021260: 653a 2062 6f6f 6c20 7c20 6469 6374 0a20  e: bool | dict. 
+00021270: 2020 2020 2020 203a 7261 6973 6520 6172         :raise ar
+00021280: 616e 676f 2e65 7863 6570 7469 6f6e 732e  ango.exceptions.
+00021290: 446f 6375 6d65 6e74 5265 706c 6163 6545  DocumentReplaceE
+000212a0: 7272 6f72 3a20 4966 2072 6570 6c61 6365  rror: If replace
+000212b0: 2066 6169 6c73 2e0a 2020 2020 2020 2020   fails..        
+000212c0: 3a72 6169 7365 2061 7261 6e67 6f2e 6578  :raise arango.ex
+000212d0: 6365 7074 696f 6e73 2e44 6f63 756d 656e  ceptions.Documen
+000212e0: 7452 6576 6973 696f 6e45 7272 6f72 3a20  tRevisionError: 
+000212f0: 4966 2072 6576 6973 696f 6e73 206d 6973  If revisions mis
+00021300: 6d61 7463 682e 0a20 2020 2020 2020 2022  match..        "
+00021310: 2222 0a20 2020 2020 2020 2065 6467 655f  "".        edge_
+00021320: 6964 2c20 6865 6164 6572 7320 3d20 7365  id, headers = se
+00021330: 6c66 2e5f 7072 6570 5f66 726f 6d5f 626f  lf._prep_from_bo
+00021340: 6479 2865 6467 652c 2063 6865 636b 5f72  dy(edge, check_r
+00021350: 6576 290a 0a20 2020 2020 2020 2070 6172  ev)..        par
+00021360: 616d 733a 2050 6172 616d 7320 3d20 7b0a  ams: Params = {.
+00021370: 2020 2020 2020 2020 2020 2020 2273 696c              "sil
+00021380: 656e 7422 3a20 7369 6c65 6e74 2c0a 2020  ent": silent,.  
+00021390: 2020 2020 2020 2020 2020 2272 6574 7572            "retur
+000213a0: 6e4e 6577 223a 2072 6574 7572 6e5f 6e65  nNew": return_ne
+000213b0: 772c 0a20 2020 2020 2020 2020 2020 2022  w,.            "
+000213c0: 7265 7475 726e 4f6c 6422 3a20 7265 7475  returnOld": retu
+000213d0: 726e 5f6f 6c64 2c0a 2020 2020 2020 2020  rn_old,.        
+000213e0: 7d0a 2020 2020 2020 2020 6966 2073 796e  }.        if syn
+000213f0: 6320 6973 206e 6f74 204e 6f6e 653a 0a20  c is not None:. 
+00021400: 2020 2020 2020 2020 2020 2070 6172 616d             param
+00021410: 735b 2277 6169 7446 6f72 5379 6e63 225d  s["waitForSync"]
+00021420: 203d 2073 796e 630a 0a20 2020 2020 2020   = sync..       
+00021430: 2072 6571 7565 7374 203d 2052 6571 7565   request = Reque
+00021440: 7374 280a 2020 2020 2020 2020 2020 2020  st(.            
+00021450: 6d65 7468 6f64 3d22 7075 7422 2c0a 2020  method="put",.  
+00021460: 2020 2020 2020 2020 2020 656e 6470 6f69            endpoi
+00021470: 6e74 3d66 222f 5f61 7069 2f67 6861 7269  nt=f"/_api/ghari
+00021480: 616c 2f7b 7365 6c66 2e5f 6772 6170 687d  al/{self._graph}
+00021490: 2f65 6467 652f 7b65 6467 655f 6964 7d22  /edge/{edge_id}"
+000214a0: 2c0a 2020 2020 2020 2020 2020 2020 6865  ,.            he
+000214b0: 6164 6572 733d 6865 6164 6572 732c 0a20  aders=headers,. 
+000214c0: 2020 2020 2020 2020 2020 2070 6172 616d             param
+000214d0: 733d 7061 7261 6d73 2c0a 2020 2020 2020  s=params,.      
+000214e0: 2020 2020 2020 6461 7461 3d65 6467 652c        data=edge,
+000214f0: 0a20 2020 2020 2020 2020 2020 2077 7269  .            wri
+00021500: 7465 3d73 656c 662e 6e61 6d65 2c0a 2020  te=self.name,.  
+00021510: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00021520: 2064 6566 2072 6573 706f 6e73 655f 6861   def response_ha
+00021530: 6e64 6c65 7228 7265 7370 3a20 5265 7370  ndler(resp: Resp
+00021540: 6f6e 7365 2920 2d3e 2055 6e69 6f6e 5b62  onse) -> Union[b
+00021550: 6f6f 6c2c 204a 736f 6e5d 3a0a 2020 2020  ool, Json]:.    
+00021560: 2020 2020 2020 2020 6966 2072 6573 702e          if resp.
+00021570: 7374 6174 7573 5f63 6f64 6520 3d3d 2034  status_code == 4
+00021580: 3132 3a20 2023 2070 7261 676d 613a 206e  12:  # pragma: n
+00021590: 6f20 636f 7665 720a 2020 2020 2020 2020  o cover.        
+000215a0: 2020 2020 2020 2020 7261 6973 6520 446f          raise Do
+000215b0: 6375 6d65 6e74 5265 7669 7369 6f6e 4572  cumentRevisionEr
+000215c0: 726f 7228 7265 7370 2c20 7265 7175 6573  ror(resp, reques
+000215d0: 7429 0a20 2020 2020 2020 2020 2020 2069  t).            i
+000215e0: 6620 6e6f 7420 7265 7370 2e69 735f 7375  f not resp.is_su
+000215f0: 6363 6573 733a 0a20 2020 2020 2020 2020  ccess:.         
+00021600: 2020 2020 2020 2072 6169 7365 2044 6f63         raise Doc
+00021610: 756d 656e 7452 6570 6c61 6365 4572 726f  umentReplaceErro
+00021620: 7228 7265 7370 2c20 7265 7175 6573 7429  r(resp, request)
+00021630: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00021640: 7369 6c65 6e74 2069 7320 5472 7565 3a0a  silent is True:.
+00021650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021660: 7265 7475 726e 2054 7275 650a 2020 2020  return True.    
+00021670: 2020 2020 2020 2020 7265 7475 726e 2066          return f
+00021680: 6f72 6d61 745f 6564 6765 2872 6573 702e  ormat_edge(resp.
+00021690: 626f 6479 290a 0a20 2020 2020 2020 2072  body)..        r
+000216a0: 6574 7572 6e20 7365 6c66 2e5f 6578 6563  eturn self._exec
+000216b0: 7574 6528 7265 7175 6573 742c 2072 6573  ute(request, res
+000216c0: 706f 6e73 655f 6861 6e64 6c65 7229 0a0a  ponse_handler)..
+000216d0: 2020 2020 6465 6620 6465 6c65 7465 280a      def delete(.
+000216e0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+000216f0: 2020 2020 2020 6564 6765 3a20 556e 696f        edge: Unio
+00021700: 6e5b 7374 722c 204a 736f 6e5d 2c0a 2020  n[str, Json],.  
+00021710: 2020 2020 2020 7265 763a 204f 7074 696f        rev: Optio
+00021720: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
+00021730: 0a20 2020 2020 2020 2063 6865 636b 5f72  .        check_r
+00021740: 6576 3a20 626f 6f6c 203d 2054 7275 652c  ev: bool = True,
+00021750: 0a20 2020 2020 2020 2069 676e 6f72 655f  .        ignore_
+00021760: 6d69 7373 696e 673a 2062 6f6f 6c20 3d20  missing: bool = 
+00021770: 4661 6c73 652c 0a20 2020 2020 2020 2073  False,.        s
+00021780: 796e 633a 204f 7074 696f 6e61 6c5b 626f  ync: Optional[bo
+00021790: 6f6c 5d20 3d20 4e6f 6e65 2c0a 2020 2020  ol] = None,.    
+000217a0: 2020 2020 7265 7475 726e 5f6f 6c64 3a20      return_old: 
+000217b0: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+000217c0: 2020 2920 2d3e 2052 6573 756c 745b 556e    ) -> Result[Un
+000217d0: 696f 6e5b 626f 6f6c 2c20 4a73 6f6e 5d5d  ion[bool, Json]]
+000217e0: 3a0a 2020 2020 2020 2020 2222 2244 656c  :.        """Del
+000217f0: 6574 6520 616e 2065 6467 6520 646f 6375  ete an edge docu
+00021800: 6d65 6e74 2e0a 0a20 2020 2020 2020 203a  ment...        :
+00021810: 7061 7261 6d20 6564 6765 3a20 4564 6765  param edge: Edge
+00021820: 2064 6f63 756d 656e 7420 4944 2c20 6b65   document ID, ke
+00021830: 7920 6f72 2062 6f64 792e 2044 6f63 756d  y or body. Docum
+00021840: 656e 7420 626f 6479 206d 7573 7420 636f  ent body must co
+00021850: 6e74 6169 6e0a 2020 2020 2020 2020 2020  ntain.          
+00021860: 2020 7468 6520 225f 6964 2220 6f72 2022    the "_id" or "
+00021870: 5f6b 6579 2220 6669 656c 642e 0a20 2020  _key" field..   
+00021880: 2020 2020 203a 7479 7065 2065 6467 653a       :type edge:
+00021890: 2073 7472 207c 2064 6963 740a 2020 2020   str | dict.    
+000218a0: 2020 2020 3a70 6172 616d 2072 6576 3a20      :param rev: 
+000218b0: 4578 7065 6374 6564 2064 6f63 756d 656e  Expected documen
+000218c0: 7420 7265 7669 7369 6f6e 2e20 4f76 6572  t revision. Over
+000218d0: 7269 6465 7320 7468 6520 7661 6c75 6520  rides the value 
+000218e0: 6f66 2022 5f72 6576 220a 2020 2020 2020  of "_rev".      
+000218f0: 2020 2020 2020 6669 656c 6420 696e 202a        field in *
+00021900: 2a65 6467 652a 2a20 6966 2070 7265 7365  *edge** if prese
+00021910: 6e74 2e0a 2020 2020 2020 2020 3a74 7970  nt..        :typ
+00021920: 6520 7265 763a 2073 7472 207c 204e 6f6e  e rev: str | Non
+00021930: 650a 2020 2020 2020 2020 3a70 6172 616d  e.        :param
+00021940: 2063 6865 636b 5f72 6576 3a20 4966 2073   check_rev: If s
+00021950: 6574 2074 6f20 5472 7565 2c20 7265 7669  et to True, revi
+00021960: 7369 6f6e 206f 6620 2a2a 6564 6765 2a2a  sion of **edge**
+00021970: 2028 6966 2067 6976 656e 2920 6973 0a20   (if given) is. 
+00021980: 2020 2020 2020 2020 2020 2063 6f6d 7061             compa
+00021990: 7265 6420 6167 6169 6e73 7420 7468 6520  red against the 
+000219a0: 7265 7669 7369 6f6e 206f 6620 7461 7267  revision of targ
+000219b0: 6574 2065 6467 6520 646f 6375 6d65 6e74  et edge document
+000219c0: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
+000219d0: 6368 6563 6b5f 7265 763a 2062 6f6f 6c0a  check_rev: bool.
+000219e0: 2020 2020 2020 2020 3a70 6172 616d 2069          :param i
+000219f0: 676e 6f72 655f 6d69 7373 696e 673a 2044  gnore_missing: D
+00021a00: 6f20 6e6f 7420 7261 6973 6520 616e 2065  o not raise an e
+00021a10: 7863 6570 7469 6f6e 206f 6e20 6d69 7373  xception on miss
+00021a20: 696e 6720 646f 6375 6d65 6e74 2e0a 2020  ing document..  
+00021a30: 2020 2020 2020 2020 2020 5468 6973 2070            This p
+00021a40: 6172 616d 6574 6572 2068 6173 206e 6f20  arameter has no 
+00021a50: 6566 6665 6374 2069 6e20 7472 616e 7361  effect in transa
+00021a60: 6374 696f 6e73 2077 6865 7265 2061 6e20  ctions where an 
+00021a70: 6578 6365 7074 696f 6e20 6973 0a20 2020  exception is.   
+00021a80: 2020 2020 2020 2020 2061 6c77 6179 7320           always 
+00021a90: 7261 6973 6564 206f 6e20 6661 696c 7572  raised on failur
+00021aa0: 6573 2e0a 2020 2020 2020 2020 3a74 7970  es..        :typ
+00021ab0: 6520 6967 6e6f 7265 5f6d 6973 7369 6e67  e ignore_missing
+00021ac0: 3a20 626f 6f6c 0a20 2020 2020 2020 203a  : bool.        :
+00021ad0: 7061 7261 6d20 7379 6e63 3a20 426c 6f63  param sync: Bloc
+00021ae0: 6b20 756e 7469 6c20 6f70 6572 6174 696f  k until operatio
+00021af0: 6e20 6973 2073 796e 6368 726f 6e69 7a65  n is synchronize
+00021b00: 6420 746f 2064 6973 6b2e 0a20 2020 2020  d to disk..     
+00021b10: 2020 203a 7479 7065 2073 796e 633a 2062     :type sync: b
+00021b20: 6f6f 6c20 7c20 4e6f 6e65 0a20 2020 2020  ool | None.     
+00021b30: 2020 203a 7061 7261 6d20 7265 7475 726e     :param return
+00021b40: 5f6f 6c64 3a20 5265 7475 726e 2062 6f64  _old: Return bod
+00021b50: 7920 6f66 2074 6865 206f 6c64 2064 6f63  y of the old doc
+00021b60: 756d 656e 7420 696e 2074 6865 2072 6573  ument in the res
+00021b70: 756c 742e 0a20 2020 2020 2020 203a 7479  ult..        :ty
+00021b80: 7065 2072 6574 7572 6e5f 6f6c 643a 2062  pe return_old: b
+00021b90: 6f6f 6c0a 2020 2020 2020 2020 3a72 6574  ool.        :ret
+00021ba0: 7572 6e3a 2054 7275 6520 6966 2065 6467  urn: True if edg
+00021bb0: 6520 7761 7320 6465 6c65 7465 6420 7375  e was deleted su
+00021bc0: 6363 6573 7366 756c 6c79 2c20 4661 6c73  ccessfully, Fals
+00021bd0: 6520 6966 2065 6467 6520 7761 7320 6e6f  e if edge was no
+00021be0: 740a 2020 2020 2020 2020 2020 2020 666f  t.            fo
+00021bf0: 756e 6420 616e 6420 2a2a 6967 6e6f 7265  und and **ignore
+00021c00: 5f6d 6973 7369 6e67 2a2a 2077 6173 2073  _missing** was s
+00021c10: 6574 2074 6f20 5472 7565 2028 646f 6573  et to True (does
+00021c20: 206e 6f74 2020 6170 706c 7920 696e 0a20   not  apply in. 
+00021c30: 2020 2020 2020 2020 2020 2074 7261 6e73             trans
+00021c40: 6163 7469 6f6e 7329 2e0a 2020 2020 2020  actions)..      
+00021c50: 2020 3a72 7479 7065 3a20 626f 6f6c 0a20    :rtype: bool. 
+00021c60: 2020 2020 2020 203a 7261 6973 6520 6172         :raise ar
+00021c70: 616e 676f 2e65 7863 6570 7469 6f6e 732e  ango.exceptions.
+00021c80: 446f 6375 6d65 6e74 4465 6c65 7465 4572  DocumentDeleteEr
+00021c90: 726f 723a 2049 6620 6465 6c65 7465 2066  ror: If delete f
+00021ca0: 6169 6c73 2e0a 2020 2020 2020 2020 3a72  ails..        :r
+00021cb0: 6169 7365 2061 7261 6e67 6f2e 6578 6365  aise arango.exce
+00021cc0: 7074 696f 6e73 2e44 6f63 756d 656e 7452  ptions.DocumentR
+00021cd0: 6576 6973 696f 6e45 7272 6f72 3a20 4966  evisionError: If
+00021ce0: 2072 6576 6973 696f 6e73 206d 6973 6d61   revisions misma
+00021cf0: 7463 682e 0a20 2020 2020 2020 2022 2222  tch..        """
+00021d00: 0a20 2020 2020 2020 2068 616e 646c 652c  .        handle,
+00021d10: 205f 2c20 6865 6164 6572 7320 3d20 7365   _, headers = se
+00021d20: 6c66 2e5f 7072 6570 5f66 726f 6d5f 646f  lf._prep_from_do
+00021d30: 6328 6564 6765 2c20 7265 762c 2063 6865  c(edge, rev, che
+00021d40: 636b 5f72 6576 290a 0a20 2020 2020 2020  ck_rev)..       
+00021d50: 2070 6172 616d 733a 2050 6172 616d 7320   params: Params 
+00021d60: 3d20 7b22 7265 7475 726e 4f6c 6422 3a20  = {"returnOld": 
+00021d70: 7265 7475 726e 5f6f 6c64 7d0a 2020 2020  return_old}.    
+00021d80: 2020 2020 6966 2073 796e 6320 6973 206e      if sync is n
+00021d90: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+00021da0: 2020 2020 2070 6172 616d 735b 2277 6169       params["wai
+00021db0: 7446 6f72 5379 6e63 225d 203d 2073 796e  tForSync"] = syn
+00021dc0: 630a 0a20 2020 2020 2020 2072 6571 7565  c..        reque
+00021dd0: 7374 203d 2052 6571 7565 7374 280a 2020  st = Request(.  
+00021de0: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+00021df0: 3d22 6465 6c65 7465 222c 0a20 2020 2020  ="delete",.     
+00021e00: 2020 2020 2020 2065 6e64 706f 696e 743d         endpoint=
+00021e10: 6622 2f5f 6170 692f 6768 6172 6961 6c2f  f"/_api/gharial/
+00021e20: 7b73 656c 662e 5f67 7261 7068 7d2f 6564  {self._graph}/ed
+00021e30: 6765 2f7b 6861 6e64 6c65 7d22 2c0a 2020  ge/{handle}",.  
+00021e40: 2020 2020 2020 2020 2020 7061 7261 6d73            params
+00021e50: 3d70 6172 616d 732c 0a20 2020 2020 2020  =params,.       
+00021e60: 2020 2020 2068 6561 6465 7273 3d68 6561       headers=hea
+00021e70: 6465 7273 2c0a 2020 2020 2020 2020 2020  ders,.          
+00021e80: 2020 7772 6974 653d 7365 6c66 2e6e 616d    write=self.nam
+00021e90: 652c 0a20 2020 2020 2020 2029 0a0a 2020  e,.        )..  
+00021ea0: 2020 2020 2020 6465 6620 7265 7370 6f6e        def respon
+00021eb0: 7365 5f68 616e 646c 6572 2872 6573 703a  se_handler(resp:
+00021ec0: 2052 6573 706f 6e73 6529 202d 3e20 556e   Response) -> Un
+00021ed0: 696f 6e5b 626f 6f6c 2c20 4a73 6f6e 5d3a  ion[bool, Json]:
+00021ee0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00021ef0: 7265 7370 2e65 7272 6f72 5f63 6f64 6520  resp.error_code 
+00021f00: 3d3d 2031 3230 3220 616e 6420 6967 6e6f  == 1202 and igno
+00021f10: 7265 5f6d 6973 7369 6e67 3a0a 2020 2020  re_missing:.    
+00021f20: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00021f30: 726e 2046 616c 7365 0a20 2020 2020 2020  rn False.       
+00021f40: 2020 2020 2069 6620 7265 7370 2e73 7461       if resp.sta
+00021f50: 7475 735f 636f 6465 203d 3d20 3431 323a  tus_code == 412:
+00021f60: 2020 2320 7072 6167 6d61 3a20 6e6f 2063    # pragma: no c
+00021f70: 6f76 6572 0a20 2020 2020 2020 2020 2020  over.           
+00021f80: 2020 2020 2072 6169 7365 2044 6f63 756d       raise Docum
+00021f90: 656e 7452 6576 6973 696f 6e45 7272 6f72  entRevisionError
+00021fa0: 2872 6573 702c 2072 6571 7565 7374 290a  (resp, request).
+00021fb0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00021fc0: 6f74 2072 6573 702e 6973 5f73 7563 6365  ot resp.is_succe
+00021fd0: 7373 3a0a 2020 2020 2020 2020 2020 2020  ss:.            
+00021fe0: 2020 2020 7261 6973 6520 446f 6375 6d65      raise Docume
+00021ff0: 6e74 4465 6c65 7465 4572 726f 7228 7265  ntDeleteError(re
+00022000: 7370 2c20 7265 7175 6573 7429 0a0a 2020  sp, request)..  
+00022010: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00022020: 3a20 4a73 6f6e 203d 2072 6573 702e 626f  : Json = resp.bo
+00022030: 6479 0a20 2020 2020 2020 2020 2020 2072  dy.            r
+00022040: 6574 7572 6e20 7b22 6f6c 6422 3a20 7265  eturn {"old": re
+00022050: 7375 6c74 5b22 6f6c 6422 5d7d 2069 6620  sult["old"]} if 
+00022060: 7265 7475 726e 5f6f 6c64 2065 6c73 6520  return_old else 
+00022070: 5472 7565 0a0a 2020 2020 2020 2020 7265  True..        re
+00022080: 7475 726e 2073 656c 662e 5f65 7865 6375  turn self._execu
+00022090: 7465 2872 6571 7565 7374 2c20 7265 7370  te(request, resp
+000220a0: 6f6e 7365 5f68 616e 646c 6572 290a 0a20  onse_handler).. 
+000220b0: 2020 2064 6566 206c 696e 6b28 0a20 2020     def link(.   
+000220c0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+000220d0: 2020 2066 726f 6d5f 7665 7274 6578 3a20     from_vertex: 
+000220e0: 556e 696f 6e5b 7374 722c 204a 736f 6e5d  Union[str, Json]
+000220f0: 2c0a 2020 2020 2020 2020 746f 5f76 6572  ,.        to_ver
+00022100: 7465 783a 2055 6e69 6f6e 5b73 7472 2c20  tex: Union[str, 
+00022110: 4a73 6f6e 5d2c 0a20 2020 2020 2020 2064  Json],.        d
+00022120: 6174 613a 204f 7074 696f 6e61 6c5b 4a73  ata: Optional[Js
+00022130: 6f6e 5d20 3d20 4e6f 6e65 2c0a 2020 2020  on] = None,.    
+00022140: 2020 2020 7379 6e63 3a20 4f70 7469 6f6e      sync: Option
+00022150: 616c 5b62 6f6f 6c5d 203d 204e 6f6e 652c  al[bool] = None,
+00022160: 0a20 2020 2020 2020 2073 696c 656e 743a  .        silent:
+00022170: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
+00022180: 2020 2020 2020 2072 6574 7572 6e5f 6e65         return_ne
+00022190: 773a 2062 6f6f 6c20 3d20 4661 6c73 652c  w: bool = False,
+000221a0: 0a20 2020 2029 202d 3e20 5265 7375 6c74  .    ) -> Result
+000221b0: 5b55 6e69 6f6e 5b62 6f6f 6c2c 204a 736f  [Union[bool, Jso
+000221c0: 6e5d 5d3a 0a20 2020 2020 2020 2022 2222  n]]:.        """
+000221d0: 496e 7365 7274 2061 206e 6577 2065 6467  Insert a new edg
+000221e0: 6520 646f 6375 6d65 6e74 206c 696e 6b69  e document linki
+000221f0: 6e67 2074 6865 2067 6976 656e 2076 6572  ng the given ver
+00022200: 7469 6365 732e 0a0a 2020 2020 2020 2020  tices...        
+00022210: 3a70 6172 616d 2066 726f 6d5f 7665 7274  :param from_vert
+00022220: 6578 3a20 2246 726f 6d22 2076 6572 7465  ex: "From" verte
+00022230: 7820 646f 6375 6d65 6e74 2049 4420 6f72  x document ID or
+00022240: 2062 6f64 7920 7769 7468 2022 5f69 6422   body with "_id"
+00022250: 2066 6965 6c64 2e0a 2020 2020 2020 2020   field..        
+00022260: 3a74 7970 6520 6672 6f6d 5f76 6572 7465  :type from_verte
+00022270: 783a 2073 7472 207c 2064 6963 740a 2020  x: str | dict.  
+00022280: 2020 2020 2020 3a70 6172 616d 2074 6f5f        :param to_
+00022290: 7665 7274 6578 3a20 2254 6f22 2076 6572  vertex: "To" ver
+000222a0: 7465 7820 646f 6375 6d65 6e74 2049 4420  tex document ID 
+000222b0: 6f72 2062 6f64 7920 7769 7468 2022 5f69  or body with "_i
+000222c0: 6422 2066 6965 6c64 2e0a 2020 2020 2020  d" field..      
+000222d0: 2020 3a74 7970 6520 746f 5f76 6572 7465    :type to_verte
+000222e0: 783a 2073 7472 207c 2064 6963 740a 2020  x: str | dict.  
+000222f0: 2020 2020 2020 3a70 6172 616d 2064 6174        :param dat
+00022300: 613a 2041 6e79 2065 7874 7261 2064 6174  a: Any extra dat
+00022310: 6120 666f 7220 7468 6520 6e65 7720 6564  a for the new ed
+00022320: 6765 2064 6f63 756d 656e 742e 2049 6620  ge document. If 
+00022330: 6974 2068 6173 2022 5f6b 6579 220a 2020  it has "_key".  
+00022340: 2020 2020 2020 2020 2020 6f72 2022 5f69            or "_i
+00022350: 6422 2066 6965 6c64 2c20 6974 7320 7661  d" field, its va
+00022360: 6c75 6520 6973 2075 7365 6420 6173 206b  lue is used as k
+00022370: 6579 206f 6620 7468 6520 6e65 7720 6564  ey of the new ed
+00022380: 6765 2064 6f63 756d 656e 740a 2020 2020  ge document.    
+00022390: 2020 2020 2020 2020 286f 7468 6572 7769          (otherwi
+000223a0: 7365 2069 7420 6973 2061 7574 6f2d 6765  se it is auto-ge
+000223b0: 6e65 7261 7465 6429 2e0a 2020 2020 2020  nerated)..      
+000223c0: 2020 3a74 7970 6520 6461 7461 3a20 6469    :type data: di
+000223d0: 6374 207c 204e 6f6e 650a 2020 2020 2020  ct | None.      
+000223e0: 2020 3a70 6172 616d 2073 796e 633a 2042    :param sync: B
+000223f0: 6c6f 636b 2075 6e74 696c 206f 7065 7261  lock until opera
+00022400: 7469 6f6e 2069 7320 7379 6e63 6872 6f6e  tion is synchron
+00022410: 697a 6564 2074 6f20 6469 736b 2e0a 2020  ized to disk..  
+00022420: 2020 2020 2020 3a74 7970 6520 7379 6e63        :type sync
+00022430: 3a20 626f 6f6c 207c 204e 6f6e 650a 2020  : bool | None.  
+00022440: 2020 2020 2020 3a70 6172 616d 2073 696c        :param sil
+00022450: 656e 743a 2049 6620 7365 7420 746f 2054  ent: If set to T
+00022460: 7275 652c 206e 6f20 646f 6375 6d65 6e74  rue, no document
+00022470: 206d 6574 6164 6174 6120 6973 2072 6574   metadata is ret
+00022480: 7572 6e65 642e 2054 6869 730a 2020 2020  urned. This.    
+00022490: 2020 2020 2020 2020 6361 6e20 6265 2075          can be u
+000224a0: 7365 6420 746f 2073 6176 6520 7265 736f  sed to save reso
+000224b0: 7572 6365 732e 0a20 2020 2020 2020 203a  urces..        :
+000224c0: 7479 7065 2073 696c 656e 743a 2062 6f6f  type silent: boo
+000224d0: 6c0a 2020 2020 2020 2020 3a70 6172 616d  l.        :param
+000224e0: 2072 6574 7572 6e5f 6e65 773a 2049 6e63   return_new: Inc
+000224f0: 6c75 6465 2062 6f64 7920 6f66 2074 6865  lude body of the
+00022500: 206e 6577 2064 6f63 756d 656e 7420 696e   new document in
+00022510: 2074 6865 2072 6574 7572 6e65 640a 2020   the returned.  
+00022520: 2020 2020 2020 2020 2020 6d65 7461 6461            metada
+00022530: 7461 2e20 4967 6e6f 7265 6420 6966 2070  ta. Ignored if p
+00022540: 6172 616d 6574 6572 202a 2a73 696c 656e  arameter **silen
+00022550: 742a 2a20 6973 2073 6574 2074 6f20 5472  t** is set to Tr
+00022560: 7565 2e0a 2020 2020 2020 2020 3a74 7970  ue..        :typ
+00022570: 6520 7265 7475 726e 5f6e 6577 3a20 626f  e return_new: bo
+00022580: 6f6c 0a20 2020 2020 2020 203a 7265 7475  ol.        :retu
+00022590: 726e 3a20 446f 6375 6d65 6e74 206d 6574  rn: Document met
+000225a0: 6164 6174 6120 2865 2e67 2e20 646f 6375  adata (e.g. docu
+000225b0: 6d65 6e74 206b 6579 2c20 7265 7669 7369  ment key, revisi
+000225c0: 6f6e 2920 6f72 2054 7275 6520 6966 0a20  on) or True if. 
+000225d0: 2020 2020 2020 2020 2020 2070 6172 616d             param
+000225e0: 6574 6572 202a 2a73 696c 656e 742a 2a20  eter **silent** 
+000225f0: 7761 7320 7365 7420 746f 2054 7275 652e  was set to True.
+00022600: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
+00022610: 2062 6f6f 6c20 7c20 6469 6374 0a20 2020   bool | dict.   
+00022620: 2020 2020 203a 7261 6973 6520 6172 616e       :raise aran
+00022630: 676f 2e65 7863 6570 7469 6f6e 732e 446f  go.exceptions.Do
+00022640: 6375 6d65 6e74 496e 7365 7274 4572 726f  cumentInsertErro
+00022650: 723a 2049 6620 696e 7365 7274 2066 6169  r: If insert fai
+00022660: 6c73 2e0a 2020 2020 2020 2020 2222 220a  ls..        """.
+00022670: 2020 2020 2020 2020 6564 6765 203d 207b          edge = {
+00022680: 225f 6672 6f6d 223a 2067 6574 5f64 6f63  "_from": get_doc
+00022690: 5f69 6428 6672 6f6d 5f76 6572 7465 7829  _id(from_vertex)
+000226a0: 2c20 225f 746f 223a 2067 6574 5f64 6f63  , "_to": get_doc
+000226b0: 5f69 6428 746f 5f76 6572 7465 7829 7d0a  _id(to_vertex)}.
+000226c0: 2020 2020 2020 2020 6966 2064 6174 6120          if data 
+000226d0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+000226e0: 2020 2020 2020 2020 2065 6467 652e 7570           edge.up
+000226f0: 6461 7465 2873 656c 662e 5f65 6e73 7572  date(self._ensur
+00022700: 655f 6b65 795f 6672 6f6d 5f69 6428 6461  e_key_from_id(da
+00022710: 7461 2929 0a20 2020 2020 2020 2072 6574  ta)).        ret
+00022720: 7572 6e20 7365 6c66 2e69 6e73 6572 7428  urn self.insert(
+00022730: 6564 6765 2c20 7379 6e63 3d73 796e 632c  edge, sync=sync,
+00022740: 2073 696c 656e 743d 7369 6c65 6e74 2c20   silent=silent, 
+00022750: 7265 7475 726e 5f6e 6577 3d72 6574 7572  return_new=retur
+00022760: 6e5f 6e65 7729 0a0a 2020 2020 6465 6620  n_new)..    def 
+00022770: 6564 6765 7328 0a20 2020 2020 2020 2073  edges(.        s
+00022780: 656c 662c 0a20 2020 2020 2020 2076 6572  elf,.        ver
+00022790: 7465 783a 2055 6e69 6f6e 5b73 7472 2c20  tex: Union[str, 
+000227a0: 4a73 6f6e 5d2c 0a20 2020 2020 2020 2064  Json],.        d
+000227b0: 6972 6563 7469 6f6e 3a20 4f70 7469 6f6e  irection: Option
+000227c0: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
+000227d0: 2020 2020 2020 2020 616c 6c6f 775f 6469          allow_di
+000227e0: 7274 795f 7265 6164 3a20 626f 6f6c 203d  rty_read: bool =
+000227f0: 2046 616c 7365 2c0a 2020 2020 2920 2d3e   False,.    ) ->
+00022800: 2052 6573 756c 745b 4a73 6f6e 5d3a 0a20   Result[Json]:. 
+00022810: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+00022820: 2074 6865 2065 6467 6520 646f 6375 6d65   the edge docume
+00022830: 6e74 7320 636f 6d69 6e67 2069 6e20 616e  nts coming in an
+00022840: 642f 6f72 206f 7574 206f 6620 7468 6520  d/or out of the 
+00022850: 7665 7274 6578 2e0a 0a20 2020 2020 2020  vertex...       
+00022860: 203a 7061 7261 6d20 7665 7274 6578 3a20   :param vertex: 
+00022870: 5665 7274 6578 2064 6f63 756d 656e 7420  Vertex document 
+00022880: 4944 206f 7220 626f 6479 2077 6974 6820  ID or body with 
+00022890: 225f 6964 2220 6669 656c 642e 0a20 2020  "_id" field..   
+000228a0: 2020 2020 203a 7479 7065 2076 6572 7465       :type verte
+000228b0: 783a 2073 7472 207c 2064 6963 740a 2020  x: str | dict.  
+000228c0: 2020 2020 2020 3a70 6172 616d 2064 6972        :param dir
+000228d0: 6563 7469 6f6e 3a20 5468 6520 6469 7265  ection: The dire
+000228e0: 6374 696f 6e20 6f66 2074 6865 2065 6467  ction of the edg
+000228f0: 6573 2e20 416c 6c6f 7765 6420 7661 6c75  es. Allowed valu
+00022900: 6573 2061 7265 2022 696e 220a 2020 2020  es are "in".    
+00022910: 2020 2020 2020 2020 616e 6420 226f 7574          and "out
+00022920: 222e 2049 6620 6e6f 7420 7365 742c 2065  ". If not set, e
+00022930: 6467 6573 2069 6e20 626f 7468 2064 6972  dges in both dir
+00022940: 6563 7469 6f6e 7320 6172 6520 7265 7475  ections are retu
+00022950: 726e 6564 2e0a 2020 2020 2020 2020 3a74  rned..        :t
+00022960: 7970 6520 6469 7265 6374 696f 6e3a 2073  ype direction: s
+00022970: 7472 0a20 2020 2020 2020 203a 7061 7261  tr.        :para
+00022980: 6d20 616c 6c6f 775f 6469 7274 795f 7265  m allow_dirty_re
+00022990: 6164 3a20 416c 6c6f 7720 7265 6164 7320  ad: Allow reads 
+000229a0: 6672 6f6d 2066 6f6c 6c6f 7765 7273 2069  from followers i
+000229b0: 6e20 6120 636c 7573 7465 722e 0a20 2020  n a cluster..   
+000229c0: 2020 2020 203a 7479 7065 2061 6c6c 6f77       :type allow
+000229d0: 5f64 6972 7479 5f72 6561 643a 2062 6f6f  _dirty_read: boo
+000229e0: 6c0a 2020 2020 2020 2020 3a72 6574 7572  l.        :retur
+000229f0: 6e3a 204c 6973 7420 6f66 2065 6467 6573  n: List of edges
+00022a00: 2061 6e64 2073 7461 7469 7374 6963 732e   and statistics.
+00022a10: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
+00022a20: 2064 6963 740a 2020 2020 2020 2020 3a72   dict.        :r
+00022a30: 6169 7365 2061 7261 6e67 6f2e 6578 6365  aise arango.exce
+00022a40: 7074 696f 6e73 2e45 6467 654c 6973 7445  ptions.EdgeListE
+00022a50: 7272 6f72 3a20 4966 2072 6574 7269 6576  rror: If retriev
+00022a60: 616c 2066 6169 6c73 2e0a 2020 2020 2020  al fails..      
+00022a70: 2020 2222 220a 2020 2020 2020 2020 7061    """.        pa
+00022a80: 7261 6d73 3a20 5061 7261 6d73 203d 207b  rams: Params = {
+00022a90: 2276 6572 7465 7822 3a20 6765 745f 646f  "vertex": get_do
+00022aa0: 635f 6964 2876 6572 7465 7829 7d0a 2020  c_id(vertex)}.  
+00022ab0: 2020 2020 2020 6966 2064 6972 6563 7469        if directi
+00022ac0: 6f6e 2069 7320 6e6f 7420 4e6f 6e65 3a0a  on is not None:.
+00022ad0: 2020 2020 2020 2020 2020 2020 7061 7261              para
+00022ae0: 6d73 5b22 6469 7265 6374 696f 6e22 5d20  ms["direction"] 
+00022af0: 3d20 6469 7265 6374 696f 6e0a 0a20 2020  = direction..   
+00022b00: 2020 2020 2072 6571 7565 7374 203d 2052       request = R
+00022b10: 6571 7565 7374 280a 2020 2020 2020 2020  equest(.        
+00022b20: 2020 2020 6d65 7468 6f64 3d22 6765 7422      method="get"
+00022b30: 2c0a 2020 2020 2020 2020 2020 2020 656e  ,.            en
+00022b40: 6470 6f69 6e74 3d66 222f 5f61 7069 2f65  dpoint=f"/_api/e
+00022b50: 6467 6573 2f7b 7365 6c66 2e6e 616d 657d  dges/{self.name}
+00022b60: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
+00022b70: 6172 616d 733d 7061 7261 6d73 2c0a 2020  arams=params,.  
+00022b80: 2020 2020 2020 2020 2020 7265 6164 3d73            read=s
+00022b90: 656c 662e 6e61 6d65 2c0a 2020 2020 2020  elf.name,.      
+00022ba0: 2020 2020 2020 6865 6164 6572 733d 7b22        headers={"
+00022bb0: 782d 6172 616e 676f 2d61 6c6c 6f77 2d64  x-arango-allow-d
+00022bc0: 6972 7479 2d72 6561 6422 3a20 2274 7275  irty-read": "tru
+00022bd0: 6522 7d20 6966 2061 6c6c 6f77 5f64 6972  e"} if allow_dir
+00022be0: 7479 5f72 6561 6420 656c 7365 204e 6f6e  ty_read else Non
+00022bf0: 652c 0a20 2020 2020 2020 2029 0a0a 2020  e,.        )..  
+00022c00: 2020 2020 2020 6465 6620 7265 7370 6f6e        def respon
+00022c10: 7365 5f68 616e 646c 6572 2872 6573 703a  se_handler(resp:
+00022c20: 2052 6573 706f 6e73 6529 202d 3e20 4a73   Response) -> Js
+00022c30: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
+00022c40: 6966 206e 6f74 2072 6573 702e 6973 5f73  if not resp.is_s
+00022c50: 7563 6365 7373 3a0a 2020 2020 2020 2020  uccess:.        
+00022c60: 2020 2020 2020 2020 7261 6973 6520 4564          raise Ed
+00022c70: 6765 4c69 7374 4572 726f 7228 7265 7370  geListError(resp
+00022c80: 2c20 7265 7175 6573 7429 0a20 2020 2020  , request).     
+00022c90: 2020 2020 2020 2073 7461 7473 203d 2072         stats = r
+00022ca0: 6573 702e 626f 6479 5b22 7374 6174 7322  esp.body["stats"
+00022cb0: 5d0a 2020 2020 2020 2020 2020 2020 7265  ].            re
+00022cc0: 7475 726e 207b 0a20 2020 2020 2020 2020  turn {.         
+00022cd0: 2020 2020 2020 2022 6564 6765 7322 3a20         "edges": 
+00022ce0: 7265 7370 2e62 6f64 795b 2265 6467 6573  resp.body["edges
+00022cf0: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
+00022d00: 2020 2020 2273 7461 7473 223a 207b 0a20      "stats": {. 
+00022d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022d20: 2020 2022 6669 6c74 6572 6564 223a 2073     "filtered": s
+00022d30: 7461 7473 5b22 6669 6c74 6572 6564 225d  tats["filtered"]
+00022d40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00022d50: 2020 2020 2020 2273 6361 6e6e 6564 5f69        "scanned_i
+00022d60: 6e64 6578 223a 2073 7461 7473 5b22 7363  ndex": stats["sc
+00022d70: 616e 6e65 6449 6e64 6578 225d 2c0a 2020  annedIndex"],.  
+00022d80: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
+00022d90: 0a20 2020 2020 2020 2020 2020 207d 0a0a  .            }..
+00022da0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00022db0: 656c 662e 5f65 7865 6375 7465 2872 6571  elf._execute(req
+00022dc0: 7565 7374 2c20 7265 7370 6f6e 7365 5f68  uest, response_h
+00022dd0: 616e 646c 6572 290a                      andler).
```

### Comparing `python-arango-7.9.1/arango/connection.py` & `python_arango-8.0.0/arango/connection.py`

 * *Files 9% similar despite different names*

```diff
@@ -19,15 +19,15 @@
 
 from arango.exceptions import (
     JWTAuthError,
     JWTExpiredError,
     JWTRefreshError,
     ServerConnectionError,
 )
-from arango.http import HTTPClient
+from arango.http import HTTPClient, RequestCompression
 from arango.request import Request
 from arango.resolver import HostResolver
 from arango.response import Response
 from arango.typings import Fields, Json
 
 Connection = Union["BasicConnection", "JwtConnection", "JwtSuperuserConnection"]
 
@@ -40,23 +40,27 @@
         hosts: Fields,
         host_resolver: HostResolver,
         sessions: Sequence[Session],
         db_name: str,
         http_client: HTTPClient,
         serializer: Callable[..., str],
         deserializer: Callable[[str], Any],
+        request_compression: Optional[RequestCompression] = None,
+        response_compression: Optional[str] = None,
     ) -> None:
         self._url_prefixes = [f"{host}/_db/{db_name}" for host in hosts]
         self._host_resolver = host_resolver
         self._sessions = sessions
         self._db_name = db_name
         self._http = http_client
         self._serializer = serializer
         self._deserializer = deserializer
         self._username: Optional[str] = None
+        self._request_compression = request_compression
+        self._response_compression = response_compression
 
     @property
     def db_name(self) -> str:
         """Return the database name.
 
         :returns: Database name.
         :rtype: str
@@ -129,22 +133,35 @@
         :param request: HTTP request.
         :type request: arango.request.Request
         :return: HTTP response.
         :rtype: arango.response.Response
         """
         tries = 0
         indexes_to_filter: Set[int] = set()
+
+        data = self.normalize_data(request.data)
+        if (
+            self._request_compression is not None
+            and isinstance(data, str)
+            and self._request_compression.needs_compression(data)
+        ):
+            request.headers["content-encoding"] = self._request_compression.encoding()
+            data = self._request_compression.compress(data)
+
+        if self._response_compression is not None:
+            request.headers["accept-encoding"] = self._response_compression
+
         while tries < self._host_resolver.max_tries:
             try:
                 resp = self._http.send_request(
                     session=self._sessions[host_index],
                     method=request.method,
                     url=self._url_prefixes[host_index] + request.endpoint,
                     params=request.params,
-                    data=self.normalize_data(request.data),
+                    data=data,
                     headers=request.headers,
                     auth=auth,
                 )
 
                 return self.prep_response(resp, request.deserialize)
             except ConnectionError:
                 url = self._url_prefixes[host_index] + request.endpoint
@@ -205,17 +222,21 @@
 
         :return: Response status code.
         :rtype: int
         """
         request = Request(method="get", endpoint="/_api/collection")
         resp = self.send_request(request)
         if resp.status_code in {401, 403}:
-            raise ServerConnectionError("bad username/password or token is expired")
+            raise ServerConnectionError(
+                resp, request, "bad username/password or token is expired"
+            )
         if not resp.is_success:  # pragma: no cover
-            raise ServerConnectionError(resp.error_message or "bad server response")
+            raise ServerConnectionError(
+                resp, request, resp.error_message or "bad server response"
+            )
         return resp.status_code
 
     @abstractmethod
     def send_request(self, request: Request) -> Response:  # pragma: no cover
         """Send an HTTP request to ArangoDB server.
 
         :param request: HTTP request.
@@ -239,36 +260,44 @@
     :type db_name: str
     :param username: Username.
     :type username: str
     :param password: Password.
     :type password: str
     :param http_client: User-defined HTTP client.
     :type http_client: arango.http.HTTPClient
+    :param: request_compression: The request compression algorithm.
+    :type request_compression: arango.http.RequestCompression | None
+    :param: response_compression: The response compression algorithm.
+    :type response_compression: str | None
     """
 
     def __init__(
         self,
         hosts: Fields,
         host_resolver: HostResolver,
         sessions: Sequence[Session],
         db_name: str,
         username: str,
         password: str,
         http_client: HTTPClient,
         serializer: Callable[..., str],
         deserializer: Callable[[str], Any],
+        request_compression: Optional[RequestCompression] = None,
+        response_compression: Optional[str] = None,
     ) -> None:
         super().__init__(
             hosts,
             host_resolver,
             sessions,
             db_name,
             http_client,
             serializer,
             deserializer,
+            request_compression,
+            response_compression,
         )
         self._username = username
         self._auth = (username, password)
 
     def send_request(self, request: Request) -> Response:
         """Send an HTTP request to ArangoDB server.
 
@@ -294,37 +323,45 @@
     :type db_name: str
     :param username: Username.
     :type username: str
     :param password: Password.
     :type password: str
     :param http_client: User-defined HTTP client.
     :type http_client: arango.http.HTTPClient
+    :param request_compression: The request compression algorithm.
+    :type request_compression: arango.http.RequestCompression | None
+    :param response_compression: The response compression algorithm.
+    :type response_compression: str | None
     """
 
     def __init__(
         self,
         hosts: Fields,
         host_resolver: HostResolver,
         sessions: Sequence[Session],
         db_name: str,
         http_client: HTTPClient,
         serializer: Callable[..., str],
         deserializer: Callable[[str], Any],
         username: Optional[str] = None,
         password: Optional[str] = None,
         user_token: Optional[str] = None,
+        request_compression: Optional[RequestCompression] = None,
+        response_compression: Optional[str] = None,
     ) -> None:
         super().__init__(
             hosts,
             host_resolver,
             sessions,
             db_name,
             http_client,
             serializer,
             deserializer,
+            request_compression,
+            response_compression,
         )
         self._username = username
         self._password = password
 
         self.exp_leeway: int = 0
         self._auth_header: Optional[str] = None
         self._token: Optional[str] = None
@@ -435,35 +472,43 @@
     :type sessions: [requests.Session]
     :param db_name: Database name.
     :type db_name: str
     :param http_client: User-defined HTTP client.
     :type http_client: arango.http.HTTPClient
     :param superuser_token: User generated token for superuser access.
     :type superuser_token: str
+    :param request_compression: The request compression algorithm.
+    :type request_compression: arango.http.RequestCompression | None
+    :param response_compression: The response compression algorithm.
+    :type response_compression: str | None
     """
 
     def __init__(
         self,
         hosts: Fields,
         host_resolver: HostResolver,
         sessions: Sequence[Session],
         db_name: str,
         http_client: HTTPClient,
         serializer: Callable[..., str],
         deserializer: Callable[[str], Any],
         superuser_token: str,
+        request_compression: Optional[RequestCompression] = None,
+        response_compression: Optional[str] = None,
     ) -> None:
         super().__init__(
             hosts,
             host_resolver,
             sessions,
             db_name,
             http_client,
             serializer,
             deserializer,
+            request_compression,
+            response_compression,
         )
         self._auth_header = f"bearer {superuser_token}"
 
     def send_request(self, request: Request) -> Response:
         """Send an HTTP request to ArangoDB server.
 
         :param request: HTTP request.
```

### Comparing `python-arango-7.9.1/arango/cursor.py` & `python_arango-8.0.0/arango/cursor.py`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/arango/database.py` & `python_arango-8.0.0/arango/database.py`

 * *Files 2% similar despite different names*

```diff
@@ -4,15 +4,15 @@
     "BatchDatabase",
     "OverloadControlDatabase",
     "TransactionDatabase",
 ]
 
 from datetime import datetime
 from numbers import Number
-from typing import Any, List, Optional, Sequence, Union
+from typing import Any, Dict, List, Optional, Sequence, Union
 from warnings import warn
 
 from arango.api import ApiGroup
 from arango.aql import AQL
 from arango.backup import Backup
 from arango.cluster import Cluster
 from arango.collection import StandardCollection
@@ -23,36 +23,45 @@
     AnalyzerGetError,
     AnalyzerListError,
     AsyncJobClearError,
     AsyncJobListError,
     CollectionCreateError,
     CollectionDeleteError,
     CollectionListError,
+    DatabaseCompactError,
     DatabaseCreateError,
     DatabaseDeleteError,
     DatabaseListError,
     DatabasePropertiesError,
+    DatabaseSupportInfoError,
     GraphCreateError,
     GraphDeleteError,
     GraphListError,
     JWTSecretListError,
     JWTSecretReloadError,
     PermissionGetError,
     PermissionListError,
     PermissionResetError,
     PermissionUpdateError,
+    ServerAvailableOptionsGetError,
+    ServerCurrentOptionsGetError,
     ServerDetailsError,
     ServerEchoError,
     ServerEncryptionError,
     ServerEngineError,
+    ServerExecuteError,
     ServerLicenseGetError,
     ServerLicenseSetError,
     ServerLogLevelError,
     ServerLogLevelSetError,
+    ServerLogSettingError,
+    ServerLogSettingSetError,
     ServerMetricsError,
+    ServerModeError,
+    ServerModeSetError,
     ServerReadLogError,
     ServerReloadRoutingError,
     ServerRequiredDBVersionError,
     ServerRoleError,
     ServerRunTestsError,
     ServerShutdownError,
     ServerShutdownProgressError,
@@ -220,14 +229,44 @@
         def response_handler(resp: Response) -> Json:
             if not resp.is_success:
                 raise DatabasePropertiesError(resp, request)
             return format_database(resp.body["result"])
 
         return self._execute(request, response_handler)
 
+    def execute(self, command: str) -> Result[Any]:
+        """Execute raw Javascript command on the server.
+
+        Executes the JavaScript code in the body on the server as
+        the body of a function with no arguments. If you have a
+        return statement then the return value you produce will be returned
+        as 'application/json'.
+
+        NOTE: this method endpoint will only be usable if the server
+        was started with the option `--javascript.allow-admin-execute true`.
+        The default value of this option is false, which disables the execution
+        of user-defined code and disables this API endpoint entirely.
+        This is also the recommended setting for production.
+
+        :param command: Javascript command to execute.
+        :type command: str
+        :return: Return value of **command**, if any.
+        :rtype: Any
+        :raise arango.exceptions.ServerExecuteError: If execution fails.
+        """
+        request = Request(method="post", endpoint="/_admin/execute", data=command)
+
+        def response_handler(resp: Response) -> Any:
+            if not resp.is_success:
+                raise ServerExecuteError(resp, request)
+
+            return resp.body
+
+        return self._execute(request, response_handler)
+
     def execute_transaction(
         self,
         command: str,
         params: Optional[Json] = None,
         read: Optional[Sequence[str]] = None,
         write: Optional[Sequence[str]] = None,
         sync: Optional[bool] = None,
@@ -435,14 +474,55 @@
         def response_handler(resp: Response) -> Json:
             if not resp.is_success:
                 raise ServerStatusError(resp, request)
             return format_server_status(resp.body)
 
         return self._execute(request, response_handler)
 
+    def compact(
+        self,
+        change_level: Optional[bool] = None,
+        compact_bottom_most_level: Optional[bool] = None,
+    ) -> Result[Json]:
+        """Compact all databases.
+
+        NOTE: This command can cause a full rewrite of all data in all databases,
+        which may take very long for large databases. It should thus only be used with
+        care and only when additional I/O load can be tolerated for a prolonged time.
+
+        This method can be used to reclaim disk space after substantial data deletions
+        have taken place, by compacting the entire database system data.
+
+        This method requires superuser access.
+
+        :param change_level: Whether or not compacted data should be moved to
+            the minimum possible level. Default value is False.
+        :type change_level: bool | None
+        :param compact_bottom_most_level: Whether or not to compact the
+            bottom-most level of data. Default value is False.
+        :type compact_bottom_most_level: bool | None
+        :return: Collection compact.
+        :rtype: dict
+        :raise arango.exceptions.CollectionCompactError: If retrieval fails.
+        """
+        data = {}
+        if change_level is not None:
+            data["changeLevel"] = change_level
+        if compact_bottom_most_level is not None:
+            data["compactBottomMostLevel"] = compact_bottom_most_level
+
+        request = Request(method="put", endpoint="/_admin/compact", data=data)
+
+        def response_handler(resp: Response) -> Json:
+            if resp.is_success:
+                return format_body(resp.body)
+            raise DatabaseCompactError(resp, request)
+
+        return self._execute(request, response_handler)
+
     def required_db_version(self) -> Result[str]:
         """Return required version of target database.
 
         :return: Required version of target database.
         :rtype: str
         :raise arango.exceptions.ServerRequiredDBVersionError: If retrieval fails.
         """
@@ -506,14 +586,64 @@
         def response_handler(resp: Response) -> str:
             if resp.is_success:
                 return str(resp.body["role"])
             raise ServerRoleError(resp, request)
 
         return self._execute(request, response_handler)
 
+    def mode(self) -> Result[str]:
+        """Return the server mode (default or read-only)
+
+        In a read-only server, all write operations will fail
+        with an error code of 1004 (ERROR_READ_ONLY). Creating or dropping
+        databases and collections will also fail with error code 11 (ERROR_FORBIDDEN).
+
+        :return: Server mode. Possible values are "default" or "readonly".
+        :rtype: str
+        :raise arango.exceptions.ServerModeError: If retrieval fails.
+        """
+        request = Request(method="get", endpoint="/_admin/server/mode")
+
+        def response_handler(resp: Response) -> str:
+            if resp.is_success:
+                return str(resp.body["mode"])
+
+            raise ServerModeError(resp, request)
+
+        return self._execute(request, response_handler)
+
+    def set_mode(self, mode: str) -> Result[Json]:
+        """Set the server mode to read-only or default.
+
+        Update mode information about a server. The JSON response will
+        contain a field mode with the value readonly or default.
+        In a read-only server all write operations will fail with an error
+        code of 1004 (ERROR_READ_ONLY). Creating or dropping of databases
+        and collections will also fail with error code 11 (ERROR_FORBIDDEN).
+
+        This is a protected API. It requires authentication and administrative
+        server rights.
+
+        :param mode: Server mode. Possible values are "default" or "readonly".
+        :type mode: str
+        :return: Server mode.
+        :rtype: str
+        :raise arango.exceptions.ServerModeSetError: If set fails.
+        """
+        request = Request(
+            method="put", endpoint="/_admin/server/mode", data={"mode": mode}
+        )
+
+        def response_handler(resp: Response) -> Json:
+            if resp.is_success:
+                return format_body(resp.body)
+            raise ServerModeSetError(resp, request)
+
+        return self._execute(request, response_handler)
+
     def time(self) -> Result[datetime]:
         """Return server system time.
 
         :return: Server system time.
         :rtype: datetime.datetime
         :raise arango.exceptions.ServerTimeError: If retrieval fails.
         """
@@ -522,22 +652,31 @@
         def response_handler(resp: Response) -> datetime:
             if not resp.is_success:
                 raise ServerTimeError(resp, request)
             return datetime.fromtimestamp(resp.body["time"])
 
         return self._execute(request, response_handler)
 
-    def echo(self) -> Result[Json]:
-        """Return details of the last request (e.g. headers, payload).
-
+    def echo(self, body: Optional[Any] = None) -> Result[Json]:
+        """Return details of the last request (e.g. headers, payload),
+        or echo the given request body.
+
+        :param body: The body of the request. Can be of any type
+            and is simply forwarded. If not set, the details of the last
+            request are returned.
+        :type body: dict | list | str | int | float | None
         :return: Details of the last request.
         :rtype: dict
         :raise arango.exceptions.ServerEchoError: If retrieval fails.
         """
-        request = Request(method="get", endpoint="/_admin/echo")
+        request = (
+            Request(method="get", endpoint="/_admin/echo")
+            if body is None
+            else Request(method="post", endpoint="/_admin/echo", data=body)
+        )
 
         def response_handler(resp: Response) -> Json:
             if not resp.is_success:
                 raise ServerEchoError(resp, request)
             result: Json = resp.body
             return result
 
@@ -745,14 +884,60 @@
                 raise ServerReadLogError(resp, request)
 
             result: Json = resp.body
             return result
 
         return self._execute(request, response_handler)
 
+    def log_settings(self) -> Result[Json]:
+        """Return the structured log settings.
+
+        :return: Current log settings. False values are not returned.
+        :rtype: dict
+        """
+        request = Request(method="get", endpoint="/_admin/log/structured")
+
+        def response_handler(resp: Response) -> Json:
+            if not resp.is_success:
+                raise ServerLogSettingError(resp, request)
+            result: Json = resp.body
+            return result
+
+        return self._execute(request, response_handler)
+
+    def set_log_settings(self, **kwargs: Dict[str, Any]) -> Result[Json]:
+        """Set the structured log settings.
+
+        This method takes arbitrary keyword arguments where the keys are the
+        structured log parameters and the values are true or false, for either
+        enabling or disabling the parameters.
+
+        .. code-block:: python
+
+            arango.set_log_settings(
+                database=True,
+                url=True,
+                username=False,
+            )
+
+        :param kwargs: Structured log parameters.
+        :type kwargs: Dict[str, Any]
+        :return: New log settings. False values are not returned.
+        :rtype: dict
+        """
+        request = Request(method="put", endpoint="/_admin/log/structured", data=kwargs)
+
+        def response_handler(resp: Response) -> Json:
+            if not resp.is_success:
+                raise ServerLogSettingSetError(resp, request)
+            result: Json = resp.body
+            return result
+
+        return self._execute(request, response_handler)
+
     def log_levels(self, server_id: Optional[str] = None) -> Result[Json]:
         """Return current logging levels.
 
         :param server_id: Forward log level to a specific server. This makes it
             easier to adjust the log levels in clusters because DB-Servers require
             JWT authentication whereas Coordinators also support authentication
             using usernames and passwords.
@@ -771,15 +956,15 @@
                 raise ServerLogLevelError(resp, request)
             result: Json = resp.body
             return result
 
         return self._execute(request, response_handler)
 
     def set_log_levels(
-        self, server_id: Optional[str] = None, **kwargs: str
+        self, server_id: Optional[str] = None, **kwargs: Dict[str, Any]
     ) -> Result[Json]:
         """Set the logging levels.
 
         This method takes arbitrary keyword arguments where the keys are the
         logger names and the values are the logging levels. For example:
 
         .. code-block:: python
@@ -793,14 +978,16 @@
         Keys that are not valid logger names are ignored.
 
         :param server_id: Forward log level to a specific server. This makes it
             easier to adjust the log levels in clusters because DB-Servers require
             JWT authentication whereas Coordinators also support authentication
             using usernames and passwords.
         :type server_id: str | None
+        :param kwargs: Logging levels.
+        :type kwargs: Dict[str, Any]
         :return: New logging levels.
         :rtype: dict
         """
         params: Params = {}
         if server_id is not None:
             params["serverId"] = server_id
 
@@ -834,15 +1021,15 @@
 
     def metrics(self) -> Result[str]:
         """Return server metrics in Prometheus format.
 
         :return: Server metrics in Prometheus format.
         :rtype: str
         """
-        request = Request(method="get", endpoint="/_admin/metrics")
+        request = Request(method="get", endpoint="/_admin/metrics/v2")
 
         def response_handler(resp: Response) -> str:
             if resp.is_success:
                 return resp.raw_body
             raise ServerMetricsError(resp, request)
 
         return self._execute(request, response_handler)
@@ -929,14 +1116,66 @@
             if resp.is_success:  # pragma: no cover
                 result: Json = resp.body["result"]
                 return result
             raise ServerEncryptionError(resp, request)
 
         return self._execute(request, response_handler)
 
+    def options(self) -> Result[Json]:
+        """Return the currently-set server options (ArangoDB 3.12+)
+
+        As this API may reveal sensitive data about the deployment, it can only
+        be accessed from inside the _system database. In addition, there is a
+        policy control startup option --server.options-api that determines if and
+        to whom the API is made available. This option can have the following
+        values:
+        - disabled: API is disabled.
+        - jwt: API can only be accessed via superuser JWT.
+        - admin: API can be accessed by admin users in the _system database only.
+        - public: everyone with access to _system database can access the API.
+
+        :return: Server options.
+        :rtype: dict
+        """
+        request = Request(method="get", endpoint="/_admin/options")
+
+        def response_handler(resp: Response) -> Json:
+            if resp.is_success:
+                result: Json = resp.body
+                return result
+            raise ServerCurrentOptionsGetError(resp, request)
+
+        return self._execute(request, response_handler)
+
+    def options_available(self) -> Result[Json]:
+        """Return a description of all available server options (ArangoDB 3.12+)
+
+        As this API may reveal sensitive data about the deployment, it can only
+        be accessed from inside the _system database. In addition, there is a
+        policy control startup option --server.options-api that determines if and
+        to whom the API is made available. This option can have the following
+        values:
+        - disabled: API is disabled.
+        - jwt: API can only be accessed via superuser JWT.
+        - admin: API can be accessed by admin users in the _system database only.
+        - public: everyone with access to _system database can access the options API.
+
+        :return: Server options.
+        :rtype: dict
+        """
+        request = Request(method="get", endpoint="/_admin/options-description")
+
+        def response_handler(resp: Response) -> Json:
+            if resp.is_success:
+                result: Json = resp.body
+                return result
+            raise ServerAvailableOptionsGetError(resp, request)
+
+        return self._execute(request, response_handler)
+
     #######################
     # Database Management #
     #######################
 
     def databases(self) -> Result[List[str]]:
         """Return the names of all databases.
 
@@ -1253,18 +1492,19 @@
             information on computed values.
         :type computedValues: list
         :return: Standard collection API wrapper.
         :rtype: arango.collection.StandardCollection
         :raise arango.exceptions.CollectionCreateError: If create fails.
         """
         key_options: Json = {"type": key_generator, "allowUserKeys": user_keys}
-        if key_increment is not None:
-            key_options["increment"] = key_increment
-        if key_offset is not None:
-            key_options["offset"] = key_offset
+        if key_generator == "autoincrement":
+            if key_increment is not None:
+                key_options["increment"] = key_increment
+            if key_offset is not None:
+                key_options["offset"] = key_offset
 
         data: Json = {
             "name": name,
             "waitForSync": sync,
             "isSystem": system,
             "keyOptions": key_options,
             "type": 3 if edge else 2,
@@ -2671,14 +2911,46 @@
                 return False
             if resp.is_success:
                 return True
             raise AnalyzerDeleteError(resp, request)
 
         return self._execute(request, response_handler)
 
+    ###########
+    # Support #
+    ###########
+
+    def support_info(self) -> Result[Json]:
+        """Return information about the deployment.
+
+        Retrieves deployment information for support purposes.
+        The endpoint returns data about the ArangoDB version used,
+        the host (operating system, server ID, CPU and storage capacity,
+        current utilization, a few metrics) and the other servers in the
+        deployment (in case of Active Failover or cluster deployments).
+
+        NOTE: This method can only be accessed from inside the **_system** database.
+        The is a policy control startup option `--server.support-info-api` that controls
+        if and to whom the API is made available.
+
+        :return: Deployment information.
+        :rtype: dict
+        :raise arango.exceptions.DatabaseSupportInfoError: If retrieval fails.
+        """
+        request = Request(method="get", endpoint="/_admin/support-info")
+
+        def response_handler(resp: Response) -> Json:
+            if resp.is_success:
+                result: Json = resp.body
+                return result
+
+            raise DatabaseSupportInfoError(resp, request)
+
+        return self._execute(request, response_handler)
+
 
 class StandardDatabase(Database):
     """Standard database API wrapper."""
 
     def __init__(self, connection: Connection) -> None:
         super().__init__(connection=connection, executor=DefaultApiExecutor(connection))
 
@@ -2727,14 +2999,22 @@
             between `os.cpu_count()` and the number of requests.
         :type max_workers: Optional[int]
         :return: Database API wrapper object specifically for batch execution.
         :rtype: arango.database.BatchDatabase
         """
         return BatchDatabase(self._conn, return_result, max_workers)
 
+    def fetch_transaction(self, transaction_id: str) -> "TransactionDatabase":
+        """Fetch an existing transaction.
+
+        :param transaction_id: The ID of the existing transaction.
+        :type transaction_id: str
+        """
+        return TransactionDatabase(connection=self._conn, transaction_id=transaction_id)
+
     def begin_transaction(
         self,
         read: Union[str, Sequence[str], None] = None,
         write: Union[str, Sequence[str], None] = None,
         exclusive: Union[str, Sequence[str], None] = None,
         sync: Optional[bool] = None,
         allow_implicit: Optional[bool] = None,
@@ -2904,39 +3184,44 @@
     :param allow_implicit: Allow reading from undeclared collections.
     :type allow_implicit: bool | None
     :param lock_timeout: Timeout for waiting on collection locks. If not given,
         a default value is used. Setting it to 0 disables the timeout.
     :type lock_timeout: int | None
     :param max_size: Max transaction size in bytes.
     :type max_size: int | None
+    :param transaction_id: Initialize using an existing transaction instead of creating
+        a new transaction.
+    :type transaction_id: str | None
     """
 
     def __init__(
         self,
         connection: Connection,
         read: Union[str, Sequence[str], None] = None,
         write: Union[str, Sequence[str], None] = None,
         exclusive: Union[str, Sequence[str], None] = None,
         sync: Optional[bool] = None,
         allow_implicit: Optional[bool] = None,
         lock_timeout: Optional[int] = None,
         max_size: Optional[int] = None,
+        transaction_id: Optional[str] = None,
     ) -> None:
         self._executor: TransactionApiExecutor
         super().__init__(
             connection=connection,
             executor=TransactionApiExecutor(
                 connection=connection,
                 read=read,
                 write=write,
                 exclusive=exclusive,
                 sync=sync,
                 allow_implicit=allow_implicit,
                 lock_timeout=lock_timeout,
                 max_size=max_size,
+                transaction_id=transaction_id,
             ),
         )
 
     def __repr__(self) -> str:
         return f"<TransactionDatabase {self.name}>"
 
     @property
```

### Comparing `python-arango-7.9.1/arango/errno.py` & `python_arango-8.0.0/arango/errno.py`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/arango/exceptions.py` & `python_arango-8.0.0/arango/exceptions.py`

 * *Files 2% similar despite different names*

```diff
@@ -356,14 +356,22 @@
     """Failed to create database."""
 
 
 class DatabaseDeleteError(ArangoServerError):
     """Failed to delete database."""
 
 
+class DatabaseSupportInfoError(ArangoServerError):
+    """Failed to retrieve support info for deployment."""
+
+
+class DatabaseCompactError(ArangoServerError):
+    """Failed to compact databases."""
+
+
 #######################
 # Document Exceptions #
 #######################
 
 
 class DocumentParseError(ArangoClientError):
     """Failed to parse document input."""
@@ -602,15 +610,15 @@
 
 
 #####################
 # Server Exceptions #
 #####################
 
 
-class ServerConnectionError(ArangoClientError):
+class ServerConnectionError(ArangoServerError):
     """Failed to connect to ArangoDB server."""
 
 
 class ServerEngineError(ArangoServerError):
     """Failed to retrieve database engine."""
 
 
@@ -662,46 +670,74 @@
     """Failed to retrieve global log."""
 
 
 class ServerLogLevelError(ArangoServerError):
     """Failed to retrieve server log levels."""
 
 
+class ServerLogSettingError(ArangoServerError):
+    """Failed to retrieve server log settings."""
+
+
 class ServerLogLevelSetError(ArangoServerError):
     """Failed to set server log levels."""
 
 
+class ServerLogSettingSetError(ArangoServerError):
+    """Failed to set server log settings."""
+
+
 class ServerReloadRoutingError(ArangoServerError):
     """Failed to reload routing details."""
 
 
 class ServerStatisticsError(ArangoServerError):
     """Failed to retrieve server statistics."""
 
 
 class ServerMetricsError(ArangoServerError):
     """Failed to retrieve server metrics."""
 
 
 class ServerRoleError(ArangoServerError):
-    """Failed to retrieve server role in a cluster."""
+    """Failed to retrieve server role."""
+
+
+class ServerModeError(ArangoServerError):
+    """Failed to retrieve server mode."""
+
+
+class ServerModeSetError(ArangoServerError):
+    """Failed to set server mode."""
 
 
 class ServerTLSError(ArangoServerError):
     """Failed to retrieve TLS data."""
 
 
 class ServerTLSReloadError(ArangoServerError):
     """Failed to reload TLS."""
 
 
 class ServerEncryptionError(ArangoServerError):
     """Failed to reload user-defined encryption keys."""
 
 
+class ServerCurrentOptionsGetError(ArangoServerError):
+    """Failed to retrieve currently-set server options."""
+
+
+class ServerAvailableOptionsGetError(ArangoServerError):
+    """Failed to retrieve available server options."""
+
+
+class ServerExecuteError(ArangoServerError):
+    """Failed to execute raw JavaScript command."""
+
+
 #####################
 # Task Exceptions   #
 #####################
 
 
 class TaskListError(ArangoServerError):
     """Failed to retrieve server tasks."""
@@ -740,14 +776,18 @@
     """Failed to commit transaction."""
 
 
 class TransactionAbortError(ArangoServerError):
     """Failed to abort transaction."""
 
 
+class TransactionFetchError(ArangoServerError):
+    """Failed to fetch existing transaction."""
+
+
 class TransactionListError(ArangoServerError):
     """Failed to retrieve transactions."""
 
 
 ###################
 # User Exceptions #
 ###################
@@ -964,15 +1004,19 @@
 
 
 class ClusterServerIDError(ArangoServerError):
     """Failed to retrieve server ID."""
 
 
 class ClusterServerRoleError(ArangoServerError):
-    """Failed to retrieve server role."""
+    """Failed to retrieve server role in a cluster."""
+
+
+class ClusterServerModeError(ArangoServerError):
+    """Failed to retrieve server mode in a cluster."""
 
 
 class ClusterServerStatisticsError(ArangoServerError):
     """Failed to retrieve DBServer statistics."""
 
 
 class ClusterServerVersionError(ArangoServerError):
```

### Comparing `python-arango-7.9.1/arango/executor.py` & `python_arango-8.0.0/arango/executor.py`

 * *Files 2% similar despite different names*

```diff
@@ -15,14 +15,15 @@
 from arango.connection import Connection
 from arango.exceptions import (
     AsyncExecuteError,
     BatchStateError,
     OverloadControlExecutorError,
     TransactionAbortError,
     TransactionCommitError,
+    TransactionFetchError,
     TransactionInitError,
     TransactionStatusError,
 )
 from arango.job import AsyncJob, BatchJob
 from arango.request import Request
 from arango.response import Response
 from arango.typings import Fields, Json
@@ -237,27 +238,31 @@
     :param lock_timeout: Timeout for waiting on collection locks. If not given,
         a default value is used. Setting it to 0 disables the timeout.
     :type lock_timeout: int
     :param max_size: Max transaction size in bytes.
     :type max_size: int
     :param allow_dirty_read: Allow reads from followers in a cluster.
     :type allow_dirty_read: bool | None
+    :param transaction_id: Initialize using an existing transaction instead of starting
+        a new transaction.
+    :type transaction_id: str | None
     """
 
     def __init__(
         self,
         connection: Connection,
         read: Optional[Fields] = None,
         write: Optional[Fields] = None,
         exclusive: Optional[Fields] = None,
         sync: Optional[bool] = None,
         allow_implicit: Optional[bool] = None,
         lock_timeout: Optional[int] = None,
         max_size: Optional[int] = None,
         allow_dirty_read: bool = False,
+        transaction_id: Optional[str] = None,
     ) -> None:
         self._conn = connection
 
         collections: Json = {}
         if read is not None:
             collections["read"] = read
         if write is not None:
@@ -271,27 +276,37 @@
         if allow_implicit is not None:
             data["allowImplicit"] = allow_implicit
         if lock_timeout is not None:
             data["lockTimeout"] = lock_timeout
         if max_size is not None:
             data["maxTransactionSize"] = max_size
 
-        request = Request(
-            method="post",
-            endpoint="/_api/transaction/begin",
-            data=data,
-            headers={"x-arango-allow-dirty-read": "true"} if allow_dirty_read else None,
-        )
-        resp = self._conn.send_request(request)
+        if transaction_id is None:
+            request = Request(
+                method="post",
+                endpoint="/_api/transaction/begin",
+                data=data,
+                headers=(
+                    {"x-arango-allow-dirty-read": "true"} if allow_dirty_read else None
+                ),
+            )
+            resp = self._conn.send_request(request)
 
-        if not resp.is_success:
-            raise TransactionInitError(resp, request)
+            if not resp.is_success:
+                raise TransactionInitError(resp, request)
+
+            result = resp.body["result"]
+            self._id: str = result["id"]
+        else:
+            self._id = transaction_id
 
-        result: Json = resp.body["result"]
-        self._id: str = result["id"]
+            try:
+                self.status()
+            except TransactionStatusError as err:
+                raise TransactionFetchError(err.response, err.request)
 
     @property
     def context(self) -> str:
         return "transaction"
 
     @property
     def id(self) -> str:
```

### Comparing `python-arango-7.9.1/arango/formatter.py` & `python_arango-8.0.0/arango/formatter.py`

 * *Files 0% similar despite different names*

```diff
@@ -16,22 +16,30 @@
     :rtype: dict
     """
     body.pop("error", None)
     body.pop("code", None)
     return body
 
 
-def format_index(body: Json) -> Json:
+def format_index(body: Json, formatter: bool = True) -> Json:
     """Format index data.
 
     :param body: Input body.
     :type body: dict
+    :param formatter: Convert (most) keys to snake_case.
+    :type formatter: bool
     :return: Formatted body.
     :rtype: dict
     """
+    if not formatter:
+        body.pop("code")
+        body.pop("error")
+        body["id"] = body["id"].split("/", 1)[-1]
+        return body
+
     result = {"id": body["id"].split("/", 1)[-1], "fields": body["fields"]}
     if "type" in body:
         result["type"] = body["type"]
     if "name" in body:
         result["name"] = body["name"]
     if "deduplicate" in body:
         result["deduplicate"] = body["deduplicate"]
@@ -97,14 +105,20 @@
         result["primaryKeyCache"] = body["primaryKeyCache"]
     if "writebufferIdle" in body:
         result["writebuffer_idle"] = body["writebufferIdle"]
     if "writebufferActive" in body:
         result["writebuffer_active"] = body["writebufferActive"]
     if "writebufferSizeMax" in body:
         result["writebuffer_max_size"] = body["writebufferSizeMax"]
+    if "fieldValueTypes" in body:
+        result["field_value_types"] = body["fieldValueTypes"]
+
+    # Introduced in 3.12 EE
+    if "optimizeTopK" in body:
+        result["optimizeTopK"] = body["optimizeTopK"]
 
     return verify_format(body, result)
 
 
 def format_key_options(body: Json) -> Json:
     """Format collection key options data.
```

### Comparing `python-arango-7.9.1/arango/foxx.py` & `python_arango-8.0.0/arango/foxx.py`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/arango/graph.py` & `python_arango-8.0.0/arango/graph.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,11 @@
 __all__ = ["Graph"]
 
 from typing import List, Optional, Sequence, Union
+from warnings import warn
 
 from arango.api import ApiGroup
 from arango.collection import EdgeCollection, VertexCollection
 from arango.connection import Connection
 from arango.exceptions import (
     EdgeDefinitionCreateError,
     EdgeDefinitionDeleteError,
@@ -380,14 +381,19 @@
         sort_func: Optional[str] = None,
         filter_func: Optional[str] = None,
         visitor_func: Optional[str] = None,
         expander_func: Optional[str] = None,
     ) -> Result[Json]:
         """Traverse the graph and return the visited vertices and edges.
 
+        .. warning::
+
+            This method is deprecated and no longer works since ArangoDB 3.12.
+            The preferred way to traverse graphs is via AQL.
+
         :param start_vertex: Start vertex document ID or body with "_id" field.
         :type start_vertex: str | dict
         :param direction: Traversal direction. Allowed values are "outbound"
             (default), "inbound" and "any".
         :type direction: str
         :param item_order: Item iteration order. Allowed values are "forward"
             (default) and "backward".
@@ -437,14 +443,17 @@
             array of connections for ``vertex``. Each connection is an object
             with attributes "edge" and "vertex".
         :type expander_func: str | None
         :return: Visited edges and vertices.
         :rtype: dict
         :raise arango.exceptions.GraphTraverseError: If traversal fails.
         """
+        m = "The HTTP traversal API is deprecated since version 3.4.0. The preferred way to traverse graphs is via AQL."  # noqa: E501
+        warn(m, DeprecationWarning, stacklevel=2)
+
         if strategy is not None:
             if strategy.lower() == "dfs":
                 strategy = "depthfirst"
             elif strategy.lower() == "bfs":
                 strategy = "breadthfirst"
 
         uniqueness = {}
```

### Comparing `python-arango-7.9.1/arango/http.py` & `python_arango-8.0.0/arango/http.py`

 * *Files 16% similar despite different names*

```diff
@@ -1,10 +1,17 @@
-__all__ = ["HTTPClient", "DefaultHTTPClient", "DEFAULT_REQUEST_TIMEOUT"]
+__all__ = [
+    "HTTPClient",
+    "DefaultHTTPClient",
+    "DeflateRequestCompression",
+    "RequestCompression",
+    "DEFAULT_REQUEST_TIMEOUT",
+]
 
 import typing
+import zlib
 from abc import ABC, abstractmethod
 from typing import Any, MutableMapping, Optional, Tuple, Union
 
 from requests import Session
 from requests.adapters import DEFAULT_POOLBLOCK, DEFAULT_POOLSIZE, HTTPAdapter
 from requests_toolbelt import MultipartEncoder
 from urllib3.poolmanager import PoolManager
@@ -36,15 +43,15 @@
     def send_request(
         self,
         session: Session,
         method: str,
         url: str,
         headers: Optional[Headers] = None,
         params: Optional[MutableMapping[str, str]] = None,
-        data: Union[str, MultipartEncoder, None] = None,
+        data: Union[str, bytes, MultipartEncoder, None] = None,
         auth: Optional[Tuple[str, str]] = None,
     ) -> Response:
         """Send an HTTP request.
 
         This method must be overridden by the user.
 
         :param session: Requests session object.
@@ -54,15 +61,15 @@
         :param url: Request URL.
         :type url: str
         :param headers: Request headers.
         :type headers: dict
         :param params: URL (query) parameters.
         :type params: dict
         :param data: Request payload.
-        :type data: str | MultipartEncoder | None
+        :type data: str | bytes | MultipartEncoder | None
         :param auth: Username and password.
         :type auth: tuple
         :returns: HTTP response.
         :rtype: arango.response.Response
         """
         raise NotImplementedError
 
@@ -194,15 +201,15 @@
     def send_request(
         self,
         session: Session,
         method: str,
         url: str,
         headers: Optional[Headers] = None,
         params: Optional[MutableMapping[str, str]] = None,
-        data: Union[str, MultipartEncoder, None] = None,
+        data: Union[str, bytes, MultipartEncoder, None] = None,
         auth: Optional[Tuple[str, str]] = None,
     ) -> Response:
         """Send an HTTP request.
 
         :param session: Requests session object.
         :type session: requests.Session
         :param method: HTTP method in lowercase (e.g. "post").
@@ -210,15 +217,15 @@
         :param url: Request URL.
         :type url: str
         :param headers: Request headers.
         :type headers: dict
         :param params: URL (query) parameters.
         :type params: dict
         :param data: Request payload.
-        :type data: str | MultipartEncoder | None
+        :type data: str | bytes | MultipartEncoder | None
         :param auth: Username and password.
         :type auth: tuple
         :returns: HTTP response.
         :rtype: arango.response.Response
         """
         response = session.request(
             method=method,
@@ -233,7 +240,79 @@
             method=method,
             url=response.url,
             headers=response.headers,
             status_code=response.status_code,
             status_text=response.reason,
             raw_body=response.text,
         )
+
+
+class RequestCompression(ABC):  # pragma: no cover
+    """Abstract base class for request compression."""
+
+    @abstractmethod
+    def needs_compression(self, data: str) -> bool:
+        """
+        :param data: Data to be compressed.
+        :type data: str
+        :returns: True if the data needs to be compressed.
+        :rtype: bool
+        """
+        raise NotImplementedError
+
+    @abstractmethod
+    def compress(self, data: str) -> bytes:
+        """Compress the data.
+
+        :param data: Data to be compressed.
+        :type data: str
+        :returns: Compressed data.
+        :rtype: bytes
+        """
+        raise NotImplementedError
+
+    @abstractmethod
+    def encoding(self) -> str:
+        """Return the content encoding exactly as it should
+            appear in the headers.
+
+        :returns: Content encoding.
+        :rtype: str
+        """
+        raise NotImplementedError
+
+
+class DeflateRequestCompression(RequestCompression):
+    """Compress requests using the 'deflate' algorithm."""
+
+    def __init__(self, threshold: int = 1024, level: int = 6):
+        """
+        :param threshold: Will compress requests to the server if
+        the size of the request body (in bytes) is at least the value of this
+        option.
+        :type threshold: int
+        :param level: Compression level, in 0-9 or -1.
+        :type level: int
+        """
+        self._threshold = threshold
+        self._level = level
+
+    def needs_compression(self, data: str) -> bool:
+        """
+        :param data: Data to be compressed.
+        :type data: str
+        :returns: True if the data needs to be compressed.
+        :rtype: bool
+        """
+        return len(data) >= self._threshold
+
+    def compress(self, data: str) -> bytes:
+        """
+        :param data: Data to be compressed.
+        :type data: str
+        :returns: Compressed data.
+        :rtype: bytes
+        """
+        return zlib.compress(data.encode("utf-8"), level=self._level)
+
+    def encoding(self) -> str:
+        return "deflate"
```

### Comparing `python-arango-7.9.1/arango/job.py` & `python_arango-8.0.0/arango/job.py`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/arango/pregel.py` & `python_arango-8.0.0/arango/pregel.py`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/arango/replication.py` & `python_arango-8.0.0/arango/replication.py`

 * *Files 0% similar despite different names*

```diff
@@ -176,21 +176,23 @@
             deserialize=False,
         )
 
         def response_handler(resp: Response) -> Json:
             if resp.is_success:
                 result = format_replication_header(resp.headers)
                 result["content"] = [
-                    [
-                        self._conn.deserialize(line)
-                        for line in resp.body.split("\n")
-                        if line
-                    ]
-                    if deserialize
-                    else resp.body
+                    (
+                        [
+                            self._conn.deserialize(line)
+                            for line in resp.body.split("\n")
+                            if line
+                        ]
+                        if deserialize
+                        else resp.body
+                    )
                 ]
                 return result
 
             raise ReplicationDumpError(resp, request)
 
         return self._execute(request, response_handler)
```

### Comparing `python-arango-7.9.1/arango/request.py` & `python_arango-8.0.0/arango/request.py`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/arango/resolver.py` & `python_arango-8.0.0/arango/resolver.py`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/arango/response.py` & `python_arango-8.0.0/arango/response.py`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/arango/typings.py` & `python_arango-8.0.0/arango/typings.py`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/arango/utils.py` & `python_arango-8.0.0/arango/utils.py`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/arango/wal.py` & `python_arango-8.0.0/arango/wal.py`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/Makefile` & `python_arango-8.0.0/docs/Makefile`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/admin.rst` & `python_arango-8.0.0/docs/admin.rst`

 * *Files 9% similar despite different names*

```diff
@@ -28,17 +28,30 @@
 
     # Retrieve the database engine.
     sys_db.engine()
 
     # Retrieve the server time.
     sys_db.time()
 
-    # Retrieve the server role in a cluster.
+    # Retrieve the server role.
     sys_db.role()
 
+    # Retrieve the server role in a cluster.
+    sys_db.cluster.server_role()
+
+    # Retrieve the server mode.
+    sys_db.mode()
+
+    # Retrieve the server mode in a cluster.
+    sys_db.cluster.server_mode()
+
+    # Set the server mode.
+    sys_db.set_mode('readonly')
+    sys_db.set_mode('default')
+
     # Retrieve the server statistics.
     sys_db.statistics()
 
     # Read the server log.
     sys_db.read_log(level="debug")
 
     # Retrieve the log levels.
@@ -50,14 +63,17 @@
         collector='INFO',
         threads='WARNING'
     )
 
     # Echo the last request.
     sys_db.echo()
 
+    # Echo a request
+    sys_db.echo('request goes here')
+
     # Reload the routing collection.
     sys_db.reload_routing()
 
     # Retrieve server metrics.
     sys_db.metrics()
```

### Comparing `python-arango-7.9.1/docs/analyzer.rst` & `python_arango-8.0.0/docs/analyzer.rst`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/aql.rst` & `python_arango-8.0.0/docs/aql.rst`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/async.rst` & `python_arango-8.0.0/docs/async.rst`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/auth.rst` & `python_arango-8.0.0/docs/auth.rst`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/backup.rst` & `python_arango-8.0.0/docs/backup.rst`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/batch.rst` & `python_arango-8.0.0/docs/batch.rst`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/certificates.rst` & `python_arango-8.0.0/docs/certificates.rst`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/cluster.rst` & `python_arango-8.0.0/docs/cluster.rst`

 * *Files 7% similar despite different names*

```diff
@@ -82,16 +82,21 @@
 
     # Get cluster server details.
     cluster.server_count()
     server_id = cluster.server_id()
     cluster.server_engine(server_id)
     cluster.server_version(server_id)
     cluster.server_statistics(server_id)
+    cluster.server_maintenance_mode(server_id)
 
-    # Toggle maintenance mode (allowed values are "on" and "off").
+    # Toggle Server maintenance mode (allowed values are "normal" and "maintenance").
+    cluster.toggle_server_maintenance_mode(server_id, 'normal')
+    cluster.toggle_server_maintenance_mode(server_id, 'maintenance', timeout=30)
+
+    # Toggle Cluster maintenance mode (allowed values are "on" and "off").
     cluster.toggle_maintenance_mode('on')
     cluster.toggle_maintenance_mode('off')
 
     # Rebalance the distribution of shards. Available with ArangoDB 3.10+.
     cluster.rebalance()
 
 See :ref:`ArangoClient` and :ref:`Cluster` for API specification.
```

### Comparing `python-arango-7.9.1/docs/collection.rst` & `python_arango-8.0.0/docs/collection.rst`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/conf.py` & `python_arango-8.0.0/docs/conf.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,14 +1,14 @@
 import os
 import sys
 
 sys.path.insert(0, os.path.abspath(".."))
 
 project = "python-arango"
-copyright = "2016-2022, Joohwan Oh"
+copyright = "2016-2024, Joohwan Oh"
 author = "Joohwan Oh"
 extensions = [
     "sphinx_rtd_theme",
     "sphinx.ext.autodoc",
     "sphinx.ext.doctest",
     "sphinx.ext.viewcode",
 ]
```

### Comparing `python-arango-7.9.1/docs/contributing.rst` & `python_arango-8.0.0/docs/contributing.rst`

 * *Files 22% similar despite different names*

```diff
@@ -3,24 +3,24 @@
 
 Requirements
 ============
 
 Before submitting a pull request on GitHub_, please make sure you meet the
 following requirements:
 
-* The pull request points to dev_ branch.
+* The pull request points to main_ branch.
 * Changes are squashed into a single commit. I like to use git rebase for this.
 * Commit message is in present tense. For example, "Fix bug" is good while
   "Fixed bug" is not.
 * Sphinx_-compatible docstrings.
 * PEP8_ compliance.
 * No missing docstrings or commented-out lines.
-* Test coverage_ remains at %100. If a piece of code is trivial and does not
+* Test coverage remains at %100. If a piece of code is trivial and does not
   need unit tests, use this_ to exclude it from coverage.
-* No build failures on `Travis CI`_. Builds automatically trigger on pull
+* No build failures. Builds automatically trigger on pull
   request submissions.
 * Documentation is kept up-to-date with the new changes (see below).
 
 .. warning::
     The dev branch is occasionally rebased, and its commit history may be
     overwritten in the process. Before you begin your feature work, git fetch
     or pull to ensure that your local branch has not diverged. If you see git
@@ -36,15 +36,15 @@
 =====
 
 To ensure PEP8_ compliance, run flake8_:
 
 .. code-block:: bash
 
     ~$ pip install flake8
-    ~$ git clone https://github.com/ArangoDB-Community/python-arango.git
+    ~$ git clone https://github.com/arangodb/python-arango.git
     ~$ cd python-arango
     ~$ flake8
 
 If there is a good reason to ignore a warning, see here_ on how to exclude it.
 
 Testing
 =======
@@ -53,24 +53,24 @@
 **python-arango**. It uses pytest_ and requires an actual ArangoDB instance.
 
 To run the test suite (use your own host, port and root password):
 
 .. code-block:: bash
 
     ~$ pip install pytest
-    ~$ git clone https://github.com/ArangoDB-Community/python-arango.git
+    ~$ git clone https://github.com/arangodb/python-arango.git
     ~$ cd python-arango
     ~$ py.test --complete --host=127.0.0.1 --port=8529 --passwd=passwd
 
 To run the test suite with coverage report:
 
 .. code-block:: bash
 
     ~$ pip install coverage pytest pytest-cov
-    ~$ git clone https://github.com/ArangoDB-Community/python-arango.git
+    ~$ git clone https://github.com/arangodb/python-arango.git
     ~$ cd python-arango
     ~$ py.test --complete --host=127.0.0.1 --port=8529 --passwd=passwd --cov=kq
 
 As the test suite creates real databases and jobs, it should only be run in
 development environments.
 
 Documentation
@@ -78,24 +78,22 @@
 
 The documentation including the README is written in reStructuredText_ and uses
 Sphinx_. To build an HTML version on your local machine:
 
 .. code-block:: bash
 
     ~$ pip install sphinx sphinx_rtd_theme
-    ~$ git clone https://github.com/ArangoDB-Community/python-arango.git
+    ~$ git clone https://github.com/arangodb/python-arango.git
     ~$ cd python-arango
     ~$ python -m sphinx -b html -W docs docs/_build/  # Open build/index.html in a browser
 
 As always, thank you for your contribution!
 
-.. _dev: https://github.com/joowani/python-arango/tree/dev
-.. _GitHub: https://github.com/joowani/python-arango
+.. _main: https://github.com/arangodb/python-arango/tree/main
+.. _GitHub: https://github.com/arangodb/python-arango
 .. _PEP8: https://www.python.org/dev/peps/pep-0008/
-.. _coverage: https://coveralls.io/github/joowani/python-arango
 .. _this: http://coverage.readthedocs.io/en/latest/excluding.html
-.. _Travis CI: https://travis-ci.org/joowani/python-arango
 .. _Sphinx: https://github.com/sphinx-doc/sphinx
 .. _flake8: http://flake8.pycqa.org
 .. _here: http://flake8.pycqa.org/en/latest/user/violations.html#in-line-ignoring-errors
 .. _pytest: https://github.com/pytest-dev/pytest
 .. _reStructuredText: https://en.wikipedia.org/wiki/ReStructuredText
```

### Comparing `python-arango-7.9.1/docs/cursor.rst` & `python_arango-8.0.0/docs/cursor.rst`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/database.rst` & `python_arango-8.0.0/docs/database.rst`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/document.rst` & `python_arango-8.0.0/docs/document.rst`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/errors.rst` & `python_arango-8.0.0/docs/errors.rst`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/foxx.rst` & `python_arango-8.0.0/docs/foxx.rst`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/graph.rst` & `python_arango-8.0.0/docs/graph.rst`

 * *Files 2% similar despite different names*

```diff
@@ -314,16 +314,18 @@
 See :ref:`Graph` and :ref:`EdgeCollection` for API specification.
 
 .. _graph-traversals:
 
 Graph Traversals
 ================
 
-**Graph traversals** are executed via the :func:`arango.graph.Graph.traverse`
-method. Each traversal can span across multiple vertex collections, and walk
+**Graph traversals** are executed via AQL. The old
+:func:`arango.graph.Graph.traverse` has been deprecated and can no longer be
+used with ArangoDB 3.12 or later.
+Each traversal can span across multiple vertex collections, and walk
 over edges and vertices using various algorithms.
 
 **Example:**
 
 .. testsetup:: traversals
 
     client = ArangoClient()
@@ -367,17 +369,16 @@
     lectures.insert({'_key': 'STA201', 'name': 'Statistics'})
 
     # Insert edges into the graph.
     teach.insert({'_from': 'teachers/jon', '_to': 'lectures/CSC101'})
     teach.insert({'_from': 'teachers/jon', '_to': 'lectures/STA201'})
     teach.insert({'_from': 'teachers/jon', '_to': 'lectures/MAT223'})
 
-    # Traverse the graph in outbound direction, breath-first.
-    school.traverse(
-        start_vertex='teachers/jon',
-        direction='outbound',
-        strategy='bfs',
-        edge_uniqueness='global',
-        vertex_uniqueness='global',
-    )
+    # AQL to perform a graph traversal
+    query = """
+    FOR v, e, p IN 1..3 OUTBOUND 'teachers/jon' GRAPH 'school'
+    OPTIONS { bfs: true, uniqueVertices: 'global' }
+    RETURN {vertex: v, edge: e, path: p}
+    """
 
-See :func:`arango.graph.Graph.traverse` for API specification.
+    # Traverse the graph in outbound direction, breath-first.
+    cursor = db.aql.execute(query)
```

### Comparing `python-arango-7.9.1/docs/http.rst` & `python_arango-8.0.0/docs/http.rst`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/logging.rst` & `python_arango-8.0.0/docs/logging.rst`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/make.bat` & `python_arango-8.0.0/docs/make.bat`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/overload.rst` & `python_arango-8.0.0/docs/overload.rst`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/pregel.rst` & `python_arango-8.0.0/docs/pregel.rst`

 * *Files 14% similar despite different names*

```diff
@@ -1,18 +1,22 @@
 Pregel
 ------
 
+.. warning::
+    Starting from ArangoDB 3.12, the Pregel API has been dropped.
+    Currently, the driver still supports it for the 3.10 and 3.11 versions, but note that it will be dropped eventually.
+
 Python-arango provides support for **Pregel**, ArangoDB module for distributed
 iterative graph processing. For more information, refer to `ArangoDB manual`_.
 
 .. _ArangoDB manual: https://docs.arangodb.com
 
 **Example:**
 
-.. testcode::
+.. code-block:: python
 
     from arango import ArangoClient
 
     # Initialize the ArangoDB client.
     client = ArangoClient()
 
     # Connect to "test" database as root user.
```

### Comparing `python-arango-7.9.1/docs/replication.rst` & `python_arango-8.0.0/docs/replication.rst`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/schema.rst` & `python_arango-8.0.0/docs/schema.rst`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/serializer.rst` & `python_arango-8.0.0/docs/serializer.rst`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/simple.rst` & `python_arango-8.0.0/docs/simple.rst`

 * *Files 22% similar despite different names*

```diff
@@ -1,12 +1,10 @@
 Simple Queries
 --------------
 
-.. caution:: There is no option to add a TTL (Time to live) or batch size optimizations to the Simple Queries due to how Arango is handling simple collection HTTP requests. Your request may time out and you'll see a CursorNextError exception. The AQL queries provide full functionality.
-
 Here is an example of using ArangoDB's **simply queries**:
 
 .. testcode::
 
     from arango import ArangoClient
 
     # Initialize the ArangoDB client.
```

### Comparing `python-arango-7.9.1/docs/specs.rst` & `python_arango-8.0.0/docs/specs.rst`

 * *Files 1% similar despite different names*

```diff
@@ -99,14 +99,20 @@
 
 DefaultHTTPClient
 =================
 
 .. autoclass:: arango.http.DefaultHTTPClient
     :members:
 
+DeflateRequestCompression
+=========================
+
+.. autoclass:: arango.http.DeflateRequestCompression
+    :members:
+
 .. _EdgeCollection:
 
 EdgeCollection
 ==============
 
 .. autoclass:: arango.collection.EdgeCollection
     :members:
```

### Comparing `python-arango-7.9.1/docs/static/logo.png` & `python_arango-8.0.0/docs/static/logo.png`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/task.rst` & `python_arango-8.0.0/docs/task.rst`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/threading.rst` & `python_arango-8.0.0/docs/threading.rst`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/transaction.rst` & `python_arango-8.0.0/docs/transaction.rst`

 * *Files 16% similar despite different names*

```diff
@@ -71,14 +71,24 @@
     # Abort the transaction
     txn_db.abort_transaction()
     assert 'Kate' not in col
     assert 'Mike' not in col
     assert 'Lily' not in col
     assert len(col) == 3  # transaction is aborted so txn_col cannot be used
 
+    # Fetch an existing transaction. Useful if you have received a Transaction ID
+    # from some other part of your system or an external system.
+    original_txn = db.begin_transaction(write='students')
+    txn_col = original_txn.collection('students')
+    assert '_rev' in txn_col.insert({'_key': 'Chip'})
+    txn_db = db.fetch_transaction(original_txn.transaction_id)
+    txn_col = txn_db.collection('students')
+    assert '_rev' in txn_col.insert({'_key': 'Alya'})
+    txn_db.abort_transaction()
+
 See :ref:`TransactionDatabase` for API specification.
 
 Alternatively, you can use
 :func:`arango.database.StandardDatabase.execute_transaction` to run raw
 Javascript code in a transaction.
 
 **Example:**
```

### Comparing `python-arango-7.9.1/docs/user.rst` & `python_arango-8.0.0/docs/user.rst`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/view.rst` & `python_arango-8.0.0/docs/view.rst`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/docs/wal.rst` & `python_arango-8.0.0/docs/wal.rst`

 * *Files identical despite different names*

### Comparing `python-arango-7.9.1/pyproject.toml` & `python_arango-8.0.0/pyproject.toml`

 * *Files 2% similar despite different names*

```diff
@@ -7,15 +7,15 @@
 
 [project]
 name = "python-arango"
 description = "Python Driver for ArangoDB"
 authors = [ {name= "Joohwan Oh", email = "joohwan.oh@outlook.com" }]
 maintainers = [
     {name = "Joohwan Oh", email = "joohwan.oh@outlook.com"},
-    {name = "Alexandru Petenchea", email = "alexandru.petenchea@arangodb.com"},
+    {name = "Alexandru Petenchea", email = "alex.petenchea@gmail.com"},
     {name = "Anthony Mahanna", email = "anthony.mahanna@arangodb.com"}
 ]
 keywords = ["arangodb", "python", "driver"]
 readme = "README.md"
 dynamic = ["version"]
 license = { file = "LICENSE" }
 requires-python = ">=3.8"
@@ -62,15 +62,15 @@
     "types-setuptools",
 ]
 
 [tool.setuptools.package-data]
 "arango" = ["py.typed"]
 
 [project.urls]
-homepage = "https://github.com/ArangoDB-Community/python-arango"
+homepage = "https://github.com/arangodb/python-arango"
 
 [tool.setuptools]
 packages = ["arango"]
 
 
 [tool.pytest.ini_options]
 addopts = "-s -vv -p no:warnings"
```

### Comparing `python-arango-7.9.1/python_arango.egg-info/PKG-INFO` & `python_arango-8.0.0/python_arango.egg-info/PKG-INFO`

 * *Files 8% similar despite different names*

```diff
@@ -1,13 +1,13 @@
 Metadata-Version: 2.1
 Name: python-arango
-Version: 7.9.1
+Version: 8.0.0
 Summary: Python Driver for ArangoDB
 Author-email: Joohwan Oh <joohwan.oh@outlook.com>
-Maintainer-email: Joohwan Oh <joohwan.oh@outlook.com>, Alexandru Petenchea <alexandru.petenchea@arangodb.com>, Anthony Mahanna <anthony.mahanna@arangodb.com>
+Maintainer-email: Joohwan Oh <joohwan.oh@outlook.com>, Alexandru Petenchea <alex.petenchea@gmail.com>, Anthony Mahanna <anthony.mahanna@arangodb.com>
 License: MIT License
         
         Copyright (c) 2016-2021 Joohwan Oh
         
         Permission is hereby granted, free of charge, to any person obtaining a copy
         of this software and associated documentation files (the "Software"), to deal
         in the Software without restriction, including without limitation the rights
@@ -22,15 +22,15 @@
         IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
         FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
         AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
         LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
         OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
         SOFTWARE.
         
-Project-URL: homepage, https://github.com/ArangoDB-Community/python-arango
+Project-URL: homepage, https://github.com/arangodb/python-arango
 Keywords: arangodb,python,driver
 Classifier: Intended Audience :: Developers
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Natural Language :: English
 Classifier: Operating System :: OS Independent
 Classifier: Programming Language :: Python :: 3
 Classifier: Programming Language :: Python :: 3.8
@@ -63,36 +63,36 @@
 Requires-Dist: sphinx_rtd_theme; extra == "dev"
 Requires-Dist: types-pkg_resources; extra == "dev"
 Requires-Dist: types-requests; extra == "dev"
 Requires-Dist: types-setuptools; extra == "dev"
 
 ![Logo](https://user-images.githubusercontent.com/2701938/108583516-c3576680-72ee-11eb-883f-2d9b52e74e45.png)
 
-[![CircleCI](https://dl.circleci.com/status-badge/img/gh/ArangoDB-Community/python-arango/tree/main.svg?style=svg)](https://dl.circleci.com/status-badge/redirect/gh/ArangoDB-Community/python-arango/tree/main)
-[![CodeQL](https://github.com/ArangoDB-Community/python-arango/actions/workflows/codeql.yaml/badge.svg)](https://github.com/ArangoDB-Community/python-arango/actions/workflows/codeql.yaml)
-[![Docs](https://github.com/ArangoDB-Community/python-arango/actions/workflows/docs.yaml/badge.svg)](https://github.com/ArangoDB-Community/python-arango/actions/workflows/docs.yaml)
-[![Coverage Status](https://codecov.io/gh/ArangoDB-Community/python-arango/branch/main/graph/badge.svg?token=M8zrjrzsUY)](https://codecov.io/gh/ArangoDB-Community/python-arango)
-[![Last commit](https://img.shields.io/github/last-commit/ArangoDB-Community/python-arango)](https://github.com/ArangoDB-Community/python-arango/commits/master)
+[![CircleCI](https://dl.circleci.com/status-badge/img/gh/arangodb/python-arango/tree/main.svg?style=svg)](https://dl.circleci.com/status-badge/redirect/gh/arangodb/python-arango/tree/main)
+[![CodeQL](https://github.com/arangodb/python-arango/actions/workflows/codeql.yaml/badge.svg)](https://github.com/arangodb/python-arango/actions/workflows/codeql.yaml)
+[![Docs](https://github.com/arangodb/python-arango/actions/workflows/docs.yaml/badge.svg)](https://github.com/arangodb/python-arango/actions/workflows/docs.yaml)
+[![Coverage Status](https://codecov.io/gh/arangodb/python-arango/branch/main/graph/badge.svg?token=M8zrjrzsUY)](https://codecov.io/gh/arangodb/python-arango)
+[![Last commit](https://img.shields.io/github/last-commit/arangodb/python-arango)](https://github.com/arangodb/python-arango/commits/master)
 
 [![PyPI version badge](https://img.shields.io/pypi/v/python-arango?color=3775A9&style=for-the-badge&logo=pypi&logoColor=FFD43B)](https://pypi.org/project/python-arango/)
 [![Python versions badge](https://img.shields.io/badge/3.8%2B-3776AB?style=for-the-badge&logo=python&logoColor=FFD43B&label=Python)](https://pypi.org/project/python-arango/)
 
-[![License](https://img.shields.io/github/license/ArangoDB-Community/python-arango?color=9E2165&style=for-the-badge)](https://github.com/ArangoDB-Community/python-arango/blob/master/LICENSE)
+[![License](https://img.shields.io/github/license/arangodb/python-arango?color=9E2165&style=for-the-badge)](https://github.com/arangodb/python-arango/blob/master/LICENSE)
 [![Code style: black](https://img.shields.io/static/v1?style=for-the-badge&label=code%20style&message=black&color=black)](https://github.com/psf/black)
 [![Downloads](https://img.shields.io/pepy/dt/python-arango?style=for-the-badge&color=282661
 )](https://pepy.tech/project/python-arango)
 
 # Python-Arango
 
 Python driver for [ArangoDB](https://www.arangodb.com), a scalable multi-model
 database natively supporting documents, graphs and search.
 
 ## Requirements
 
-- ArangoDB version 3.9+
+- ArangoDB version 3.11+
 - Python version 3.8+
 
 ## Installation
 
 ```shell
 pip install python-arango --upgrade
 ```
@@ -115,16 +115,16 @@
 
 # Connect to "test" database as root user.
 db = client.db("test", username="root", password="passwd")
 
 # Create a new collection named "students".
 students = db.create_collection("students")
 
-# Add a hash index to the collection.
-students.add_hash_index(fields=["name"], unique=True)
+# Add a persistent index to the collection.
+students.add_index({'type': 'persistent', 'fields': ['name'], 'unique': True})
 
 # Insert new documents into the collection.
 students.insert({"name": "jane", "age": 39})
 students.insert({"name": "josh", "age": 18})
 students.insert({"name": "judy", "age": 21})
 
 # Execute an AQL query and iterate through the result cursor.
@@ -176,16 +176,17 @@
 edges.insert({"_from": "students/01", "_to": "lectures/MAT101"})
 edges.insert({"_from": "students/01", "_to": "lectures/STA101"})
 edges.insert({"_from": "students/01", "_to": "lectures/CSC101"})
 edges.insert({"_from": "students/02", "_to": "lectures/MAT101"})
 edges.insert({"_from": "students/02", "_to": "lectures/STA101"})
 edges.insert({"_from": "students/03", "_to": "lectures/CSC101"})
 
-# Traverse the graph in outbound direction, breadth-first.
-result = graph.traverse(
-    start_vertex="students/01",
-    direction="outbound",
-    strategy="breadthfirst"
-)
+# Traverse the graph in outbound direction, breath-first.
+query = """
+    FOR v, e, p IN 1..3 OUTBOUND 'students/01' GRAPH 'school'
+    OPTIONS { bfs: true, uniqueVertices: 'global' }
+    RETURN {vertex: v, edge: e, path: p}
+    """
+cursor = db.aql.execute(query)
 ```
 
 Please see the [documentation](https://docs.python-arango.com) for more details.
```

### Comparing `python-arango-7.9.1/python_arango.egg-info/SOURCES.txt` & `python_arango-8.0.0/python_arango.egg-info/SOURCES.txt`

 * *Files 1% similar despite different names*

```diff
@@ -48,14 +48,15 @@
 docs/async.rst
 docs/auth.rst
 docs/backup.rst
 docs/batch.rst
 docs/certificates.rst
 docs/cluster.rst
 docs/collection.rst
+docs/compression.rst
 docs/conf.py
 docs/contributing.rst
 docs/cursor.rst
 docs/database.rst
 docs/document.rst
 docs/errno.rst
 docs/errors.rst
```

### Comparing `python-arango-7.9.1/starter.sh` & `python_arango-8.0.0/starter.sh`

 * *Files 6% similar despite different names*

```diff
@@ -28,19 +28,20 @@
 elif [ "$license" == "enterprise" ]; then
     image_name="enterprise"
 else
     echo "Invalid argument. Please provide either 'community' or 'enterprise'."
     exit 1
 fi
 
-conf_file=""
-if [[ "${version%.*}" == "3.10" ]]; then
-    conf_file="${setup}-3.10"
+if [ "$version" == "latest" ]; then
+    conf_file="${setup}-3.12"
+elif [[ "$version" == *.*.* ]]; then
+    conf_file="${setup}-${version%.*}"
 else
-    conf_file="${setup}"
+    conf_file="${setup}-${version}"
 fi
 
 docker run -d \
   --name arango \
   -p 8528:8528 \
   -p 8529:8529 \
   $extra_ports \
```

