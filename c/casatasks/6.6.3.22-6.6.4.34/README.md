# Comparing `tmp/casatasks-6.6.3.22-py3-none-any.whl.zip` & `tmp/casatasks-6.6.4.34-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,425 +1,426 @@
-Zip file size: 1828863 bytes, number of entries: 423
--rw-r--r--  2.0 unx    25454 b- defN 24-Jan-17 15:12 casatasks/LICENSE.txt
--rw-r--r--  2.0 unx    16293 b- defN 24-Jan-17 15:26 casatasks/__init__.py
--rw-r--r--  2.0 unx      113 b- defN 24-Jan-17 15:12 casatasks/__main__.py
--rw-r--r--  2.0 unx    17968 b- defN 24-Jan-17 15:26 casatasks/accor.py
--rw-r--r--  2.0 unx    23332 b- defN 24-Jan-17 15:26 casatasks/apparentsens.py
--rw-r--r--  2.0 unx    16748 b- defN 24-Jan-17 15:26 casatasks/applycal.py
--rw-r--r--  2.0 unx     2321 b- defN 24-Jan-17 15:26 casatasks/asdmsummary.py
--rw-r--r--  2.0 unx    24748 b- defN 24-Jan-17 15:26 casatasks/bandpass.py
--rw-r--r--  2.0 unx    16533 b- defN 24-Jan-17 15:26 casatasks/blcal.py
--rw-r--r--  2.0 unx     3218 b- defN 24-Jan-17 15:26 casatasks/calstat.py
--rw-r--r--  2.0 unx     5159 b- defN 24-Jan-17 15:26 casatasks/clearcal.py
--rw-r--r--  2.0 unx     1810 b- defN 24-Jan-17 15:26 casatasks/clearstat.py
--rw-r--r--  2.0 unx     9828 b- defN 24-Jan-17 15:26 casatasks/concat.py
--rw-r--r--  2.0 unx      508 b- defN 24-Jan-17 15:12 casatasks/config.py
--rw-r--r--  2.0 unx     2974 b- defN 24-Jan-17 15:26 casatasks/conjugatevis.py
--rw-r--r--  2.0 unx    16406 b- defN 24-Jan-17 15:26 casatasks/cvel.py
--rw-r--r--  2.0 unx    22234 b- defN 24-Jan-17 15:26 casatasks/cvel2.py
--rw-r--r--  2.0 unx    41733 b- defN 24-Jan-17 15:26 casatasks/deconvolve.py
--rw-r--r--  2.0 unx     3220 b- defN 24-Jan-17 15:26 casatasks/defintent.py
--rw-r--r--  2.0 unx     3647 b- defN 24-Jan-17 15:26 casatasks/delmod.py
--rw-r--r--  2.0 unx     5523 b- defN 24-Jan-17 15:26 casatasks/exportasdm.py
--rw-r--r--  2.0 unx     5227 b- defN 24-Jan-17 15:26 casatasks/exportfits.py
--rw-r--r--  2.0 unx    10973 b- defN 24-Jan-17 15:26 casatasks/exportuvfits.py
--rw-r--r--  2.0 unx     4550 b- defN 24-Jan-17 15:26 casatasks/feather.py
--rw-r--r--  2.0 unx     5573 b- defN 24-Jan-17 15:26 casatasks/fixplanets.py
--rw-r--r--  2.0 unx     6244 b- defN 24-Jan-17 15:26 casatasks/fixvis.py
--rw-r--r--  2.0 unx    15005 b- defN 24-Jan-17 15:26 casatasks/flagcmd.py
--rw-r--r--  2.0 unx    81550 b- defN 24-Jan-17 15:26 casatasks/flagdata.py
--rw-r--r--  2.0 unx     4961 b- defN 24-Jan-17 15:26 casatasks/flagmanager.py
--rw-r--r--  2.0 unx    11512 b- defN 24-Jan-17 15:26 casatasks/fluxscale.py
--rw-r--r--  2.0 unx    16061 b- defN 24-Jan-17 15:26 casatasks/fringefit.py
--rw-r--r--  2.0 unx     6119 b- defN 24-Jan-17 15:26 casatasks/ft.py
--rw-r--r--  2.0 unx    26164 b- defN 24-Jan-17 15:26 casatasks/gaincal.py
--rw-r--r--  2.0 unx    14448 b- defN 24-Jan-17 15:26 casatasks/gencal.py
--rw-r--r--  2.0 unx     5524 b- defN 24-Jan-17 15:26 casatasks/getcalmodvla.py
--rw-r--r--  2.0 unx     6935 b- defN 24-Jan-17 15:26 casatasks/getephemtable.py
--rw-r--r--  2.0 unx    13082 b- defN 24-Jan-17 15:26 casatasks/hanningsmooth.py
--rw-r--r--  2.0 unx     8648 b- defN 24-Jan-17 15:26 casatasks/imbaseline.py
--rw-r--r--  2.0 unx     7157 b- defN 24-Jan-17 15:26 casatasks/imcollapse.py
--rw-r--r--  2.0 unx     4496 b- defN 24-Jan-17 15:26 casatasks/imcontsub.py
--rw-r--r--  2.0 unx    11906 b- defN 24-Jan-17 15:26 casatasks/imdev.py
--rw-r--r--  2.0 unx    26784 b- defN 24-Jan-17 15:26 casatasks/imfit.py
--rw-r--r--  2.0 unx     6823 b- defN 24-Jan-17 15:26 casatasks/imhead.py
--rw-r--r--  2.0 unx     3920 b- defN 24-Jan-17 15:26 casatasks/imhistory.py
--rw-r--r--  2.0 unx    17125 b- defN 24-Jan-17 15:26 casatasks/immath.py
--rw-r--r--  2.0 unx     8676 b- defN 24-Jan-17 15:26 casatasks/immoments.py
--rw-r--r--  2.0 unx     6462 b- defN 24-Jan-17 15:26 casatasks/impbcor.py
--rw-r--r--  2.0 unx     3240 b- defN 24-Jan-17 15:26 casatasks/importasap.py
--rw-r--r--  2.0 unx    22205 b- defN 24-Jan-17 15:26 casatasks/importasdm.py
--rw-r--r--  2.0 unx     6301 b- defN 24-Jan-17 15:26 casatasks/importatca.py
--rw-r--r--  2.0 unx     5502 b- defN 24-Jan-17 15:26 casatasks/importfits.py
--rw-r--r--  2.0 unx     4500 b- defN 24-Jan-17 15:26 casatasks/importfitsidi.py
--rw-r--r--  2.0 unx     2893 b- defN 24-Jan-17 15:26 casatasks/importgmrt.py
--rw-r--r--  2.0 unx     4845 b- defN 24-Jan-17 15:26 casatasks/importmiriad.py
--rw-r--r--  2.0 unx     3223 b- defN 24-Jan-17 15:26 casatasks/importnro.py
--rw-r--r--  2.0 unx     3264 b- defN 24-Jan-17 15:26 casatasks/importuvfits.py
--rw-r--r--  2.0 unx     7707 b- defN 24-Jan-17 15:26 casatasks/importvla.py
--rw-r--r--  2.0 unx    14346 b- defN 24-Jan-17 15:26 casatasks/impv.py
--rw-r--r--  2.0 unx     7955 b- defN 24-Jan-17 15:26 casatasks/imrebin.py
--rw-r--r--  2.0 unx     3652 b- defN 24-Jan-17 15:26 casatasks/imreframe.py
--rw-r--r--  2.0 unx    23379 b- defN 24-Jan-17 15:26 casatasks/imregrid.py
--rw-r--r--  2.0 unx    13825 b- defN 24-Jan-17 15:26 casatasks/imsmooth.py
--rw-r--r--  2.0 unx    23313 b- defN 24-Jan-17 15:26 casatasks/imstat.py
--rw-r--r--  2.0 unx     7940 b- defN 24-Jan-17 15:26 casatasks/imsubimage.py
--rw-r--r--  2.0 unx     5072 b- defN 24-Jan-17 15:26 casatasks/imtrans.py
--rw-r--r--  2.0 unx     7072 b- defN 24-Jan-17 15:26 casatasks/imval.py
--rw-r--r--  2.0 unx     7647 b- defN 24-Jan-17 15:26 casatasks/initweights.py
--rw-r--r--  2.0 unx    15729 b- defN 24-Jan-17 15:26 casatasks/listcal.py
--rw-r--r--  2.0 unx     2119 b- defN 24-Jan-17 15:26 casatasks/listfits.py
--rw-r--r--  2.0 unx     2146 b- defN 24-Jan-17 15:26 casatasks/listhistory.py
--rw-r--r--  2.0 unx    11666 b- defN 24-Jan-17 15:26 casatasks/listobs.py
--rw-r--r--  2.0 unx     4996 b- defN 24-Jan-17 15:26 casatasks/listpartition.py
--rw-r--r--  2.0 unx     3038 b- defN 24-Jan-17 15:26 casatasks/listsdm.py
--rw-r--r--  2.0 unx    12941 b- defN 24-Jan-17 15:26 casatasks/listvis.py
--rw-r--r--  2.0 unx    14202 b- defN 24-Jan-17 15:26 casatasks/makemask.py
--rw-r--r--  2.0 unx    43072 b- defN 24-Jan-17 15:26 casatasks/mstransform.py
--rw-r--r--  2.0 unx     9665 b- defN 24-Jan-17 15:26 casatasks/msuvbin.py
--rw-r--r--  2.0 unx     5732 b- defN 24-Jan-17 15:26 casatasks/nrobeamaverage.py
--rw-r--r--  2.0 unx    17491 b- defN 24-Jan-17 15:26 casatasks/partition.py
--rw-r--r--  2.0 unx     8285 b- defN 24-Jan-17 15:26 casatasks/phaseshift.py
--rw-r--r--  2.0 unx     5125 b- defN 24-Jan-17 15:26 casatasks/plotants.py
--rw-r--r--  2.0 unx    21488 b- defN 24-Jan-17 15:26 casatasks/plotbandpass.py
--rw-r--r--  2.0 unx     9852 b- defN 24-Jan-17 15:26 casatasks/plotprofilemap.py
--rw-r--r--  2.0 unx     3426 b- defN 24-Jan-17 15:26 casatasks/plotweather.py
--rw-r--r--  2.0 unx    19753 b- defN 24-Jan-17 15:26 casatasks/polcal.py
--rw-r--r--  2.0 unx     2939 b- defN 24-Jan-17 15:26 casatasks/polfromgain.py
--rw-r--r--  2.0 unx     7751 b- defN 24-Jan-17 15:26 casatasks/predictcomp.py
--rw-r--r--  2.0 unx     3498 b- defN 24-Jan-17 15:26 casatasks/rerefant.py
--rw-r--r--  2.0 unx     9112 b- defN 24-Jan-17 15:26 casatasks/rmfit.py
--rw-r--r--  2.0 unx     2150 b- defN 24-Jan-17 15:26 casatasks/rmtables.py
--rw-r--r--  2.0 unx    21991 b- defN 24-Jan-17 15:26 casatasks/sdatmcor.py
--rw-r--r--  2.0 unx    31250 b- defN 24-Jan-17 15:26 casatasks/sdbaseline.py
--rw-r--r--  2.0 unx    19333 b- defN 24-Jan-17 15:26 casatasks/sdcal.py
--rw-r--r--  2.0 unx    14417 b- defN 24-Jan-17 15:26 casatasks/sdfit.py
--rw-r--r--  2.0 unx     8916 b- defN 24-Jan-17 15:26 casatasks/sdfixscan.py
--rw-r--r--  2.0 unx    11865 b- defN 24-Jan-17 15:26 casatasks/sdgaincal.py
--rw-r--r--  2.0 unx    26023 b- defN 24-Jan-17 15:26 casatasks/sdimaging.py
--rw-r--r--  2.0 unx   137389 b- defN 24-Jan-17 15:26 casatasks/sdintimaging.py
--rw-r--r--  2.0 unx     7142 b- defN 24-Jan-17 15:26 casatasks/sdpolaverage.py
--rw-r--r--  2.0 unx     6005 b- defN 24-Jan-17 15:26 casatasks/sdsidebandsplit.py
--rw-r--r--  2.0 unx     8198 b- defN 24-Jan-17 15:26 casatasks/sdsmooth.py
--rw-r--r--  2.0 unx     6695 b- defN 24-Jan-17 15:26 casatasks/sdtimeaverage.py
--rw-r--r--  2.0 unx    25528 b- defN 24-Jan-17 15:26 casatasks/setjy.py
--rw-r--r--  2.0 unx    17825 b- defN 24-Jan-17 15:26 casatasks/simalma.py
--rw-r--r--  2.0 unx    18119 b- defN 24-Jan-17 15:26 casatasks/simanalyze.py
--rw-r--r--  2.0 unx    24900 b- defN 24-Jan-17 15:26 casatasks/simobserve.py
--rw-r--r--  2.0 unx     7914 b- defN 24-Jan-17 15:26 casatasks/slsearch.py
--rw-r--r--  2.0 unx     4158 b- defN 24-Jan-17 15:26 casatasks/smoothcal.py
--rw-r--r--  2.0 unx    45036 b- defN 24-Jan-17 15:26 casatasks/specfit.py
--rw-r--r--  2.0 unx     8346 b- defN 24-Jan-17 15:26 casatasks/specflux.py
--rw-r--r--  2.0 unx    12698 b- defN 24-Jan-17 15:26 casatasks/specsmooth.py
--rw-r--r--  2.0 unx     2668 b- defN 24-Jan-17 15:26 casatasks/splattotable.py
--rw-r--r--  2.0 unx    17789 b- defN 24-Jan-17 15:26 casatasks/split.py
--rw-r--r--  2.0 unx    20825 b- defN 24-Jan-17 15:26 casatasks/spxfit.py
--rw-r--r--  2.0 unx    19586 b- defN 24-Jan-17 15:26 casatasks/statwt.py
--rw-r--r--  2.0 unx   156502 b- defN 24-Jan-17 15:26 casatasks/tclean.py
--rw-r--r--  2.0 unx     4525 b- defN 24-Jan-17 15:26 casatasks/testconcat.py
--rw-r--r--  2.0 unx    28544 b- defN 24-Jan-17 15:26 casatasks/tsdimaging.py
--rw-r--r--  2.0 unx    12446 b- defN 24-Jan-17 15:26 casatasks/uvcontsub.py
--rw-r--r--  2.0 unx     8459 b- defN 24-Jan-17 15:26 casatasks/uvcontsub_old.py
--rw-r--r--  2.0 unx     8868 b- defN 24-Jan-17 15:26 casatasks/uvmodelfit.py
--rw-r--r--  2.0 unx     3274 b- defN 24-Jan-17 15:26 casatasks/uvsub.py
--rw-r--r--  2.0 unx     7919 b- defN 24-Jan-17 15:26 casatasks/virtualconcat.py
--rw-r--r--  2.0 unx     4604 b- defN 24-Jan-17 15:26 casatasks/vishead.py
--rw-r--r--  2.0 unx    13732 b- defN 24-Jan-17 15:26 casatasks/visstat.py
--rw-r--r--  2.0 unx    11196 b- defN 24-Jan-17 15:26 casatasks/widebandpbcor.py
--rw-r--r--  2.0 unx    19110 b- defN 24-Jan-17 15:12 casatasks/__xml__/accor.xml
--rw-r--r--  2.0 unx    24415 b- defN 24-Jan-17 15:12 casatasks/__xml__/apparentsens.xml
--rw-r--r--  2.0 unx    18506 b- defN 24-Jan-17 15:12 casatasks/__xml__/applycal.xml
--rw-r--r--  2.0 unx     1212 b- defN 24-Jan-17 15:12 casatasks/__xml__/asdmsummary.xml
--rw-r--r--  2.0 unx    27442 b- defN 24-Jan-17 15:12 casatasks/__xml__/bandpass.xml
--rw-r--r--  2.0 unx    17253 b- defN 24-Jan-17 15:12 casatasks/__xml__/blcal.xml
--rw-r--r--  2.0 unx     3102 b- defN 24-Jan-17 15:12 casatasks/__xml__/calstat.xml
--rw-r--r--  2.0 unx     4500 b- defN 24-Jan-17 15:12 casatasks/__xml__/clearcal.xml
--rw-r--r--  2.0 unx      908 b- defN 24-Jan-17 15:12 casatasks/__xml__/clearstat.xml
--rw-r--r--  2.0 unx     7682 b- defN 24-Jan-17 15:12 casatasks/__xml__/concat.xml
--rw-r--r--  2.0 unx     1872 b- defN 24-Jan-17 15:12 casatasks/__xml__/conjugatevis.xml
--rw-r--r--  2.0 unx    22439 b- defN 24-Jan-17 15:12 casatasks/__xml__/cvel.xml
--rw-r--r--  2.0 unx    24548 b- defN 24-Jan-17 15:12 casatasks/__xml__/cvel2.xml
--rw-r--r--  2.0 unx    45787 b- defN 24-Jan-17 15:12 casatasks/__xml__/deconvolve.xml
--rw-r--r--  2.0 unx     2324 b- defN 24-Jan-17 15:12 casatasks/__xml__/defintent.xml
--rw-r--r--  2.0 unx     3230 b- defN 24-Jan-17 15:12 casatasks/__xml__/delmod.xml
--rw-r--r--  2.0 unx     4256 b- defN 24-Jan-17 15:12 casatasks/__xml__/exportasdm.xml
--rw-r--r--  2.0 unx     4677 b- defN 24-Jan-17 15:12 casatasks/__xml__/exportfits.xml
--rw-r--r--  2.0 unx    10459 b- defN 24-Jan-17 15:12 casatasks/__xml__/exportuvfits.xml
--rw-r--r--  2.0 unx     3473 b- defN 24-Jan-17 15:12 casatasks/__xml__/feather.xml
--rw-r--r--  2.0 unx     4855 b- defN 24-Jan-17 15:12 casatasks/__xml__/fixplanets.xml
--rw-r--r--  2.0 unx     5552 b- defN 24-Jan-17 15:12 casatasks/__xml__/fixvis.xml
--rw-r--r--  2.0 unx    18382 b- defN 24-Jan-17 15:12 casatasks/__xml__/flagcmd.xml
--rw-r--r--  2.0 unx    95087 b- defN 24-Jan-17 15:12 casatasks/__xml__/flagdata.xml
--rw-r--r--  2.0 unx     6491 b- defN 24-Jan-17 15:12 casatasks/__xml__/flagmanager.xml
--rw-r--r--  2.0 unx    10724 b- defN 24-Jan-17 15:12 casatasks/__xml__/fluxscale.xml
--rw-r--r--  2.0 unx    16831 b- defN 24-Jan-17 15:12 casatasks/__xml__/fringefit.xml
--rw-r--r--  2.0 unx     5634 b- defN 24-Jan-17 15:12 casatasks/__xml__/ft.xml
--rw-r--r--  2.0 unx    27911 b- defN 24-Jan-17 15:12 casatasks/__xml__/gaincal.xml
--rw-r--r--  2.0 unx    13559 b- defN 24-Jan-17 15:12 casatasks/__xml__/gencal.xml
--rw-r--r--  2.0 unx     6003 b- defN 24-Jan-17 15:12 casatasks/__xml__/getcalmodvla.xml
--rw-r--r--  2.0 unx     5989 b- defN 24-Jan-17 15:12 casatasks/__xml__/getephemtable.xml
--rw-r--r--  2.0 unx    11212 b- defN 24-Jan-17 15:12 casatasks/__xml__/hanningsmooth.xml
--rw-r--r--  2.0 unx    13796 b- defN 24-Jan-17 15:12 casatasks/__xml__/imbaseline.xml
--rw-r--r--  2.0 unx     7612 b- defN 24-Jan-17 15:12 casatasks/__xml__/imcollapse.xml
--rw-r--r--  2.0 unx     3670 b- defN 24-Jan-17 15:12 casatasks/__xml__/imcontsub.xml
--rw-r--r--  2.0 unx    13467 b- defN 24-Jan-17 15:12 casatasks/__xml__/imdev.xml
--rw-r--r--  2.0 unx    27822 b- defN 24-Jan-17 15:12 casatasks/__xml__/imfit.xml
--rw-r--r--  2.0 unx     7692 b- defN 24-Jan-17 15:12 casatasks/__xml__/imhead.xml
--rw-r--r--  2.0 unx     3780 b- defN 24-Jan-17 15:12 casatasks/__xml__/imhistory.xml
--rw-r--r--  2.0 unx    19823 b- defN 24-Jan-17 15:12 casatasks/__xml__/immath.xml
--rw-r--r--  2.0 unx     9230 b- defN 24-Jan-17 15:12 casatasks/__xml__/immoments.xml
--rw-r--r--  2.0 unx     6746 b- defN 24-Jan-17 15:12 casatasks/__xml__/impbcor.xml
--rw-r--r--  2.0 unx     2305 b- defN 24-Jan-17 15:12 casatasks/__xml__/importasap.xml
--rw-r--r--  2.0 unx    20912 b- defN 24-Jan-17 15:12 casatasks/__xml__/importasdm.xml
--rw-r--r--  2.0 unx     5824 b- defN 24-Jan-17 15:12 casatasks/__xml__/importatca.xml
--rw-r--r--  2.0 unx     4453 b- defN 24-Jan-17 15:12 casatasks/__xml__/importfits.xml
--rw-r--r--  2.0 unx     3325 b- defN 24-Jan-17 15:12 casatasks/__xml__/importfitsidi.xml
--rw-r--r--  2.0 unx     1879 b- defN 24-Jan-17 15:12 casatasks/__xml__/importgmrt.xml
--rw-r--r--  2.0 unx     4639 b- defN 24-Jan-17 15:12 casatasks/__xml__/importmiriad.xml
--rw-r--r--  2.0 unx     2155 b- defN 24-Jan-17 15:12 casatasks/__xml__/importnro.xml
--rw-r--r--  2.0 unx     2519 b- defN 24-Jan-17 15:12 casatasks/__xml__/importuvfits.xml
--rw-r--r--  2.0 unx     7348 b- defN 24-Jan-17 15:12 casatasks/__xml__/importvla.xml
--rw-r--r--  2.0 unx    16810 b- defN 24-Jan-17 15:12 casatasks/__xml__/impv.xml
--rw-r--r--  2.0 unx     7929 b- defN 24-Jan-17 15:12 casatasks/__xml__/imrebin.xml
--rw-r--r--  2.0 unx     3944 b- defN 24-Jan-17 15:12 casatasks/__xml__/imreframe.xml
--rw-r--r--  2.0 unx    23404 b- defN 24-Jan-17 15:12 casatasks/__xml__/imregrid.xml
--rw-r--r--  2.0 unx    18483 b- defN 24-Jan-17 15:12 casatasks/__xml__/imsmooth.xml
--rw-r--r--  2.0 unx    27026 b- defN 24-Jan-17 15:12 casatasks/__xml__/imstat.xml
--rw-r--r--  2.0 unx     8616 b- defN 24-Jan-17 15:12 casatasks/__xml__/imsubimage.xml
--rw-r--r--  2.0 unx     4369 b- defN 24-Jan-17 15:12 casatasks/__xml__/imtrans.xml
--rw-r--r--  2.0 unx     8783 b- defN 24-Jan-17 15:12 casatasks/__xml__/imval.xml
--rw-r--r--  2.0 unx     8420 b- defN 24-Jan-17 15:12 casatasks/__xml__/initweights.xml
--rw-r--r--  2.0 unx    14649 b- defN 24-Jan-17 15:12 casatasks/__xml__/listcal.xml
--rw-r--r--  2.0 unx     1052 b- defN 24-Jan-17 15:12 casatasks/__xml__/listfits.xml
--rw-r--r--  2.0 unx     1109 b- defN 24-Jan-17 15:12 casatasks/__xml__/listhistory.xml
--rw-r--r--  2.0 unx    14584 b- defN 24-Jan-17 15:12 casatasks/__xml__/listobs.xml
--rw-r--r--  2.0 unx     4504 b- defN 24-Jan-17 15:12 casatasks/__xml__/listpartition.xml
--rw-r--r--  2.0 unx     2034 b- defN 24-Jan-17 15:12 casatasks/__xml__/listsdm.xml
--rw-r--r--  2.0 unx    14008 b- defN 24-Jan-17 15:12 casatasks/__xml__/listvis.xml
--rw-r--r--  2.0 unx    15589 b- defN 24-Jan-17 15:12 casatasks/__xml__/makemask.xml
--rw-r--r--  2.0 unx    52552 b- defN 24-Jan-17 15:12 casatasks/__xml__/mstransform.xml
--rw-r--r--  2.0 unx     9632 b- defN 24-Jan-17 15:12 casatasks/__xml__/msuvbin.xml
--rw-r--r--  2.0 unx     5399 b- defN 24-Jan-17 15:12 casatasks/__xml__/nrobeamaverage.xml
--rw-r--r--  2.0 unx    18609 b- defN 24-Jan-17 15:12 casatasks/__xml__/partition.xml
--rw-r--r--  2.0 unx     8196 b- defN 24-Jan-17 15:12 casatasks/__xml__/phaseshift.xml
--rw-r--r--  2.0 unx     4535 b- defN 24-Jan-17 15:12 casatasks/__xml__/plotants.xml
--rw-r--r--  2.0 unx    25797 b- defN 24-Jan-17 15:12 casatasks/__xml__/plotbandpass.xml
--rw-r--r--  2.0 unx    10498 b- defN 24-Jan-17 15:12 casatasks/__xml__/plotprofilemap.xml
--rw-r--r--  2.0 unx     2117 b- defN 24-Jan-17 15:12 casatasks/__xml__/plotweather.xml
--rw-r--r--  2.0 unx    24515 b- defN 24-Jan-17 15:12 casatasks/__xml__/polcal.xml
--rw-r--r--  2.0 unx     2217 b- defN 24-Jan-17 15:12 casatasks/__xml__/polfromgain.xml
--rw-r--r--  2.0 unx     8056 b- defN 24-Jan-17 15:12 casatasks/__xml__/predictcomp.xml
--rw-r--r--  2.0 unx     3130 b- defN 24-Jan-17 15:12 casatasks/__xml__/rerefant.xml
--rw-r--r--  2.0 unx     8856 b- defN 24-Jan-17 15:12 casatasks/__xml__/rmfit.xml
--rw-r--r--  2.0 unx     1092 b- defN 24-Jan-17 15:12 casatasks/__xml__/rmtables.xml
--rw-r--r--  2.0 unx    22215 b- defN 24-Jan-17 15:12 casatasks/__xml__/sdatmcor.xml
--rw-r--r--  2.0 unx    39080 b- defN 24-Jan-17 15:12 casatasks/__xml__/sdbaseline.xml
--rw-r--r--  2.0 unx    24856 b- defN 24-Jan-17 15:12 casatasks/__xml__/sdcal.xml
--rw-r--r--  2.0 unx    16689 b- defN 24-Jan-17 15:12 casatasks/__xml__/sdfit.xml
--rw-r--r--  2.0 unx     9510 b- defN 24-Jan-17 15:12 casatasks/__xml__/sdfixscan.xml
--rw-r--r--  2.0 unx    13345 b- defN 24-Jan-17 15:12 casatasks/__xml__/sdgaincal.xml
--rw-r--r--  2.0 unx    34312 b- defN 24-Jan-17 15:12 casatasks/__xml__/sdimaging.xml
--rw-r--r--  2.0 unx   137940 b- defN 24-Jan-17 15:12 casatasks/__xml__/sdintimaging.xml
--rw-r--r--  2.0 unx     6997 b- defN 24-Jan-17 15:12 casatasks/__xml__/sdpolaverage.xml
--rw-r--r--  2.0 unx     5486 b- defN 24-Jan-17 15:12 casatasks/__xml__/sdsidebandsplit.xml
--rw-r--r--  2.0 unx     8750 b- defN 24-Jan-17 15:12 casatasks/__xml__/sdsmooth.xml
--rw-r--r--  2.0 unx     6558 b- defN 24-Jan-17 15:12 casatasks/__xml__/sdtimeaverage.xml
--rw-r--r--  2.0 unx    29486 b- defN 24-Jan-17 15:12 casatasks/__xml__/setjy.xml
--rw-r--r--  2.0 unx    21078 b- defN 24-Jan-17 15:12 casatasks/__xml__/simalma.xml
--rw-r--r--  2.0 unx    20059 b- defN 24-Jan-17 15:12 casatasks/__xml__/simanalyze.xml
--rw-r--r--  2.0 unx    27983 b- defN 24-Jan-17 15:12 casatasks/__xml__/simobserve.xml
--rw-r--r--  2.0 unx     8822 b- defN 24-Jan-17 15:12 casatasks/__xml__/slsearch.xml
--rw-r--r--  2.0 unx     3703 b- defN 24-Jan-17 15:12 casatasks/__xml__/smoothcal.xml
--rw-r--r--  2.0 unx    50753 b- defN 24-Jan-17 15:12 casatasks/__xml__/specfit.xml
--rw-r--r--  2.0 unx     9280 b- defN 24-Jan-17 15:12 casatasks/__xml__/specflux.xml
--rw-r--r--  2.0 unx    13365 b- defN 24-Jan-17 15:12 casatasks/__xml__/specsmooth.xml
--rw-r--r--  2.0 unx     1665 b- defN 24-Jan-17 15:12 casatasks/__xml__/splattotable.xml
--rw-r--r--  2.0 unx    16305 b- defN 24-Jan-17 15:12 casatasks/__xml__/split.xml
--rw-r--r--  2.0 unx    23161 b- defN 24-Jan-17 15:12 casatasks/__xml__/spxfit.xml
--rw-r--r--  2.0 unx    25373 b- defN 24-Jan-17 15:12 casatasks/__xml__/statwt.xml
--rw-r--r--  2.0 unx   158742 b- defN 24-Jan-17 15:12 casatasks/__xml__/tclean.xml
--rw-r--r--  2.0 unx     3036 b- defN 24-Jan-17 15:12 casatasks/__xml__/testconcat.xml
--rw-r--r--  2.0 unx    37942 b- defN 24-Jan-17 15:12 casatasks/__xml__/tsdimaging.xml
--rw-r--r--  2.0 unx    11503 b- defN 24-Jan-17 15:12 casatasks/__xml__/uvcontsub.xml
--rw-r--r--  2.0 unx     9142 b- defN 24-Jan-17 15:12 casatasks/__xml__/uvcontsub_old.xml
--rw-r--r--  2.0 unx     9466 b- defN 24-Jan-17 15:12 casatasks/__xml__/uvmodelfit.xml
--rw-r--r--  2.0 unx     2617 b- defN 24-Jan-17 15:12 casatasks/__xml__/uvsub.xml
--rw-r--r--  2.0 unx     7100 b- defN 24-Jan-17 15:12 casatasks/__xml__/virtualconcat.xml
--rw-r--r--  2.0 unx     7282 b- defN 24-Jan-17 15:12 casatasks/__xml__/vishead.xml
--rw-r--r--  2.0 unx    18657 b- defN 24-Jan-17 15:12 casatasks/__xml__/visstat.xml
--rw-r--r--  2.0 unx    12321 b- defN 24-Jan-17 15:12 casatasks/__xml__/widebandpbcor.xml
--rw-r--r--  2.0 unx    46388 b- defN 24-Jan-17 15:12 casatasks/private/JPLephem_reader2.py
--rw-r--r--  2.0 unx     1162 b- defN 24-Jan-17 15:12 casatasks/private/callabletask.py
--rw-r--r--  2.0 unx    14227 b- defN 24-Jan-17 15:12 casatasks/private/callibrary.py
--rw-r--r--  2.0 unx      239 b- defN 24-Jan-17 15:12 casatasks/private/casa_transition.py
--rw-r--r--  2.0 unx    14657 b- defN 24-Jan-17 15:12 casatasks/private/casaxmlutil.py
--rw-r--r--  2.0 unx   157097 b- defN 24-Jan-17 15:12 casatasks/private/cleanhelper.py
--rw-r--r--  2.0 unx    13276 b- defN 24-Jan-17 15:12 casatasks/private/concatephem.py
--rw-r--r--  2.0 unx     8093 b- defN 24-Jan-17 15:12 casatasks/private/convertephem.py
--rw-r--r--  2.0 unx     2677 b- defN 24-Jan-17 15:12 casatasks/private/correct_ant_posns.py
--rw-r--r--  2.0 unx    26457 b- defN 24-Jan-17 15:12 casatasks/private/correct_ant_posns_alma.py
--rw-r--r--  2.0 unx     8909 b- defN 24-Jan-17 15:12 casatasks/private/correct_ant_posns_evla.py
--rw-r--r--  2.0 unx      235 b- defN 24-Jan-17 15:12 casatasks/private/cvt.py
--rw-r--r--  2.0 unx   157940 b- defN 24-Jan-17 15:12 casatasks/private/flaghelper.py
--rw-r--r--  2.0 unx     4083 b- defN 24-Jan-17 15:12 casatasks/private/ialib.py
--rw-r--r--  2.0 unx     1445 b- defN 24-Jan-17 15:12 casatasks/private/imtools.py
--rw-r--r--  2.0 unx    33735 b- defN 24-Jan-17 15:12 casatasks/private/jplhorizons_query.py
--rw-r--r--  2.0 unx    28074 b- defN 24-Jan-17 15:12 casatasks/private/jyperk.py
--rw-r--r--  2.0 unx    15085 b- defN 24-Jan-17 15:12 casatasks/private/mslisthelper.py
--rw-r--r--  2.0 unx     3997 b- defN 24-Jan-17 15:12 casatasks/private/mstools.py
--rw-r--r--  2.0 unx    47244 b- defN 24-Jan-17 15:12 casatasks/private/partitionhelper.py
--rw-r--r--  2.0 unx     3874 b- defN 24-Jan-17 15:12 casatasks/private/predictcomp_helper.py
--rw-r--r--  2.0 unx    34733 b- defN 24-Jan-17 15:12 casatasks/private/sdbeamutil.py
--rw-r--r--  2.0 unx    37380 b- defN 24-Jan-17 15:12 casatasks/private/sdint_helper.py
--rw-r--r--  2.0 unx    29985 b- defN 24-Jan-17 15:12 casatasks/private/sdutil.py
--rw-r--r--  2.0 unx    39120 b- defN 24-Jan-17 15:12 casatasks/private/setjy_helper.py
--rw-r--r--  2.0 unx   158147 b- defN 24-Jan-17 15:12 casatasks/private/simutil.py
--rw-r--r--  2.0 unx    30058 b- defN 24-Jan-17 15:12 casatasks/private/solar_system_setjy.py
--rw-r--r--  2.0 unx     5196 b- defN 24-Jan-17 15:12 casatasks/private/task_accor.py
--rw-r--r--  2.0 unx     2815 b- defN 24-Jan-17 15:12 casatasks/private/task_apparentsens.py
--rw-r--r--  2.0 unx     8689 b- defN 24-Jan-17 15:12 casatasks/private/task_applycal.py
--rw-r--r--  2.0 unx      655 b- defN 24-Jan-17 15:12 casatasks/private/task_asdmsummary.py
--rw-r--r--  2.0 unx     6690 b- defN 24-Jan-17 15:12 casatasks/private/task_bandpass.py
--rw-r--r--  2.0 unx     4516 b- defN 24-Jan-17 15:12 casatasks/private/task_blcal.py
--rw-r--r--  2.0 unx     2545 b- defN 24-Jan-17 15:12 casatasks/private/task_calstat.py
--rw-r--r--  2.0 unx     2444 b- defN 24-Jan-17 15:12 casatasks/private/task_clearcal.py
--rw-r--r--  2.0 unx      400 b- defN 24-Jan-17 15:12 casatasks/private/task_clearstat.py
--rw-r--r--  2.0 unx    24590 b- defN 24-Jan-17 15:12 casatasks/private/task_concat.py
--rw-r--r--  2.0 unx     4476 b- defN 24-Jan-17 15:12 casatasks/private/task_conjugatevis.py
--rw-r--r--  2.0 unx    26240 b- defN 24-Jan-17 15:12 casatasks/private/task_cvel.py
--rw-r--r--  2.0 unx     4820 b- defN 24-Jan-17 15:12 casatasks/private/task_cvel2.py
--rw-r--r--  2.0 unx    12952 b- defN 24-Jan-17 15:12 casatasks/private/task_deconvolve.py
--rw-r--r--  2.0 unx     7916 b- defN 24-Jan-17 15:12 casatasks/private/task_defintent.py
--rw-r--r--  2.0 unx     1926 b- defN 24-Jan-17 15:12 casatasks/private/task_delmod.py
--rw-r--r--  2.0 unx    10251 b- defN 24-Jan-17 15:12 casatasks/private/task_exportasdm.py
--rw-r--r--  2.0 unx     2476 b- defN 24-Jan-17 15:12 casatasks/private/task_exportfits.py
--rw-r--r--  2.0 unx     1073 b- defN 24-Jan-17 15:12 casatasks/private/task_exportuvfits.py
--rw-r--r--  2.0 unx     1928 b- defN 24-Jan-17 15:12 casatasks/private/task_feather.py
--rw-r--r--  2.0 unx    24616 b- defN 24-Jan-17 15:12 casatasks/private/task_fixplanets.py
--rw-r--r--  2.0 unx    22449 b- defN 24-Jan-17 15:12 casatasks/private/task_fixvis.py
--rw-r--r--  2.0 unx    68570 b- defN 24-Jan-17 15:12 casatasks/private/task_flagcmd.py
--rw-r--r--  2.0 unx    30925 b- defN 24-Jan-17 15:12 casatasks/private/task_flagdata.py
--rw-r--r--  2.0 unx     5127 b- defN 24-Jan-17 15:12 casatasks/private/task_flagmanager.py
--rw-r--r--  2.0 unx    10752 b- defN 24-Jan-17 15:12 casatasks/private/task_fluxscale.py
--rw-r--r--  2.0 unx     5833 b- defN 24-Jan-17 15:12 casatasks/private/task_fringefit.py
--rw-r--r--  2.0 unx     6598 b- defN 24-Jan-17 15:12 casatasks/private/task_ft.py
--rw-r--r--  2.0 unx     8273 b- defN 24-Jan-17 15:12 casatasks/private/task_gaincal.py
--rw-r--r--  2.0 unx     9241 b- defN 24-Jan-17 15:12 casatasks/private/task_gencal.py
--rw-r--r--  2.0 unx    12010 b- defN 24-Jan-17 15:12 casatasks/private/task_getcalmodvla.py
--rw-r--r--  2.0 unx     4400 b- defN 24-Jan-17 15:12 casatasks/private/task_getephemtable.py
--rw-r--r--  2.0 unx     3917 b- defN 24-Jan-17 15:12 casatasks/private/task_hanningsmooth.py
--rw-r--r--  2.0 unx   113942 b- defN 24-Jan-17 15:12 casatasks/private/task_imbaseline.py
--rw-r--r--  2.0 unx     3917 b- defN 24-Jan-17 15:12 casatasks/private/task_imcollapse.py
--rw-r--r--  2.0 unx     3170 b- defN 24-Jan-17 15:12 casatasks/private/task_imcontsub.py
--rw-r--r--  2.0 unx     1960 b- defN 24-Jan-17 15:12 casatasks/private/task_imdev.py
--rw-r--r--  2.0 unx     2007 b- defN 24-Jan-17 15:12 casatasks/private/task_imfit.py
--rw-r--r--  2.0 unx     5505 b- defN 24-Jan-17 15:12 casatasks/private/task_imhead.py
--rw-r--r--  2.0 unx      693 b- defN 24-Jan-17 15:12 casatasks/private/task_imhistory.py
--rw-r--r--  2.0 unx    24322 b- defN 24-Jan-17 15:12 casatasks/private/task_immath.py
--rw-r--r--  2.0 unx     6718 b- defN 24-Jan-17 15:12 casatasks/private/task_immoments.py
--rw-r--r--  2.0 unx     3692 b- defN 24-Jan-17 15:12 casatasks/private/task_impbcor.py
--rw-r--r--  2.0 unx     2655 b- defN 24-Jan-17 15:12 casatasks/private/task_importasap.py
--rw-r--r--  2.0 unx    25554 b- defN 24-Jan-17 15:12 casatasks/private/task_importasdm.py
--rw-r--r--  2.0 unx     4090 b- defN 24-Jan-17 15:12 casatasks/private/task_importatca.py
--rw-r--r--  2.0 unx     9482 b- defN 24-Jan-17 15:12 casatasks/private/task_importfits.py
--rw-r--r--  2.0 unx     7537 b- defN 24-Jan-17 15:12 casatasks/private/task_importfitsidi.py
--rw-r--r--  2.0 unx    15107 b- defN 24-Jan-17 15:12 casatasks/private/task_importgmrt.py
--rw-r--r--  2.0 unx     2867 b- defN 24-Jan-17 15:12 casatasks/private/task_importmiriad.py
--rw-r--r--  2.0 unx     2166 b- defN 24-Jan-17 15:12 casatasks/private/task_importnro.py
--rw-r--r--  2.0 unx     2028 b- defN 24-Jan-17 15:12 casatasks/private/task_importuvfits.py
--rw-r--r--  2.0 unx     3142 b- defN 24-Jan-17 15:12 casatasks/private/task_importvla.py
--rw-r--r--  2.0 unx     2540 b- defN 24-Jan-17 15:12 casatasks/private/task_impv.py
--rw-r--r--  2.0 unx     2506 b- defN 24-Jan-17 15:12 casatasks/private/task_imrebin.py
--rw-r--r--  2.0 unx     2814 b- defN 24-Jan-17 15:12 casatasks/private/task_imreframe.py
--rw-r--r--  2.0 unx    14755 b- defN 24-Jan-17 15:12 casatasks/private/task_imregrid.py
--rw-r--r--  2.0 unx     7833 b- defN 24-Jan-17 15:12 casatasks/private/task_imsmooth.py
--rw-r--r--  2.0 unx     1289 b- defN 24-Jan-17 15:12 casatasks/private/task_imstat.py
--rw-r--r--  2.0 unx     2134 b- defN 24-Jan-17 15:12 casatasks/private/task_imsubimage.py
--rw-r--r--  2.0 unx     3321 b- defN 24-Jan-17 15:12 casatasks/private/task_imtrans.py
--rw-r--r--  2.0 unx    14494 b- defN 24-Jan-17 15:12 casatasks/private/task_imval.py
--rw-r--r--  2.0 unx     3365 b- defN 24-Jan-17 15:12 casatasks/private/task_initweights.py
--rw-r--r--  2.0 unx      984 b- defN 24-Jan-17 15:12 casatasks/private/task_listcal.py
--rw-r--r--  2.0 unx      475 b- defN 24-Jan-17 15:12 casatasks/private/task_listfits.py
--rw-r--r--  2.0 unx      627 b- defN 24-Jan-17 15:12 casatasks/private/task_listhistory.py
--rw-r--r--  2.0 unx     1970 b- defN 24-Jan-17 15:12 casatasks/private/task_listobs.py
--rw-r--r--  2.0 unx     5500 b- defN 24-Jan-17 15:12 casatasks/private/task_listpartition.py
--rw-r--r--  2.0 unx    17255 b- defN 24-Jan-17 15:12 casatasks/private/task_listsdm.py
--rw-r--r--  2.0 unx     1039 b- defN 24-Jan-17 15:12 casatasks/private/task_listvis.py
--rw-r--r--  2.0 unx     1089 b- defN 24-Jan-17 15:12 casatasks/private/task_logging.py
--rw-r--r--  2.0 unx    60731 b- defN 24-Jan-17 15:12 casatasks/private/task_makemask.py
--rw-r--r--  2.0 unx    16477 b- defN 24-Jan-17 15:12 casatasks/private/task_mstransform.py
--rw-r--r--  2.0 unx     4082 b- defN 24-Jan-17 15:12 casatasks/private/task_msuvbin.py
--rw-r--r--  2.0 unx     4002 b- defN 24-Jan-17 15:12 casatasks/private/task_nrobeamaverage.py
--rw-r--r--  2.0 unx     6449 b- defN 24-Jan-17 15:12 casatasks/private/task_partition.py
--rw-r--r--  2.0 unx     6456 b- defN 24-Jan-17 15:12 casatasks/private/task_phaseshift.py
--rw-r--r--  2.0 unx    15846 b- defN 24-Jan-17 15:12 casatasks/private/task_plotants.py
--rw-r--r--  2.0 unx   439545 b- defN 24-Jan-17 15:12 casatasks/private/task_plotbandpass.py
--rw-r--r--  2.0 unx    34563 b- defN 24-Jan-17 15:12 casatasks/private/task_plotprofilemap.py
--rw-r--r--  2.0 unx    13018 b- defN 24-Jan-17 15:12 casatasks/private/task_plotweather.py
--rw-r--r--  2.0 unx     4877 b- defN 24-Jan-17 15:12 casatasks/private/task_polcal.py
--rw-r--r--  2.0 unx     8698 b- defN 24-Jan-17 15:12 casatasks/private/task_polfromgain.py
--rw-r--r--  2.0 unx     8658 b- defN 24-Jan-17 15:12 casatasks/private/task_predictcomp.py
--rw-r--r--  2.0 unx     1261 b- defN 24-Jan-17 15:12 casatasks/private/task_rerefant.py
--rw-r--r--  2.0 unx     2306 b- defN 24-Jan-17 15:12 casatasks/private/task_rmfit.py
--rw-r--r--  2.0 unx      794 b- defN 24-Jan-17 15:12 casatasks/private/task_rmtables.py
--rw-r--r--  2.0 unx    24543 b- defN 24-Jan-17 15:12 casatasks/private/task_sdatmcor.py
--rw-r--r--  2.0 unx    21408 b- defN 24-Jan-17 15:12 casatasks/private/task_sdbaseline.py
--rw-r--r--  2.0 unx    10888 b- defN 24-Jan-17 15:12 casatasks/private/task_sdcal.py
--rw-r--r--  2.0 unx     5655 b- defN 24-Jan-17 15:12 casatasks/private/task_sdfit.py
--rw-r--r--  2.0 unx    26481 b- defN 24-Jan-17 15:12 casatasks/private/task_sdfixscan.py
--rw-r--r--  2.0 unx     4759 b- defN 24-Jan-17 15:12 casatasks/private/task_sdgaincal.py
--rw-r--r--  2.0 unx    55674 b- defN 24-Jan-17 15:12 casatasks/private/task_sdimaging.py
--rw-r--r--  2.0 unx    37776 b- defN 24-Jan-17 15:12 casatasks/private/task_sdintimaging.py
--rw-r--r--  2.0 unx     1684 b- defN 24-Jan-17 15:12 casatasks/private/task_sdpolaverage.py
--rw-r--r--  2.0 unx      905 b- defN 24-Jan-17 15:12 casatasks/private/task_sdsidebandsplit.py
--rw-r--r--  2.0 unx     1479 b- defN 24-Jan-17 15:12 casatasks/private/task_sdsmooth.py
--rw-r--r--  2.0 unx     4103 b- defN 24-Jan-17 15:12 casatasks/private/task_sdtimeaverage.py
--rw-r--r--  2.0 unx    30826 b- defN 24-Jan-17 15:12 casatasks/private/task_setjy.py
--rw-r--r--  2.0 unx    81824 b- defN 24-Jan-17 15:12 casatasks/private/task_simalma.py
--rw-r--r--  2.0 unx    54741 b- defN 24-Jan-17 15:12 casatasks/private/task_simanalyze.py
--rw-r--r--  2.0 unx    65699 b- defN 24-Jan-17 15:12 casatasks/private/task_simobserve.py
--rw-r--r--  2.0 unx     3181 b- defN 24-Jan-17 15:12 casatasks/private/task_slsearch.py
--rw-r--r--  2.0 unx     1734 b- defN 24-Jan-17 15:12 casatasks/private/task_smoothcal.py
--rw-r--r--  2.0 unx     4948 b- defN 24-Jan-17 15:12 casatasks/private/task_specfit.py
--rw-r--r--  2.0 unx     8526 b- defN 24-Jan-17 15:12 casatasks/private/task_specflux.py
--rw-r--r--  2.0 unx     1772 b- defN 24-Jan-17 15:12 casatasks/private/task_specsmooth.py
--rw-r--r--  2.0 unx     2748 b- defN 24-Jan-17 15:12 casatasks/private/task_splattotable.py
--rw-r--r--  2.0 unx     9910 b- defN 24-Jan-17 15:12 casatasks/private/task_split.py
--rw-r--r--  2.0 unx     4500 b- defN 24-Jan-17 15:12 casatasks/private/task_spxfit.py
--rw-r--r--  2.0 unx     2827 b- defN 24-Jan-17 15:12 casatasks/private/task_statwt.py
--rw-r--r--  2.0 unx    19746 b- defN 24-Jan-17 15:12 casatasks/private/task_tclean.py
--rw-r--r--  2.0 unx     5463 b- defN 24-Jan-17 15:12 casatasks/private/task_testconcat.py
--rw-r--r--  2.0 unx    43213 b- defN 24-Jan-17 15:12 casatasks/private/task_tsdimaging.py
--rw-r--r--  2.0 unx     3059 b- defN 24-Jan-17 15:12 casatasks/private/task_uvcontsub.py
--rw-r--r--  2.0 unx    16768 b- defN 24-Jan-17 15:12 casatasks/private/task_uvcontsub_old.py
--rw-r--r--  2.0 unx     1876 b- defN 24-Jan-17 15:12 casatasks/private/task_uvmodelfit.py
--rw-r--r--  2.0 unx     2170 b- defN 24-Jan-17 15:12 casatasks/private/task_uvsub.py
--rw-r--r--  2.0 unx    17685 b- defN 24-Jan-17 15:12 casatasks/private/task_virtualconcat.py
--rw-r--r--  2.0 unx     5626 b- defN 24-Jan-17 15:12 casatasks/private/task_vishead.py
--rw-r--r--  2.0 unx     3546 b- defN 24-Jan-17 15:12 casatasks/private/task_visstat.py
--rw-r--r--  2.0 unx    20916 b- defN 24-Jan-17 15:12 casatasks/private/task_widebandpbcor.py
--rw-r--r--  2.0 unx    48931 b- defN 24-Jan-17 15:12 casatasks/private/tec_maps.py
--rw-r--r--  2.0 unx    25338 b- defN 24-Jan-17 15:12 casatasks/private/update_spw.py
--rw-r--r--  2.0 unx     3491 b- defN 24-Jan-17 15:12 casatasks/private/userconfig.py
--rw-r--r--  2.0 unx     5829 b- defN 24-Jan-17 15:12 casatasks/private/vishead_util.py
--rw-r--r--  2.0 unx        0 b- defN 24-Jan-17 15:12 casatasks/private/imagerhelpers/__init__.py
--rw-r--r--  2.0 unx    24657 b- defN 24-Jan-17 15:12 casatasks/private/imagerhelpers/_gclean.py
--rw-r--r--  2.0 unx    34617 b- defN 24-Jan-17 15:12 casatasks/private/imagerhelpers/imager_base.py
--rw-r--r--  2.0 unx    13143 b- defN 24-Jan-17 15:12 casatasks/private/imagerhelpers/imager_deconvolver.py
--rw-r--r--  2.0 unx    24198 b- defN 24-Jan-17 15:12 casatasks/private/imagerhelpers/imager_parallel_continuum.py
--rw-r--r--  2.0 unx    18301 b- defN 24-Jan-17 15:12 casatasks/private/imagerhelpers/imager_parallel_cube.py
--rw-r--r--  2.0 unx     4509 b- defN 24-Jan-17 15:12 casatasks/private/imagerhelpers/imager_parallel_deconvolver.py
--rw-r--r--  2.0 unx     9622 b- defN 24-Jan-17 15:12 casatasks/private/imagerhelpers/imager_return_dict.py
--rw-r--r--  2.0 unx    46647 b- defN 24-Jan-17 15:12 casatasks/private/imagerhelpers/input_parameters.py
--rw-r--r--  2.0 unx    10524 b- defN 24-Jan-17 15:12 casatasks/private/imagerhelpers/parallel_imager_helper.py
--rw-r--r--  2.0 unx    14230 b- defN 24-Jan-17 15:12 casatasks/private/imagerhelpers/summary_minor.py
--rw-r--r--  2.0 unx        0 b- defN 24-Jan-17 15:12 casatasks/private/parallel/__init__.py
--rw-r--r--  2.0 unx    65764 b- defN 24-Jan-17 15:12 casatasks/private/parallel/parallel_data_helper.py
--rw-r--r--  2.0 unx    27792 b- defN 24-Jan-17 15:12 casatasks/private/parallel/parallel_task_helper.py
--rw-r--r--  2.0 unx     6422 b- defN 24-Jan-17 15:12 casatasks/private/parallel/rflag_post_proc.py
--rw-r--r--  2.0 unx        0 b- defN 24-Jan-17 15:26 casatasks/tests/__init__.py
--rw-r--r--  2.0 unx    10938 b- defN 24-Jan-17 15:12 casatasks/tests/test_casatasks.py
--rw-r--r--  2.0 unx      664 b- defN 24-Jan-17 15:26 casatasks-6.6.3.22.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 24-Jan-17 15:26 casatasks-6.6.3.22.dist-info/WHEEL
--rw-r--r--  2.0 unx       10 b- defN 24-Jan-17 15:26 casatasks-6.6.3.22.dist-info/top_level.txt
--rw-rw-r--  2.0 unx    36951 b- defN 24-Jan-17 15:26 casatasks-6.6.3.22.dist-info/RECORD
-423 files, 6931214 bytes uncompressed, 1771225 bytes compressed:  74.4%
+Zip file size: 1834853 bytes, number of entries: 424
+-rw-r--r--  2.0 unx    25454 b- defN 24-May-25 15:32 casatasks/LICENSE.txt
+-rw-r--r--  2.0 unx    16440 b- defN 24-May-25 15:52 casatasks/__init__.py
+-rw-r--r--  2.0 unx      113 b- defN 24-May-25 15:32 casatasks/__main__.py
+-rw-r--r--  2.0 unx    17968 b- defN 24-May-25 15:52 casatasks/accor.py
+-rw-r--r--  2.0 unx    23332 b- defN 24-May-25 15:52 casatasks/apparentsens.py
+-rw-r--r--  2.0 unx    16748 b- defN 24-May-25 15:52 casatasks/applycal.py
+-rw-r--r--  2.0 unx     2321 b- defN 24-May-25 15:52 casatasks/asdmsummary.py
+-rw-r--r--  2.0 unx    24747 b- defN 24-May-25 15:52 casatasks/bandpass.py
+-rw-r--r--  2.0 unx    16533 b- defN 24-May-25 15:52 casatasks/blcal.py
+-rw-r--r--  2.0 unx     3218 b- defN 24-May-25 15:52 casatasks/calstat.py
+-rw-r--r--  2.0 unx     5159 b- defN 24-May-25 15:52 casatasks/clearcal.py
+-rw-r--r--  2.0 unx     1810 b- defN 24-May-25 15:52 casatasks/clearstat.py
+-rw-r--r--  2.0 unx     9828 b- defN 24-May-25 15:52 casatasks/concat.py
+-rw-r--r--  2.0 unx     2974 b- defN 24-May-25 15:52 casatasks/conjugatevis.py
+-rw-r--r--  2.0 unx    16406 b- defN 24-May-25 15:52 casatasks/cvel.py
+-rw-r--r--  2.0 unx    22234 b- defN 24-May-25 15:52 casatasks/cvel2.py
+-rw-r--r--  2.0 unx    41733 b- defN 24-May-25 15:52 casatasks/deconvolve.py
+-rw-r--r--  2.0 unx     3220 b- defN 24-May-25 15:52 casatasks/defintent.py
+-rw-r--r--  2.0 unx     3647 b- defN 24-May-25 15:52 casatasks/delmod.py
+-rw-r--r--  2.0 unx     5523 b- defN 24-May-25 15:52 casatasks/exportasdm.py
+-rw-r--r--  2.0 unx     5227 b- defN 24-May-25 15:52 casatasks/exportfits.py
+-rw-r--r--  2.0 unx    10973 b- defN 24-May-25 15:52 casatasks/exportuvfits.py
+-rw-r--r--  2.0 unx     4550 b- defN 24-May-25 15:52 casatasks/feather.py
+-rw-r--r--  2.0 unx     5548 b- defN 24-May-25 15:52 casatasks/fixplanets.py
+-rw-r--r--  2.0 unx     6244 b- defN 24-May-25 15:52 casatasks/fixvis.py
+-rw-r--r--  2.0 unx    15005 b- defN 24-May-25 15:52 casatasks/flagcmd.py
+-rw-r--r--  2.0 unx    81748 b- defN 24-May-25 15:52 casatasks/flagdata.py
+-rw-r--r--  2.0 unx     4961 b- defN 24-May-25 15:52 casatasks/flagmanager.py
+-rw-r--r--  2.0 unx    11512 b- defN 24-May-25 15:52 casatasks/fluxscale.py
+-rw-r--r--  2.0 unx    16061 b- defN 24-May-25 15:52 casatasks/fringefit.py
+-rw-r--r--  2.0 unx     6119 b- defN 24-May-25 15:52 casatasks/ft.py
+-rw-r--r--  2.0 unx    26968 b- defN 24-May-25 15:52 casatasks/gaincal.py
+-rw-r--r--  2.0 unx    14448 b- defN 24-May-25 15:52 casatasks/gencal.py
+-rw-r--r--  2.0 unx     5391 b- defN 24-May-25 15:52 casatasks/getantposalma.py
+-rw-r--r--  2.0 unx     5524 b- defN 24-May-25 15:52 casatasks/getcalmodvla.py
+-rw-r--r--  2.0 unx     6935 b- defN 24-May-25 15:52 casatasks/getephemtable.py
+-rw-r--r--  2.0 unx    13082 b- defN 24-May-25 15:52 casatasks/hanningsmooth.py
+-rw-r--r--  2.0 unx     8648 b- defN 24-May-25 15:52 casatasks/imbaseline.py
+-rw-r--r--  2.0 unx     7157 b- defN 24-May-25 15:52 casatasks/imcollapse.py
+-rw-r--r--  2.0 unx     4496 b- defN 24-May-25 15:52 casatasks/imcontsub.py
+-rw-r--r--  2.0 unx    11906 b- defN 24-May-25 15:52 casatasks/imdev.py
+-rw-r--r--  2.0 unx    26784 b- defN 24-May-25 15:52 casatasks/imfit.py
+-rw-r--r--  2.0 unx     6823 b- defN 24-May-25 15:52 casatasks/imhead.py
+-rw-r--r--  2.0 unx     3920 b- defN 24-May-25 15:52 casatasks/imhistory.py
+-rw-r--r--  2.0 unx    17125 b- defN 24-May-25 15:52 casatasks/immath.py
+-rw-r--r--  2.0 unx     8676 b- defN 24-May-25 15:52 casatasks/immoments.py
+-rw-r--r--  2.0 unx     6462 b- defN 24-May-25 15:52 casatasks/impbcor.py
+-rw-r--r--  2.0 unx     3240 b- defN 24-May-25 15:52 casatasks/importasap.py
+-rw-r--r--  2.0 unx    22205 b- defN 24-May-25 15:52 casatasks/importasdm.py
+-rw-r--r--  2.0 unx     6301 b- defN 24-May-25 15:52 casatasks/importatca.py
+-rw-r--r--  2.0 unx     5502 b- defN 24-May-25 15:52 casatasks/importfits.py
+-rw-r--r--  2.0 unx     4500 b- defN 24-May-25 15:52 casatasks/importfitsidi.py
+-rw-r--r--  2.0 unx     2893 b- defN 24-May-25 15:52 casatasks/importgmrt.py
+-rw-r--r--  2.0 unx     4845 b- defN 24-May-25 15:52 casatasks/importmiriad.py
+-rw-r--r--  2.0 unx     3223 b- defN 24-May-25 15:52 casatasks/importnro.py
+-rw-r--r--  2.0 unx     3264 b- defN 24-May-25 15:52 casatasks/importuvfits.py
+-rw-r--r--  2.0 unx     7707 b- defN 24-May-25 15:52 casatasks/importvla.py
+-rw-r--r--  2.0 unx    14346 b- defN 24-May-25 15:52 casatasks/impv.py
+-rw-r--r--  2.0 unx     7955 b- defN 24-May-25 15:52 casatasks/imrebin.py
+-rw-r--r--  2.0 unx     3652 b- defN 24-May-25 15:52 casatasks/imreframe.py
+-rw-r--r--  2.0 unx    23379 b- defN 24-May-25 15:52 casatasks/imregrid.py
+-rw-r--r--  2.0 unx    13825 b- defN 24-May-25 15:52 casatasks/imsmooth.py
+-rw-r--r--  2.0 unx     6858 b- defN 24-May-25 15:52 casatasks/imstat.py
+-rw-r--r--  2.0 unx     7940 b- defN 24-May-25 15:52 casatasks/imsubimage.py
+-rw-r--r--  2.0 unx     5072 b- defN 24-May-25 15:52 casatasks/imtrans.py
+-rw-r--r--  2.0 unx     7072 b- defN 24-May-25 15:52 casatasks/imval.py
+-rw-r--r--  2.0 unx     7647 b- defN 24-May-25 15:52 casatasks/initweights.py
+-rw-r--r--  2.0 unx    15729 b- defN 24-May-25 15:52 casatasks/listcal.py
+-rw-r--r--  2.0 unx     2119 b- defN 24-May-25 15:52 casatasks/listfits.py
+-rw-r--r--  2.0 unx     2146 b- defN 24-May-25 15:52 casatasks/listhistory.py
+-rw-r--r--  2.0 unx    11666 b- defN 24-May-25 15:52 casatasks/listobs.py
+-rw-r--r--  2.0 unx     4996 b- defN 24-May-25 15:52 casatasks/listpartition.py
+-rw-r--r--  2.0 unx     3038 b- defN 24-May-25 15:52 casatasks/listsdm.py
+-rw-r--r--  2.0 unx    12941 b- defN 24-May-25 15:52 casatasks/listvis.py
+-rw-r--r--  2.0 unx    14202 b- defN 24-May-25 15:52 casatasks/makemask.py
+-rw-r--r--  2.0 unx    43072 b- defN 24-May-25 15:52 casatasks/mstransform.py
+-rw-r--r--  2.0 unx     9665 b- defN 24-May-25 15:52 casatasks/msuvbin.py
+-rw-r--r--  2.0 unx     5732 b- defN 24-May-25 15:52 casatasks/nrobeamaverage.py
+-rw-r--r--  2.0 unx    17491 b- defN 24-May-25 15:52 casatasks/partition.py
+-rw-r--r--  2.0 unx     8285 b- defN 24-May-25 15:52 casatasks/phaseshift.py
+-rw-r--r--  2.0 unx     5125 b- defN 24-May-25 15:52 casatasks/plotants.py
+-rw-r--r--  2.0 unx    21488 b- defN 24-May-25 15:52 casatasks/plotbandpass.py
+-rw-r--r--  2.0 unx     9852 b- defN 24-May-25 15:52 casatasks/plotprofilemap.py
+-rw-r--r--  2.0 unx     3426 b- defN 24-May-25 15:52 casatasks/plotweather.py
+-rw-r--r--  2.0 unx    19753 b- defN 24-May-25 15:52 casatasks/polcal.py
+-rw-r--r--  2.0 unx     3513 b- defN 24-May-25 15:52 casatasks/polfromgain.py
+-rw-r--r--  2.0 unx     7751 b- defN 24-May-25 15:52 casatasks/predictcomp.py
+-rw-r--r--  2.0 unx     3498 b- defN 24-May-25 15:52 casatasks/rerefant.py
+-rw-r--r--  2.0 unx     9112 b- defN 24-May-25 15:52 casatasks/rmfit.py
+-rw-r--r--  2.0 unx     2150 b- defN 24-May-25 15:52 casatasks/rmtables.py
+-rw-r--r--  2.0 unx    21991 b- defN 24-May-25 15:52 casatasks/sdatmcor.py
+-rw-r--r--  2.0 unx    31250 b- defN 24-May-25 15:52 casatasks/sdbaseline.py
+-rw-r--r--  2.0 unx    19333 b- defN 24-May-25 15:52 casatasks/sdcal.py
+-rw-r--r--  2.0 unx    14417 b- defN 24-May-25 15:52 casatasks/sdfit.py
+-rw-r--r--  2.0 unx     8916 b- defN 24-May-25 15:52 casatasks/sdfixscan.py
+-rw-r--r--  2.0 unx    11865 b- defN 24-May-25 15:52 casatasks/sdgaincal.py
+-rw-r--r--  2.0 unx    26023 b- defN 24-May-25 15:52 casatasks/sdimaging.py
+-rw-r--r--  2.0 unx   137389 b- defN 24-May-25 15:52 casatasks/sdintimaging.py
+-rw-r--r--  2.0 unx     7142 b- defN 24-May-25 15:52 casatasks/sdpolaverage.py
+-rw-r--r--  2.0 unx     6005 b- defN 24-May-25 15:52 casatasks/sdsidebandsplit.py
+-rw-r--r--  2.0 unx     8198 b- defN 24-May-25 15:52 casatasks/sdsmooth.py
+-rw-r--r--  2.0 unx     6695 b- defN 24-May-25 15:52 casatasks/sdtimeaverage.py
+-rw-r--r--  2.0 unx    25528 b- defN 24-May-25 15:52 casatasks/setjy.py
+-rw-r--r--  2.0 unx    17825 b- defN 24-May-25 15:52 casatasks/simalma.py
+-rw-r--r--  2.0 unx    18119 b- defN 24-May-25 15:52 casatasks/simanalyze.py
+-rw-r--r--  2.0 unx    25022 b- defN 24-May-25 15:52 casatasks/simobserve.py
+-rw-r--r--  2.0 unx     7914 b- defN 24-May-25 15:52 casatasks/slsearch.py
+-rw-r--r--  2.0 unx     4158 b- defN 24-May-25 15:52 casatasks/smoothcal.py
+-rw-r--r--  2.0 unx    45036 b- defN 24-May-25 15:52 casatasks/specfit.py
+-rw-r--r--  2.0 unx     8346 b- defN 24-May-25 15:52 casatasks/specflux.py
+-rw-r--r--  2.0 unx    12698 b- defN 24-May-25 15:52 casatasks/specsmooth.py
+-rw-r--r--  2.0 unx     2668 b- defN 24-May-25 15:52 casatasks/splattotable.py
+-rw-r--r--  2.0 unx    17789 b- defN 24-May-25 15:52 casatasks/split.py
+-rw-r--r--  2.0 unx    20825 b- defN 24-May-25 15:52 casatasks/spxfit.py
+-rw-r--r--  2.0 unx    19586 b- defN 24-May-25 15:52 casatasks/statwt.py
+-rw-r--r--  2.0 unx   162808 b- defN 24-May-25 15:52 casatasks/tclean.py
+-rw-r--r--  2.0 unx     4525 b- defN 24-May-25 15:52 casatasks/testconcat.py
+-rw-r--r--  2.0 unx    29246 b- defN 24-May-25 15:52 casatasks/tsdimaging.py
+-rw-r--r--  2.0 unx    12446 b- defN 24-May-25 15:52 casatasks/uvcontsub.py
+-rw-r--r--  2.0 unx     8459 b- defN 24-May-25 15:52 casatasks/uvcontsub_old.py
+-rw-r--r--  2.0 unx     8868 b- defN 24-May-25 15:52 casatasks/uvmodelfit.py
+-rw-r--r--  2.0 unx     3274 b- defN 24-May-25 15:52 casatasks/uvsub.py
+-rw-r--r--  2.0 unx     7919 b- defN 24-May-25 15:52 casatasks/virtualconcat.py
+-rw-r--r--  2.0 unx     4604 b- defN 24-May-25 15:52 casatasks/vishead.py
+-rw-r--r--  2.0 unx    13732 b- defN 24-May-25 15:52 casatasks/visstat.py
+-rw-r--r--  2.0 unx    11197 b- defN 24-May-25 15:52 casatasks/widebandpbcor.py
+-rw-r--r--  2.0 unx    19110 b- defN 24-May-25 15:32 casatasks/__xml__/accor.xml
+-rw-r--r--  2.0 unx    24415 b- defN 24-May-25 15:32 casatasks/__xml__/apparentsens.xml
+-rw-r--r--  2.0 unx    18506 b- defN 24-May-25 15:32 casatasks/__xml__/applycal.xml
+-rw-r--r--  2.0 unx     1212 b- defN 24-May-25 15:32 casatasks/__xml__/asdmsummary.xml
+-rw-r--r--  2.0 unx    27441 b- defN 24-May-25 15:32 casatasks/__xml__/bandpass.xml
+-rw-r--r--  2.0 unx    17253 b- defN 24-May-25 15:32 casatasks/__xml__/blcal.xml
+-rw-r--r--  2.0 unx     3102 b- defN 24-May-25 15:32 casatasks/__xml__/calstat.xml
+-rw-r--r--  2.0 unx     4500 b- defN 24-May-25 15:32 casatasks/__xml__/clearcal.xml
+-rw-r--r--  2.0 unx      908 b- defN 24-May-25 15:32 casatasks/__xml__/clearstat.xml
+-rw-r--r--  2.0 unx     7682 b- defN 24-May-25 15:32 casatasks/__xml__/concat.xml
+-rw-r--r--  2.0 unx     1872 b- defN 24-May-25 15:32 casatasks/__xml__/conjugatevis.xml
+-rw-r--r--  2.0 unx    22439 b- defN 24-May-25 15:32 casatasks/__xml__/cvel.xml
+-rw-r--r--  2.0 unx    24548 b- defN 24-May-25 15:32 casatasks/__xml__/cvel2.xml
+-rw-r--r--  2.0 unx    45787 b- defN 24-May-25 15:32 casatasks/__xml__/deconvolve.xml
+-rw-r--r--  2.0 unx     2324 b- defN 24-May-25 15:32 casatasks/__xml__/defintent.xml
+-rw-r--r--  2.0 unx     3230 b- defN 24-May-25 15:32 casatasks/__xml__/delmod.xml
+-rw-r--r--  2.0 unx     4256 b- defN 24-May-25 15:32 casatasks/__xml__/exportasdm.xml
+-rw-r--r--  2.0 unx     4677 b- defN 24-May-25 15:32 casatasks/__xml__/exportfits.xml
+-rw-r--r--  2.0 unx    10459 b- defN 24-May-25 15:32 casatasks/__xml__/exportuvfits.xml
+-rw-r--r--  2.0 unx     3473 b- defN 24-May-25 15:32 casatasks/__xml__/feather.xml
+-rw-r--r--  2.0 unx     4830 b- defN 24-May-25 15:32 casatasks/__xml__/fixplanets.xml
+-rw-r--r--  2.0 unx     5552 b- defN 24-May-25 15:32 casatasks/__xml__/fixvis.xml
+-rw-r--r--  2.0 unx    18382 b- defN 24-May-25 15:32 casatasks/__xml__/flagcmd.xml
+-rw-r--r--  2.0 unx    95277 b- defN 24-May-25 15:32 casatasks/__xml__/flagdata.xml
+-rw-r--r--  2.0 unx     6491 b- defN 24-May-25 15:32 casatasks/__xml__/flagmanager.xml
+-rw-r--r--  2.0 unx    10724 b- defN 24-May-25 15:32 casatasks/__xml__/fluxscale.xml
+-rw-r--r--  2.0 unx    16831 b- defN 24-May-25 15:32 casatasks/__xml__/fringefit.xml
+-rw-r--r--  2.0 unx     5634 b- defN 24-May-25 15:32 casatasks/__xml__/ft.xml
+-rw-r--r--  2.0 unx    28720 b- defN 24-May-25 15:32 casatasks/__xml__/gaincal.xml
+-rw-r--r--  2.0 unx    13559 b- defN 24-May-25 15:32 casatasks/__xml__/gencal.xml
+-rw-r--r--  2.0 unx     4693 b- defN 24-May-25 15:32 casatasks/__xml__/getantposalma.xml
+-rw-r--r--  2.0 unx     6003 b- defN 24-May-25 15:32 casatasks/__xml__/getcalmodvla.xml
+-rw-r--r--  2.0 unx     5989 b- defN 24-May-25 15:32 casatasks/__xml__/getephemtable.xml
+-rw-r--r--  2.0 unx    11212 b- defN 24-May-25 15:32 casatasks/__xml__/hanningsmooth.xml
+-rw-r--r--  2.0 unx    13796 b- defN 24-May-25 15:32 casatasks/__xml__/imbaseline.xml
+-rw-r--r--  2.0 unx     7612 b- defN 24-May-25 15:32 casatasks/__xml__/imcollapse.xml
+-rw-r--r--  2.0 unx     3670 b- defN 24-May-25 15:32 casatasks/__xml__/imcontsub.xml
+-rw-r--r--  2.0 unx    13467 b- defN 24-May-25 15:32 casatasks/__xml__/imdev.xml
+-rw-r--r--  2.0 unx    27822 b- defN 24-May-25 15:32 casatasks/__xml__/imfit.xml
+-rw-r--r--  2.0 unx     7692 b- defN 24-May-25 15:32 casatasks/__xml__/imhead.xml
+-rw-r--r--  2.0 unx     3780 b- defN 24-May-25 15:32 casatasks/__xml__/imhistory.xml
+-rw-r--r--  2.0 unx    19823 b- defN 24-May-25 15:32 casatasks/__xml__/immath.xml
+-rw-r--r--  2.0 unx     9230 b- defN 24-May-25 15:32 casatasks/__xml__/immoments.xml
+-rw-r--r--  2.0 unx     6746 b- defN 24-May-25 15:32 casatasks/__xml__/impbcor.xml
+-rw-r--r--  2.0 unx     2305 b- defN 24-May-25 15:32 casatasks/__xml__/importasap.xml
+-rw-r--r--  2.0 unx    20912 b- defN 24-May-25 15:32 casatasks/__xml__/importasdm.xml
+-rw-r--r--  2.0 unx     5824 b- defN 24-May-25 15:32 casatasks/__xml__/importatca.xml
+-rw-r--r--  2.0 unx     4453 b- defN 24-May-25 15:32 casatasks/__xml__/importfits.xml
+-rw-r--r--  2.0 unx     3325 b- defN 24-May-25 15:32 casatasks/__xml__/importfitsidi.xml
+-rw-r--r--  2.0 unx     1879 b- defN 24-May-25 15:32 casatasks/__xml__/importgmrt.xml
+-rw-r--r--  2.0 unx     4639 b- defN 24-May-25 15:32 casatasks/__xml__/importmiriad.xml
+-rw-r--r--  2.0 unx     2155 b- defN 24-May-25 15:32 casatasks/__xml__/importnro.xml
+-rw-r--r--  2.0 unx     2519 b- defN 24-May-25 15:32 casatasks/__xml__/importuvfits.xml
+-rw-r--r--  2.0 unx     7348 b- defN 24-May-25 15:32 casatasks/__xml__/importvla.xml
+-rw-r--r--  2.0 unx    16810 b- defN 24-May-25 15:32 casatasks/__xml__/impv.xml
+-rw-r--r--  2.0 unx     7929 b- defN 24-May-25 15:32 casatasks/__xml__/imrebin.xml
+-rw-r--r--  2.0 unx     3944 b- defN 24-May-25 15:32 casatasks/__xml__/imreframe.xml
+-rw-r--r--  2.0 unx    23404 b- defN 24-May-25 15:32 casatasks/__xml__/imregrid.xml
+-rw-r--r--  2.0 unx    18483 b- defN 24-May-25 15:32 casatasks/__xml__/imsmooth.xml
+-rw-r--r--  2.0 unx    10189 b- defN 24-May-25 15:32 casatasks/__xml__/imstat.xml
+-rw-r--r--  2.0 unx     8616 b- defN 24-May-25 15:32 casatasks/__xml__/imsubimage.xml
+-rw-r--r--  2.0 unx     4369 b- defN 24-May-25 15:32 casatasks/__xml__/imtrans.xml
+-rw-r--r--  2.0 unx     8783 b- defN 24-May-25 15:32 casatasks/__xml__/imval.xml
+-rw-r--r--  2.0 unx     8420 b- defN 24-May-25 15:32 casatasks/__xml__/initweights.xml
+-rw-r--r--  2.0 unx    14649 b- defN 24-May-25 15:32 casatasks/__xml__/listcal.xml
+-rw-r--r--  2.0 unx     1052 b- defN 24-May-25 15:32 casatasks/__xml__/listfits.xml
+-rw-r--r--  2.0 unx     1109 b- defN 24-May-25 15:32 casatasks/__xml__/listhistory.xml
+-rw-r--r--  2.0 unx    14584 b- defN 24-May-25 15:32 casatasks/__xml__/listobs.xml
+-rw-r--r--  2.0 unx     4504 b- defN 24-May-25 15:32 casatasks/__xml__/listpartition.xml
+-rw-r--r--  2.0 unx     2034 b- defN 24-May-25 15:32 casatasks/__xml__/listsdm.xml
+-rw-r--r--  2.0 unx    14008 b- defN 24-May-25 15:32 casatasks/__xml__/listvis.xml
+-rw-r--r--  2.0 unx    15589 b- defN 24-May-25 15:32 casatasks/__xml__/makemask.xml
+-rw-r--r--  2.0 unx    52552 b- defN 24-May-25 15:32 casatasks/__xml__/mstransform.xml
+-rw-r--r--  2.0 unx     9632 b- defN 24-May-25 15:32 casatasks/__xml__/msuvbin.xml
+-rw-r--r--  2.0 unx     5399 b- defN 24-May-25 15:32 casatasks/__xml__/nrobeamaverage.xml
+-rw-r--r--  2.0 unx    18609 b- defN 24-May-25 15:32 casatasks/__xml__/partition.xml
+-rw-r--r--  2.0 unx     8196 b- defN 24-May-25 15:32 casatasks/__xml__/phaseshift.xml
+-rw-r--r--  2.0 unx     4535 b- defN 24-May-25 15:32 casatasks/__xml__/plotants.xml
+-rw-r--r--  2.0 unx    25797 b- defN 24-May-25 15:32 casatasks/__xml__/plotbandpass.xml
+-rw-r--r--  2.0 unx    10498 b- defN 24-May-25 15:32 casatasks/__xml__/plotprofilemap.xml
+-rw-r--r--  2.0 unx     2117 b- defN 24-May-25 15:32 casatasks/__xml__/plotweather.xml
+-rw-r--r--  2.0 unx    24515 b- defN 24-May-25 15:32 casatasks/__xml__/polcal.xml
+-rw-r--r--  2.0 unx     2756 b- defN 24-May-25 15:32 casatasks/__xml__/polfromgain.xml
+-rw-r--r--  2.0 unx     8056 b- defN 24-May-25 15:32 casatasks/__xml__/predictcomp.xml
+-rw-r--r--  2.0 unx     3130 b- defN 24-May-25 15:32 casatasks/__xml__/rerefant.xml
+-rw-r--r--  2.0 unx     8856 b- defN 24-May-25 15:32 casatasks/__xml__/rmfit.xml
+-rw-r--r--  2.0 unx     1092 b- defN 24-May-25 15:32 casatasks/__xml__/rmtables.xml
+-rw-r--r--  2.0 unx    22215 b- defN 24-May-25 15:32 casatasks/__xml__/sdatmcor.xml
+-rw-r--r--  2.0 unx    39080 b- defN 24-May-25 15:32 casatasks/__xml__/sdbaseline.xml
+-rw-r--r--  2.0 unx    24856 b- defN 24-May-25 15:32 casatasks/__xml__/sdcal.xml
+-rw-r--r--  2.0 unx    16689 b- defN 24-May-25 15:32 casatasks/__xml__/sdfit.xml
+-rw-r--r--  2.0 unx     9510 b- defN 24-May-25 15:32 casatasks/__xml__/sdfixscan.xml
+-rw-r--r--  2.0 unx    13345 b- defN 24-May-25 15:32 casatasks/__xml__/sdgaincal.xml
+-rw-r--r--  2.0 unx    34312 b- defN 24-May-25 15:32 casatasks/__xml__/sdimaging.xml
+-rw-r--r--  2.0 unx   137940 b- defN 24-May-25 15:32 casatasks/__xml__/sdintimaging.xml
+-rw-r--r--  2.0 unx     6997 b- defN 24-May-25 15:32 casatasks/__xml__/sdpolaverage.xml
+-rw-r--r--  2.0 unx     5486 b- defN 24-May-25 15:32 casatasks/__xml__/sdsidebandsplit.xml
+-rw-r--r--  2.0 unx     8750 b- defN 24-May-25 15:32 casatasks/__xml__/sdsmooth.xml
+-rw-r--r--  2.0 unx     6558 b- defN 24-May-25 15:32 casatasks/__xml__/sdtimeaverage.xml
+-rw-r--r--  2.0 unx    29486 b- defN 24-May-25 15:32 casatasks/__xml__/setjy.xml
+-rw-r--r--  2.0 unx    21078 b- defN 24-May-25 15:32 casatasks/__xml__/simalma.xml
+-rw-r--r--  2.0 unx    20059 b- defN 24-May-25 15:32 casatasks/__xml__/simanalyze.xml
+-rw-r--r--  2.0 unx    28064 b- defN 24-May-25 15:32 casatasks/__xml__/simobserve.xml
+-rw-r--r--  2.0 unx     8822 b- defN 24-May-25 15:32 casatasks/__xml__/slsearch.xml
+-rw-r--r--  2.0 unx     3703 b- defN 24-May-25 15:32 casatasks/__xml__/smoothcal.xml
+-rw-r--r--  2.0 unx    50753 b- defN 24-May-25 15:32 casatasks/__xml__/specfit.xml
+-rw-r--r--  2.0 unx     9280 b- defN 24-May-25 15:32 casatasks/__xml__/specflux.xml
+-rw-r--r--  2.0 unx    13365 b- defN 24-May-25 15:32 casatasks/__xml__/specsmooth.xml
+-rw-r--r--  2.0 unx     1665 b- defN 24-May-25 15:32 casatasks/__xml__/splattotable.xml
+-rw-r--r--  2.0 unx    16305 b- defN 24-May-25 15:32 casatasks/__xml__/split.xml
+-rw-r--r--  2.0 unx    23161 b- defN 24-May-25 15:32 casatasks/__xml__/spxfit.xml
+-rw-r--r--  2.0 unx    25373 b- defN 24-May-25 15:32 casatasks/__xml__/statwt.xml
+-rw-r--r--  2.0 unx   165282 b- defN 24-May-25 15:32 casatasks/__xml__/tclean.xml
+-rw-r--r--  2.0 unx     3036 b- defN 24-May-25 15:32 casatasks/__xml__/testconcat.xml
+-rw-r--r--  2.0 unx    39815 b- defN 24-May-25 15:32 casatasks/__xml__/tsdimaging.xml
+-rw-r--r--  2.0 unx    11503 b- defN 24-May-25 15:32 casatasks/__xml__/uvcontsub.xml
+-rw-r--r--  2.0 unx     9142 b- defN 24-May-25 15:32 casatasks/__xml__/uvcontsub_old.xml
+-rw-r--r--  2.0 unx     9466 b- defN 24-May-25 15:32 casatasks/__xml__/uvmodelfit.xml
+-rw-r--r--  2.0 unx     2617 b- defN 24-May-25 15:32 casatasks/__xml__/uvsub.xml
+-rw-r--r--  2.0 unx     7100 b- defN 24-May-25 15:32 casatasks/__xml__/virtualconcat.xml
+-rw-r--r--  2.0 unx     7282 b- defN 24-May-25 15:32 casatasks/__xml__/vishead.xml
+-rw-r--r--  2.0 unx    18657 b- defN 24-May-25 15:32 casatasks/__xml__/visstat.xml
+-rw-r--r--  2.0 unx    12322 b- defN 24-May-25 15:32 casatasks/__xml__/widebandpbcor.xml
+-rw-r--r--  2.0 unx     1162 b- defN 24-May-25 15:32 casatasks/private/callabletask.py
+-rw-r--r--  2.0 unx    14227 b- defN 24-May-25 15:32 casatasks/private/callibrary.py
+-rw-r--r--  2.0 unx      239 b- defN 24-May-25 15:32 casatasks/private/casa_transition.py
+-rw-r--r--  2.0 unx    14657 b- defN 24-May-25 15:32 casatasks/private/casaxmlutil.py
+-rw-r--r--  2.0 unx   157097 b- defN 24-May-25 15:32 casatasks/private/cleanhelper.py
+-rw-r--r--  2.0 unx    13276 b- defN 24-May-25 15:32 casatasks/private/concatephem.py
+-rw-r--r--  2.0 unx     8093 b- defN 24-May-25 15:32 casatasks/private/convertephem.py
+-rw-r--r--  2.0 unx     2677 b- defN 24-May-25 15:32 casatasks/private/correct_ant_posns.py
+-rw-r--r--  2.0 unx    26457 b- defN 24-May-25 15:32 casatasks/private/correct_ant_posns_alma.py
+-rw-r--r--  2.0 unx     8909 b- defN 24-May-25 15:32 casatasks/private/correct_ant_posns_evla.py
+-rw-r--r--  2.0 unx      235 b- defN 24-May-25 15:32 casatasks/private/cvt.py
+-rw-r--r--  2.0 unx   158105 b- defN 24-May-25 15:32 casatasks/private/flaghelper.py
+-rw-r--r--  2.0 unx     4083 b- defN 24-May-25 15:32 casatasks/private/ialib.py
+-rw-r--r--  2.0 unx     1445 b- defN 24-May-25 15:32 casatasks/private/imtools.py
+-rw-r--r--  2.0 unx    34142 b- defN 24-May-25 15:32 casatasks/private/jplhorizons_query.py
+-rw-r--r--  2.0 unx    28074 b- defN 24-May-25 15:32 casatasks/private/jyperk.py
+-rw-r--r--  2.0 unx    15085 b- defN 24-May-25 15:32 casatasks/private/mslisthelper.py
+-rw-r--r--  2.0 unx     3997 b- defN 24-May-25 15:32 casatasks/private/mstools.py
+-rw-r--r--  2.0 unx    47244 b- defN 24-May-25 15:32 casatasks/private/partitionhelper.py
+-rw-r--r--  2.0 unx     3874 b- defN 24-May-25 15:32 casatasks/private/predictcomp_helper.py
+-rw-r--r--  2.0 unx    34733 b- defN 24-May-25 15:32 casatasks/private/sdbeamutil.py
+-rw-r--r--  2.0 unx    39129 b- defN 24-May-25 15:32 casatasks/private/sdint_helper.py
+-rw-r--r--  2.0 unx    30639 b- defN 24-May-25 15:32 casatasks/private/sdutil.py
+-rw-r--r--  2.0 unx    39120 b- defN 24-May-25 15:32 casatasks/private/setjy_helper.py
+-rw-r--r--  2.0 unx   158147 b- defN 24-May-25 15:32 casatasks/private/simutil.py
+-rw-r--r--  2.0 unx    30058 b- defN 24-May-25 15:32 casatasks/private/solar_system_setjy.py
+-rw-r--r--  2.0 unx     5196 b- defN 24-May-25 15:32 casatasks/private/task_accor.py
+-rw-r--r--  2.0 unx     2815 b- defN 24-May-25 15:32 casatasks/private/task_apparentsens.py
+-rw-r--r--  2.0 unx     8689 b- defN 24-May-25 15:32 casatasks/private/task_applycal.py
+-rw-r--r--  2.0 unx      655 b- defN 24-May-25 15:32 casatasks/private/task_asdmsummary.py
+-rw-r--r--  2.0 unx     6690 b- defN 24-May-25 15:32 casatasks/private/task_bandpass.py
+-rw-r--r--  2.0 unx     4516 b- defN 24-May-25 15:32 casatasks/private/task_blcal.py
+-rw-r--r--  2.0 unx     2545 b- defN 24-May-25 15:32 casatasks/private/task_calstat.py
+-rw-r--r--  2.0 unx     2444 b- defN 24-May-25 15:32 casatasks/private/task_clearcal.py
+-rw-r--r--  2.0 unx      400 b- defN 24-May-25 15:32 casatasks/private/task_clearstat.py
+-rw-r--r--  2.0 unx    24590 b- defN 24-May-25 15:32 casatasks/private/task_concat.py
+-rw-r--r--  2.0 unx     4476 b- defN 24-May-25 15:32 casatasks/private/task_conjugatevis.py
+-rw-r--r--  2.0 unx    26240 b- defN 24-May-25 15:32 casatasks/private/task_cvel.py
+-rw-r--r--  2.0 unx     4820 b- defN 24-May-25 15:32 casatasks/private/task_cvel2.py
+-rw-r--r--  2.0 unx    13359 b- defN 24-May-25 15:32 casatasks/private/task_deconvolve.py
+-rw-r--r--  2.0 unx     7916 b- defN 24-May-25 15:32 casatasks/private/task_defintent.py
+-rw-r--r--  2.0 unx     1926 b- defN 24-May-25 15:32 casatasks/private/task_delmod.py
+-rw-r--r--  2.0 unx    10251 b- defN 24-May-25 15:32 casatasks/private/task_exportasdm.py
+-rw-r--r--  2.0 unx     2476 b- defN 24-May-25 15:32 casatasks/private/task_exportfits.py
+-rw-r--r--  2.0 unx     1073 b- defN 24-May-25 15:32 casatasks/private/task_exportuvfits.py
+-rw-r--r--  2.0 unx     1928 b- defN 24-May-25 15:32 casatasks/private/task_feather.py
+-rw-r--r--  2.0 unx    24318 b- defN 24-May-25 15:32 casatasks/private/task_fixplanets.py
+-rw-r--r--  2.0 unx    22449 b- defN 24-May-25 15:32 casatasks/private/task_fixvis.py
+-rw-r--r--  2.0 unx    68570 b- defN 24-May-25 15:32 casatasks/private/task_flagcmd.py
+-rw-r--r--  2.0 unx    30948 b- defN 24-May-25 15:32 casatasks/private/task_flagdata.py
+-rw-r--r--  2.0 unx     5127 b- defN 24-May-25 15:32 casatasks/private/task_flagmanager.py
+-rw-r--r--  2.0 unx    10752 b- defN 24-May-25 15:32 casatasks/private/task_fluxscale.py
+-rw-r--r--  2.0 unx     5833 b- defN 24-May-25 15:32 casatasks/private/task_fringefit.py
+-rw-r--r--  2.0 unx     6598 b- defN 24-May-25 15:32 casatasks/private/task_ft.py
+-rw-r--r--  2.0 unx     8273 b- defN 24-May-25 15:32 casatasks/private/task_gaincal.py
+-rw-r--r--  2.0 unx     9241 b- defN 24-May-25 15:32 casatasks/private/task_gencal.py
+-rw-r--r--  2.0 unx    12056 b- defN 24-May-25 15:32 casatasks/private/task_getantposalma.py
+-rw-r--r--  2.0 unx    12010 b- defN 24-May-25 15:32 casatasks/private/task_getcalmodvla.py
+-rw-r--r--  2.0 unx     4400 b- defN 24-May-25 15:32 casatasks/private/task_getephemtable.py
+-rw-r--r--  2.0 unx     3917 b- defN 24-May-25 15:32 casatasks/private/task_hanningsmooth.py
+-rw-r--r--  2.0 unx   113942 b- defN 24-May-25 15:32 casatasks/private/task_imbaseline.py
+-rw-r--r--  2.0 unx     3917 b- defN 24-May-25 15:32 casatasks/private/task_imcollapse.py
+-rw-r--r--  2.0 unx     3170 b- defN 24-May-25 15:32 casatasks/private/task_imcontsub.py
+-rw-r--r--  2.0 unx     1960 b- defN 24-May-25 15:32 casatasks/private/task_imdev.py
+-rw-r--r--  2.0 unx     2007 b- defN 24-May-25 15:32 casatasks/private/task_imfit.py
+-rw-r--r--  2.0 unx     5505 b- defN 24-May-25 15:32 casatasks/private/task_imhead.py
+-rw-r--r--  2.0 unx      693 b- defN 24-May-25 15:32 casatasks/private/task_imhistory.py
+-rw-r--r--  2.0 unx    24322 b- defN 24-May-25 15:32 casatasks/private/task_immath.py
+-rw-r--r--  2.0 unx     6718 b- defN 24-May-25 15:32 casatasks/private/task_immoments.py
+-rw-r--r--  2.0 unx     3692 b- defN 24-May-25 15:32 casatasks/private/task_impbcor.py
+-rw-r--r--  2.0 unx     2655 b- defN 24-May-25 15:32 casatasks/private/task_importasap.py
+-rw-r--r--  2.0 unx    25554 b- defN 24-May-25 15:32 casatasks/private/task_importasdm.py
+-rw-r--r--  2.0 unx     4090 b- defN 24-May-25 15:32 casatasks/private/task_importatca.py
+-rw-r--r--  2.0 unx     9482 b- defN 24-May-25 15:32 casatasks/private/task_importfits.py
+-rw-r--r--  2.0 unx     7537 b- defN 24-May-25 15:32 casatasks/private/task_importfitsidi.py
+-rw-r--r--  2.0 unx    15107 b- defN 24-May-25 15:32 casatasks/private/task_importgmrt.py
+-rw-r--r--  2.0 unx     2867 b- defN 24-May-25 15:32 casatasks/private/task_importmiriad.py
+-rw-r--r--  2.0 unx     2166 b- defN 24-May-25 15:32 casatasks/private/task_importnro.py
+-rw-r--r--  2.0 unx     2028 b- defN 24-May-25 15:32 casatasks/private/task_importuvfits.py
+-rw-r--r--  2.0 unx     3142 b- defN 24-May-25 15:32 casatasks/private/task_importvla.py
+-rw-r--r--  2.0 unx     2540 b- defN 24-May-25 15:32 casatasks/private/task_impv.py
+-rw-r--r--  2.0 unx     2506 b- defN 24-May-25 15:32 casatasks/private/task_imrebin.py
+-rw-r--r--  2.0 unx     2814 b- defN 24-May-25 15:32 casatasks/private/task_imreframe.py
+-rw-r--r--  2.0 unx    14755 b- defN 24-May-25 15:32 casatasks/private/task_imregrid.py
+-rw-r--r--  2.0 unx     7833 b- defN 24-May-25 15:32 casatasks/private/task_imsmooth.py
+-rw-r--r--  2.0 unx     1289 b- defN 24-May-25 15:32 casatasks/private/task_imstat.py
+-rw-r--r--  2.0 unx     2134 b- defN 24-May-25 15:32 casatasks/private/task_imsubimage.py
+-rw-r--r--  2.0 unx     3321 b- defN 24-May-25 15:32 casatasks/private/task_imtrans.py
+-rw-r--r--  2.0 unx    14494 b- defN 24-May-25 15:32 casatasks/private/task_imval.py
+-rw-r--r--  2.0 unx     3365 b- defN 24-May-25 15:32 casatasks/private/task_initweights.py
+-rw-r--r--  2.0 unx      984 b- defN 24-May-25 15:32 casatasks/private/task_listcal.py
+-rw-r--r--  2.0 unx      475 b- defN 24-May-25 15:32 casatasks/private/task_listfits.py
+-rw-r--r--  2.0 unx      627 b- defN 24-May-25 15:32 casatasks/private/task_listhistory.py
+-rw-r--r--  2.0 unx     1970 b- defN 24-May-25 15:32 casatasks/private/task_listobs.py
+-rw-r--r--  2.0 unx     5500 b- defN 24-May-25 15:32 casatasks/private/task_listpartition.py
+-rw-r--r--  2.0 unx    17255 b- defN 24-May-25 15:32 casatasks/private/task_listsdm.py
+-rw-r--r--  2.0 unx     1039 b- defN 24-May-25 15:32 casatasks/private/task_listvis.py
+-rw-r--r--  2.0 unx     1089 b- defN 24-May-25 15:32 casatasks/private/task_logging.py
+-rw-r--r--  2.0 unx    60731 b- defN 24-May-25 15:32 casatasks/private/task_makemask.py
+-rw-r--r--  2.0 unx    16477 b- defN 24-May-25 15:32 casatasks/private/task_mstransform.py
+-rw-r--r--  2.0 unx     4082 b- defN 24-May-25 15:32 casatasks/private/task_msuvbin.py
+-rw-r--r--  2.0 unx     4002 b- defN 24-May-25 15:32 casatasks/private/task_nrobeamaverage.py
+-rw-r--r--  2.0 unx     6449 b- defN 24-May-25 15:32 casatasks/private/task_partition.py
+-rw-r--r--  2.0 unx     6456 b- defN 24-May-25 15:32 casatasks/private/task_phaseshift.py
+-rw-r--r--  2.0 unx    15846 b- defN 24-May-25 15:32 casatasks/private/task_plotants.py
+-rw-r--r--  2.0 unx   440392 b- defN 24-May-25 15:32 casatasks/private/task_plotbandpass.py
+-rw-r--r--  2.0 unx    34563 b- defN 24-May-25 15:32 casatasks/private/task_plotprofilemap.py
+-rw-r--r--  2.0 unx    13018 b- defN 24-May-25 15:32 casatasks/private/task_plotweather.py
+-rw-r--r--  2.0 unx     4877 b- defN 24-May-25 15:32 casatasks/private/task_polcal.py
+-rw-r--r--  2.0 unx    11653 b- defN 24-May-25 15:32 casatasks/private/task_polfromgain.py
+-rw-r--r--  2.0 unx     8658 b- defN 24-May-25 15:32 casatasks/private/task_predictcomp.py
+-rw-r--r--  2.0 unx     1261 b- defN 24-May-25 15:32 casatasks/private/task_rerefant.py
+-rw-r--r--  2.0 unx     2306 b- defN 24-May-25 15:32 casatasks/private/task_rmfit.py
+-rw-r--r--  2.0 unx      794 b- defN 24-May-25 15:32 casatasks/private/task_rmtables.py
+-rw-r--r--  2.0 unx    24543 b- defN 24-May-25 15:32 casatasks/private/task_sdatmcor.py
+-rw-r--r--  2.0 unx    21408 b- defN 24-May-25 15:32 casatasks/private/task_sdbaseline.py
+-rw-r--r--  2.0 unx    10888 b- defN 24-May-25 15:32 casatasks/private/task_sdcal.py
+-rw-r--r--  2.0 unx     5655 b- defN 24-May-25 15:32 casatasks/private/task_sdfit.py
+-rw-r--r--  2.0 unx    26481 b- defN 24-May-25 15:32 casatasks/private/task_sdfixscan.py
+-rw-r--r--  2.0 unx     4759 b- defN 24-May-25 15:32 casatasks/private/task_sdgaincal.py
+-rw-r--r--  2.0 unx    55674 b- defN 24-May-25 15:32 casatasks/private/task_sdimaging.py
+-rw-r--r--  2.0 unx    37776 b- defN 24-May-25 15:32 casatasks/private/task_sdintimaging.py
+-rw-r--r--  2.0 unx     1684 b- defN 24-May-25 15:32 casatasks/private/task_sdpolaverage.py
+-rw-r--r--  2.0 unx      905 b- defN 24-May-25 15:32 casatasks/private/task_sdsidebandsplit.py
+-rw-r--r--  2.0 unx     1479 b- defN 24-May-25 15:32 casatasks/private/task_sdsmooth.py
+-rw-r--r--  2.0 unx     4103 b- defN 24-May-25 15:32 casatasks/private/task_sdtimeaverage.py
+-rw-r--r--  2.0 unx    30529 b- defN 24-May-25 15:32 casatasks/private/task_setjy.py
+-rw-r--r--  2.0 unx    81824 b- defN 24-May-25 15:32 casatasks/private/task_simalma.py
+-rw-r--r--  2.0 unx    54741 b- defN 24-May-25 15:32 casatasks/private/task_simanalyze.py
+-rw-r--r--  2.0 unx    65699 b- defN 24-May-25 15:32 casatasks/private/task_simobserve.py
+-rw-r--r--  2.0 unx     3181 b- defN 24-May-25 15:32 casatasks/private/task_slsearch.py
+-rw-r--r--  2.0 unx     1734 b- defN 24-May-25 15:32 casatasks/private/task_smoothcal.py
+-rw-r--r--  2.0 unx     4948 b- defN 24-May-25 15:32 casatasks/private/task_specfit.py
+-rw-r--r--  2.0 unx     8526 b- defN 24-May-25 15:32 casatasks/private/task_specflux.py
+-rw-r--r--  2.0 unx     1772 b- defN 24-May-25 15:32 casatasks/private/task_specsmooth.py
+-rw-r--r--  2.0 unx     2748 b- defN 24-May-25 15:32 casatasks/private/task_splattotable.py
+-rw-r--r--  2.0 unx     9910 b- defN 24-May-25 15:32 casatasks/private/task_split.py
+-rw-r--r--  2.0 unx     4500 b- defN 24-May-25 15:32 casatasks/private/task_spxfit.py
+-rw-r--r--  2.0 unx     2827 b- defN 24-May-25 15:32 casatasks/private/task_statwt.py
+-rw-r--r--  2.0 unx    24498 b- defN 24-May-25 15:32 casatasks/private/task_tclean.py
+-rw-r--r--  2.0 unx     5463 b- defN 24-May-25 15:32 casatasks/private/task_testconcat.py
+-rw-r--r--  2.0 unx    44965 b- defN 24-May-25 15:32 casatasks/private/task_tsdimaging.py
+-rw-r--r--  2.0 unx     3059 b- defN 24-May-25 15:32 casatasks/private/task_uvcontsub.py
+-rw-r--r--  2.0 unx    16768 b- defN 24-May-25 15:32 casatasks/private/task_uvcontsub_old.py
+-rw-r--r--  2.0 unx     1876 b- defN 24-May-25 15:32 casatasks/private/task_uvmodelfit.py
+-rw-r--r--  2.0 unx     2170 b- defN 24-May-25 15:32 casatasks/private/task_uvsub.py
+-rw-r--r--  2.0 unx    17685 b- defN 24-May-25 15:32 casatasks/private/task_virtualconcat.py
+-rw-r--r--  2.0 unx     5626 b- defN 24-May-25 15:32 casatasks/private/task_vishead.py
+-rw-r--r--  2.0 unx     3546 b- defN 24-May-25 15:32 casatasks/private/task_visstat.py
+-rw-r--r--  2.0 unx    20916 b- defN 24-May-25 15:32 casatasks/private/task_widebandpbcor.py
+-rw-r--r--  2.0 unx    48931 b- defN 24-May-25 15:32 casatasks/private/tec_maps.py
+-rw-r--r--  2.0 unx    25338 b- defN 24-May-25 15:32 casatasks/private/update_spw.py
+-rw-r--r--  2.0 unx     5829 b- defN 24-May-25 15:32 casatasks/private/vishead_util.py
+-rw-r--r--  2.0 unx        0 b- defN 24-May-25 15:32 casatasks/private/imagerhelpers/__init__.py
+-rw-r--r--  2.0 unx    35295 b- defN 24-May-25 15:32 casatasks/private/imagerhelpers/_gclean.py
+-rw-r--r--  2.0 unx    35134 b- defN 24-May-25 15:32 casatasks/private/imagerhelpers/imager_base.py
+-rw-r--r--  2.0 unx    13143 b- defN 24-May-25 15:32 casatasks/private/imagerhelpers/imager_deconvolver.py
+-rw-r--r--  2.0 unx    45935 b- defN 24-May-25 15:32 casatasks/private/imagerhelpers/imager_mtmfs_via_cube.py
+-rw-r--r--  2.0 unx    24198 b- defN 24-May-25 15:32 casatasks/private/imagerhelpers/imager_parallel_continuum.py
+-rw-r--r--  2.0 unx    18301 b- defN 24-May-25 15:32 casatasks/private/imagerhelpers/imager_parallel_cube.py
+-rw-r--r--  2.0 unx     4509 b- defN 24-May-25 15:32 casatasks/private/imagerhelpers/imager_parallel_deconvolver.py
+-rw-r--r--  2.0 unx    25214 b- defN 24-May-25 15:32 casatasks/private/imagerhelpers/imager_return_dict.py
+-rw-r--r--  2.0 unx    47239 b- defN 24-May-25 15:32 casatasks/private/imagerhelpers/input_parameters.py
+-rw-r--r--  2.0 unx    10524 b- defN 24-May-25 15:32 casatasks/private/imagerhelpers/parallel_imager_helper.py
+-rw-r--r--  2.0 unx    14230 b- defN 24-May-25 15:32 casatasks/private/imagerhelpers/summary_minor.py
+-rw-r--r--  2.0 unx        0 b- defN 24-May-25 15:32 casatasks/private/parallel/__init__.py
+-rw-r--r--  2.0 unx    65764 b- defN 24-May-25 15:32 casatasks/private/parallel/parallel_data_helper.py
+-rw-r--r--  2.0 unx    27792 b- defN 24-May-25 15:32 casatasks/private/parallel/parallel_task_helper.py
+-rw-r--r--  2.0 unx     6422 b- defN 24-May-25 15:32 casatasks/private/parallel/rflag_post_proc.py
+-rw-r--r--  2.0 unx        0 b- defN 24-May-25 15:52 casatasks/tests/__init__.py
+-rw-r--r--  2.0 unx    10938 b- defN 24-May-25 15:32 casatasks/tests/test_casatasks.py
+-rw-r--r--  2.0 unx      664 b- defN 24-May-25 15:52 casatasks-6.6.4.34.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 24-May-25 15:52 casatasks-6.6.4.34.dist-info/WHEEL
+-rw-r--r--  2.0 unx       10 b- defN 24-May-25 15:52 casatasks-6.6.4.34.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx    37080 b- defN 24-May-25 15:52 casatasks-6.6.4.34.dist-info/RECORD
+424 files, 6975029 bytes uncompressed, 1777001 bytes compressed:  74.5%
```

## zipnote {}

```diff
@@ -33,17 +33,14 @@
 
 Filename: casatasks/clearstat.py
 Comment: 
 
 Filename: casatasks/concat.py
 Comment: 
 
-Filename: casatasks/config.py
-Comment: 
-
 Filename: casatasks/conjugatevis.py
 Comment: 
 
 Filename: casatasks/cvel.py
 Comment: 
 
 Filename: casatasks/cvel2.py
@@ -96,14 +93,17 @@
 
 Filename: casatasks/gaincal.py
 Comment: 
 
 Filename: casatasks/gencal.py
 Comment: 
 
+Filename: casatasks/getantposalma.py
+Comment: 
+
 Filename: casatasks/getcalmodvla.py
 Comment: 
 
 Filename: casatasks/getephemtable.py
 Comment: 
 
 Filename: casatasks/hanningsmooth.py
@@ -462,14 +462,17 @@
 
 Filename: casatasks/__xml__/gaincal.xml
 Comment: 
 
 Filename: casatasks/__xml__/gencal.xml
 Comment: 
 
+Filename: casatasks/__xml__/getantposalma.xml
+Comment: 
+
 Filename: casatasks/__xml__/getcalmodvla.xml
 Comment: 
 
 Filename: casatasks/__xml__/getephemtable.xml
 Comment: 
 
 Filename: casatasks/__xml__/hanningsmooth.xml
@@ -738,17 +741,14 @@
 
 Filename: casatasks/__xml__/visstat.xml
 Comment: 
 
 Filename: casatasks/__xml__/widebandpbcor.xml
 Comment: 
 
-Filename: casatasks/private/JPLephem_reader2.py
-Comment: 
-
 Filename: casatasks/private/callabletask.py
 Comment: 
 
 Filename: casatasks/private/callibrary.py
 Comment: 
 
 Filename: casatasks/private/casa_transition.py
@@ -909,14 +909,17 @@
 
 Filename: casatasks/private/task_gaincal.py
 Comment: 
 
 Filename: casatasks/private/task_gencal.py
 Comment: 
 
+Filename: casatasks/private/task_getantposalma.py
+Comment: 
+
 Filename: casatasks/private/task_getcalmodvla.py
 Comment: 
 
 Filename: casatasks/private/task_getephemtable.py
 Comment: 
 
 Filename: casatasks/private/task_hanningsmooth.py
@@ -1194,17 +1197,14 @@
 
 Filename: casatasks/private/tec_maps.py
 Comment: 
 
 Filename: casatasks/private/update_spw.py
 Comment: 
 
-Filename: casatasks/private/userconfig.py
-Comment: 
-
 Filename: casatasks/private/vishead_util.py
 Comment: 
 
 Filename: casatasks/private/imagerhelpers/__init__.py
 Comment: 
 
 Filename: casatasks/private/imagerhelpers/_gclean.py
@@ -1212,14 +1212,17 @@
 
 Filename: casatasks/private/imagerhelpers/imager_base.py
 Comment: 
 
 Filename: casatasks/private/imagerhelpers/imager_deconvolver.py
 Comment: 
 
+Filename: casatasks/private/imagerhelpers/imager_mtmfs_via_cube.py
+Comment: 
+
 Filename: casatasks/private/imagerhelpers/imager_parallel_continuum.py
 Comment: 
 
 Filename: casatasks/private/imagerhelpers/imager_parallel_cube.py
 Comment: 
 
 Filename: casatasks/private/imagerhelpers/imager_parallel_deconvolver.py
@@ -1251,20 +1254,20 @@
 
 Filename: casatasks/tests/__init__.py
 Comment: 
 
 Filename: casatasks/tests/test_casatasks.py
 Comment: 
 
-Filename: casatasks-6.6.3.22.dist-info/METADATA
+Filename: casatasks-6.6.4.34.dist-info/METADATA
 Comment: 
 
-Filename: casatasks-6.6.3.22.dist-info/WHEEL
+Filename: casatasks-6.6.4.34.dist-info/WHEEL
 Comment: 
 
-Filename: casatasks-6.6.3.22.dist-info/top_level.txt
+Filename: casatasks-6.6.4.34.dist-info/top_level.txt
 Comment: 
 
-Filename: casatasks-6.6.3.22.dist-info/RECORD
+Filename: casatasks-6.6.4.34.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## casatasks/__init__.py

```diff
@@ -58,14 +58,15 @@
             'fixplanets',
             'fixvis',
             'phaseshift',
             'fluxscale',
             'ft',
             'gaincal',
             'gencal',
+            'getantposalma',
             'testconcat',
             'apparentsens',
             'getcalmodvla',
             'hanningsmooth',
             'imcollapse',
             'imcontsub',
             'imdev',
@@ -127,15 +128,15 @@
             'sdintimaging',
             'sdpolaverage',
             'sdsidebandsplit',
             'plotprofilemap',
             'imbaseline',
           ]
 
-from . import config
+from casaconfig import config
 casalog = _logsink( config.logfile )
 
 from .imhead import imhead
 from .immoments import immoments
 from .imhistory import imhistory
 from .applycal import applycal
 from .bandpass import bandpass
@@ -185,14 +186,15 @@
 from .fixplanets import fixplanets
 from .fixvis import fixvis
 from .phaseshift import phaseshift
 from .fluxscale import fluxscale
 from .ft import ft
 from .gaincal import gaincal
 from .gencal import gencal
+from .getantposalma import getantposalma
 from .testconcat import testconcat
 from .apparentsens import apparentsens
 from .getcalmodvla import getcalmodvla
 from .hanningsmooth import hanningsmooth
 from .imcollapse import imcollapse
 from .imcontsub import imcontsub
 from .imdev import imdev
@@ -253,19 +255,19 @@
 from .plotbandpass import plotbandpass
 from .sdintimaging import sdintimaging
 from .sdpolaverage import sdpolaverage
 from .sdsidebandsplit import sdsidebandsplit
 from .plotprofilemap import plotprofilemap
 from .imbaseline import imbaseline
 
-def version( ): return [ 6, 6, 3, 22 ]
-def version_string( ): return "6.6.3.22"
+def version( ): return [ 6, 6, 4, 34 ]
+def version_string( ): return "6.6.4.34"
 casalog.setglobal(True)
 
-def xml_interface_defs( ): return { 'imhead': __os.path.join(__cwd,'__xml__/imhead.xml'), 'immoments': __os.path.join(__cwd,'__xml__/immoments.xml'), 'imhistory': __os.path.join(__cwd,'__xml__/imhistory.xml'), 'applycal': __os.path.join(__cwd,'__xml__/applycal.xml'), 'bandpass': __os.path.join(__cwd,'__xml__/bandpass.xml'), 'blcal': __os.path.join(__cwd,'__xml__/blcal.xml'), 'calstat': __os.path.join(__cwd,'__xml__/calstat.xml'), 'defintent': __os.path.join(__cwd,'__xml__/defintent.xml'), 'concat': __os.path.join(__cwd,'__xml__/concat.xml'), 'split': __os.path.join(__cwd,'__xml__/split.xml'), 'listobs': __os.path.join(__cwd,'__xml__/listobs.xml'), 'flagdata': __os.path.join(__cwd,'__xml__/flagdata.xml'), 'flagcmd': __os.path.join(__cwd,'__xml__/flagcmd.xml'), 'getephemtable': __os.path.join(__cwd,'__xml__/getephemtable.xml'), 'setjy': __os.path.join(__cwd,'__xml__/setjy.xml'), 'cvel': __os.path.join(__cwd,'__xml__/cvel.xml'), 'cvel2': __os.path.join(__cwd,'__xml__/cvel2.xml'), 'importuvfits': __os.path.join(__cwd,'__xml__/importuvfits.xml'), 'importfits': __os.path.join(__cwd,'__xml__/importfits.xml'), 'exportfits': __os.path.join(__cwd,'__xml__/exportfits.xml'), 'exportuvfits': __os.path.join(__cwd,'__xml__/exportuvfits.xml'), 'partition': __os.path.join(__cwd,'__xml__/partition.xml'), 'listpartition': __os.path.join(__cwd,'__xml__/listpartition.xml'), 'flagmanager': __os.path.join(__cwd,'__xml__/flagmanager.xml'), 'mstransform': __os.path.join(__cwd,'__xml__/mstransform.xml'), 'msuvbin': __os.path.join(__cwd,'__xml__/msuvbin.xml'), 'tclean': __os.path.join(__cwd,'__xml__/tclean.xml'), 'deconvolve': __os.path.join(__cwd,'__xml__/deconvolve.xml'), 'immath': __os.path.join(__cwd,'__xml__/immath.xml'), 'vishead': __os.path.join(__cwd,'__xml__/vishead.xml'), 'uvsub': __os.path.join(__cwd,'__xml__/uvsub.xml'), 'spxfit': __os.path.join(__cwd,'__xml__/spxfit.xml'), 'splattotable': __os.path.join(__cwd,'__xml__/splattotable.xml'), 'specsmooth': __os.path.join(__cwd,'__xml__/specsmooth.xml'), 'specflux': __os.path.join(__cwd,'__xml__/specflux.xml'), 'smoothcal': __os.path.join(__cwd,'__xml__/smoothcal.xml'), 'specfit': __os.path.join(__cwd,'__xml__/specfit.xml'), 'imstat': __os.path.join(__cwd,'__xml__/imstat.xml'), 'slsearch': __os.path.join(__cwd,'__xml__/slsearch.xml'), 'delmod': __os.path.join(__cwd,'__xml__/delmod.xml'), 'imsubimage': __os.path.join(__cwd,'__xml__/imsubimage.xml'), 'accor': __os.path.join(__cwd,'__xml__/accor.xml'), 'asdmsummary': __os.path.join(__cwd,'__xml__/asdmsummary.xml'), 'clearcal': __os.path.join(__cwd,'__xml__/clearcal.xml'), 'conjugatevis': __os.path.join(__cwd,'__xml__/conjugatevis.xml'), 'exportasdm': __os.path.join(__cwd,'__xml__/exportasdm.xml'), 'importasdm': __os.path.join(__cwd,'__xml__/importasdm.xml'), 'clearstat': __os.path.join(__cwd,'__xml__/clearstat.xml'), 'fixplanets': __os.path.join(__cwd,'__xml__/fixplanets.xml'), 'fixvis': __os.path.join(__cwd,'__xml__/fixvis.xml'), 'phaseshift': __os.path.join(__cwd,'__xml__/phaseshift.xml'), 'fluxscale': __os.path.join(__cwd,'__xml__/fluxscale.xml'), 'ft': __os.path.join(__cwd,'__xml__/ft.xml'), 'gaincal': __os.path.join(__cwd,'__xml__/gaincal.xml'), 'gencal': __os.path.join(__cwd,'__xml__/gencal.xml'), 'testconcat': __os.path.join(__cwd,'__xml__/testconcat.xml'), 'apparentsens': __os.path.join(__cwd,'__xml__/apparentsens.xml'), 'getcalmodvla': __os.path.join(__cwd,'__xml__/getcalmodvla.xml'), 'hanningsmooth': __os.path.join(__cwd,'__xml__/hanningsmooth.xml'), 'imcollapse': __os.path.join(__cwd,'__xml__/imcollapse.xml'), 'imcontsub': __os.path.join(__cwd,'__xml__/imcontsub.xml'), 'imdev': __os.path.join(__cwd,'__xml__/imdev.xml'), 'imfit': __os.path.join(__cwd,'__xml__/imfit.xml'), 'impbcor': __os.path.join(__cwd,'__xml__/impbcor.xml'), 'importasap': __os.path.join(__cwd,'__xml__/importasap.xml'), 'importatca': __os.path.join(__cwd,'__xml__/importatca.xml'), 'importfitsidi': __os.path.join(__cwd,'__xml__/importfitsidi.xml'), 'importgmrt': __os.path.join(__cwd,'__xml__/importgmrt.xml'), 'importnro': __os.path.join(__cwd,'__xml__/importnro.xml'), 'importvla': __os.path.join(__cwd,'__xml__/importvla.xml'), 'impv': __os.path.join(__cwd,'__xml__/impv.xml'), 'imrebin': __os.path.join(__cwd,'__xml__/imrebin.xml'), 'imreframe': __os.path.join(__cwd,'__xml__/imreframe.xml'), 'imregrid': __os.path.join(__cwd,'__xml__/imregrid.xml'), 'imsmooth': __os.path.join(__cwd,'__xml__/imsmooth.xml'), 'imtrans': __os.path.join(__cwd,'__xml__/imtrans.xml'), 'imval': __os.path.join(__cwd,'__xml__/imval.xml'), 'initweights': __os.path.join(__cwd,'__xml__/initweights.xml'), 'listcal': __os.path.join(__cwd,'__xml__/listcal.xml'), 'listfits': __os.path.join(__cwd,'__xml__/listfits.xml'), 'listhistory': __os.path.join(__cwd,'__xml__/listhistory.xml'), 'listsdm': __os.path.join(__cwd,'__xml__/listsdm.xml'), 'listvis': __os.path.join(__cwd,'__xml__/listvis.xml'), 'makemask': __os.path.join(__cwd,'__xml__/makemask.xml'), 'polcal': __os.path.join(__cwd,'__xml__/polcal.xml'), 'polfromgain': __os.path.join(__cwd,'__xml__/polfromgain.xml'), 'predictcomp': __os.path.join(__cwd,'__xml__/predictcomp.xml'), 'rerefant': __os.path.join(__cwd,'__xml__/rerefant.xml'), 'rmfit': __os.path.join(__cwd,'__xml__/rmfit.xml'), 'rmtables': __os.path.join(__cwd,'__xml__/rmtables.xml'), 'sdatmcor': __os.path.join(__cwd,'__xml__/sdatmcor.xml'), 'sdbaseline': __os.path.join(__cwd,'__xml__/sdbaseline.xml'), 'sdcal': __os.path.join(__cwd,'__xml__/sdcal.xml'), 'sdfit': __os.path.join(__cwd,'__xml__/sdfit.xml'), 'sdfixscan': __os.path.join(__cwd,'__xml__/sdfixscan.xml'), 'sdgaincal': __os.path.join(__cwd,'__xml__/sdgaincal.xml'), 'sdimaging': __os.path.join(__cwd,'__xml__/sdimaging.xml'), 'sdsmooth': __os.path.join(__cwd,'__xml__/sdsmooth.xml'), 'tsdimaging': __os.path.join(__cwd,'__xml__/tsdimaging.xml'), 'nrobeamaverage': __os.path.join(__cwd,'__xml__/nrobeamaverage.xml'), 'sdtimeaverage': __os.path.join(__cwd,'__xml__/sdtimeaverage.xml'), 'simanalyze': __os.path.join(__cwd,'__xml__/simalma.xml'), 'simobserve': __os.path.join(__cwd,'__xml__/simobserve.xml'), 'feather': __os.path.join(__cwd,'__xml__/simanalyze.xml'), 'simalma': __os.path.join(__cwd,'__xml__/feather.xml'), 'statwt': __os.path.join(__cwd,'__xml__/statwt.xml'), 'virtualconcat': __os.path.join(__cwd,'__xml__/virtualconcat.xml'), 'uvcontsub_old': __os.path.join(__cwd,'__xml__/uvcontsub_old.xml'), 'uvcontsub': __os.path.join(__cwd,'__xml__/uvcontsub.xml'), 'uvmodelfit': __os.path.join(__cwd,'__xml__/uvmodelfit.xml'), 'visstat': __os.path.join(__cwd,'__xml__/visstat.xml'), 'widebandpbcor': __os.path.join(__cwd,'__xml__/widebandpbcor.xml'), 'importmiriad': __os.path.join(__cwd,'__xml__/importmiriad.xml'), 'plotweather': __os.path.join(__cwd,'__xml__/plotweather.xml'), 'plotants': __os.path.join(__cwd,'__xml__/plotants.xml'), 'fringefit': __os.path.join(__cwd,'__xml__/fringefit.xml'), 'plotbandpass': __os.path.join(__cwd,'__xml__/plotbandpass.xml'), 'sdintimaging': __os.path.join(__cwd,'__xml__/sdintimaging.xml'), 'sdpolaverage': __os.path.join(__cwd,'__xml__/sdpolaverage.xml'), 'sdsidebandsplit': __os.path.join(__cwd,'__xml__/sdsidebandsplit.xml'), 'plotprofilemap': __os.path.join(__cwd,'__xml__/plotprofilemap.xml'), 'imbaseline': __os.path.join(__cwd,'__xml__/imbaseline.xml') }
+def xml_interface_defs( ): return { 'imhead': __os.path.join(__cwd,'__xml__/imhead.xml'), 'immoments': __os.path.join(__cwd,'__xml__/immoments.xml'), 'imhistory': __os.path.join(__cwd,'__xml__/imhistory.xml'), 'applycal': __os.path.join(__cwd,'__xml__/applycal.xml'), 'bandpass': __os.path.join(__cwd,'__xml__/bandpass.xml'), 'blcal': __os.path.join(__cwd,'__xml__/blcal.xml'), 'calstat': __os.path.join(__cwd,'__xml__/calstat.xml'), 'defintent': __os.path.join(__cwd,'__xml__/defintent.xml'), 'concat': __os.path.join(__cwd,'__xml__/concat.xml'), 'split': __os.path.join(__cwd,'__xml__/split.xml'), 'listobs': __os.path.join(__cwd,'__xml__/listobs.xml'), 'flagdata': __os.path.join(__cwd,'__xml__/flagdata.xml'), 'flagcmd': __os.path.join(__cwd,'__xml__/flagcmd.xml'), 'getephemtable': __os.path.join(__cwd,'__xml__/getephemtable.xml'), 'setjy': __os.path.join(__cwd,'__xml__/setjy.xml'), 'cvel': __os.path.join(__cwd,'__xml__/cvel.xml'), 'cvel2': __os.path.join(__cwd,'__xml__/cvel2.xml'), 'importuvfits': __os.path.join(__cwd,'__xml__/importuvfits.xml'), 'importfits': __os.path.join(__cwd,'__xml__/importfits.xml'), 'exportfits': __os.path.join(__cwd,'__xml__/exportfits.xml'), 'exportuvfits': __os.path.join(__cwd,'__xml__/exportuvfits.xml'), 'partition': __os.path.join(__cwd,'__xml__/partition.xml'), 'listpartition': __os.path.join(__cwd,'__xml__/listpartition.xml'), 'flagmanager': __os.path.join(__cwd,'__xml__/flagmanager.xml'), 'mstransform': __os.path.join(__cwd,'__xml__/mstransform.xml'), 'msuvbin': __os.path.join(__cwd,'__xml__/msuvbin.xml'), 'tclean': __os.path.join(__cwd,'__xml__/tclean.xml'), 'deconvolve': __os.path.join(__cwd,'__xml__/deconvolve.xml'), 'immath': __os.path.join(__cwd,'__xml__/immath.xml'), 'vishead': __os.path.join(__cwd,'__xml__/vishead.xml'), 'uvsub': __os.path.join(__cwd,'__xml__/uvsub.xml'), 'spxfit': __os.path.join(__cwd,'__xml__/spxfit.xml'), 'splattotable': __os.path.join(__cwd,'__xml__/splattotable.xml'), 'specsmooth': __os.path.join(__cwd,'__xml__/specsmooth.xml'), 'specflux': __os.path.join(__cwd,'__xml__/specflux.xml'), 'smoothcal': __os.path.join(__cwd,'__xml__/smoothcal.xml'), 'specfit': __os.path.join(__cwd,'__xml__/specfit.xml'), 'imstat': __os.path.join(__cwd,'__xml__/imstat.xml'), 'slsearch': __os.path.join(__cwd,'__xml__/slsearch.xml'), 'delmod': __os.path.join(__cwd,'__xml__/delmod.xml'), 'imsubimage': __os.path.join(__cwd,'__xml__/imsubimage.xml'), 'accor': __os.path.join(__cwd,'__xml__/accor.xml'), 'asdmsummary': __os.path.join(__cwd,'__xml__/asdmsummary.xml'), 'clearcal': __os.path.join(__cwd,'__xml__/clearcal.xml'), 'conjugatevis': __os.path.join(__cwd,'__xml__/conjugatevis.xml'), 'exportasdm': __os.path.join(__cwd,'__xml__/exportasdm.xml'), 'importasdm': __os.path.join(__cwd,'__xml__/importasdm.xml'), 'clearstat': __os.path.join(__cwd,'__xml__/clearstat.xml'), 'fixplanets': __os.path.join(__cwd,'__xml__/fixplanets.xml'), 'fixvis': __os.path.join(__cwd,'__xml__/fixvis.xml'), 'phaseshift': __os.path.join(__cwd,'__xml__/phaseshift.xml'), 'fluxscale': __os.path.join(__cwd,'__xml__/fluxscale.xml'), 'ft': __os.path.join(__cwd,'__xml__/ft.xml'), 'gaincal': __os.path.join(__cwd,'__xml__/gaincal.xml'), 'gencal': __os.path.join(__cwd,'__xml__/gencal.xml'), 'getantposalma': __os.path.join(__cwd,'__xml__/getantposalma.xml'), 'testconcat': __os.path.join(__cwd,'__xml__/testconcat.xml'), 'apparentsens': __os.path.join(__cwd,'__xml__/apparentsens.xml'), 'getcalmodvla': __os.path.join(__cwd,'__xml__/getcalmodvla.xml'), 'hanningsmooth': __os.path.join(__cwd,'__xml__/hanningsmooth.xml'), 'imcollapse': __os.path.join(__cwd,'__xml__/imcollapse.xml'), 'imcontsub': __os.path.join(__cwd,'__xml__/imcontsub.xml'), 'imdev': __os.path.join(__cwd,'__xml__/imdev.xml'), 'imfit': __os.path.join(__cwd,'__xml__/imfit.xml'), 'impbcor': __os.path.join(__cwd,'__xml__/impbcor.xml'), 'importasap': __os.path.join(__cwd,'__xml__/importasap.xml'), 'importatca': __os.path.join(__cwd,'__xml__/importatca.xml'), 'importfitsidi': __os.path.join(__cwd,'__xml__/importfitsidi.xml'), 'importgmrt': __os.path.join(__cwd,'__xml__/importgmrt.xml'), 'importnro': __os.path.join(__cwd,'__xml__/importnro.xml'), 'importvla': __os.path.join(__cwd,'__xml__/importvla.xml'), 'impv': __os.path.join(__cwd,'__xml__/impv.xml'), 'imrebin': __os.path.join(__cwd,'__xml__/imrebin.xml'), 'imreframe': __os.path.join(__cwd,'__xml__/imreframe.xml'), 'imregrid': __os.path.join(__cwd,'__xml__/imregrid.xml'), 'imsmooth': __os.path.join(__cwd,'__xml__/imsmooth.xml'), 'imtrans': __os.path.join(__cwd,'__xml__/imtrans.xml'), 'imval': __os.path.join(__cwd,'__xml__/imval.xml'), 'initweights': __os.path.join(__cwd,'__xml__/initweights.xml'), 'listcal': __os.path.join(__cwd,'__xml__/listcal.xml'), 'listfits': __os.path.join(__cwd,'__xml__/listfits.xml'), 'listhistory': __os.path.join(__cwd,'__xml__/listhistory.xml'), 'listsdm': __os.path.join(__cwd,'__xml__/listsdm.xml'), 'listvis': __os.path.join(__cwd,'__xml__/listvis.xml'), 'makemask': __os.path.join(__cwd,'__xml__/makemask.xml'), 'polcal': __os.path.join(__cwd,'__xml__/polcal.xml'), 'polfromgain': __os.path.join(__cwd,'__xml__/polfromgain.xml'), 'predictcomp': __os.path.join(__cwd,'__xml__/predictcomp.xml'), 'rerefant': __os.path.join(__cwd,'__xml__/rerefant.xml'), 'rmfit': __os.path.join(__cwd,'__xml__/rmfit.xml'), 'rmtables': __os.path.join(__cwd,'__xml__/rmtables.xml'), 'sdatmcor': __os.path.join(__cwd,'__xml__/sdatmcor.xml'), 'sdbaseline': __os.path.join(__cwd,'__xml__/sdbaseline.xml'), 'sdcal': __os.path.join(__cwd,'__xml__/sdcal.xml'), 'sdfit': __os.path.join(__cwd,'__xml__/sdfit.xml'), 'sdfixscan': __os.path.join(__cwd,'__xml__/sdfixscan.xml'), 'sdgaincal': __os.path.join(__cwd,'__xml__/sdgaincal.xml'), 'sdimaging': __os.path.join(__cwd,'__xml__/sdimaging.xml'), 'sdsmooth': __os.path.join(__cwd,'__xml__/sdsmooth.xml'), 'tsdimaging': __os.path.join(__cwd,'__xml__/tsdimaging.xml'), 'nrobeamaverage': __os.path.join(__cwd,'__xml__/nrobeamaverage.xml'), 'sdtimeaverage': __os.path.join(__cwd,'__xml__/sdtimeaverage.xml'), 'simanalyze': __os.path.join(__cwd,'__xml__/simalma.xml'), 'simobserve': __os.path.join(__cwd,'__xml__/simobserve.xml'), 'feather': __os.path.join(__cwd,'__xml__/simanalyze.xml'), 'simalma': __os.path.join(__cwd,'__xml__/feather.xml'), 'statwt': __os.path.join(__cwd,'__xml__/statwt.xml'), 'virtualconcat': __os.path.join(__cwd,'__xml__/virtualconcat.xml'), 'uvcontsub_old': __os.path.join(__cwd,'__xml__/uvcontsub_old.xml'), 'uvcontsub': __os.path.join(__cwd,'__xml__/uvcontsub.xml'), 'uvmodelfit': __os.path.join(__cwd,'__xml__/uvmodelfit.xml'), 'visstat': __os.path.join(__cwd,'__xml__/visstat.xml'), 'widebandpbcor': __os.path.join(__cwd,'__xml__/widebandpbcor.xml'), 'importmiriad': __os.path.join(__cwd,'__xml__/importmiriad.xml'), 'plotweather': __os.path.join(__cwd,'__xml__/plotweather.xml'), 'plotants': __os.path.join(__cwd,'__xml__/plotants.xml'), 'fringefit': __os.path.join(__cwd,'__xml__/fringefit.xml'), 'plotbandpass': __os.path.join(__cwd,'__xml__/plotbandpass.xml'), 'sdintimaging': __os.path.join(__cwd,'__xml__/sdintimaging.xml'), 'sdpolaverage': __os.path.join(__cwd,'__xml__/sdpolaverage.xml'), 'sdsidebandsplit': __os.path.join(__cwd,'__xml__/sdsidebandsplit.xml'), 'plotprofilemap': __os.path.join(__cwd,'__xml__/plotprofilemap.xml'), 'imbaseline': __os.path.join(__cwd,'__xml__/imbaseline.xml') }
 
 mpi_env_found=False
 try:
     from casampi.MPIEnvironment import MPIEnvironment
     mpi_env_found=True
 except:
     mpi_env_found=False
@@ -293,18 +295,18 @@
 except:
   pass
 import platform
 if mpi_env_found and MPIEnvironment.is_mpi_enabled:
     if MPIEnvironment.is_mpi_client:
         try:
             casalog.post("Python version " + platform.python_version())
-            casalog.post("CASA Version " + package_variant.upper() + " 6.6.3.22")
+            casalog.post("CASA Version " + package_variant.upper() + " 6.6.4.34")
             casalog.post("MPI Enabled")
         except:
             print("Error: the logfile is not writable")
 else:
     try:
         casalog.post("Python version " + platform.python_version())
-        casalog.post("CASA Version " + package_variant.upper() + " 6.6.3.22")
+        casalog.post("CASA Version " + package_variant.upper() + " 6.6.4.34")
     except:
         print("Error: the logfile is not writable")
```

## casatasks/bandpass.py

```diff
@@ -1,9 +1,9 @@
 ##################### generated by xml-casa (v2) from bandpass.xml ##################
-##################### 9212d76fdcd3b66e91cab10f80557c5d ##############################
+##################### 83925879e747e0b20387dd8ace9a53fa ##############################
 from __future__ import absolute_import
 import numpy
 from casatools.typecheck import CasaValidator as _val_ctor
 _pc = _val_ctor( )
 from casatools.coercetype import coerce as _coerce
 from casatools.errors import create_error_string
 from .private.task_bandpass import bandpass as _bandpass_t
@@ -211,15 +211,15 @@
                  'B' does a channel by channel solution for each
                  specified spw. 
                  'BPOLY' is somewhat experimental. It will fit an
                  nth order polynomial for the amplitude and phase
                  as a function of frequency. Only one fit is made
                  for all specified spw, and edge channels should
                  be omitted.
-                 Use taskname=plotcal in order to compare the
+                 Use taskname=plotms in order to compare the
                  results from B and BPOLY.
                  
                     Example: bandtype='BPOLY'
     smodel       Point source Stokes parameters for source model.
     corrdepflags f False (default), if any correlation is flagged, treat all correlations in
                        the visibility vector as flagged when solving (per channel, per baseline).
                        If True, use unflagged correlations in a visibility vector, even if one or more
```

## casatasks/fixplanets.py

```diff
@@ -1,9 +1,9 @@
 ##################### generated by xml-casa (v2) from fixplanets.xml ################
-##################### 9e77d5f648d8c3e845548de6053a7d00 ##############################
+##################### 284ba2a1cc4b6c7ef2f46d6558118056 ##############################
 from __future__ import absolute_import
 import numpy
 from casatools.typecheck import CasaValidator as _val_ctor
 _pc = _val_ctor( )
 from casatools.coercetype import coerce as _coerce
 from casatools.errors import create_error_string
 from .private.task_fixplanets import fixplanets as _fixplanets_t
@@ -51,17 +51,17 @@
               Default: '' (use pointing table)
               
                  Example: 'J2000 19h30m00 -40d00m00'
               
               The direction can either be given explicitly or
               as the path to a JPL Horizons
               ephemeris. Alternatively, the ephemeris table can
-              also be provided as mime format file. For more
+              also be provided using getephemtable task. For more
               information, see the task pages of fixplanets in
-              CASA Docs (https://casa.nrao.edu/casadocs/).
+              the CASA Docs.
     refant    Reference antenna name(s); a prioritized list may be
               specified
               Default: 0 (antenna ID 0)
               
                  Examples: 
                  refant='4' (antenna with index 4)
                  refant='VA04' (VLA antenna #4)
```

## casatasks/flagdata.py

```diff
@@ -1,9 +1,9 @@
 ##################### generated by xml-casa (v2) from flagdata.xml ##################
-##################### 9f485cb5bafdda981ba9a7819244567b ##############################
+##################### 4f26e57fc00d2ca604825e5f4b7fac4a ##############################
 from __future__ import absolute_import
 import numpy
 from casatools.typecheck import CasaValidator as _val_ctor
 _pc = _val_ctor( )
 from casatools.coercetype import coerce as _coerce
 from casatools.errors import create_error_string
 from .private.task_flagdata import flagdata as _flagdata_t
@@ -424,19 +424,23 @@
                        'NORM' followed by any of 'ALL', 'I', 'XX', 'YY',
                        'RR', 'LL', 'WVR' ('WVR' = water vapour
                        radiometer of ALMA data).
                        
                           Example: correlation="XX,YY".
                        
                        For modes clip, tfcrop or rflag, the default
-                       means ABS_ALL. If the input is cal table that
-                       does not contain a complex data column, the
-                       default will fall back to REAL_ALL.
+                       means ABS_ALL.
+                       If the input is cal table that does not contain
+                       a complex data column, the default will fall back
+                       to REAL_ALL.
                        For calibration tables, the solutions are:
                        'Sol1', 'Sol2', Sol3, Sol4.
+                       When using the 'ARG' option, the values of
+                       parameters such as clipminmax are expeced in
+                       units of radians.
                        
                        NOTE: correlation selection is not supported for
                        modes other than clip, tfcrop or rflag in cal
                        tables.
     scan               Scan number range
                        Subparameter of selectdata=True
                        Default: '' = all
```

## casatasks/gaincal.py

```diff
@@ -1,9 +1,9 @@
 ##################### generated by xml-casa (v2) from gaincal.xml ###################
-##################### 4b8a0e9889f4fac3a7bbdf7e05c0ba89 ##############################
+##################### 7c21c599f57fdbdddd203514dcc55c60 ##############################
 from __future__ import absolute_import
 import numpy
 from casatools.typecheck import CasaValidator as _val_ctor
 _pc = _val_ctor( )
 from casatools.coercetype import coerce as _coerce
 from casatools.errors import create_error_string
 from .private.task_gaincal import gaincal as _gaincal_t
@@ -171,14 +171,18 @@
                     refant='VA04' (VLA antenna #4)
                     refant='EA02,EA23,EA13' (EVLA antenna EA02,
                     use EA23 and EA13 as alternates if/when EA02
                     drops out)
                  
                  Use taskname=listobs for antenna listing
     refantmode   Reference antenna mode
+                   Default: 'flex'
+                 
+                 - 'flex': If the preferred or current refant drops out, switch to another. Alternate reference antennas will be chosen from the refant parameter (if a nontrivial list of antennas is specified), or according to proximity to the last-used refant. If and when the preferred refant returns, the referencing will switch back to it. 
+                 - 'strict': If the preferred or current refant is absent for a solution, flag all antennas at that solution. This mode ensures that the effective cross-hand phase will be maintained constant and equal to that of the chosen refant, and not subject to variation due to finite SNR when switching among reference antennas. If a list of antennas is specified in refant, only the first is used.
     minblperant  Minimum number of baselines required per antenna for each
                  solve
                  Default: 4
                  
                  Antennas with fewer baselines are excluded from
                  solutions.
```

## casatasks/imstat.py

```diff
@@ -1,9 +1,9 @@
 ##################### generated by xml-casa (v2) from imstat.xml ####################
-##################### 0b2cadc8f3a6963fbd22d332d9507b82 ##############################
+##################### 76730722711b052751c7e443e885cbf7 ##############################
 from __future__ import absolute_import
 import numpy
 from casatools.typecheck import CasaValidator as _val_ctor
 _pc = _val_ctor( )
 from casatools.coercetype import coerce as _coerce
 from casatools.errors import create_error_string
 from .private.task_imstat import imstat as _imstat_t
@@ -38,299 +38,14 @@
     clmethod  Method to use for calculating classical statistics. Supported methods are "auto", "tiled", and "framework". Ignored if algorithm is not "classic".
     niter     For biweight, this is the maximum number of iterations to attempt. Iterating will stop when either this limit is reached, or the zscore criterion is met. If negative, do a fast, simple computation (see description). Ignored if the algorithm is not "biweight".
     [1;42mRETURNS[1;m      void
 
     --------- examples -----------------------------------------------------------
 
     
-    
-    Many parameters are determined from the specified region of an image.
-    For this version, the region can be specified by a set of rectangular
-    pixel coordinates, the channel ranges and the Stokes.
-    
-    For directed output, run as
-    myoutput = imstat()
-    
-    
-    Keyword arguments:
-    imagename    Name of input image
-    Default: none; Example: imagename='ngc5921_task.im'
-    axes         axes to compute statistics over. -1 => all axes.
-    region       Region selection. Default is
-    to use the full image.
-    box          Rectangular region(s) to select in direction plane. See
-    Default is to use the entire direction plane.
-    Example: box='10,10,50,50'
-    box = '10,10,30,30,35,35,50,50' (two boxes)
-    chans        Channels to use. Default is to use all channels.
-    Example: chans='3~20'
-    stokes       Stokes planes to use. Default is to
-    use all Stokes planes.
-    Example:stokes='I,Q'
-    listit       Print stats and bounding box to logger?
-    verbose      Print additional messages to logger?
-    mask         Mask to use. Default is none.
-    stretch      Stretch the mask if necessary and possible?
-    logfile      Name of file to write fit results.
-    append       If logfile exists, append to it (True) or overwrite it (False).
-    alogortihm   Algorithm to use to compute statistics. Supported values are "classic"
-    and "hinges-fences" (minimum match supported.)
-    fence        Fence factor when algorithm = "hinges-fences". Negative values are not
-    applicable and in these cases, the classic algorithm is used.
-    center       Center to use for "fit-half". Valid choices are "mean" (mean value of the
-    selected pixels), "median" (median value of the selected pixels), and "zero"
-    (0.0 is used as the center value). Ignored if algorithm is not "fit-half".
-    lside        For fit-half, use values <= center for the real data? If false, use
-    values >= center as the real data. Ignored if algorithm is not "fit-half"
-    zscore       For chauvenet, this is the target maximum number of standard deviations data
-    may have to be included. If negative, use Chauvenet's criterion. Ignored if
-    algorithm is not "chauvenet".
-    maxiter      For chauvenet, this is the maximum number of iterations to attempt. Iterating
-    will stop when either this limit is reached, or the zscore criterion is met.
-    If negative, iterate until the zscore criterion is met. Ignored if algorithm is
-    not "chauvenet".
-    clmethod     Method to use for calculating classical statistics. Supported methods are "auto",
-    "tiled", and "framework". Ignored if algorithm is not "classic".
-    
-    General procedure:
-    
-    1.  Specify inputs, then
-    
-    2.  myoutput = imstat()
-    or specify inputs directly in calling sequence to task
-    myoutput = imstat(imagename='image.im', etc)
-    
-    3.  myoutput['KEYS'] will contain the result associated with any
-    of the keys given below
-    
-    KEYS CURRENTLY AVAILABLE
-    blc          - absolute PIXEL coordinate of the bottom left corner of
-    the bounding box surrounding the selected region
-    blcf         - Same as blc, but uses WORLD coordinates instead of pixels
-    trc          - the absolute PIXEL coordinate of the top right corner
-    of the bounding box surrounding the selected region
-    trcf         - Same as trc, but uses WORLD coordinates instead of pixels
-    flux         - the flux or flux density. See below for details.
-    npts         - the number of unmasked points used
-    max          - the maximum pixel value
-    min          - minimum pixel value
-    maxpos       - absolute PIXEL coordinate of maximum pixel value
-    maxposf      - Same as maxpos, but uses WORLD coordinates instead of pixels
-    minpos       - absolute pixel coordinate of minimum pixel value
-    minposf      - Same as minpos, but uses WORLD coordinates instead of pixels
-    sum          - the sum of the pixel values: $sum I_i$
-    sumsq        - the sum of the squares of the pixel values: $sum I_i^2$
-    mean         - the mean of pixel values:
-    $bar{I} = sum I_i / n$
-    sigma        - the standard deviation about the mean:
-    $sigma^2 = (sum I_i - bar{I})^2 / (n-1)$
-    rms          - the root mean square:
-    $sqrt {sum I_i^2 / n}$
-    median       - the median pixel value
-    medabsdevmed - the median of the absolute deviations from the
-    median
-    quartile     - the inner-quartile range. Find the points
-    which are 25% largest and 75% largest (the median is
-    50% largest).
-    q1           - the first quartile.
-    q3           - the third quartile
-    
-    CURSOR AXES
-    The axes parameter allows one to set the cursor axes over which statistics
-    are computed. For example, consider a 3-dimensional image for which axes=[0,2].
-    The statistics would be computed for each XZ (axes 0 and 2) plane in the
-    image.  One could then examine those statistics as a function of the Y
-    (axis 1) axis.
-    
-    Each statistic is stored in an array in its own field in the returned dictionary.
-    The dimensionality of these arrays is equal to the number of axes over which the
-    statistics were not evaluated (called the display axes). For example, if the input
-    image has four axes, and axes=[0], the output statistic arrays will have three dimensions.
-    If axes=[0, 1], the output statistic arrays will have two dimensions.
-    
-    The shape of the output arrays when axes has a positive number of elements is based on
-    the region selection. If there is no region selection, the shape of the statistic arrays
-    is just the shape of the image along the display (non-cursor) axes. For example, if the
-    input image has dimensions of 300x400x4x80 (RA x Dec x Stokes x Freq) and axes=[0, 1],
-    in the absence of a region selection, the shape of the output statistic arrays will be
-    4x80. If there is a region selection, the shape of the output statistic arrays will be
-    determined by the number of planes along the display axes chosen in the region selection.
-    For example, continuing with our example, if axes=[0,1], chans="5~15;30~70", and
-    stokes="IV", the output statistic arrays will have shapes of 2x52. Only the selected
-    planes will be displayed in the logger output if verbose=True.
-    
-    In the case where the image has a pixel mask, and/or the mask parameter is specified,
-    and because of this specification a plane is entirely masked, this element is included in
-    the statistic arrays (usually with a value of 0). It is not included in the logger output
-    if verbose=True. One can exclude such elements from computations on the output arrays by
-    using the numpy.extract() method. For example, to compute the minimum rms value, not
-    including any fully masked planes, one could use
-    
-    stats = imstat(...)
-    rmsmin = numpy.min(numpy.extract(stats['npts']>0, stats['rms']))
-    
-    Thus in the computation of rmsmin, only the rms elements are considered which have
-    associated values of npts that are not zero.
-    
-    ALGORITHMS
-    
-    Several types of statistical algorithms are supported:
-    
-    * classic: This is the familiar algorithm, in which all unmasked pixels are used. One may choose
-    one of two methods, which vary only by performance, for computing classic statistics, via the
-    clmethod parameter. The "tiled" method is the old method and is fastest in cases where there are
-    a large number of individual sets of statistics to be computed and a small number of data points
-    per set. This can occur when one sets the axes parameter, which causes several individual sets of
-    statistics to be computed. The "framework" method uses the new statistics framework to compute
-    statistics. This method is fastest in the regime where one has a small number of individual sets
-    of statistics to calculate, and each set has a large number of points. For example, this method
-    is fastest when computing statistics over an entire image in one go (no axes specified). A third
-    option, "auto", chooses which method to use by predicting which be faster based on the number of
-    pixels in the image and the choice of the axes parameter.
-    
-    * fit-half: This algorithm calculates statistics on a dataset created from real and virtual pixel values.
-    The real values are determined by the input parameters center and lside. The parameter center
-    tells the algorithm where the center value of the combined real+virtual dataset should be. Options
-    are the mean or the median of the input image's pixel values, or at zero. The lside parameter tells
-    the algorithm on which side of this center the real pixel values are located. True indicates that
-    the real pixel values to be used are <= center. False indicates the real pixel values to be used
-    are >= center. The virtual part of the dataset is then created by reflecting all the real values
-    through the center value, to create a perfectly symmetric dataset composed of a real and a virtual
-    component. Statistics are then calculated on this resultant dataset. These two parameters are
-    ignored if algorithm is not "fit-half". Because the maximum value is virtual if lside is True and the
-    minimum value is virtual if lside is False, the value of the maximum position (if lside=True) or
-    minimum position (if lside=False) is not reported in the returned record.
-    
-    * hinges-fences: This algorithm calculates statistics by including data in a range
-    between Q1 - f*D and Q3 + f*D, inclusive, where Q1 is the first quartile of the distribution
-    of unmasked data, subject to any specified pixel ranges, Q3 is the third quartile, D = Q3 - Q1
-    (the inner quartile range), and f is the user-specified fence factor. Negative values of f
-    indicate that the full distribution is to be used (ie, the classic algorithm is used). Sufficiently
-    large values of f will also be equivalent to using the classic algorithm. For f = 0, only data
-    in the inner quartile range is used for computing statistics. The value of fence is silently
-    ignored if algorithm is not "hinges-fences".
-    
-    * chauvenet: The idea behind this algorithm is to eliminate outliers based on a maximum z-score value.
-    A z-score is the number of standard deviations a point is from the mean of a distribution. This
-    method thus is meant to be used for (nearly) normal distributions. In general, this is an iterative
-    process, with successive iterations discarding additional outliers as the remaining points become
-    closer to forming a normal distribution. Iterating stops when no additional points lie beyond the
-    specified zscore value, or, if zscore is negative, when Chauvenet's criterion is met (see below).
-    The parameter maxiter can be set to a non-negative value to prematurely abort this iterative
-    process. When verbose=T, the "N iter" column in the table that is logged represents the number
-    of iterations that were executed.
-    
-    Chauvenet's criterion allows the target z-score to decrease as the number of points in the
-    distribution decreases on subsequent iterations. Essentially, the criterion is that the probability
-    of having one point in a normal distribution at a maximum z-score of z_max must be at least 0.5.
-    z_max is therefore a function of (only) the number of points in the distrbution and is given by
-    
-    npts = 0.5/erfc(z_max/sqrt(2))
-    
-    where erfc() is the complementary error function. As iterating proceeds, the number of remaining
-    points decreases as outliers are discarded, and so z_max likewise decreases. Convergence occurs when
-    all remaining points fall within a z-score of z_max. Below is an illustrative table of z_max values
-    and their corresponding npts values. For example, it is likely that there will be a 5-sigma "noise
-    bump" in a perfectly noisy image with one million independent elements.
-    
-    z_max    npts
-    1.0                1
-    1.5                3
-    2.0               10
-    2.5               40
-    3.0              185
-    3.5            1,074
-    4.0            7,893
-    4.5           73,579
-    5.0          872,138
-    5.5       13,165,126
-    6.0      253,398,672
-    6.5    6,225,098,696
-    7.0  195,341,107,722
-    
-    NOTES ON FLUX DENSITIES AND FLUXES
-    
-    Fluxes and flux densities are not computed if any of the following conditions is met:
-    
-    1. The image does not have a direction coordinate
-    2. The image does not have a intensity-like brightness unit. Examples of such units
-    are Jy/beam (in which case the image must also have a beam) and K.
-    3. There are no direction axes in the cursor axes that are used.
-    4. If the (specified region of the) image has a non-degenerate spectral axis,
-    and the image has a tablular spectral axis (axis with varying increments)
-    5. Any axis that is not a direction nor a spectral axis that is included in the cursor
-    axes is not degenerate within in specified region
-    
-    Note that condition 4 may be removed in the future.
-    
-    In cases where none of the above conditions is met, the flux density(ies) (intensities
-    integrated over direction planes) will be computed if any of the following conditions
-    are met:
-    
-    1. The image has no spectral coordinate
-    2. The cursor axes do not include the spectral axis
-    3. The spectral axis in the chosen region is degenerate
-    
-    In the case where there is a nondegenerate spectral axis that is included in the cursor
-    axes, the flux (flux density integrated over spectral planes) will be computed. In this
-    case, the spectral portion of the flux unit will be the velocity unit of the spectral
-    coordinate if it has one (eg, if the brightness unit is Jy/beam and the velocity unit is
-    km/s, the flux will have units of Jy.km/s). If not, the spectral portion of the flux unit
-    will be the frequency unit of the spectral axis (eg, if the brightness unit is K and the
-    frequency unit is Hz, the resulting flux unit will be K.arcsec2.Hz).
-    
-    In both cases of flux density or flux being computed, the resulting numerical value is
-    assigned to the "flux" key in the output dictionary.
-    
-    ADDITIONAL EXAMPLES
-    
-    # Selected two box region
-    # box 1, bottom-left coord is 2,3 and top-right coord is 14,15
-    # box 2, bottom-left coord is 30,31 and top-right coord is 42,43
-    imstat( 'myImage', box='2,3,14,15;30,31,42,43' )
-    
-    # Select the same two box regions but only channels 4 and 5
-    imstat( 'myImage', box='2,3,14,15;30,31,42,43', chan='4~5' )
-    
-    # Select all channels greater the 20 as well as channel 0.
-    # Then the mean and standard deviation are printed
-    results = imstat( 'myImage', chans='>20;0' )
-    print "Mean is: ", results['mean'], "  s.d. ", results['sigma']
-    
-    # Find statistical information for the Q stokes value only
-    # then the I stokes values only, and printing out the statistical
-    # values that we are interested in.
-    s1 = imstat( 'myimage', stokes='Q' )
-    s2 = imstat( 'myimage', stokes='I' )
-    print "       |  MIN  |   MAX  | MEAN"
-    print "  Q    | ",s1['min'][0],"  |  ",s1['max'][0],"  |  ",,"  |  ",s1['mean'][0]
-    print "  I    | ",s2['min'][0],"  |  ",s2['max'][0],"  |  ",,"  |  ",s2['mean'][0]
-    
-    # evaluate statistics for each spectral plane in an ra x dec x frequency image
-    myim = "noisy.im"
-    ia.fromshape(myim, [20,30,40])
-    # give pixels non-zero values
-    ia.addnoise()
-    ia.done()
-    # These are the display axes, the calculation of statistics occurs
-    # for each (hyper)plane along axes not listed in the axes parameter,
-    # in this case axis 2 (the frequency axis)
-    # display the rms for each frequency plane (your mileage will vary with
-    # the values).
-    stats = imstat(imagename=myim, axes=[0,1])
-    stats["rms"]
-    Out[10]:
-    array([ 0.99576014,  1.03813124,  0.97749186,  0.97587883,  1.04189885,
-    1.03784776,  1.03371549,  1.03153074,  1.00841606,  0.947155  ,
-    0.97335404,  0.94389403,  1.0010221 ,  0.97151822,  1.03942156,
-    1.01158476,  0.96957082,  1.04212773,  1.00589049,  0.98696715,
-    1.00451481,  1.02307892,  1.03102005,  0.97334671,  0.95209879,
-    1.02088714,  0.96999902,  0.98661619,  1.01039267,  0.96842754,
-    0.99464947,  1.01536798,  1.02466023,  0.96956468,  0.98090756,
-    0.9835844 ,  0.95698935,  1.05487967,  0.99846411,  0.99634868])
 
 
     """
 
     _info_group_ = """information, analysis"""
     _info_desc_ = """Calculates statistical information from an image or image region"""
```

## casatasks/polfromgain.py

```diff
@@ -1,9 +1,9 @@
 ##################### generated by xml-casa (v2) from polfromgain.xml ###############
-##################### 09dcbeb422075b24cdc8c7d5a1d330d1 ##############################
+##################### 81a3ae6d4c5273a4ac930473d37d18bb ##############################
 from __future__ import absolute_import
 import numpy
 from casatools.typecheck import CasaValidator as _val_ctor
 _pc = _val_ctor( )
 from casatools.coercetype import coerce as _coerce
 from casatools.errors import create_error_string
 from .private.task_polfromgain import polfromgain as _polfromgain_t
@@ -17,55 +17,39 @@
 
     
     TBD
     
 
     --------- parameter descriptions ---------------------------------------------
 
-    vis      Name of input visibility file (MS)
-    tablein  Input calibration table
-    caltable Output calibration table (forces polarization correction if specified)
-    paoffset Manual position angle offset
+    vis      Name of input MS from which gaincal caltable in tablein originated.  Used to extract geometry information not available in the tablein caltable.
+    tablein  Input gain calibration table corresponding to MS specified in vis.
+    caltable Optional output calibration table which will contain source polarization-corrected gains, if specified
+    paoffset Manual position angle offset (clockwise, in deg); added to value stored in the MS FEED subtable.  Use with care, since downstream calibration operation using polfromgain results will change according to this position angle offset.
+    minpacov Minimum parallactic angle coverage (deg) required for Q,U estimation. Reliable Q,U estimation depends on adequate parallactic angle coverage, and this parameter enforces a minimum allowable range of parallactic angle (per antenna) for unflagged gain solutions before the Q,U esimation is attempted.  (If caltable is specified, gains for antennas failing the minpacov criteria will be corrected by the per-spw average of Q,U estimates from good antennas.)
     [1;42mRETURNS[1;m     void
 
     --------- examples -----------------------------------------------------------
 
     
-    
-    
-    TBD...
-    
-    Keyword arguments:
-    vis -- Name of input visibility file
-    default: none;
-    tablein -- Input calibration table (G or T)
-    default: none;
-    caltable -- Output calibration table
-    default: ''  (no new table)
-    if specified, new caltable with polarization removed is generated
-    paoffset -- Manual position angle offset
-    default: 0.0  (no extra offset)
-    example: paoffset=10.0  (10 degree offset)
-    
-    
 
 
     """
 
     _info_group_ = """calibration"""
     _info_desc_ = """Derive linear polarization from gain ratio"""
 
-    def __call__( self, vis='', tablein='', caltable='', paoffset=float(0.0) ):
-        schema = {'vis': {'type': 'cReqPath', 'coerce': _coerce.expand_path}, 'tablein': {'type': 'cReqPath', 'coerce': _coerce.expand_path}, 'caltable': {'type': 'cStr', 'coerce': _coerce.to_str}, 'paoffset': {'type': 'cFloat', 'coerce': _coerce.to_float}}
-        doc = {'vis': vis, 'tablein': tablein, 'caltable': caltable, 'paoffset': paoffset}
+    def __call__( self, vis='', tablein='', caltable='', paoffset=float(0.0), minpacov=float(30.0) ):
+        schema = {'vis': {'type': 'cReqPath', 'coerce': _coerce.expand_path}, 'tablein': {'type': 'cReqPath', 'coerce': _coerce.expand_path}, 'caltable': {'type': 'cStr', 'coerce': _coerce.to_str}, 'paoffset': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'minpacov': {'type': 'cFloat', 'coerce': _coerce.to_float}}
+        doc = {'vis': vis, 'tablein': tablein, 'caltable': caltable, 'paoffset': paoffset, 'minpacov': minpacov}
         assert _pc.validate(doc,schema), create_error_string(_pc.errors)
-        _logging_state_ = _start_log( 'polfromgain', [ 'vis=' + repr(_pc.document['vis']), 'tablein=' + repr(_pc.document['tablein']), 'caltable=' + repr(_pc.document['caltable']), 'paoffset=' + repr(_pc.document['paoffset']) ] )
+        _logging_state_ = _start_log( 'polfromgain', [ 'vis=' + repr(_pc.document['vis']), 'tablein=' + repr(_pc.document['tablein']), 'caltable=' + repr(_pc.document['caltable']), 'paoffset=' + repr(_pc.document['paoffset']), 'minpacov=' + repr(_pc.document['minpacov']) ] )
         task_result = None
         try:
-            task_result = _polfromgain_t( _pc.document['vis'], _pc.document['tablein'], _pc.document['caltable'], _pc.document['paoffset'] )
+            task_result = _polfromgain_t( _pc.document['vis'], _pc.document['tablein'], _pc.document['caltable'], _pc.document['paoffset'], _pc.document['minpacov'] )
         except Exception as exc:
             _except_log('polfromgain', exc)
             raise
         finally:
             task_result = _end_log( _logging_state_, 'polfromgain', task_result )
         return task_result
```

## casatasks/setjy.py

```diff
@@ -1,9 +1,9 @@
 ##################### generated by xml-casa (v2) from setjy.xml #####################
-##################### 9be83b90dab42c37901e1a24b8bfb7cb ##############################
+##################### 00ebb1489d4e63a2ce3f6c2e5a10db6e ##############################
 from __future__ import absolute_import
 import numpy
 from casatools.typecheck import CasaValidator as _val_ctor
 _pc = _val_ctor( )
 from casatools.coercetype import coerce as _coerce
 from casatools.errors import create_error_string
 from .private.task_setjy import setjy as _setjy_t
@@ -349,35 +349,35 @@
                   and "Perley-Butler 2017" 
                   Default: 'nearest'
                   Options: 'nearest|linear|cubic|spline'
                   
                   This parameter is ignored for other non-variable
                   sources in the standard.
     usescratch    Will create if necessary and use the MODEL_DATA
-                  Default: False
-                  Options: False|True
+                  Default: True 
+                  Options: True|False
                   
-                  * If False: 'virtual' model is created. The model
-                    information is saved either in the SOURCE_MODEL
-                    column in the SOURCE table (if one exists) or
-                    in the keyword of the main table in the MS and
-                    model visibilities are evaluated on the fly
-                    when calculating  calibration or plotting in
-                    plotms.
                   * If True: the model visibility will be evaluated
                     and saved on disk in the MODEL_DATA column.
                     This will increase your ms in size by a factor
                     of 1.5 (w.r.t. the case where  you only have
                     the DATA and the CORRECTED_DATA column). Use
                     True if you need to interact with the
                     MODEL_DATA in python, say. Also, use True if
                     you need finer than field and spw  selections
                     using scans/time (and when use with intent
                     selection, please see WARNING section in the
                     intent parameter description).
+                  * If False: 'virtual' model is created. The model
+                    information is saved either in the SOURCE_MODEL
+                    column in the SOURCE table (if one exists) or
+                    in the keyword of the main table in the MS, and
+                    model visibilities are evaluated on the fly
+                    when calculating  calibration or plotting in
+                    plotms.
                   
                   By running usescratch=T, it will remove the
                   existing virtual model from previous
                   runs. usescratch=F will not remove the existing
                   MODEL_DATA but in subsequent process the virtual
                   model with matching field and spw combination
                   will be used if it exists regardless of the
@@ -402,15 +402,15 @@
 
 
     """
 
     _info_group_ = """imaging, calibration"""
     _info_desc_ = """Fills the model column with the visibilities of a calibrator"""
 
-    def __call__( self, vis='', field='', spw='', selectdata=False, timerange='', scan='', intent='', observation='', scalebychan=True, standard='Perley-Butler 2017', model='', listmodels=False, fluxdensity=int(-1), spix=float(0.0), reffreq='1GHz', polindex=[  ], polangle=[  ], rotmeas=float(0.0), fluxdict={ }, useephemdir=False, interpolation='nearest', usescratch=False, ismms=False ):
+    def __call__( self, vis='', field='', spw='', selectdata=False, timerange='', scan='', intent='', observation='', scalebychan=True, standard='Perley-Butler 2017', model='', listmodels=False, fluxdensity=int(-1), spix=float(0.0), reffreq='1GHz', polindex=[  ], polangle=[  ], rotmeas=float(0.0), fluxdict={ }, useephemdir=False, interpolation='nearest', usescratch=True, ismms=False ):
         schema = {'vis': {'type': 'cStr', 'coerce': _coerce.to_str}, 'field': {'type': 'cStr', 'coerce': _coerce.to_str}, 'spw': {'type': 'cStr', 'coerce': _coerce.to_str}, 'selectdata': {'type': 'cBool'}, 'timerange': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'scan': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'intent': {'type': 'cStr', 'coerce': _coerce.to_str}, 'observation': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cInt'}]}, 'scalebychan': {'type': 'cBool'}, 'standard': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'Perley-Taylor 95', 'Butler-JPL-Horizons 2010', 'Perley-Butler 2010', 'Stevens-Reynolds 2016', 'Perley-Taylor 99', 'Perley-Butler 2013', 'Perley 90', 'Scaife-Heald 2012', 'manual', 'Butler-JPL-Horizons 2012', 'Perley-Butler 2017', 'fluxscale', 'Baars' ]}, 'model': {'type': 'cStr', 'coerce': _coerce.to_str}, 'listmodels': {'type': 'cBool'}, 'fluxdensity': {'anyof': [{'type': 'cInt'}, {'type': 'cIntVec', 'coerce': [_coerce.to_list,_coerce.to_intvec]}, {'type': 'cFloatVec', 'coerce': [_coerce.to_list,_coerce.to_floatvec]}]}, 'spix': {'anyof': [{'type': 'cFloat', 'coerce': _coerce.to_float}, {'type': 'cFloatVec', 'coerce': [_coerce.to_list,_coerce.to_floatvec]}]}, 'reffreq': {'type': 'cStr', 'coerce': _coerce.to_str}, 'polindex': {'type': 'cFloatVec', 'coerce': [_coerce.to_list,_coerce.to_floatvec]}, 'polangle': {'type': 'cFloatVec', 'coerce': [_coerce.to_list,_coerce.to_floatvec]}, 'rotmeas': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'fluxdict': {'type': 'cDict'}, 'useephemdir': {'type': 'cBool'}, 'interpolation': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'nearest', 'linear', 'spline', '', 'cubic' ]}, 'usescratch': {'type': 'cBool'}, 'ismms': {'type': 'cBool'}}
         doc = {'vis': vis, 'field': field, 'spw': spw, 'selectdata': selectdata, 'timerange': timerange, 'scan': scan, 'intent': intent, 'observation': observation, 'scalebychan': scalebychan, 'standard': standard, 'model': model, 'listmodels': listmodels, 'fluxdensity': fluxdensity, 'spix': spix, 'reffreq': reffreq, 'polindex': polindex, 'polangle': polangle, 'rotmeas': rotmeas, 'fluxdict': fluxdict, 'useephemdir': useephemdir, 'interpolation': interpolation, 'usescratch': usescratch, 'ismms': ismms}
         assert _pc.validate(doc,schema), create_error_string(_pc.errors)
         _logging_state_ = _start_log( 'setjy', [ 'vis=' + repr(_pc.document['vis']), 'field=' + repr(_pc.document['field']), 'spw=' + repr(_pc.document['spw']), 'selectdata=' + repr(_pc.document['selectdata']), 'timerange=' + repr(_pc.document['timerange']), 'scan=' + repr(_pc.document['scan']), 'intent=' + repr(_pc.document['intent']), 'observation=' + repr(_pc.document['observation']), 'scalebychan=' + repr(_pc.document['scalebychan']), 'standard=' + repr(_pc.document['standard']), 'model=' + repr(_pc.document['model']), 'listmodels=' + repr(_pc.document['listmodels']), 'fluxdensity=' + repr(_pc.document['fluxdensity']), 'spix=' + repr(_pc.document['spix']), 'reffreq=' + repr(_pc.document['reffreq']), 'polindex=' + repr(_pc.document['polindex']), 'polangle=' + repr(_pc.document['polangle']), 'rotmeas=' + repr(_pc.document['rotmeas']), 'fluxdict=' + repr(_pc.document['fluxdict']), 'useephemdir=' + repr(_pc.document['useephemdir']), 'interpolation=' + repr(_pc.document['interpolation']), 'usescratch=' + repr(_pc.document['usescratch']), 'ismms=' + repr(_pc.document['ismms']) ] )
         task_result = None
         try:
             task_result = _setjy_t( _pc.document['vis'], _pc.document['field'], _pc.document['spw'], _pc.document['selectdata'], _pc.document['timerange'], _pc.document['scan'], _pc.document['intent'], _pc.document['observation'], _pc.document['scalebychan'], _pc.document['standard'], _pc.document['model'], _pc.document['listmodels'], _pc.document['fluxdensity'], _pc.document['spix'], _pc.document['reffreq'], _pc.document['polindex'], _pc.document['polangle'], _pc.document['rotmeas'], _pc.document['fluxdict'], _pc.document['useephemdir'], _pc.document['interpolation'], _pc.document['usescratch'], _pc.document['ismms'] )
```

## casatasks/simobserve.py

```diff
@@ -1,9 +1,9 @@
 ##################### generated by xml-casa (v2) from simobserve.xml ################
-##################### fe9eb3fea861ddc8826c37705d9a43c7 ##############################
+##################### 0e3aaa53282e4e44cb7a3dfe57d8f593 ##############################
 from __future__ import absolute_import
 import numpy
 from casatools.typecheck import CasaValidator as _val_ctor
 _pc = _val_ctor( )
 from casatools.coercetype import coerce as _coerce
 from casatools.errors import create_error_string
 from .private.task_simobserve import simobserve as _simobserve_t
@@ -27,18 +27,17 @@
     into output simulated images using simanalyze.
     
     ALMA users are encouraged to use the simalma task, which provides
     additional information on the multiple simobserve and simanalyze calls
     required to simulate an ALMA observation which may consist of 12m
     interferometric, 7m interferometric, and 12m total power data.
     
-    More information and examples are availible at
-    http://casaguides.nrao.edu/index.php?title=Simulating_Observations_in_CASA
-    Please contact the Helpdesk with any questions (see
-    https://casa.nrao.edu/help_desk_all.shtml)
+    More information and examples are availible in the CASA Guides (http://casaguides.nrao.edu) under Simulations.
+    Please contact the CASA Team with any questions (see
+    https://casa.nrao.edu/index_contact.shtml)
 
     --------- parameter descriptions ---------------------------------------------
 
     project         root prefix for output file names
     skymodel        Model image to observe
                     
                     * simobserve uses a CASA or fits image. If you
@@ -81,19 +80,21 @@
     incell          set new cell/pixel size
                     Subparameter of skymodel
                     Default: '' (use whatever is in the image
                     already)
                     
                        Example: incell='0.1arcsec'
     incenter        Frequency to use for the center channel (or only channel,
-                    if the skymodel is 2D)
+                    if the skymodel is 2D).
                     Subparameter of skymodel
                     Default: '' (use whatever is in the image
                     already)
                     
+                    		     This will also become the default rest frequency, e.g. when imaging with tclean.
+                    
                        Example: incenter='89GHz'
     inwidth         Set new channel width 
                       Subparameter of skymodel
                       Default: '' (use whatever is in the image
                       already)
                       
                       Should be a string representing a quantity with
@@ -304,17 +305,15 @@
                     Subparameter of
                     thermalnoise='tsys-atm|tsys-manual'
     t_sky           Atmospheric temperature in K
                     Subparameter of thermalnoise='tsys-manual'
     tau0            Zenith opacity at observing frequency
                     Subparameter of thermalnoise='tsys-manual'
                     
-                    https://casaguides.nrao.edu/index.php/Corrupt
-                    for more information on noise, in particular how
-                    to add a phase screen using the toolkit
+                    See the Simulations CASA Guide (https://casaguides.nrao.edu) on 'Corrupting Simulated Data' for more information on noise, in particular how to add a phase screen using the toolkit
     seed            Random number seed
                     Subparameter of
                     thermalnoise='tsys-atm|tsys-manual'
     leakage         add cross polarization corruption of this fractional
                     magnitude (interferometer only)
     graphics        View plots on the screen, saved to file, both, or neither
                     Options: screen|file|both|none
```

## casatasks/tclean.py

```diff
@@ -1,9 +1,9 @@
 ##################### generated by xml-casa (v2) from tclean.xml ####################
-##################### a67eec76023722587f91a92ba878e467 ##############################
+##################### e4216b74f32e985c533b81c5ecdbefef ##############################
 from __future__ import absolute_import
 import numpy
 from casatools.typecheck import CasaValidator as _val_ctor
 _pc = _val_ctor( )
 from casatools.coercetype import coerce as _coerce
 from casatools.errors import create_error_string
 from .private.task_tclean import tclean as _tclean_t
@@ -188,22 +188,25 @@
                          su.getOptimumSize(345) 
                          Output :  360
     cell                 Cell size
                          example: cell=['0.5arcsec,'0.5arcsec'] or
                          cell=['1arcmin', '1arcmin']
                          cell = '1arcsec' is equivalent to ['1arcsec','1arcsec']
     phasecenter          Phase center of the image (string or field id); if the phasecenter is the name known major solar system object ('MERCURY', 'VENUS', 'MARS', 'JUPITER', 'SATURN', 'URANUS', 'NEPTUNE', 'PLUTO', 'SUN', 'MOON') or is an ephemerides table then that source is tracked and the background sources get smeared. There is a special case, when phasecenter='TRACKFIELD', which will use the ephemerides or polynomial phasecenter in the FIELD table of the MS's as the source center to track.
-                         example: phasecenter=6
-                                  phasecenter='J2000 19h30m00 -40d00m00'
-                                  phasecenter='J2000 292.5deg  -40.0deg'
-                                  phasecenter='J2000 5.105rad  -0.698rad'
-                                  phasecenter='ICRS 13:05:27.2780 -049.28.04.458'
-                                  phasecenter='myComet_ephem.tab'
-                                  phasecenter='MOON'
-                                  phasecenter='TRACKFIELD'
+                         
+                              Note : If unspecified, tclean will use the phase-center from the first data field of the MS (or list of MSs) selected for imaging. 
+                         
+                         			example: phasecenter=6
+                         phasecenter='J2000 19h30m00 -40d00m00'
+                         phasecenter='J2000 292.5deg  -40.0deg'
+                         phasecenter='J2000 5.105rad  -0.698rad'
+                         phasecenter='ICRS 13:05:27.2780 -049.28.04.458'
+                         phasecenter='myComet_ephem.tab'
+                         phasecenter='MOON'
+                         phasecenter='TRACKFIELD'
     stokes               Stokes Planes to make
                          default='I'; example: stokes='IQUV';
                            Options: 'I','Q','U','V','IV','QU','IQ','UV','IQUV','RR','LL','XX','YY','RRLL','XXYY','pseudoI'
                          
                                        Note : Due to current internal code constraints, if any correlation pair
                                                   is flagged, by default, no data for that row in the MS will be used.
                                                   So, in an MS with XX,YY, if only YY is flagged, neither a
@@ -241,62 +244,105 @@
                          
                           Negative components in the model image will be included as is.
                          
                          [ Note : If an error occurs during image resampling/regridding,
                                       please try using task imregrid to resample the starting model
                                       image onto a CASA image with the target shape and
                                       coordinate system before supplying it via startmodel ]
-    specmode             Spectral definition mode (mfs,cube,cubedata, cubesource)
+    specmode             Spectral definition mode (mfs,cube,cubedata, cubesource, mvc)
                          
-                         mode='mfs' : Continuum imaging with only one output image channel.
-                                               (mode='cont' can also be used here)
+                         specmode='mfs' : Continuum imaging with only one output image channel.
+                                                        (mode='cont' can also be used here)
                          
-                         mode='cube' : Spectral line imaging with one or more channels
-                                                 Parameters start, width,and nchan define the spectral
-                                                 coordinate system and can be specified either in terms
-                                                 of channel numbers, frequency or velocity in whatever
-                                                 spectral frame is specified in 'outframe'.
-                                                 All internal and output images are made with outframe as the
-                                                 base spectral frame. However imaging code internally uses the fixed
-                                                 spectral frame, LSRK for automatic internal software
-                                                 Doppler tracking so that a spectral line observed over an
-                                                 extended time range will line up appropriately.
-                                                 Therefore the output images have additional spectral frame conversion
-                                                 layer in LSRK on the top the base frame.
+                         specmode='cube' : Spectral line imaging with one or more channels
+                                                        Parameters start, width,and nchan define the spectral
+                                                       coordinate system and can be specified either in terms
+                                                       of channel numbers, frequency or velocity in whatever
+                                                       spectral frame is specified in 'outframe'.
+                                                       All internal and output images are made with outframe as the
+                                                       base spectral frame. However imaging code internally uses the fixed
+                                                       spectral frame, LSRK for automatic internal software
+                                                       Doppler tracking so that a spectral line observed over an
+                                                       extended time range will line up appropriately.
+                                                       Therefore the output images have additional spectral frame conversion
+                                                        layer in LSRK on the top the base frame.
                          
                          
                                                  (Note : Even if the input parameters are specified in a frame
                                                              other than LSRK, the viewer still displays spectral
                                                              axis in LSRK by default because of the conversion frame
                                                              layer mentioned above. The viewer can be used to relabel
                                                              the spectral axis in any desired frame - via the spectral
                                                              reference option under axis label properties in the
                                                              data display options window.)
                          
                          
                                                  
                          
-                          mode='cubedata' : Spectral line imaging with one or more channels
+                         
+                          specmode='cubedata' : Spectral line imaging with one or more channels
                                                           There is no internal software Doppler tracking so
                                                           a spectral line observed over an extended time range
                                                           may be smeared out in frequency. There is strictly
                                                           no valid spectral frame with which to associate with the
                                                           output images, thus the image spectral  frame will
                                                           be labelled  "Undefined".
                          
                                                           
-                          mode='cubesource': Spectral line imaging while
+                          specmode='cubesource': Spectral line imaging while
                                                           tracking moving source (near field or solar system
                                                           objects). The velocity of the source is accounted
                                                           and the frequency reported is in the source frame.
                                                           As there is no "SOURCE" frame defined in CASA,
                                                           the frame in the image will be labelled "REST" (but do note the
                                                           velocity of a given line reported may be different from the rest frame
                                                           velocity if the emission region is moving w.r.t the systemic
                                                           velocity frame of the source)
+                         
+                          specmode='mvc' : Multiterm continuum imaging with cube major cycles. 
+                                                          This mode requires deconvolver='mtmfs' with nterms>1 
+                                                          and user-set choices of 'reffreq' and 'nchan'. 
+                         
+                                                          The output images and minor cycle are similar to specmode='mfs' 
+                                                          with deconvolver='mtmfs', but the major cycles are done in 
+                                                          cube mode (and require a setting of 'reffreq' and 'nchan'). 
+                                                          By default, frequency-dependent primary beam correction is 
+                                                          applied to each channel, before being combined across frequency
+                                                          to make the inputs to the 'mtmfs' deconvolver.  This results in 
+                                                          implicit wideband pb-correction, with the deconvolver seeing only
+                                                          the sky spectral structure.
+                         
+                                                          Note : There is currently no option to turn off wideband pb correction
+                                                          as part of the flat-sky normalization between the major and minor cycles.
+                                                          Therefore, 'mvc' with the 'standard' and 'wproject' gridders will also apply
+                                                          pblimits per channel, masking all regions outside of pblimit.                 	
+                                                          An option to retain sources outside the pblimit will be added in a future release. 
+                         
+                                                          Note : Below is some guidance for choosing 'nchan' and 'reffreq' :
+                                    
+                                                          The cube produced by the major cycle is used in a linear least square fits for Taylor
+                                                          polynomials per pixel. Therefore, one only needs as many channels in the cube, as
+                                                          required for an accurate polynomial fit for sources that have the strongest
+                                                          spectral structure.
+                         
+                                                          In general, 'nchan' needs to be greater than or equal to 'nterms', and the
+                                                          frequency range selected by the data will be evenly split into nchan channels.
+                                                          For a low-order polynomial fit, only a small number (around 10)
+                                                          channels are typically needed (for VLA/ALMA bandwidth ratios).
+                                                          'nchan=-1' applies a heuristic that results in a default of 10 cube channels
+                                                          for a 2:1 bandwidth ratio.
+                         
+                                                          nchan = MAX( bandwidth/(0.1*startfreq) ,  nterms+1 )
+                         
+                                                          Note: When running in parallel, the nchan selected may limit the speedup if it
+                                                          is smaller than the number of processes used.
+                         
+                                                          The 'reffreq' is the reference frequency used for the Taylor polynomial expansion.
+                                                          By default, in specmode='mvc', reffreq is set to the middle of the selected
+                                                          frequency range.
     reffreq              Reference frequency of the output image coordinate system
                          
                          Example :  reffreq='1.5GHz'    as a string with units.
                          
                          By default, it is calculated as the middle of the selected frequency range.
                          
                          For deconvolver='mtmfs' the Taylor expansion is also done about
@@ -1044,18 +1090,38 @@
                          
                          Note : Stand-alone PB-correction can be triggered by re-running
                                    tclean with the appropriate imagename and with
                                    niter=0, calcpsf=False, calcres=False, pbcor=True, vptable='vp.tab'
                                    ( where vp.tab is the name of the vpmanager file.
                                       See the inline help for the 'vptable' parameter )
                          
-                         Note : Multi-term PB correction that includes a correction for the
-                                   spectral index of the PB has not been enabled for the 4.7 release.
-                                   Please use the widebandpbcor task instead.
-                                   ( Wideband PB corrections are required when the amplitude of the
+                         Note : For deconvolver='mtmfs', pbcor will divide each Taylor term image by the .tt0 average PB.   
+                                    For all gridders, this calculation is accurate for small fractional bandwidths.  
+                         
+                                    For large fractional bandwidths, please use one of the following options.
+                         
+                                    (a) For single pointings, run the tclean task with specmode='mfs', deconvolver='mtmfs', 
+                                          and gridder='standard' with pbcor=True or False. 
+                                          If a PB-corrected spectral index is required, 
+                                          please use the widebandpbcor task to apply multi-tern PB-correction.
+                         
+                                    (b) For mosaics, run tclean task with specmode='mfs', deconvolver='mtmfs',
+                                          and gridder='awproject' , wbawp=True, conjbeams=True, with pbcor=True.  
+                                          This option applies wideband PB correction as part of the gridding step and
+                                          pbcor=True will be accurate because the spectral index map will already 
+                                          be PB-corrected. 
+                         
+                                    (c) For mosaics, run tclean with specmode='mvc', deconvolver='mtmfs', 
+                                          and gridder='standard' or 'mosaic' with pbcor=True.  
+                                          This option applies wideband PB-correction to channelized residual images
+                                          prior to the minor cycle and pbcor=True will be accurate because the spectral 
+                                          index map will already be PB-corrected. 
+                         
+                          Note : Frequency-dependent PB corrections are typically required for full-band imaging with the VLA. 
+                                      Wideband PB corrections are required when the amplitude of the
                                       brightest source is known accurately enough to be sensitive
                                       to the difference in the PB gain between the upper and lower
                                       end of the band at its location. As a guideline, the artificial spectral
                                       index due to the PB is -1.4 at the 0.5 gain level and less than -0.2
                                       at the 0.9 gain level at the middle frequency )
     outlierfile          Name of outlier-field image definitions
                          
@@ -1762,16 +1828,15 @@
 
     """
 
     _info_group_ = """imaging"""
     _info_desc_ = """Radio Interferometric Image Reconstruction"""
 
     def __call__( self, vis='', selectdata=True, field='', spw='', timerange='', uvrange='', antenna='', scan='', observation='', intent='', datacolumn='corrected', imagename='', imsize=[ int(100) ], cell=[  ], phasecenter='', stokes='I', projection='SIN', startmodel='', specmode='mfs', reffreq='', nchan=int(-1), start='', width='', outframe='LSRK', veltype='radio', restfreq=[  ], interpolation='linear', perchanweightdensity=True, gridder='standard', facets=int(1), psfphasecenter='', wprojplanes=int(1), vptable='', mosweight=True, aterm=True, psterm=False, wbawp=True, conjbeams=False, cfcache='', usepointing=False, computepastep=float(360.0), rotatepastep=float(360.0), pointingoffsetsigdev=[  ], pblimit=float(0.2), normtype='flatnoise', deconvolver='hogbom', scales=[  ], nterms=int(2), smallscalebias=float(0.0), fusedthreshold=float(0.0), largestscale=int(-1), restoration=True, restoringbeam=[  ], pbcor=False, outlierfile='', weighting='natural', robust=float(0.5), noise='1.0Jy', npixels=int(0), uvtaper=[ '' ], niter=int(0), gain=float(0.1), threshold=float(0.0), nsigma=float(0.0), cycleniter=int(-1), cyclefactor=float(1.0), minpsffraction=float(0.05), maxpsffraction=float(0.8), interactive=False, nmajor=int(-1), fullsummary=False, usemask='user', mask='', pbmask=float(0.0), sidelobethreshold=float(3.0), noisethreshold=float(5.0), lownoisethreshold=float(1.5), negativethreshold=float(0.0), smoothfactor=float(1.0), minbeamfrac=float(0.3), cutthreshold=float(0.01), growiterations=int(75), dogrowprune=True, minpercentchange=float(-1.0), verbose=False, fastnoise=True, restart=True, savemodel='none', calcres=True, calcpsf=True, psfcutoff=float(0.35), parallel=False ):
-        schema = {'vis': {'anyof': [{'type': 'cReqPath', 'coerce': _coerce.expand_path}, {'type': 'cReqPathVec', 'coerce': [_coerce.to_list,_coerce.expand_pathvec]}]}, 'selectdata': {'type': 'cBool'}, 'field': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'spw': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'timerange': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'uvrange': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'antenna': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'scan': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'observation': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cInt'}]}, 'intent': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'datacolumn': {'type': 'cStr', 'coerce': _coerce.to_str}, 'imagename': {'anyof': [{'type': 'cInt'}, {'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'imsize': {'anyof': [{'type': 'cInt'}, {'type': 'cIntVec', 'coerce': [_coerce.to_list,_coerce.to_intvec]}]}, 'cell': {'anyof': [{'type': 'cIntVec', 'coerce': [_coerce.to_list,_coerce.to_intvec]}, {'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cFloat', 'coerce': _coerce.to_float}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}, {'type': 'cInt'}, {'type': 'cFloatVec', 'coerce': [_coerce.to_list,_coerce.to_floatvec]}]}, 'phasecenter': {'anyof': [{'type': 'cInt'}, {'type': 'cStr', 'coerce': _coerce.to_str}]}, 'stokes': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'I', 'IQUV', 'UV', 'RRLL', 'IQ', 'V', 'pseudoI', 'QU', 'YY', 'RR', 'Q', 'U', 'IV', 'XX', 'XXYY', 'LL' ]}, 'projection': {'type': 'cStr', 'coerce': _coerce.to_str}, 'startmodel': {'type': 'cVariant', 'coerce': [_coerce.to_variant]}, 'specmode': {'type': 'cVariant', 'coerce': [_coerce.to_variant] # <allowed> IS NOT ALLOWED FOR A PARAMETER OF TYPE any
-}, 'reffreq': {'type': 'cVariant', 'coerce': [_coerce.to_variant]}, 'nchan': {'type': 'cInt'}, 'start': {'type': 'cVariant', 'coerce': [_coerce.to_variant]}, 'width': {'type': 'cVariant', 'coerce': [_coerce.to_variant]}, 'outframe': {'type': 'cStr', 'coerce': _coerce.to_str}, 'veltype': {'type': 'cStr', 'coerce': _coerce.to_str}, 'restfreq': {'type': 'cVariant', 'coerce': [_coerce.to_variant]}, 'interpolation': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'nearest', 'linear', 'cubic' ]}, 'perchanweightdensity': {'type': 'cBool'}, 'gridder': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'widefield', 'wproject', 'imagemosaic', 'standard', 'awproject', 'wprojectft', 'mosaicft', 'ft', 'ftmosaic', 'mosaic', 'awprojectft', 'gridft' ]}, 'facets': {'type': 'cInt'}, 'psfphasecenter': {'anyof': [{'type': 'cInt'}, {'type': 'cStr', 'coerce': _coerce.to_str}]}, 'wprojplanes': {'type': 'cInt'}, 'vptable': {'type': 'cStr', 'coerce': _coerce.to_str}, 'mosweight': {'type': 'cBool'}, 'aterm': {'type': 'cBool'}, 'psterm': {'type': 'cBool'}, 'wbawp': {'type': 'cBool'}, 'conjbeams': {'type': 'cBool'}, 'cfcache': {'type': 'cStr', 'coerce': _coerce.to_str}, 'usepointing': {'type': 'cBool'}, 'computepastep': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'rotatepastep': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'pointingoffsetsigdev': {'anyof': [{'type': 'cIntVec', 'coerce': [_coerce.to_list,_coerce.to_intvec]}, {'type': 'cFloatVec', 'coerce': [_coerce.to_list,_coerce.to_floatvec]}]}, 'pblimit': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'normtype': {'type': 'cStr', 'coerce': _coerce.to_str}, 'deconvolver': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'clarkstokes_exp', 'mtmfs', 'mem', 'clarkstokes', 'hogbom', 'clark_exp', 'clark', 'asp', 'multiscale' ]}, 'scales': {'anyof': [{'type': 'cIntVec', 'coerce': [_coerce.to_list,_coerce.to_intvec]}, {'type': 'cFloatVec', 'coerce': [_coerce.to_list,_coerce.to_floatvec]}]}, 'nterms': {'type': 'cInt'}, 'smallscalebias': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'fusedthreshold': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'largestscale': {'type': 'cInt'}, 'restoration': {'type': 'cBool'}, 'restoringbeam': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'pbcor': {'type': 'cBool'}, 'outlierfile': {'type': 'cStr', 'coerce': _coerce.to_str}, 'weighting': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'briggsabs', 'briggs', 'briggsbwtaper', 'natural', 'radial', 'superuniform', 'uniform' ]}, 'robust': {'type': 'cFloat', 'coerce': _coerce.to_float, 'min': -2.0, 'max': 2.0}, 'noise': {'type': 'cVariant', 'coerce': [_coerce.to_variant]}, 'npixels': {'type': 'cInt'}, 'uvtaper': {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}, 'niter': {'type': 'cInt'}, 'gain': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'threshold': {'type': 'cVariant', 'coerce': [_coerce.to_variant]}, 'nsigma': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'cycleniter': {'type': 'cInt'}, 'cyclefactor': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'minpsffraction': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'maxpsffraction': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'interactive': {'type': 'cBool'}, 'nmajor': {'type': 'cInt'}, 'fullsummary': {'type': 'cBool'}, 'usemask': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'user', 'pb', 'auto-multithresh' ]}, 'mask': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'pbmask': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'sidelobethreshold': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'noisethreshold': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'lownoisethreshold': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'negativethreshold': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'smoothfactor': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'minbeamfrac': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'cutthreshold': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'growiterations': {'type': 'cInt'}, 'dogrowprune': {'type': 'cBool'}, 'minpercentchange': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'verbose': {'type': 'cBool'}, 'fastnoise': {'type': 'cBool'}, 'restart': {'type': 'cBool'}, 'savemodel': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'none', 'virtual', 'modelcolumn' ]}, 'calcres': {'type': 'cBool'}, 'calcpsf': {'type': 'cBool'}, 'psfcutoff': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'parallel': {'type': 'cBool'}}
+        schema = {'vis': {'anyof': [{'type': 'cReqPath', 'coerce': _coerce.expand_path}, {'type': 'cReqPathVec', 'coerce': [_coerce.to_list,_coerce.expand_pathvec]}]}, 'selectdata': {'type': 'cBool'}, 'field': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'spw': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'timerange': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'uvrange': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'antenna': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'scan': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'observation': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cInt'}]}, 'intent': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'datacolumn': {'type': 'cStr', 'coerce': _coerce.to_str}, 'imagename': {'anyof': [{'type': 'cInt'}, {'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'imsize': {'anyof': [{'type': 'cInt'}, {'type': 'cIntVec', 'coerce': [_coerce.to_list,_coerce.to_intvec]}]}, 'cell': {'anyof': [{'type': 'cIntVec', 'coerce': [_coerce.to_list,_coerce.to_intvec]}, {'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cFloat', 'coerce': _coerce.to_float}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}, {'type': 'cInt'}, {'type': 'cFloatVec', 'coerce': [_coerce.to_list,_coerce.to_floatvec]}]}, 'phasecenter': {'anyof': [{'type': 'cInt'}, {'type': 'cStr', 'coerce': _coerce.to_str}]}, 'stokes': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'I', 'IQUV', 'UV', 'RRLL', 'IQ', 'V', 'pseudoI', 'QU', 'YY', 'RR', 'Q', 'U', 'IV', 'XX', 'XXYY', 'LL' ]}, 'projection': {'type': 'cStr', 'coerce': _coerce.to_str}, 'startmodel': {'type': 'cVariant', 'coerce': [_coerce.to_variant]}, 'specmode': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'cont', 'cubedata', 'cube', 'cubesource', 'mfs', 'mvc' ]}, 'reffreq': {'type': 'cVariant', 'coerce': [_coerce.to_variant]}, 'nchan': {'type': 'cInt'}, 'start': {'type': 'cVariant', 'coerce': [_coerce.to_variant]}, 'width': {'type': 'cVariant', 'coerce': [_coerce.to_variant]}, 'outframe': {'type': 'cStr', 'coerce': _coerce.to_str}, 'veltype': {'type': 'cStr', 'coerce': _coerce.to_str}, 'restfreq': {'type': 'cVariant', 'coerce': [_coerce.to_variant]}, 'interpolation': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'nearest', 'linear', 'cubic' ]}, 'perchanweightdensity': {'type': 'cBool'}, 'gridder': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'widefield', 'wproject', 'imagemosaic', 'standard', 'awproject', 'wprojectft', 'mosaicft', 'ft', 'ftmosaic', 'mosaic', 'awprojectft', 'gridft' ]}, 'facets': {'type': 'cInt'}, 'psfphasecenter': {'anyof': [{'type': 'cInt'}, {'type': 'cStr', 'coerce': _coerce.to_str}]}, 'wprojplanes': {'type': 'cInt'}, 'vptable': {'type': 'cStr', 'coerce': _coerce.to_str}, 'mosweight': {'type': 'cBool'}, 'aterm': {'type': 'cBool'}, 'psterm': {'type': 'cBool'}, 'wbawp': {'type': 'cBool'}, 'conjbeams': {'type': 'cBool'}, 'cfcache': {'type': 'cStr', 'coerce': _coerce.to_str}, 'usepointing': {'type': 'cBool'}, 'computepastep': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'rotatepastep': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'pointingoffsetsigdev': {'anyof': [{'type': 'cIntVec', 'coerce': [_coerce.to_list,_coerce.to_intvec]}, {'type': 'cFloatVec', 'coerce': [_coerce.to_list,_coerce.to_floatvec]}]}, 'pblimit': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'normtype': {'type': 'cStr', 'coerce': _coerce.to_str}, 'deconvolver': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'clarkstokes_exp', 'mtmfs', 'mem', 'clarkstokes', 'hogbom', 'clark_exp', 'clark', 'asp', 'multiscale' ]}, 'scales': {'anyof': [{'type': 'cIntVec', 'coerce': [_coerce.to_list,_coerce.to_intvec]}, {'type': 'cFloatVec', 'coerce': [_coerce.to_list,_coerce.to_floatvec]}]}, 'nterms': {'type': 'cInt'}, 'smallscalebias': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'fusedthreshold': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'largestscale': {'type': 'cInt'}, 'restoration': {'type': 'cBool'}, 'restoringbeam': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'pbcor': {'type': 'cBool'}, 'outlierfile': {'type': 'cStr', 'coerce': _coerce.to_str}, 'weighting': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'briggsabs', 'briggs', 'briggsbwtaper', 'natural', 'radial', 'superuniform', 'uniform' ]}, 'robust': {'type': 'cFloat', 'coerce': _coerce.to_float, 'min': -2.0, 'max': 2.0}, 'noise': {'type': 'cVariant', 'coerce': [_coerce.to_variant]}, 'npixels': {'type': 'cInt'}, 'uvtaper': {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}, 'niter': {'type': 'cInt'}, 'gain': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'threshold': {'type': 'cVariant', 'coerce': [_coerce.to_variant]}, 'nsigma': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'cycleniter': {'type': 'cInt'}, 'cyclefactor': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'minpsffraction': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'maxpsffraction': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'interactive': {'type': 'cBool'}, 'nmajor': {'type': 'cInt'}, 'fullsummary': {'type': 'cBool'}, 'usemask': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'user', 'pb', 'auto-multithresh' ]}, 'mask': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'pbmask': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'sidelobethreshold': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'noisethreshold': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'lownoisethreshold': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'negativethreshold': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'smoothfactor': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'minbeamfrac': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'cutthreshold': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'growiterations': {'type': 'cInt'}, 'dogrowprune': {'type': 'cBool'}, 'minpercentchange': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'verbose': {'type': 'cBool'}, 'fastnoise': {'type': 'cBool'}, 'restart': {'type': 'cBool'}, 'savemodel': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'none', 'virtual', 'modelcolumn' ]}, 'calcres': {'type': 'cBool'}, 'calcpsf': {'type': 'cBool'}, 'psfcutoff': {'type': 'cFloat', 'coerce': _coerce.to_float}, 'parallel': {'type': 'cBool'}}
         doc = {'vis': vis, 'selectdata': selectdata, 'field': field, 'spw': spw, 'timerange': timerange, 'uvrange': uvrange, 'antenna': antenna, 'scan': scan, 'observation': observation, 'intent': intent, 'datacolumn': datacolumn, 'imagename': imagename, 'imsize': imsize, 'cell': cell, 'phasecenter': phasecenter, 'stokes': stokes, 'projection': projection, 'startmodel': startmodel, 'specmode': specmode, 'reffreq': reffreq, 'nchan': nchan, 'start': start, 'width': width, 'outframe': outframe, 'veltype': veltype, 'restfreq': restfreq, 'interpolation': interpolation, 'perchanweightdensity': perchanweightdensity, 'gridder': gridder, 'facets': facets, 'psfphasecenter': psfphasecenter, 'wprojplanes': wprojplanes, 'vptable': vptable, 'mosweight': mosweight, 'aterm': aterm, 'psterm': psterm, 'wbawp': wbawp, 'conjbeams': conjbeams, 'cfcache': cfcache, 'usepointing': usepointing, 'computepastep': computepastep, 'rotatepastep': rotatepastep, 'pointingoffsetsigdev': pointingoffsetsigdev, 'pblimit': pblimit, 'normtype': normtype, 'deconvolver': deconvolver, 'scales': scales, 'nterms': nterms, 'smallscalebias': smallscalebias, 'fusedthreshold': fusedthreshold, 'largestscale': largestscale, 'restoration': restoration, 'restoringbeam': restoringbeam, 'pbcor': pbcor, 'outlierfile': outlierfile, 'weighting': weighting, 'robust': robust, 'noise': noise, 'npixels': npixels, 'uvtaper': uvtaper, 'niter': niter, 'gain': gain, 'threshold': threshold, 'nsigma': nsigma, 'cycleniter': cycleniter, 'cyclefactor': cyclefactor, 'minpsffraction': minpsffraction, 'maxpsffraction': maxpsffraction, 'interactive': interactive, 'nmajor': nmajor, 'fullsummary': fullsummary, 'usemask': usemask, 'mask': mask, 'pbmask': pbmask, 'sidelobethreshold': sidelobethreshold, 'noisethreshold': noisethreshold, 'lownoisethreshold': lownoisethreshold, 'negativethreshold': negativethreshold, 'smoothfactor': smoothfactor, 'minbeamfrac': minbeamfrac, 'cutthreshold': cutthreshold, 'growiterations': growiterations, 'dogrowprune': dogrowprune, 'minpercentchange': minpercentchange, 'verbose': verbose, 'fastnoise': fastnoise, 'restart': restart, 'savemodel': savemodel, 'calcres': calcres, 'calcpsf': calcpsf, 'psfcutoff': psfcutoff, 'parallel': parallel}
         assert _pc.validate(doc,schema), create_error_string(_pc.errors)
         _logging_state_ = _start_log( 'tclean', [ 'vis=' + repr(_pc.document['vis']), 'selectdata=' + repr(_pc.document['selectdata']), 'field=' + repr(_pc.document['field']), 'spw=' + repr(_pc.document['spw']), 'timerange=' + repr(_pc.document['timerange']), 'uvrange=' + repr(_pc.document['uvrange']), 'antenna=' + repr(_pc.document['antenna']), 'scan=' + repr(_pc.document['scan']), 'observation=' + repr(_pc.document['observation']), 'intent=' + repr(_pc.document['intent']), 'datacolumn=' + repr(_pc.document['datacolumn']), 'imagename=' + repr(_pc.document['imagename']), 'imsize=' + repr(_pc.document['imsize']), 'cell=' + repr(_pc.document['cell']), 'phasecenter=' + repr(_pc.document['phasecenter']), 'stokes=' + repr(_pc.document['stokes']), 'projection=' + repr(_pc.document['projection']), 'startmodel=' + repr(_pc.document['startmodel']), 'specmode=' + repr(_pc.document['specmode']), 'reffreq=' + repr(_pc.document['reffreq']), 'nchan=' + repr(_pc.document['nchan']), 'start=' + repr(_pc.document['start']), 'width=' + repr(_pc.document['width']), 'outframe=' + repr(_pc.document['outframe']), 'veltype=' + repr(_pc.document['veltype']), 'restfreq=' + repr(_pc.document['restfreq']), 'interpolation=' + repr(_pc.document['interpolation']), 'perchanweightdensity=' + repr(_pc.document['perchanweightdensity']), 'gridder=' + repr(_pc.document['gridder']), 'facets=' + repr(_pc.document['facets']), 'psfphasecenter=' + repr(_pc.document['psfphasecenter']), 'wprojplanes=' + repr(_pc.document['wprojplanes']), 'vptable=' + repr(_pc.document['vptable']), 'mosweight=' + repr(_pc.document['mosweight']), 'aterm=' + repr(_pc.document['aterm']), 'psterm=' + repr(_pc.document['psterm']), 'wbawp=' + repr(_pc.document['wbawp']), 'conjbeams=' + repr(_pc.document['conjbeams']), 'cfcache=' + repr(_pc.document['cfcache']), 'usepointing=' + repr(_pc.document['usepointing']), 'computepastep=' + repr(_pc.document['computepastep']), 'rotatepastep=' + repr(_pc.document['rotatepastep']), 'pointingoffsetsigdev=' + repr(_pc.document['pointingoffsetsigdev']), 'pblimit=' + repr(_pc.document['pblimit']), 'normtype=' + repr(_pc.document['normtype']), 'deconvolver=' + repr(_pc.document['deconvolver']), 'scales=' + repr(_pc.document['scales']), 'nterms=' + repr(_pc.document['nterms']), 'smallscalebias=' + repr(_pc.document['smallscalebias']), 'fusedthreshold=' + repr(_pc.document['fusedthreshold']), 'largestscale=' + repr(_pc.document['largestscale']), 'restoration=' + repr(_pc.document['restoration']), 'restoringbeam=' + repr(_pc.document['restoringbeam']), 'pbcor=' + repr(_pc.document['pbcor']), 'outlierfile=' + repr(_pc.document['outlierfile']), 'weighting=' + repr(_pc.document['weighting']), 'robust=' + repr(_pc.document['robust']), 'noise=' + repr(_pc.document['noise']), 'npixels=' + repr(_pc.document['npixels']), 'uvtaper=' + repr(_pc.document['uvtaper']), 'niter=' + repr(_pc.document['niter']), 'gain=' + repr(_pc.document['gain']), 'threshold=' + repr(_pc.document['threshold']), 'nsigma=' + repr(_pc.document['nsigma']), 'cycleniter=' + repr(_pc.document['cycleniter']), 'cyclefactor=' + repr(_pc.document['cyclefactor']), 'minpsffraction=' + repr(_pc.document['minpsffraction']), 'maxpsffraction=' + repr(_pc.document['maxpsffraction']), 'interactive=' + repr(_pc.document['interactive']), 'nmajor=' + repr(_pc.document['nmajor']), 'fullsummary=' + repr(_pc.document['fullsummary']), 'usemask=' + repr(_pc.document['usemask']), 'mask=' + repr(_pc.document['mask']), 'pbmask=' + repr(_pc.document['pbmask']), 'sidelobethreshold=' + repr(_pc.document['sidelobethreshold']), 'noisethreshold=' + repr(_pc.document['noisethreshold']), 'lownoisethreshold=' + repr(_pc.document['lownoisethreshold']), 'negativethreshold=' + repr(_pc.document['negativethreshold']), 'smoothfactor=' + repr(_pc.document['smoothfactor']), 'minbeamfrac=' + repr(_pc.document['minbeamfrac']), 'cutthreshold=' + repr(_pc.document['cutthreshold']), 'growiterations=' + repr(_pc.document['growiterations']), 'dogrowprune=' + repr(_pc.document['dogrowprune']), 'minpercentchange=' + repr(_pc.document['minpercentchange']), 'verbose=' + repr(_pc.document['verbose']), 'fastnoise=' + repr(_pc.document['fastnoise']), 'restart=' + repr(_pc.document['restart']), 'savemodel=' + repr(_pc.document['savemodel']), 'calcres=' + repr(_pc.document['calcres']), 'calcpsf=' + repr(_pc.document['calcpsf']), 'psfcutoff=' + repr(_pc.document['psfcutoff']), 'parallel=' + repr(_pc.document['parallel']) ] )
         task_result = None
         try:
             task_result = _tclean_t( _pc.document['vis'], _pc.document['selectdata'], _pc.document['field'], _pc.document['spw'], _pc.document['timerange'], _pc.document['uvrange'], _pc.document['antenna'], _pc.document['scan'], _pc.document['observation'], _pc.document['intent'], _pc.document['datacolumn'], _pc.document['imagename'], _pc.document['imsize'], _pc.document['cell'], _pc.document['phasecenter'], _pc.document['stokes'], _pc.document['projection'], _pc.document['startmodel'], _pc.document['specmode'], _pc.document['reffreq'], _pc.document['nchan'], _pc.document['start'], _pc.document['width'], _pc.document['outframe'], _pc.document['veltype'], _pc.document['restfreq'], _pc.document['interpolation'], _pc.document['perchanweightdensity'], _pc.document['gridder'], _pc.document['facets'], _pc.document['psfphasecenter'], _pc.document['wprojplanes'], _pc.document['vptable'], _pc.document['mosweight'], _pc.document['aterm'], _pc.document['psterm'], _pc.document['wbawp'], _pc.document['conjbeams'], _pc.document['cfcache'], _pc.document['usepointing'], _pc.document['computepastep'], _pc.document['rotatepastep'], _pc.document['pointingoffsetsigdev'], _pc.document['pblimit'], _pc.document['normtype'], _pc.document['deconvolver'], _pc.document['scales'], _pc.document['nterms'], _pc.document['smallscalebias'], _pc.document['fusedthreshold'], _pc.document['largestscale'], _pc.document['restoration'], _pc.document['restoringbeam'], _pc.document['pbcor'], _pc.document['outlierfile'], _pc.document['weighting'], _pc.document['robust'], _pc.document['noise'], _pc.document['npixels'], _pc.document['uvtaper'], _pc.document['niter'], _pc.document['gain'], _pc.document['threshold'], _pc.document['nsigma'], _pc.document['cycleniter'], _pc.document['cyclefactor'], _pc.document['minpsffraction'], _pc.document['maxpsffraction'], _pc.document['interactive'], _pc.document['nmajor'], _pc.document['fullsummary'], _pc.document['usemask'], _pc.document['mask'], _pc.document['pbmask'], _pc.document['sidelobethreshold'], _pc.document['noisethreshold'], _pc.document['lownoisethreshold'], _pc.document['negativethreshold'], _pc.document['smoothfactor'], _pc.document['minbeamfrac'], _pc.document['cutthreshold'], _pc.document['growiterations'], _pc.document['dogrowprune'], _pc.document['minpercentchange'], _pc.document['verbose'], _pc.document['fastnoise'], _pc.document['restart'], _pc.document['savemodel'], _pc.document['calcres'], _pc.document['calcpsf'], _pc.document['psfcutoff'], _pc.document['parallel'] )
         except Exception as exc:
```

## casatasks/tsdimaging.py

```diff
@@ -1,9 +1,9 @@
 ##################### generated by xml-casa (v2) from tsdimaging.xml ################
-##################### 0522846f652aa36987e18cd7a467d7d6 ##############################
+##################### 2d7f46f4a73503efdef1a7aaf32a62c9 ##############################
 from __future__ import absolute_import
 import numpy
 from casatools.typecheck import CasaValidator as _val_ctor
 _pc = _val_ctor( )
 from casatools.coercetype import coerce as _coerce
 from casatools.errors import create_error_string
 from .private.task_tsdimaging import tsdimaging as _tsdimaging_t
@@ -63,36 +63,37 @@
     overwrite      overwrite the output file if already exists [True, False]
     field          select data by field IDs and names, e.g. \'3C2*\' (\'\'=all)
     spw            select data by IF IDs (spectral windows), e.g. \'3,5,7\' (\'\'=all)
     antenna        select data by antenna names or IDs, e.g, \'PM03\' (\'\' = all antennas)
     scan           select data by scan numbers, e.g. \'21~23\' (\'\'=all)
     intent         select data by observational intent, e.g. \'*ON_SOURCE*\' (\'\'=all)
     timerange      select data by range of time, e.g. 20:15:00~20:16:00 (\'\'=all)
-    mode           spectral gridding type
+    outframe       velocity frame of output image (''=current frame or LSRK for multiple-MS inputs)
+    mode           spectral gridding type [\'channel\', \'frequency\', \'velocity\']
     nchan          number of channels (planes) in output image (-1=all)
     start          start of output spectral dimension, e.g. \'0\', \'110GHz\', \'-20km/s\'
     width          width of output spectral channels
     veltype        velocity definition
     specmode       Spectral definition mode (cube, cubedata, cubesource)
-    outframe       velocity frame of output image (''=current frame or LSRK for multiple-MS inputs)
+    pointingcolumn pointing data column to use
+    convertfirst   Specify whether the direction of the specified pointing column must be converted to image"s reference frame prior to being interpolated at data-taking time, and when. "never": interpolate against the pointing column, then convert.  "always": interpolate against the beforehand converted pointing column. "auto": if there are less pointings than selected data rows convert first, else interpolate first
+    projection     map projection type
+    imsize         x and y image size in pixels, e.g., [64,64]. Single value: same for both spatial axes ([] = number of pixels to cover whole pointings in MSes)
+    cell           x and y cell size, (e.g., [\'8arcsec\',\'8arcsec\']. default unit arcmin. ('' = 1/3 of FWHM of primary beam)
+    phasecenter    image center direction: position or field index or ephemeris source info, e.g., \'J2000 17:30:15.0 -25.30.00.0\', \'MARS\'. (\'\' = the center of pointing directions in MSes)
+    stokes         stokes parameters or polarization types to image, e.g. \'I\', \'XX\'
     gridfunction   gridding function for imaging (see description in help)
     convsupport    convolution support for gridding
     truncate       truncation radius for gridding
     gwidth         HWHM for gaussian
     jwidth         c-parameter for jinc function
-    imsize         x and y image size in pixels, e.g., [64,64]. Single value: same for both spatial axes ([] = number of pixels to cover whole pointings in MSes)
-    cell           x and y cell size, (e.g., [\'8arcsec\',\'8arcsec\']. default unit arcmin. ('' = 1/3 of FWHM of primary beam)
-    phasecenter    image center direction: position or field index or ephemeris source info, e.g., \'J2000 17:30:15.0 -25.30.00.0\', \'MARS\'. (\'\' = the center of pointing directions in MSes)
-    projection     map projection type
-    pointingcolumn pointing data column to use
-    restfreq       rest frequency to assign to image, e.g., \'114.5GHz\'. When the default value \'\' is used, the task currently internally uses REST_FREQUENCY of SOURCE table or mean frequency of given spectral window as a default value.
-    stokes         stokes parameters or polarization types to image, e.g. \'I\', \'XX\'
+    clipminmax     Clip minimum and maximum value from each pixel. Note the benefit of clipping is lost when the number of integrations contributing to each gridded pixel is small, or where the incidence of spurious datapoints is approximately or greater than the number of beams (in area) encompassed by expected image.
     minweight      Minimum weight ratio to the median of weight used in weight correction and weight beased masking
     brightnessunit Overwrite the brightness unit in image (\'\' = respect the unit in MS) [\'K\' or \'Jy/beam\']
-    clipminmax     Clip minimum and maximum value from each pixel. Note the benefit of clipping is lost when the number of integrations contributing to each gridded pixel is small, or where the incidence of spurious datapoints is approximately or greater than the number of beams (in area) encompassed by expected image.
+    restfreq       rest frequency to assign to image, e.g., \'114.5GHz\'. When the default value \'\' is used, the task currently internally uses REST_FREQUENCY of SOURCE table or mean frequency of given spectral window as a default value.
     [1;42mRETURNS[1;m           void
 
     --------- examples -----------------------------------------------------------
 
     
     Keyword arguments:
     infiles -- a list of names of input SD Measurementsets
@@ -389,22 +390,22 @@
 
 
     """
 
     _info_group_ = """single dish"""
     _info_desc_ = """SD task: imaging for total power and spectral data"""
 
-    def __call__( self, infiles=[  ], outfile='', overwrite=False, field='', spw='', antenna='', scan='', intent='OBSERVE_TARGET#ON_SOURCE', timerange='', mode='channel', nchan=int(-1), start=int(0), width=int(1), veltype='radio', specmode='cube', outframe='', gridfunction='BOX', convsupport=int(-1), truncate=int(-1), gwidth=int(-1), jwidth=int(-1), imsize=[  ], cell='', phasecenter='', projection='SIN', pointingcolumn='direction', restfreq='', stokes='I', minweight=float(0.1), brightnessunit='', clipminmax=False ):
-        schema = {'infiles': {'type': 'cReqPathVec', 'coerce': [_coerce.to_list,_coerce.expand_pathvec]}, 'outfile': {'type': 'cStr', 'coerce': _coerce.to_str}, 'overwrite': {'type': 'cBool'}, 'field': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'spw': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'antenna': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'scan': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'intent': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'timerange': {'type': 'cStr', 'coerce': _coerce.to_str}, 'mode': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'channel', 'frequency', 'velocity' ]}, 'nchan': {'type': 'cInt'}, 'start': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cInt'}]}, 'width': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cInt'}]}, 'veltype': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'OPTICAL', 'RELATIVISTIC', 'radio', 'true', 'optical', 'RADIO', 'TRUE', 'relativistic' ]}, 'specmode': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'cube', 'cubedata', 'cubesource' ]}, 'outframe': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'LSRK', 'CMB', 'geo', 'bary', 'GALACTO', 'GEO', 'TOPO', 'LSRD', 'lsrk', 'topo', 'LGROUP', 'BARY', 'lsrd', 'cmb', 'galacto', 'lgroup', '' ]}, 'gridfunction': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'GJINC', 'pb', 'sf', 'GAUSS', 'PB', 'SF', 'gauss', 'BOX', 'box', 'gjinc' ]}, 'convsupport': {'type': 'cInt'}, 'truncate': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cInt'}, {'type': 'cFloat', 'coerce': _coerce.to_float}]}, 'gwidth': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cInt'}, {'type': 'cFloat', 'coerce': _coerce.to_float}]}, 'jwidth': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cInt'}, {'type': 'cFloat', 'coerce': _coerce.to_float}]}, 'imsize': {'anyof': [{'type': 'cIntVec', 'coerce': [_coerce.to_list,_coerce.to_intvec]}, {'type': 'cFloatVec', 'coerce': [_coerce.to_list,_coerce.to_floatvec]}]}, 'cell': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}, {'type': 'cFloatVec', 'coerce': [_coerce.to_list,_coerce.to_floatvec]}]}, 'phasecenter': {'type': 'cVariant', 'coerce': [_coerce.to_variant]}, 'projection': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'sin', 'SIN', 'SFL', 'CAR', 'sfl', 'car', 'TAN', 'tan' ]}, 'pointingcolumn': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'TARGET', 'encoder', 'ENCODER', 'source_offset', 'pointing_offset', 'target', 'POINTING_OFFSET', 'DIRECTION', 'SOURCE_OFFSET', 'direction' ]}, 'restfreq': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cFloat', 'coerce': _coerce.to_float}]}, 'stokes': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'I', 'IQUV', 'UV', 'RRLL', 'IQ', 'V', 'pseudoI', 'QU', 'YY', 'RR', 'Q', 'U', 'IV', 'XX', 'XXYY', 'LL' ]}, 'minweight': {'type': 'cFloat', 'coerce': _coerce.to_float, 'min': 0}, 'brightnessunit': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ '', 'K', 'Jy/beam' ]}, 'clipminmax': {'type': 'cBool'}}
-        doc = {'infiles': infiles, 'outfile': outfile, 'overwrite': overwrite, 'field': field, 'spw': spw, 'antenna': antenna, 'scan': scan, 'intent': intent, 'timerange': timerange, 'mode': mode, 'nchan': nchan, 'start': start, 'width': width, 'veltype': veltype, 'specmode': specmode, 'outframe': outframe, 'gridfunction': gridfunction, 'convsupport': convsupport, 'truncate': truncate, 'gwidth': gwidth, 'jwidth': jwidth, 'imsize': imsize, 'cell': cell, 'phasecenter': phasecenter, 'projection': projection, 'pointingcolumn': pointingcolumn, 'restfreq': restfreq, 'stokes': stokes, 'minweight': minweight, 'brightnessunit': brightnessunit, 'clipminmax': clipminmax}
+    def __call__( self, infiles=[  ], outfile='', overwrite=False, field='', spw='', antenna='', scan='', intent='OBSERVE_TARGET#ON_SOURCE', timerange='', outframe='', mode='channel', nchan=int(-1), start=int(0), width=int(1), veltype='radio', specmode='cube', pointingcolumn='direction', convertfirst='never', projection='SIN', imsize=[  ], cell='', phasecenter='', stokes='I', gridfunction='BOX', convsupport=int(-1), truncate=int(-1), gwidth=int(-1), jwidth=int(-1), clipminmax=False, minweight=float(0.1), brightnessunit='', restfreq='' ):
+        schema = {'infiles': {'type': 'cReqPathVec', 'coerce': [_coerce.to_list,_coerce.expand_pathvec]}, 'outfile': {'type': 'cStr', 'coerce': _coerce.to_str}, 'overwrite': {'type': 'cBool'}, 'field': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'spw': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'antenna': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'scan': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'intent': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}]}, 'timerange': {'type': 'cStr', 'coerce': _coerce.to_str}, 'outframe': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'LSRK', 'CMB', 'geo', 'bary', 'GALACTO', 'GEO', 'TOPO', 'LSRD', 'lsrk', 'topo', 'LGROUP', 'BARY', 'lsrd', 'cmb', 'galacto', 'lgroup', '' ]}, 'mode': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'channel', 'frequency', 'velocity' ]}, 'nchan': {'type': 'cInt'}, 'start': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cInt'}]}, 'width': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cInt'}]}, 'veltype': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'OPTICAL', 'RELATIVISTIC', 'radio', 'true', 'optical', 'RADIO', 'TRUE', 'relativistic' ]}, 'specmode': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'cube', 'cubedata', 'cubesource' ]}, 'pointingcolumn': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'TARGET', 'encoder', 'ENCODER', 'source_offset', 'pointing_offset', 'target', 'POINTING_OFFSET', 'DIRECTION', 'SOURCE_OFFSET', 'direction' ]}, 'convertfirst': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'never', 'auto', 'always' ]}, 'projection': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'sin', 'SIN', 'SFL', 'CAR', 'sfl', 'car', 'TAN', 'tan' ]}, 'imsize': {'anyof': [{'type': 'cIntVec', 'coerce': [_coerce.to_list,_coerce.to_intvec]}, {'type': 'cFloatVec', 'coerce': [_coerce.to_list,_coerce.to_floatvec]}]}, 'cell': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cStrVec', 'coerce': [_coerce.to_list,_coerce.to_strvec]}, {'type': 'cFloatVec', 'coerce': [_coerce.to_list,_coerce.to_floatvec]}]}, 'phasecenter': {'type': 'cVariant', 'coerce': [_coerce.to_variant]}, 'stokes': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'I', 'IQUV', 'UV', 'RRLL', 'IQ', 'V', 'pseudoI', 'QU', 'YY', 'RR', 'Q', 'U', 'IV', 'XX', 'XXYY', 'LL' ]}, 'gridfunction': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ 'GJINC', 'pb', 'sf', 'GAUSS', 'PB', 'SF', 'gauss', 'BOX', 'box', 'gjinc' ]}, 'convsupport': {'type': 'cInt'}, 'truncate': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cInt'}, {'type': 'cFloat', 'coerce': _coerce.to_float}]}, 'gwidth': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cInt'}, {'type': 'cFloat', 'coerce': _coerce.to_float}]}, 'jwidth': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cInt'}, {'type': 'cFloat', 'coerce': _coerce.to_float}]}, 'clipminmax': {'type': 'cBool'}, 'minweight': {'type': 'cFloat', 'coerce': _coerce.to_float, 'min': 0}, 'brightnessunit': {'type': 'cStr', 'coerce': _coerce.to_str, 'allowed': [ '', 'K', 'Jy/beam' ]}, 'restfreq': {'anyof': [{'type': 'cStr', 'coerce': _coerce.to_str}, {'type': 'cFloat', 'coerce': _coerce.to_float}]}}
+        doc = {'infiles': infiles, 'outfile': outfile, 'overwrite': overwrite, 'field': field, 'spw': spw, 'antenna': antenna, 'scan': scan, 'intent': intent, 'timerange': timerange, 'outframe': outframe, 'mode': mode, 'nchan': nchan, 'start': start, 'width': width, 'veltype': veltype, 'specmode': specmode, 'pointingcolumn': pointingcolumn, 'convertfirst': convertfirst, 'projection': projection, 'imsize': imsize, 'cell': cell, 'phasecenter': phasecenter, 'stokes': stokes, 'gridfunction': gridfunction, 'convsupport': convsupport, 'truncate': truncate, 'gwidth': gwidth, 'jwidth': jwidth, 'clipminmax': clipminmax, 'minweight': minweight, 'brightnessunit': brightnessunit, 'restfreq': restfreq}
         assert _pc.validate(doc,schema), create_error_string(_pc.errors)
-        _logging_state_ = _start_log( 'tsdimaging', [ 'infiles=' + repr(_pc.document['infiles']), 'outfile=' + repr(_pc.document['outfile']), 'overwrite=' + repr(_pc.document['overwrite']), 'field=' + repr(_pc.document['field']), 'spw=' + repr(_pc.document['spw']), 'antenna=' + repr(_pc.document['antenna']), 'scan=' + repr(_pc.document['scan']), 'intent=' + repr(_pc.document['intent']), 'timerange=' + repr(_pc.document['timerange']), 'mode=' + repr(_pc.document['mode']), 'nchan=' + repr(_pc.document['nchan']), 'start=' + repr(_pc.document['start']), 'width=' + repr(_pc.document['width']), 'veltype=' + repr(_pc.document['veltype']), 'specmode=' + repr(_pc.document['specmode']), 'outframe=' + repr(_pc.document['outframe']), 'gridfunction=' + repr(_pc.document['gridfunction']), 'convsupport=' + repr(_pc.document['convsupport']), 'truncate=' + repr(_pc.document['truncate']), 'gwidth=' + repr(_pc.document['gwidth']), 'jwidth=' + repr(_pc.document['jwidth']), 'imsize=' + repr(_pc.document['imsize']), 'cell=' + repr(_pc.document['cell']), 'phasecenter=' + repr(_pc.document['phasecenter']), 'projection=' + repr(_pc.document['projection']), 'pointingcolumn=' + repr(_pc.document['pointingcolumn']), 'restfreq=' + repr(_pc.document['restfreq']), 'stokes=' + repr(_pc.document['stokes']), 'minweight=' + repr(_pc.document['minweight']), 'brightnessunit=' + repr(_pc.document['brightnessunit']), 'clipminmax=' + repr(_pc.document['clipminmax']) ] )
+        _logging_state_ = _start_log( 'tsdimaging', [ 'infiles=' + repr(_pc.document['infiles']), 'outfile=' + repr(_pc.document['outfile']), 'overwrite=' + repr(_pc.document['overwrite']), 'field=' + repr(_pc.document['field']), 'spw=' + repr(_pc.document['spw']), 'antenna=' + repr(_pc.document['antenna']), 'scan=' + repr(_pc.document['scan']), 'intent=' + repr(_pc.document['intent']), 'timerange=' + repr(_pc.document['timerange']), 'outframe=' + repr(_pc.document['outframe']), 'mode=' + repr(_pc.document['mode']), 'nchan=' + repr(_pc.document['nchan']), 'start=' + repr(_pc.document['start']), 'width=' + repr(_pc.document['width']), 'veltype=' + repr(_pc.document['veltype']), 'specmode=' + repr(_pc.document['specmode']), 'pointingcolumn=' + repr(_pc.document['pointingcolumn']), 'convertfirst=' + repr(_pc.document['convertfirst']), 'projection=' + repr(_pc.document['projection']), 'imsize=' + repr(_pc.document['imsize']), 'cell=' + repr(_pc.document['cell']), 'phasecenter=' + repr(_pc.document['phasecenter']), 'stokes=' + repr(_pc.document['stokes']), 'gridfunction=' + repr(_pc.document['gridfunction']), 'convsupport=' + repr(_pc.document['convsupport']), 'truncate=' + repr(_pc.document['truncate']), 'gwidth=' + repr(_pc.document['gwidth']), 'jwidth=' + repr(_pc.document['jwidth']), 'clipminmax=' + repr(_pc.document['clipminmax']), 'minweight=' + repr(_pc.document['minweight']), 'brightnessunit=' + repr(_pc.document['brightnessunit']), 'restfreq=' + repr(_pc.document['restfreq']) ] )
         task_result = None
         try:
-            task_result = _tsdimaging_t( _pc.document['infiles'], _pc.document['outfile'], _pc.document['overwrite'], _pc.document['field'], _pc.document['spw'], _pc.document['antenna'], _pc.document['scan'], _pc.document['intent'], _pc.document['timerange'], _pc.document['mode'], _pc.document['nchan'], _pc.document['start'], _pc.document['width'], _pc.document['veltype'], _pc.document['specmode'], _pc.document['outframe'], _pc.document['gridfunction'], _pc.document['convsupport'], _pc.document['truncate'], _pc.document['gwidth'], _pc.document['jwidth'], _pc.document['imsize'], _pc.document['cell'], _pc.document['phasecenter'], _pc.document['projection'], _pc.document['pointingcolumn'], _pc.document['restfreq'], _pc.document['stokes'], _pc.document['minweight'], _pc.document['brightnessunit'], _pc.document['clipminmax'] )
+            task_result = _tsdimaging_t( _pc.document['infiles'], _pc.document['outfile'], _pc.document['overwrite'], _pc.document['field'], _pc.document['spw'], _pc.document['antenna'], _pc.document['scan'], _pc.document['intent'], _pc.document['timerange'], _pc.document['outframe'], _pc.document['mode'], _pc.document['nchan'], _pc.document['start'], _pc.document['width'], _pc.document['veltype'], _pc.document['specmode'], _pc.document['pointingcolumn'], _pc.document['convertfirst'], _pc.document['projection'], _pc.document['imsize'], _pc.document['cell'], _pc.document['phasecenter'], _pc.document['stokes'], _pc.document['gridfunction'], _pc.document['convsupport'], _pc.document['truncate'], _pc.document['gwidth'], _pc.document['jwidth'], _pc.document['clipminmax'], _pc.document['minweight'], _pc.document['brightnessunit'], _pc.document['restfreq'] )
         except Exception as exc:
             _except_log('tsdimaging', exc)
             raise
         finally:
             task_result = _end_log( _logging_state_, 'tsdimaging', task_result )
         return task_result
```

## casatasks/widebandpbcor.py

```diff
@@ -1,9 +1,9 @@
 ##################### generated by xml-casa (v2) from widebandpbcor.xml #############
-##################### 1363f4a31fcc390190ae89db0dc7a350 ##############################
+##################### 16e4031e46f432d427545ca38fcd9618 ##############################
 from __future__ import absolute_import
 import numpy
 from casatools.typecheck import CasaValidator as _val_ctor
 _pc = _val_ctor( )
 from casatools.coercetype import coerce as _coerce
 from casatools.errors import create_error_string
 from .private.task_widebandpbcor import widebandpbcor as _widebandpbcor_t
@@ -11,15 +11,15 @@
 from casatasks.private.task_logging import end_log as _end_log
 from casatasks.private.task_logging import except_log as _except_log
 
 class _widebandpbcor:
     """
     widebandpbcor ---- Wideband PB-correction on the output of the MS-MFS algorithm
 
-    WideBand Primary-beam correction. It computes a set of PBs at the specified frequencies, calculates Taylor-coefficient images that represent the PB spectrum, performs a polynomial division to PB-correct the output Taylor-coefficient images from clean(nterms>1), and recompute spectral index (and curvature) using the PB-corrected Taylor-coefficient images
+    WideBand Primary-beam correction. It computes a set of PBs at the specified frequencies, calculates Taylor-coefficient images that represent the PB spectrum, performs a polynomial division to PB-correct the output Taylor-coefficient images from clean(nterms>1), and recompute spectral index (and curvature) using the PB-corrected Taylor-coefficient images.
 
     --------- parameter descriptions ---------------------------------------------
 
     vis        Name of measurement set.
     imagename  Name-prefix of multi-termimages to operate on.
     nterms     Number of taylor terms to use
     threshold  Intensity above which to re-calculate spectral index
```

## casatasks/__xml__/bandpass.xml

### casatasks/__xml__/bandpass.xml

```diff
@@ -273,15 +273,15 @@
                       'B' does a channel by channel solution for each
                       specified spw. 
                       'BPOLY' is somewhat experimental. It will fit an
                       nth order polynomial for the amplitude and phase
                       as a function of frequency. Only one fit is made
                       for all specified spw, and edge channels should
                       be omitted.
-                      Use taskname=plotcal in order to compare the
+                      Use taskname=plotms in order to compare the
                       results from B and BPOLY.
 
                          Example: bandtype='BPOLY'</description>
         <value>B</value>
         <allowed kind="enum">
           <value>B</value>
           <value>BPOLY</value>
```

## casatasks/__xml__/fixplanets.xml

### casatasks/__xml__/fixplanets.xml

```diff
@@ -51,17 +51,17 @@
                      Default: '' (use pointing table)
 
                         Example: 'J2000 19h30m00 -40d00m00'
 
                      The direction can either be given explicitly or
                      as the path to a JPL Horizons
                      ephemeris. Alternatively, the ephemeris table can
-                     also be provided as mime format file. For more
+                     also be provided using getephemtable task. For more
                      information, see the task pages of fixplanets in
-                     CASA Docs (https://casa.nrao.edu/casadocs/).</description>
+                     the CASA Docs.</description>
         <any type="variant"/>
         <value type="string"/>
       </param>
       <param name="refant" type="any">
         <shortdescription>Reference antenna name(s)</shortdescription>
         <description>Reference antenna name(s); a prioritized list may be
 specified
```

## casatasks/__xml__/flagdata.xml

### casatasks/__xml__/flagdata.xml

```diff
@@ -485,19 +485,23 @@
                      'NORM' followed by any of 'ALL', 'I', 'XX', 'YY',
                      'RR', 'LL', 'WVR' ('WVR' = water vapour
                      radiometer of ALMA data).
 
                         Example: correlation=&quot;XX,YY&quot;.
 
                      For modes clip, tfcrop or rflag, the default
-                     means ABS_ALL. If the input is cal table that
-                     does not contain a complex data column, the
-                     default will fall back to REAL_ALL.
+                     means ABS_ALL.
+                     If the input is cal table that does not contain
+                     a complex data column, the default will fall back
+                     to REAL_ALL.
                      For calibration tables, the solutions are:
                      'Sol1', 'Sol2', Sol3, Sol4.
+                     When using the 'ARG' option, the values of
+                     parameters such as clipminmax are expeced in
+                     units of radians.
 
                      NOTE: correlation selection is not supported for
                      modes other than clip, tfcrop or rflag in cal
                      tables.</description>
         <type>string</type>
         <type>stringVec</type>
         <value type="string"/>
```

## casatasks/__xml__/gaincal.xml

### casatasks/__xml__/gaincal.xml

```diff
@@ -223,16 +223,20 @@
                         use EA23 and EA13 as alternates if/when EA02
                         drops out)
 
                      Use taskname=listobs for antenna listing</description>
         <value/>
       </param>
       <param name="refantmode" type="string">
-        <shortdescription>Reference antenna mode</shortdescription>
-        <description>Reference antenna mode</description>
+        <shortdescription>Reference antenna mode (flex, strict)</shortdescription>
+        <description>Reference antenna mode
+                     Default: 'flex'
+
+                   - 'flex': If the preferred or current refant drops out, switch to another. Alternate reference antennas will be chosen from the refant parameter (if a nontrivial list of antennas is specified), or according to proximity to the last-used refant. If and when the preferred refant returns, the referencing will switch back to it. 
+                   - 'strict': If the preferred or current refant is absent for a solution, flag all antennas at that solution. This mode ensures that the effective cross-hand phase will be maintained constant and equal to that of the chosen refant, and not subject to variation due to finite SNR when switching among reference antennas. If a list of antennas is specified in refant, only the first is used.</description>
         <value>flex</value>
         <allowed kind="enum">
           <value>flex</value>
           <value>strict</value>
         </allowed>
       </param>
       <param name="minblperant" type="int">
```

## casatasks/__xml__/imstat.xml

### casatasks/__xml__/imstat.xml

```diff
@@ -160,293 +160,10 @@
               <value>3</value>
             </default>
           </equals>
         </when>
       </constraints>
     </input>
     <returns type="void"/>
-    <example>Many parameters are determined from the specified region of an image.
-     For this version, the region can be specified by a set of rectangular
-     pixel coordinates, the channel ranges and the Stokes.
-
-     For directed output, run as 
-                    myoutput = imstat()
-   
-
-Keyword arguments:
-imagename    Name of input image
-             Default: none; Example: imagename='ngc5921_task.im'
-axes         axes to compute statistics over. -1 =&gt; all axes.
-region       Region selection. Default is
-             to use the full image.
-box          Rectangular region(s) to select in direction plane. See
-             Default is to use the entire direction plane.
-             Example: box='10,10,50,50'
-             box = '10,10,30,30,35,35,50,50' (two boxes)
-chans        Channels to use. Default is to use all channels.
-             Example: chans='3~20'    
-stokes       Stokes planes to use. Default is to
-             use all Stokes planes.
-             Example:stokes='I,Q'
-listit       Print stats and bounding box to logger? 
-verbose      Print additional messages to logger?
-mask         Mask to use. Default is none.
-stretch      Stretch the mask if necessary and possible? 
-logfile      Name of file to write fit results.
-append       If logfile exists, append to it (True) or overwrite it (False).
-alogortihm   Algorithm to use to compute statistics. Supported values are &quot;classic&quot;
-             and &quot;hinges-fences&quot; (minimum match supported.)
-fence        Fence factor when algorithm = &quot;hinges-fences&quot;. Negative values are not
-             applicable and in these cases, the classic algorithm is used.
-center       Center to use for &quot;fit-half&quot;. Valid choices are &quot;mean&quot; (mean value of the
-             selected pixels), &quot;median&quot; (median value of the selected pixels), and &quot;zero&quot;
-             (0.0 is used as the center value). Ignored if algorithm is not &quot;fit-half&quot;.
-lside        For fit-half, use values &lt;= center for the real data? If false, use
-             values &gt;= center as the real data. Ignored if algorithm is not &quot;fit-half&quot;
-zscore       For chauvenet, this is the target maximum number of standard deviations data
-             may have to be included. If negative, use Chauvenet's criterion. Ignored if
-             algorithm is not &quot;chauvenet&quot;.
-maxiter      For chauvenet, this is the maximum number of iterations to attempt. Iterating
-             will stop when either this limit is reached, or the zscore criterion is met.
-             If negative, iterate until the zscore criterion is met. Ignored if algorithm is
-             not &quot;chauvenet&quot;.
-clmethod     Method to use for calculating classical statistics. Supported methods are &quot;auto&quot;,
-             &quot;tiled&quot;, and &quot;framework&quot;. Ignored if algorithm is not &quot;classic&quot;.
-             
-      General procedure:
-
-         1.  Specify inputs, then
-
-         2.  myoutput = imstat()
-               or specify inputs directly in calling sequence to task
-             myoutput = imstat(imagename='image.im', etc)
-
-         3.  myoutput['KEYS'] will contain the result associated with any
-               of the keys given below
-        
-        KEYS CURRENTLY AVAILABLE
-        blc          - absolute PIXEL coordinate of the bottom left corner of 
-                       the bounding box surrounding the selected region
-        blcf         - Same as blc, but uses WORLD coordinates instead of pixels
-        trc          - the absolute PIXEL coordinate of the top right corner 
-                       of the bounding box surrounding the selected region
-        trcf         - Same as trc, but uses WORLD coordinates instead of pixels
-        flux         - the flux or flux density. See below for details.
-        npts         - the number of unmasked points used
-        max          - the maximum pixel value
-        min          - minimum pixel value
-        maxpos       - absolute PIXEL coordinate of maximum pixel value
-        maxposf      - Same as maxpos, but uses WORLD coordinates instead of pixels
-        minpos       - absolute pixel coordinate of minimum pixel value
-        minposf      - Same as minpos, but uses WORLD coordinates instead of pixels
-        sum          - the sum of the pixel values: $\sum I_i$
-        sumsq        - the sum of the squares of the pixel values: $\sum I_i^2$
-        mean         - the mean of pixel values: 
-                       $\bar{I} = \sum I_i / n$
-        sigma        - the standard deviation about the mean: 
-                       $\sigma^2 = (\sum I_i - \bar{I})^2 / (n-1)$
-        rms          - the root mean square: 
-                       $\sqrt {\sum I_i^2 / n}$
-        median       - the median pixel value
-        medabsdevmed - the median of the absolute deviations from the 
-                       median
-        quartile     - the inner-quartile range. Find the points 
-                       which are 25% largest and 75% largest (the median is 
-                       50% largest).
-    q1           - the first quartile.
-    q3           - the third quartile
-
-CURSOR AXES
-The axes parameter allows one to set the cursor axes over which statistics 
-are computed. For example, consider a 3-dimensional image for which axes=[0,2]. 
-The statistics would be computed for each XZ (axes 0 and 2) plane in the
-image.  One could then examine those statistics as a function of the Y
-(axis 1) axis. 
-
-Each statistic is stored in an array in its own field in the returned dictionary.
-The dimensionality of these arrays is equal to the number of axes over which the
-statistics were not evaluated (called the display axes). For example, if the input
-image has four axes, and axes=[0], the output statistic arrays will have three dimensions.
-If axes=[0, 1], the output statistic arrays will have two dimensions.
-
-The shape of the output arrays when axes has a positive number of elements is based on
-the region selection. If there is no region selection, the shape of the statistic arrays
-is just the shape of the image along the display (non-cursor) axes. For example, if the
-input image has dimensions of 300x400x4x80 (RA x Dec x Stokes x Freq) and axes=[0, 1],
-in the absence of a region selection, the shape of the output statistic arrays will be
-4x80. If there is a region selection, the shape of the output statistic arrays will be
-determined by the number of planes along the display axes chosen in the region selection.
-For example, continuing with our example, if axes=[0,1], chans=&quot;5~15;30~70&quot;, and
-stokes=&quot;IV&quot;, the output statistic arrays will have shapes of 2x52. Only the selected
-planes will be displayed in the logger output if verbose=True.
-
-In the case where the image has a pixel mask, and/or the mask parameter is specified,
-and because of this specification a plane is entirely masked, this element is included in
-the statistic arrays (usually with a value of 0). It is not included in the logger output
-if verbose=True. One can exclude such elements from computations on the output arrays by
-using the numpy.extract() method. For example, to compute the minimum rms value, not
-including any fully masked planes, one could use
-
-stats = imstat(...)
-rmsmin = numpy.min(numpy.extract(stats['npts']&gt;0, stats['rms']))
-
-Thus in the computation of rmsmin, only the rms elements are considered which have
-associated values of npts that are not zero.
-
-ALGORITHMS
-
-Several types of statistical algorithms are supported:
-
-* classic: This is the familiar algorithm, in which all unmasked pixels are used. One may choose
-  one of two methods, which vary only by performance, for computing classic statistics, via the
-  clmethod parameter. The &quot;tiled&quot; method is the old method and is fastest in cases where there are
-  a large number of individual sets of statistics to be computed and a small number of data points
-  per set. This can occur when one sets the axes parameter, which causes several individual sets of
-  statistics to be computed. The &quot;framework&quot; method uses the new statistics framework to compute
-  statistics. This method is fastest in the regime where one has a small number of individual sets
-  of statistics to calculate, and each set has a large number of points. For example, this method
-  is fastest when computing statistics over an entire image in one go (no axes specified). A third
-  option, &quot;auto&quot;, chooses which method to use by predicting which be faster based on the number of
-  pixels in the image and the choice of the axes parameter.
-  
-* fit-half: This algorithm calculates statistics on a dataset created from real and virtual pixel values.
-  The real values are determined by the input parameters center and lside. The parameter center
-  tells the algorithm where the center value of the combined real+virtual dataset should be. Options
-  are the mean or the median of the input image's pixel values, or at zero. The lside parameter tells
-  the algorithm on which side of this center the real pixel values are located. True indicates that
-  the real pixel values to be used are &lt;= center. False indicates the real pixel values to be used
-  are &gt;= center. The virtual part of the dataset is then created by reflecting all the real values
-  through the center value, to create a perfectly symmetric dataset composed of a real and a virtual
-  component. Statistics are then calculated on this resultant dataset. These two parameters are
-  ignored if algorithm is not &quot;fit-half&quot;. Because the maximum value is virtual if lside is True and the
-  minimum value is virtual if lside is False, the value of the maximum position (if lside=True) or
-  minimum position (if lside=False) is not reported in the returned record.
-  
-* hinges-fences: This algorithm calculates statistics by including data in a range
-  between Q1 - f*D and Q3 + f*D, inclusive, where Q1 is the first quartile of the distribution
-  of unmasked data, subject to any specified pixel ranges, Q3 is the third quartile, D = Q3 - Q1
-  (the inner quartile range), and f is the user-specified fence factor. Negative values of f
-  indicate that the full distribution is to be used (ie, the classic algorithm is used). Sufficiently
-  large values of f will also be equivalent to using the classic algorithm. For f = 0, only data
-  in the inner quartile range is used for computing statistics. The value of fence is silently
-  ignored if algorithm is not &quot;hinges-fences&quot;.
-
-* chauvenet: The idea behind this algorithm is to eliminate outliers based on a maximum z-score value.
-  A z-score is the number of standard deviations a point is from the mean of a distribution. This
-  method thus is meant to be used for (nearly) normal distributions. In general, this is an iterative
-  process, with successive iterations discarding additional outliers as the remaining points become
-  closer to forming a normal distribution. Iterating stops when no additional points lie beyond the
-  specified zscore value, or, if zscore is negative, when Chauvenet's criterion is met (see below).
-  The parameter maxiter can be set to a non-negative value to prematurely abort this iterative
-  process. When verbose=T, the &quot;N iter&quot; column in the table that is logged represents the number
-  of iterations that were executed.
-  
-  Chauvenet's criterion allows the target z-score to decrease as the number of points in the
-  distribution decreases on subsequent iterations. Essentially, the criterion is that the probability
-  of having one point in a normal distribution at a maximum z-score of z_max must be at least 0.5.
-  z_max is therefore a function of (only) the number of points in the distrbution and is given by
-  
-  npts = 0.5/erfc(z_max/sqrt(2))
-  
-  where erfc() is the complementary error function. As iterating proceeds, the number of remaining
-  points decreases as outliers are discarded, and so z_max likewise decreases. Convergence occurs when
-  all remaining points fall within a z-score of z_max. Below is an illustrative table of z_max values
-  and their corresponding npts values. For example, it is likely that there will be a 5-sigma &quot;noise
-  bump&quot; in a perfectly noisy image with one million independent elements.
-  
-  z_max    npts
-  1.0                1
-  1.5                3
-  2.0               10
-  2.5               40
-  3.0              185
-  3.5            1,074
-  4.0            7,893
-  4.5           73,579
-  5.0          872,138
-  5.5       13,165,126
-  6.0      253,398,672
-  6.5    6,225,098,696
-  7.0  195,341,107,722
-
-NOTES ON FLUX DENSITIES AND FLUXES
-
-Fluxes and flux densities are not computed if any of the following conditions is met:
-
-1. The image does not have a direction coordinate
-2. The image does not have a intensity-like brightness unit. Examples of such units
-   are Jy/beam (in which case the image must also have a beam) and K.
-3. There are no direction axes in the cursor axes that are used.
-4. If the (specified region of the) image has a non-degenerate spectral axis,
-   and the image has a tablular spectral axis (axis with varying increments)
-5. Any axis that is not a direction nor a spectral axis that is included in the cursor
-   axes is not degenerate within in specified region
-
-Note that condition 4 may be removed in the future.
-
-In cases where none of the above conditions is met, the flux density(ies) (intensities
-integrated over direction planes) will be computed if any of the following conditions
-are met:
-
-1. The image has no spectral coordinate
-2. The cursor axes do not include the spectral axis
-3. The spectral axis in the chosen region is degenerate
-
-In the case where there is a nondegenerate spectral axis that is included in the cursor
-axes, the flux (flux density integrated over spectral planes) will be computed. In this
-case, the spectral portion of the flux unit will be the velocity unit of the spectral
-coordinate if it has one (eg, if the brightness unit is Jy/beam and the velocity unit is
-km/s, the flux will have units of Jy.km/s). If not, the spectral portion of the flux unit
-will be the frequency unit of the spectral axis (eg, if the brightness unit is K and the
-frequency unit is Hz, the resulting flux unit will be K.arcsec2.Hz). 
-
-In both cases of flux density or flux being computed, the resulting numerical value is
-assigned to the &quot;flux&quot; key in the output dictionary.
-
-ADDITIONAL EXAMPLES
-
-        # Selected two box region
-        # box 1, bottom-left coord is 2,3 and top-right coord is 14,15
-        # box 2, bottom-left coord is 30,31 and top-right coord is 42,43
-        imstat( 'myImage', box='2,3,14,15;30,31,42,43' )
-
-        # Select the same two box regions but only channels 4 and 5
-        imstat( 'myImage', box='2,3,14,15;30,31,42,43', chan='4~5' )
-
-        # Select all channels greater the 20 as well as channel 0.
-        # Then the mean and standard deviation are printed
-        results = imstat( 'myImage', chans='&gt;20;0' )
-        print &quot;Mean is: &quot;, results['mean'], &quot;  s.d. &quot;, results['sigma']
-
-        # Find statistical information for the Q stokes value only
-        # then the I stokes values only, and printing out the statistical
-        # values that we are interested in.
-        s1 = imstat( 'myimage', stokes='Q' )
-        s2 = imstat( 'myimage', stokes='I' )
-        print &quot;       |  MIN  |   MAX  | MEAN&quot;
-        print &quot;  Q    | &quot;,s1['min'][0],&quot;  |  &quot;,s1['max'][0],&quot;  |  &quot;,,&quot;  |  &quot;,s1['mean'][0]
-        print &quot;  I    | &quot;,s2['min'][0],&quot;  |  &quot;,s2['max'][0],&quot;  |  &quot;,,&quot;  |  &quot;,s2['mean'][0]
-
-# evaluate statistics for each spectral plane in an ra x dec x frequency image
-myim = &quot;noisy.im&quot;
-ia.fromshape(myim, [20,30,40])
-# give pixels non-zero values
-ia.addnoise()
-ia.done()
-# These are the display axes, the calculation of statistics occurs
-# for each (hyper)plane along axes not listed in the axes parameter,
-# in this case axis 2 (the frequency axis)
-# display the rms for each frequency plane (your mileage will vary with
-# the values).
-stats = imstat(imagename=myim, axes=[0,1])
- stats[&quot;rms&quot;]
-  Out[10]: 
-array([ 0.99576014,  1.03813124,  0.97749186,  0.97587883,  1.04189885,
-        1.03784776,  1.03371549,  1.03153074,  1.00841606,  0.947155  ,
-        0.97335404,  0.94389403,  1.0010221 ,  0.97151822,  1.03942156,
-        1.01158476,  0.96957082,  1.04212773,  1.00589049,  0.98696715,
-        1.00451481,  1.02307892,  1.03102005,  0.97334671,  0.95209879,
-        1.02088714,  0.96999902,  0.98661619,  1.01039267,  0.96842754,
-        0.99464947,  1.01536798,  1.02466023,  0.96956468,  0.98090756,
-        0.9835844 ,  0.95698935,  1.05487967,  0.99846411,  0.99634868])</example>
+    <example/>
   </task>
 </casaxml>
```

## casatasks/__xml__/polfromgain.xml

### casatasks/__xml__/polfromgain.xml

```diff
@@ -1,43 +1,36 @@
 <?xml version="1.0" encoding="utf-8"?>
 <casaxml xmlns="http://casa.nrao.edu/schema/psetTypes.html" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://casa.nrao.edu/schema/casa.xsd       file:///opt/casa/code/xmlcasa/xml/casa.xsd">
   <task type="function" name="polfromgain" category="calibration">
     <shortdescription>Derive linear polarization from gain ratio</shortdescription>
     <description>TBD</description>
     <input>
       <param type="path" name="vis" mustexist="true">
-        <shortdescription>Name of input visibility file (MS)</shortdescription>
-        <description>Name of input visibility file (MS)</description>
+        <shortdescription>Name of input MeasurementSet</shortdescription>
+        <description>Name of input MS from which gaincal caltable in tablein originated.  Used to extract geometry information not available in the tablein caltable.</description>
         <value/>
       </param>
       <param type="path" name="tablein" mustexist="true">
-        <shortdescription>Input calibration table</shortdescription>
-        <description>Input calibration table</description>
+        <shortdescription>Input gain calibration table</shortdescription>
+        <description>Input gain calibration table corresponding to MS specified in vis.</description>
         <value/>
       </param>
       <param type="string" name="caltable">
-        <shortdescription>Output calibration table (forces polarization correction if specified)</shortdescription>
-        <description>Output calibration table (forces polarization correction if specified)</description>
+        <shortdescription>Optional output caltable (for polarization-corrected gains if specified)</shortdescription>
+        <description>Optional output calibration table which will contain source polarization-corrected gains, if specified</description>
         <value/>
       </param>
       <param type="double" name="paoffset">
-        <shortdescription>Manual position angle offset</shortdescription>
-        <description>Manual position angle offset</description>
+        <shortdescription>Manual feed position angle offset (clockwise, in deg)</shortdescription>
+        <description>Manual position angle offset (clockwise, in deg); added to value stored in the MS FEED subtable.  Use with care, since downstream calibration operation using polfromgain results will change according to this position angle offset.</description>
         <value>0.0</value>
       </param>
+      <param type="double" name="minpacov">
+        <shortdescription>Minimum parallactic angle coverage (deg) required for Q,U estimation</shortdescription>
+        <description>Minimum parallactic angle coverage (deg) required for Q,U estimation. Reliable Q,U estimation depends on adequate parallactic angle coverage, and this parameter enforces a minimum allowable range of parallactic angle (per antenna) for unflagged gain solutions before the Q,U esimation is attempted.  (If caltable is specified, gains for antennas failing the minpacov criteria will be corrected by the per-spw average of Q,U estimates from good antennas.)</description>
+        <value>30.0</value>
+      </param>
     </input>
     <returns type="void"/>
-    <example>TBD...
-
-        Keyword arguments:
-        vis -- Name of input visibility file
-                default: none; 
-        tablein -- Input calibration table (G or T)
-                default: none; 
-        caltable -- Output calibration table
-                default: ''  (no new table)
-                if specified, new caltable with polarization removed is generated
-        paoffset -- Manual position angle offset
-              default: 0.0  (no extra offset)
-              example: paoffset=10.0  (10 degree offset)</example>
+    <example/>
   </task>
 </casaxml>
```

## casatasks/__xml__/setjy.xml

### casatasks/__xml__/setjy.xml

```diff
@@ -452,35 +452,35 @@
           <value>spline</value>
           <value/>
         </allowed>
       </param>
       <param type="bool" name="usescratch">
         <shortdescription>Will create if necessary and use the MODEL_DATA</shortdescription>
         <description>Will create if necessary and use the MODEL_DATA
-                     Default: False
-                     Options: False|True
+                     Default: True 
+                     Options: True|False
 
-                     * If False: 'virtual' model is created. The model
-                       information is saved either in the SOURCE_MODEL
-                       column in the SOURCE table (if one exists) or
-                       in the keyword of the main table in the MS and
-                       model visibilities are evaluated on the fly
-                       when calculating  calibration or plotting in
-                       plotms.
                      * If True: the model visibility will be evaluated
                        and saved on disk in the MODEL_DATA column.
                        This will increase your ms in size by a factor
                        of 1.5 (w.r.t. the case where  you only have
                        the DATA and the CORRECTED_DATA column). Use
                        True if you need to interact with the
                        MODEL_DATA in python, say. Also, use True if
                        you need finer than field and spw  selections
                        using scans/time (and when use with intent
                        selection, please see WARNING section in the
                        intent parameter description).
+                     * If False: 'virtual' model is created. The model
+                       information is saved either in the SOURCE_MODEL
+                       column in the SOURCE table (if one exists) or
+                       in the keyword of the main table in the MS, and
+                       model visibilities are evaluated on the fly
+                       when calculating  calibration or plotting in
+                       plotms.
 
                      By running usescratch=T, it will remove the
                      existing virtual model from previous
                      runs. usescratch=F will not remove the existing
                      MODEL_DATA but in subsequent process the virtual
                      model with matching field and spw combination
                      will be used if it exists regardless of the
@@ -491,15 +491,15 @@
                      virtual model is not possible.).
 
                      VERY IMPORTANT: The current implementation of
                      time-dependent models (e.g. ephemerides sources)
                      within setjy is incompatible with the use of the
                      virtual model column. Please use ephemerides source
                      models only with usescratch=True</description>
-        <value>False</value>
+        <value>True</value>
       </param>
       <param type="bool" name="ismms" subparam="true" visibility="hidden">
         <shortdescription>to be used internally for MMS</shortdescription>
         <description>to be used internally for MMS</description>
         <value>False</value>
       </param>
       <constraints>
```

## casatasks/__xml__/simobserve.xml

### casatasks/__xml__/simobserve.xml

```diff
@@ -13,18 +13,17 @@
 into output simulated images using simanalyze.
     
 ALMA users are encouraged to use the simalma task, which provides
 additional information on the multiple simobserve and simanalyze calls
 required to simulate an ALMA observation which may consist of 12m
 interferometric, 7m interferometric, and 12m total power data.
     
-More information and examples are availible at 
-http://casaguides.nrao.edu/index.php?title=Simulating_Observations_in_CASA
-Please contact the Helpdesk with any questions (see
-https://casa.nrao.edu/help_desk_all.shtml)</description>
+More information and examples are availible in the CASA Guides (http://casaguides.nrao.edu) under Simulations.
+Please contact the CASA Team with any questions (see
+https://casa.nrao.edu/index_contact.shtml)</description>
     <example/>
     <input>
       <param name="project" type="string">
         <shortdescription>Root prefix for output file names</shortdescription>
         <description>root prefix for output file names</description>
         <value>sim</value>
       </param>
@@ -88,19 +87,21 @@
 
                         Example: incell='0.1arcsec'</description>
         <value type="string"/>
       </param>
       <param subparam="true" name="incenter" type="string">
         <shortdescription>Set new frequency of center channel e.g. 89GHz (required even for 2D model)</shortdescription>
         <description>Frequency to use for the center channel (or only channel,
-if the skymodel is 2D)
+if the skymodel is 2D).
                      Subparameter of skymodel
                      Default: '' (use whatever is in the image
                      already)
 
+		     This will also become the default rest frequency, e.g. when imaging with tclean.
+
                         Example: incenter='89GHz'</description>
         <value type="string"/>
       </param>
       <param subparam="true" name="inwidth" type="string">
         <shortdescription>Set new channel width, e.g. &quot;10MHz&quot; (required even for 2D model)</shortdescription>
         <description>Set new channel width 
                      Subparameter of skymodel
@@ -446,17 +447,15 @@
         </allowed>
       </param>
       <param subparam="true" name="tau0" type="double">
         <shortdescription>Zenith opacity</shortdescription>
         <description>Zenith opacity at observing frequency
                       Subparameter of thermalnoise='tsys-manual'
 
-                      https://casaguides.nrao.edu/index.php/Corrupt
-                      for more information on noise, in particular how
-                      to add a phase screen using the toolkit</description>
+                      See the Simulations CASA Guide (https://casaguides.nrao.edu) on 'Corrupting Simulated Data' for more information on noise, in particular how to add a phase screen using the toolkit</description>
         <value>0.1</value>
         <allowed kind="range">
           <value range="min">0</value>
         </allowed>
       </param>
       <param subparam="true" name="seed" type="int">
         <shortdescription>Random number seed</shortdescription>
```

## casatasks/__xml__/tclean.xml

### casatasks/__xml__/tclean.xml

```diff
@@ -262,15 +262,18 @@
         <type>string</type>
         <type>stringVec</type>
         <value type="stringVec">&quot;1arcsec&quot;</value>
       </param>
       <param type="any" name="phasecenter">
         <shortdescription>Phase center of the image</shortdescription>
         <description>Phase center of the image (string or field id); if the phasecenter is the name known major solar system object ('MERCURY', 'VENUS', 'MARS', 'JUPITER', 'SATURN', 'URANUS', 'NEPTUNE', 'PLUTO', 'SUN', 'MOON') or is an ephemerides table then that source is tracked and the background sources get smeared. There is a special case, when phasecenter='TRACKFIELD', which will use the ephemerides or polynomial phasecenter in the FIELD table of the MS's as the source center to track.
-               example: phasecenter=6
+
+                             Note : If unspecified, tclean will use the phase-center from the first data field of the MS (or list of MSs) selected for imaging. 
+
+			example: phasecenter=6
                         phasecenter='J2000 19h30m00 -40d00m00'
                         phasecenter='J2000 292.5deg  -40.0deg'
                         phasecenter='J2000 5.105rad  -0.698rad'
                         phasecenter='ICRS 13:05:27.2780 -049.28.04.458'
                         phasecenter='myComet_ephem.tab'
                         phasecenter='MOON'
                         phasecenter='TRACKFIELD'</description>
@@ -349,71 +352,115 @@
 
                       [ Note : If an error occurs during image resampling/regridding,
                                    please try using task imregrid to resample the starting model
                                    image onto a CASA image with the target shape and
                                    coordinate system before supplying it via startmodel ]</description>
         <value type="string"/>
       </param>
-      <param type="any" name="specmode" required="true">
-        <shortdescription>Spectral definition mode (mfs,cube,cubedata, cubesource)</shortdescription>
-        <description>Spectral definition mode (mfs,cube,cubedata, cubesource)
-
-                       mode='mfs' : Continuum imaging with only one output image channel.
-                                             (mode='cont' can also be used here)
-
-                       mode='cube' : Spectral line imaging with one or more channels
-                                               Parameters start, width,and nchan define the spectral
-                                               coordinate system and can be specified either in terms
-                                               of channel numbers, frequency or velocity in whatever
-                                               spectral frame is specified in 'outframe'.
-                                               All internal and output images are made with outframe as the
-                                               base spectral frame. However imaging code internally uses the fixed
-                                               spectral frame, LSRK for automatic internal software
-                                               Doppler tracking so that a spectral line observed over an
-                                               extended time range will line up appropriately.
-                                               Therefore the output images have additional spectral frame conversion
-                                               layer in LSRK on the top the base frame.
+      <param type="string" name="specmode" required="true">
+        <shortdescription>Spectral definition mode (mfs,cube,cubedata, cubesource,mvc)</shortdescription>
+        <description>Spectral definition mode (mfs,cube,cubedata, cubesource, mvc)
+
+                       specmode='mfs' : Continuum imaging with only one output image channel.
+                                                      (mode='cont' can also be used here)
+
+                       specmode='cube' : Spectral line imaging with one or more channels
+                                                      Parameters start, width,and nchan define the spectral
+                                                     coordinate system and can be specified either in terms
+                                                     of channel numbers, frequency or velocity in whatever
+                                                     spectral frame is specified in 'outframe'.
+                                                     All internal and output images are made with outframe as the
+                                                     base spectral frame. However imaging code internally uses the fixed
+                                                     spectral frame, LSRK for automatic internal software
+                                                     Doppler tracking so that a spectral line observed over an
+                                                     extended time range will line up appropriately.
+                                                     Therefore the output images have additional spectral frame conversion
+                                                      layer in LSRK on the top the base frame.
 
 
                                                (Note : Even if the input parameters are specified in a frame
                                                            other than LSRK, the viewer still displays spectral
                                                            axis in LSRK by default because of the conversion frame
                                                            layer mentioned above. The viewer can be used to relabel
                                                            the spectral axis in any desired frame - via the spectral
                                                            reference option under axis label properties in the
                                                            data display options window.)
 
 
                                                
 
-                        mode='cubedata' : Spectral line imaging with one or more channels
+
+                        specmode='cubedata' : Spectral line imaging with one or more channels
                                                         There is no internal software Doppler tracking so
                                                         a spectral line observed over an extended time range
                                                         may be smeared out in frequency. There is strictly
                                                         no valid spectral frame with which to associate with the
                                                         output images, thus the image spectral  frame will
                                                         be labelled  &quot;Undefined&quot;.
 
                                                         
-                        mode='cubesource': Spectral line imaging while
+                        specmode='cubesource': Spectral line imaging while
                                                         tracking moving source (near field or solar system
                                                         objects). The velocity of the source is accounted
                                                         and the frequency reported is in the source frame.
                                                         As there is no &quot;SOURCE&quot; frame defined in CASA,
                                                         the frame in the image will be labelled &quot;REST&quot; (but do note the
                                                         velocity of a given line reported may be different from the rest frame
                                                         velocity if the emission region is moving w.r.t the systemic
-                                                        velocity frame of the source)</description>
+                                                        velocity frame of the source)
+
+                        specmode='mvc' : Multiterm continuum imaging with cube major cycles. 
+                                                        This mode requires deconvolver='mtmfs' with nterms&gt;1 
+                                                        and user-set choices of 'reffreq' and 'nchan'. 
+
+                                                        The output images and minor cycle are similar to specmode='mfs' 
+                                                        with deconvolver='mtmfs', but the major cycles are done in 
+                                                        cube mode (and require a setting of 'reffreq' and 'nchan'). 
+                                                        By default, frequency-dependent primary beam correction is 
+                                                        applied to each channel, before being combined across frequency
+                                                        to make the inputs to the 'mtmfs' deconvolver.  This results in 
+                                                        implicit wideband pb-correction, with the deconvolver seeing only
+                                                        the sky spectral structure.
+
+                                                        Note : There is currently no option to turn off wideband pb correction
+                                                        as part of the flat-sky normalization between the major and minor cycles.
+                                                        Therefore, 'mvc' with the 'standard' and 'wproject' gridders will also apply
+                                                        pblimits per channel, masking all regions outside of pblimit.                 	
+                                                        An option to retain sources outside the pblimit will be added in a future release. 
+
+                                                        Note : Below is some guidance for choosing 'nchan' and 'reffreq' :
+                                  
+                                                        The cube produced by the major cycle is used in a linear least square fits for Taylor
+                                                        polynomials per pixel. Therefore, one only needs as many channels in the cube, as
+                                                        required for an accurate polynomial fit for sources that have the strongest
+                                                        spectral structure.
+
+                                                        In general, 'nchan' needs to be greater than or equal to 'nterms', and the
+                                                        frequency range selected by the data will be evenly split into nchan channels.
+                                                        For a low-order polynomial fit, only a small number (around 10)
+                                                        channels are typically needed (for VLA/ALMA bandwidth ratios).
+                                                        'nchan=-1' applies a heuristic that results in a default of 10 cube channels
+                                                        for a 2:1 bandwidth ratio.
+
+                                                        nchan = MAX( bandwidth/(0.1*startfreq) ,  nterms+1 )
+
+                                                        Note: When running in parallel, the nchan selected may limit the speedup if it
+                                                        is smaller than the number of processes used.
+
+                                                        The 'reffreq' is the reference frequency used for the Taylor polynomial expansion.
+                                                        By default, in specmode='mvc', reffreq is set to the middle of the selected
+                                                        frequency range.</description>
         <value type="string">mfs</value>
         <allowed kind="enum">
           <value>mfs</value>
           <value>cont</value>
           <value>cube</value>
           <value>cubedata</value>
           <value>cubesource</value>
+          <value>mvc</value>
         </allowed>
       </param>
       <param type="any" name="reffreq" subparam="true">
         <shortdescription>Reference frequency</shortdescription>
         <description>Reference frequency of the output image coordinate system
 
                        Example :  reffreq='1.5GHz'    as a string with units.
@@ -741,14 +788,15 @@
           <value>wprojectft</value>
           <value>mosaic</value>
           <value>ftmosaic</value>
           <value>mosaicft</value>
           <value>imagemosaic</value>
           <value>awproject</value>
           <value>awprojectft</value>
+          <!--             <value>awp2</value> -->
         </allowed>
       </param>
       <param type="int" name="facets" subparam="true">
         <shortdescription>Number of facets on a side</shortdescription>
         <description>Number of facets on a side
 
                        A set of (facets x facets) subregions of the specified image
@@ -1332,25 +1380,45 @@
       </param>
       <param type="bool" name="pbcor" subparam="true">
         <shortdescription>Apply PB correction on the output restored image</shortdescription>
         <description>Apply PB correction on the output restored image
 
                        A new image with extension .image.pbcor will be created from
                        the evaluation of   .image / .pb  for all pixels above the specified pblimit.
-
+                       
                        Note : Stand-alone PB-correction can be triggered by re-running
                                  tclean with the appropriate imagename and with
                                  niter=0, calcpsf=False, calcres=False, pbcor=True, vptable='vp.tab'
                                  ( where vp.tab is the name of the vpmanager file.
                                     See the inline help for the 'vptable' parameter )
 
-                       Note : Multi-term PB correction that includes a correction for the
-                                 spectral index of the PB has not been enabled for the 4.7 release.
-                                 Please use the widebandpbcor task instead.
-                                 ( Wideband PB corrections are required when the amplitude of the
+                       Note : For deconvolver='mtmfs', pbcor will divide each Taylor term image by the .tt0 average PB.   
+                                  For all gridders, this calculation is accurate for small fractional bandwidths.  
+
+                                  For large fractional bandwidths, please use one of the following options.
+
+                                  (a) For single pointings, run the tclean task with specmode='mfs', deconvolver='mtmfs', 
+                                        and gridder='standard' with pbcor=True or False. 
+                                        If a PB-corrected spectral index is required, 
+                                        please use the widebandpbcor task to apply multi-tern PB-correction.
+
+                                  (b) For mosaics, run tclean task with specmode='mfs', deconvolver='mtmfs',
+                                        and gridder='awproject' , wbawp=True, conjbeams=True, with pbcor=True.  
+                                        This option applies wideband PB correction as part of the gridding step and
+                                        pbcor=True will be accurate because the spectral index map will already 
+                                        be PB-corrected. 
+
+                                  (c) For mosaics, run tclean with specmode='mvc', deconvolver='mtmfs', 
+                                        and gridder='standard' or 'mosaic' with pbcor=True.  
+                                        This option applies wideband PB-correction to channelized residual images
+                                        prior to the minor cycle and pbcor=True will be accurate because the spectral 
+                                        index map will already be PB-corrected. 
+
+                        Note : Frequency-dependent PB corrections are typically required for full-band imaging with the VLA. 
+                                    Wideband PB corrections are required when the amplitude of the
                                     brightest source is known accurately enough to be sensitive
                                     to the difference in the PB gain between the upper and lower
                                     end of the band at its location. As a guideline, the artificial spectral
                                     index due to the PB is -1.4 at the 0.5 gain level and less than -0.2
                                     at the 0.9 gain level at the middle frequency )</description>
         <value type="bool">False</value>
       </param>
@@ -2264,14 +2332,22 @@
         </when>
         <when param="specmode">
           <equals type="string" value="mfs">
             <default param="reffreq">
               <value>&quot;&quot;</value>
             </default>
           </equals>
+          <equals type="string" value="mvc">
+            <default param="reffreq">
+              <value>&quot;&quot;</value>
+            </default>
+            <default param="nchan">
+              <value>-1</value>
+            </default>
+          </equals>
           <equals type="string" value="cube">
             <default param="nchan">
               <value>-1</value>
             </default>
             <default param="start">
               <value>&quot;&quot;</value>
             </default>
@@ -2547,14 +2623,22 @@
             <default param="conjbeams">
               <value>False</value>
             </default>
             <default param="usepointing">
               <value>False</value>
             </default>
           </equals>
+          <!--       <equals type="string" value="awp2">
+         <default param="wprojplanes"><value>1</value></default>
+	 <default param="normtype"><value>&quot;flatnoise&quot;</value></default>
+	 <default param="computepastep"><value>360.0</value></default>
+	 <default param="mosweight"><value>False</value></default>
+	 <default param="usepointing"><value>False</value></default>
+       </equals> 
+-->
         </when>
         <when param="weighting">
           <equals type="string" value="natural">
             <default param="uvtaper">
               <value>[]</value>
             </default>
           </equals>
```

## casatasks/__xml__/tsdimaging.xml

### casatasks/__xml__/tsdimaging.xml

```diff
@@ -91,17 +91,41 @@
         <value type="string">OBSERVE_TARGET#ON_SOURCE</value>
       </param>
       <param type="string" name="timerange">
         <shortdescription>select data by range of time, e.g. 20:15:00~20:16:00 (\'\'=all)</shortdescription>
         <description>select data by range of time, e.g. 20:15:00~20:16:00 (\'\'=all)</description>
         <value/>
       </param>
+      <param subparam="true" name="outframe" type="string">
+        <shortdescription>velocity frame of output image [\'lsrk\', \'lsrd\', \'bary\', \'geo\', \'topo\', \'galacto\', \'lgroup\', \'cmb\'] (\'\'=current frame or LSRK for multiple-MS inputs)</shortdescription>
+        <description>velocity frame of output image (''=current frame or LSRK for multiple-MS inputs)</description>
+        <value/>
+        <allowed ignorecase="true" kind="enum">
+          <value>lsrk</value>
+          <value>lsrd</value>
+          <value>bary</value>
+          <value>geo</value>
+          <value>topo</value>
+          <value>galacto</value>
+          <value>lgroup</value>
+          <value>cmb</value>
+          <value>LSRK</value>
+          <value>LSRD</value>
+          <value>BARY</value>
+          <value>GEO</value>
+          <value>TOPO</value>
+          <value>GALACTO</value>
+          <value>LGROUP</value>
+          <value>CMB</value>
+          <value/>
+        </allowed>
+      </param>
       <param type="string" name="mode">
-        <description>spectral gridding type</description>
         <shortdescription>spectral gridding type [\'channel\', \'frequency\', \'velocity\']</shortdescription>
+        <description>spectral gridding type [\'channel\', \'frequency\', \'velocity\']</description>
         <value>channel</value>
         <allowed kind="enum">
           <value>channel</value>
           <value>frequency</value>
           <value>velocity</value>
         </allowed>
       </param>
@@ -145,83 +169,55 @@
         <value>cube</value>
         <allowed kind="enum">
           <value>cube</value>
           <value>cubedata</value>
           <value>cubesource</value>
         </allowed>
       </param>
-      <param subparam="true" name="outframe" type="string">
-        <shortdescription>velocity frame of output image [\'lsrk\', \'lsrd\', \'bary\', \'geo\', \'topo\', \'galacto\', \'lgroup\', \'cmb\'] (\'\'=current frame or LSRK for multiple-MS inputs)</shortdescription>
-        <description>velocity frame of output image (''=current frame or LSRK for multiple-MS inputs)</description>
-        <value/>
-        <allowed ignorecase="true" kind="enum">
-          <value>lsrk</value>
-          <value>lsrd</value>
-          <value>bary</value>
-          <value>geo</value>
-          <value>topo</value>
-          <value>galacto</value>
-          <value>lgroup</value>
-          <value>cmb</value>
-          <value>LSRK</value>
-          <value>LSRD</value>
-          <value>BARY</value>
-          <value>GEO</value>
-          <value>TOPO</value>
-          <value>GALACTO</value>
-          <value>LGROUP</value>
-          <value>CMB</value>
-          <value/>
-        </allowed>
-      </param>
-      <param type="string" name="gridfunction">
-        <shortdescription>gridding function for imaging [\'BOX\', \'SF\', \'PB\', \'GAUSS\' or \'GJINC\'] (see description in help)</shortdescription>
-        <description>gridding function for imaging (see description in help)</description>
-        <value>BOX</value>
+      <param type="string" name="pointingcolumn">
+        <shortdescription>pointing data column to use [\'direction\', \'target\', \'pointing_offset\', \'source_offset\' or \'encoder\']</shortdescription>
+        <description>pointing data column to use</description>
+        <value>direction</value>
         <allowed kind="enum">
-          <value>BOX</value>
-          <value>PB</value>
-          <value>SF</value>
-          <value>GAUSS</value>
-          <value>GJINC</value>
-          <value>box</value>
-          <value>pb</value>
-          <value>sf</value>
-          <value>gauss</value>
-          <value>gjinc</value>
+          <value>target</value>
+          <value>pointing_offset</value>
+          <value>source_offset</value>
+          <value>encoder</value>
+          <value>direction</value>
+          <value>TARGET</value>
+          <value>POINTING_OFFSET</value>
+          <value>SOURCE_OFFSET</value>
+          <value>ENCODER</value>
+          <value>DIRECTION</value>
         </allowed>
       </param>
-      <param type="int" name="convsupport" subparam="true">
-        <shortdescription>convolution support for gridding</shortdescription>
-        <description>convolution support for gridding</description>
-        <value>-1</value>
-      </param>
-      <param type="any" name="truncate" subparam="true">
-        <shortdescription>truncation radius for gridding</shortdescription>
-        <description>truncation radius for gridding</description>
-        <type>string</type>
-        <type>int</type>
-        <type>double</type>
-        <value type="int">-1</value>
-      </param>
-      <param type="any" name="gwidth" subparam="true">
-        <shortdescription>HWHM for gaussian</shortdescription>
-        <description>HWHM for gaussian</description>
-        <type>string</type>
-        <type>int</type>
-        <type>double</type>
-        <value type="int">-1</value>
+      <param type="string" name="convertfirst">
+        <shortdescription>pointing column: direction conversion-interpolation processing scheme to use [&quot;never&quot;, &quot;auto&quot;, &quot;always&quot;]</shortdescription>
+        <description>Specify whether the direction of the specified pointing column must be converted to image&quot;s reference frame prior to being interpolated at data-taking time, and when. &quot;never&quot;: interpolate against the pointing column, then convert.  &quot;always&quot;: interpolate against the beforehand converted pointing column. &quot;auto&quot;: if there are less pointings than selected data rows convert first, else interpolate first</description>
+        <value>never</value>
+        <allowed kind="enum">
+          <value>never</value>
+          <value>auto</value>
+          <value>always</value>
+        </allowed>
       </param>
-      <param type="any" name="jwidth" subparam="true">
-        <shortdescription>c-parameter for jinc function</shortdescription>
-        <description>c-parameter for jinc function</description>
-        <type>string</type>
-        <type>int</type>
-        <type>double</type>
-        <value type="int">-1</value>
+      <param type="string" name="projection">
+        <shortdescription>map projection type</shortdescription>
+        <description>map projection type</description>
+        <value>SIN</value>
+        <allowed kind="enum">
+          <value>SIN</value>
+          <value>CAR</value>
+          <value>TAN</value>
+          <value>SFL</value>
+          <value>sin</value>
+          <value>car</value>
+          <value>tan</value>
+          <value>sfl</value>
+        </allowed>
       </param>
       <param type="any" name="imsize">
         <shortdescription>x and y image size in pixels, e.g., [64,64]. Single value: same for both spatial axes ([] = number of pixels to cover whole pointings in MSes)</shortdescription>
         <description>x and y image size in pixels, e.g., [64,64]. Single value: same for both spatial axes ([] = number of pixels to cover whole pointings in MSes)</description>
         <type>intVec</type>
         <type>doubleVec</type>
         <value type="intVec"/>
@@ -236,53 +232,14 @@
       </param>
       <param type="any" name="phasecenter">
         <shortdescription>image center direction: position or field index or ephemeris source info, e.g., \'J2000 17:30:15.0 -25.30.00.0\', \'MARS\'. (\'\' = the center of pointing directions in MSes)</shortdescription>
         <description>image center direction: position or field index or ephemeris source info, e.g., \'J2000 17:30:15.0 -25.30.00.0\', \'MARS\'. (\'\' = the center of pointing directions in MSes)</description>
         <any type="variant"/>
         <value type="string"/>
       </param>
-      <param type="string" name="projection">
-        <shortdescription>map projection type</shortdescription>
-        <description>map projection type</description>
-        <value>SIN</value>
-        <allowed kind="enum">
-          <value>SIN</value>
-          <value>CAR</value>
-          <value>TAN</value>
-          <value>SFL</value>
-          <value>sin</value>
-          <value>car</value>
-          <value>tan</value>
-          <value>sfl</value>
-        </allowed>
-      </param>
-      <param type="string" name="pointingcolumn">
-        <shortdescription>pointing data column to use [\'direction\', \'target\', \'pointing_offset\', \'source_offset\' or \'encoder\']</shortdescription>
-        <description>pointing data column to use</description>
-        <value>direction</value>
-        <allowed kind="enum">
-          <value>target</value>
-          <value>pointing_offset</value>
-          <value>source_offset</value>
-          <value>encoder</value>
-          <value>direction</value>
-          <value>TARGET</value>
-          <value>POINTING_OFFSET</value>
-          <value>SOURCE_OFFSET</value>
-          <value>ENCODER</value>
-          <value>DIRECTION</value>
-        </allowed>
-      </param>
-      <param type="any" name="restfreq">
-        <shortdescription>rest frequency to assign to image, e.g., \'114.5GHz\'. When the default value \'\' is used, the task currently internally uses REST_FREQUENCY of SOURCE table or mean frequency of given spectral window as a default value.</shortdescription>
-        <description>rest frequency to assign to image, e.g., \'114.5GHz\'. When the default value \'\' is used, the task currently internally uses REST_FREQUENCY of SOURCE table or mean frequency of given spectral window as a default value.</description>
-        <type>string</type>
-        <type>double</type>
-        <value type="string"/>
-      </param>
       <param type="string" name="stokes">
         <shortdescription>stokes parameters or polarization types to image, e.g. \'I\', \'XX\'</shortdescription>
         <description>stokes parameters or polarization types to image, e.g. \'I\', \'XX\'</description>
         <value type="string">I</value>
         <allowed kind="enum">
           <value>I</value>
           <value>Q</value>
@@ -298,14 +255,65 @@
           <value>XX</value>
           <value>YY</value>
           <value>RRLL</value>
           <value>XXYY</value>
           <value>pseudoI</value>
         </allowed>
       </param>
+      <param type="string" name="gridfunction">
+        <shortdescription>gridding function for imaging [\'BOX\', \'SF\', \'PB\', \'GAUSS\' or \'GJINC\'] (see description in help)</shortdescription>
+        <description>gridding function for imaging (see description in help)</description>
+        <value>BOX</value>
+        <allowed kind="enum">
+          <value>BOX</value>
+          <value>PB</value>
+          <value>SF</value>
+          <value>GAUSS</value>
+          <value>GJINC</value>
+          <value>box</value>
+          <value>pb</value>
+          <value>sf</value>
+          <value>gauss</value>
+          <value>gjinc</value>
+        </allowed>
+      </param>
+      <param type="int" name="convsupport" subparam="true">
+        <shortdescription>convolution support for gridding</shortdescription>
+        <description>convolution support for gridding</description>
+        <value>-1</value>
+      </param>
+      <param type="any" name="truncate" subparam="true">
+        <shortdescription>truncation radius for gridding</shortdescription>
+        <description>truncation radius for gridding</description>
+        <type>string</type>
+        <type>int</type>
+        <type>double</type>
+        <value type="int">-1</value>
+      </param>
+      <param type="any" name="gwidth" subparam="true">
+        <shortdescription>HWHM for gaussian</shortdescription>
+        <description>HWHM for gaussian</description>
+        <type>string</type>
+        <type>int</type>
+        <type>double</type>
+        <value type="int">-1</value>
+      </param>
+      <param type="any" name="jwidth" subparam="true">
+        <shortdescription>c-parameter for jinc function</shortdescription>
+        <description>c-parameter for jinc function</description>
+        <type>string</type>
+        <type>int</type>
+        <type>double</type>
+        <value type="int">-1</value>
+      </param>
+      <param type="bool" name="clipminmax">
+        <shortdescription>Clip minimum and maximum value from each pixel</shortdescription>
+        <description>Clip minimum and maximum value from each pixel. Note the benefit of clipping is lost when the number of integrations contributing to each gridded pixel is small, or where the incidence of spurious datapoints is approximately or greater than the number of beams (in area) encompassed by expected image.</description>
+        <value>False</value>
+      </param>
       <param type="double" name="minweight">
         <shortdescription>Minimum weight ratio to use</shortdescription>
         <description>Minimum weight ratio to the median of weight used in weight correction and weight beased masking</description>
         <allowed kind="range">
           <value range="min">0</value>
         </allowed>
         <value>0.1</value>
@@ -316,18 +324,20 @@
         <value/>
         <allowed kind="enum">
           <value/>
           <value>K</value>
           <value>Jy/beam</value>
         </allowed>
       </param>
-      <param type="bool" name="clipminmax">
-        <shortdescription>Clip minimum and maximum value from each pixel</shortdescription>
-        <description>Clip minimum and maximum value from each pixel. Note the benefit of clipping is lost when the number of integrations contributing to each gridded pixel is small, or where the incidence of spurious datapoints is approximately or greater than the number of beams (in area) encompassed by expected image.</description>
-        <value>False</value>
+      <param type="any" name="restfreq">
+        <shortdescription>rest frequency to assign to image, e.g., \'114.5GHz\'. When the default value \'\' is used, the task currently internally uses REST_FREQUENCY of SOURCE table or mean frequency of given spectral window as a default value.</shortdescription>
+        <description>rest frequency to assign to image, e.g., \'114.5GHz\'. When the default value \'\' is used, the task currently internally uses REST_FREQUENCY of SOURCE table or mean frequency of given spectral window as a default value.</description>
+        <type>string</type>
+        <type>double</type>
+        <value type="string"/>
       </param>
       <constraints>
         <when param="mode">
           <equals value="channel">
             <default param="nchan">
               <value>-1</value>
             </default>
```

## casatasks/__xml__/widebandpbcor.xml

### casatasks/__xml__/widebandpbcor.xml

```diff
@@ -1,12 +1,12 @@
 <?xml version="1.0" encoding="utf-8"?>
 <casaxml xmlns="http://casa.nrao.edu/schema/psetTypes.html" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://casa.nrao.edu/schema/casa.xsd file:///opt/casa/code/xmlcasa/xml/casa.xsd">
   <task type="function" name="widebandpbcor" category="imaging" visibility="experimental">
     <shortdescription>Wideband PB-correction on the output of the MS-MFS algorithm</shortdescription>
-    <description>WideBand Primary-beam correction. It computes a set of PBs at the specified frequencies, calculates Taylor-coefficient images that represent the PB spectrum, performs a polynomial division to PB-correct the output Taylor-coefficient images from clean(nterms&gt;1), and recompute spectral index (and curvature) using the PB-corrected Taylor-coefficient images</description>
+    <description>WideBand Primary-beam correction. It computes a set of PBs at the specified frequencies, calculates Taylor-coefficient images that represent the PB spectrum, performs a polynomial division to PB-correct the output Taylor-coefficient images from clean(nterms&gt;1), and recompute spectral index (and curvature) using the PB-corrected Taylor-coefficient images.</description>
     <input>
       <param type="path" name="vis" kind="ms" mustexist="true">
         <shortdescription>Name of measurement set.</shortdescription>
         <description>Name of measurement set.</description>
         <value/>
       </param>
       <param type="string" name="imagename">
```

## casatasks/private/flaghelper.py

```diff
@@ -1893,18 +1893,24 @@
     val = None
 
     if (isinstance(elem, np.int_) or isinstance(elem, np.int8) or
             isinstance(elem, np.int16) or isinstance(elem, np.int32) or
             isinstance(elem, np.int64)):
         val = int(elem)
 
-    elif (isinstance(elem, np.float_) or isinstance(elem, np.float16) or
-          isinstance(elem, np.float32) or isinstance(elem, np.float64) or
-          isinstance(elem, np.float128)):
-        val = float(elem)
+    elif(isinstance(elem,np.float16) or
+         isinstance(elem,np.float32) or isinstance(elem,np.float64)):
+           val = float(elem)
+
+    elif (hasattr(np, "float")) and isinstance(elem,np.float):
+           val = float(elem)
+    # float128 is not available on all platforms
+    elif (hasattr(np, "float128")) and isinstance(elem,np.float128):
+           val = float(elem)
+
         
     else:
         # it is none of the above numpy types
         val = elem
         
     # return the casted element  
     return val
```

## casatasks/private/jplhorizons_query.py

```diff
@@ -210,18 +210,18 @@
     # output CASA table columns     
     # These are required columns for SetJy
     cols = {
         'MJD': {'header': 'Date__\(UT\)',
                 'comment': 'date in MJD',
                 'unit': 'd'},
         'RA': {'header': 'R.A.',
-               'comment': 'astrometric Right Ascension (ICRF/J2000)',
+               'comment': 'astrometric Right Ascension (ICRF)',
                'unit': 'deg'},
         'DEC': {'header': 'DEC',
-                'comment': 'astrometric Declination (ICRF/J2000)',
+                'comment': 'astrometric Declination (ICRF)',
                 'unit': 'deg'},
         'Rho': {'header': 'delta',
                 'comment': 'geocentric distance',
                 'unit': 'AU'},
         'RadVel': {'header': 'deldot',
                    'comment': 'geocentric distance rate',
                    'unit': 'AU/d'},
@@ -309,20 +309,23 @@
                     headerdict['VS_CREATE'] = year + '/' + nmon + '/' + day2 + '/' + tm[0:5]
                     # VS_DATE - use the current time to indicate the time CASA table is created
                     headerdict['VS_DATE'] = time.strftime('%Y/%m/%d/%H:%M',time.gmtime() )
                     headerdict['VS_TYPE'] = 'Table of comet/planetary positions'
                     # VERSION stored in the output table may be incremented in the future.
                     # For now, it is fixed, but it may be incremented from 0003 to 0004 to indiate
                     # this new code is used to convert the jpl horizons data to a table.
-                    headerdict['VS_VERSION'] = '0004.000'
+                    # ver 0004.0001 - new keyword: ephemeris_source, posrefsys 'ICRF/J2000' -> "ICRS' 
+                    headerdict['VS_VERSION'] = '0004.0001'
                     # target object name
                 elif re.match(r'^[>\s]*Target body name', line):
-                    m = re.match(r'^[>\s]*Target body name:\s+\d*\s*(\w+)', line)
+                    m = re.match(r'^[>\s]*Target body name:\s+(\S+)\s+(\S*)\s+\{(\w+)\:\s*(\S+)\}', line)
                     if m:
                         headerdict['NAME'] = m[1]
+                        if len(m.groups())==4 and m[3]=='source':
+                            headerdict['ephemeris_source'] = m[4]
                 # start time (of the requested time range)
                 elif re.search(r'Start time', line):
                     m = re.match(r'^[>\s]*Start time\s+\S+\s+\S+\s+(\S+)\s+(\S+)\s+(\w+)', line)
                     if m:
                         startmjd = _qa.totime(m[1] + '/' + m[2])
    #--This info will not be used but left here since it might be useful fo debugging.
    #             # end time (of the requested time range)
@@ -367,15 +370,17 @@
                         headerdict['GeoLat'] = float(long_lat_alt[1])
                         headerdict['GeoDist'] = float(long_lat_alt[2])
                         # obs location
                 elif re.search(r'Center-site name', line):
                     m = re.match(r'^[>\s]*Center-site name:\s+(\w+)', line)
                     if m:
                         headerdict['obsloc'] = m[1]
-                        headerdict['posrefsys'] =  'ICRF/J2000.0'
+                        # Assume the query is made in ICRF reference frame
+                        # and for casacore measures, this will be 'ICRS'
+                        headerdict['posrefsys'] =  'ICRS'
                 elif re.search(r'Target radii', line):
                     m = re.match(r'^[>\s]*Target radii\s*:\s*([0-9.]+\s*x\s*[0-9.]+\s*x\s*[0-9.]+)\s*km.*|'
                                  '^[>/s]*Target radii\s*:\s*([0-9.]+)\s*km', line)
                     if m:
                         matchlist = m.groups()
                         radiiarr = np.zeros(3)
                         if len(matchlist)==2:
@@ -669,15 +674,15 @@
 
 def _fill_keywords_from_dict(keydict, colkeys, tablename):
     # open tb
     # get ra,dec,np_ra, np_dec, and radii in the keyword
     # call mod version of mean_radius_with_known_theta
     orderedmainkeys = ['VS_CREATE','VS_DATE','VS_TYPE','VS_VERSION','NAME',
                        'MJD0','dMJD','GeoDist','GeoLat','GeoLong','obsloc',
-                       'posrefsys','earliest','latest','radii',
+                       'posrefsys','ephemeris_source','earliest','latest','radii',
                        'meanrad','orb_per','rot_per','T_mean']
     try:
         _tb.open(tablename, nomodify=False)
         disklat = _tb.getcol('DiskLat')
         if 'radii' in keydict:
             radiival = keydict['radii']['value']
             calc_meanrad = _mean_radius_with_known_theta(disklat, radiival)
```

## casatasks/private/sdint_helper.py

```diff
@@ -37,14 +37,19 @@
         except(ValueError):
             _ia.close()
             casalog.post('The image '+_ia.name()+' has no frequency axis. Try adding one with ia.adddegaxis() .', 'SEVERE')
 
         return freqaxis_index
             
     def getFreqList(self,imname=''):
+      """ Get the list of frequencies for the given image, one for each channel.
+
+      Returns:
+        list[float] The frequencies for each channel in the image, in Hz.
+      """
 
       _ia.open(imname)
       csys =_ia.coordsys()
       shp = _ia.shape()
       freqaxis_index = self.getFreqAxisIndex()
       _ia.close()
 
@@ -210,16 +215,22 @@
 
 ################################################
 
     def modify_with_pb(self, inpcube='', pbcube='',cubewt='', chanwt='', action='mult',pblimit=0.2, freqdep=True):
         """
         Multiply or divide by the PB
 
-        freqdep = True :  Channel by channel
-        freqdep = False : Before/After deconvolution, use a freq-independent PB from the middle of the list
+        Args:
+          inpcube: The cube to be modified. For example: "try.int.cube.model"
+          pbcube: The primary beam to multiply/divide by. For example: "try.int.cube.pb"
+          cubewt: The per-channel weight of the inpcube. For example: "try.int.cube.sumwt"
+          chanwt: List of 0s and 1s, one per channel, to effectively disable the effect of a channel on the resulting images.
+          action: 'mult' or 'div', to multiply by the PB or divide by it.
+          pblimit: For pixels less than this value in the PB, set those same pixels in the inpcube to zero.
+          freqdep: True for channel by channel, False to use a freq-independent PB from the middle of the list before/after deconvolution
         """
         casalog.post('Modify with PB : ' + action + ' with frequency dependence ' + str(freqdep))
 
         freqlist = self.getFreqList(inpcube)
 
         _ia.open(inpcube)
         shp=_ia.shape()
@@ -240,15 +251,15 @@
         pbplane = _ia.getchunk(blc=[0,0,0,refchan],trc=[shp[0],shp[1],0,refchan])
         _ia.close()
         pbplane.fill(0.0)
 
 #        pbplane = np.zeros( (shp[0],shp[1]), 'float')
 
         if freqdep==False:
-            _ia.open(cubewt)
+            _ia.open(cubewt) # .sumwt
             cwt = _ia.getchunk()[0,0,0,:]
             _ia.close()
 
             if shp[3] != len(cwt) or len(freqlist) != len(cwt):
                 raise Exception("Modify with PB : Nchan shape mismatch between cube and sumwt.")
 
             cwt = cwt * chanwt  ## Merge the weights and flags
@@ -356,16 +367,27 @@
         _ia.close()
         _ia.done() 
 
 ################################################
     def cube_to_taylor_sum(self, cubename='', cubewt='', chanwt='', mtname='',reffreq='1.5GHz',nterms=2,dopsf=False):
         """
         Convert Cubes (output of major cycle) to Taylor weighted averages (inputs to the minor cycle)
-        Input : Cube
-        Output : Set of images with suffix : .tt0, .tt1, etc...
+        Input : Cube image <cubename>, with channels weighted by image <cubewt>
+        Output : Set of images : <mtname>.tt0, <mtname>.tt1, etc...
+        Algorithm: I_ttN = sum([   I_v * ((f-ref)/ref)**N   for f in freqs   ])
+
+        Args:
+          cubename: Name of a cube image to interpret into a set of taylor term .ttN images, eg "try.residual", "joint.cube.psf".
+          cubewt: Name of a .sumwt image that contains the per-channel weighting for the interferometer image.
+          chanwt: List of 0s and 1s, one per channel, to effectively disable the effect of a channel on the resulting images.
+          mtname: The prefix output name, to be concatenated with ".ttN" strings, eg "try_mt.residual", "joint.multiterm.psf"
+                  These images should already exist by the time this function is called.
+                  It's suggested that this have same suffix as cubename.
+          dopsf: Signals that cubename represents a point source function, should be true if cubename ends with ".psf".
+                 If true, then output 2*nterms-1 ttN images.
         """
 
         refnu = _qa.convert( _qa.quantity(reffreq) ,'Hz' )['value']
 
         # casalog.post("&&&&&&&&& REF FREQ : " + str(refnu))
 
         pix=[]
```

## casatasks/private/sdutil.py

```diff
@@ -16,14 +16,33 @@
 from casatools import mstransformer, table
 
 from . import flaghelper as fh
 from casatasks.private.mstools import write_history
 from casatasks.private.parallel.parallel_data_helper import ParallelDataHelper
 from casatasks.private.update_spw import update_spwchan
 
+class Casalog:
+    """Easily and consistently log CASA messages.
+
+    Motivation:
+    The origin of a message posted directly with casalog.post
+    must be specified at each casalog.post call.
+
+    Usage Example:
+    def my_funtion():
+        logger = Casalog(origin="my_function")
+        logger.post("Hello 1") # Logs <TaskName>::my_function::<ProcessorName> Hello 1
+        logger.post("Hello 2") # Logs <TaskName>::my_function::<ProcessorName> Hello 2
+
+    """
+    def __init__(self, origin: str):
+        """Construct an object posting messages having the given origin
+        """
+        self.post = functools.partial(casalog.post, origin=origin)
+
 
 @contextlib.contextmanager
 def tool_manager(vis, ctor, *args, **kwargs):
     # this is the only syntax allowed in CASA6, code in CASA6 should be converted to
     # call this method with a tool constructor directly
     tool = ctor()
     if vis and "open" in dir(tool):
```

## casatasks/private/task_deconvolve.py

```diff
@@ -16,15 +16,15 @@
     is_CASA6 = is_python3
 
 from casatasks import casalog
 
 from casatools import image
 from casatasks.private.imagerhelpers.imager_deconvolver import PyDeconvolver
 from casatasks.private.imagerhelpers.input_parameters import ImagerParameters
-from casatasks.private.imagerhelpers.imager_return_dict import ReturnDictionary
+from casatasks.private.imagerhelpers.imager_return_dict import ImagingDict
 from casatasks.private.parallel.parallel_task_helper import ParallelTaskHelper
 from .cleanhelper import write_tclean_history, get_func_params
 from casatools import synthesisimager
 ia = image( )
 
 try:
     if is_CASA6:
@@ -269,33 +269,41 @@
 
         ## Set up the internal state of the iterater and automask
         # is this necessary? -> I think so ~bgb200731
         isit = decon.hasConverged()
         decon.updateMask()
 
         isit = decon.hasConverged() # here in case updateMaskMinor() produces an all-false mask
+        runmin = not isit   ##  Are minor cycles going to be run or not ?  Will the return dictionary have summaryminor or not ?
+        ##print ("Runmin? " , runmin)
         if not isit:
             # print("running minor cycle");
             t0=time.time();
             decon.runMinorCycle()
             t1=time.time();
             casalog.post("***Time for minor cycle: "+"%.2f"%(t1-t0)+" sec", "INFO3", "task_deconvolve");
             isit = decon.hasConverged() # get the convergence state, to report back to the calling code
 
 
         # Residual image needs to be computed for this to work
-        if niter==0:
-            rd = ReturnDictionary()
-            retrec = rd.constructResidualDict(paramList)
+        if niter==0 or runmin==False:
+            id = ImagingDict()
+            retrec1 = id.construct_residual_dict(paramList)
 
         ## Get summary from iterbot
         #if type(interactive) != bool and niter>0:
         # this requrirment should go...
-        if niter>0:
-            retrec=decon.getSummary(fullsummary);
+        #if niter>0:
+        retrec=decon.getSummary(fullsummary);
+
+        if niter==0 or runmin==False:
+            retrec['summaryminor'] = retrec1['summaryminor']  #CAS-14184
+            retrec['stopcode'] = retrec1['stopcode']
+            retrec['stopDescription'] = retrec1['stopDescription']
+
 
         #################################################
         #### Teardown
         #################################################
 
         ## Get records from iterbot, to be used in the next call to deconvolve
         iterrec = decon.getIterRecords()
```

## casatasks/private/task_fixplanets.py

```diff
@@ -1,33 +1,41 @@
-from __future__ import absolute_import
 import shutil
 import os
 import string
 
-# get is_CASA6 and is_python3
-from casatasks.private.casa_transition import *
-if is_CASA6:
-    from .parallel.parallel_task_helper import ParallelTaskHelper
-    from . import JPLephem_reader2 as jplreader
-    from casatools import ms as mstool
-    from casatools import table as tbtool
-    from casatools import imager as imtool
-    from casatools import measures, quanta
-    from casatasks import casalog
-    from .mstools import write_history
-    _qa = quanta( )
-    _me = measures( )
-else:
-    from taskinit import *
-    from mstools import write_history
-    from parallel.parallel_task_helper import ParallelTaskHelper
-    import recipes.ephemerides.JPLephem_reader2 as jplreader
-    # not really local copies
-    _qa = qa
-    _me = me
+from .parallel.parallel_task_helper import ParallelTaskHelper
+from casatools import ms as mstool
+from casatools import table as tbtool
+from casatools import imager as imtool
+from casatools import measures, quanta
+from casatasks import casalog
+from .mstools import write_history
+_qa = quanta( )
+_me = measures( )
+
+def _checkinternalephemtab(vis, field):
+    """
+    This function checks if there is an ephemeris table attached in the MS for
+    the field selected. It will returned table names found under FIELD table.
+
+    """
+    import glob
+    from casatools import table, ms
+    _tb = table()
+    _ms = ms() 
+    fids = _ms.msseltoindex(vis=vis,field=field)['field']
+    _tb.open(vis+'/FIELD')
+    ephemnames = []
+    if 'EPHEMERIS_ID' in _tb.colnames():
+        for i in fids:
+            ephemid = _tb.getcell('EPHEMERIS_ID',i)
+            if ephemid != -1:
+                ephemnames.append(glob.glob(f'{vis}/FIELD/EPHEM{ephemid}*/')[0])
+    _tb.close()
+    return list(set(ephemnames))
 
 def fixplanets(vis, field, fixuvw=False, direction='', refant=0, reftime='first'):
     """
     Fix FIELD, SOURCE, and UVW for given fields based on given direction or pointing
     table information
 
     This task's main purpose is to correct observations which were performed
@@ -42,22 +50,19 @@
     field      -- field selection string
     
     fixuvw     -- recalc uvw coordinates? (default: False)
 
     direction  -- if set, don't use pointing table but set direction to this value.
                   The direction can either be given explicitly or as the path
                   to a JPL Horizons ephemeris (for an example of the format,
-                  see directory data/ephemerides/JPL-Horizons/).
-                  Alternatively, the ephemeris table can also be provided as mime format file,
-                  i.e. a saved email as obtained via the commands (for example):
-                  import recipes.ephemerides.request as jplreq
-                  jplreq.request_from_JPL(objnam='Mars',startdate='2012-01-01',enddate='2014-12-31',
-                       date_incr='0.1 d', get_axis_orientation=False, get_axis_ang_orientation=True,
-                       get_sub_long=True, use_apparent=False, get_sep=False,
-                       return_address='YOUR_EMAIL_ADDESS', mailserver='YOUR_MAIL_SERVER_ADDRESS')
+                  ephemerides/JPL-Horizons/ in the local data directory or "External Data" section 
+                  of the current CASADocs).
+                  Alternatively, the ephemeris table can also be obtained using
+                  getephemtable task.
+ 
                   example: 'J2000 19h30m00 -40d00m00', default= '' (use pointing table)
 
     refant     -- if using pointing table information, use it from this antenna
                   default: 0 (antenna id 0)
                   examples: 'DV06' (antenna with name DV06)
                             3 (antenna id 3)
 
@@ -253,33 +258,33 @@
 
             else: # direction is not an empty string, use this instead of the pointing table information
                 if(type(direction)==str):
                     dirstr = direction.split(' ')
                     if len(dirstr)==1: # an ephemeris table was given
                         if(os.path.exists(dirstr[0])):
                             if os.path.isfile(dirstr[0]): # it is a file, i.e. not a CASA table
-                                try: # a mime file maybe?
-                                    outdict=jplreader.readJPLephem(dirstr[0], '1.0')
-                                    if not jplreader.ephem_dict_to_table(outdict, dirstr[0]+".tab"):
-                                        raise ValueError("Error converting dictionary to ephem table")
-                                except: # no it is not a mime file either
-                                    msg = "*** Error when interpreting parameter \'direction\':\n File given is not a valid JPL email mime format file."
-                                    raise RuntimeError(msg)
-                                else:
-                                    theephemeris = dirstr[0]+".tab"
-                                    casalog.post('Successfully converted mime format ephemeris to table '+theephemeris+'.\n Will use it with offset (0,0)', 'NORMAL')
+                                msg = "*** Error when interpreting parameter \'direction\':\n  A file is given. Use of the JPL-Horizons "+\
+                                     "MIME format file is deprecated."
+                                raise RuntimeError(msg)
                             else: # not a file, assume it is a CASA table
                                 theephemeris = dirstr[0]
+                                # add a check if it is going to replace the existing table in the MS
+                                existingephemtab = _checkinternalephemtab(vis, field)
+                                if existingephemtab != []:
+                                    casalog.post(f'Will replace existing ephemeris table {existingephemtab} in the MS with {direction}. '+\
+                                         'Ephemeris tables attached in the MS are assumed to be the ones used by the correlator and attaching' +\
+                                         ' a different ephemeris table may lead to scientifically wrong results.','WARN') 
+
                                 casalog.post('Will use ephemeris table '+theephemeris+' with offset (0,0)', 'NORMAL')
                             
                             thenewra_rad = 0.
                             thenewdec_rad = 0.
 
                         else:
-                            msg = "*** Error when interpreting parameter \'direction\':\n string is neither a direction nor an existing file or table."
+                            msg = "*** Error when interpreting parameter \'direction\':\n string is neither a direction nor a table."
                             raise RuntimeError(msg)
                     else:
                         if len(dirstr)==2: # a direction without ref frame was given
                             dirstr = ['J2000', dirstr[0], dirstr[1]]
                             casalog.post('Assuming reference frame J2000 for parameter \'direction\'', 'NORMAL')
                         elif not len(dirstr)==3:
                             msg = 'Incorrect format in parameter \'direction\''
@@ -402,15 +407,15 @@
                 except Exception as instance:
                     raise RuntimeError("*** Error \'%s\' when attaching ephemeris: " %
                                        (instance))
                 finally:
                     mst.close()
 
 
-            if(fixuvw and (oldrefcol!=[]) and (thenewref>0)): 
+            if(fixuvw and (len(oldrefcol)!=0) and (thenewref>0)): 
                 # modify reference of phase dir for fixuvw
                 pcol = tbt.getcol('PhaseDir_Ref')
                 pcol[fld] = 0 # J2000
                 tbt.putcol('PhaseDir_Ref', pcol) # J2000
 
             tbt.close()
 
@@ -426,18 +431,18 @@
             tbt.open(vis+'/SOURCE', nomodify=False)
             sdir = tbt.getcol('DIRECTION')
             newsdir = sdir
             sname = tbt.getcol('NAME')
 
             for i in range(0,tbt.nrows()):
                 if(sname[i]==planetname):
-                    # casalog.post('i old dir ' + i + " " + sdir[0][i] + sdir[1][i])
+                    #casalog.post('i old dir ' + i + " " + sdir[0][i] + sdir[1][i])
                     newsdir[0][i] = newsra_rad
                     newsdir[1][i] = newsdec_rad
-                    # casalog.post('  new dir ' + newsdir[0][i] + newsdir[1][i])
+                    #casalog.post('  new dir ' + newsdir[0][i] + newsdir[1][i])
             tbt.putcol('DIRECTION', newsdir)
             tbt.close()
             casalog.post("SOURCE table DIRECTION column changed.", 'NORMAL')
 
         # end for
 
         if(fixuvw):
@@ -452,15 +457,15 @@
                     
             imt = imtool()
             imt.open(vis, usescratch=False)
             imt.calcuvw(fldids, refcode='J2000', reuse=False)
             imt.close()
             imt = None
 
-            if((oldrefcol!=[]) and (thenewref>0)): 
+            if((len(oldrefcol)!=0) and (thenewref>0)): 
                 tbt.open(vis+'/FIELD', nomodify=False)
                 tbt.putcol('PhaseDir_Ref', oldrefcol)
                 tbt.close()
 
         else:
             casalog.post("UVW coordinates not changed.", 'NORMAL')
 
@@ -472,19 +477,16 @@
         mst = None
         tbt = None
         imt = None
 
     # Write history to MS
     try:
         param_names = fixplanets.__code__.co_varnames[:fixplanets.__code__.co_argcount]
-        if is_python3:
-            vars = locals()
-            param_vals = [vars[p] for p in param_names]
-        else:
-            param_vals = [eval(p) for p in param_names]
+        vars = locals()
+        param_vals = [vars[p] for p in param_names]
         write_history(mstool(), vis, 'fixplanets', param_names,
                       param_vals, casalog)
     except Exception as instance:
         casalog.post("*** Error \'%s\' updating HISTORY" % (instance),
                      'WARN')
 
     mst = None
```

## casatasks/private/task_flagdata.py

```diff
@@ -564,15 +564,15 @@
 
             # Add the agent's parameters
             seldic.update(agent_pars)
 
             tempdict = copy.deepcopy(seldic)
             # Remove the empty parameters
             for k,v in seldic.items():
-                if v == '':
+                if isinstance(v, str) and v == '':
                     tempdict.pop(k)
 
             cmddict = {'command':tempdict}
             cmddict['reason'] = ''
             cmddict['applied'] = False
             flagcmd[0] = cmddict
```

## casatasks/private/task_imcollapse.py

```diff
@@ -16,15 +16,15 @@
 # License for more details.
 #
 # You should have received a copy of the GNU Library General Public License
 # along with this library; if not, write to the Free Software Foundation,
 # Inc., 675 Massachusetts Ave, Cambridge, MA 02139, USA.
 #
 # Correspondence concerning AIPS++ should be adressed as follows:
-#        Internet email: aips2-request@nrao.edu.
+#        Internet email: casa-feedback@nrao.edu.
 #        Postal address: AIPS++ Project Office
 #                        National Radio Astronomy Observatory
 #                        520 Edgemont Road
 #                        Charlottesville, VA 22903-2475 USA
 #
 # <author>
 # Dave Mehringer
```

## casatasks/private/task_imhead.py

```diff
@@ -17,15 +17,15 @@
 # License for more details.
 #
 # You should have received a copy of the GNU Library General Public License
 # along with this library; if not, write to the Free Software Foundation,
 # Inc., 675 Massachusetts Ave, Cambridge, MA 02139, USA.
 #
 # Correspondence concerning AIPS++ should be adressed as follows:
-#        Internet email: aips2-request@nrao.edu.
+#        Internet email: casa-feedback@nrao.edu.
 #        Postal address: AIPS++ Project Office
 #                        National Radio Astronomy Observatory
 #                        520 Edgemont Road
 #                        Charlottesville, VA 22903-2475 USA
 #
 # <author>
 # Shannon Jaeger (University of Calgary)
```

## casatasks/private/task_immath.py

```diff
@@ -15,15 +15,15 @@
 # License for more details.
 #
 # You should have received a copy of the GNU Library General Public License
 # along with this library; if not, write to the Free Software Foundation,
 # Inc., 675 Massachusetts Ave, Cambridge, MA 02139, USA.
 #
 # Correspondence concerning AIPS++ should be adressed as follows:
-#        Internet email: aips2-request@nrao.edu.
+#        Internet email: casa-feedback@nrao.edu.
 #        Postal address: AIPS++ Project Office
 #                        National Radio Astronomy Observatory
 #                        520 Edgemont Road
 #                        Charlottesville, VA 22903-2475 USA
 #
 # <summary>
 # CASA task for smoothing an image, by doing Forier-based convolution
```

## casatasks/private/task_immoments.py

```diff
@@ -16,15 +16,15 @@
 # License for more details.
 #
 # You should have received a copy of the GNU Library General Public License
 # along with this library; if not, write to the Free Software Foundation,
 # Inc., 675 Massachusetts Ave, Cambridge, MA 02139, USA.
 #
 # Correspondence concerning AIPS++ should be adressed as follows:
-#        Internet email: aips2-request@nrao.edu.
+#        Internet email: casa-feedback@nrao.edu.
 #        Postal address: AIPS++ Project Office
 #                        National Radio Astronomy Observatory
 #                        520 Edgemont Road
 #                        Charlottesville, VA 22903-2475 USA
 #
 # <author>
 # Shannon Jaeger (University of Calgary)
```

## casatasks/private/task_impbcor.py

```diff
@@ -15,15 +15,15 @@
 # License for more details.
 #
 # You should have received a copy of the GNU Library General Public License
 # along with this library; if not, write to the Free Software Foundation,
 # Inc., 675 Massachusetts Ave, Cambridge, MA 02139, USA.
 #
 # Correspondence concerning AIPS++ should be adressed as follows:
-#        Internet email: aips2-request@nrao.edu.
+#        Internet email: casa-feedback@nrao.edu.
 #        Postal address: AIPS++ Project Office
 #                        National Radio Astronomy Observatory
 #                        520 Edgemont Road
 #                        Charlottesville, VA 22903-2475 USA
 #
 # <author>
 # Dave Mehringer
```

## casatasks/private/task_importgmrt.py

```diff
@@ -16,15 +16,15 @@
 # License for more details.
 #
 # You should have received a copy of the GNU Library General Public License
 # along with this library; if not, write to the Free Software Foundation,
 # Inc., 675 Massachusetts Ave, Cambridge, MA 02139, USA.
 #
 # Correspondence concerning AIPS++ should be adressed as follows:
-#        Internet email: aips2-request@nrao.edu.
+#        Internet email: casa-feedback@nrao.edu.
 #        Postal address: AIPS++ Project Office
 #                        National Radio Astronomy Observatory
 #                        520 Edgemont Road
 #                        Charlottesville, VA 22903-2475 USA
 #
 # <author>
 # Shannon Jaeger (University of Calgary)
```

## casatasks/private/task_imsmooth.py

```diff
@@ -15,15 +15,15 @@
 # License for more details.
 #
 # You should have received a copy of the GNU Library General Public License
 # along with this library; if not, write to the Free Software Foundation,
 # Inc., 675 Massachusetts Ave, Cambridge, MA 02139, USA.
 #
 # Correspondence concerning AIPS++ should be adressed as follows:
-#        Internet email: aips2-request@nrao.edu.
+#        Internet email: casa-feedback@nrao.edu.
 #        Postal address: AIPS++ Project Office
 #                        National Radio Astronomy Observatory
 #                        520 Edgemont Road
 #                        Charlottesville, VA 22903-2475 USA
 #
 # <summary>
 # CASA task for smoothing an image, by doing Forier-based convolution
```

## casatasks/private/task_imtrans.py

```diff
@@ -15,15 +15,15 @@
 # License for more details.
 #
 # You should have received a copy of the GNU Library General Public License
 # along with this library; if not, write to the Free Software Foundation,
 # Inc., 675 Massachusetts Ave, Cambridge, MA 02139, USA.
 #
 # Correspondence concerning AIPS++ should be adressed as follows:
-#        Internet email: aips2-request@nrao.edu.
+#        Internet email: casa-feedback@nrao.edu.
 #        Postal address: AIPS++ Project Office
 #                        National Radio Astronomy Observatory
 #                        520 Edgemont Road
 #                        Charlottesville, VA 22903-2475 USA
 #
 # <author>
 # Dave Mehringer
```

## casatasks/private/task_plotbandpass.py

```diff
@@ -21,14 +21,15 @@
 import time
 import copy
 
 import matplotlib.transforms
 import numpy as np
 import pylab as pb
 from casatasks import casalog
+from casatasks.private import sdutil, simutil
 from casatools import (atmosphere, ctsys, measures, ms, msmetadata, quanta,
                        table)
 from matplotlib.ticker import (FormatStrFormatter, MultipleLocator,
                                ScalarFormatter)
 from six.moves import input, range
 
 # CAS-13722, CAS-13385
@@ -503,15 +504,15 @@
 #        return(mymsmd.nspw())
 
 
 def drawOverlayTimeLegends(xframe,firstFrame,xstartTitle,ystartTitle,caltable,titlesize,
                            fieldIndicesToPlot,ispwInCalTable,uniqueTimesPerFieldPerSpw,
                            timerangeListTimes, solutionTimeThresholdSeconds,debugSloppyMatch,
                            ystartOverlayLegend,debug,mysize, fieldsToPlot,myUniqueColor,
-                           timeHorizontalSpacing, fieldIndex,overlayColors,
+                           timeHorizontalSpacing, fieldIndex, overlayColors,
                            antennaVerticalSpacing, overlayAntennas,
                            timerangeList, caltableTitle,
                            mytime, scansToPlot, scansForUniqueTimes):
     """
     Draws the legend at the top of the page, if it is the correct time to do so,
     including the overlayTimes, the 'UT' label, and the caltable name.
     """
@@ -605,15 +606,15 @@
 
 def drawAtmosphereAndFDM(showatm, showtsky, atmString, subplotRows, mysize, TebbSky,
                          TebbSkyImage,plotrange, xaxis, atmchan, atmfreq, transmission,
                          subplotCols, showatmPoints,xframe, channels,LO1,atmchanImage,
                          atmfreqImage,transmissionImage, firstFrame,showfdm,nChannels,tableFormat,
                          originalSpw_casa33, chanFreqGHz_casa33,originalSpw,chanFreqGHz,
                          overlayTimes, overlayAntennas, xant, antennasToPlot, overlaySpws,
-                         baseband, showBasebandNumber, basebandDict, overlayBasebands,
+                         baseband, showBasebandNumber, basebandDict, overlayBasebands, overlayColors,
                          drewAtmosphere, showtsys=False, Trx=None):
     """
     If requested by the user at the command line, draw the atmospheric curve
     and the FDM window locations.
     """
     mylineno = lineNumber()
     ylim = pb.ylim()  # CAS-8655
@@ -642,18 +643,18 @@
 #    if (overlayTimes==False or overlayAntennas==False or xant==antennasToPlot[-1]):
     # Because this function is now only called from one place, setting this to
     # True is what we want. - 18-Jun-2013
     if (True):
         if (xaxis.find('freq')>=0 and showfdm and nChannels <= 256):
             if (tableFormat == 33):
                 showFDM(originalSpw_casa33, chanFreqGHz_casa33,
-                        baseband, showBasebandNumber, basebandDict)
+                        baseband, showBasebandNumber, basebandDict, overlayColors)
             else:
                 showFDM(originalSpw, chanFreqGHz,
-                        baseband, showBasebandNumber, basebandDict)
+                        baseband, showBasebandNumber, basebandDict, overlayColors)
             ylim = pb.ylim()  # CAS-11062 need to pass the new wider limits back up to calling function
     return ylim  # CAS-8655
 
 def DrawPolarizationLabelsForOverlayTime(xstartPolLabel,ystartPolLabel,corr_type,polsToPlot,
                                          channeldiff,ystartMadLabel,subplotRows,gamp_mad,mysize,
                                          ampmarkstyle,markersize,ampmarkstyle2, gamp_std):
     """
@@ -3409,15 +3410,15 @@
                                                        xframe, channels,LO1,atmchanImage,atmfreqImage,
                                                        transmissionImage, firstFrame,showfdm,nChannels,
                                                        tableFormat,originalSpw_casa33,
                                                        chanFreqGHz_casa33,originalSpw,chanFreqGHz,
                                                        overlayTimes, overlayAntennas, xant,
                                                        antennasToPlot, overlaySpws, baseband,
                                                        showBasebandNumber, basebandDict,
-                                                       overlayBasebands, drewAtmosphere, showtsys)
+                                                       overlayBasebands, overlayColors, drewAtmosphere, showtsys)
                                   drewAtmosphere = True
                               if (xctr == firstUnflaggedAntennaToPlot or overlayAntennas==False): # changed xant->xctr on 11-mar-2014
                                   DrawPolarizationLabelsForOverlayTime(xstartPolLabel,ystartPolLabel,corr_type,polsToPlot,
                                                                        channeldiff,ystartMadLabel,subplotRows,gamp_mad,mysize,
                                                                        ampmarkstyle,markersize,ampmarkstyle2,gamp_std)
                       else:  # not overlaying times
                           msg = "Skip %s spw%d (%s) all data flagged" % (antstring, ispw, titleString)
@@ -4163,15 +4164,15 @@
                                   if (debug): print("drawOverlayTimeLegends loc 2")
                                   drawOverlayTimeLegends(xframe,firstFrame,xstartTitle,ystartTitle,
                                                          caltable,titlesize,fieldIndicesToPlot,
                                                          ispwInCalTable,uniqueTimesPerFieldPerSpw,
                                                          timerangeListTimes, solutionTimeThresholdSeconds,
                                                          debugSloppyMatch,ystartOverlayLegend,debug,mysize,
                                                          fieldsToPlot,myUniqueColor,timeHorizontalSpacing,
-                                                         fieldIndex,overlayColors, antennaVerticalSpacing,
+                                                         fieldIndex, overlayColors, antennaVerticalSpacing,
                                                          overlayAntennas, timerangeList, caltableTitle,
                                                          mytime, scansToPlotPerSpw[ispw], scansForUniqueTimes)
 #                                                         mytime, scansToPlot, scansForUniqueTimes) # task version
                                   if (debug): print("done drawOverlayTimeLegends loc 2")
                       elif (overlayAntennas and overlayTimes):  # Oct 23, 2012
                           # This will only happen for overlay='antenna,time'
                           if (xframe == firstFrame and mytime == firstTimeMatch and xctr==firstUnflaggedAntennaToPlot and bOverlay==False):  # bug fix on 2015-08-19 for CAS-7820
@@ -4195,15 +4196,15 @@
                                 # This is necessary for the case that no antennas were flagged for the single timerange selected
                                 if (debug): print("drawOverlayTimeLegends loc 3")
                                 drawOverlayTimeLegends(xframe,firstFrame,xstartTitle,ystartTitle,caltable,titlesize,
                                                        fieldIndicesToPlot,ispwInCalTable,uniqueTimesPerFieldPerSpw,
                                                        timerangeListTimes, solutionTimeThresholdSeconds,
                                                        debugSloppyMatch,ystartOverlayLegend,debug,mysize,
                                                        fieldsToPlot,myUniqueColor,timeHorizontalSpacing,
-                                                       fieldIndex,overlayColors, antennaVerticalSpacing,
+                                                       fieldIndex, overlayColors, antennaVerticalSpacing,
                                                        overlayAntennas, timerangeList, caltableTitle,
                                                        mytime, scansToPlotPerSpw[ispw], scansForUniqueTimes)
 #                                                       mytime, scansToPlot, scansForUniqueTimes) # task version
 
 
                       if (debug): print("####### 2nd place")
                       # Here is 2nd place where we eliminate any white space on the right and left edge of the plots: 'amp'
@@ -4266,17 +4267,17 @@
                                                  overlaySpws=overlaySpws,
                                                  overlayBasebands=overlayBasebands,
                                                  drewAtmosphere=drewAtmosphere,loc=204,
                                                  showtsys=showtsys, Trx=Trx)
                               drewAtmosphere = True
                           if (xaxis.find('freq')>=0 and showfdm and nChannels <= 256):
                               if (tableFormat == 33):
-                                  showFDM(originalSpw_casa33, chanFreqGHz_casa33, baseband, showBasebandNumber, basebandDict)
+                                  showFDM(originalSpw_casa33, chanFreqGHz_casa33, baseband, showBasebandNumber, basebandDict, overlayColors)
                               else:
-                                  showFDM(originalSpw, chanFreqGHz, baseband, showBasebandNumber, basebandDict)
+                                  showFDM(originalSpw, chanFreqGHz, baseband, showBasebandNumber, basebandDict, overlayColors)
                       if (debug): print("done drawAtmosphere/FDM check")
 
                       if (bOverlay):
                           # draw polarization labels
                           x0 = xstartPolLabel
                           y0 = ystartPolLabel
                           for p in range(nPolarizations):
@@ -4988,15 +4989,15 @@
                                   if (debug): print("drawOverlayTimeLegends loc 4")
                                   drawOverlayTimeLegends(xframe,firstFrame,xstartTitle,ystartTitle,
                                                          caltable,titlesize,fieldIndicesToPlot,
                                                          ispwInCalTable,uniqueTimesPerFieldPerSpw,
                                                          timerangeListTimes, solutionTimeThresholdSeconds,
                                                          debugSloppyMatch,ystartOverlayLegend,debug,mysize,
                                                          fieldsToPlot,myUniqueColor,timeHorizontalSpacing,
-                                                         fieldIndex,overlayColors, antennaVerticalSpacing,
+                                                         fieldIndex, overlayColors, antennaVerticalSpacing,
                                                          overlayAntennas, timerangeList, caltableTitle,
                                                          mytime, scansToPlotPerSpw[ispw], scansForUniqueTimes)
 #                                                         mytime, scansToPlot, scansForUniqueTimes) # task version
 
                       elif (overlayAntennas and overlayTimes):  # Oct 23, 2012
                           # This will only happen for: try to support overlay='antenna,time'
                           if (xframe == firstFrame and mytime==0 and xctr==firstUnflaggedAntennaToPlot and bOverlay==False):
@@ -5064,17 +5065,17 @@
                                                  overlayBasebands=overlayBasebands,
                                                  drewAtmosphere=drewAtmosphere, loc=206,
                                                  showtsys=showtsys, Trx=Trx)
                               drewAtmosphere = True
 
                           if (xaxis.find('freq')>=0 and showfdm and nChannels <= 256):
                               if (tableFormat == 33):
-                                  showFDM(originalSpw_casa33, chanFreqGHz_casa33, baseband, showBasebandNumber, basebandDict)
+                                  showFDM(originalSpw_casa33, chanFreqGHz_casa33, baseband, showBasebandNumber, basebandDict, overlayColors)
                               else:
-                                  showFDM(originalSpw, chanFreqGHz, baseband, showBasebandNumber, basebandDict)
+                                  showFDM(originalSpw, chanFreqGHz, baseband, showBasebandNumber, basebandDict, overlayColors)
 
                       if (bOverlay):
                           # draw polarization labels
                           x0 = xstartPolLabel
                           y0 = ystartPolLabel
                           for p in range(nPolarizations):
                               if (corrTypeToString(corr_type[p]) in polsToPlot):
@@ -5666,14 +5667,15 @@
           except:
               pwvmean = defaultPWV
 
     if (verbose):
         print("Using PWV = %.2f mm" % pwvmean)
 
     # default values in case we can't find them below
+    myqa = quanta()
     airmass = 1.5
     P = 563.0
     H = 20.0
     T = 273.0
     roundedScanTimes = []
     if (type(mymsmd) != str):
         if (verbose):
@@ -5701,15 +5703,18 @@
                 if (verbose): print("bestscan = %s" % (str(bestscan)))
                 mindiff = tdiff
         if (verbose):
               print("For timestamp=%.1f, got closest scan = %d, %.0f sec away" %(timestamp, bestscan,mindiff))
         if (verbose): print("Calling getWeather()")
         [conditions,myTimes] = getWeather(vis,bestscan,antenna,verbose,mymsmd)
         if (verbose): print("Done getWeather()")
-        P = conditions['pressure']
+
+        # convert pressure with unit to the value in mbar
+        P = myqa.convert(myqa.quantity(conditions['pressure'], conditions['pressure_unit']), 'mbar')['value']
+
         H = conditions['humidity']
         T = conditions['temperature']+273.15
         if (P <= 0.0):
             P = 563
         if (H <= 0.0):
             H = 20
     else:
@@ -5742,14 +5747,21 @@
           print("P,H,T = %f,%f,%f" % (P,H,T))
     if (conditions['elevation'] <= 3):
         print("Using 45 deg elevation instead")
         airmass = 1.0/math.cos(45*math.pi/180.)
     else:
         airmass = 1.0/math.cos((90-conditions['elevation'])*math.pi/180.)
 
+    # get the elevation of the antenna
+    geodetic_elevation = 5059
+    if os.path.exists(os.path.join(vis, 'ANTENNA')):
+        with sdutil.table_manager(os.path.join(vis, 'ANTENNA')) as tb:
+            _X, _Y, _Z = (float(i) for i in tb.getcell('POSITION', antenna))
+            geodetic_elevation = simutil.simutil().xyz2long(_X, _Y, _Z, 'WGS84')[2]
+
     tropical = 1
     midLatitudeSummer = 2
     midLatitudeWinter = 3
     numchan = len(freqs)
     # Set the reference freq to be the middle of the middle two channels
     reffreq=0.5*(freqs[numchan//2-1]+freqs[numchan//2])
     originalnumchan = numchan
@@ -5759,19 +5771,20 @@
         chans = list(range(0,originalnumchan,(originalnumchan//numchan)))
 
     chansep = (freqs[-1]-freqs[0])/(numchan-1)
     nbands = 1
     if (verbose): print("Opening casac.atmosphere()")
     myat = atmosphere()
     if (verbose): print("Opened")
-    myqa = quanta()
     fCenter = myqa.quantity(reffreq,'GHz')
     fResolution = myqa.quantity(chansep,'GHz')
     fWidth = myqa.quantity(numchan*chansep,'GHz')
-    myat.initAtmProfile(humidity=H,temperature=myqa.quantity(T,"K"),altitude=myqa.quantity(5059,"m"),pressure=myqa.quantity(P,'mbar'),atmType=midLatitudeWinter)
+    myat.initAtmProfile(humidity=H, temperature=myqa.quantity(T, "K"),
+                        altitude=myqa.quantity(geodetic_elevation, "m"),
+                        pressure=myqa.quantity(P, 'mbar'), atmType=midLatitudeWinter)
     myat.initSpectralWindow(nbands,fCenter,fWidth,fResolution)
     myat.setUserWH2O(myqa.quantity(pwvmean,'mm'))
 
 #    myat.setAirMass()  # This does not affect the opacity, but it does effect TebbSky, so do it manually.
 
     n = myat.getNumChan()
     if (verbose): print("numchan = %s" % (str(n)))
@@ -6149,15 +6162,15 @@
                 except:
                     print("b)Invalid chanrange (%d-%d). Valid range = 0-%d" % (cr0,cr1,len(frequencies)-1))
                     return(-1)
     if (abs(plotrange[2]) > 0 or abs(plotrange[3]) > 0):
         SetNewYLimits([plotrange[2],plotrange[3]])
     return(0)
 
-def showFDM(originalSpw, chanFreqGHz, baseband, showBasebandNumber, basebandDict):
+def showFDM(originalSpw, chanFreqGHz, baseband, showBasebandNumber, basebandDict, overlayColors):
     """
     Draws a horizontal bar indicating the location of FDM spws in the dataset.
 
     Still need to limit based on the baseband -- need dictionary passed in.
     originalSpw: should contain all spws in the dataset, not just the ones
                 in the caltable
     baseband: the baseband of the current spw
@@ -7189,14 +7202,15 @@
         mytb.done()
         return([conditions,myTimes])
     if (True):
         mjdsec = mytb.getcol('TIME')
         indices = np.argsort(mjdsec)
         mjd = mjdsec/86400.
         pressure = mytb.getcol('PRESSURE')
+        conditions['pressure_unit'] = mytb.getcolkeywords('PRESSURE').get('QuantumUnits', ['mbar'])[0]
         relativeHumidity = mytb.getcol('REL_HUMIDITY')
         temperature = mytb.getcol('TEMPERATURE')
         if (np.median(temperature) > 100):
             # must be in units of Kelvin, so convert to C
             temperature -= 273.15
         if 'DEW_POINT' in mytb.colnames():
             dewPoint = mytb.getcol('DEW_POINT')
```

## casatasks/private/task_polfromgain.py

```diff
@@ -13,20 +13,23 @@
 except ImportError:
     from taskinit import *
 
     mytb=tbtool()
     myme=metool()
     mymd=msmdtool()
 
-def polfromgain(vis,tablein,caltable,paoffset):
+def polfromgain(vis,tablein,caltable,paoffset,minpacov):
 
     casalog.origin('polfromgain')
 
     casalog.post("Deriving calibrator linear polarization from gain ratios.")
 
+    casalog.post("Requiring at least "+str(minpacov)+" deg of parallactic angle coverage for each antenna solution.")
+    minpacovR=minpacov*pi/180.0
+
     try:
 
         if ((type(vis)==str) & (os.path.exists(vis))):
             mymd.open(vis)
         else:
             raise ValueError('Visibility data set not found - please verify the name')
 
@@ -90,33 +93,29 @@
             IQUV[fldnames[ifld]]={}
             for ispw in uspws:
 
                 r=mypl.zeros(nant)
                 q=mypl.zeros(nant)
                 u=mypl.zeros(nant)
                 antok=mypl.zeros(nant,dtype=bool)
+                parangbyant={}  # we will remember parang outside main iant loop (for rempol on bad ants)
+                
+                casalog.post('Fld='+fldnames[ifld]+' Spw='+str(ispw)+':')
 
                 for iant in range(nant):
                     qstring='FIELD_ID=='+str(ifld)+' && SPECTRAL_WINDOW_ID=='+str(ispw)+' && ANTENNA1=='+str(iant)
                     st=mytb.query(query=qstring)
                     nrows=st.nrows()
                     if nrows > 0:
 
                         times=st.getcol('TIME')
                         gains=st.getcol('CPARAM')
                         flags=st.getcol('FLAG')
                         flags=mypl.logical_or(flags[0,0,:],flags[1,0,:])  # 1D
 
-                        # Escape if insufficient data
-                        if (nrows-mypl.sum(flags))<3:
-                            antok[iant]=False
-                            st.close()
-                            continue
-
-
                         # parang
                         parang=mypl.zeros(len(times))
                 
                         apos=mymd.antennaposition(iant)
                         latr=myme.measure(apos,'WGS84')['m1']['value']
                         myme.doframe(apos)
                         har=mypl.zeros(nrows)
@@ -126,88 +125,143 @@
                             last-=floor(last)  # days
                             last*=24.0  # hours
                             ha=last-rah  # hours
                             har[itim]=ha*2.0*pi/24.0  # radians
                     
                         parang=mypl.arctan2( (cos(latr)*mypl.sin(har)),
                                              (sin(latr)*cos(decr)-cos(latr)*sin(decr)*mypl.cos(har)) )
+                        # correct for cycle at +/-180.
+                        #   (makes values crossing +/-180 deg all positive, and thus continuous)
+                        #   (hmm, this will still fail at inferior circumpolar transit, but that is very rare)
+                        if (latr<decr):
+                            parang[parang<0.0]+=(2*pi)
 
                         parang+=rang[iant,ispw]
                         parang+=(paoffset*pi/180.)       # manual feed pa offset
-                    
+
+                        # save parang values for this antenna
+                        parangbyant[iant]=parang
+
+                        # Escape if insufficient samples
+                        nsamp=nrows-mypl.sum(flags)
+                        if (nsamp<3):
+                            antok[iant]=False
+                            casalog.post('  Ant='+str(iant)+' has insuffiencient sampling: nsamp='+
+                                         str(nsamp)+' < 3')
+                            st.close()
+                            continue
+
+                        # Check parang coverage
+                        dparang=abs(parang[~flags].max()-parang[~flags].min())  # rad
+                        if dparang<minpacovR:
+                            antok[iant]=False
+                            casalog.post('  Ant='+str(iant)+' has insuffiencient parang cov: '+
+                                         str(round(dparang*180/pi,2))+' < '+str(minpacov)+'deg')
+                            continue
+
+
+
                         # indep var matrix
                         A=mypl.ones((nrows,3))
                         A[:,1]=mypl.cos(2*parang)
                         A[:,2]=mypl.sin(2*parang)
                         A[flags,:]=0.0  # zero flagged rows
                     
                         # squared gain amplitude ratio
                         amps=mypl.absolute(gains)
                         amps[amps==0.0]=1.0
                         gratio2=mypl.square(amps[0,0,:]/amps[1,0,:])
                         gratio2[flags]=0.0  # zero flagged samples
                 
-                        fit=mypl.lstsq(A,gratio2)
+                        fit=mypl.lstsq(A,gratio2,rcond=None)
 
-                        r[iant]=fit[0][0]
-                        q[iant]=fit[0][1]/r[iant]/2.0
-                        u[iant]=fit[0][2]/r[iant]/2.0
-                        r[iant]=sqrt(r[iant])
+                        r2=fit[0][0]
+                        if r2<0.0:
+                            casalog.post('  Ant='+str(iant)+' yielded an unphysical solution; skipping.')
+                            continue
+
+                        # Reaching here, we have a nominally good solution
+                        antok[iant]=True;
+
+                        q[iant]=fit[0][1]/r2/2.0
+                        u[iant]=fit[0][2]/r2/2.0
                         p=sqrt(q[iant]**2+u[iant]**2)
                         x=0.5*atan2(u[iant],q[iant])*180/pi
-                    
-                        antok[iant]=True;
 
-                        # casalog.post('Fld='+fldnames[ifld],'Spw='+str(ispw),'Ant='+str(iant), '(PA offset='+str(rang[iant,ispw]*180/pi+paoffset)+'deg)','Gx/Gy='+str(r[iant]),'q='+str(q[iant]),'u='+str(u[iant]),'p='+str(p),'x='+str(x))
-                        casalog.post('Fld='+fldnames[ifld]+' Spw='+str(ispw)+' Ant='+str(iant)+' (PA offset='+str(rang[iant,ispw]*180/pi+paoffset)+'deg)'+' q='+str(q[iant])+' u='+str(u[iant])+' p='+str(p)+' x='+str(x)+' Gx/Gy='+str(sqrt(r[iant])))
+                        casalog.post('  Ant='+str(iant)+
+                                     ' (PA offset='+str(round(rang[iant,ispw]*180/pi+paoffset,2))+'deg)'+
+                                     ' q='+str(round(q[iant],4))+' u='+str(round(u[iant],4))+' p='+str(round(p,4))+' x='+str(round(x,3))+
+                                     ' Gx/Gy='+str(round(sqrt(r2),4))+
+                                     ' (parang cov='+str(round(dparang*180/pi,1))+'deg; nsamp='+str(nsamp))
 
                         if rempol:
                             if p<1.0:
                                 Qpsi=q[iant]*mypl.cos(2*parang) + u[iant]*mypl.sin(2*parang)
                                 gains[0,0,:]/=mypl.sqrt(1.0+Qpsi)
                                 gains[1,0,:]/=mypl.sqrt(1.0-Qpsi)
                                 st.putcol('CPARAM',gains)
                             else:
                                 st.close()
                                 raise RuntimeError('Spurious fractional polarization!')
-
                     st.close()
 
                 nantok=mypl.sum(antok)
-                if nantok>0:
+                if nantok==0:
+                    casalog.post('Found no good polarization solutions for Fld='+fldnames[ifld]+' Spw='+str(ispw),'WARN')
+                    mask[ispw,ifld]=False
+                else:
                     Q[ispw,ifld]=mypl.sum(q)/nantok
                     U[ispw,ifld]=mypl.sum(u)/nantok
                     R[ispw,ifld]=mypl.sum(r)/nantok
                     mask[ispw,ifld]=True
                 
                     P=sqrt(Q[ispw,ifld]**2+U[ispw,ifld]**2)
                     X=0.5*atan2(U[ispw,ifld],Q[ispw,ifld])*180/pi
 
-                #casalog.post... 'Fld='+fldnames[ifld],'Spw='+str(ispw),'Ant=*', '(PA offset='+str(rang[iant,ispw]*180/pi+paoffset)+'deg)','Gx/Gy='+str(R[ispw,ifld]),'Q='+str(Q[ispw,ifld]),'U='+str(U[ispw,ifld]),'P='+str(P),'X='+str(X)
-
-                    casalog.post('Fld='+fldnames[ifld]+' Spw='+str(ispw)+' Ant=*'+' (PA offset='+str(rang[iant,ispw]*180/pi+paoffset)+'deg)'+' Q='+str(Q[ispw,ifld])+' U='+str(U[ispw,ifld])+' P='+str(P)+' X='+str(X))
+                    casalog.post('  Ant=<*>  '+
+                                 ' Q='+str(round(Q[ispw,ifld],4))+
+                                 ' U='+str(round(U[ispw,ifld],4))+
+                                 ' P='+str(round(P,4))+' X='+str(round(X,3)))
 
                     IQUV[fldnames[ifld]]['Spw'+str(ispw)]=[1.0,Q[ispw,ifld],U[ispw,ifld],0.0]
 
-                else:
-                    mask[ispw,ifld]=False
+                    # if required, remove ant-averaged polarization from non-ok antennas (if any)
+                    if rempol and nantok<nant:
+                        badantlist=[i for i in range(nant) if not antok[i]]
+                        casalog.post('  (Correcting undersampled antennas ('+str(badantlist)+
+                                     ') with <*> solution.)')                                    
+                        for iant in badantlist:
+                            if iant in parangbyant.keys():
+                                qstring='FIELD_ID=='+str(ifld)+' && SPECTRAL_WINDOW_ID=='+str(ispw)+' && ANTENNA1=='+str(iant)
+                                st=mytb.query(query=qstring)
+                                if st.nrows()>0 and P<1.0:
+                                    gains=st.getcol('CPARAM')
+                                    parang=parangbyant[iant]
+                                    Qpsi=Q[ispw,ifld]*mypl.cos(2*parang) + U[ispw,ifld]*mypl.sin(2*parang)
+                                    gains[0,0,:]/=mypl.sqrt(1.0+Qpsi)
+                                    gains[1,0,:]/=mypl.sqrt(1.0-Qpsi)
+                                    st.putcol('CPARAM',gains)
+                                st.close()
+
 
             if sum(mask[:,ifld])>0:
                 casalog.post('For field='+fldnames[ifld]+' there are '+str(sum(mask[:,ifld]))+' good spws.')
                 Qm=mypl.mean(Q[mask[:,ifld],ifld])
                 Um=mypl.mean(U[mask[:,ifld],ifld])
                 IQUV[fldnames[ifld]]['SpwAve']=[1.0,Qm,Um,0.0]
                 Qe=mypl.std(Q[mask[:,ifld],ifld])
                 Ue=mypl.std(U[mask[:,ifld],ifld])
                 Pm=sqrt(Qm**2+Um**2)
                 Xm=0.5*atan2(Um,Qm)*180/pi
-                casalog.post('Spw mean: Fld='+fldnames[ifld]+' Q='+str(Qm)+' U='+str(Um)+' P='+str(Pm)+' X='+str(Xm))
-                
+                casalog.post('Spw mean: Fld='+fldnames[ifld]+' Q='+str(round(Qm,4))+' U='+str(round(Um,4))+' P='+str(round(Pm,4))+' X='+str(round(Xm,3)))
+            else:
+                casalog.post('Found no good polarization solutions for Fld='+fldnames[ifld]+' in any spw.','WARN')
+
         mytb.close()
-        mymd.close()
 
         casalog.post("NB: Returning dictionary containing fractional Stokes results.")
         return IQUV
 
     finally:
-        mytb.close()
         mymd.close()
+        myme.done()
+
```

## casatasks/private/task_setjy.py

```diff
@@ -14,42 +14,26 @@
 # findCalModels.
 # Inside findCalModels there is a new section at the top to use
 # ctsys.resolve to make the initial attempt to find the models.
 # If that fails or is unavailable it falls back to the CASA5 code.
 
 # get is_python3 and is_CASA6
 from casatasks.private.casa_transition import *
-if is_CASA6:
-    from .setjy_helper import * 
-    from .parallel.parallel_data_helper import ParallelDataHelper
-    from .parallel.parallel_task_helper import ParallelTaskHelper
-    from .mstools import write_history
-    from casatools import ctsys, ms, imager, calibrater
-    from casatasks import casalog
-
-    # used in one type comparison
-    strType = str
-
-    # default roots argument for findCalModels
-    defaultRoots = ['.']
-else:
-    from setjy_helper import * 
-    from taskinit import *
-    from taskinit import mstool as ms
-    from taskinit import imtool as imager
-    from taskinit import cbtool as calibrater
-    from mstools import write_history
-    from parallel.parallel_data_helper import ParallelDataHelper
-    from parallel.parallel_task_helper import ParallelTaskHelper
+from .setjy_helper import * 
+from .parallel.parallel_data_helper import ParallelDataHelper
+from .parallel.parallel_task_helper import ParallelTaskHelper
+from .mstools import write_history
+from casatools import ctsys, ms, imager, calibrater
+from casatasks import casalog
 
-    # used in one type comparison
-    strType = string
+# used in one type comparison
+strType = str
 
-    # default roots argument for findCalModels
-    defaultRoots = ['.', casa['dirs']['data']]
+# default roots argument for findCalModels
+defaultRoots = ['.']
 
 # Helper class for Multi-MS processing (by SC)
 class SetjyHelper():
     def __init__(self, msfile=None):
         self.__msfile = msfile
         
     def resetModelCol(self):
@@ -198,15 +182,17 @@
         
         # Actual operation, when either the MODEL_DATA column or visibility model header are set
         else:
             if not os.path.isdir(vis):
               #casalog.post(vis + " must be a valid MS unless listmodels is True.",
               #             "SEVERE")
                 raise Exception("%s is not a valid MS" % vis) 
-
+            if 'Butler-JPL-Horizons' in standard and not usescratch:
+                raise RuntimeError(f"usescratch={usescratch} and standard={standard}. "
+                  +"Virtual model can not be used for an ephemeris object calibrator. Use usescratch=True.") 
             myms = ms()
             myim = imager()
             if ismms==None: ismms=False
             if type(vis) == str and os.path.isdir(vis):
                 n_selected_rows = nselrows(vis, field, spw, observation, timerange, scan, intent, usescratch, ismms)
                 # jagonzal: When  usescratch=True, creating the MODEL column only on a sub-set of
                 # Sub-MSs causes problems because ms::open requires all the tables in ConCatTable
```

## casatasks/private/task_slsearch.py

```diff
@@ -16,15 +16,15 @@
 # License for more details.
 #
 # You should have received a copy of the GNU Library General Public License
 # along with this library; if not, write to the Free Software Foundation,
 # Inc., 675 Massachusetts Ave, Cambridge, MA 02139, USA.
 #
 # Correspondence concerning AIPS++ should be adressed as follows:
-#        Internet email: aips2-request@nrao.edu.
+#        Internet email: casa-feedback@nrao.edu.
 #        Postal address: AIPS++ Project Office
 #                        National Radio Astronomy Observatory
 #                        520 Edgemont Road
 #                        Charlottesville, VA 22903-2475 USA
 #
 # <author>
 # Dave Mehringer
```

## casatasks/private/task_specfit.py

```diff
@@ -16,15 +16,15 @@
 # License for more details.
 #
 # You should have received a copy of the GNU Library General Public License
 # along with this library; if not, write to the Free Software Foundation,
 # Inc., 675 Massachusetts Ave, Cambridge, MA 02139, USA.
 #
 # Correspondence concerning AIPS++ should be adressed as follows:
-#        Internet email: aips2-request@nrao.edu.
+#        Internet email: casa-feedback@nrao.edu.
 #        Postal address: AIPS++ Project Office
 #                        National Radio Astronomy Observatory
 #                        520 Edgemont Road
 #                        Charlottesville, VA 22903-2475 USA
 #
 # <author>
 # Dave Mehringer
```

## casatasks/private/task_specflux.py

```diff
@@ -15,15 +15,15 @@
 # License for more details.
 #
 # You should have received a copy of the GNU Library General Public License
 # along with this library; if not, write to the Free Software Foundation,
 # Inc., 675 Massachusetts Ave, Cambridge, MA 02139, USA.
 #
 # Correspondence concerning AIPS++ should be adressed as follows:
-#        Internet email: aips2-request@nrao.edu.
+#        Internet email: casa-feedback@nrao.edu.
 #        Postal address: AIPS++ Project Office
 #                        National Radio Astronomy Observatory
 #                        520 Edgemont Road
 #                        Charlottesville, VA 22903-2475 USA
 #
 # <author>
 # Dave Mehringer
```

## casatasks/private/task_splattotable.py

```diff
@@ -15,15 +15,15 @@
 # License for more details.
 #
 # You should have received a copy of the GNU Library General Public License
 # along with this library; if not, write to the Free Software Foundation,
 # Inc., 675 Massachusetts Ave, Cambridge, MA 02139, USA.
 #
 # Correspondence concerning AIPS++ should be adressed as follows:
-#        Internet email: aips2-request@nrao.edu.
+#        Internet email: casa-feedback@nrao.edu.
 #        Postal address: AIPS++ Project Office
 #                        National Radio Astronomy Observatory
 #                        520 Edgemont Road
 #                        Charlottesville, VA 22903-2475 USA
 #
 # <author>
 # Dave Mehringer
```

## casatasks/private/task_spxfit.py

```diff
@@ -16,15 +16,15 @@
 # License for more details.
 #
 # You should have received a copy of the GNU Library General Public License
 # along with this library; if not, write to the Free Software Foundation,
 # Inc., 675 Massachusetts Ave, Cambridge, MA 02139, USA.
 #
 # Correspondence concerning AIPS++ should be adressed as follows:
-#        Internet email: aips2-request@nrao.edu.
+#        Internet email: casa-feedback@nrao.edu.
 #        Postal address: AIPS++ Project Office
 #                        National Radio Astronomy Observatory
 #                        520 Edgemont Road
 #                        Charlottesville, VA 22903-2475 USA
 #
 # <author>
 # Dave Mehringer
```

## casatasks/private/task_tclean.py

```diff
@@ -9,182 +9,168 @@
 
 import os
 import shutil
 import numpy
 import copy
 import filecmp
 import time
+import pdb
+
 # get is_CASA6 and is_python3
 from casatasks.private.casa_transition import *
+
+
 from casatasks import casalog
 
 from casatasks.private.imagerhelpers.imager_base import PySynthesisImager
 from casatasks.private.imagerhelpers.input_parameters import saveparams2last
 from casatasks.private.imagerhelpers.imager_parallel_continuum import PyParallelContSynthesisImager
 from casatasks.private.imagerhelpers.imager_parallel_cube import PyParallelCubeSynthesisImager
+from casatasks.private.imagerhelpers.imager_mtmfs_via_cube import PyMtmfsViaCubeSynthesisImager
 from casatasks.private.imagerhelpers.input_parameters import ImagerParameters
-from casatasks.private.imagerhelpers.imager_return_dict import ReturnDictionary
+from casatasks.private.imagerhelpers.imager_return_dict import ImagingDict
 from .cleanhelper import write_tclean_history, get_func_params
 from casatools import table
 from casatools import image
 from casatools import synthesisutils
 from casatools import synthesisimager
 
+
 try:
-    if is_CASA6:
-        from casampi.MPIEnvironment import MPIEnvironment
-        from casampi import MPIInterface
-    else:
-        from mpi4casa.MPIEnvironment import MPIEnvironment
-        from mpi4casa import MPIInterface
+    from casampi.MPIEnvironment import MPIEnvironment
+    from casampi import MPIInterface
+
     mpi_available = True
 except ImportError:
     mpi_available = False
 
+# if you want to save tclean.last.* from python call of tclean uncomment the decorator
+#@saveparams2last(multibackup=True)
 
-#if you want to save tclean.last.* from python call of tclean uncomment the decorator   
-#@saveparams2last(multibackup=True) 
 def tclean(
     ####### Data Selection
-    vis,#='', 
+    vis,  # ='',
     selectdata,
-    field,#='', 
-    spw,#='',
-    timerange,#='',
-    uvrange,#='',
-    antenna,#='',
-    scan,#='',
-    observation,#='',
-    intent,#='',
-    datacolumn,#='corrected',
-
+    field,  # ='',
+    spw,  # ='',
+    timerange,  # ='',
+    uvrange,  # ='',
+    antenna,  # ='',
+    scan,  # ='',
+    observation,  # ='',
+    intent,  # ='',
+    datacolumn,  # ='corrected',
     ####### Image definition
-    imagename,#='',
-    imsize,#=[100,100],
-    cell,#=['1.0arcsec','1.0arcsec'],
-    phasecenter,#='J2000 19:59:28.500 +40.44.01.50',
-    stokes,#='I',
-    projection,#='SIN',
-    startmodel,#='',
-
+    imagename,  # ='',
+    imsize,  # =[100,100],
+    cell,  # =['1.0arcsec','1.0arcsec'],
+    phasecenter,  # ='J2000 19:59:28.500 +40.44.01.50',
+    stokes,  # ='I',
+    projection,  # ='SIN',
+    startmodel,  # ='',
     ## Spectral parameters
-    specmode,#='mfs',
-    reffreq,#='',
-    nchan,#=1,
-    start,#='',
-    width,#='',
-    outframe,#='LSRK',
-    veltype,#='',
-    restfreq,#=[''],
-#    sysvel,#='',
-#    sysvelframe,#='',
-    interpolation,#='',
-    perchanweightdensity, #=''
-    ## 
+    specmode,  # ='mfs',
+    reffreq,  # ='',
+    nchan,  # =1,
+    start,  # ='',
+    width,  # ='',
+    outframe,  # ='LSRK',
+    veltype,  # ='',
+    restfreq,  # =[''],
+    #    sysvel,#='',
+    #    sysvelframe,#='',
+    interpolation,  # ='',
+    perchanweightdensity,  # =''
+    ##
     ####### Gridding parameters
-    gridder,#='ft',
-    facets,#=1,
-    psfphasecenter,#='',
-
-    wprojplanes,#=1,
-
+    gridder,  # ='ft',
+    facets,  # =1,
+    psfphasecenter,  # ='',
+    wprojplanes,  # =1,
     ### PB
     vptable,
-    mosweight, #=True
-    aterm,#=True,
-    psterm,#=True,
-    wbawp ,#= True,
-    conjbeams ,#= True,
-    cfcache ,#= "",
-    usepointing, #=false
-    computepastep ,#=360.0,
-    rotatepastep ,#=360.0,
-    pointingoffsetsigdev ,#=[10.0],
-
-    pblimit,#=0.01,
-    normtype,#='flatnoise',
-
+    mosweight,  # =True
+    aterm,  # =True,
+    psterm,  # =True,
+    wbawp,  # = True,
+    conjbeams,  # = True,
+    cfcache,  # = "",
+    usepointing,  # =false
+    computepastep,  # =360.0,
+    rotatepastep,  # =360.0,
+    pointingoffsetsigdev,  # =[10.0],
+    pblimit,  # =0.01,
+    normtype,  # ='flatnoise',
     ####### Deconvolution parameters
-    deconvolver,#='hogbom',
-    scales,#=[],
-    nterms,#=1,
-    smallscalebias,#=0.0
-    fusedthreshold,#=0.0
-    largestscale,#=-1
-
+    deconvolver,  # ='hogbom',
+    scales,  # =[],
+    nterms,  # =1,
+    smallscalebias,  # =0.0
+    fusedthreshold,  # =0.0
+    largestscale,  # =-1
     ### restoration options
     restoration,
-    restoringbeam,#=[],
+    restoringbeam,  # =[],
     pbcor,
-
     ##### Outliers
-    outlierfile,#='',
-
+    outlierfile,  # ='',
     ##### Weighting
-    weighting,#='natural',
-    robust,#=0.5,
-    noise,#0.0Jy
-    npixels,#=0,
-#    uvtaper,#=False,
-    uvtaper,#=[],
-
-
+    weighting,  # ='natural',
+    robust,  # =0.5,
+    noise,  # 0.0Jy
+    npixels,  # =0,
+    #    uvtaper,#=False,
+    uvtaper,  # =[],
     ##### Iteration control
     niter,#=0, 
     gain,#=0.1,
     threshold,#=0.0, 
     nsigma,#=0.0
     cycleniter,#=0, 
     cyclefactor,#=1.0,
     minpsffraction,#=0.1,
     maxpsffraction,#=0.8,
     interactive,#=False, 
     nmajor,#=-1,
     fullsummary,#=False,
 
     ##### (new) Mask parameters
-    usemask,#='user',
-    mask,#='',
-    pbmask,#='',
+    usemask,  # ='user',
+    mask,  # ='',
+    pbmask,  # ='',
     # maskthreshold,#='',
     # maskresolution,#='',
     # nmask,#=0,
-
     ##### automask by multithresh
-    sidelobethreshold,#=5.0,
-    noisethreshold,#=3.0,
-    lownoisethreshold,#=3.0,
-    negativethreshold,#=0.0,
-    smoothfactor,#=1.0,
-    minbeamfrac,#=0.3, 
-    cutthreshold,#=0.01,
-    growiterations,#=100
-    dogrowprune,#=True
-    minpercentchange,#=0.0
-    verbose, #=False
-    fastnoise, #=False
-
+    sidelobethreshold,  # =5.0,
+    noisethreshold,  # =3.0,
+    lownoisethreshold,  # =3.0,
+    negativethreshold,  # =0.0,
+    smoothfactor,  # =1.0,
+    minbeamfrac,  # =0.3,
+    cutthreshold,  # =0.01,
+    growiterations,  # =100
+    dogrowprune,  # =True
+    minpercentchange,  # =0.0
+    verbose,  # =False
+    fastnoise,  # =False
     ## Misc
-
-    restart,#=True,
-
-    savemodel,#="none",
-
-#    makeimages,#="auto"
-    calcres,#=True,
-    calcpsf,#=True,
-    psfcutoff,#=0.35
-
+    restart,  # =True,
+    savemodel,  # ="none",
+    #    makeimages,#="auto"
+    calcres,  # =True,
+    calcpsf,  # =True,
+    psfcutoff,  # =0.35
     ####### State parameters
-    parallel):#=False):
+    parallel,
+):  # =False):
 
     #####################################################
     #### Sanity checks and controls
     #####################################################
-    
     ### Move these checks elsewhere ? 
     inpparams=locals().copy()
 #    saveinputs(inpparams)
     ###now deal with parameters which are not the same name 
     inpparams['msname']= inpparams.pop('vis')
     inpparams['timestr']= inpparams.pop('timerange')
     inpparams['uvdist']= inpparams.pop('uvrange')
@@ -199,326 +185,490 @@
     if specmode=='cont':
         specmode='mfs'
         inpparams['specmode']='mfs'
 #    if specmode=='mfs' and nterms==1 and deconvolver == "mtmfs":
 #        casalog.post( "The MTMFS deconvolution algorithm (deconvolver='mtmfs') needs nterms>1.Please set nterms=2 (or more). ", "WARN", "task_tclean" )
 #        return
 
-    if(deconvolver=="mtmfs" and (specmode=='cube' or specmode=='cubedata')):
-        casalog.post( "The MSMFS algorithm (deconvolver='mtmfs') with specmode='cube' is not supported", "WARN", "task_tclean" )
-        return
-
+    # Force chanchunks=1 always now (CAS-13400)
+    inpparams["chanchunks"] = 1
 
-    if((specmode=='cube' or specmode=='cubedata') and (parallel==False and mpi_available and   MPIEnvironment.is_mpi_enabled) ):
-        casalog.post( "Setting parameter parallel=False with specmode='cube' when launching CASA with mpi has no effect", "WARN", "task_tclean" )
-        
-      
-    if(perchanweightdensity==False and weighting=='briggsbwtaper'):
-        casalog.post( "The briggsbwtaper weighting scheme is not compatable with perchanweightdensity=False.", "WARN", "task_tclean" )
+    if specmode == "cont":
+        specmode = "mfs"
+        inpparams["specmode"] = "mfs"
+    #    if specmode=='mfs' and nterms==1 and deconvolver == "mtmfs":
+    #        casalog.post( "The MTMFS deconvolution algorithm (deconvolver='mtmfs') needs nterms>1.Please set nterms=2 (or more). ", "WARN", "task_tclean" )
+    #        return
+
+    if deconvolver == "mtmfs" and (specmode == "cube" or specmode == "cubedata"):
+        casalog.post(
+            "The MSMFS algorithm (deconvolver='mtmfs') with specmode='cube' is not supported",
+            "WARN",
+            "task_tclean",
+        )
         return
+
+    if (
+        (specmode == "cube" or specmode == "cubedata" or specmode == "cubesource")
+    ) and (parallel == False and mpi_available and MPIEnvironment.is_mpi_enabled):
+        casalog.post(
+            "When CASA is launched with mpi, the parallel=False option has no effect for 'cube' imaging for gridder='mosaic','wproject','standard' and major cycles are always executed in parallel.\n",
+            "WARN",
+            "task_tclean",
+        )
+        # casalog.post( "Setting parameter parallel=False with specmode='cube' when launching CASA with mpi has no effect except for awproject.", "WARN", "task_tclean" )
+
+
+    ## Part of CAS-13814, checking for the only options compatible with mtmfs_via_cube.  
+    if specmode=="mvc": 
+        if deconvolver != 'mtmfs' or nterms<=1 :           
+            casalog.post("The specmode='mvc' option requires the deconvolver to be 'mtmfs' and 'nterms>1.",
+                         "WARN",
+                         "task_tclean")
+            return
+
+    ## Part of CAS-13814, moving warnings about pbcor and widebandpbcor from the C++ code to here, for better access to user-settings.
+    if specmode=='mfs' and deconvolver=='mtmfs' and gridder in ['standard','mosaic'] and pbcor==True:
+        casalog.post("For specmode='mfs' and deconvolver='mtmfs', the option of pbcor=True divides each restored Taylor coefficient image by the pb.tt0 image. This correction ignores the frequency-dependence of the primary beam and does not correct for PB spectral index. It is scientifically valid only for small fractional bandwidths. For more accurate wideband primary beam correction (if needed), please use one of the following options : (1) specmode='mvc' with gridder='standard' or 'mosaic' with pbcor=True,  (2) conjbeams=True and wbawp=True with gridder='awproject' and pbcor=True.",
+                     "WARN",
+                     "task_tclean")
+    if perchanweightdensity == False and weighting == "briggsbwtaper":
+        casalog.post(
+            "The briggsbwtaper weighting scheme is not compatable with perchanweightdensity=False.",
+            "WARN",
+            "task_tclean",
+        )
         
-    if((specmode=='mfs' or specmode=='cont') and weighting=='briggsbwtaper'):
-        casalog.post( "The briggsbwtaper weighting scheme is not compatable with specmode='mfs' or 'cont'.", "WARN", "task_tclean" )
+    if (specmode == "mfs" or specmode == "cont") and weighting == "briggsbwtaper":
+        casalog.post(
+            "The briggsbwtaper weighting scheme is not compatable with specmode='mfs' or 'cont'.",
+            "WARN",
+            "task_tclean",
+        )
         return
-        
-    if(npixels != 0 and weighting=='briggsbwtaper'):
-        casalog.post( "The briggsbwtaper weighting scheme is not compatable with npixels != 0.", "WARN", "task_tclean" )
+
+    if npixels != 0 and weighting == "briggsbwtaper":
+        casalog.post(
+            "The briggsbwtaper weighting scheme is not compatable with npixels != 0.",
+            "WARN",
+            "task_tclean",
+        )
         return
 
+    if facets > 1 and parallel == True:
+        casalog.post(
+            "Facetted imaging currently works only in serial. Please choose pure W-projection instead.",
+            "WARN",
+            "task_tclean",
+        )
+
+    if nmajor < -1:
+        casalog.post(
+            "Negative values less than -1 for nmajor are reserved for possible future implementation",
+            "WARN",
+            "task_tclean",
+        )
+        return
 
-    if(facets>1 and parallel==True):
-        casalog.post("Facetted imaging currently works only in serial. Please choose pure W-projection instead.","WARN","task_tclean")
+    ## CAS-13814
+    if (specmode == "mvc" and gridder == 'awproject' and (conjbeams==True or wbawp==False) ):
+        casalog.post(
+            "specmode='mvc' requires frequency-dependent primary beams to be used during cube gridding. Please set conjbeams=False and wbawp=True for the awproject gridder.",
+            "WARN",
+            "task_tclean",
+        )
+        return
 
-    if (nmajor < -1):
-        casalog.post("Negative values less than -1 for nmajor are reserved for possible future implementation", "WARN", "task_tclean")
+        #CAS-13814
+    if (specmode == "mvc" and gridder == 'mosaic' and conjbeams==True):
+        casalog.post(
+            "specmode='mvc' requires frequency-dependent primary beams to be used during cube gridding. Please set conjbeams=False with the mosaic gridder.",
+            "WARN",
+            "task_tclean",
+        )
         return
 
+    
     #####################################################
     #### Construct ImagerParameters object
     #####################################################
 
     imager = None
     paramList = None
 
     # Put all parameters into dictionaries and check them.
     ##make a dictionary of parameters that ImagerParameters take
 
-    if is_python3:
-        defparm=dict(list(zip(ImagerParameters.__init__.__code__.co_varnames[1:], ImagerParameters.__init__.__defaults__)))
-    else:
-        defparm=dict(zip(ImagerParameters.__init__.__func__.__code__.co_varnames[1:], ImagerParameters.__init__.func_defaults))
-        
+    defparm = dict(
+        list(
+            zip(
+                ImagerParameters.__init__.__code__.co_varnames[1:],
+                ImagerParameters.__init__.__defaults__,
+            )
+        )
+    )
     ###assign values to the ones passed to tclean and if not defined yet in tclean...
     ###assign them the default value of the constructor
-    bparm={k:  inpparams[k] if k in inpparams else defparm[k]  for k in defparm.keys()}
+    bparm = {k: inpparams[k] if k in inpparams else defparm[k] for k in defparm.keys()}
 
     ###default mosweight=True is tripping other gridders as they are not
     ###expecting it to be true
-    if(bparm['mosweight']==True and bparm['gridder'].find("mosaic") == -1):
-        bparm['mosweight']=False
+    if bparm["mosweight"] == True and bparm["gridder"].find("mosaic") == -1:
+        bparm["mosweight"] = False
 
-    if specmode=='mfs':
-        bparm['perchanweightdensity'] = False
-    
-    # deprecation message
-    if usemask=='auto-thresh' or usemask=='auto-thresh2':
-        casalog.post(usemask+" is deprecated, will be removed in CASA 5.4.  It is recommended to use auto-multithresh instead", "WARN") 
-
-    #paramList.printParameters()
-    
-    if len(pointingoffsetsigdev)>0 and pointingoffsetsigdev[0]!=0.0 and usepointing==True and gridder.count('awproj')>1:
-        casalog.post("pointingoffsetsigdev will be used for pointing corrections with AWProjection", "WARN") 
-#    elif usepointing==True and pointingoffsetsigdev[0] == 0:
-#        casalog.post("pointingoffsetsigdev is set to zero which is an unphysical value, will proceed with the native sky pixel resolution instead". "WARN")
+    if specmode == "mfs":
+        bparm["perchanweightdensity"] = False
 
+    # deprecation message
+    if usemask == "auto-thresh" or usemask == "auto-thresh2":
+        casalog.post(
+            usemask
+            + " is deprecated, will be removed in CASA 5.4.  It is recommended to use auto-multithresh instead",
+            "WARN",
+        )
+
+    # paramList.printParameters()
+
+    if (
+        len(pointingoffsetsigdev) > 0
+        and pointingoffsetsigdev[0] != 0.0
+        and usepointing == True
+        and gridder.count("awproj") > 1
+    ):
+        casalog.post(
+            "pointingoffsetsigdev will be used for pointing corrections with AWProjection",
+            "WARN",
+        )
+    #    elif usepointing==True and pointingoffsetsigdev[0] == 0:
+    #        casalog.post("pointingoffsetsigdev is set to zero which is an unphysical value, will proceed with the native sky pixel resolution instead". "WARN")
 
     ##pcube may still need to be set to True for some combination of ftmachine etc...
-    #=========================================================
-    concattype=''
-    pcube=False
-    if parallel==True and specmode!='mfs':
-        if specmode!='mfs':
-            pcube=False
-            parallel=False
+    # =========================================================
+    concattype = ""
+    pcube = False
+    if parallel == True and specmode != "mfs":
+        if specmode != "mfs":
+            pcube = False
+            parallel = False
         else:
-            pcube=True
-    #=========================================================
+            pcube = True
+    # =========================================================
     ####set the children to load c++ libraries and applicator
     ### make workers ready for c++ based mpicommands
-    cppparallel=False
-    if mpi_available and MPIEnvironment.is_mpi_enabled and specmode!='mfs' and not pcube:
-        mint=MPIInterface.MPIInterface()
-        cl=mint.getCluster()
-        if(is_CASA6):
-            cl._cluster.pgc("from casatools import synthesisimager", False)
-            cl._cluster.pgc("si=synthesisimager()", False)
-        else:
-            cl._cluster.pgc("from casac import casac", False)
-            cl._cluster.pgc("si=casac.synthesisimager()", False) 
+    cppparallel = False
+    if (
+        mpi_available
+        and MPIEnvironment.is_mpi_enabled
+        and specmode != "mfs"
+        and not pcube
+    ):
+        mint = MPIInterface.MPIInterface()
+        cl = mint.getCluster()
+        cl._cluster.pgc("from casatools import synthesisimager", False)
+        cl._cluster.pgc("si=synthesisimager()", False)
         cl._cluster.pgc("si.initmpi()", False)
-        cppparallel=True
+        cppparallel = True
         ###ignore chanchunk
-        bparm['chanchunks']=1
+        bparm["chanchunks"] = 1
 
     # catch non operational case (parallel cube tclean with interative=T)
     if pcube and interactive:
-        casalog.post( "Interactive mode is not currently supported with parallel apwproject cube CLEANing, please restart by setting interactive=F", "WARN", "task_tclean" )
+        casalog.post(
+            "Interactive mode is not currently supported with parallel apwproject cube CLEANing, please restart by setting interactive=F",
+            "WARN",
+            "task_tclean",
+        )
         return False
+
     #casalog.post('parameters {}'.format(bparm))    
     paramList=ImagerParameters(**bparm)
 
     ## Setup Imager objects, for different parallelization schemes.
-    imagerInst=PySynthesisImager
-    if parallel==False and pcube==False:
-         imager = PySynthesisImager(params=paramList)
-         imagerInst=PySynthesisImager
-    elif parallel==True:
-         imager = PyParallelContSynthesisImager(params=paramList)
-         imagerInst=PySynthesisImager
-    elif pcube==True:
-         imager = PyParallelCubeSynthesisImager(params=paramList)
-         imagerInst=PyParallelCubeSynthesisImager
-         # virtualconcat type - changed from virtualmove to virtualcopy 2016-07-20
-         #using ia.imageconcat now the name changed to copyvirtual 2019-08-12
-         concattype='copyvirtual'
+    imagerInst = PySynthesisImager
+    if specmode == "mvc":
+        imager = PyMtmfsViaCubeSynthesisImager(params=paramList)
+        imagerInst = PyMtmfsViaCubeSynthesisImager
+    elif parallel == False and pcube == False:
+        imager = PySynthesisImager(params=paramList)
+        imagerInst = PySynthesisImager
+    elif parallel == True:
+        imager = PyParallelContSynthesisImager(params=paramList)
+        imagerInst = PySynthesisImager
+    elif pcube == True:
+        imager = PyParallelCubeSynthesisImager(params=paramList)
+        imagerInst = PyParallelCubeSynthesisImager
+        # virtualconcat type - changed from virtualmove to virtualcopy 2016-07-20
+        # using ia.imageconcat now the name changed to copyvirtual 2019-08-12
+        concattype = "copyvirtual"
     else:
-         casalog.post('Invalid parallel combination in doClean.', 'ERROR')
-         return
-    
-    retrec={}
+        casalog.post("Invalid parallel combination in doClean.", "ERROR")
+        return
 
-    try: 
-    #if (1):
-        #pdb.set_trace()
+    retrec = {}
+
+    try:
+        # if (1):
+        # pdb.set_trace()
         ## Init major cycle elements
-        t0=time.time();
+        t0 = time.time()
         imager.initializeImagers()
-    
+
         # Construct the CFCache for AWProject-class of FTMs.  For
         # other choices the following three calls become NoOps.
         # imager.dryGridding();
         # imager.fillCFCache();
         # imager.reloadCFCache();
 
         imager.initializeNormalizers()
         imager.setWeighting()
-        t1=time.time();
-        casalog.post("***Time for initializing imager and normalizers: "+"%.2f"%(t1-t0)+" sec", "INFO3", "task_tclean");
+        t1 = time.time()
+        casalog.post(
+            "***Time for initializing imager and normalizers: "
+            + "%.2f" % (t1 - t0)
+            + " sec",
+            "INFO3",
+            "task_tclean",
+        )
 
         ## Init minor cycle elements
-        if niter>0 or restoration==True:
-            t0=time.time();
+        if niter > 0 or restoration == True:
+            t0 = time.time()
             imager.initializeDeconvolvers()
-            t1=time.time();
-            casalog.post("***Time for initializing deconvolver(s): "+"%.2f"%(t1-t0)+" sec", "INFO3", "task_tclean");
+            t1 = time.time()
+            casalog.post(
+                "***Time for initializing deconvolver(s): "
+                + "%.2f" % (t1 - t0)
+                + " sec",
+                "INFO3",
+                "task_tclean",
+            )
 
         ####now is the time to check estimated memory
         imager.estimatememory()
-            
-        if niter>0:
-            t0=time.time();
+
+        if niter > 0:
+            t0 = time.time()
             imager.initializeIterationControl()
-            t1=time.time();
-            casalog.post("***Time for initializing iteration controller: "+"%.2f"%(t1-t0)+" sec", "INFO3", "task_tclean");
-        
+            t1 = time.time()
+            casalog.post(
+                "***Time for initializing iteration controller: "
+                + "%.2f" % (t1 - t0)
+                + " sec",
+                "INFO3",
+                "task_tclean",
+            )
+
         ## Make PSF
-        if calcpsf==True:
-            t0=time.time();
-             
+        if calcpsf == True:
+            t0 = time.time()
+
             imager.makePSF()
-            if((psfphasecenter != '') and ('mosaic' in gridder)):
+            if (psfphasecenter != "") and ("mosaic" in gridder):
                 ###for some reason imager keeps the psf open delete it and recreate it afterwards
                 imager.deleteTools()
-                mytb=table()
-                psfname=bparm['imagename']+'.psf.tt0' if(os.path.exists( bparm['imagename']+'.psf.tt0')) else bparm['imagename']+'.psf'
+                mytb = table()
+                psfname = (
+                    bparm["imagename"] + ".psf.tt0"
+                    if (os.path.exists(bparm["imagename"] + ".psf.tt0"))
+                    else bparm["imagename"] + ".psf"
+                )
                 mytb.open(psfname)
-                miscinf=mytb.getkeyword('miscinfo')
-                iminf=mytb.getkeyword('imageinfo')
-                #casalog.post ('miscinfo {} {}'.format(miscinf, iminf))
+                miscinf = mytb.getkeyword("miscinfo")
+                iminf = mytb.getkeyword("imageinfo")
+                # casalog.post ('miscinfo {} {}'.format(miscinf, iminf))
                 mytb.done()
                 casalog.post("doing with different phasecenter psf")
                 imager.unlockimages(0)
-                psfParameters=paramList.getAllPars()
-                psfParameters['phasecenter']=psfphasecenter
-                psfParamList=ImagerParameters(**psfParameters)
-                psfimager=imagerInst(params=psfParamList)
+                psfParameters = paramList.getAllPars()
+                psfParameters["phasecenter"] = psfphasecenter
+                psfParamList = ImagerParameters(**psfParameters)
+                psfimager = imagerInst(params=psfParamList)
                 psfimager.initializeImagers()
                 psfimager.setWeighting()
-                psfimager.makeImage('psf', psfParameters['imagename']+'.psf')
+                psfimager.makeImage("psf", psfParameters["imagename"] + ".psf")
                 psfimager.deleteTools()
                 mytb.open(psfname, nomodify=False)
-                mytb.putkeyword('imageinfo',iminf)
-                mytb.putkeyword('miscinfo',miscinf)
+                mytb.putkeyword("imageinfo", iminf)
+                mytb.putkeyword("miscinfo", miscinf)
                 mytb.done()
                 mysu=synthesisutils()
                 mysu.fitPsfBeam(imagename=bparm['imagename'],
                                 nterms=(bparm['nterms']  if deconvolver=="mtmfs" else 1),
                                 psfcutoff=bparm['psfcutoff'])
                 imager = PySynthesisImager(params=paramList)
                 imager.initializeImagers()
                 imager.initializeNormalizers()
                 imager.setWeighting()
                 ###redo these as we destroyed things for lock issues
                 ## Init minor cycle elements
-                if niter>0 or restoration==True:
-                    imager.initializeDeconvolvers() 
-                if niter>0:
+                if niter > 0 or restoration == True:
+                    imager.initializeDeconvolvers()
+                if niter > 0:
                     imager.initializeIterationControl()
 
-            t1=time.time();
-            if(specmode != 'mfs' and ('stand' in gridder)):
-                casalog.post("***Time for making PSF and PB: "+"%.2f"%(t1-t0)+" sec", "INFO3", "task_tclean");
+            t1 = time.time()
+            if specmode != "mfs" and ("stand" in gridder):
+                casalog.post(
+                    "***Time for making PSF and PB: " + "%.2f" % (t1 - t0) + " sec",
+                    "INFO3",
+                    "task_tclean",
+                )
             else:
-                casalog.post("***Time for making PSF: "+"%.2f"%(t1-t0)+" sec", "INFO3", "task_tclean");
-            
+                casalog.post(
+                    "***Time for making PSF: " + "%.2f" % (t1 - t0) + " sec",
+                    "INFO3",
+                    "task_tclean",
+                )
+
             imager.makePB()
 
-            t2=time.time();
-            if(specmode=='mfs' and ('stand' in gridder)):
-                casalog.post("***Time for making PB: "+"%.2f"%(t2-t1)+" sec", "INFO3", "task_tclean");
+            t2 = time.time()
+            if specmode == "mfs" and ("stand" in gridder):
+                casalog.post(
+                    "***Time for making PB: " + "%.2f" % (t2 - t1) + " sec",
+                    "INFO3",
+                    "task_tclean",
+                )
 
-        if gridder in ['mosaic','awproject']:
+        if gridder in ["mosaic", "awproject"]:
             imager.checkPB()
 
-        if niter >=0 : 
+        if niter >= 0:
 
             ## Make dirty image
-            if calcres==True:
-                t0=time.time();
+            if calcres == True:
+                t0 = time.time()
                 imager.runMajorCycle(isCleanCycle=False)
-                t1=time.time();
-                casalog.post("***Time for major cycle (calcres=T): "+"%.2f"%(t1-t0)+" sec", "INFO3", "task_tclean"); 
+                t1 = time.time()
+                casalog.post(
+                    "***Time for major cycle (calcres=T): "
+                    + "%.2f" % (t1 - t0)
+                    + " sec",
+                    "INFO3",
+                    "task_tclean",
+                )
 
             ## In case of no deconvolution iterations....
-            if niter==0 and calcres==False:
+            if niter == 0 and calcres == False:
                 if savemodel != "none":
                     imager.predictModel()
 
             # CAS-13960 : Construct return dict for niter=0 case
             # If residual image does not exist, summaryminor will not be
             # populated.
             if niter==0:
-                rd = ReturnDictionary()
-                retrec = rd.constructResidualDict(paramList)
+                id = ImagingDict()
+                retrec = id.construct_residual_dict(paramList)
 
             ## Do deconvolution and iterations
             if niter>0 :
                 t0=time.time();
                 isit = imager.hasConverged()
                 imager.updateMask()
-                #if((type(usemask)==str) and ('auto' in usemask)):  
+                # if((type(usemask)==str) and ('auto' in usemask)):
                 #    isit = imager.hasConverged()
                 isit = imager.hasConverged()
-               
-                t1=time.time();
-                casalog.post("***Time to update mask: "+"%.2f"%(t1-t0)+" sec", "INFO3", "task_tclean");
-                while ( not isit ):
-                    t0=time.time();
+
+                t1 = time.time()
+                casalog.post(
+                    "***Time to update mask: " + "%.2f" % (t1 - t0) + " sec",
+                    "INFO3",
+                    "task_tclean",
+                )
+                while not isit:
+                    t0 = time.time()
                     ### sometimes after automasking it does not do anything
-                    doneMinor=imager.runMinorCycle()
-                    t1=time.time();
-                    casalog.post("***Time for minor cycle: "+"%.2f"%(t1-t0)+" sec", "INFO3", "task_tclean");
+                    doneMinor = imager.runMinorCycle()
+                    t1 = time.time()
+                    casalog.post(
+                        "***Time for minor cycle: " + "%.2f" % (t1 - t0) + " sec",
+                        "INFO3",
+                        "task_tclean",
+                    )
 
-                    t0=time.time();
-                    if(doneMinor):
+                    t0 = time.time()
+                    if doneMinor:
                         imager.runMajorCycle()
-                    t1=time.time();
-                    casalog.post("***Time for major cycle: "+"%.2f"%(t1-t0)+" sec", "INFO3", "task_tclean");
-                   
+                    t1 = time.time()
+                    casalog.post(
+                        "***Time for major cycle: " + "%.2f" % (t1 - t0) + " sec",
+                        "INFO3",
+                        "task_tclean",
+                    )
+
                     imager.updateMask()
-                    t2=time.time()
-                    casalog.post("***Time to update mask: "+"%.2f"%(t2-t1)+" sec", "INFO3", "task_tclean");
+                    t2 = time.time()
+                    casalog.post(
+                        "***Time to update mask: " + "%.2f" % (t2 - t1) + " sec",
+                        "INFO3",
+                        "task_tclean",
+                    )
                     isit = imager.hasConverged() or (not doneMinor)
-                    
+
                 ## Get summary from iterbot
                 #if type(interactive) != bool:
                 retrec=imager.getSummary(fullsummary);
                 
                 if savemodel!='none' and (interactive==True or usemask=='auto-multithresh' or nsigma>0.0):
                     paramList.resetParameters()
-                    if parallel and specmode=='mfs':
+                    if parallel and specmode == "mfs":
                         # For parallel mfs, also needs to reset the parameters for each node
                         imager.resetSaveModelParams(paramList)
                     imager.initializeImagers()
                     imager.predictModel()
 
             ## Restore images.
-            if restoration==True:  
-                t0=time.time();
+            if restoration == True:
+                t0 = time.time()
                 imager.restoreImages()
-                t1=time.time();
-                casalog.post("***Time for restoring images: "+"%.2f"%(t1-t0)+" sec", "INFO3", "task_tclean");
-                if pbcor==True:
-                    t0=time.time();
+                t1 = time.time()
+                casalog.post(
+                    "***Time for restoring images: " + "%.2f" % (t1 - t0) + " sec",
+                    "INFO3",
+                    "task_tclean",
+                )
+                if pbcor == True:
+                    t0 = time.time()
                     imager.pbcorImages()
-                    t1=time.time();
-                    casalog.post("***Time for pb-correcting images: "+"%.2f"%(t1-t0)+" sec", "INFO3", "task_tclean");
-        ######### niter >=0  end if 
+                    t1 = time.time()
+                    casalog.post(
+                        "***Time for pb-correcting images: "
+                        + "%.2f" % (t1 - t0)
+                        + " sec",
+                        "INFO3",
+                        "task_tclean",
+                    )
+        ######### niter >=0  end if
 
     finally:
         ##close tools
         # needs to deletools before concat or lock waits for ever
         if imager != None:
-             imager.deleteTools()
-        if(cppparallel):
+            imager.deleteTools()
+        if cppparallel:
             ###release workers back to python mpi control
-            si=synthesisimager()
+            si = synthesisimager()
             si.releasempi()
-        if (pcube):
+        if pcube:
             casalog.post("running concatImages ...")
-            casalog.post("Running virtualconcat (type=%s) of sub-cubes" % concattype,"INFO2", "task_tclean")
+            casalog.post(
+                "Running virtualconcat (type=%s) of sub-cubes" % concattype,
+                "INFO2",
+                "task_tclean",
+            )
             imager.concatImages(type=concattype)
-        # CAS-10721 
-        #if niter>0 and savemodel != "none":
+        # CAS-10721
+        # if niter>0 and savemodel != "none":
         #    casalog.post("Please check the casa log file for a message confirming that the model was saved after the last major cycle. If it doesn't exist, please re-run tclean with niter=0,calcres=False,calcpsf=False in order to trigger a 'predict model' step that obeys the savemodel parameter.","WARN","task_tclean")
 
     # Write history at the end, when hopefully all .workdirectory, .work.temp, etc. are gone
     # from disk, so they won't be picked up. They need time to disappear on NFS or slow hw.
     try:
         params = get_func_params(tclean, locals())
-        write_tclean_history(imagename, 'tclean', params, casalog)
+        write_tclean_history(imagename, "tclean", params, casalog)
     except Exception as exc:
-        casalog.post("Error updating history (logtable): {} ".format(exc),'WARN')
+        casalog.post("Error updating history (logtable): {} ".format(exc), "WARN")
 
     return retrec
 
+
 ##################################################
```

## casatasks/private/task_tsdimaging.py

```diff
@@ -5,14 +5,16 @@
 import os
 import re
 import shutil
 import time
 
 import numpy
 
+from functools import partial
+
 from casatasks import casalog
 from casatools import image, imager
 from casatools import ms as mstool
 from casatools import quanta
 
 from . import mslisthelper, sdbeamutil, sdutil
 # (1) Import the python application layer
@@ -300,14 +302,21 @@
             if col not in ignore_columns:
                 report_conformance(mslist, col, process_set)
                 fix_dict[op][col] = process_set
     fix_conformance(fix_dict)
 
 
 def sort_vis(vislist, spw, mode, width, field, antenna, scan, intent, timerange):
+    """Sort the given MeasurementSet path(s) by their earliest data-taking time, in increasing order.
+
+    Return a 7-tuple where
+        * the first entry holds the re-ordered paths
+        * the remaining entries hold their corresponding data selection parameters
+        * FIXME: input parameters mode and width are not used
+    """
     if isinstance(vislist, str) or len(vislist) == 1:
         return vislist, field, spw, antenna, scan, intent, timerange
     # chronological sort
     sorted_vislist, sorted_timelist = mslisthelper.sort_mslist(vislist)
     _vislist = list(vislist)
     sorted_idx = [_vislist.index(vis) for vis in sorted_vislist]
     mslisthelper.report_sort_result(sorted_vislist, sorted_timelist, sorted_idx, mycasalog=casalog)
@@ -399,15 +408,16 @@
 
     Calculate the primary beam size of antenna, using dish diamenter
     and rest frequency
     Average antenna diamter and reference frequency are adopted for
     calculation.
     The input argument should be a list of antenna IDs.
     """
-    casalog.post("Calculating Pirimary beam size:")
+    logger = sdutil.Casalog(origin="_calc_PB")
+    logger.post("Calculating Primary beam size:")
     # CAS-5410 Use private tools inside task scripts
     my_qa = quanta()
 
     pb_factor = 1.175
     # Reference frequency
     ref_freq = restfreq
     if type(ref_freq) in [float, numpy.float64]:
@@ -424,17 +434,17 @@
     # antdiam_ave = self._get_average_antenna_diameter(antenna)
     # Calculate PB
     wave_length = 0.2997924 / my_qa.convert(my_qa.quantity(ref_freq), 'GHz')['value']
     D_m = my_qa.convert(antdiam_ave, 'm')['value']
     lambda_D = wave_length / D_m * 3600. * 180 / numpy.pi
     PB = my_qa.quantity(pb_factor * lambda_D, 'arcsec')
     # Summary
-    casalog.post("- Antenna diameter: %s m" % D_m)
-    casalog.post("- Reference Frequency: %s" % ref_freq)
-    casalog.post("PB size = %5.3f * lambda/D = %s" % (pb_factor, my_qa.tos(PB)))
+    logger.post(f"- Antenna diameter: {D_m} m")
+    logger.post(f"- Reference Frequency: {ref_freq}")
+    logger.post(f"PB size = {pb_factor:5.3f} * lambda/D = {my_qa.tos(PB)}")
     return PB
 
 
 def _get_imsize(width, height, dx, dy):
     casalog.post("Calculating pixel size.")
     # CAS-5410 Use private tools inside task scripts
     my_qa = quanta()
@@ -519,22 +529,24 @@
         ret_dict['height'] = my_qa.quantity(0.0, 'rad')
     return ret_dict
 
 
 def _handle_image_params(imsize, cell, phasecenter,
                          vislist, field, spw, antenna, scan, intent, timerange,
                          restfreq, pointingcolumntouse, ephemsrcname):
+    logger = sdutil.Casalog(origin="_handle_image_params")
     # round-up imsize
     _imsize = sdutil.to_list(imsize, int) or sdutil.to_list(imsize, numpy.integer)
     if _imsize is None:
         _imsize = imsize if hasattr(imsize, '__iter__') else [imsize]
         _imsize = [int(numpy.ceil(v)) for v in _imsize]
-        casalog.post(
-            "imsize is not integers. force converting to integer pixel numbers.", priority="WARN")
-        casalog.post("rounded-up imsize: %s --> %s" % (str(imsize), str(_imsize)))
+        logger.post(
+            "imsize is not integers. force converting to integer pixel numbers.",
+            priority="WARN")
+        logger.post("rounded-up imsize: %s --> %s" % (str(imsize), str(_imsize)))
 
     # calculate cell based on PB if it is not given
     _cell = cell
     if _cell == '' or _cell[0] == '':
         # calc PB
         if isinstance(vislist, str):
             vis = vislist
@@ -552,64 +564,52 @@
             else:
                 baseline = antsel + '&&&'
             with open_ms(vis) as ms:
                 ms.msselect({'baseline': baseline})
                 ndx = ms.msselectedindices()
             antenna_id = ndx['antenna1'][0]
         grid_factor = 3.
-        casalog.post("The cell size will be calculated using PB size of antennas in the first MS")
+        logger.post("The cell size will be calculated using PB size of antennas in the first MS")
         qpb = _calc_PB(vis, antenna_id, restfreq)
         _cell = '%f%s' % (qpb['value'] / grid_factor, qpb['unit'])
-        casalog.post("Using cell size = PB/%4.2F = %s" % (grid_factor, _cell))
+        logger.post("Using cell size = PB/%4.2F = %s" % (grid_factor, _cell))
 
     # Calculate Pointing center and extent (if necessary)
     _phasecenter = phasecenter
     if _phasecenter == '' or len(_imsize) == 0 or _imsize[0] < 1:
         # return a dictionary with keys 'center', 'width', 'height'
         map_param = _get_pointing_extent(_phasecenter, vislist, field, spw, antenna, scan, intent,
                                          timerange, pointingcolumntouse, ephemsrcname)
         # imsize
         (cellx, celly) = sdutil.get_cellx_celly(_cell, unit='arcmin')
         if len(_imsize) == 0 or _imsize[0] < 1:
             _imsize = _get_imsize(map_param['width'], map_param['height'], cellx, celly)
             if _phasecenter != "":
-                casalog.post(
+                logger.post(
                     "You defined phasecenter but not imsize. "
                     "The image will cover as wide area as pointing in MS extends, "
                     "but be centered at phasecenter. "
                     "This could result in a strange image if your phasecenter is "
                     "apart from the center of pointings",
                     priority='WARN')
             if _imsize[0] > 1024 or _imsize[1] > 1024:
-                casalog.post(
+                logger.post(
                     "The calculated image pixel number is larger than 1024. "
                     "It could take time to generate the image depending on your computer resource. "
                     "Please wait...",
                     priority='WARN')
 
         # phasecenter
         # if empty, it should be determined here...
         if _phasecenter == "":
             _phasecenter = map_param['center']
 
     return _imsize, _cell, _phasecenter
 
 
-def _calc_pblimit(minweight):
-    if minweight == 0.0:
-        # set tiny value
-        pblimit = 1e-16
-    else:
-        pblimit = minweight
-
-    # disable pixel mask by pblimit
-    pblimit = 1e-16
-    return pblimit
-
-
 def _get_param(ms_index, param):
     if isinstance(param, str):
         return param
     elif hasattr(param, '__iter__'):
         if len(param) == 1:
             return param[0]
         else:
@@ -731,14 +731,15 @@
 def set_beam_size(vis, imagename,
                   field, spw, baseline, scan, intent, timerange,
                   ephemsrcname, pointingcolumntouse, antenna_name, antenna_diameter,
                   restfreq, gridfunction, convsupport, truncate, gwidth, jwidth):
     """Set estimated beam size to the image."""
     is_alma = antenna_name[0:2] in ['PM', 'DV', 'DA', 'CM']
     blockage = '0.75m' if is_alma else '0.0m'
+    log_origin = 'set_beam_size'
 
     with open_ia(imagename) as ia:
         csys = ia.coordsys()
         outref = csys.referencecode('direction')[0]
         cell = list(csys.increment(type='direction', format='s')['string'])
         csys.done()
 
@@ -746,41 +747,48 @@
     sampling_params = old_tool.get_pointing_sampling_params(vis, field, spw, baseline,
                                                             scan, intent, timerange,
                                                             outref=outref,
                                                             movingsource=ephemsrcname,
                                                             pointingcolumntouse=pointingcolumntouse,
                                                             antenna_name=antenna_name)
     qa = quanta()
-    casalog.post('sampling_params={0}'.format(sampling_params))
+    casalog.post(
+        f'sampling_params={sampling_params}',
+        origin=log_origin
+    )
     xsampling, ysampling = qa.getvalue(qa.convert(sampling_params['sampling'], 'arcsec'))
     angle = qa.getvalue(qa.convert(sampling_params['angle'], 'deg'))[0]
 
-    casalog.post('Detected raster sampling = [{x:f}, {y:f}] arcsec'.format(
-        x=xsampling,
-        y=ysampling
-    ))
+    casalog.post(
+        f'Detected raster sampling = [{xsampling:f}, {ysampling:f}] arcsec',
+        origin=log_origin
+    )
 
     # handling of failed sampling detection
     valid_sampling = True
     # TODO: copy from sdimaging implementation
     sampling = [xsampling, ysampling]
     if abs(xsampling) < 2.2e-3 or not numpy.isfinite(xsampling):
         casalog.post(
             f"Invalid sampling={xsampling} arcsec. "
             f"Using the value of orthogonal direction={ysampling} arcsec",
-            priority="WARN")
+            priority="WARN",
+            origin=log_origin
+        )
         sampling = [ysampling]
         angle = 0.0
         valid_sampling = False
     if abs(ysampling) < 1.0e-3 or not numpy.isfinite(ysampling):
         if valid_sampling:
             casalog.post(
                 f"Invalid sampling={ysampling} arcsec. "
                 f"Using the value of orthogonal direction={xsampling} arcsec",
-                priority="WARN")
+                priority="WARN",
+                origin=log_origin
+            )
             sampling = [xsampling]
             angle = 0.0
             valid_sampling = True
     # reduce sampling and cell if it's possible
     if len(sampling) > 1 and abs(sampling[0] - sampling[1]) <= 0.01 * abs(sampling[0]):
         sampling = [sampling[0]]
         angle = 0.0
@@ -792,57 +800,64 @@
         bu.set_antenna(antenna_diameter, blockage)
         bu.set_sampling(sampling, "%fdeg" % angle)
         bu.set_image_param(cell, restfreq, gridfunction,
                            convsupport, truncate, gwidth,
                            jwidth, is_alma)
         bu.summary()
         imbeam_dict = bu.get_beamsize_image()
-        casalog.post("Setting image beam: major={major}, minor={minor}, pa={pa}".format(
-            major=imbeam_dict['major'],
-            minor=imbeam_dict['minor'],
-            pa=imbeam_dict['pa']
-        ))
+        casalog.post(
+            f"Setting image beam: "
+            f"major={imbeam_dict['major']}, "
+            f"minor={imbeam_dict['minor']}, "
+            f"pa={imbeam_dict['pa']}",
+            origin=log_origin
+        )
         # set beam size to image
         with open_ia(imagename) as ia:
             ia.setrestoringbeam(**imbeam_dict)
     else:
         # BOTH sampling was invalid
         casalog.post(
-            "Could not detect valid raster sampling. Exitting without setting beam size to image",
-            priority='WARN')
+            "Could not detect valid raster sampling. "
+            "Exiting without setting beam size to image",
+            priority='WARN',
+            origin=log_origin
+        )
 
 
 def do_weight_mask(imagename, weightimage, minweight):
     # Mask image pixels whose weight are smaller than minweight.
     # Weight image should have 0 weight for pixels below < minweight
-    casalog.post("Start masking the map using minweight = %f" %
-                 minweight, "INFO")
+    logger = sdutil.Casalog(origin="do_weight_mask")
+    logger.post(f"Start masking the map using minweight = {minweight:f}",
+                 priority="INFO")
     with open_ia(weightimage) as ia:
         try:
             stat = ia.statistics(mask="'" + weightimage + "' > 0.0", robust=True)
             valid_pixels = stat['npts']
         except RuntimeError as e:
             if 'No valid data found.' in str(e):
                 valid_pixels = [0]
             else:
                 raise e
 
     if len(valid_pixels) == 0 or valid_pixels[0] == 0:
-        casalog.post(
+        logger.post(
             "All pixels weight zero. "
             "This indicates no data in MS is in image area. "
             "Mask will not be set. Please check your image parameters.",
             priority="WARN")
         return
     median_weight = stat['median'][0]
     weight_threshold = median_weight * minweight
-    casalog.post("Median of weight in the map is %f" % median_weight,
-                 "INFO")
-    casalog.post("Pixels in map with weight <= median(weight)*minweight = %f will be masked." %
-                 (weight_threshold), "INFO")
+    logger.post(f"Median of weight in the map is {median_weight:f}",
+                 priority="INFO")
+    logger.post(f"Pixels in map with weight <= median(weight)*minweight = "
+                 "{weight_threshold:f} will be masked.",
+                 priority="INFO")
     # Leaving the original logic to calculate the number of masked pixels via
     # product of median of and min_weight (which i don't understand the logic)
 
     # Modify default mask
     with open_ia(imagename) as ia:
         ia.calcmask("'%s'>%f" % (weightimage, weight_threshold), asdefault=True)
 
@@ -857,17 +872,18 @@
             if 'All selected pixels are masked' in str(e):
                 valid_pixels_after = 0
             else:
                 raise
 
     masked_fraction = 100. * (1. - valid_pixels_after / float(valid_pixels[0]))
 
-    msg = f"This amounts to {masked_fraction:5.1f} % of the area with nonzero weight."
-    casalog.post(msg, "INFO")
-    casalog.post(
+    logger.post(f"This amounts to {masked_fraction:5.1f} % "
+                  "of the area with nonzero weight.", 
+                  priority="INFO")
+    logger.post(
         f"The weight image '{weightimage}' is returned by this task, "
         "if the user wishes to assess the results in detail.",
         priority="INFO")
 
 
 def get_ms_column_unit(tb, colname):
     col_unit = ''
@@ -893,191 +909,209 @@
     else:
         image_unit = 'Jy/beam'
 
     return image_unit
 
 
 @sdutil.sdtask_decorator
-def tsdimaging(infiles, outfile, overwrite, field, spw, antenna, scan, intent, timerange, mode,
-               nchan, start, width, veltype,
-               specmode, outframe,
-               gridfunction, convsupport, truncate, gwidth, jwidth, imsize, cell, phasecenter,
-               projection, pointingcolumn, restfreq, stokes, minweight, brightnessunit, clipminmax):
+def tsdimaging(
+        # Input data: list of MeasurementSets
+        infiles,
+        # Output data: CASA images: their path prefix, overwrite control
+        outfile, overwrite,
+        # Select data from input MeasurementSets, by
+        field, spw, antenna, scan, intent, timerange,
+        # Output images definition: frequency axis
+        outframe, # velocity frame
+        mode, nchan, start, width, veltype, # gridding type
+        specmode, # Doppler handling
+        # Output images definition: spatial axes
+        pointingcolumn, convertfirst,
+        projection,
+        imsize, cell, phasecenter,
+        # Output images definition: stokes axis
+        stokes,
+        # Gridder parameters
+        gridfunction, convsupport, truncate, gwidth, jwidth,
+        clipminmax,
+        # Single-dish image: mask control
+        minweight,
+        # Single-dish image: metadata
+        brightnessunit,
+        restfreq # rest frequency to assign to image
+    ):
 
     origin = 'tsdimaging'
     imager = None
 
-    try:
-        # tweak input parameters
-        # ---- if spw starts with ':', add '*' at the beginning
+    try: # Create the Single-Dish Image
+        # Validate brightnessunit parameter CAS-11503
+        image_unit = brightnessunit.lower().capitalize()
+        if not image_unit in ['', 'K', 'Jy/beam']:
+            raise ValueError(f"Invalid brightness unit: {brightnessunit}")
+
+        # Handle outfile and overwrite parameters
+        output_path_prefix = outfile.rstrip('/')
+        singledish_image_path = output_path_prefix + image_suffix
+        if os.path.exists(singledish_image_path):
+            if overwrite == False:
+                raise RuntimeError(
+                        f"Output file exists: '{singledish_image_path}'"
+                      )
+            else:
+                # delete existing images
+                if os.path.exists(singledish_image_path):
+                    casalog.post(f"Removing '{singledish_image_path}'")
+                    _remove_image(singledish_image_path)
+                assert not os.path.exists(singledish_image_path)
+                for _suffix in associate_suffixes:
+                    path_to_remove = output_path_prefix + _suffix
+                    if os.path.exists(path_to_remove):
+                        casalog.post(f"Removing '{path_to_remove}'")
+                        _remove_image(path_to_remove)
+                    assert not os.path.exists(path_to_remove)
+
+        # Tweak spw parameter into _spw
         if isinstance(spw, str):
             _spw = '*' + spw if spw.startswith(':') else spw
         else:
             _spw = ['*' + v if v.startswith(':') else v for v in spw]
 
-        # ---- if antenna doesn't contain '&&&', append it
+        # Handle image spectral axis parameters
+        imnchan, imstart, imwidth = _configure_spectral_axis(
+            mode, nchan, start, width, restfreq
+        )
+
+        # Handle image restfreq parameter's default value
+        _restfreq = _get_restfreq_if_empty(
+            infiles, _spw, field, restfreq
+        )
+
+        # Handle gridder parameters
+        # convert type of task's default values
+        # to ones supported by the Synthesis Imager framework
+        gtruncate = _handle_grid_defaults(truncate)
+        ggwidth = _handle_grid_defaults(gwidth)
+        gjwidth = _handle_grid_defaults(jwidth)
+
+        # handle infiles parameter
+        # sort input data to get results consistent with old sdimaging task
+        _sorted = sort_vis(
+            infiles, _spw, mode, imwidth, field,
+            antenna, scan, intent, timerange
+        )
+        sorted_vis = _sorted[0]
+        sorted_field = _sorted[1]
+        sorted_spw = _sorted[2]
+        sorted_antenna = _sorted[3]
+        sorted_scan = _sorted[4]
+        sorted_intent = _sorted[5]
+        sorted_timerange = _sorted[6]
+
         def antenna_to_baseline(s):
             if len(s) == 0:
                 return s
             elif len(s) > 3 and s.endswith('&&&'):
                 return s
             else:
                 return '{0}&&&'.format(s)
-        if isinstance(antenna, str):
-            baseline = antenna_to_baseline(antenna)
-        else:
-            baseline = [antenna_to_baseline(a) for a in antenna]
 
-        # handle overwrite parameter
-        _outfile = outfile.rstrip('/')
-        presumed_imagename = _outfile + image_suffix
-        if os.path.exists(presumed_imagename):
-            if overwrite == False:
-                raise RuntimeError('Output file \'{0}\' exists.'.format(presumed_imagename))
-            else:
-                # delete existing images
-                casalog.post('Removing \'{0}\''.format(presumed_imagename))
-                _remove_image(presumed_imagename)
-                assert not os.path.exists(presumed_imagename)
-                for _suffix in associate_suffixes:
-                    casalog.post('Removing \'{0}\''.format(_outfile + _suffix))
-                    _remove_image(_outfile + _suffix)
-                    assert not os.path.exists(_outfile + _suffix)
-
-        # handle image spectral axis parameters
-        imnchan, imstart, imwidth = _configure_spectral_axis(mode, nchan, start, width, restfreq)
-
-        # handle image restfreq parameter's default value
-        _restfreq = _get_restfreq_if_empty(infiles, _spw, field, restfreq)
-
-        # handle gridder parameters
-        # ---- translate some default values into the ones
-        #      that are consistent with the current framework
-        gtruncate = _handle_grid_defaults(truncate)
-        ggwidth = _handle_grid_defaults(gwidth)
-        gjwidth = _handle_grid_defaults(jwidth)
+        if isinstance(sorted_antenna, str):
+            sorted_baseline = antenna_to_baseline(sorted_antenna)
+        else:
+            sorted_baseline = [antenna_to_baseline(a) for a in sorted_antenna]
 
-        # handle image geometric parameters
+        # Handle image geometric parameters
         _ephemsrcname = ''
         ephem_sources = ['MERCURY', 'VENUS', 'MARS', 'JUPITER', 'SATURN',
                          'URANUS', 'NEPTUNE', 'PLUTO', 'SUN', 'MOON', 'TRACKFIELD']
         if isinstance(phasecenter, str) and phasecenter.strip().upper() in ephem_sources:
             _ephemsrcname = phasecenter
+        _imsize, _cell, _phasecenter = _handle_image_params(
+            imsize, cell, phasecenter, sorted_vis,
+            sorted_field, sorted_spw, sorted_antenna,
+            sorted_scan, sorted_intent, sorted_timerange,
+            _restfreq, pointingcolumn, _ephemsrcname
+        )
 
-        # handle image parameters
-        if isinstance(infiles, str) or len(infiles) == 1:
-            _imsize, _cell, _phasecenter = _handle_image_params(imsize, cell, phasecenter, infiles,
-                                                                field, _spw, antenna, scan, intent, timerange,
-                                                                _restfreq, pointingcolumn, _ephemsrcname)
-            sorted_vis = infiles
-        else:
-            # sort input data to get consistent result with older sdimaging
-            _sorted = sort_vis(infiles, _spw, mode, imwidth, field, antenna, scan, intent, timerange)
-            sorted_vis, sorted_field, sorted_spw, sorted_antenna, sorted_scan, sorted_intent, sorted_timerange = _sorted
-            _imsize, _cell, _phasecenter = _handle_image_params(imsize, cell, phasecenter, sorted_vis,
-                                                                sorted_field, sorted_spw, sorted_antenna,
-                                                                sorted_scan, sorted_intent, sorted_timerange,
-                                                                _restfreq, pointingcolumn, _ephemsrcname)
-
-        # calculate pblimit from minweight
-        pblimit = _calc_pblimit(minweight)
-
-        # (2) Set up Input Parameters
+        # Set up PySynthesisImager input parameters
         # - List all parameters that you need here
         # - Defaults will be assumed for unspecified parameters
         # - Nearly all parameters are identical to that in the task. Please look at the
         # list of parameters under __init__ using  " help ImagerParameters " )
         casalog.post('*** Creating paramList ***', origin=origin)
         paramList = ImagerParameters(
-            # input file name
-            msname=sorted_vis,
-            # data selection
-            field=field,
-            spw=_spw,
-            timestr=timerange,
-            antenna=baseline,
-            scan=scan,
-            state=intent,
-            # image parameters
-            imagename=_outfile,
-            nchan=imnchan,
-            start=imstart,
-            width=imwidth,
-            outframe=outframe,
-            veltype=veltype,
-            restfreq=_restfreq,
-            phasecenter=_phasecenter,
-            imsize=_imsize,
-            cell=_cell,
-            projection=projection,
-            stokes=stokes,
-            specmode=specmode,
-            gridder='singledish',
-            # single dish specific parameters
-            gridfunction=gridfunction,
-            convsupport=convsupport,
-            truncate=gtruncate,
-            gwidth=ggwidth,
-            jwidth=gjwidth,
-            pointingcolumntouse=pointingcolumn,
-            minweight=minweight,
-            clipminmax=clipminmax,
-            # normalizer
-            normtype='flatsky',
-            pblimit=pblimit
-        )
-
-        # handle brightnessunit (CAS-11503)
-        image_unit = ''
-        if len(brightnessunit) > 0:
-            if brightnessunit.lower() == 'k':
-                image_unit = 'K'
-            elif brightnessunit.lower() == 'jy/beam':
-                image_unit = 'Jy/beam'
-            else:
-                raise ValueError("Invalid brightness unit, %s" % brightnessunit)
-
-        # TODO: handle overwrite
-        # TODO: output image name
-
-        # (3) Construct the PySynthesisImager object, with all input parameters
+                # input file name
+                msname=sorted_vis,  # 'sdimaging.ms',
+                # data selection
+                field=sorted_field,  # '',
+                spw=sorted_spw,  # '0',
+                timestr=sorted_timerange,
+                antenna=sorted_baseline,
+                scan=sorted_scan,
+                state=sorted_intent,
+                # image parameters
+                imagename=output_path_prefix,  # 'try2',
+                nchan=imnchan,  # 1024,
+                start=imstart,  # '0',
+                width=imwidth,  # '1',
+                outframe=outframe,
+                veltype=veltype,
+                restfreq=_restfreq,
+                phasecenter=_phasecenter,  # 'J2000 17:18:29 +59.31.23',
+                imsize=_imsize,  # [75,75],
+                cell=_cell,  # ['3arcmin', '3arcmin'],
+                projection=projection,
+                stokes=stokes,
+                specmode=specmode,
+                gridder='singledish',
+                # single dish specific parameters
+                gridfunction=gridfunction,
+                convsupport=convsupport,
+                truncate=gtruncate,
+                gwidth=ggwidth,
+                jwidth=gjwidth,
+                pointingcolumntouse=pointingcolumn,
+                convertfirst=convertfirst,
+                minweight=minweight,
+                clipminmax=clipminmax,
+                # normalizer
+                normtype='flatsky',
+                pblimit=1e-16 # TODO: explain why 1e-16 ?
+            )
 
+        # Construct the PySynthesisImager object, with all input parameters
         casalog.post('*** Creating imager object ***', origin=origin)
         imager = PySynthesisImager(params=paramList)
 
-        # (4) Initialize various modules.
+        # Initialize PySynthesisImager "modules" required for single-dish imaging
         # - Pick only the modules you will need later on. For example, to only make
         # the PSF, there is no need for the deconvolver or iteration control modules.
-
-        # Initialize modules major cycle modules
-
         casalog.post('*** Initializing imagers ***', origin=origin)
+        # This is where the underlying C++ synthesis imager is created
         imager.initializeImagers()
         casalog.post('*** Initializing normalizers ***', origin=origin)
         imager.initializeNormalizers()
 
-        # (5) Make the initial images
-
-        casalog.post('*** makeSdImage... ***', origin=origin)
+        # Create Single-Dish images
+        casalog.post('*** Creating single-dish images ***', origin=origin)
         imager.makeSdImage()
+        casalog.post('*** Created single-dish images ***', origin=origin)
 
-    finally:
-        # (8) Close tools.
-
+    finally: # Close tools and rename Synthesis Imager's residual image
         casalog.post('*** Cleaning up tools ***', origin=origin)
         if imager is not None:
             imager.deleteTools()
+        # Change image suffix from .residual to .image
+        residual_image_path = output_path_prefix + residual_suffix
+        if os.path.exists(residual_image_path):
+            os.rename(residual_image_path, singledish_image_path)
 
-        # change image suffix from .residual to .image
-        if os.path.exists(outfile + residual_suffix):
-            os.rename(outfile + residual_suffix, outfile + image_suffix)
-
-    # set beam size
+    # Set single-dish image's beam size
     # TODO: re-define related functions in the new tool framework (sdms?)
-    imagename = outfile + image_suffix
     # ms_index = 0
     rep_ms = _get_param(0, infiles)
     rep_field = _get_param(0, field)
     rep_spw = _get_param(0, _spw)
     rep_antenna = _get_param(0, antenna)
     rep_scan = _get_param(0, scan)
     rep_intent = _get_param(0, intent)
@@ -1089,31 +1123,37 @@
     with open_ms(rep_ms) as ms:
         ms.msselect({'baseline': baseline})
         ndx = ms.msselectedindices()
         antenna_index = ndx['antenna1'][0]
     with sdutil.table_manager(os.path.join(rep_ms, 'ANTENNA')) as tb:
         antenna_name = tb.getcell('NAME', antenna_index)
         antenna_diameter = tb.getcell('DISH_DIAMETER', antenna_index)
-    set_beam_size(rep_ms, imagename,
-                  rep_field, rep_spw, baseline, rep_scan, rep_intent, rep_timerange,
-                  _ephemsrcname, pointingcolumn, antenna_name, antenna_diameter,
-                  _restfreq, gridfunction, convsupport, truncate, gwidth, jwidth)
+    casalog.post(f"Setting single-dish image's beam")
+    set_beam_size(
+        rep_ms, singledish_image_path,
+        rep_field, rep_spw, baseline, rep_scan, rep_intent, rep_timerange,
+        _ephemsrcname, pointingcolumn, antenna_name, antenna_diameter,
+        _restfreq, gridfunction, convsupport, truncate, gwidth, jwidth
+    )
 
-    # set brightness unit (CAS-11503)
+    # Set single-dish image's brightness unit (CAS-11503)
     if len(image_unit) == 0:
         image_unit = get_brightness_unit_from_ms(rep_ms)
     if len(image_unit) > 0:
-        with open_ia(imagename) as ia:
-            casalog.post("Setting brightness unit '%s' to image." % image_unit)
+        with open_ia(singledish_image_path) as ia:
+            casalog.post(f"Setting single-dish image's brightness unit to '{image_unit}'")
             ia.setbrightnessunit(image_unit)
 
-    # mask low weight pixels
-    weightimage = outfile + weight_suffix
-    do_weight_mask(imagename, weightimage, minweight)
-
+    # Update single-dish image's mask: mask low weight pixels
+    weight_image_path = output_path_prefix + weight_suffix
+    casalog.post(f"Creating weight image mask")
+    do_weight_mask(singledish_image_path, weight_image_path, minweight)
+
+    # Delete images systematically generated by the Synthesis Imager
+    # which are either not required or currently useless
+    # in the context of single-dish imaging
     # CAS-10891
-    _remove_image(outfile + '.sumwt')
-
+    _remove_image(output_path_prefix + '.sumwt')
     # CAS-10893
     # TODO: remove the following line once the 'correct' SD
     # PSF image based on primary beam can be generated
-    _remove_image(outfile + '.psf')
+    _remove_image(output_path_prefix + '.psf')
```

## casatasks/private/imagerhelpers/_gclean.py

```diff
@@ -1,11 +1,11 @@
 ########################################################################3
 #  _gclean.py
 #
-# Copyright (C) 2021,2022
+# Copyright (C) 2021,2022,2023
 # Associated Universities, Inc. Washington DC, USA.
 #
 # This script is free software; you can redistribute it and/or modify it
 # under the terms of the GNU Library General Public License as published by
 # the Free Software Foundation; either version 2 of the License, or (at your
 # option) any later version.
 #
@@ -15,28 +15,40 @@
 # License for more details.
 #
 # You should have received a copy of the GNU Library General Public License
 # along with this library; if not, write to the Free Software Foundation,
 # Inc., 675 Massachusetts Ave, Cambridge, MA 02139, USA.
 #
 # Correspondence concerning AIPS++ should be adressed as follows:
-#        Internet email: aips2-request@nrao.edu.
+#        Internet email: casa-feedback@nrao.edu.
 #        Postal address: AIPS++ Project Office
 #                        National Radio Astronomy Observatory
 #                        520 Edgemont Road
 #                        Charlottesville, VA 22903-2475 USA
 #
 import os
 import asyncio
 from functools import reduce
 import copy
-
+import numpy as np
+import shutil
+import time
+import subprocess
+
+from casatasks.private.imagerhelpers.imager_return_dict import ImagingDict
+from casatasks import deconvolve, tclean, imstat
+
+###
+### import check versions
+###
 _GCV001 = True
 _GCV002 = True
 _GCV003 = True
+_GCV004 = True
+
 
 # from casatasks.private.imagerhelpers._gclean import gclean
 class gclean:
     '''gclean(...) creates a stream of convergence records which indicate
     the convergence quaility of the tclean process. The initial record
     describes the initial dirty image.
     It is designed for use with the interactive clean GUI, but it could
@@ -61,113 +73,188 @@
     TODO: do we need to preserve any hidden state between tclean calls for the iterbotsink and/or synthesisimager tools?
     '''
 
     def _tclean( self, *args, **kwargs ):
         """ Calls tclean records the arguments in the local history of tclean calls.
 
         The full tclean history for this instance can be retrieved via the cmds() method."""
-        from casatasks import tclean
         arg_s = ', '.join( map( lambda a: self._history_filter(len(self._exe_cmds), None, repr(a)), args ) )
         kw_s = ', '.join( map( lambda kv: self._history_filter(len(self._exe_cmds), kv[0], "%s=%s" % (kv[0],repr(kv[1]))), kwargs.items()) )
         if len(arg_s) > 0 and len(kw_s) > 0:
             parameters = arg_s + ", " + kw_s
         else:
             parameters = arg_s + kw_s
         self._exe_cmds.append( "tclean( %s )" % parameters )
+        self._exe_cmds_per_iter[-1] += 1
         return tclean( *args, **kwargs )
 
     def _deconvolve( self, *args, **kwargs ):
         """ Calls deconvolve records the arguments in the local history of deconvolve calls.
 
         The full deconvolve history for this instance can be retrieved via the cmds() method."""
-        from casatasks import deconvolve
         arg_s = ', '.join( map( lambda a: self._history_filter(len(self._exe_cmds), None, repr(a)), args ) )
         kw_s = ', '.join( map( lambda kv: self._history_filter(len(self._exe_cmds), kv[0], "%s=%s" % (kv[0],repr(kv[1]))), kwargs.items()) )
         if len(arg_s) > 0 and len(kw_s) > 0:
             parameters = arg_s + ", " + kw_s
         else:
             parameters = arg_s + kw_s
         self._exe_cmds.append( "deconvolve( %s )" % parameters )
+        self._exe_cmds_per_iter[-1] += 1
         return deconvolve( *args, **kwargs )
 
-    def cmds( self ):
-        """ Returns the history of all tclean calls for this instance. """
-        return self._exe_cmds
+    def _remove_tree( self, directory ):
+        if os.path.isdir(directory):
+            shutil.rmtree(directory)
+            self._exe_cmds.append( f'''shutil.rmtree( {repr(directory)} )''' )
+            self._exe_cmds_per_iter[-1] += 1
+
+    def cmds( self, history=False ):
+        """ Returns the history of all tclean calls for this instance. If ``history``
+        is set to True then the full history will be returned, otherwise the commands
+        executed for generating the latest result are returned.
+        """
+
+        if history:
+            return self._exe_cmds
+        else:
+            if self._exe_cmds_per_iter[-1] > 0:
+                # Return the last N commands
+                return self._exe_cmds[-self._exe_cmds_per_iter[-1]:]
+            else:
+                # If convergence is hit, no commands were run so return nothing
+                return []
+
 
     def update( self, msg ):
         """ Interactive clean parameters update.
 
         Args:
-            msg: dict with possible keys 'niter', 'cycleniter', 'nmajor', 'threshold', 'cyclefactor' and 'mask'
+            msg: dict with possible keys 'niter', 'cycleniter', 'nmajor', 'threshold', 'cyclefactor'
+
+        Returns:
+            stopcode : Stop code in case of error (-1 on error, 0 if no error), int
+            stopdesc : Exception error message, str
         """
         if 'niter' in msg:
             try:
                 self._niter = int(msg['niter'])
-            except ValueError:
-                pass
+                if self._niter < -1:
+                    return -1, f"niter must be >= -1"
+            except ValueError as err:
+                return -1, "niter must be an integer"
+
         if 'cycleniter' in msg:
             try:
                 self._cycleniter = int(msg['cycleniter'])
+                if self._cycleniter < -1:
+                    return -1, f"cycleniter must be >= -1"
             except ValueError:
-                pass
+                return -1, "cycleniter must be an integer"
+
+        if 'nmajor' in msg:
+            try:
+                self._nmajor = int(msg['nmajor'])
+                if self._nmajor < -1:
+                    return -1, f"nmajor must be >= -1"
+            except ValueError as e:
+                return -1, "nmajor must be an integer"
+
         if 'threshold' in msg:
-            self._threshold = msg['threshold']
+            try:
+                self._threshold = float(msg['threshold'])
+                if self._threshold < 0:
+                    return -1, f"threshold must be >= 0"
+            except ValueError:
+                if isinstance(msg['threshold'], str) and "jy" in msg['threshold'].lower():
+                    self._threshold_to_float(msg['threshold']) # Convert str to float
+                else:
+                    return -1, f"threshold must be a number, or a number with units (Jy/mJy/uJy)"
+
         if 'cyclefactor' in msg:
             try:
-                self._cyclefactor = int(msg['cyclefactor'])
+                self._cyclefactor = float(msg['cyclefactor'])
+                if self._cyclefactor <= 0:
+                    return -1, f"cyclefactor must be > 0"
             except ValueError:
-                pass
-        if 'mask' in msg:
-            self._mask = msg['mask']
-
-    def __init__( self, vis, imagename, field='', spw='', timerange='', uvrange='', antenna='', scan='', observation='', intent='', datacolumn='corrected',
-                  imsize=[100], cell=[ ], phasecenter='', stokes='I', startmodel='', specmode='cube', reffreq='', nchan=-1, start='', width='', outframe='LSRK',
-                  restfreq='', interpolation='linear', perchanweightdensity=True, gridder='standard', wprojplanes=int(1), mosweight=True, psterm=False, wbawp=True,
-                  conjbeams=False, usepointing=False, pointingoffsetsigdev=[  ], pblimit=0.2, deconvolver='hogbom', niter=0, threshold='0.1Jy', nsigma=0.0,
-                  cycleniter=-1, nmajor=1, cyclefactor=1.0, scales=[], restoringbeam='', pbcor=False, nterms=int(2), weighting='natural', robust=float(0.5),
-                  npixels=0, gain=float(0.1), sidelobethreshold=3.0, noisethreshold=5.0, lownoisethreshold=1.5, negativethreshold=0.0, minbeamfrac=0.3,
-                  growiterations=75, dogrowprune=True, minpercentchange=-1.0, fastnoise=True, savemodel='none', usemask='user', mask='', parallel=False,
-                  history_filter=lambda index, arg, history_value: history_value ):
+                return -1, "cyclefactor must be a number"
+
+        return 0, ""
+
+
+
+    def _threshold_to_float(self, msg=None):
+        # Convert threshold from string to float if necessary
+        if msg is not None:
+            if isinstance(msg, str):
+                if "mJy" in msg:
+                    self._threshold = float(msg.replace("mJy", "")) / 1e3
+                elif "uJy" in msg:
+                    self._threshold = float(msg.replace("uJy", "")) / 1e6
+                elif "Jy" in msg:
+                    self._threshold = float(msg.replace("Jy", ""))
+        else:
+            if isinstance(self._threshold, str):
+                if "mJy" in self._threshold:
+                    self._threshold = float(self._threshold.replace("mJy", "")) / 1e3
+                elif "uJy" in self._threshold:
+                    self._threshold = float(self._threshold.replace("uJy", "")) / 1e6
+                elif "Jy" in self._threshold:
+                    self._threshold = float(self._threshold.replace("Jy", ""))
+
+
+    def __init__( self, vis, imagename, field='', spw='', timerange='', uvrange='', antenna='', scan='', observation='', intent='', datacolumn='corrected', imsize=[100], cell=[ ],
+                 phasecenter='', stokes='I', startmodel='', specmode='cube', reffreq='', nchan=-1, start='', width='', outframe='LSRK', veltype='radio', restfreq='', interpolation='linear',
+                 perchanweightdensity=True, gridder='standard', wprojplanes=int(1), mosweight=True, psterm=False, wbawp=True, conjbeams=False, usepointing=False, pointingoffsetsigdev=[  ],
+                 pblimit=0.2, deconvolver='hogbom', smallscalebias=0.0, niter=0, threshold='0.1Jy', nsigma=0.0, cycleniter=-1, nmajor=1, cyclefactor=1.0, minpsffraction=0.05,
+                 maxpsffraction=0.8, scales=[], restoringbeam='', pbcor=False, nterms=int(2), weighting='natural', robust=float(0.5), npixels=0, gain=float(0.1), pbmask=0.2, sidelobethreshold=3.0,
+                 noisethreshold=5.0, lownoisethreshold=1.5, negativethreshold=0.0, smoothfactor=float(1.0), minbeamfrac=0.3, cutthreshold=0.01, growiterations=75, dogrowprune=True,
+                 minpercentchange=-1.0, verbose=False, fastnoise=True, savemodel='none', usemask='user', mask='', parallel=False, history_filter=lambda index, arg, history_value: history_value ):
+
         self._vis = vis
         self._imagename = imagename
         self._imsize = imsize
         self._cell = cell
         self._phasecenter = phasecenter
         self._stokes = stokes
         self._startmodel = startmodel
         self._specmode = specmode
         self._reffreq = reffreq
         self._nchan = nchan
         self._start = start
         self._width = width
         self._outframe = outframe
-        self._interpolation = interpolation
+        self._veltype = veltype
         self._restfreq = restfreq
+        self._interpolation = interpolation
         self._perchanweightdensity = perchanweightdensity
         self._gridder = gridder
         self._wprojplanes = wprojplanes
         self._mosweight = mosweight
         self._psterm = psterm
         self._wbawp = wbawp
         self._conjbeams = conjbeams
         self._usepointing = usepointing
         self._pointingoffsetsigdev = pointingoffsetsigdev
         self._pblimit = pblimit
         self._deconvolver = deconvolver
+        self._smallscalebias = smallscalebias
         self._niter = niter
         self._threshold = threshold
         self._cycleniter = cycleniter
+        self._minpsffraction = minpsffraction
+        self._maxpsffraction = maxpsffraction
         self._nsigma = nsigma
         self._nmajor = nmajor
         self._cyclefactor = cyclefactor
         self._scales = scales
         self._restoringbeam = restoringbeam
         self._pbcor = pbcor
         self._nterms = nterms
         self._exe_cmds = [ ]
+        self._exe_cmds_per_iter = [ ]
         self._history_filter = history_filter
         self._finalized = False
         self._field = field
         self._spw = spw
         self._timerange = timerange
         self._uvrange = uvrange
         self._antenna = antenna
@@ -175,108 +262,180 @@
         self._observation = observation
         self._intent = intent
         self._datacolumn = datacolumn
         self._weighting = weighting
         self._robust = robust
         self._npixels = npixels
         self._gain = gain
+        self._pbmask = pbmask
         self._sidelobethreshold = sidelobethreshold
         self._noisethreshold = noisethreshold
         self._lownoisethreshold = lownoisethreshold
         self._negativethreshold = negativethreshold
+        self._smoothfactor = smoothfactor
         self._minbeamfrac = minbeamfrac
+        self._cutthreshold = cutthreshold
         self._growiterations = growiterations
         self._dogrowprune = dogrowprune
         self._minpercentchange = minpercentchange
+        self._verbose = verbose
         self._fastnoise = fastnoise
         self._savemodel = savemodel
         self._parallel = parallel
         self._usemask = usemask
         self._mask = mask
-
+        self.global_imdict = ImagingDict()
+        self.current_imdict = ImagingDict()
         self._major_done = 0
-        self._convergence_result = (None,None,None,{ 'chan': None, 'major': None })
+        self.hasit = False # Convergence flag
+        self.stopdescription = '' # Convergence flag
+        self._initial_mask_exists = False
+        self._convergence_result = (None,None,None,None,None,{ 'chan': None, 'major': None })
         #                           ^^^^ ^^^^ ^^^^ ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^----->>> convergence info
-        #                              |    | |
-        #                              |    | +---------------->>> major cycles done for current run
+        #                              |    | |     |    +----->>> Number of global iterations remaining for current run (niterleft)
+        #                              |    | |     +---------->>> Number of major cycles remaining for current run (nmajorleft)
+        #                              |    | +---------------->>> major cycles done for current run (nmajordone)
         #                              |    +------------------>>> tclean stopcode
-        #                              +----------------------->>> error message
-    @staticmethod
-    def __filter_convergence( raw ):
-        ###
-        ### this function filters out the pieces of the `raw` tclean 'summaryminor'
-        ### return dictionary that we care about
-        ###
-        ### the first index in the `raw` dictionary is the channel axis
-        ### each channel may have a number of polarity dictionaries
-        ###
-        keep_keys = [ 'modelFlux', 'iterDone', 'peakRes', 'stopCode', 'cycleThresh' ]
-        ret = {}
-        for channel_k,channel_v in raw[0].items( ): # 0: main field in multifield imaging TODO worry about other fields
-            ret[channel_k] = {}
-            for stokes_k,stokes_v in channel_v.items( ):
-                ret[channel_k][stokes_k] = {}
-                for summary_k in keep_keys:
-                    ret[channel_k][stokes_k][summary_k] = copy.deepcopy(stokes_v[summary_k])
-        return ret
+        #                              +----------------------->>> tclean stopdescription
+
+        # Convert threshold from string to float, interpreting units.
+        # XXX : We should ideally use quantities, but we are trying to
+        # stick to "public API" funtions inside _gclean
+        self._threshold_to_float()
+
 
     def __add_per_major_items( self, tclean_ret, major_ret, chan_ret ):
         '''Add meta-data about the whole major cycle, including 'cyclethreshold'
         '''
+
         if 'cyclethreshold' in tclean_ret:
-            return dict( major=dict( cyclethreshold=[tclean_ret['cyclethreshold']] if major_ret is None else (major_ret['cyclethreshold'] + [tclean_ret['cyclethreshold']]) ),
+
+            rdict = dict( major=dict( cyclethreshold=[tclean_ret['cyclethreshold']] if major_ret is None else (major_ret['cyclethreshold'] + [tclean_ret['cyclethreshold']]) ),
                          chan=chan_ret )
         else:
-            return dict( major=dict( cyclethreshold=major_ret['cyclethreshold'].append(tclean_ret['cyclethreshold']) ),
+            rdict = dict( major=dict( cyclethreshold=major_ret['cyclethreshold'].append(tclean_ret['cyclethreshold']) ),
                          chan=chan_ret )
 
-    @staticmethod
-    def __update_convergence( cumm_sm, new_sm ):
-        """Accumulates the per-channel/stokes subimage 'summaryminor' records from new_sm to cumm_sm.
-        param cumm_sm: cummulative summary minor records : { chan: { stoke: { key: [values] } } }
-        param new_sm: new summary minor records : { chan: { stoke: { key: [values] } } }
+        return rdict
+
 
-        For most "keys", the resultant "values" will be a list, one value per minor cycle.
+    def _calc_deconv_controls(self, imdict, niterleft=0, threshold=0, cycleniter=-1):
+        """
+        Calculate cycleniter and cyclethreshold for deconvolution.
+        """
+
+        use_cycleniter = niterleft  #niter - imdict.returndict['iterdone']
+
+        if cycleniter > -1 : # User is forcing this number
+            use_cycleniter = min(cycleniter, use_cycleniter)
+
+        psffrac = imdict.returndict['maxpsfsidelobe'] * self._cyclefactor
+        psffrac = max(psffrac, self._minpsffraction)
+        psffrac = min(psffrac, self._maxpsffraction)
+
+        # TODO : This assumes the default field (i.e., field=0);
+        # This won't work for multiple fields.
+        cyclethreshold = psffrac * imdict.get_peakres()
+        cyclethreshold = max(cyclethreshold, threshold)
+
+        return int(use_cycleniter), cyclethreshold
+
+
+    def __update_convergence(self):
+        """
+        Accumulates the per-channel/stokes summaryminor keys across all major cycle calls so far.
 
         The "iterDone" key will be replaced with "iterations", and for the "iterations" key,
         the value in the returned cummulative record will be a rolling sum of iterations done
         for tclean calls so far, one value per minor cycle.
         For example, if there have been two clean calls, and in the first call channel 0 had
         [1] iteration in 1 minor cycle, and for the second call channel 0 had [6, 10, 9, 1]
         iterations in 4 minor cycles), then the resultant "iterations" key for channel 0 would be:
         [1, 7, 17, 26, 27]
         """
 
-        ### substitute 'iterations' for 'iterDone'
-        replace_iters_key = lambda x: ('iterations' if x[0] == 'iterDone' else x[0], x[1])
-        new_sm = {
-            chan_k: {
-                stokes_k: {
-                    k: v for k,v in map( replace_iters_key, stokes_v.items( ) )
-                } for stokes_k,stokes_v in chan_v.items()
-            } for chan_k,chan_v in new_sm.items()
-        }
+        keys = ['modelFlux', 'iterDone', 'peakRes', 'stopCode', 'cycleThresh']
+
+        # Grab tuples of keys of interest
+        outrec = {}
+        for nn in range(self.global_imdict.nchan):
+            outrec[nn] = {}
+            for ss in range(self.global_imdict.nstokes):
+                outrec[nn][ss] = {}
+                for key in keys:
+                    # Replace iterDone with iterations
+                    if key == 'iterDone':
+                        # Maintain cumulative sum of iterations per entry
+                        outrec[nn][ss]['iterations'] = np.cumsum(self.global_imdict.get_key(key, stokes=ss, chan=nn))
+                        # Replace iterDone with iterations
+                        #outrec[nn][ss]['iterations'] =  self.global_imdict.get_key(key, stokes=ss, chan=nn)
+                    else:
+                        outrec[nn][ss][key] = self.global_imdict.get_key(key, stokes=ss, chan=nn)
+
+        return outrec
+
+
+    def _check_initial_mask(self):
+        """
+        Check if a mask from a previous run exists on disk or not.
+        """
+
+        if self._usemask == 'user' and self._mask == '':
+            maskname = self._imagename + '.mask'
+
+            if os.path.exists(maskname):
+                self._initial_mask_exists = True
+            else:
+                self._initial_mask_exists = False
 
-        if cumm_sm is None:
-            return new_sm
+    def _fix_initial_mask(self):
+        """
+        If on start up, no user mask is provided, then flip the initial mask to
+        be all zeros for interactive use.
+        """
+
+        from casatools import image
+        ia = image()
+
+        if self._usemask == 'user' and self._mask == '':
+            maskname = self._imagename + '.mask'
+
+            # This means the mask was newly created by deconvolve, so flip it
+            if os.path.exists(maskname) and self._initial_mask_exists is False:
+                ia.open(maskname)
+                ia.set(0.0)
+                ia.close()
+
+    def _update_peakres(self):
+        if self._deconvolver == 'mtmfs':
+            residname = self._imagename + '.residual.tt0'
         else:
-            def accumulate_tclean_records( cumm_subsm_rec, new_subsm_rec ):
-                """
-                param cumm_subsm_rec: cummulative subimage 'summaryminor' record : { "key": [minor cycle values,...] }
-                param new_subsm_rec: new subimage 'summaryminor' record : { "key": [minor cycle values,...] }
-                """
-                curr_iters_sum = max(cumm_subsm_rec['iterations']) if 'iterations' in cumm_subsm_rec else 0
-                if 'iterations' in new_subsm_rec:
-                    iterations_tuple = reduce(  lambda acc, v: (acc[0]+v, acc[1] + [acc[0]+v+curr_iters_sum]),  new_subsm_rec['iterations'],  (0,[])  )
-                    new_subsm_rec['iterations'] = iterations_tuple[1] # just want the sum of iterations list
-                return { key: cumm_subsm_rec[key] + new_subsm_rec[key] for key in new_subsm_rec.keys( ) }
-            return { channel_k: {
-                         stokes_k: accumulate_tclean_records( cumm_sm[channel_k][stokes_k], stokes_v )
-                         for stokes_k,stokes_v in channel_v.items( ) } for channel_k,channel_v in new_sm.items( )
-                   }
+            residname = self._imagename + '.residual'
+
+        maskname = self._imagename + '.mask'
+        if not os.path.exists(maskname):
+            maskname = ''
+
+        peakres = imstat(imagename=residname, mask=maskname)['max']
+        if len(maskname) > 0:
+            masksum = imstat(imagename=maskname)['sum']
+        else:
+            masksum = []
+
+        if len(peakres) > 0:
+            peakres = peakres[0]
+        else:
+            peakres = None
+
+        if len(masksum) > 0:
+            masksum = masksum[0]
+        else:
+            masksum = None
+
+        return peakres, masksum
 
     def __next__( self ):
         """ Runs tclean and returns the (stopcode, convergence result) when executed with the python builtin next() function.
 
         The returned convergence result is a nested dictionary:
         {
             channel id: {
@@ -284,88 +443,191 @@
                     summary key: [values, one per minor cycle]
                 },
             },
         }
 
         See also: gclean.__update_convergence(...)
         """
-        if self._finalized:
-            self._convergence_result = ( f'iteration terminated',
-                                         self._convergence_result[1],
-                                         self._major_done,
-                                         self._convergence_result[3] )
-            raise StopIteration
-        #                                                                             ensure that at least the initial tclean run
+
         #                      vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv------------>>> is done to produce an initial dirty image
         if self._niter < 1 and self._convergence_result[2] is not None:
             self._convergence_result = ( f'nothing to run, niter == {self._niter}',
                                          self._convergence_result[1],
                                          self._major_done,
-                                         self._convergence_result[3] )
+                                         self._nmajor,
+                                         self._niter,
+                                         self._convergence_result[5] )
             return self._convergence_result
         else:
-            ###
             ### CALL SEQUENCE:
             ###       tclean(niter=0),deconvolve(niter=0),tclean(niter=100),deconvolve(niter=0),tclean(niter=100),tclean(niter=0,restoration=True)
-            ###
-            if self._convergence_result[1] is None:
-                # initial call to tclean(...) creates the initial dirty image with niter=0
-                tclean_ret = self._tclean( vis=self._vis, mask=self._mask, imagename=self._imagename, imsize=self._imsize, cell=self._cell,
-                                           phasecenter=self._phasecenter, stokes=self._stokes, startmodel=self._startmodel, specmode=self._specmode,
-                                           reffreq=self._reffreq, gridder=self._gridder, wprojplanes=self._wprojplanes, mosweight=self._mosweight,
-                                           psterm=self._psterm, wbawp=self._wbawp, conjbeams=self._conjbeams, usepointing=self._usepointing,
-                                           interpolation=self._interpolation, restfreq=self._restfreq, perchanweightdensity=self._perchanweightdensity,
-                                           nchan=self._nchan, start=self._start, width=self._width, outframe=self._outframe,
-                                           pointingoffsetsigdev=self._pointingoffsetsigdev, pblimit=self._pblimit, deconvolver=self._deconvolver,
-                                           cyclefactor=self._cyclefactor, scales=self._scales, restoringbeam=self._restoringbeam, pbcor=self._pbcor,
-                                           nterms=self._nterms, field=self._field, spw=self._spw, timerange=self._timerange, uvrange=self._uvrange,
-                                           antenna=self._antenna, scan=self._scan, observation=self._observation, intent=self._intent,
-                                           datacolumn=self._datacolumn, weighting=self._weighting, robust=self._robust, npixels=self._npixels,
-                                           interactive=False, niter=0, gain=0.000001, calcres=True, restoration=False, parallel=self._parallel, fullsummary=True )
-                self._deconvolve( imagename=self._imagename, niter=0, usemask=self._usemask, restoration=False, deconvolver=self._deconvolver )
-                self._major_done = 0
-            else:
-                tclean_ret = self._tclean( vis=self._vis, imagename=self._imagename, imsize=self._imsize, cell=self._cell, phasecenter=self._phasecenter,
-                                           stokes=self._stokes, specmode=self._specmode, reffreq=self._reffreq,
+            self._exe_cmds_per_iter.append(0)
+            try:
+                if self._convergence_result[1] is None:
+
+                    # initial call to tclean(...) creates the initial dirty image with niter=0
+                    tclean_ret = self._tclean( vis=self._vis, mask=self._mask, imagename=self._imagename, imsize=self._imsize, cell=self._cell,
+                                               phasecenter=self._phasecenter, stokes=self._stokes, startmodel=self._startmodel, specmode=self._specmode,
+                                               reffreq=self._reffreq, gridder=self._gridder, wprojplanes=self._wprojplanes, mosweight=self._mosweight,
+                                               psterm=self._psterm, wbawp=self._wbawp, conjbeams=self._conjbeams, usepointing=self._usepointing,
+                                               interpolation=self._interpolation, perchanweightdensity=self._perchanweightdensity,
+                                               nchan=self._nchan, start=self._start, width=self._width, veltype=self._veltype, restfreq=self._restfreq,
+                                               outframe=self._outframe, pointingoffsetsigdev=self._pointingoffsetsigdev, pblimit=self._pblimit,
+                                               deconvolver=self._deconvolver, smallscalebias=self._smallscalebias, cyclefactor=self._cyclefactor,
+                                               scales=self._scales, restoringbeam=self._restoringbeam, pbcor=self._pbcor, nterms=self._nterms,
+                                               field=self._field, spw=self._spw, timerange=self._timerange, uvrange=self._uvrange, antenna=self._antenna,
+                                               scan=self._scan, observation=self._observation, intent=self._intent, datacolumn=self._datacolumn,
+                                               weighting=self._weighting, robust=self._robust, npixels=self._npixels, interactive=False, niter=0,
+                                               gain=self._gain, calcres=True, calcpsf=True, restoration=False, parallel=self._parallel, fullsummary=True)
+
+                    # Check if a mask from a previous run exists on disk
+                    self._check_initial_mask()
+
+                    deconv_ret = self._deconvolve(imagename=self._imagename, startmodel=self._startmodel,
+                                                  deconvolver=self._deconvolver, restoration=False,
+                                                  threshold=self._threshold, niter=0,
+                                                  nsigma=self._nsigma, fullsummary=True, fastnoise=self._fastnoise, usemask=self._usemask,
+                                                  mask=self._mask, pbmask=self._pbmask, sidelobethreshold=self._sidelobethreshold, noisethreshold=self._noisethreshold,
+                                                  lownoisethreshold=self._lownoisethreshold, negativethreshold=self._negativethreshold, smoothfactor=self._smoothfactor,
+                                                  minbeamfrac=self._minbeamfrac, cutthreshold=self._cutthreshold, growiterations=self._growiterations,
+                                                  dogrowprune=self._dogrowprune, verbose=self._verbose)
+
+                    # If no mask from a previous run exists, over-write the ones with zeros for the default mask
+                    self._fix_initial_mask()
+
+                    self.current_imdict.returndict = self.current_imdict.merge(tclean_ret, deconv_ret)
+                    self.global_imdict.returndict = self.current_imdict.returndict
+
+                    ## Initial call where niterleft and nmajorleft are same as original input values.
+                    self.hasit, self.stopdescription = self.global_imdict.has_converged(self._niter, self._threshold, self._nmajor)
+
+                    self.current_imdict.returndict['stopcode'] = self.hasit
+                    self.current_imdict.returndict['stopDescription'] = self.stopdescription
+                    self._major_done = 0
+                else:
+                    # Reset convergence every time, since we return control to the GUI after a single major cycle
+                    self.current_imdict.returndict['iterdone'] = 0.
+
+                    # Mask can be updated here...
+                    # Check for mask update - peakres + masksum
+                    _peakres, _masksum = self._update_peakres()
+
+                    self.hasit, self.stopdescription = self.global_imdict.has_converged(self._niter, self._threshold, self._nmajor, masksum=_masksum, peakres=_peakres)
+
+                    #self.global_imdict.returndict['stopcode'] = self.hasit
+                    #self.global_imdict.returndict['stopDescription'] = self.stopdescription
+
+                    #self.current_imdict.returndict['stopcode'] = self.hasit
+                    #self.current_imdict.returndict['stopDescription'] = self.stopdescription
+
+                    # Has not, i.e., not converged
+                    if self.hasit ==0 :
+                        use_cycleniter, cyclethreshold = self._calc_deconv_controls(self.current_imdict, self._niter, self._threshold, self._cycleniter)
+
+                        # Run the minor cycle
+                        deconv_ret = self._deconvolve(imagename=self._imagename, startmodel=self._startmodel,
+                                                  deconvolver=self._deconvolver, restoration=False,
+                                                  threshold=cyclethreshold, niter=use_cycleniter, gain=self._gain, fullsummary=True)
+
+                        # Run the major cycle
+                        tclean_ret = self._tclean( vis=self._vis, imagename=self._imagename, imsize=self._imsize, cell=self._cell,
+                                           phasecenter=self._phasecenter, stokes=self._stokes, specmode=self._specmode, reffreq=self._reffreq,
                                            gridder=self._gridder, wprojplanes=self._wprojplanes, mosweight=self._mosweight, psterm=self._psterm,
                                            wbawp=self._wbawp, conjbeams=self._conjbeams, usepointing=self._usepointing, interpolation=self._interpolation,
-                                           restfreq=self._restfreq, perchanweightdensity=self._perchanweightdensity, nchan=self._nchan, start=self._start,
-                                           width=self._width, outframe=self._outframe, pointingoffsetsigdev=self._pointingoffsetsigdev, pblimit=self._pblimit,
-                                           deconvolver=self._deconvolver, cyclefactor=self._cyclefactor, scales=self._scales, restoringbeam=self._restoringbeam,
-                                           pbcor=self._pbcor, nterms=self._nterms, field=self._field, spw=self._spw, timerange=self._timerange,
-                                           uvrange=self._uvrange, antenna=self._antenna, scan=self._scan, observation=self._observation, intent=self._intent,
-                                           datacolumn=self._datacolumn, weighting=self._weighting, robust=self._robust, npixels=self._npixels, interactive=False,
-                                           niter=self._niter, restart=True, calcpsf=False, calcres=False, restoration=False, threshold=self._threshold,
-                                           nsigma=self._nsigma, cycleniter=self._cycleniter, nmajor=self._nmajor, gain=self._gain,
+                                           perchanweightdensity=self._perchanweightdensity, nchan=self._nchan, start=self._start,
+                                           width=self._width, veltype=self._veltype, restfreq=self._restfreq, outframe=self._outframe,
+                                           pointingoffsetsigdev=self._pointingoffsetsigdev, pblimit=self._pblimit, deconvolver=self._deconvolver,
+                                           smallscalebias=self._smallscalebias, cyclefactor=self._cyclefactor, scales=self._scales,
+                                           restoringbeam=self._restoringbeam, pbcor=self._pbcor, nterms=self._nterms, field=self._field,
+                                           spw=self._spw, timerange=self._timerange, uvrange=self._uvrange, antenna=self._antenna,
+                                           scan=self._scan, observation=self._observation, intent=self._intent, datacolumn=self._datacolumn,
+                                           weighting=self._weighting, robust=self._robust, npixels=self._npixels, interactive=False,
+                                           niter=0, restart=True, calcpsf=False, calcres=True, restoration=False, threshold=self._threshold,
+                                           nsigma=self._nsigma, cycleniter=self._cycleniter, nmajor=1, gain=self._gain,
                                            sidelobethreshold=self._sidelobethreshold, noisethreshold=self._noisethreshold,
                                            lownoisethreshold=self._lownoisethreshold, negativethreshold=self._negativethreshold,
                                            minbeamfrac=self._minbeamfrac, growiterations=self._growiterations, dogrowprune=self._dogrowprune,
-                                           minpercentchange=self._minpercentchange, fastnoise=self._fastnoise, savemodel=self._savemodel, maxpsffraction=1,
-                                           minpsffraction=0, parallel=self._parallel, fullsummary=True )
-                self._deconvolve( imagename=self._imagename, niter=0, usemask=self._usemask, restoration=False, deconvolver=self._deconvolver )
-                self._major_done = tclean_ret['nmajordone'] if 'nmajordone' in tclean_ret else 0
-
-            if len(tclean_ret) > 0 and 'summaryminor' in tclean_ret and sum(map(len,tclean_ret['summaryminor'].values())) > 0:
-                new_summaryminor_rec = gclean.__filter_convergence(tclean_ret['summaryminor'])
-                self._convergence_result = ( None,
-                                             tclean_ret['stopcode'] if 'stopcode' in tclean_ret else 0,
+                                           minpercentchange=self._minpercentchange, fastnoise=self._fastnoise, savemodel=self._savemodel,
+                                           maxpsffraction=self._maxpsffraction,
+                                           minpsffraction=self._minpsffraction, parallel=self._parallel, fullsummary=True )
+
+                        # Replace return dict with new return dict
+                        # The order of the dicts into merge is important.
+                        self.current_imdict.returndict = self.current_imdict.merge(tclean_ret, deconv_ret)
+
+                        # Append new return dict to global return dict
+                        self.global_imdict.returndict = self.global_imdict.concat(self.global_imdict.returndict, self.current_imdict.returndict)
+                        self._major_done = self.current_imdict.returndict['nmajordone']
+
+                        ## Decrement count for the major cycle just done...
+                        self.__decrement_counts()
+
+                        # Use global imdict for convergence check
+                        if deconv_ret['stopcode'] == 7:   ## Tell the convergence checker that the mask is zero and iterations were skipped
+                            self.hasit, self.stopdescription = self.global_imdict.has_converged(self._niter, self._threshold, self._nmajor, masksum=0)
+                        else:
+                            self.hasit, self.stopdescription = self.global_imdict.has_converged(self._niter, self._threshold, self._nmajor)
+
+
+                    self.global_imdict.returndict['stopcode'] = self.hasit
+                    self.global_imdict.returndict['stopDescription'] = self.stopdescription
+
+                    if not self.hasit:
+                        # If we haven't converged, run deconvolve to update the mask
+                        self._deconvolve(imagename=self._imagename, startmodel=self._startmodel, deconvolver=self._deconvolver, restoration=False, threshold=self._threshold, niter=0,
+                                         nsigma=self._nsigma, fullsummary=True, fastnoise=self._fastnoise, usemask=self._usemask, mask='', pbmask=self._pbmask,
+                                         sidelobethreshold=self._sidelobethreshold, noisethreshold=self._noisethreshold, lownoisethreshold=self._lownoisethreshold,
+                                         negativethreshold=self._negativethreshold, smoothfactor=self._smoothfactor, minbeamfrac=self._minbeamfrac, cutthreshold=self._cutthreshold,
+                                         growiterations=self._growiterations, dogrowprune=self._dogrowprune, verbose=self._verbose)
+
+
+                if len(self.global_imdict.returndict) > 0 and 'summaryminor' in self.global_imdict.returndict and sum(map(len,self.global_imdict.returndict['summaryminor'].values())) > 0:
+                    self._convergence_result = ( self.global_imdict.returndict['stopDescription'] if 'stopDescription' in self.global_imdict.returndict else '',
+                                                 self.global_imdict.returndict['stopcode'] if 'stopcode' in self.global_imdict.returndict else 0,
+                                                 self._major_done,
+                                                 self._nmajor,
+                                                 self._niter,
+                                                 self.__add_per_major_items( self.global_imdict.returndict,
+                                                                             self._convergence_result[5]['major'],
+                                                                             self.__update_convergence()))
+                else:
+                    self._convergence_result = ( f'tclean returned an empty result',
+                                                 self._convergence_result[1],
+                                                 self._major_done,
+                                                 self._nmajor,
+                                                 self._niter,
+                                                 self._convergence_result[5] )
+            except Exception as e:
+                self._convergence_result = ( str(e),
+                                             -1,
                                              self._major_done,
-                                             self.__add_per_major_items( tclean_ret,
-                                                                         self._convergence_result[3]['major'],
-                                                                         gclean.__update_convergence( self._convergence_result[3]['chan'],
-                                                                                                      new_summaryminor_rec ) ) )
-            else:
-                self._convergence_result = ( f'tclean returned an empty result',
-                                             self._convergence_result[1],
-                                             self._major_done,
-                                             self._convergence_result[3] )
+                                             self._nmajor,
+                                             self._niter,
+                                             self._convergence_result[5] )
+                return self._convergence_result
+
             return self._convergence_result
 
+    def __decrement_counts( self ):
+        ## Update niterleft and nmajorleft now.
+        if self.hasit == 0:  ##If not yet converged.
+            if self._nmajor != -1:   ## If -1, don't touch it.
+                self._nmajor = self._nmajor - 1
+                if self._nmajor<0:   ## Force a floor
+                    self._nmajor=0
+            self._niter = self._niter - self.current_imdict.get_key('iterdone')
+            if self._niter<0:  ## This can happen when we're counting niter across channels in a single minor cycle set, and it crosses the total.
+                self._niter=0  ## Force a floor
+        else:
+            return  ##If convergence has been reached, don't try to decrement further.
+
+
     def __reflect_stop( self ):
         ## if python wasn't hacky, you would be able to try/except/raise in lambda
+        time.sleep(1)
         try:
             return self.__next__( )
         except StopIteration:
             raise StopAsyncIteration
 
     async def __anext__( self ):
         ### asyncio.run cannot be used here because this is called
@@ -376,39 +638,40 @@
 
     def __iter__( self ):
         return self
 
     def __aiter__( self ):
         return self
 
+    def __split_filename( self, path ):
+        return os.path.splitext(os.path.basename(path))
+
+    def __default_mask_name( self ):
+        imgparts = self.__split_filename( self._imagename )
+        return f'{imgparts[0]}.mask'
+
+    def mask(self):
+        #return self.__default_mask_name() if self._mask == '' else self._mask
+        return f'{self._imagename}.mask' if self._mask == '' else self._mask
+
     def reset(self):
         #if not self._finalized:
         #    raise RuntimeError('attempt to reset a gclean run that has not been finalized')
         self._finalized = False
         self._convergence_result = ( None,
                                      self._convergence_result[1],
                                      self._major_done,
-                                     self._convergence_result[3] )
+                                     self._nmajor,
+                                     self._niter,
+                                     self._convergence_result[5] )
 
     def restore(self):
         """ Restores the final image, and returns a path to the restored image. """
-        tclean_ret = self._tclean( vis=self._vis, imagename=self._imagename, imsize=self._imsize, cell=self._cell,
-                                   phasecenter=self._phasecenter, stokes=self._stokes, specmode=self._specmode,
-                                   reffreq=self._reffreq, gridder=self._gridder, wprojplanes=self._wprojplanes, mosweight=self._mosweight,
-                                   psterm=self._psterm, wbawp=self._wbawp, conjbeams=self._conjbeams, usepointing=self._usepointing,
-                                   interpolation=self._interpolation, restfreq=self._restfreq, perchanweightdensity=self._perchanweightdensity, nchan=self._nchan,
-                                   start=self._start, width=self._width, outframe=self._outframe, pointingoffsetsigdev=self._pointingoffsetsigdev,
-                                   pblimit=self._pblimit, deconvolver=self._deconvolver, cyclefactor=self._cyclefactor, scales=self._scales,
-                                   restoringbeam=self._restoringbeam, pbcor=self._pbcor, nterms=self._nterms, field=self._field, spw=self._spw,
-                                   timerange=self._timerange, uvrange=self._uvrange, antenna=self._antenna, scan=self._scan,
-                                   observation=self._observation, intent=self._intent, datacolumn=self._datacolumn, weighting=self._weighting,
-                                   robust=self._robust, npixels=self._npixels, gain=self._gain, sidelobethreshold=self._sidelobethreshold,
-                                   noisethreshold=self._noisethreshold, lownoisethreshold=self._lownoisethreshold,
-                                   negativethreshold=self._negativethreshold, minbeamfrac=self._minbeamfrac, growiterations=self._growiterations,
-                                   dogrowprune=self._dogrowprune, minpercentchange=self._minpercentchange, fastnoise=self._fastnoise,
-                                   savemodel=self._savemodel, nsigma=self._nsigma, interactive=False,
-                                   niter=0, restart=True, calcpsf=False, calcres=False, restoration=True,
-                                   parallel=self._parallel )
+        deconv_ret = self._deconvolve(imagename=self._imagename,
+                                      deconvolver=self._deconvolver,
+                                      restoration=True, niter=0,
+                                      fullsummary=True)
+
         return { "image": f"{self._imagename}.image" }
 
     def has_next(self):
         return not self._finalized
```

## casatasks/private/imagerhelpers/imager_base.py

```diff
@@ -2,35 +2,40 @@
 import os
 import math
 import shutil
 import string
 import time
 import re
 import copy
+from typing import TYPE_CHECKING
 from casatasks.private.casa_transition import is_CASA6
 
 if is_CASA6:
     from casatools import (
         synthesisimager,
         synthesisdeconvolver,
         synthesisnormalizer,
         iterbotsink,
         ctsys,
         table,
         image,
     )
     from casatasks import casalog
     from casatasks.private.imagerhelpers.summary_minor import SummaryMinor
+    if TYPE_CHECKING:
+        from casatasks.private.imagerhelpers.input_parameters import ImagerParameters
 
     ctsys_hostinfo = ctsys.hostinfo
     _tb = table()
     _ia = image()
 else:
     from taskinit import *
     from imagerhelpers.summary_minor import SummaryMinor
+    if TYPE_CHECKING:
+        from imagerhelpers.input_parameters import ImagerParameters
 
     synthesisimager = casac.synthesisimager
     synthesisdeconvolver = casac.synthesisdeconvolver
     synthesisnormalizer = casac.synthesisnormalizer
     # make it look like the CASA6 version even though it's using the CASA5 named tool not present in CASA6
     iterbotsink = casac.synthesisiterbot
 
@@ -42,15 +47,16 @@
 
 Summary...
     
 """
 
 #############################################
 class PySynthesisImager:
-    def __init__(self, params):
+
+    def __init__(self,params: 'ImagerParameters'):
         ################ Tools
         self.initDefaults()
 
         # Check all input parameters, after partitioning setup.
 
         # Selection Parameters. Dictionary of dictionaries, indexed by 'ms0','ms1',...
         self.allselpars = params.getSelPars()
@@ -97,14 +103,15 @@
         if exists:
             casalog.post("CFCache already exists")
         else:           
             self.dryGridding();
             self.fillCFCache();
             self.reloadCFCache();
         
+
     def initializeImagers(self):
 
         ## Initialize the tool for the current node
         self.SItool = synthesisimager()
 
         ## casalog.post('impars ', self.allimpars['0']['specmode'], 'frame', self.allimpars['0']['outframe'])
         ## Send in selection parameters for all MSs in the list.
@@ -118,38 +125,42 @@
         #        nimpars = copy.deepcopy(self.allimpars)
         #        for fld in range(0,self.NF):
         #            self.SItool.defineimage( **( nimpars[str(fld)]  ) )
 
         # If cfcache directory already exists, assume that it is
         # usable and is correct.  makeCFCache call then becomes a
         # NoOp.
+
         cfCacheName=''
         exists=False
-        if(self.allgridpars['0']['gridder'].startswith('awp')):
+        if(self.allgridpars['0']['gridder'].startswith('awpr') or self.allgridpars['0']['gridder'].startswith('awph') ):
             cfCacheName=self.allgridpars['0']['cfcache'];
             if (cfCacheName == ''):
                 cfCacheName = self.allimpars['0']['imagename'] + '.cf'
                 self.allgridpars['0']['cfcache']= cfCacheName 
             exists = (os.path.exists(cfCacheName) and os.path.isdir(cfCacheName));
         else:
             cfCacheName=''
             exists=True
             
         for fld in range(0,self.NF):
             # casalog.post("self.allimpars=",self.allimpars,"\n")
+
+            # print(f'####allimpars={self.allimpars[str(fld)]} \n    allgridpars={self.allgridpars[str(fld)]}')
             self.SItool.defineimage(
                 self.allimpars[str(fld)], self.allgridpars[str(fld)]
             )
 
         ###for cases when synthesisnormalizer is setup in c++ send the normalizer info
         ###all images have the same normtype etc..so first one is good enough
         self.SItool.normalizerinfo(self.allnormpars["0"])
         ###commenting this out so that tuneSelect is done after weighting
         ###CAS-11687
         # For cube imaging:  align the data selections and image setup
+
         #if self.allimpars['0']['specmode'] != 'mfs' and self.allimpars['0']['specmode'] != 'cubedata':
         #   self.SItool.tuneselectdata()
         ###For cubes create cfcache ahead of each partition trying
         ### to create it as it is not multiprocess safe
         if("cube" in self.allimpars['0']['specmode']):
             self.makeCFCache(exists);
 
@@ -219,16 +230,14 @@
             self.SDtools[immod].restore()
 
     #############################################
     def pbcorImages(self):
         for immod in range(0, self.NF):
             self.SDtools[immod].pbcor()
 
-    #############################################
-
     def getSummary(self,fullsummary,fignum=1):
         summ = self.IBtool.getiterationsummary()
         casalog.post('getSummary call: fullsummary='+str(fullsummary))
         if ('stopcode' in summ):
             summ['stopDescription'] = self.getStopDescription(summ['stopcode'])
         if ('summaryminor' in summ):
             summ['summaryminor'] = SummaryMinor.convertMatrix(summ['summaryminor'],fullsummary)
@@ -421,41 +430,51 @@
                     # casalog.post("Model visibilities may not have been saved in the MS even though you have asked for it. Please check the logger for the phrases 'Run (Last) Major Cycle'  and  '" + wstr +"'. If these do not appear, then please save the model via a separate tclean run with niter=0,calcres=F,calcpsf=F. It will pick up the existing model from disk and save/predict it.   Reason for this : For performance reasons model visibilities are saved only in the last major cycle. If the X button on the interactive GUI is used to terminate a run before this automatically detected 'last' major cycle, the model isn't written. However, a subsequent tclean run as described above will predict and save the model. ","WARN")
 
         # casalog.post('Mask changed during interaction  : ', maskchanged)
         return maskchanged or forcestop
 
     #############################################
     def makePSF(self):
-
         self.makePSFCore()
-        divideInPython=self.allimpars['0']['specmode'] == 'mfs' or self.allimpars['0']['deconvolver'] == 'mtmfs'
+        divideInPython = (
+            self.allimpars["0"]["specmode"] == "mfs"
+            or self.allimpars["0"]["deconvolver"] == "mtmfs"
+        )
+
         ### Gather PSFs (if needed) and normalize by weight
         for immod in range(0, self.NF):
             # for cube normalization is done in C++
             if divideInPython:
                 self.PStools[immod].gatherpsfweight()
                 self.PStools[immod].dividepsfbyweight()
-            if self.SDtools != []:
-                if immod <= len(self.SDtools) - 1:
-                    self.SDtools[immod].checkrestoringbeam()
+            self.check_psf(immod)
+
+    def check_psf(self, immod):
+        if self.SDtools != []:
+            if immod <= len(self.SDtools) - 1:
+                self.SDtools[immod].checkrestoringbeam()
 
     #############################################
     def calcVisAppSens(self):
 
         return self.SItool.apparentsens()
 
     #############################################
 
     def runMajorCycle(self, isCleanCycle=True):
         # @param isCleanCycle: true if this is part of the major/minor cleaning loop, false if this is being used for some other purpose (such as generating the residual image)
         if self.IBtool != None:
             lastcycle = self.IBtool.cleanComplete(lastcyclecheck=True) > 0
         else:
             lastcycle = True
-        divideInPython=self.allimpars['0']['specmode'] == 'mfs' or self.allimpars['0']['deconvolver'] == 'mtmfs'
+
+        divideInPython = (
+            self.allimpars["0"]["specmode"] == "mfs"
+            or self.allimpars["0"]["deconvolver"] == "mtmfs"
+        )
         ##norm is done in C++ for cubes
         if not divideInPython:
             self.runMajorCycleCore(lastcycle)
             if isCleanCycle:
                 self.majorCnt += 1
             if self.IBtool != None:
                 self.IBtool.endmajorcycle()
@@ -740,15 +759,15 @@
             and summ["summaryminor"].shape[0] == 6
         ):
             casalog.post(
                 "Cannot make summary plot. Please check contents of the output dictionary from tclean."
             )
             return summ
 
-        import pylab as pl
+        import matplotlib.pyplot as pl
         from numpy import max as amax
 
         # 0 : iteration number (within deconvolver, per cycle)
         # 1 : peak residual
         # 2 : model flux
         # 3 : cyclethreshold
         # 4 : deconvolver id
```

## casatasks/private/imagerhelpers/imager_return_dict.py

```diff
@@ -1,18 +1,19 @@
 from __future__ import absolute_import
 
 import os
 import numpy as np
 
 # Assume CASA 6, CASA 5 is no longer built
 from casatools import image
+from casatasks import casalog
 ia = image()
 
 
-class ReturnDictionary():
+class ImagingDict():
     """
     Class that constructs the tclean return dictionary - implemented
     specifically for the niter=0 case, to reproduce the dictionary generated in
     C++ without modifying the C++ code.
 
     Attributes:
     -----------
@@ -20,46 +21,443 @@
     modelname       : Name of the input model image (optional)
     summaryminor    : The dictionary containing summaryminor
     retrec          : The full return dictionary
 
     Methods:
     --------
 
-    imageDimensions(residname)
+    image_dimensions(residname)
         Use the image() tool to query for the number of Stokes planes and
         frequency channels in the input image.
 
-    fillSummaryMinor(residname, modelname, channo, stokes, stokes_axis, freq_axis, fullsummary):
+    fill_summary_minor(residname, modelname, channo, stokes, stokes_axis, freq_axis, fullsummary):
         Given the input image name, and the corresponding field, channel number, and
         Stokes plane, extract the relevant information from the image to generate a
         summaryminor dict as defined
 
-    constructSummaryMinor(self, paramList):
+    construct_summary_minor(self, paramList):
         Constructs and populates a nested dictionary containing the summaryMinor()
         information required by tclean.
         This is a duplicate of the existing summaryMinor() class in C++, but is
         being re-written here to avoid issues with modifying iterControl.
 
-    constructResidualDict(paramList):
+    construct_residual_dict(paramList):
         Construct the residual dictionary given the input image name and associated parameters. This residual dictionary is meant to
         duplicate that generated by imager.getSummary(fullsummary) for the special
-        case of niter = 0 to avoid initializing the deconvolver.
     """
 
-    def __init__(self):
-        """
-        Initialize necessary variables for the return dictionary.
-        """
+    def __init__(self) -> None:
+        self._returndict = {}
+        self._summaryminor = {}
+
+        # These three parameters cannot be assigned, only accessed.
+        # They reflect the values in the summaryminor key in the return dict.
+
+        self._nfield = 0
+        self._nstokes = 0
+        self._nchan = 0
+
         self.residname = ''
         self.modelname = ''
-        self.summaryminor = dict()
-        self.retrec = dict()
+        self.maskname = ''
+
+        self._initialize()
+
+        self._summaryminor_keys = ['iterDone', 'peakRes', 'modelFlux', 'cycleThresh',
+                                   'cycleStartIters', 'startIterDone',
+                                   'startPeakRes', 'startModelFlux',
+                                   'startPeakResNM', 'peakResNM', 'masksum',
+                                   'mpiServer', 'stopCode']
+
+    def __str__(self) -> str:
+        """
+        Pretty print the return dictionary.
+        """
+
+        retstr = ''
+        for key, val in self._returndict.items():
+            if key == 'summaryminor':
+                retstr += 'summaryminor:\n'
+                for field in val.keys():
+                    for freq in val[field].keys():
+                        for stokes in val[field][freq].keys():
+                            for key2, val2 in val[field][freq][stokes].items():
+                                retstr += f'\t Field: {field: 3d}, Chan: {freq: 3d}, Stokes: {stokes :2d}, {key2}, {val2}\n'
+            else:
+                retstr += f'{key}: {val}\n'
+        return retstr
+
+    @property
+    def returndict(self) -> dict:
+        return self._returndict
+
+    @returndict.setter
+    def returndict(self, inpdict: dict) -> None:
+        self._returndict = inpdict
+
+    @returndict.deleter
+    def returndict(self) -> None:
+        del self._returndict
+
+    @property
+    def nfield(self) -> int:
+        self._nfield = len(self._returndict['summaryminor'].keys())
+        return self._nfield
+
+    @nfield.deleter
+    def nfield(self) -> None:
+        del self._nfield
+
+    # XXX : This assumes that the number of channels is the same for all fields
+    @property
+    def nchan(self) -> int:
+        self._nchan = 0
+        for field in self._returndict['summaryminor'].keys():
+            self._nchan = len(self._returndict['summaryminor'][field].keys())
+            break
+
+        return self._nchan
+
+    @nchan.deleter
+    def nchan(self) -> None:
+        del self._nchan
+
+    @property
+    def nstokes(self) -> int:
+        self._nstokes = 0
+        for field in self._returndict['summaryminor'].keys():
+            for freq in self._returndict['summaryminor'][field].keys():
+                self._nstokes = len(self._returndict['summaryminor'][field][freq].keys())
+                break
+
+        return self._nstokes
+
+    @nstokes.deleter
+    def nstokes(self) -> None:
+        del self._nstokes
+
+    def _initialize(self) -> None:
+        """
+        Initialize the return dictionary with dummy values. This sets up the
+        dictionary structure and keys to expect, and will be filled in with
+        real values when running tclean or deconvolve.
+        """
+
+        # Initialize the values that don't need to inspect any images
+        self._returndict['cleanstate'] = ''
+        self._returndict['cyclefactor'] = 1.0
+        self._returndict['cycleiterdone'] = 0
+        self._returndict['cycleniter'] = 0
+        self._returndict['cyclethreshold'] = 0
+        self._returndict['interactiveiterdone'] = 0
+        self._returndict['interactivemode'] = False
+        self._returndict['interactiveniter'] = 0
+        self._returndict['interactivethreshold'] = 0
+
+        self._returndict['iterdone'] = 0
+        self._returndict['loopgain'] = 0
+        self._returndict['maxpsffraction'] = 0
+        self._returndict['maxpsfsidelobe'] = 0
+        self._returndict['minpsffraction'] = 0
+
+        self._returndict['niter'] = 0
+        self._returndict['nmajordone'] = 0
+        self._returndict['nsigma'] = 0.0
+        self._returndict['stopcode'] = 0
+
+        self._returndict['summarymajor'] = np.array([])
+        # Summary minor is nested as {field{freq{stokes}}
+        # TODO : Figure out a better way to initialize the empty summary minor
+        # without explicitly setting a field/stokes/channel number.
+        self._returndict['summaryminor'] = {}
+        self._returndict['summaryminor'][0] = {}
+        self._returndict['summaryminor'][0][0] = {}
+        self._returndict['summaryminor'][0][0][0] = self._initialize_summary_minor()
+
+        self._returndict['threshold'] = 0.0
+        self._returndict['stopDescription'] = 'Zero iterations performed'
+
+
+    def _initialize_summary_minor(self) -> dict:
+        """
+        Initialize the summary minor dictionary with dummy values. This sets up the
+        dictionary structure and keys to expect, and will be filled in with
+        real values when running tclean or deconvolve.
+        """
+
+        self._summaryminor['iterDone'] = []
+        self._summaryminor['peakRes'] = []
+        self._summaryminor['modelFlux'] = []
+        self._summaryminor['cycleThresh'] = []
+        self._summaryminor['cycleStartIters'] = []
+        self._summaryminor['startIterDone'] = []
+        self._summaryminor['startPeakRes'] = []
+        self._summaryminor['startModelFlux'] = []
+        self._summaryminor['startPeakResNM'] = []
+        self._summaryminor['peakResNM'] = []
+        self._summaryminor['masksum'] = []
+        self._summaryminor['mpiServer'] = []
+        self._summaryminor['stopCode'] = []
+
+        return self._summaryminor
+
+
+
+    def get_key(self, key:str, field:int=0, chan:int=0, stokes:int=0) -> list:
+        """
+        Return the list of values for the specified key. If requesting a key
+        within "summaryminor", also specify the field, channel and stokes plane.
+
+        Inputs:
+        key         The key to return. str
+        field       The field to return. int
+        chan        The channel to return. int
+        stokes      The stokes plane to return. int
+
+        Returns:
+        The list of values for the specified key. list
+        """
+
+        #if key.lower() == 'peakres':
+        #    print(f"field {field}, chan {chan}, stokes {stokes}, peakres {self._returndict['summaryminor'][field][chan][stokes][key]}")
+
+        try:
+            if key in self._summaryminor_keys:
+                return self._returndict['summaryminor'][field][chan][stokes][key]
+            else:
+                return self._returndict[key]
+        except KeyError:
+            print(f'WARNING : Key {key} not found in return dictionary.')
+            return []
+
+
+    @staticmethod
+    def get_summaryminor_stopdesc(stopcode:int=None) -> str:
+        """
+        Given the summaryminor stopcode, return the stop description.
+
+        Inputs:
+        stopcode        The stopcode to return the description for. int
+
+        Returns:
+        stopdesc        The stop description. str
+        """
+
+        stopdesc = {0:'Skipped this channel/polarization. Zero mask.',
+                    1:'Reached cycleniter',
+                    2:'Reached cyclethreshold',
+                    3:'Zero iterations performed',
+                    4:'Possible divergence. Peak residual increased by 10% from minimum',
+                    5:'Exited deconvolver minor cycle without reaching any stopping criterion',
+                    6:'Reached n-sigma threshold'}
+
+        if stopcode is None:
+            return stopdesc
+
+        return stopdesc[stopcode]
+
+
+
+    def merge(self, tclean_dict: dict, deconv_dict: dict, key_path=[]) -> None:
+        """
+        Merge the return dictionaries from tclean and deconvolve.
+
+        Inputs:
+        tclean_dict     The return dictionary from deconvolve. dict
+        deconv_dict     The return dictionary from tclean. dict
+
+        Returns:
+        merge_dict
+        """
+
+        merge_dict = tclean_dict.copy()
+
+        for key, val in deconv_dict.items():
+            if key == 'summaryminor':
+                # Copy summaryminor from deconvolve always
+                merge_dict[key] = val
+            # Copy all the iteration control keys from deconvolve
+            elif key in ['iterdone', 'cycleiterdone', 'cycleniter', 'cyclethreshold',
+                         'maxpsffraction', 'maxpsfsidelobe', 'minpsffraction', 'nsigma']:
+                merge_dict[key] = val
+
+        return merge_dict
+
 
+    def concat(self, dict1:dict, dict2:dict) -> None:
+        """
+        Concatenate the two input dictionaries. The input dictionary must be a
+        fully formed return dictionary from either `tclean` or `deconvolve`.
+
+        The keys within summaryminor are always concatenated.
+        The following keys are incremented :
+            iterdone
+            nmajordone
+
+        The rest of the keys are left unchanged, and default to the values in dict2.
+
+        Inputs:
+        dict1     The initial dictionary, dict
+        dict2     The input dictionary to append. dict
 
-    def imageDimensions(self):
+        Returns:
+        appendix  The concatenated dictionary. dict
+        """
+
+        appendix = dict1.copy()
+
+        # All unique keys
+        dict_keys = list(dict1.keys()) + [key for key in dict2.keys() if key not in dict1.keys()]
+
+        for key in dict_keys:
+            if key not in dict1.keys() or key not in dict2.keys():
+                print("Internal Error : KEY mismatch : ", key)
+
+            if key in ['iterdone', 'nmajordone']:
+                appendix[key] = dict1[key] + dict2[key]
+            elif isinstance(dict1[key], dict) and isinstance(dict2[key], dict):
+                appendix[key] = self.concat(dict1[key], dict2[key])
+            elif isinstance(dict1[key], list) and isinstance(dict2[key], list):
+                appendix[key] = dict1[key] + dict2[key]
+            elif isinstance(dict1[key], np.ndarray) and isinstance(dict2[key], np.ndarray):
+                # Using a list allows either key to be completely empty
+                # numpy.concatenate breaks if one or both are length 0
+                temparr = []
+                temparr.extend(dict1[key])
+                temparr.extend(dict2[key])
+                appendix[key] = np.array(temparr)
+            elif isinstance(dict1[key], (int, float, complex)) and isinstance(dict2[key], (int, float, complex)):
+                appendix[key] = dict2[key]
+            else:
+                # Just use the key from dict1
+                appendix[key] = dict2[key]
+
+        return appendix
+
+
+
+    def check_masksum(self, field:int=0, major_index:int=-1) -> int:
+        """
+        Checks if the masksum key in summaryminor is uniformly zero across all
+        channels and Stokes planes.
+
+        By default it checks the last major cycle.
+        """
+
+        masksum = 0
+        for chan in range(self.nchan):
+            for stokes in range(self.nstokes):
+                masksum += self.get_key('masksum', field, chan, stokes)[major_index]
+
+        return masksum
+
+
+    def get_peakres(self, field:int=0, major_index:int=-1) -> float:
+        """
+        Calculates the peak residual across all channels and Stokes planes.
+
+        By default it calculates the peak residual over the last major cycle.
+        major_index directly indexes into the major cycle to query, so
+        major_index=-2 will query the penultimate major cycle etc.
+
+        Inputs:
+        field               The field index over which to calculate the peak residual, int
+        major_index         The major cycle index to query, int
+
+        Returns:
+        peakres             The peak residual, float
+        """
+
+        peakres = 0.0
+
+        for chan in range(self.nchan):
+            for stokes in range(self.nstokes):
+                masksum = self.get_key('masksum', field, chan, stokes)[major_index]
+                if masksum > 0:
+                    peakres = max(peakres, self.get_key('peakRes', field, chan, stokes)[major_index])
+
+        return peakres
+
+
+    def has_converged(self, niterleft=0, threshold=0, nmajorleft=0, masksum=None, peakres=None):
+        """
+        Check stopping criteria for convergence, based on the criteria specified here -
+        https://casadocs.readthedocs.io/en/stable/notebooks/synthesis_imaging.html#Returned-Dictionary
+
+        If peakres is provided, then prefer that over what is in the return
+        dict. This is to account for the usage case where the user has modified
+        the mask in between major cycles, and we need to update values of the
+        peak residual in order to determine if we want to continue
+        deconvolution.
+        """
+
+        # TODO : Implement StopCode 3, 8
+        # Note : For InteractiveClean, stopcode 3 is handled by the GUI for now
+        # Stopcode 8 requires some work to figure out what nsigmathreshold is
+        # and how it is calculated, so leaving that out for the moment.
+        # NSigma is not exposed in the GUI as of 2023-12-15.
+
+        stopcode = 0
+        stopDescription = ''
+
+        nmajordone = self.get_key('nmajordone')
+#        if nmajordone >= 2:
+#            # Peak residual over last two major cycles
+#            peakres1 = self.get_peakres(major_index=-1)
+#            peakres2 = self.get_peakres(major_index=-2)
+#        else:
+#            peakres1 = 0
+#            peakres2 = 0
+#
+#        peakres_list = np.asarray([self.get_peakres(major_index=-1*(ii+1)) for ii in range(nmajordone)])
+#        #min_peakres = np.amin(peakres_list[peakres_list != 0])
+#        min_peakres = np.amin(peakres_list)
+#        if min_peakres==0:
+#            print("peakres = 0 ! ")
+
+        if peakres != None:
+            _peakres = peakres
+        else:
+            _peakres = self.get_peakres()
+
+        if masksum !=None:
+            use_masksum = masksum      ## If the mask has been zero'd out and iterations have been skipped (i.e. no summaryminor).
+        else:
+            use_masksum = self.check_masksum()    ## If iterations have happened, latest info will be in the summaryminor.
+
+        if use_masksum == 0:
+            stopcode = 7
+            stopDescription = 'Zero mask'
+        elif niterleft<=0:
+            stopcode = 1
+            stopDescription = 'Reached the iteration limit'
+        elif _peakres <= threshold:
+            stopcode = 2
+            stopDescription = 'Reached global stopping threshold (within mask)'
+        elif (nmajorleft != -1 and nmajorleft==0):
+            stopcode = 9
+            stopDescription = 'Reached the major cycle limit (nmajor)'
+        # Stopcode 3 : Force Stop is handled by InteractiveClean GUI for now
+        # TODO : If this is used to run iteration control for non-interactive clean, implement this
+#        elif nmajordone > 2 and np.allclose(peakres1, peakres2):
+#            stopcode = 4
+#            stopDescription = 'No change in peak residual across consecutive major cycles'
+#        elif peakres1 > 3*peakres2 and peakres2 != 0:
+#            stopcode = 5
+#            stopDescription = 'Peak residual increased by more than 3x across consecutive major cycles'
+#        elif peakres1 > 3*min_peakres:
+#            stopcode = 6
+#            stopDescription = 'Peak residual increased by more than 3x from the minimum reached'
+
+        return  stopcode, stopDescription
+
+
+
+
+    def image_dimensions(self):
         """
         Given the input image, uses the ia tool to query for the number of Stokes
         planes and frequency channels.
 
         Inputs:
         None
 
@@ -83,15 +481,15 @@
         nfreq = shape[freq_axis]
 
         ia.close()
 
         return nstokes, nfreq, stokes_axis, freq_axis
 
 
-    def fillSummaryMinor(self, channo, stokes, stokes_axis, freq_axis, fullsummary):
+    def fill_summary_minor(self, channo, stokes, stokes_axis, freq_axis, fullsummary):
         """
         Given the input image name, and the corresponding field, channel number, and
         Stokes plane, extract the relevant information from the image to generate a
         summaryminor dict as defined
         https://casadocs.readthedocs.io/en/stable/notebooks/synthesis_imaging.html#Minor-Cycle-Summary-Dictionary
 
         Inputs:
@@ -117,26 +515,37 @@
             blc = [0, 0, stokes, channo]
             trc = [shape[0], shape[1], stokes, channo]
         elif stokes_axis == 3 and freq_axis == 2:
             blc = [0, 0, channo, stokes]
             trc = [shape[0], shape[1], channo, stokes]
 
         data = ia.getchunk(blc, trc, dropdeg=True)
-        mask = ia.getchunk(blc, trc, dropdeg=True, getmask=True)
         ia.close()
 
+        # Get the mask if it exists
+        if os.path.exists(self.maskname):
+            ia.open(self.maskname)
+            mask = ia.getchunk(blc, trc, dropdeg=True)
+            ia.close()
+        else:
+            mask = [] # No mask, so everything is unmasked
+
         # If model image exists, calc model flux, else set to 0
         model_sum = 0
         if os.path.exists(self.modelname):
             ia.open(self.modelname)
             model_data = ia.getchunk(blc, trc, dropdeg=True)
             model_sum = np.sum(model_data)
             ia.close()
 
-        peak_resid = np.amax(data*mask)
+        if len(mask) == 0:
+            peak_resid = np.amax(data)
+        else:
+            peak_resid = np.amax(data*mask)
+
         if fullsummary:
             peak_resid_NM = np.amax(data)
             mask_sum = np.sum(mask)
 
         summaryparams = dict()
         # This entire function is only invoked in the special case of niter=0
         summaryparams['iterDone'] = [0.0,]
@@ -156,104 +565,106 @@
             summaryparams['masksum'] = [mask_sum,]
             summaryparams['mpiServer'] = [0.0,]
             summaryparams['stopCode'] = [3,]
 
 
         return summaryparams
 
-
-    def constructSummaryMinor(self, paramList):
+    def construct_summary_minor(self, paramList):
         """
         Constructs and populates a nested dictionary containing the summaryMinor()
         information required by tclean.
 
         This is a duplicate of the existing summaryMinor() class in C++, but is
         being re-written here to avoid issues with modifying iterControl.
 
         Inputs:
         paramList        Object that contains all imaging parameters
 
         Returns:
-        summaryMinor    Nested dictionary with the summaryMinor keys, dict
+        None
         """
 
         impars = paramList.allimpars
         decpars = paramList.alldecpars
 
         # Each field is stored as a different key in impars
         nfields = len(impars.keys())
 
         for ff in range(nfields):
             self.residname=impars[str(ff)]['imagename']+'.residual.tt0' if(os.path.exists(impars[str(ff)]['imagename']+'.residual.tt0')) else impars[str(ff)]['imagename']+'.residual'
             self.modelname=impars[str(ff)]['imagename']+'.model.tt0' if(os.path.exists(impars[str(ff)]['imagename']+'.model.tt0')) else impars[str(ff)]['imagename']+'.model'
+            if(os.path.exists(impars[str(ff)]['imagename']+'.mask')):
+                 self.maskname=impars[str(ff)]['imagename']+'.mask'
 
             fullsummary = decpars[str(ff)]['fullsummary']
-            nstokes, nfreq, stokes_axis, freq_axis = self.imageDimensions()
+            nstokes, nfreq, stokes_axis, freq_axis = self.image_dimensions()
 
-            self.summaryminor[ff] = dict()
+            if ff not in self._returndict['summaryminor']:
+                self._returndict['summaryminor'][ff] = dict()
 
             for cc in range(nfreq):
-                self.summaryminor[ff][cc] = dict()
-                for ss in range(nstokes):
-                    self.summaryminor[ff][cc][ss] = self.fillSummaryMinor(cc, ss, stokes_axis, freq_axis, fullsummary)
+                if cc not in self._returndict['summaryminor'][ff]:
+                    self._returndict['summaryminor'][ff][cc] = dict()
 
-        return self.summaryminor
+                for ss in range(nstokes):
+                    if ss not in self._returndict['summaryminor'][ff][cc]:
+                        self._returndict['summaryminor'][ff][cc][ss] = dict()
 
+                    self._returndict['summaryminor'][ff][cc][ss] = self.fill_summary_minor(cc, ss, stokes_axis, freq_axis, fullsummary)
 
 
-    def constructResidualDict(self, paramList):
+    def construct_residual_dict(self, paramList):
         """
         Construct the residual dictionary given the input image name and associated parameters. This residual dictionary is meant to
         duplicate that generated by imager.getSummary(fullsummary) for the special
         case of niter = 0 to avoid initializing the deconvolver.
 
         Inputs:
         paramList   The tclean inputs, defaults where not specified. dict
 
         Returns:
-        retrec      The return dictionary with imaging statistics. dict
+        returndict  The return dictionary with imaging statistics. dict
         """
 
         imagename = paramList.allimpars['0']['imagename']
 
         self.residname = imagename+'.residual.tt0' if(os.path.exists(imagename +'.residual.tt0')) else imagename +'.residual'
         do_summary_minor = True
         # Only fill summaryminor if the residual image exists
         if not os.path.exists(self.residname):
             do_summary_minor = False
             #raise FileNotFoundError(f'{residname} does not exist on disk. Cannot construct tclean return dictionary.')
 
         # Initialize the values that don't need to inspect any images
-        self.retrec['cleanstate'] = 'running'
-        self.retrec['cyclefactor'] = paramList.getAllPars()['cyclefactor']
-        self.retrec['cycleiterdone'] = 0
-        self.retrec['cycleniter'] = 0
-        self.retrec['cyclethreshold'] = 0
-        self.retrec['interactiveiterdone'] = 0
-        self.retrec['interactivemode'] = paramList.alldecpars['0']['interactive']
-        self.retrec['interactiveniter'] = 0
-        self.retrec['interactivethreshold'] = 0
-
-        self.retrec['iterdone'] = 0
-        self.retrec['loopgain'] = 0
-        self.retrec['maxpsffraction'] = 0
-        self.retrec['maxpsfsidelobe'] = 0
-        self.retrec['minpsffraction'] = 0
-
-        self.retrec['niter'] = 0
-        self.retrec['nmajordone'] = 1
-        self.retrec['nsigma'] = 0.0
+        self._returndict['cleanstate'] = 'running'
+        self._returndict['cyclefactor'] = paramList.getAllPars()['cyclefactor']
+        self._returndict['cycleiterdone'] = 0
+        self._returndict['cycleniter'] = 0
+        self._returndict['cyclethreshold'] = 0
+        self._returndict['interactiveiterdone'] = 0
+        self._returndict['interactivemode'] = paramList.alldecpars['0']['interactive']
+        self._returndict['interactiveniter'] = 0
+        self._returndict['interactivethreshold'] = 0
+
+        self._returndict['iterdone'] = 0
+        self._returndict['loopgain'] = 0
+        self._returndict['maxpsffraction'] = 0
+        self._returndict['maxpsfsidelobe'] = 0
+        self._returndict['minpsffraction'] = 0
+
+        self._returndict['niter'] = 0
+        self._returndict['nmajordone'] = 1
+        self._returndict['nsigma'] = 0.0
         # stopcode 3 --> Zero iterations performed
-        self.retrec['stopcode'] = 3
+        self._returndict['stopcode'] = 3
 
-        self.retrec['summarymajor'] = np.array([0,])
+        self._returndict['summarymajor'] = np.array([0,])
 
         if do_summary_minor:
-            self.retrec['summaryminor'] = self.constructSummaryMinor(paramList)
-        else:
-            self.retrec['summaryminor'] = {}
+            self.construct_summary_minor(paramList)
 
-        self.retrec['threshold'] = 0.0
-        self.retrec['stopDescription'] = 'Zero iterations performed'
+        self._returndict['threshold'] = paramList.getAllPars()['threshold']
+        self._returndict['stopDescription'] = 'Zero iterations performed'
 
 
-        return self.retrec
+        return self._returndict
```

## casatasks/private/imagerhelpers/input_parameters.py

```diff
@@ -31,350 +31,341 @@
 """
 
 
 ######################################################
 ######################################################
 ######################################################
 
-
-
-class ImagerParameters:
-    def __init__(
-        self,
-        ## Data Selection
-        msname="",
-        field="",
-        spw="",
-        timestr="",
-        uvdist="",
-        antenna="",
-        scan="",
-        obs="",
-        state="",
-        datacolumn="corrected",
-        ## Image Definition
-        imagename="",
-        imsize=[1, 1],
-        cell=[10.0, 10.0],
-        phasecenter="",
-        stokes="I",
-        projection="SIN",
-        startmodel="",
-        ## Spectral Parameters
-        specmode="mfs",
-        reffreq="",
-        nchan=1,
-        start="",
-        width="",
-        outframe="LSRK",
-        veltype="radio",
-        restfreq=[""],
-        sysvel="",
-        sysvelframe="",
-        interpolation="nearest",
-        perchanweightdensity=False,
-        gridder="standard",
-        #                 ftmachine='gridft',
-        facets=1,
-        chanchunks=1,
-        wprojplanes=1,
-        vptable="",
-        usepointing=False,
-        mosweight=False,
-        aterm=True,
-        psterm=True,
-        mterm=True,
-        wbawp=True,
-        cfcache="",
-        dopbcorr=True,
-        conjbeams=True,
-        computepastep=360.0,
-        rotatepastep=360.0,
-        pointingoffsetsigdev=[30.0, 30.0],
-        pblimit=0.01,
-        normtype="flatnoise",
-        psfcutoff=0.35,
-        outlierfile="",
-        restart=True,
-        weighting="natural",
-        robust=0.5,
-        noise="0.0Jy",
-        npixels=0,
-        uvtaper=[],
-        niter=0,
-        cycleniter=0,
-        loopgain=0.1,
-        threshold="0.0Jy",
-        nsigma=0.0,
-        cyclefactor=1.0,
-        minpsffraction=0.1,
-        maxpsffraction=0.8,
-        interactive=False,
-        fullsummary=False,
-        nmajor=-1,
-        deconvolver="hogbom",
-        scales=[],
-        nterms=1,
-        scalebias=0.0,
-        restoringbeam=[],
-        #                 mtype='default',
-        usemask="user",
-        mask="",
-        pbmask=0.0,
-        maskthreshold="",
-        maskresolution="",
-        nmask=0,
-        #                 autoadjust=False,
-        sidelobethreshold=5.0,
-        noisethreshold=3.0,
-        lownoisethreshold=3.0,
-        negativethreshold=0.0,
-        smoothfactor=1.0,
-        minbeamfrac=0.3,
-        cutthreshold=0.01,
-        growiterations=100,
-        dogrowprune=True,
-        minpercentchange=0.0,
-        verbose=False,
-        fastnoise=True,
-        fusedthreshold=0.0,
-        largestscale=-1,
-        #                 usescratch=True,
-        #                 readonly=True,
-        savemodel="none",
-        parallel=False,
-        workdir="",
-        ## CFCache params
-        cflist=[],
-        ## single-dish imaging params
-        gridfunction="SF",
-        convsupport=-1,
-        truncate="-1",
-        gwidth="-1",
-        jwidth="-1",
-        pointingcolumntouse="direction",
-        minweight=0.0,
-        clipminmax=False,
-    ):
+class ImagerParameters():
+    def __init__(self,
+            # Input Data: what gets in
+            msname='',
+
+            # Output Data: what goes out
+            imagename='',
+
+
+            # The remaining parameters are Control Parameters:
+            # they control How what gets in goes out
+
+            ## Data Selection
+            field='',
+            spw='',
+            timestr='',
+            uvdist='',
+            antenna='',
+            scan='',
+            obs='',
+            state='',
+            datacolumn='corrected',
+            ## Image Definition
+            imsize=[1,1],
+            cell=[10.0,10.0],
+            phasecenter='',
+            stokes='I',
+            projection='SIN',
+            startmodel='',
+            ## Spectral Parameters
+            specmode='mfs',
+            reffreq='',
+            nchan=1,
+            start='',
+            width='',
+            outframe='LSRK',
+            veltype='radio',
+            restfreq=[''],
+            sysvel='',
+            sysvelframe='',
+            interpolation='nearest',
+            perchanweightdensity=False,
+            gridder="standard",
+            # ftmachine='gridft',
+            facets=1,
+            chanchunks=1,
+
+            wprojplanes=1,
+
+            vptable="",
+            usepointing=False,
+            mosweight=False,
+            aterm=True,
+            psterm=True,
+            mterm=True,
+            wbawp = True,
+            cfcache = "",
+            dopbcorr = True,
+            conjbeams = True,
+            computepastep =360.0,
+            rotatepastep =360.0,
+            pointingoffsetsigdev = [30.0,30.0],
+                 
+            pblimit=0.01,
+            normtype='flatnoise',
+                 
+            psfcutoff=0.35,
+
+            outlierfile='',
+            restart=True,
+
+            weighting='natural',
+            robust=0.5,
+            noise='0.0Jy',
+            npixels=0,
+            uvtaper=[],
+
+            niter=0,
+            cycleniter=0,
+            loopgain=0.1,
+            threshold='0.0Jy',
+            nsigma=0.0,
+            cyclefactor=1.0,
+            minpsffraction=0.1,
+            maxpsffraction=0.8,
+            interactive=False,
+            fullsummary=False,
+            nmajor=-1,
+
+            deconvolver='hogbom',
+            scales=[],
+            nterms=1,
+            scalebias=0.0,
+            restoringbeam=[],
+            # mtype='default',
+
+            usemask='user',
+            mask='',
+            pbmask=0.0,
+            maskthreshold='',
+            maskresolution='',
+            nmask=0,
+            # autoadjust=False,
+
+            sidelobethreshold=5.0,
+            noisethreshold=3.0,
+            lownoisethreshold=3.0,
+            negativethreshold=0.0,
+            smoothfactor=1.0,
+            minbeamfrac=0.3,
+            cutthreshold=0.01,
+            growiterations=100,
+            dogrowprune=True,
+            minpercentchange=0.0,
+            verbose=False,
+            fastnoise=True,
+            fusedthreshold=0.0,
+            largestscale=-1,
+
+            # usescratch=True,
+            # readonly=True,
+            savemodel="none",
+            parallel=False,
+
+            workdir='',
+
+            ## CFCache params
+            cflist=[],
+                 
+            ## single-dish imaging params
+            gridfunction='SF',
+            convsupport=-1,
+            truncate="-1",
+            gwidth="-1",
+            jwidth="-1",
+            pointingcolumntouse='direction',
+            convertfirst='never',
+            minweight=0.0,
+            clipminmax=False
+        ):
         self.allparameters = dict(locals())
-        ############TESTOO for debugging Felipe's crash
-        # params_str=pprint.pformat(self.allparameters)
-        # casalog.post('ALLPARAMS : ' + params_str, 'WARN', 'CAS-9386-DEBUG')
-        ################################################
-        del self.allparameters["self"]
+        del self.allparameters['self']
+
         self.defaultKey = "0"
-        ## Selection params. For multiple MSs, all are lists.
-        ## For multiple nodes, the selection parameters are modified inside PySynthesisImager
+        # ---- Selection params. For multiple MSs, all are lists.
+        # For multiple nodes, the selection parameters are modified inside PySynthesisImager
         self.allselpars = {
-            "msname": msname,
-            "field": field,
-            "spw": spw,
-            "scan": scan,
-            "timestr": timestr,
-            "uvdist": uvdist,
-            "antenna": antenna,
-            "obs": obs,
-            "state": state,
-            "datacolumn": datacolumn,
-            "savemodel": savemodel,
+            'msname':msname, 'field':field, 'spw':spw, 'scan':scan,
+            'timestr':timestr, 'uvdist':uvdist, 'antenna':antenna, 'obs':obs,'state':state,
+            'datacolumn':datacolumn,
+            'savemodel':savemodel
         }
-        #                           'usescratch':usescratch, 'readonly':readonly}
-
-        ## Imaging/deconvolution parameters
-        ## The outermost dictionary index is image field.
-        ## The '0' or main field's parameters come from the task parameters
-        ## The outlier '1', '2', ....  parameters come from the outlier file
+        # ---- Imaging/deconvolution parameters
+        # The outermost dictionary index is image field.
+        # The '0' or main field's parameters come from the task parameters
+        # The outlier '1', '2', ....  parameters come from the outlier file
         self.outlierfile = outlierfile
-        ## Initialize the parameter lists with the 'main' or '0' field's parameters
-        ######### Image definition
+        # Initialize the parameter lists with the 'main' or '0' field's parameters
+        # ---- Image definition
         self.allimpars = {
             self.defaultKey: {
-                "imagename": imagename,
-                "nchan": nchan,
-                "imsize": imsize,
-                "cell": cell,
-                "phasecenter": phasecenter,
-                "stokes": stokes,
-                "specmode": specmode,
-                "start": start,
-                "width": width,
-                "veltype": veltype,
-                "nterms": nterms,
-                "restfreq": restfreq,
-                "outframe": outframe,
-                "reffreq": reffreq,
-                "sysvel": sysvel,
-                "sysvelframe": sysvelframe,
-                "projection": projection,
-                "restart": restart,
-                "startmodel": startmodel,
-                "deconvolver": deconvolver,
+                # Image
+                'imagename': imagename,
+                'nchan': nchan,
+                'imsize': imsize,
+                'cell': cell,
+                'phasecenter': phasecenter,
+                'stokes': stokes,
+                # Frequency axis
+                'specmode': specmode,
+                'start': start,
+                'width': width,
+                'veltype': veltype,
+                'nterms': nterms,
+                'restfreq': restfreq,
+                # Output frame
+                'outframe': outframe,
+                'reffreq': reffreq,
+                'sysvel': sysvel,
+                'sysvelframe': sysvelframe,
+                # Projection
+                'projection': projection,
+                # Deconvolution
+                'restart': restart,
+                'startmodel': startmodel,
+                'deconvolver': deconvolver
             }
         }
-        ######### Gridding
+        # ---- Gridding
         self.allgridpars = {
             self.defaultKey: {
-                "gridder": gridder,
-                "aterm": aterm,
-                "psterm": psterm,
-                "mterm": mterm,
-                "wbawp": wbawp,
-                "cfcache": cfcache,
-                "usepointing": usepointing,
-                "dopbcorr": dopbcorr,
-                "conjbeams": conjbeams,
-                "computepastep": computepastep,
-                "rotatepastep": rotatepastep,  #'mtype':mtype, # 'weightlimit':weightlimit,
-                "pointingoffsetsigdev": pointingoffsetsigdev,
-                "facets": facets,
-                "chanchunks": chanchunks,
-                "interpolation": interpolation,
-                "wprojplanes": wprojplanes,
-                "deconvolver": deconvolver,
-                "vptable": vptable,
-                ## single-dish specific
-                "convfunc": gridfunction,
-                "convsupport": convsupport,
-                "truncate": truncate,
-                "gwidth": gwidth,
-                "jwidth": jwidth,
-                "minweight": minweight,
-                "clipminmax": clipminmax,
-                "imagename": imagename,
+                'gridder': gridder,
+                # aterm group
+                'aterm': aterm,
+                'psterm': psterm,
+                'mterm': mterm,
+                'wbawp': wbawp,
+                # cfcache group
+                'cfcache': cfcache,
+                'usepointing': usepointing,
+                'dopbcorr': dopbcorr,
+                # conjbeams group
+                'conjbeams': conjbeams,
+                'computepastep': computepastep,
+                #
+                'rotatepastep': rotatepastep, #'mtype':mtype, # 'weightlimit':weightlimit,
+                'pointingoffsetsigdev': pointingoffsetsigdev,
+                # facets group
+                'facets': facets,
+                'chanchunks': chanchunks,
+                # interpolation group
+                'interpolation': interpolation,
+                'wprojplanes': wprojplanes,
+                # deconvolver group
+                'deconvolver': deconvolver,
+                'vptable': vptable,
+                'imagename': imagename,
+                # single-dish specific parameters
+                # ---- spatial coordinates
+                'pointingcolumntouse': pointingcolumntouse,
+                'convertfirst': convertfirst,
+                # ---- convolution function
+                'convfunc': gridfunction,
+                'convsupport': convsupport,
+                # ---- truncate group
+                'truncate': truncate,
+                'gwidth': gwidth,
+                'jwidth': jwidth,
+                # ---- minweight group
+                'minweight': minweight,
+                'clipminmax': clipminmax
             }
         }
-        ######### weighting
-        rmode = "none"
-        if weighting == "briggsabs":
-            rmode = "abs"
-            weighting = "briggs"
-        elif weighting == "briggs":
-            rmode = "norm"
-        elif weighting == "briggsbwtaper":
-            rmode = "bwtaper"
-            weighting = "briggs"
-        self.weightpars = {
-            "type": weighting,
-            "rmode": rmode,
-            "robust": robust,
-            "noise": noise,
-            "npixels": npixels,
-            "uvtaper": uvtaper,
-            "multifield": mosweight,
-            "usecubebriggs": perchanweightdensity,
-        }
-
-        ######### Normalizers ( this is where flat noise, flat sky rules will go... )
+        # ---- Weighting
+        if True: # Compute rmode and self.weightpars
+            rmode = 'none'
+            if (weighting == 'briggsabs'):
+                rmode = 'abs'
+                weighting = 'briggs'
+            elif (weighting == 'briggs'):
+                rmode = 'norm'
+            elif (weighting == 'briggsbwtaper'):
+                rmode = 'bwtaper'
+                weighting = 'briggs'
+
+            self.weightpars = {
+                'type': weighting,
+                'rmode': rmode,
+                'robust': robust,
+                'noise': noise,
+                'npixels': npixels,
+                'uvtaper': uvtaper,
+                'multifield': mosweight,
+                'usecubebriggs': perchanweightdensity
+            }
+        # ---- Normalizers ( this is where flat noise, flat sky rules will go... )
         self.allnormpars = {
-            self.defaultKey: {  #'mtype': mtype,
-                "pblimit": pblimit,
-                "nterms": nterms,
-                "facets": facets,
-                "normtype": normtype,
-                "workdir": workdir,
-                "deconvolver": deconvolver,
-                "imagename": imagename,
-                "restoringbeam": restoringbeam,
-                "psfcutoff": psfcutoff,
+            self.defaultKey : {
+                # pblimit group
+                'pblimit': pblimit,
+                'nterms': nterms,
+                'facets': facets,
+                # normtype group
+                'normtype': normtype,
+                'workdir': workdir,
+                # deconvolver group
+                'deconvolver': deconvolver,
+                'imagename': imagename,
+                'restoringbeam': restoringbeam,
+                'psfcutoff': psfcutoff
             }
         }
-
-        ######### Deconvolution
-
+        # ---- Deconvolution
         self.alldecpars = {
             self.defaultKey: {
-                "id": 0,
-                "deconvolver": deconvolver,
-                "nterms": nterms,
-                "scales": scales,
-                "scalebias": scalebias,
-                "restoringbeam": restoringbeam,
-                "usemask": usemask,
-                "mask": mask,
-                "pbmask": pbmask,
-                "maskthreshold": maskthreshold,
-                "maskresolution": maskresolution,
-                "nmask": nmask,
+                'id':0, 'deconvolver':deconvolver, 'nterms':nterms,
+                'scales':scales, 'scalebias':scalebias, 'restoringbeam':restoringbeam, 'usemask':usemask,
+                'mask':mask, 'pbmask':pbmask, 'maskthreshold':maskthreshold,
+                'maskresolution':maskresolution, 'nmask':nmask,
                 #'maskresolution':maskresolution, 'nmask':nmask,'autoadjust':autoadjust,
-                "sidelobethreshold": sidelobethreshold,
-                "noisethreshold": noisethreshold,
-                "lownoisethreshold": lownoisethreshold,
-                "negativethreshold": negativethreshold,
-                "smoothfactor": smoothfactor,
-                "fusedthreshold": fusedthreshold,
-                "specmode": specmode,
-                "largestscale": largestscale,
-                "minbeamfrac": minbeamfrac,
-                "cutthreshold": cutthreshold,
-                "growiterations": growiterations,
-                "dogrowprune": dogrowprune,
-                "minpercentchange": minpercentchange,
-                "verbose": verbose,
-                "fastnoise": fastnoise,
-                "interactive": interactive,
-                "startmodel": startmodel,
-                "nsigma": nsigma,
-                "imagename": imagename,
-                "fullsummary": fullsummary,
+                'sidelobethreshold':sidelobethreshold, 'noisethreshold':noisethreshold,
+                'lownoisethreshold':lownoisethreshold, 'negativethreshold':negativethreshold,'smoothfactor':smoothfactor,
+                'fusedthreshold':fusedthreshold, 'specmode':specmode,'largestscale':largestscale,
+
+                'minbeamfrac':minbeamfrac, 'cutthreshold':cutthreshold, 'growiterations':growiterations,
+                 'dogrowprune':dogrowprune, 'minpercentchange':minpercentchange, 'verbose':verbose, 'fastnoise':fastnoise,
+                'interactive':interactive, 'startmodel':startmodel, 'nsigma':nsigma,  'imagename':imagename, 'fullsummary':fullsummary
             }
         }
-
-        ######### Iteration control.
+        # ---- Iteration control
         self.iterpars = {
-            "niter": niter,
-            "cycleniter": cycleniter,
-            "threshold": threshold,
-            "loopgain": loopgain,
-            "interactive": interactive,
-            "cyclefactor": cyclefactor,
-            "minpsffraction": minpsffraction,
-            "maxpsffraction": maxpsffraction,
-            "savemodel": savemodel,
-            "nsigma": nsigma,
-            "nmajor": nmajor,
-            "fullsummary": fullsummary,
+            'niter':niter, 'cycleniter':cycleniter, 'threshold':threshold,
+            'loopgain':loopgain, 'interactive':interactive,
+            'cyclefactor':cyclefactor, 'minpsffraction':minpsffraction,
+            'maxpsffraction':maxpsffraction,
+            'savemodel':savemodel,'nsigma':nsigma, 'nmajor':nmajor, 'fullsummary':fullsummary
         }
-
-        ######### CFCache params.
-        self.cfcachepars = {"cflist": cflist}
-
-        ######### parameters that may be internally modified for savemodel behavior
+        # ---- CFCache params
+        self.cfcachepars = {
+            'cflist': cflist
+        }
+        # ---- Parameters that may be internally modified for savemodel behavior
         self.inpars = {
-            "savemodel": savemodel,
-            "interactive": interactive,
-            "nsigma": nsigma,
-            "usemask": usemask,
+            'savemodel': savemodel,
+            'interactive': interactive,
+            'nsigma': nsigma,
+            'usemask': usemask
         }
-
-        # self.reusename=reuse
-
-        ## List of supported parameters in outlier files.
-        ## All other parameters will default to the global values.
+        # ---- List of supported parameters in outlier files.
+        # All other parameters will default to the global values.
         self.outimparlist = [
-            "imagename",
-            "nchan",
-            "imsize",
-            "cell",
-            "phasecenter",
-            "startmodel",
-            "start",
-            "width",
-            "nterms",
-            "reffreq",
-            "specmode",
+            'imagename','nchan','imsize','cell','phasecenter','startmodel',
+            'start','width',
+            'nterms','reffreq','specmode'
         ]
-        self.outgridparlist = ["gridder", "deconvolver", "wprojplanes"]
+        self.outgridparlist = ['gridder','deconvolver','wprojplanes']
         self.outweightparlist = []
-        self.outdecparlist = ["deconvolver", "startmodel", "nterms", "usemask", "mask"]
-        self.outnormparlist = ["deconvolver", "weightlimit", "nterms"]
-        #        self.outnormparlist=['imagename','mtype','weightlimit','nterms']
+        self.outdecparlist = [
+            'deconvolver','startmodel','nterms','usemask','mask'
+        ]
+        self.outnormparlist = ['deconvolver','weightlimit','nterms']
 
         ret = self.checkParameters(parallel)
         if ret == False:
-            casalog.post("Found errors in input parameters. Please check.", "WARN")
+            casalog.post(
+                'Found errors in input parameters. Please check.', 'WARN'
+            )
 
         self.printParameters()
 
     def resetParameters(self):
         """reset parameters to the original settting for interactive, nsigma, auto-multithresh when savemodel!='none'"""
         if self.inpars["savemodel"] != "none" and (
             self.inpars["interactive"] == True
@@ -568,18 +559,23 @@
 
             selkeys = self.allselpars.keys()
 
             # Convert all non-list parameters into lists.
             for par in selkeys:
                 if type(self.allselpars[par]) != list:
                     self.allselpars[par] = [self.allselpars[par]]
-
+                    
             # Check that all are the same length as nvis
             # If not, and if they're single, replicate them nvis times
             nvis = len(self.allselpars["msname"])
+
+            if nvis==0:
+                errs = errs + "Input MS list is empty"
+                return errs
+            
             for par in selkeys:
                 if len(self.allselpars[par]) > 1 and len(self.allselpars[par]) != nvis:
                     errs = (
                         errs
                         + str(par)
                         + " must have a single entry, or "
                         + str(nvis)
@@ -602,15 +598,14 @@
                 synu = synthesisutils()
                 selparlist["ms" + str(ms)] = synu.checkselectionparams(
                     selparlist["ms" + str(ms)]
                 )
                 synu.done()
 
             # casalog.post(selparlist)
-
             self.allselpars = selparlist
 
         return errs
 
     def makeImagingParamLists(self, parallel):
         errs = ""
         # casalog.post("specmode=",self.allimpars['0']['specmode'], " parallel=",parallel)
```

## Comparing `casatasks-6.6.3.22.dist-info/METADATA` & `casatasks-6.6.4.34.dist-info/METADATA`

 * *Files 24% similar despite different names*

```diff
@@ -1,19 +1,19 @@
 Metadata-Version: 2.1
 Name: casatasks
-Version: 6.6.3.22
+Version: 6.6.4.34
 Summary: the CASA tasks
 Home-page: https://open-bitbucket.nrao.edu/projects/CASA/repos/casatools/browse
 Download-URL: https://casa.nrao.edu/download/
 Author: CASA development team
-Author-email: aips2-request@nrao.edu
+Author-email: casa-feedback@nrao.edu
 Maintainer: Darrell Schiebel
 Maintainer-email: drs@nrao.edu
 License: GNU Library or Lesser General Public License (LGPL)
 Classifier: Programming Language :: Python :: 3.8
-Requires-Dist: casatools ==6.6.3.22
+Requires-Dist: casatools ==6.6.4.34
 Requires-Dist: matplotlib
 Requires-Dist: scipy
 Requires-Dist: certifi
 
 The CASAtasks are a collection of (mostly) stateless functions for
 the analysis of radio astronomy observations.
```

## Comparing `casatasks-6.6.3.22.dist-info/RECORD` & `casatasks-6.6.4.34.dist-info/RECORD`

 * *Files 2% similar despite different names*

```diff
@@ -1,41 +1,41 @@
 casatasks/LICENSE.txt,sha256=IEfzsTvSd8f8JBZn3LoATY_RkNKJnAyr2p020oPTVfQ,25454
-casatasks/__init__.py,sha256=DuvXVe_M-Qn5qVNsiH2FLbKebd1YRpy098UY4q3mHyQ,16293
+casatasks/__init__.py,sha256=KZUXkv396WDwzLxIPJDaK_R-CA7OF4ijVJsoOHbAtY4,16440
 casatasks/__main__.py,sha256=7rsnskXVXyq9-0I3gGsbhi-JqQ5bXSaMTYwgOQ2LsQE,113
 casatasks/accor.py,sha256=SbQFOYbrRESijYQOSb9WXybANbBHAEH7-hHGxdSIWzQ,17968
 casatasks/apparentsens.py,sha256=7Q-orRySCCz6SoTs3ay8bnXmlFyUBu7GsW2TWOnEW7A,23332
 casatasks/applycal.py,sha256=OEBqb2p1trT1bUArr6W3_wSVwoNrn0nNIMJ1E2BU-Ok,16748
 casatasks/asdmsummary.py,sha256=1SR-EZPkW85JEOROS30EuzTBAyt0rWV7QLXU-yMvbLs,2321
-casatasks/bandpass.py,sha256=RYRoTUyJcODnipe2ipLmAX_7KrBjJaja78VhDrZu4B8,24748
+casatasks/bandpass.py,sha256=hh1rQfx1S2fIX7wZqodk-fJeyY7JCuk3-3cPwY0zAlM,24747
 casatasks/blcal.py,sha256=SbD-lpyCCIMFm0XuRia9_GJGVfZITqd-i1NN4CteuvU,16533
 casatasks/calstat.py,sha256=dtMOSEfqh7HL_HUxDxeHNjd9kD0TahourXO7SfU2qLs,3218
 casatasks/clearcal.py,sha256=bjBNR3Txjp7a0Ecn2eVfITl1vqkeRFlSnsLf-1sZ_mg,5159
 casatasks/clearstat.py,sha256=BFOMtCzHYDRKzFRl7LiWgp0n4GHouXx3vYs0przXiJw,1810
 casatasks/concat.py,sha256=v8pL10ivcw_2QIGo2-ssOWZ3laGebw3jsQ5p6vmtZl0,9828
-casatasks/config.py,sha256=IndIMIP62cXiSvoD8WpmgITREk77X9VbdJ81MLoNqsI,508
 casatasks/conjugatevis.py,sha256=Hj7FIFl4ijpcInQE99a602SOQUbZJ0UU9eFjef1MWDQ,2974
 casatasks/cvel.py,sha256=tXKJIi7CWzy5D2VQXqB3z_aXVcE74NerYHOFi6NvzgU,16406
 casatasks/cvel2.py,sha256=Nvzcx9pbmRoCfa7tgC8uCEDOVr-1PNtWyjmh3fTmtdM,22234
 casatasks/deconvolve.py,sha256=gLGzsi3jf5W7n9_p3kQq6WED0EKK_YJ92B262lIs-4w,41733
 casatasks/defintent.py,sha256=27jtUciQ0yOSNcJga_tDV5LzrbApOgxeP1Wa8MXoNDM,3220
 casatasks/delmod.py,sha256=MzLBxIe97WVMbiJIyp6pY6uaA0RSOAY3TViLIxSdaME,3647
 casatasks/exportasdm.py,sha256=qXPine9zELdQZKL77ISMZi8L6sMEwQ4XEqGkL9H_aBQ,5523
 casatasks/exportfits.py,sha256=ErI19fw7qNQKeUFUFjVU7aBplyxl0wh_k4wCZ8I2klc,5227
 casatasks/exportuvfits.py,sha256=nYuhvQhxoLiP4f-blgmscqybZwlYyAN6YcwbTCJAAbk,10973
 casatasks/feather.py,sha256=XoYXKxbmuuUCJ5Z0JbzN6QOtLVsMZEqU6-XxR3_7r4o,4550
-casatasks/fixplanets.py,sha256=e26SwKS-lULSWW1HSM2EP87RPIqm6JFjpm1A_RYYWoc,5573
+casatasks/fixplanets.py,sha256=4EHXcnTVF6s39Xo9TM1vJdY-mP-dgfObsfz6tRU-86U,5548
 casatasks/fixvis.py,sha256=gg7feINITLkw-i3Ffh5ngm9FdbMukRzYepR_zB0JmA0,6244
 casatasks/flagcmd.py,sha256=XBqnaQPp-b2Z1syDW2fUTkOyvD_SC0hhOytJbSyzNkg,15005
-casatasks/flagdata.py,sha256=Mfk-mABnwZrGQUpCFVE6q-bzYDDnnoXA7AqpJC3hRLI,81550
+casatasks/flagdata.py,sha256=ZCsR7jk_mtgQCN1wcB8Ga2vhf7nLhXBN5-AJKJgMeQw,81748
 casatasks/flagmanager.py,sha256=kHWJcyv_hu6y0Qg50wrJL7jd6eW1PJEuVgUCzlNqVkw,4961
 casatasks/fluxscale.py,sha256=flEothOK6JyhaPtXEFbT8ecNtL3wol7QSrdL6SU3pIM,11512
 casatasks/fringefit.py,sha256=roSnEY6QJQenU_SKRh4vfmARVSphutuAXvPEPZyWd_M,16061
 casatasks/ft.py,sha256=7kzCOepzA0ZvYT6tOMlKwqZnun5-Zwb7I4X8_1ByutQ,6119
-casatasks/gaincal.py,sha256=TF7ACnc7cCYAktHQcBK-nEwDOyAa_b7FHhlI0UvdISU,26164
+casatasks/gaincal.py,sha256=83-4rmPCxE4fd16iQo0HZGRo7QoLuJghzm7mOMAX3Xs,26968
 casatasks/gencal.py,sha256=-eoaSngS_y7gBwQ9Ev9-w2VrvTkbrx2Va05vvd7itmw,14448
+casatasks/getantposalma.py,sha256=aLunQAEnQKWIq8dDxC7dc2X1CpuIH9xlAsXf3nr00i4,5391
 casatasks/getcalmodvla.py,sha256=wLxaaELQNpton5qfloRa0pZ6xL0fAWtAAq2mAIV7yz0,5524
 casatasks/getephemtable.py,sha256=-qn3bVEk_9SfUUobkNuZ_Csml97mHvMIf8gH9Qwi7uI,6935
 casatasks/hanningsmooth.py,sha256=Frd3yLdcsm5fGDtoCY1YbFnqVDvgoehrh0heQdIpFjM,13082
 casatasks/imbaseline.py,sha256=tK24IBwbK-mIkrmbK3IcqzJoI_sxGy7KKFXXphOCkqw,8648
 casatasks/imcollapse.py,sha256=gywI2OuzNPwwyCwVKQfupHZH4NzgRAOsMrnRwTnZ9QA,7157
 casatasks/imcontsub.py,sha256=QgqmYvM-BVhKdYPCRXWB7ak4MroNIpJxlo2Jpd1CK3I,4496
 casatasks/imdev.py,sha256=YKFcShiAZEOJUiCUIzEBR4uIyMP_EQCbf3nFwRPc0xo,11906
@@ -56,15 +56,15 @@
 casatasks/importuvfits.py,sha256=yJqIg9m1iwhnYOor9CBtYt-b_QpQy9MkFE4D1G6JlQk,3264
 casatasks/importvla.py,sha256=Pq_mLhuX1_ib3XYxFLL1Gq5FZo6-x3ZM4YIrFXgRrx8,7707
 casatasks/impv.py,sha256=BJ7kvqblfdbTtkubriJBTncHc63tlY9kDyRTTuheeNw,14346
 casatasks/imrebin.py,sha256=CU0Ca-x9qOuHq6XT6yz9_f0O3s67qhLw38bmnS3nhkM,7955
 casatasks/imreframe.py,sha256=CH2q-eZZeJUyp_O8XBkwXcJzTSrS7mWRf9SYOwTrB6o,3652
 casatasks/imregrid.py,sha256=JybbDs9tB0c5wl_ySigmnbV0A_enVMWO1HPwenn_2lE,23379
 casatasks/imsmooth.py,sha256=sIvM-Ifz2XcJOUVaG2UsoXw-1TLXJpPv3ZzSStflyQQ,13825
-casatasks/imstat.py,sha256=BsEVVu5FIOeVYJWIzN8DcbxoZjxl1GvD7Nr8D_vp9vM,23313
+casatasks/imstat.py,sha256=zOjnWm96hyda7DPoCzsqvBYNwafCobh4hfiXkB3EAbQ,6858
 casatasks/imsubimage.py,sha256=h69w6-KMw-VmP2rBPvbGuEoclmwZh0-_sDhsWTUOkhI,7940
 casatasks/imtrans.py,sha256=MnPJFe-Z3M1uBPE7IDjkkEFHbVtsMYBDA8OH33AjJZ8,5072
 casatasks/imval.py,sha256=gbam0L-_mPcz0Rom1k3DBtD2iV1HRpxPHcDrpu89rU0,7072
 casatasks/initweights.py,sha256=nYaofgU6lvAxntnAa5XQWaph8XAwGMSWBkGpoPvfjpI,7647
 casatasks/listcal.py,sha256=FDFOyQFlFbAvgEyevhHZ1ZfidHAHsrNIzV1P80ydNgU,15729
 casatasks/listfits.py,sha256=FhNTJtToVLK1asplTw9M7-orV2LaiSMAfmOXBj9S65s,2119
 casatasks/listhistory.py,sha256=FZiLpoopgYyD1eu17r031P0L-dfdTyd49o75MUX-1GY,2146
@@ -79,15 +79,15 @@
 casatasks/partition.py,sha256=DPp_8sPKakgLSLcLA2C4mqAglqLwCmOujpkx4q9F1Xk,17491
 casatasks/phaseshift.py,sha256=x8YUpHwBNRrWxhZuJa_dxxdnl1ibuGkbEPpw9o0yrPA,8285
 casatasks/plotants.py,sha256=nDr1uR0uRPXMbQWuD9YevUvKFeHE0iueW6J1ZlS85xI,5125
 casatasks/plotbandpass.py,sha256=pSXmkIxdV2k0rtFvY0Lz-S2U8KJ4zV81wUw4DqpHxGQ,21488
 casatasks/plotprofilemap.py,sha256=93ITXCvqeOjOtIqkV-u_sQnT_-julTbQ_SjaibUBMfM,9852
 casatasks/plotweather.py,sha256=bCBVqUtZJJ6D_4QBlhN2w8pTDrspwZwQU2gNPui7D0I,3426
 casatasks/polcal.py,sha256=5QMcJjs5wKCKU4EIQzELczQXxF0iy2vl-_wtqEYQZmA,19753
-casatasks/polfromgain.py,sha256=GsvinOFZmQwfOIMH6LGQZ7c9E_hvaRczWL8UiFtoXnE,2939
+casatasks/polfromgain.py,sha256=NgnXCHu-6mSxdHLV8Gz_B47o_6SUSahlPwid5zbVOfM,3513
 casatasks/predictcomp.py,sha256=AMY2kGHSEj0tDpRRtQhNAOuH87iXucs96jxx5Mx8KL4,7751
 casatasks/rerefant.py,sha256=6o6pDDc_0DctOFpel5D1xOZO7LiSbUz3Yd7tJ3Ki_PA,3498
 casatasks/rmfit.py,sha256=UccyLpxijPgESbklBQWWaqi632AB0qznHZjdIz-WhOY,9112
 casatasks/rmtables.py,sha256=g3JCOaUeQY4B_GNaUjzAGYwOIP9xuY6kbSY_Wu1f618,2150
 casatasks/sdatmcor.py,sha256=QzCYIDDHPcB7E0FaOjfMXyIakTr94Sh-bAXnclr97LU,21991
 casatasks/sdbaseline.py,sha256=sjrexfrXWLC1CiDRXyeURhgGTJsIFqWQeJh9xwOjgHY,31250
 casatasks/sdcal.py,sha256=H3RTixSzBXtHDibjl0sP1t2vrDk8zBm1czV7TbawMXU,19333
@@ -96,43 +96,43 @@
 casatasks/sdgaincal.py,sha256=12_R5Dp06jy0ur5pC7nHDvUEhyKvuoViCkitnmkgd80,11865
 casatasks/sdimaging.py,sha256=gyIWeEU6-e1Y6nRZ6coe4ijWJMuOCoyQL1DZnLQCnC0,26023
 casatasks/sdintimaging.py,sha256=9VoHZZtfFY4D4WO-a8LwoyxPgYHYuxkdCtj1ymPE4Yw,137389
 casatasks/sdpolaverage.py,sha256=WmF6j80SKuheIVn8aLxgs7x02-NAvl9BowJTlsEVUSw,7142
 casatasks/sdsidebandsplit.py,sha256=Er1-wFxWxtI5uSKERTTEK466d8bmvhac7wEQhQaWBFU,6005
 casatasks/sdsmooth.py,sha256=Ce5Ftl9G6P7fRNSQfw-AG7wg5yqvie7oWp5Cro7Fn6I,8198
 casatasks/sdtimeaverage.py,sha256=nJ26eSlN3-_ma34ulQ9M8BXQrND5rdWXihurz0tJc5U,6695
-casatasks/setjy.py,sha256=By77mgZ_AHkEi6eBE0dPESH4e1ndK90OaHZGeivMANo,25528
+casatasks/setjy.py,sha256=ZK5DKQ8NUAqrbMZthZbRdz3w1w5811Mr-LU8zSr0Vjs,25528
 casatasks/simalma.py,sha256=0LSo39H4dy_AOtQhe0EL5fF1Ld7w4bBa4i7aMTA-tqs,17825
 casatasks/simanalyze.py,sha256=6nQEbn0D25PcfVwbfvzHd9R-EKVl_gX0hax7nRUKxRU,18119
-casatasks/simobserve.py,sha256=gRcc57WUggkRTo7RuPNaiuNOq4rqcHSjxNKNxnREu_s,24900
+casatasks/simobserve.py,sha256=g8ohND0XewrIlmlIJPC182UrCo4gaURqVfzzzgyNVnw,25022
 casatasks/slsearch.py,sha256=aaKSCktY3Ccp5zezZByElUp5Bt3r1FmRZearcryIAjY,7914
 casatasks/smoothcal.py,sha256=lxUOrxbLhtwimCG2DyvSylw03vMd5-agqhJNRXASuFc,4158
 casatasks/specfit.py,sha256=nj-VzJAgIeMg_USt8YXRAVNyrer8I43y-T_VAJLh4Qs,45036
 casatasks/specflux.py,sha256=Xmi2WbCCl88fZ5jHRPLgavuMqWxEyK_GJCRmH1Vnmuw,8346
 casatasks/specsmooth.py,sha256=XfF5HQTswOUOvF3t5hyoobsXx-Kz7pn3nQnI0qgioek,12698
 casatasks/splattotable.py,sha256=GI7uKX391rYFzPXtMND0qxmyDsL6ifQ0Ao-9Cp4hHuM,2668
 casatasks/split.py,sha256=Ac3AwbL65vOtJVks2IZqVZ4lIQYb6muw56cryOly9Ac,17789
 casatasks/spxfit.py,sha256=WDGIz4D007d7W17fNleq8z1jyXz2YFsJxeZo2N-5fnM,20825
 casatasks/statwt.py,sha256=bm4OG3BudfULjx5rScsbSZqDMe_A2nns9FiC6fXfz6s,19586
-casatasks/tclean.py,sha256=24gp0Ysot33d1fw4madND8LjQ445WsnX5ng03Arbm3I,156502
+casatasks/tclean.py,sha256=plJYrgnPt7woNOg8kIXJPx0IpgWWv0Q-XbtFAhEkwoI,162808
 casatasks/testconcat.py,sha256=2jJOEDKlCFsMH8bnkzkQ7ecFa20PrUtd0ViXKxGUEBE,4525
-casatasks/tsdimaging.py,sha256=DrOkC3EpUX8QPKNt33ESEKnN7WssjWJvkJydxmdYbKI,28544
+casatasks/tsdimaging.py,sha256=vyt5WLklK-7q1TAe8x18kBgwDLXCvsuNZfX-MTYVgOk,29246
 casatasks/uvcontsub.py,sha256=ABDYe-iA9x9YCUkpQL92WeZuW3ChpFqdEKQfDJ60woE,12446
 casatasks/uvcontsub_old.py,sha256=0gJsj79XQ_VQ7fr3L0AU8BMp96RHixHzOl45o2NtRBM,8459
 casatasks/uvmodelfit.py,sha256=ttIbN_0oxgmrfr7URPEcBaGlqaHVCW0-aaFCWjw52YA,8868
 casatasks/uvsub.py,sha256=BYsXTeWNYn4KGElYy5t5Lhqps376BBUed6r5KpXJz0M,3274
 casatasks/virtualconcat.py,sha256=VFf8p5RuwC6MESbDnfxYmFBs45zqsDBRP8kRguZyZVs,7919
 casatasks/vishead.py,sha256=SNqvjY4NWMofoEpCwbtaPtCU7BtCPR_fjjB0R2uQL8M,4604
 casatasks/visstat.py,sha256=NyFpiy8ryK5gUO-W9kul6-CTBLcW64M8QKy7kNGNKRw,13732
-casatasks/widebandpbcor.py,sha256=6-DlhllRctyAYPprLg9laRyQmH6IK73kkQ84FwMHv1c,11196
+casatasks/widebandpbcor.py,sha256=LfZnzek4PAmSEpF552lj2-3oaTbr2nBb1kO26VDsa30,11197
 casatasks/__xml__/accor.xml,sha256=k3o9a9VDTQiW0PtNrw2W7tMzpvEdSRg85UpULas9PFM,19110
 casatasks/__xml__/apparentsens.xml,sha256=btZpZswDDPmaFq1FTTfbY9NMNdJ5xHlcdF586jL5VWE,24415
 casatasks/__xml__/applycal.xml,sha256=yyNrIOWGR107XZaRH8YA1uUcrG8JjYzhAczSLLhlTbU,18506
 casatasks/__xml__/asdmsummary.xml,sha256=ZiMg3vWuRkHGrSR-7PnB1sePeg6BMgjIWcPP080LSq0,1212
-casatasks/__xml__/bandpass.xml,sha256=0mhi1XvzlX61wfGcISUbWjJ0RQ6FZmOzKl68Uy0gDxA,27442
+casatasks/__xml__/bandpass.xml,sha256=4C3hod_534ml-fVdA_jeTTBJUxBrNK5La4vCDVQFF9I,27441
 casatasks/__xml__/blcal.xml,sha256=SmXuXesxeZpwWGolJMUsBT7cVJYk1z0bBvlQLTb5Z74,17253
 casatasks/__xml__/calstat.xml,sha256=yDAt1UmuXw4zmvJ9XiL-xVnkzGVi5r3AjmLBzuwaT60,3102
 casatasks/__xml__/clearcal.xml,sha256=VjiX3Dwsos2a7ICVBr1N46bwy47PsXEyfMjoFbqqmvc,4500
 casatasks/__xml__/clearstat.xml,sha256=D6Fzckz_JfYmipZ8N24XBWNy3fxPLxwP6McA_lowxjs,908
 casatasks/__xml__/concat.xml,sha256=QAgCDb4W-hV6t6QotDzkAN0vIFfv17OGumjZqK8143k,7682
 casatasks/__xml__/conjugatevis.xml,sha256=DjDzgUHH6eTSV6QPRWWT1gKsadPte_8Vn8iR-3blh0E,1872
 casatasks/__xml__/cvel.xml,sha256=4He0V7qluyM2a4rY4gpAplt1c0Fp5Cvem5GzxksfTpw,22439
@@ -140,24 +140,25 @@
 casatasks/__xml__/deconvolve.xml,sha256=bPnyOKTuVduPTzE5bivR3eZ2cEg-XXucsggQFMFy7eQ,45787
 casatasks/__xml__/defintent.xml,sha256=l_-9fnjOeCz4S-iWLN7i1j4rA5snMTTXp_Ua2qMkXMU,2324
 casatasks/__xml__/delmod.xml,sha256=K6tUD2o1tazD9yfbTDJpn0to9AQqs3arbM0J6K2sDZM,3230
 casatasks/__xml__/exportasdm.xml,sha256=fi1KqLnfCY_2AW_hr3yvkai0h3jBCi5lloxnUkVqq3g,4256
 casatasks/__xml__/exportfits.xml,sha256=8VUxiXkuBg3NBH9arHg_qvKi-5OJzv4h_8vrlWQhICU,4677
 casatasks/__xml__/exportuvfits.xml,sha256=TQzO4hTFQyvu0lLptWr23_WRGa4qFf3OiHuBYTdSDdU,10459
 casatasks/__xml__/feather.xml,sha256=uD5N7ISOKhHOE0W-JUSKGpcsHq18kTzW4jSQX9iLK2c,3473
-casatasks/__xml__/fixplanets.xml,sha256=W71pYDG2jI2oHuhoXzMFCQookld6zXJcQk7dXGKISW0,4855
+casatasks/__xml__/fixplanets.xml,sha256=Me7Yzv5mcWRtFsA6Jfvr4zh6R--k7tGTlaafHns2Eng,4830
 casatasks/__xml__/fixvis.xml,sha256=8WQ60JSWsqHWg9CCB-RmWZGFdCP4b8TOD0YGmTLGzDg,5552
 casatasks/__xml__/flagcmd.xml,sha256=Pi4vf7n-RCPuGg97kdRd5mHkiQ9jmqF_Fw01MV0A_YQ,18382
-casatasks/__xml__/flagdata.xml,sha256=3DijwQ2WGtGNX7wosCxyxbQsWx9io12Iv001jLJNjfk,95087
+casatasks/__xml__/flagdata.xml,sha256=7za0THon5TEgGVCeD-hYLxsbPYRwXYnlgiTivJTXoKE,95277
 casatasks/__xml__/flagmanager.xml,sha256=DImZ2J20TNAk3pVN056G5jTNlv2E5MnufuNMvfKet1k,6491
 casatasks/__xml__/fluxscale.xml,sha256=TAjONXkgqbK83ROg89f25FcECPz6eqR6i668xsUwVLQ,10724
 casatasks/__xml__/fringefit.xml,sha256=Z5eshTGNKln6x6c8FCQ6QmAGGolE04Wjsv12GjXC1CY,16831
 casatasks/__xml__/ft.xml,sha256=x7kmUzA1NQWu9DqfnG9IWNFk8voPT9uORpC5U0Z26fQ,5634
-casatasks/__xml__/gaincal.xml,sha256=8l7Nxkxt0NtI6VbaOSVMaOGo0kiInmeJ1VUt_-SOWuU,27911
+casatasks/__xml__/gaincal.xml,sha256=6GTFTX6sAQALIvMxhO5nwaQmVFuR_FChqsdRGwATdJc,28720
 casatasks/__xml__/gencal.xml,sha256=sJH5Lwf-2Z6MzMhN4fQyj0gsVpQ8okxFV-uEgWRqsqA,13559
+casatasks/__xml__/getantposalma.xml,sha256=BiByt5JbUS-so61YDX02iMIo1bWC73tSTrk67baL7mM,4693
 casatasks/__xml__/getcalmodvla.xml,sha256=8demQ99uiS4oJlJCXN0-q-pPbLPdcnwOlQvdJbpfXCs,6003
 casatasks/__xml__/getephemtable.xml,sha256=NXPKo3gD17EvgGYf9iSG9A483PNtL0xsEqqy2SwgpSs,5989
 casatasks/__xml__/hanningsmooth.xml,sha256=AXVJbbGNQRNzODzGOP_2UBf77UcBLrXKWDIxyVh7_jw,11212
 casatasks/__xml__/imbaseline.xml,sha256=DJflKDNg3SAv1PivmSY4yiyBpi1slXeN1VijijoXMT4,13796
 casatasks/__xml__/imcollapse.xml,sha256=leentdteWQsgEGHNmJr1qzsaKRkRMcWpHzYGGfbgJpI,7612
 casatasks/__xml__/imcontsub.xml,sha256=NP7rB_I0wY2zXDQBaGnt7jlHqr-gAgLe1ut5Xs8X5Is,3670
 casatasks/__xml__/imdev.xml,sha256=e__aQO41EaVe5Qt3LCYgGVzmEpMi-xVKyowCccizvyo,13467
@@ -178,15 +179,15 @@
 casatasks/__xml__/importuvfits.xml,sha256=t5UEtcEYzqCOtz3HUEyYZR-YTmnCGWkHYGYU2I45hNE,2519
 casatasks/__xml__/importvla.xml,sha256=Q0S2JidusxZ4WbJn_9iP6rRhvCGyqiAozzFz7bBuRfA,7348
 casatasks/__xml__/impv.xml,sha256=AvFersLgbOW_onAqQyQ0PpIrSIvvhJqczqa3oz8Cbqc,16810
 casatasks/__xml__/imrebin.xml,sha256=OkvaKuQqrxdBNBXoAZFcHhtseREq8TYekOeAyHkgjow,7929
 casatasks/__xml__/imreframe.xml,sha256=7U1ob-nJ0dYsHgTx0TQtgd30G_UpemtSv82DaoNYuWE,3944
 casatasks/__xml__/imregrid.xml,sha256=h7_h4SJ-_Bl8d2tqg6p8tKt6Aiut2EOo8xASgir6-m0,23404
 casatasks/__xml__/imsmooth.xml,sha256=2zwQ6EVwjsOm5v2qPJS2Ej9N76Iti0c5UqTWIYdKrjc,18483
-casatasks/__xml__/imstat.xml,sha256=XTKLU7YJm7JDmZgBNfDHtzyeHOKjefTfZrbSRkcweZc,27026
+casatasks/__xml__/imstat.xml,sha256=nMKsrCCauCGl6w9ZhwnBiKhJxbCYOZb7POkRoBpnDaQ,10189
 casatasks/__xml__/imsubimage.xml,sha256=RGK8i9wQAdOnkJlSbdnb6vh6wgA-RiZZFVQtKq4dATs,8616
 casatasks/__xml__/imtrans.xml,sha256=ECIyO1G8nkv6KJgsqQswfp44kJglTvk5kRcqeJa8Qrc,4369
 casatasks/__xml__/imval.xml,sha256=nwqtZ29aASEH2sj4DZQXKiYP1aM0EdW5itmkRmtzWZM,8783
 casatasks/__xml__/initweights.xml,sha256=aqwC043fGV-2QwpnO090_BrAGChzksm-TfyNn8PuLL8,8420
 casatasks/__xml__/listcal.xml,sha256=1qIqmMmkyEmshE96hFo8Gal9m2Dtd_jUxUjPE0nLhJ0,14649
 casatasks/__xml__/listfits.xml,sha256=1x7sYS8AfrkT0XG69KkPoK2C9u8DOVm6hqeyGIeGJP8,1052
 casatasks/__xml__/listhistory.xml,sha256=L5NTwOeN90HBbJyc8EcPuDbSMyp337Bc3VdCsqJbOnI,1109
@@ -201,15 +202,15 @@
 casatasks/__xml__/partition.xml,sha256=PC9p16tgA0TZ_uptqsqXcwah_yNL3vcDxpsohHRfnVU,18609
 casatasks/__xml__/phaseshift.xml,sha256=Mrz1kKfCdBZ7Qc7jJAnn8Tthsu8I-6o7-dP7YBGoMP0,8196
 casatasks/__xml__/plotants.xml,sha256=qlurS5V3gk4nskztOpr6megTmdjGkOyi33ZI3gYhbGM,4535
 casatasks/__xml__/plotbandpass.xml,sha256=tV2qdo9eU7tDhwgEkSEkD-BovylpF5NBWblBkV6deDg,25797
 casatasks/__xml__/plotprofilemap.xml,sha256=Jt5-eHCLrboroSfKd_1TA1qJ6b2NiYwjqoSWO6gvYJI,10498
 casatasks/__xml__/plotweather.xml,sha256=Pb_3CUi-tLUieYXgslTay2rex-yMGCbNF3kyr8PUThc,2117
 casatasks/__xml__/polcal.xml,sha256=7lRxUJDKeTl5ySb7mHHddQi63oNdLc_pG_JP8nS9HME,24515
-casatasks/__xml__/polfromgain.xml,sha256=R_3L1a0EanwfD-uZisIJeaJoKYzN7qKnjaHA5pntAd8,2217
+casatasks/__xml__/polfromgain.xml,sha256=3L7a10BCAVCdwA7aRYXY0ijKODrM79YO1HQ2bXK5AWM,2756
 casatasks/__xml__/predictcomp.xml,sha256=f_GFkcQEKaDUcp5KAbVamtV8vmsqZbdybj0_rScSOQQ,8056
 casatasks/__xml__/rerefant.xml,sha256=XcEZbA5BbKBkc23Skeg4J6QZKTEtZkbXpAVMHOGBTpA,3130
 casatasks/__xml__/rmfit.xml,sha256=gldf41cgWKKUCdxocoTTsq0WvVtQHU7r4lTCqW5Hwd0,8856
 casatasks/__xml__/rmtables.xml,sha256=lxE2qNk-zK9uSviMqqi4VlAzFs3I6hT4vyc8oHZic2k,1092
 casatasks/__xml__/sdatmcor.xml,sha256=U-4tLf81Vyy70TVztBEZAKILmAAVKgQ3-QWlGCxE-p4,22215
 casatasks/__xml__/sdbaseline.xml,sha256=YhjC9Nxz0QyYY4yljwGuF1SMcXJ0_VYWMX9c_X03bTA,39080
 casatasks/__xml__/sdcal.xml,sha256=Go5QRVfuU6pwclLoGqrnnPSLFKH9L0zZbcWy_ZmMC64,24856
@@ -218,62 +219,61 @@
 casatasks/__xml__/sdgaincal.xml,sha256=EG8kMwHkBuLA24KJRNT5jizsofeklX_MZMDrRn2btBE,13345
 casatasks/__xml__/sdimaging.xml,sha256=SMWB8zE_vruGbF5egO0wYBsk6n1xqeq9--1xgh2wPfs,34312
 casatasks/__xml__/sdintimaging.xml,sha256=Qvp0s9qBDs76nIvi_j9bD8BJqUMbgB07Jeo7j1SWhb0,137940
 casatasks/__xml__/sdpolaverage.xml,sha256=42TvJlHSEuQ79r167aHbN-QtuKlrujW3mnN0aoMRYuI,6997
 casatasks/__xml__/sdsidebandsplit.xml,sha256=pnokWjQzXE-yonSdEfVT2yXSjNP3OVRlKzOfx8vf_PY,5486
 casatasks/__xml__/sdsmooth.xml,sha256=akmu0khXCB7Aq7YSneFCa5Y2GYaMJFAJ4xBo9_o-tU4,8750
 casatasks/__xml__/sdtimeaverage.xml,sha256=0lAl5zgCnfLCadEZ05T9HP3kSfOcihyX9DApl6DQvhw,6558
-casatasks/__xml__/setjy.xml,sha256=DjczElWh1VsFJcr_CIZgdzxq-JhpLUkc6wsvrMX9PlQ,29486
+casatasks/__xml__/setjy.xml,sha256=mrK6opWSlAgDHFzXPQ9od_J97M8ECdklczJS-6sxrQQ,29486
 casatasks/__xml__/simalma.xml,sha256=QJVBYkzyv5ixq4SVP-_qbUS9o1zCIvFxc_J4oJNB-UM,21078
 casatasks/__xml__/simanalyze.xml,sha256=4rTG4eCoSKikUOCk3O4JWinSo1GFbrw5GfL5smUmtsU,20059
-casatasks/__xml__/simobserve.xml,sha256=7Oar-0NGY1FaQxq0dYESzAC5Kw2eEQRbBTYzWAPFtKs,27983
+casatasks/__xml__/simobserve.xml,sha256=7Cnyz4fbRvkXzJJSu8OStAXs73bczNf2JUYBoWD6oKQ,28064
 casatasks/__xml__/slsearch.xml,sha256=EKPK7MoQrGE2e4zW4sDXWhdby1m3sNrBOz4wtCOv_ME,8822
 casatasks/__xml__/smoothcal.xml,sha256=UNlTNcUJX4WG_WpI1CqSl3GFzalAyKT8pTB0AXxUKpY,3703
 casatasks/__xml__/specfit.xml,sha256=ZYTjW8yjRk76V7x8w1lsjh-CPoiXuvqwdXDmM-YPatk,50753
 casatasks/__xml__/specflux.xml,sha256=WDbEMV0fk_YhZysHSaUcDpvhmHBgjDJWQDwQZ7SogS4,9280
 casatasks/__xml__/specsmooth.xml,sha256=dryqo4jC0dISgarlPz4FxWkM0NiAuO1cl-bgqu9EW08,13365
 casatasks/__xml__/splattotable.xml,sha256=UkdmmKY7lR2h3kQg4AP61rKu4gV6YP45g5Q6stYadAk,1665
 casatasks/__xml__/split.xml,sha256=uV8JAyfMZuVualsdaYE--JXxGgAdb7zCLB3VaNb1Tzk,16305
 casatasks/__xml__/spxfit.xml,sha256=UA8bnqvPJFAAU0XCc971octem6zSjjfP6O3ZtgSOBSw,23161
 casatasks/__xml__/statwt.xml,sha256=rCwAQp8BwaxzZONQuBvmsDS4s5f-DdDK3PxbqKv3Uso,25373
-casatasks/__xml__/tclean.xml,sha256=gD5auTTviezQ3MlgbR2oQFzlb9piEsA_g7aLmw-FvWk,158742
+casatasks/__xml__/tclean.xml,sha256=MOl0EXm6Ff-rYTsDten7lupWSMG2pqrY9mOnVzKMbAU,165282
 casatasks/__xml__/testconcat.xml,sha256=eiMfzKsY3XKys9QhIdxFfnffT2_gFa--x42PCyXhDuk,3036
-casatasks/__xml__/tsdimaging.xml,sha256=kUsz7FIDR8jV35hTNU1VdIgevE-Vu_D7rp3dTsvQTV8,37942
+casatasks/__xml__/tsdimaging.xml,sha256=EBOCWQPnj-6QUWkqaVe_0vZYOGeHMv-EJlNzelhflwQ,39815
 casatasks/__xml__/uvcontsub.xml,sha256=V2y29nx3Okq0JYc8OwtN6P9wbCVDJbvhznm-gV5gAmo,11503
 casatasks/__xml__/uvcontsub_old.xml,sha256=lAbPLEZ6iHO6wYgBcHjMkPxkd76mx73vxGXI5QDHmdE,9142
 casatasks/__xml__/uvmodelfit.xml,sha256=MrC_-l5MRvvbHfxwnV3wlIO41H76eSUe5RYO8F4oK28,9466
 casatasks/__xml__/uvsub.xml,sha256=Ekvs4FtbNTgL8t1POZy4Qfyd6txUe2JcvDYVok_-9Ys,2617
 casatasks/__xml__/virtualconcat.xml,sha256=ei6mqgFbbVZ5cYbLbdUQINm79DGTB8kYiS8p8IjfR7U,7100
 casatasks/__xml__/vishead.xml,sha256=TjPvsliq-UfpATzExPR2R_MACdy7UyKo2K-sjYu1K44,7282
 casatasks/__xml__/visstat.xml,sha256=RApasy6S7oI4ewMkhc3tSkLpbgfQvNiaABMsaTVhQdw,18657
-casatasks/__xml__/widebandpbcor.xml,sha256=Ec-0k1avooZ7lVrxu2qDXknX5M14Z-iYwMauP1IOp9g,12321
-casatasks/private/JPLephem_reader2.py,sha256=Uf8veL4Ym44A7_TE7zv8ps8vkTDF982rtbPbFKAWCek,46388
+casatasks/__xml__/widebandpbcor.xml,sha256=VSkdKpg0HBKQNzDLuGVELkHSwUReyUnapQXfWw0gDcc,12322
 casatasks/private/callabletask.py,sha256=wTpzPm_H8zIB6YQiTpQSEWdnjUyYG-9nQWu37SAyTXU,1162
 casatasks/private/callibrary.py,sha256=6H33E-MuArWFdJJQFkvCvkMbd8M_SdKBRwamWhg9fI4,14227
 casatasks/private/casa_transition.py,sha256=Ui2r1AQLXmw3WeYZSn3HnzwHB2fYTuQNWVbJAucVa6E,239
 casatasks/private/casaxmlutil.py,sha256=7ojFCCj9x9OdxQSTvxJplWgVEln7YVT3oXD2yz6_-Nw,14657
 casatasks/private/cleanhelper.py,sha256=XPFcyXK9uSqk1xoAQJDChsuxZGiY1v6P6wWI1vcK1zI,157097
 casatasks/private/concatephem.py,sha256=JA95WHFmExVjMUfuQQOFr1V86Cc7lkR4iOUunSd2Yzs,13276
 casatasks/private/convertephem.py,sha256=opaeq4N8suhhs0WFsoc20tv1Di33e6lbF1qbgD3xemY,8093
 casatasks/private/correct_ant_posns.py,sha256=r5PX_K41yylMOS3PwskPgDlBT4jqLVP7Q_MucpoXanw,2677
 casatasks/private/correct_ant_posns_alma.py,sha256=MK5CzeDxaWqKvWpAfdAeIWSWZTg-s7WbcE2IYfuYYqw,26457
 casatasks/private/correct_ant_posns_evla.py,sha256=nLXrTaOH4hV0lPQHNkgmyx3kkTn8nyG2LeCds1PqBoY,8909
 casatasks/private/cvt.py,sha256=7-ZAZ3Jfe8QO6sSujF9BVeaN5JTpCC93pO5X673Giz0,235
-casatasks/private/flaghelper.py,sha256=jrtasaQPNr221uexq129nICwiDZlrZkC63CtYaQbno8,157940
+casatasks/private/flaghelper.py,sha256=NZHqQPRUUjJpJOaIgg9aEOMmAukeRcsFv2SrhO4RMg8,158105
 casatasks/private/ialib.py,sha256=EzKnlYELv2W4_JWLZljlyCXK4-5MjtV8K-IHmSOjv0U,4083
 casatasks/private/imtools.py,sha256=-JamL8bmshaqme6ht1pzuuCGcWJxrywt3xp-ZIaVStM,1445
-casatasks/private/jplhorizons_query.py,sha256=mja9sHmNdLO3bljNeYz520_B7_AeTESp1z2DnklV75Y,33735
+casatasks/private/jplhorizons_query.py,sha256=NvYIKV1Crv95f9f6Og8Y0DGsEnOBsyXmMKIPPWoJZ_g,34142
 casatasks/private/jyperk.py,sha256=PQMGA7KFUhKmP3FKKYFlhPWcUUuErRJszSXdFf7i2ls,28074
 casatasks/private/mslisthelper.py,sha256=CdnN4CZI6o_xCICNBH1z4KpHBGZm6CVig7OLNx_kO6s,15085
 casatasks/private/mstools.py,sha256=-GVoxX77oJhhAu5fckfqMj06Zy7L2G0po8W37Dx9xcI,3997
 casatasks/private/partitionhelper.py,sha256=vHkG3UkHiyCax8N3OQM2QVxcovdF7XLsO3bqQuKfTzk,47244
 casatasks/private/predictcomp_helper.py,sha256=1B3QryOmD3V7g86Ulg-Zh2RothYqVRsjQkYCCeGknBU,3874
 casatasks/private/sdbeamutil.py,sha256=2dypQQApF4snYI5VuPYAb3raPgiq9IX_EgkSEadWcgM,34733
-casatasks/private/sdint_helper.py,sha256=EHv-NSj974V3Pn-_d42l6DRRKJMDQd5qrYLpX1jsLv4,37380
-casatasks/private/sdutil.py,sha256=L_Vfbrd0aCPysqJr2QT3tjfOxDZhKsCNVMg4pudNFYM,29985
+casatasks/private/sdint_helper.py,sha256=10guUQz0ttrI8rHcK6JclyDKk3HapfB-YUJUTVMeGGI,39129
+casatasks/private/sdutil.py,sha256=vqurDf9Qbsm7UjzeyjFclKjJ_yTkHtsOl8AZ1VK46v4,30639
 casatasks/private/setjy_helper.py,sha256=8LCBH4y06QQJkNrZvrcrbO2eUTRe7Z9vN45-HUdm2K8,39120
 casatasks/private/simutil.py,sha256=fj8JA4llTDYDtRye1wQFZ4cOcggheumVVeBTG_Oilv4,158147
 casatasks/private/solar_system_setjy.py,sha256=gpFZ9D8y5_4AXUWUUy5M2OmGnHJkLzVCvoqd4KLCbb0,30058
 casatasks/private/task_accor.py,sha256=HaSZ-sA0IeVcrnwioFEUYg-6LkyLwUAmWDgd2XGhcAY,5196
 casatasks/private/task_apparentsens.py,sha256=ZFY6nc9oKVJudpiWZWw6uDk3Ko4wKPGWtJ1nhgMSGqY,2815
 casatasks/private/task_applycal.py,sha256=7AoXoJirKoCq4qovt60Qpdvl27yx3aNqCnURiuZpRyc,8689
 casatasks/private/task_asdmsummary.py,sha256=m0xRf91Uvk53jfca4DPjJoc-8OXrZAQhmXch2pznVvM,655
@@ -282,62 +282,63 @@
 casatasks/private/task_calstat.py,sha256=_nu1CubWwT8D5a30rU4I0Xl7WHi51nhCmX-YgA21qlc,2545
 casatasks/private/task_clearcal.py,sha256=L2K09kyrrcA6RpF6mliziHvUuwz1QYTcbrqovimpwyg,2444
 casatasks/private/task_clearstat.py,sha256=8jLlmMyZFciBbLW61fgZi9zfXEAL5Iw8BBRGsbxadEA,400
 casatasks/private/task_concat.py,sha256=Qxsj93pubYYdHV0QrXGMuF7xlzwKxZkA4tOhlIHI0cI,24590
 casatasks/private/task_conjugatevis.py,sha256=Y7qQ0iG_JPi-ps_UG2EgfXMfsMOywhrnRpRMNtTo3XE,4476
 casatasks/private/task_cvel.py,sha256=OPteZEomwTJ1ElDztqiRRsowgM0eYX6OIHLMGTkfh8k,26240
 casatasks/private/task_cvel2.py,sha256=_ep4sgTFQ2mH0_NrX5yjuL-77MqZE0gd48D88BagakE,4820
-casatasks/private/task_deconvolve.py,sha256=E0cqRrvvqh-N7sBfO60MzaP8Gq1hrvEn6-dBU_lHnuU,12952
+casatasks/private/task_deconvolve.py,sha256=naVti8aiQjKWXKmR4xGBPDdezfk66OnTFo3NoZtGuZQ,13359
 casatasks/private/task_defintent.py,sha256=UAKBUFdro-KMKSIcmdZayxSwvNlHBu5W2vG7jiiSA3A,7916
 casatasks/private/task_delmod.py,sha256=GkXJcAxfpqQCG7F1t_inxw3M3zGf4tnGaX4YvC6S9B4,1926
 casatasks/private/task_exportasdm.py,sha256=0KZQFHO3eaoT051KA_CFptrtYJ41wMyMiTnolWZmubE,10251
 casatasks/private/task_exportfits.py,sha256=4gK0IBSEIfqjw2Qyt0IuFEEpNWBObhwMYSoldlGw56g,2476
 casatasks/private/task_exportuvfits.py,sha256=OXetEQaXSUlbBTbDqQFyfK7Qj6rx1effoMQiIsrg2nI,1073
 casatasks/private/task_feather.py,sha256=Mx4J8k-RrxtVEvERbaZY-SvABqUw6WHtYxqE5D3KmOE,1928
-casatasks/private/task_fixplanets.py,sha256=wOx6YKT9fMhaRnESkT34pqPKrcD-n-9YtMk7al9aysk,24616
+casatasks/private/task_fixplanets.py,sha256=opYnnX8OeRXUPWnNdVmEYZsg5vl3q_BmBxrI26UGW1A,24318
 casatasks/private/task_fixvis.py,sha256=n-_rUFM-XKATVlqD6FgUPXbaeWeqWx9gSraTFFgCaQ4,22449
 casatasks/private/task_flagcmd.py,sha256=_Z70wS44jSvqhXSNhTzxJcFRwwMx9i_M_Dz3DooeNHA,68570
-casatasks/private/task_flagdata.py,sha256=WkmRtSk1t-teuTvu006eBwG3zF9dUSJcozqWL6QII2M,30925
+casatasks/private/task_flagdata.py,sha256=QgG06Z-DJmMu4iSnflEsRxRO8ONDT_zw5oz5XGLAVp0,30948
 casatasks/private/task_flagmanager.py,sha256=6Fpvwlb9aGYiuv3q-oT58yzpveQryJtjH_WX6dxry5s,5127
 casatasks/private/task_fluxscale.py,sha256=szIfPYZ0xpjFd50hgaYHKIjo-yxi_qcZcEYhlm4YxKI,10752
 casatasks/private/task_fringefit.py,sha256=pTDvelX2FYtPsrilNMJ-VYJEkpa7iSLBaLtcR6vwDN8,5833
 casatasks/private/task_ft.py,sha256=dvhr7hayRe74Ga_YehanPF55QZ2uqtWhUjyrRTU7_tI,6598
 casatasks/private/task_gaincal.py,sha256=C5Jrsgh0kD_zo8LKNvGrPeg4sHtBgwuPzpr_3Zc2ibA,8273
 casatasks/private/task_gencal.py,sha256=3Kn_r4R6g8JYW3tMYfKkOv07AUIGTQvaBAJ_DqWRIQ8,9241
+casatasks/private/task_getantposalma.py,sha256=KKq3b2IWbWYHl3xaB_lsFnvItIlZup7ev2gnYYlvP6A,12056
 casatasks/private/task_getcalmodvla.py,sha256=2G9lrkFSTFoEgMkrelyLJbctkSWXrTHH4bEEEJxeUUM,12010
 casatasks/private/task_getephemtable.py,sha256=5tsTaJbxDhEX6fSRI5B0RdHaiMuXT2tUbtKWd-OKshE,4400
 casatasks/private/task_hanningsmooth.py,sha256=qPNHRjY4s4zewZVyBSbWEZW0lNsAZHXIGDNdBHKXwbE,3917
 casatasks/private/task_imbaseline.py,sha256=6XsA8s2HZLf3BdzV8VIC1CLJHw3inUrwc0oEswaWc0Y,113942
-casatasks/private/task_imcollapse.py,sha256=Dsz_q_-a7t_1TS521pHa9oNHRIUerK0_sifo2jtqkZM,3917
+casatasks/private/task_imcollapse.py,sha256=hXEoPq1kZ8UXEncdrxaPnacuCAZT2G5ieYj7r5hIpco,3917
 casatasks/private/task_imcontsub.py,sha256=fBAQ4QTv9aAKTgxCSLKPHem-s0isaX4vdszHs4prIik,3170
 casatasks/private/task_imdev.py,sha256=9bbZ1vAtqwDnPhbU4t1wMC3M_7-HKY-l4bSkt3F_fq0,1960
 casatasks/private/task_imfit.py,sha256=VJc9uAjI89XKy8lwnhN5tdw-P47WHcQzBU7qSu7SRbU,2007
-casatasks/private/task_imhead.py,sha256=OlLM_595_Kalu1zs9f0et5iDC8fl5KEAP329IgFBVEM,5505
+casatasks/private/task_imhead.py,sha256=swaz4p5XozHq3JyVXqLTXi6u0WP8JqEGTVOz-6MuOAg,5505
 casatasks/private/task_imhistory.py,sha256=G0iW8-8xT9HBtZyt1FU8qWI4mbhb_NCNoUfaVpOl-V4,693
-casatasks/private/task_immath.py,sha256=FAiuHU1Zk9sJZCkbX_lXNl0H-0-dtcSLT4A6OATp9F4,24322
-casatasks/private/task_immoments.py,sha256=Ztc-cxIYm0xG5kYKFhyklbwVGDT-nQP8La25bV9wioU,6718
-casatasks/private/task_impbcor.py,sha256=HjSvwJmh_S-RNjyl2GE7_VvcxGlw-lgWOGhB4GKfZO4,3692
+casatasks/private/task_immath.py,sha256=YtawfnTEQTeaSBbz0Uec5Zsxcvqc-T0eWkm9gXukWCg,24322
+casatasks/private/task_immoments.py,sha256=omd1ofvbyYEJuZHBTEQVAFt2r3Sk0mRBkivfz4GCVps,6718
+casatasks/private/task_impbcor.py,sha256=MkdezUYNTN37deMP_B7Y5iHqUkmvpzHtLvmRF_tQp4o,3692
 casatasks/private/task_importasap.py,sha256=durxPQiX8sT1Mnyb9O6yLtlKA97Ycvp7wH1T-MNFydk,2655
 casatasks/private/task_importasdm.py,sha256=2NDY-n1FLrU9ByyPbQgvF24pKV2n5NdA_8uR4wDt1dM,25554
 casatasks/private/task_importatca.py,sha256=MQkscXrxNvamq4Kc5C2tcEPgbUO0I4VQI23B3_Mx8LQ,4090
 casatasks/private/task_importfits.py,sha256=UhUQHkXjrr20PLf8Q1O4qDdiUxluKzEhPVJi7bkIqkA,9482
 casatasks/private/task_importfitsidi.py,sha256=kGUkgIRl142IN-fUesrVSC_juUJ3_gjtRPAICXmf6Y4,7537
-casatasks/private/task_importgmrt.py,sha256=9LsIk1tVYev3DX1vfmWALM0Y1tvPfw3iAoxTD70vaKw,15107
+casatasks/private/task_importgmrt.py,sha256=9KZwaCJHWW0a34qDgWgvyN3PNILEsHfw2CXGRGZOHrM,15107
 casatasks/private/task_importmiriad.py,sha256=K1JybZwG3KVk6nFOmbXXvFTpSnGO1aJMT291pzAxfbk,2867
 casatasks/private/task_importnro.py,sha256=-i0j8d4pHr1Y3uEdqlfZ4SZnU0iZb3fpOh62JKlY8Uc,2166
 casatasks/private/task_importuvfits.py,sha256=2JP0IGvWjReHn14i0qF2YVPPzNkGDQL7Qa87BhteEJc,2028
 casatasks/private/task_importvla.py,sha256=MaIFUkEmf-CijLbVpTvDEI9Lxj2nho0U-tEarg0EAnk,3142
 casatasks/private/task_impv.py,sha256=4kOj0_LhzK70UvhNqjm6YzaMHb5rlDrurjwiT2LuJIk,2540
 casatasks/private/task_imrebin.py,sha256=y4aq8adbtqs8w3LqAb5EOgmaRDVFavWmjIRYLPgRvJA,2506
 casatasks/private/task_imreframe.py,sha256=TmpkuPTQO2bWmJwK5vJuNhHVAz6E_JeBkFz8drjU6nY,2814
 casatasks/private/task_imregrid.py,sha256=8mSTYuFqOyhzNfeT31RCVZAZmMsF18eSIBGfixOHYis,14755
-casatasks/private/task_imsmooth.py,sha256=ONn2RnK4NgLwXzKGkeex82GTewBGjVVtuxtwBwSUOoM,7833
+casatasks/private/task_imsmooth.py,sha256=eVuLUiqxwg7uS0a5em3gdt9A2E95bRhcAJtsPLwqHc8,7833
 casatasks/private/task_imstat.py,sha256=0YvpVGwTbWjqo4ZoUyrPjuMPf4uuJy7-iGBKznkR6LE,1289
 casatasks/private/task_imsubimage.py,sha256=v6AHgnOT_8gO9OdcoQPtpkeefkCBeH76H-I1ZBmnSsY,2134
-casatasks/private/task_imtrans.py,sha256=yypHq3eVfGQVgBRP2QgdCWgA9pmCR7skhZMprno_r6M,3321
+casatasks/private/task_imtrans.py,sha256=4l923cOoggxnmZwvrLXNT_9lSk4DR7ogvW1m_IwkiIY,3321
 casatasks/private/task_imval.py,sha256=ELHYMSafEngCKSjWyaqh2zAuKgmgl-mLKkCrVQcRP0k,14494
 casatasks/private/task_initweights.py,sha256=ga8PPYjdvwKfpiqLLakXbOAjTQLBKEUSp8uU8UUtWhQ,3365
 casatasks/private/task_listcal.py,sha256=ecytL5hNz-AVDpmwMXIQRaUL8b5kus9JiUHsoQOLyGo,984
 casatasks/private/task_listfits.py,sha256=P6GSW00zwXErPyJsoXOBGjJuNk9i_kc9v5wLHnS8mVU,475
 casatasks/private/task_listhistory.py,sha256=7mV2s9dx5AgDul4YPc1Q17Lwm0klgp3BSAG9v0gnYfI,627
 casatasks/private/task_listobs.py,sha256=SO1VMthQFPvCKdg7Gx6a3lRDwFHh6E7ioa8ZbLBkHKw,1970
 casatasks/private/task_listpartition.py,sha256=W4uWaXmUZK3Ve8H3UFXhfhktcQeHhEpfC7-Zb67KrrA,5500
@@ -347,19 +348,19 @@
 casatasks/private/task_makemask.py,sha256=lruHhK4pgbFMedw8YWZ3kCU2M4bZVvbxr1FPXxN4-aw,60731
 casatasks/private/task_mstransform.py,sha256=8atsi1k2tTCye_wh3Te_VwzM4o2tfPo02jb1cu2v9SA,16477
 casatasks/private/task_msuvbin.py,sha256=4-XsLpqCB48utJnvkQIFIXd789mXMPQx4--nJM2RTiY,4082
 casatasks/private/task_nrobeamaverage.py,sha256=6I0a61sxXvRgJ3wIGENG1CjcQYdDcu_MapzB33R9cQ0,4002
 casatasks/private/task_partition.py,sha256=w3pxTuwji8uBcS6jbY69hlzU3HOaK87IJZFDLkvTHXg,6449
 casatasks/private/task_phaseshift.py,sha256=3hD_jMX6px19EaPGRH-YRhpU54E93Fpb6W2-ZmQRjAU,6456
 casatasks/private/task_plotants.py,sha256=WWZp7Vv7bCRAX9jJEn9Is6m5_0HSePA1WApNtspf1rM,15846
-casatasks/private/task_plotbandpass.py,sha256=XoKoDPlN5Fsus0hKkba5POujCK9i62Q366Bs9qxpJV8,439545
+casatasks/private/task_plotbandpass.py,sha256=OZKqUP_eL0_aSnqMbzscJcqewQf0ERrCggdDQ3NgB3g,440392
 casatasks/private/task_plotprofilemap.py,sha256=oXW0jUQwzWD-D0kxPB02RjS4VDk12EqZp3tZ3_gLZGc,34563
 casatasks/private/task_plotweather.py,sha256=2TWQtczSCdxPh_kYwXcaYFykAEEokprRWOujAQzVcd0,13018
 casatasks/private/task_polcal.py,sha256=WWmXeZ_InJtFuGYHPLhdVeGOZdwua6jK5F-2GOvPGpM,4877
-casatasks/private/task_polfromgain.py,sha256=WIfIufoeN5rjVoUuvUhnqPoo9c8GqAjQdLu2TwCykZs,8698
+casatasks/private/task_polfromgain.py,sha256=0q4s_bhguUHbdNT9owVJCd8wWoGDLbL1p__R0HUxeTs,11653
 casatasks/private/task_predictcomp.py,sha256=aDFO9rgFNt7G-7zEGv-VgYsAe8IV63lsegFKdmKNkKM,8658
 casatasks/private/task_rerefant.py,sha256=ZlQQtL1WDAe-0liKspTn1_2G35-xXR8rR8vKss5NT1s,1261
 casatasks/private/task_rmfit.py,sha256=22ZhKMDghWibVlzQ9PdqSdqgMb1Ft0OWe27NKRpESyk,2306
 casatasks/private/task_rmtables.py,sha256=G7PRYG-Xj8Rt3m98m_QDOuISjTZQo_gywYfFhuLNUsE,794
 casatasks/private/task_sdatmcor.py,sha256=DYtTbdk_VkQqQc2GIKVomrtB0BwqrvoNiJ0FLVhd6yQ,24543
 casatasks/private/task_sdbaseline.py,sha256=Lk8Z7j-JcH4Y3LpExunhSPhVL_WU1olOoJqMDqQ70Io,21408
 casatasks/private/task_sdcal.py,sha256=N-U7u9KOWMPSYQbFHOOqx3l2w1nfiG6Wluy54xx9Bz8,10888
@@ -368,56 +369,56 @@
 casatasks/private/task_sdgaincal.py,sha256=a2EV9ud8_n47qQR-Pkgm5P01_so5FqMF-9y-6vTDkWY,4759
 casatasks/private/task_sdimaging.py,sha256=lqaqmmZUiCUSWFScyP-16vcMpqhTrMvivHnFYwDnmIA,55674
 casatasks/private/task_sdintimaging.py,sha256=qGUHxQSk29rPnsdh5bPevtWHczdAxupDmcFcBw3bdqg,37776
 casatasks/private/task_sdpolaverage.py,sha256=rrRVgl2QQaSC51ErKOzdq83g7UW6yYhnMIeWb_WQlS0,1684
 casatasks/private/task_sdsidebandsplit.py,sha256=CYF-zRNNCKhnvFKANak0XBBZ1eK5N9nneaekIDvhS7M,905
 casatasks/private/task_sdsmooth.py,sha256=Z4LLMQbNgbS73raWyOQJdmQiUENLAYVptVXJ_nZfNIw,1479
 casatasks/private/task_sdtimeaverage.py,sha256=nehGo2W0zi38ic-vgwE5N6WrAv8KXwCtr0J6oU8bhuQ,4103
-casatasks/private/task_setjy.py,sha256=CS7TpAIFR5s3zySF4eC-4RqJOVD_2flfS2-h2sJpIbk,30826
+casatasks/private/task_setjy.py,sha256=qZAaGWgb8X2AXuPZzTq3fBuSz5vrGeVDfown5bf9u98,30529
 casatasks/private/task_simalma.py,sha256=uw9um6z6SuvUD7NvpNibIS3mrNsX1mHGhmnyBryi8AM,81824
 casatasks/private/task_simanalyze.py,sha256=q6cFvPlAK0euFVFesiJIcHaV-MDA4wmhx35qdoo4wZc,54741
 casatasks/private/task_simobserve.py,sha256=MDL9j7kYj8qB0ldr0mgdBvCndVWzKYCUaSEaC9xddd8,65699
-casatasks/private/task_slsearch.py,sha256=M20GMCYWA6MBnAEM0-ddpLFg-MWtmFSIkDbzCRXZ4IA,3181
+casatasks/private/task_slsearch.py,sha256=nIkQmPembHVTNvUxdTLw5vWTzCqVp1IcRjo1yU6-Cp8,3181
 casatasks/private/task_smoothcal.py,sha256=uFv0CdImJZ-aD1ENesJeTCXW_8T9kY5mFYKBmz5Z2so,1734
-casatasks/private/task_specfit.py,sha256=Uo0AZFgxMpH-P6PlF_WaK4_MejXFme7WpTtBK3Gbxqo,4948
-casatasks/private/task_specflux.py,sha256=baGQU96OG6WmzN_f6V-bqpSnOGjr2NjMy8knzJ4afyQ,8526
+casatasks/private/task_specfit.py,sha256=X7sXDHzdUrDJqh-Nrdkpi9hETmWmg1EE6lY_b0sF4jw,4948
+casatasks/private/task_specflux.py,sha256=6mLDuIGtObio2hu2XdGRklYi5yQffIwLapaiDqro_q4,8526
 casatasks/private/task_specsmooth.py,sha256=kJItqamjSN1M-CRpFXrP7R0Gn0ZHK5zKvZ541BTpaLY,1772
-casatasks/private/task_splattotable.py,sha256=MNeFt1ju_v3aYm9f3Mb0va_bnSTVInDtR8fo_iRCYb0,2748
+casatasks/private/task_splattotable.py,sha256=4vTrY5aLma0TNu_4E_XBeSQXYK_TyW-jz3MST-Tm7yk,2748
 casatasks/private/task_split.py,sha256=8gt30U5kulNv98oKWKfIf9aRl0OwHbuf3S_twZSddf8,9910
-casatasks/private/task_spxfit.py,sha256=YoiBc7mUb8eOm-qAKnBgg1z587f_khnxw5mw-FPeBoE,4500
+casatasks/private/task_spxfit.py,sha256=nshFhlLO8uY_aNvJEDZtMNzThiDpycrVjm3xbhlRrUY,4500
 casatasks/private/task_statwt.py,sha256=WrI6eDre3SIHbblpztz1t9wceWJQ-0LuZkimOt0zGEQ,2827
-casatasks/private/task_tclean.py,sha256=7n6DSrwYs73xSRrKFA5ecLe5pqEwKGkt-ikxtym4v4k,19746
+casatasks/private/task_tclean.py,sha256=gHikTdNQV6W6CDif7jhG6D7TCyJyLbCEIG8OGjWqiks,24498
 casatasks/private/task_testconcat.py,sha256=wHgsNjnweq5D-Yi99v6icaXJny2WJ3E5vJpemSgVRMA,5463
-casatasks/private/task_tsdimaging.py,sha256=ZnY2HJ5QagbQZ7SUD8o9tozgA4kvU9MrMKbUa8mfTjM,43213
+casatasks/private/task_tsdimaging.py,sha256=TpDlgUHwQi0vCAm2nDz6txgnagQYBaP5OoIcY3wlzhk,44965
 casatasks/private/task_uvcontsub.py,sha256=dBvunX-YJTBUhIwiGW965LBSUW3i_HbFuEvwXlGcJEc,3059
 casatasks/private/task_uvcontsub_old.py,sha256=Ad4_PBznGlTeUNmomKFWTMS4abOLHsW9cxY0SDuEGbg,16768
 casatasks/private/task_uvmodelfit.py,sha256=-oVKnV7BNuzZtvImkB7LgMWrbiYD-u-u04agIjqZQww,1876
 casatasks/private/task_uvsub.py,sha256=hkp0ixmVsKQFbiTy5HhOIm8drLcKR3mTtBvMlGHMINw,2170
 casatasks/private/task_virtualconcat.py,sha256=kCL0m0bstQlMPlAM3t54MwYdIhzvWu0F3g0lCliRkhc,17685
 casatasks/private/task_vishead.py,sha256=BltNy7YEradlpw1GE9AGQPnh5bQI1DDJ9rgaX-xwprM,5626
 casatasks/private/task_visstat.py,sha256=Crl6XBM_6_OEUkB8_yvWEnsjAWs1hEEdLwGmmJsgeZw,3546
 casatasks/private/task_widebandpbcor.py,sha256=Kc7790juwc9LAeLRiTZZZJKiWV0JWsFFAd2PY6Mgwek,20916
 casatasks/private/tec_maps.py,sha256=NhLG70G0OrhzD9sewEdtVnyMI3A7BA5HkhbPRGOX6lg,48931
 casatasks/private/update_spw.py,sha256=5ZGM3XRY5jGvJiUZsUh5YwChcPfqH70evNrJKiynPxk,25338
-casatasks/private/userconfig.py,sha256=ckZFoGpg7eryZdqMKdpopol4PluN9oPPJWUIx8Pl86U,3491
 casatasks/private/vishead_util.py,sha256=XEyZIRLdYbaD24AYHKmkpyYq3CoPd18ozmmDV4Ii8AY,5829
 casatasks/private/imagerhelpers/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-casatasks/private/imagerhelpers/_gclean.py,sha256=lB-16tFKSWw4OdI61ZAOvKDKpqcAKb7h554wbEmnkTU,24657
-casatasks/private/imagerhelpers/imager_base.py,sha256=FEU0Y0m58kmttfB6sV-HwfXnwTlnXXSgYZ7hCs9yAK8,34617
+casatasks/private/imagerhelpers/_gclean.py,sha256=O-oHGj1cUog5dVKyrAxSi3O3VjwQErvrTwG_VUmhis8,35295
+casatasks/private/imagerhelpers/imager_base.py,sha256=YsFXSJu9ff2XFkgJhnqbs7vEOrdCvD4LejI6MkhRa8Q,35134
 casatasks/private/imagerhelpers/imager_deconvolver.py,sha256=RfKfjcAhRjq25dYQAz3RX9pqZhPfIBaaVWAXzmMqQo8,13143
+casatasks/private/imagerhelpers/imager_mtmfs_via_cube.py,sha256=Z7iWBb7sippIUIokHfKQlQYn5tjZzRogdT9USG-hR7Q,45935
 casatasks/private/imagerhelpers/imager_parallel_continuum.py,sha256=1lwJXHbR82Z80CaGjaXdXL5kNlpsAdBXF7JqY-NWu4Y,24198
 casatasks/private/imagerhelpers/imager_parallel_cube.py,sha256=JZaKM7w2uTTY0PQeK6pWk14okuXtbEAIf8MH0urludE,18301
 casatasks/private/imagerhelpers/imager_parallel_deconvolver.py,sha256=n2VO6cF6mo2FJKZkVZT6_Glq3FXVlI9MzFGijortdso,4509
-casatasks/private/imagerhelpers/imager_return_dict.py,sha256=1dhIbe6co2FRNP4P_OOG94Y3pVj--EvZz1IeP8n8zks,9622
-casatasks/private/imagerhelpers/input_parameters.py,sha256=EpIcT5kAUQNQTlMZ7he9uGo4FyughwNTWAU5Qp08Kv0,46647
+casatasks/private/imagerhelpers/imager_return_dict.py,sha256=i4i-0bcv4apPWBEuLazSENAML1tl_IVUaX6r2nvpnHg,25214
+casatasks/private/imagerhelpers/input_parameters.py,sha256=OjCQyVtAGw8A5YKfC-HiywQETh1CFe2X4U2eKN_g2lI,47239
 casatasks/private/imagerhelpers/parallel_imager_helper.py,sha256=ZdDas-abgooQpR8LBxtQSs4d97HOGNJYZ4KYfENlBhE,10524
 casatasks/private/imagerhelpers/summary_minor.py,sha256=kx5emX_7UN3PVL248LM7vY6hcFr72LOEWd4GvpOBAv4,14230
 casatasks/private/parallel/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 casatasks/private/parallel/parallel_data_helper.py,sha256=sf8PT2svPXY9LCCP3tIhvoFpGi_SSv_WFUPAVvumsFw,65764
 casatasks/private/parallel/parallel_task_helper.py,sha256=AnCE5Kr6G-akmg3wA7wEha6qqFBIoMZoe7P2EghscQo,27792
 casatasks/private/parallel/rflag_post_proc.py,sha256=hDKgULUjr8mgBA_yk2A-hq-fD7MLeVuHjDVraPA96Qo,6422
 casatasks/tests/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 casatasks/tests/test_casatasks.py,sha256=HaL_6MD4IYjsmxY3Ak5WXAnW0WC5ka4jZdQttD5mbvc,10938
-casatasks-6.6.3.22.dist-info/METADATA,sha256=XKCzBMo1b69vvx5fIEm1APr1akpBXBVCZn6O2EqwyLw,664
-casatasks-6.6.3.22.dist-info/WHEEL,sha256=oiQVh_5PnQM0E3gPdiz09WCNmwiHDMaGer_elqB3coM,92
-casatasks-6.6.3.22.dist-info/top_level.txt,sha256=DzoCR4EN6ywAREyS0bI7v3y37vYwMtD-h1UVnJbgXnU,10
-casatasks-6.6.3.22.dist-info/RECORD,,
+casatasks-6.6.4.34.dist-info/METADATA,sha256=OP1HxPV0qm6T3v2ILi8jzY0YobKupBliT9-vNTcrfwU,664
+casatasks-6.6.4.34.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
+casatasks-6.6.4.34.dist-info/top_level.txt,sha256=DzoCR4EN6ywAREyS0bI7v3y37vYwMtD-h1UVnJbgXnU,10
+casatasks-6.6.4.34.dist-info/RECORD,,
```

